var TP=Object.defineProperty,AP=Object.defineProperties;var LP=Object.getOwnPropertyDescriptors;var FE=Object.getOwnPropertySymbols;var NP=Object.prototype.hasOwnProperty,kP=Object.prototype.propertyIsEnumerable;var RE=(o,t,e)=>t in o?TP(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,cs=(o,t)=>{for(var e in t||={})NP.call(t,e)&&RE(o,e,t[e]);if(FE)for(var e of FE(t))kP.call(t,e)&&RE(o,e,t[e]);return o},oa=(o,t)=>AP(o,LP(t));var eS;function Wg(){return eS}function So(o){let t=eS;return eS=o,t}var OE=Symbol("NotFound");function hu(o){return o===OE||o?.name==="\u0275NotFound"}var tS=null;var zE=1;var PE=Symbol("SIGNAL");function di(o){let t=tS;return tS=o,t}function rS(){return tS}var nS={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function BE(o){if(!(qg(o)&&!o.dirty)&&!(!o.dirty&&o.lastCleanEpoch===zE)){if(!o.producerMustRecompute(o)&&!aS(o)){iS(o);return}o.producerRecomputeValue(o),iS(o)}}function iS(o){o.dirty=!1,o.lastCleanEpoch=zE}function sS(o){return o&&jE(o),di(o)}function jE(o){o.producersTail=void 0,o.recomputing=!0}function HE(o,t){di(t),o&&VE(o)}function VE(o){o.recomputing=!1;let t=o.producersTail,e=t!==void 0?t.nextProducer:o.producers;if(e!==void 0){if(qg(o))do e=lS(e);while(e!==void 0);t!==void 0?t.nextProducer=void 0:o.producers=void 0}}function aS(o){for(let t=o.producers;t!==void 0;t=t.nextProducer){let e=t.producer,i=t.lastReadVersion;if(i!==e.version||(BE(e),i!==e.version))return!0}return!1}function oS(o){if(qg(o)){let t=o.producers;for(;t!==void 0;)t=lS(t)}o.producers=void 0,o.producersTail=void 0,o.consumers=void 0,o.consumersTail=void 0}function lS(o){let t=o.producer,e=o.nextProducer,i=o.nextConsumer,r=o.prevConsumer;if(o.nextConsumer=void 0,o.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:t.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(t.consumers=i,!qg(t)){let n=t.producers;for(;n!==void 0;)n=lS(n)}return e}function qg(o){return o.consumerIsAlwaysLive||o.consumers!==void 0}function FP(){throw new Error}var RP=FP;function hS(o){RP=o}function Ts(o){return typeof o=="function"}function Yg(o){let e=o(i=>{Error.call(i),i.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Gg=Yg(o=>function(e){o(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function op(o,t){if(o){let e=o.indexOf(t);0<=e&&o.splice(e,1)}}var us=class o{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let n of e)n.remove(this);else e.remove(this);let{initialTeardown:i}=this;if(Ts(i))try{i()}catch(n){t=n instanceof Gg?n.errors:[n]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let n of r)try{_E(n)}catch(s){t=t??[],s instanceof Gg?t=[...t,...s.errors]:t.push(s)}}if(t)throw new Gg(t)}}add(t){var e;if(t&&t!==this)if(this.closed)_E(t);else{if(t instanceof o){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){let{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){let{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&op(e,t)}remove(t){let{_finalizers:e}=this;e&&op(e,t),t instanceof o&&t._removeParent(this)}};us.EMPTY=(()=>{let o=new us;return o.closed=!0,o})();var cS=us.EMPTY;function Qg(o){return o instanceof us||o&&"closed"in o&&Ts(o.remove)&&Ts(o.add)&&Ts(o.unsubscribe)}function _E(o){Ts(o)?o():o.unsubscribe()}var Va={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var cu={setTimeout(o,t,...e){let{delegate:i}=cu;return i?.setTimeout?i.setTimeout(o,t,...e):setTimeout(o,t,...e)},clearTimeout(o){let{delegate:t}=cu;return(t?.clearTimeout||clearTimeout)(o)},delegate:void 0};function UE(o){cu.setTimeout(()=>{let{onUnhandledError:t}=Va;if(t)t(o);else throw o})}function uS(){}var WE=dS("C",void 0,void 0);function qE(o){return dS("E",void 0,o)}function YE(o){return dS("N",o,void 0)}function dS(o,t,e){return{kind:o,value:t,error:e}}var _h=null;function uu(o){if(Va.useDeprecatedSynchronousErrorHandling){let t=!_h;if(t&&(_h={errorThrown:!1,error:null}),o(),t){let{errorThrown:e,error:i}=_h;if(_h=null,e)throw i}}else o()}function GE(o){Va.useDeprecatedSynchronousErrorHandling&&_h&&(_h.errorThrown=!0,_h.error=o)}var Uh=class extends us{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Qg(t)&&t.add(this)):this.destination=PP}static create(t,e,i){return new du(t,e,i)}next(t){this.isStopped?fS(YE(t),this):this._next(t)}error(t){this.isStopped?fS(qE(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?fS(WE,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},OP=Function.prototype.bind;function pS(o,t){return OP.call(o,t)}var gS=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){Xg(i)}}error(t){let{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){Xg(i)}else Xg(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Xg(e)}}},du=class extends Uh{constructor(t,e,i){super();let r;if(Ts(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let n;this&&Va.useDeprecatedNextContext?(n=Object.create(t),n.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&pS(t.next,n),error:t.error&&pS(t.error,n),complete:t.complete&&pS(t.complete,n)}):r=t}this.destination=new gS(r)}};function Xg(o){Va.useDeprecatedSynchronousErrorHandling?GE(o):UE(o)}function zP(o){throw o}function fS(o,t){let{onStoppedNotification:e}=Va;e&&cu.setTimeout(()=>e(o,t))}var PP={closed:!0,next:uS,error:zP,complete:uS};var QE=typeof Symbol=="function"&&Symbol.observable||"@@observable";function XE(o){return o}function KE(o){return o.length===0?XE:o.length===1?o[0]:function(e){return o.reduce((i,r)=>r(i),e)}}var pu=(()=>{class o{constructor(e){e&&(this._subscribe=e)}lift(e){let i=new o;return i.source=this,i.operator=e,i}subscribe(e,i,r){let n=jP(e)?e:new du(e,i,r);return uu(()=>{let{operator:s,source:a}=this;n.add(s?s.call(n,a):a?this._subscribe(n):this._trySubscribe(n))}),n}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return i=$E(i),new i((r,n)=>{let s=new du({next:a=>{try{e(a)}catch(l){n(l),s.unsubscribe()}},error:n,complete:r});this.subscribe(s)})}_subscribe(e){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(e)}[QE](){return this}pipe(...e){return KE(e)(this)}toPromise(e){return e=$E(e),new e((i,r)=>{let n;this.subscribe(s=>n=s,s=>r(s),()=>i(n))})}}return o.create=t=>new o(t),o})();function $E(o){var t;return(t=o??Va.Promise)!==null&&t!==void 0?t:Promise}function BP(o){return o&&Ts(o.next)&&Ts(o.error)&&Ts(o.complete)}function jP(o){return o&&o instanceof Uh||BP(o)&&Qg(o)}function HP(o){return Ts(o?.lift)}function ZE(o){return t=>{if(HP(t))return t.lift(function(e){try{return o(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function JE(o,t,e,i,r){return new vS(o,t,e,i,r)}var vS=class extends Uh{constructor(t,e,i,r,n,s){super(t),this.onFinalize=n,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};var eT=Yg(o=>function(){o(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Yl=(()=>{class o extends pu{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let i=new Kg(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new eT}next(e){uu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(e)}})}error(e){uu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){uu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:i,isStopped:r,observers:n}=this;return i||r?cS:(this.currentObservers=null,n.push(e),new us(()=>{this.currentObservers=null,op(n,e)}))}_checkFinalizedStatuses(e){let{hasError:i,thrownError:r,isStopped:n}=this;i?e.error(r):n&&e.complete()}asObservable(){let e=new pu;return e.source=this,e}}return o.create=(t,e)=>new Kg(t,e),o})(),Kg=class extends Yl{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.next)===null||i===void 0||i.call(e,t)}error(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.error)===null||i===void 0||i.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,i;return(i=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&i!==void 0?i:cS}};var lp=class extends Yl{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){let{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}};function $g(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}function mS(o,t){return ZE((e,i)=>{let r=0;e.subscribe(JE(i,n=>{i.next(o.call(t,n,r++))}))})}var pi=class extends Error{code;constructor(t,e){super(LS(t,e)),this.code=t}};function _P(o){return`NG0${Math.abs(o)}`}function LS(o,t){return`${_P(o)}${t?": "+t:""}`}function Qi(o){for(let t in o)if(o[t]===Qi)return t;throw Error("")}function rT(o,t){for(let e in t)t.hasOwnProperty(e)&&!o.hasOwnProperty(e)&&(o[e]=t[e])}function qh(o){if(typeof o=="string")return o;if(Array.isArray(o))return`[${o.map(qh).join(", ")}]`;if(o==null)return""+o;let t=o.overriddenName||o.name;if(t)return`${t}`;let e=o.toString();if(e==null)return""+e;let i=e.indexOf(`
`);return i>=0?e.slice(0,i):e}function NS(o,t){return o?t?`${o} ${t}`:o:t||""}var UP=Qi({__forward_ref__:Qi});function iv(o){return o.__forward_ref__=iv,o.toString=function(){return qh(this())},o}function _s(o){return nT(o)?o():o}function nT(o){return typeof o=="function"&&o.hasOwnProperty(UP)&&o.__forward_ref__===iv}function Pr(o){return{token:o.token,providedIn:o.providedIn||null,factory:o.factory,value:void 0}}function Ql(o){return{providers:o.providers||[],imports:o.imports||[]}}function rv(o){return WP(o,nv)}function WP(o,t){return o.hasOwnProperty(t)&&o[t]||null}function qP(o){let t=o?.[nv]??null;return t||null}function bS(o){return o&&o.hasOwnProperty(Jg)?o[Jg]:null}var nv=Qi({\u0275prov:Qi}),Jg=Qi({\u0275inj:Qi}),Ti=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=Pr({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function kS(o){return o&&!!o.\u0275providers}var FS=Qi({\u0275cmp:Qi}),RS=Qi({\u0275dir:Qi}),OS=Qi({\u0275pipe:Qi});var SS=Qi({\u0275fac:Qi}),Xh=Qi({__NG_ELEMENT_ID__:Qi}),tT=Qi({__NG_ENV_ID__:Qi});function sT(o){return typeof o=="string"?o:o==null?"":String(o)}function aT(o){return typeof o=="function"?o.name||o.toString():typeof o=="object"&&o!=null&&typeof o.type=="function"?o.type.name||o.type.toString():sT(o)}var oT=Qi({ngErrorCode:Qi}),YP=Qi({ngErrorMessage:Qi}),GP=Qi({ngTokenPath:Qi});function zS(o,t){return lT("",-200,t)}function sv(o,t){throw new pi(-201,!1)}function lT(o,t,e){let i=new pi(t,o);return i[oT]=t,i[YP]=o,e&&(i[GP]=e),i}function QP(o){return o[oT]}var CS;function hT(){return CS}function Vs(o){let t=CS;return CS=o,t}function PS(o,t,e){let i=rv(o);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(e&8)return null;if(t!==void 0)return t;sv(o,"Injector")}var XP={},Wh=XP,KP="__NG_DI_FLAG__",wS=class{injector;constructor(t){this.injector=t}retrieve(t,e){let i=Yh(e)||0;try{return this.injector.get(t,i&8?null:Wh,i)}catch(r){if(hu(r))return r;throw r}}};function $P(o,t=0){let e=Wg();if(e===void 0)throw new pi(-203,!1);if(e===null)return PS(o,void 0,t);{let i=ZP(t),r=e.retrieve(o,i);if(hu(r)){if(i.optional)return null;throw r}return r}}function Ui(o,t=0){return(hT()||$P)(_s(o),t)}function Si(o,t){return Ui(o,Yh(t))}function Yh(o){return typeof o>"u"||typeof o=="number"?o:0|(o.optional&&8)|(o.host&&1)|(o.self&&2)|(o.skipSelf&&4)}function ZP(o){return{optional:!!(o&8),host:!!(o&1),self:!!(o&2),skipSelf:!!(o&4)}}function xS(o){let t=[];for(let e=0;e<o.length;e++){let i=_s(o[e]);if(Array.isArray(i)){if(i.length===0)throw new pi(900,!1);let r,n=0;for(let s=0;s<i.length;s++){let a=i[s],l=JP(a);typeof l=="number"?l===-1?r=a.token:n|=l:r=a}t.push(Ui(r,n))}else t.push(Ui(i))}return t}function JP(o){return o[KP]}function gu(o,t){let e=o.hasOwnProperty(SS);return e?o[SS]:null}function cT(o,t,e){if(o.length!==t.length)return!1;for(let i=0;i<o.length;i++){let r=o[i],n=t[i];if(e&&(r=e(r),n=e(n)),n!==r)return!1}return!0}function uT(o){return o.flat(Number.POSITIVE_INFINITY)}function av(o,t){o.forEach(e=>Array.isArray(e)?av(e,t):t(e))}function BS(o,t,e){t>=o.length?o.push(e):o.splice(t,0,e)}function up(o,t){return t>=o.length-1?o.pop():o.splice(t,1)[0]}var Xl={},la=[],Kh=new Ti(""),jS=new Ti("",-1),HS=new Ti(""),cp=class{get(t,e=Wh){if(e===Wh){let r=lT("",-201);throw r.name="\u0275NotFound",r}return e}};function $h(o){return o[FS]||null}function VS(o){return o[RS]||null}function dT(o){return o[OS]||null}function pT(...o){return{\u0275providers:_S(!0,o),\u0275fromNgModule:!0}}function _S(o,...t){let e=[],i=new Set,r,n=s=>{e.push(s)};return av(t,s=>{let a=s;ev(a,n,[],i)&&(r||=[],r.push(a))}),r!==void 0&&fT(r,n),e}function fT(o,t){for(let e=0;e<o.length;e++){let{ngModule:i,providers:r}=o[e];US(r,n=>{t(n,i)})}}function ev(o,t,e,i){if(o=_s(o),!o)return!1;let r=null,n=bS(o),s=!n&&$h(o);if(!n&&!s){let l=o.ngModule;if(n=bS(l),n)r=l;else return!1}else{if(s&&!s.standalone)return!1;r=o}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let h of l)ev(h,t,e,i)}}else if(n){if(n.imports!=null&&!a){i.add(r);let h;try{av(n.imports,c=>{ev(c,t,e,i)&&(h||=[],h.push(c))})}finally{}h!==void 0&&fT(h,t)}if(!a){let h=gu(r)||(()=>new r);t({provide:r,useFactory:h,deps:la},r),t({provide:HS,useValue:r,multi:!0},r),t({provide:Kh,useValue:()=>Ui(r),multi:!0},r)}let l=n.providers;if(l!=null&&!a){let h=o;US(l,c=>{t(c,h)})}}else return!1;return r!==o&&o.providers!==void 0}function US(o,t){for(let e of o)kS(e)&&(e=e.\u0275providers),Array.isArray(e)?US(e,t):t(e)}var eB=Qi({provide:String,useValue:Qi});function gT(o){return o!==null&&typeof o=="object"&&eB in o}function tB(o){return!!(o&&o.useExisting)}function iB(o){return!!(o&&o.useFactory)}function tv(o){return typeof o=="function"}var dp=new Ti(""),Zg={},iT={},yS;function pp(){return yS===void 0&&(yS=new cp),yS}var ha=class{},Gh=class extends ha{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,MS(t,s=>this.processProvider(s)),this.records.set(jS,fu(void 0,this)),r.has("environment")&&this.records.set(ha,fu(void 0,this));let n=this.records.get(dp);n!=null&&typeof n.value=="string"&&this.scopes.add(n.value),this.injectorDefTypes=new Set(this.get(HS,la,{self:!0}))}retrieve(t,e){let i=Yh(e)||0;try{return this.get(t,Wh,i)}catch(r){if(hu(r))return r;throw r}}destroy(){hp(this),this._destroyed=!0;let t=di(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),di(t)}}onDestroy(t){return hp(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){hp(this);let e=So(this),i=Vs(void 0),r;try{return t()}finally{So(e),Vs(i)}}get(t,e=Wh,i){if(hp(this),t.hasOwnProperty(tT))return t[tT](this);let r=Yh(i),n,s=So(this),a=Vs(void 0);try{if(!(r&4)){let h=this.records.get(t);if(h===void 0){let c=oB(t)&&rv(t);c&&this.injectableDefInScope(c)?h=fu(IS(t),Zg):h=null,this.records.set(t,h)}if(h!=null)return this.hydrate(t,h,r)}let l=r&2?pp():this.parent;return e=r&8&&e===Wh?null:e,l.get(t,e)}catch(l){let h=QP(l);throw h===-200||h===-201?new pi(h,null):l}finally{Vs(a),So(s)}}resolveInjectorInitializers(){let t=di(null),e=So(this),i=Vs(void 0),r;try{let n=this.get(Kh,la,{self:!0});for(let s of n)s()}finally{So(e),Vs(i),di(t)}}toString(){let t=[],e=this.records;for(let i of e.keys())t.push(qh(i));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=_s(t);let e=tv(t)?t:_s(t&&t.provide),i=nB(t);if(!tv(t)&&t.multi===!0){let r=this.records.get(e);r||(r=fu(void 0,Zg,!0),r.factory=()=>xS(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e,i){let r=di(null);try{if(e.value===iT)throw zS(qh(t));return e.value===Zg&&(e.value=iT,e.value=e.factory(void 0,i)),typeof e.value=="object"&&e.value&&aB(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{di(r)}}injectableDefInScope(t){if(!t.providedIn)return!1;let e=_s(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){let e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}};function IS(o){let t=rv(o),e=t!==null?t.factory:gu(o);if(e!==null)return e;if(o instanceof Ti)throw new pi(204,!1);if(o instanceof Function)return rB(o);throw new pi(204,!1)}function rB(o){if(o.length>0)throw new pi(204,!1);let e=qP(o);return e!==null?()=>e.factory(o):()=>new o}function nB(o){if(gT(o))return fu(void 0,o.useValue);{let t=vT(o);return fu(t,Zg)}}function vT(o,t,e){let i;if(tv(o)){let r=_s(o);return gu(r)||IS(r)}else if(gT(o))i=()=>_s(o.useValue);else if(iB(o))i=()=>o.useFactory(...xS(o.deps||[]));else if(tB(o))i=(r,n)=>Ui(_s(o.useExisting),n!==void 0&&n&8?8:void 0);else{let r=_s(o&&(o.useClass||o.provide));if(sB(o))i=()=>new r(...xS(o.deps));else return gu(r)||IS(r)}return i}function hp(o){if(o.destroyed)throw new pi(205,!1)}function fu(o,t,e=!1){return{factory:o,value:t,multi:e?[]:void 0}}function sB(o){return!!o.deps}function aB(o){return o!==null&&typeof o=="object"&&typeof o.ngOnDestroy=="function"}function oB(o){return typeof o=="function"||typeof o=="object"&&o.ngMetadataName==="InjectionToken"}function MS(o,t){for(let e of o)Array.isArray(e)?MS(e,t):e&&kS(e)?MS(e.\u0275providers,t):t(e)}function ov(o,t){let e;o instanceof Gh?(hp(o),e=o):e=new wS(o);let i,r=So(e),n=Vs(void 0);try{return t()}finally{So(r),Vs(n)}}function mT(){return hT()!==void 0||Wg()!=null}var _a=0,_t=1,Vt=2,xn=3,ca=4,ua=5,fp=6,vu=7,ds=8,Kl=9,il=10,ps=11,mu=12,WS=13,yu=14,Ua=15,$l=16,Zh=17,wo=18,gp=19,qS=20,el=21,lv=22,vp=23,Us=24,hv=25,mp=26,xo=27,yT=1;var Zl=7,yp=8,Jh=9,fs=10;function Io(o){return Array.isArray(o)&&typeof o[yT]=="object"}function Wa(o){return Array.isArray(o)&&o[yT]===!0}function YS(o){return(o.flags&4)!==0}function ec(o){return o.componentOffset>-1}function cv(o){return(o.flags&1)===1}function rl(o){return!!o.template}function bu(o){return(o[Vt]&512)!==0}function tc(o){return(o[Vt]&256)===256}var bT="svg",ST="math";function qa(o){for(;Array.isArray(o);)o=o[_a];return o}function Mo(o,t){return qa(t[o.index])}function uv(o,t){return o.data[t]}function Ya(o,t){let e=t[o];return Io(e)?e:e[_a]}function CT(o){return(o[Vt]&4)===4}function dv(o){return(o[Vt]&128)===128}function wT(o){return Wa(o[xn])}function GS(o,t){return t==null?null:o[t]}function QS(o){o[Zh]=0}function XS(o){o[Vt]&1024||(o[Vt]|=1024,dv(o)&&Sp(o))}function bp(o){return!!(o[Vt]&9216||o[Us]?.dirty)}function pv(o){o[il].changeDetectionScheduler?.notify(8),o[Vt]&64&&(o[Vt]|=1024),bp(o)&&Sp(o)}function Sp(o){o[il].changeDetectionScheduler?.notify(0);let t=Gl(o);for(;t!==null&&!(t[Vt]&8192||(t[Vt]|=8192,!dv(t)));)t=Gl(t)}function KS(o,t){if(tc(o))throw new pi(911,!1);o[el]===null&&(o[el]=[]),o[el].push(t)}function xT(o,t){if(o[el]===null)return;let e=o[el].indexOf(t);e!==-1&&o[el].splice(e,1)}function Gl(o){let t=o[xn];return Wa(t)?t[xn]:t}function $S(o){return o[vu]??=[]}function ZS(o){return o.cleanup??=[]}function IT(o,t,e,i){let r=$S(t);r.push(e),o.firstCreatePass&&ZS(o).push(i,r.length-1)}var Ii={lFrame:HT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var DS=!1;function MT(){return Ii.lFrame.elementDepthCount}function DT(){Ii.lFrame.elementDepthCount++}function ET(){Ii.lFrame.elementDepthCount--}function TT(){return Ii.bindingsEnabled}function AT(){return Ii.skipHydrationRootTNode!==null}function LT(o){return Ii.skipHydrationRootTNode===o}function NT(){Ii.skipHydrationRootTNode=null}function cn(){return Ii.lFrame.lView}function Jl(){return Ii.lFrame.tView}function fv(o){return Ii.lFrame.contextLView=o,o[ds]}function gv(o){return Ii.lFrame.contextLView=null,o}function da(){let o=JS();for(;o!==null&&o.type===64;)o=o.parent;return o}function JS(){return Ii.lFrame.currentTNode}function kT(){let o=Ii.lFrame,t=o.currentTNode;return o.isParent?t:t.parent}function vv(o,t){let e=Ii.lFrame;e.currentTNode=o,e.isParent=t}function eC(){return Ii.lFrame.isParent}function FT(){Ii.lFrame.isParent=!1}function tC(){return DS}function iC(o){let t=DS;return DS=o,t}function RT(o){return Ii.lFrame.bindingIndex=o}function OT(){return Ii.lFrame.bindingIndex++}function zT(){return Ii.lFrame.inI18n}function PT(o,t){let e=Ii.lFrame;e.bindingIndex=e.bindingRootIndex=o,mv(t)}function BT(){return Ii.lFrame.currentDirectiveIndex}function mv(o){Ii.lFrame.currentDirectiveIndex=o}function rC(){return Ii.lFrame.currentQueryIndex}function yv(o){Ii.lFrame.currentQueryIndex=o}function lB(o){let t=o[_t];return t.type===2?t.declTNode:t.type===1?o[ua]:null}function nC(o,t,e){if(e&4){let r=t,n=o;for(;r=r.parent,r===null&&!(e&1);)if(r=lB(n),r===null||(n=n[yu],r.type&10))break;if(r===null)return!1;t=r,o=n}let i=Ii.lFrame=jT();return i.currentTNode=t,i.lView=o,!0}function bv(o){let t=jT(),e=o[_t];Ii.lFrame=t,t.currentTNode=e.firstChild,t.lView=o,t.tView=e,t.contextLView=o,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function jT(){let o=Ii.lFrame,t=o===null?null:o.child;return t===null?HT(o):t}function HT(o){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:o,child:null,inI18n:!1};return o!==null&&(o.child=t),t}function VT(){let o=Ii.lFrame;return Ii.lFrame=o.parent,o.currentTNode=null,o.lView=null,o}var sC=VT;function Sv(){let o=VT();o.isParent=!0,o.tView=null,o.selectedIndex=-1,o.contextLView=null,o.elementDepthCount=0,o.currentDirectiveIndex=-1,o.currentNamespace=null,o.bindingRootIndex=-1,o.bindingIndex=-1,o.currentQueryIndex=0}function aC(){return Ii.lFrame.selectedIndex}function eh(o){Ii.lFrame.selectedIndex=o}function _T(){let o=Ii.lFrame;return uv(o.tView,o.selectedIndex)}function UT(){return Ii.lFrame.currentNamespace}var WT=!0;function qT(){return WT}function YT(o){WT=o}function ES(o,t=null,e=null,i){let r=GT(o,t,e,i);return r.resolveInjectorInitializers(),r}function GT(o,t=null,e=null,i,r=new Set){let n=[e||la,pT(o)];return i=i||(typeof o=="object"?void 0:qh(o)),new Gh(n,t||pp(),i||null,r)}var tl=class o{static THROW_IF_NOT_FOUND=Wh;static NULL=new cp;static create(t,e){if(Array.isArray(t))return ES({name:""},e,t,"");{let i=t.name??"";return ES({name:i},t.parent,t.providers,i)}}static \u0275prov=Pr({token:o,providedIn:"any",factory:()=>Ui(jS)});static __NG_ELEMENT_ID__=-1},Ga=new Ti(""),Cv=(()=>{class o{static __NG_ELEMENT_ID__=hB;static __NG_ENV_ID__=e=>e}return o})(),TS=class extends Cv{_lView;constructor(t){super(),this._lView=t}get destroyed(){return tc(this._lView)}onDestroy(t){let e=this._lView;return KS(e,t),()=>xT(e,t)}};function hB(){return new TS(cn())}var Co=class{_console=console;handleError(t){this._console.error("ERROR",t)}},th=new Ti("",{providedIn:"root",factory:()=>{let o=Si(ha),t;return e=>{o.destroyed&&!t?setTimeout(()=>{throw e}):(t??=o.get(Co),t.handleError(e))}}}),QT={provide:Kh,useValue:()=>void Si(Co),multi:!0};var Qh=class{},wv=new Ti("",{providedIn:"root",factory:()=>!1});var oC=new Ti(""),lC=new Ti(""),ic=(()=>{class o{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new lp(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new pu(e=>{e.next(!1),e.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Pr({token:o,providedIn:"root",factory:()=>new o})}return o})();function Cp(...o){}var hC=(()=>{class o{static \u0275prov=Pr({token:o,providedIn:"root",factory:()=>new AS})}return o})(),AS=class{dirtyEffectCount=0;queues=new Map;add(t){this.enqueue(t),this.schedule(t)}schedule(t){t.dirty&&this.dirtyEffectCount++}remove(t){let e=t.zone,i=this.queues.get(e);i.has(t)&&(i.delete(t),t.dirty&&this.dirtyEffectCount--)}enqueue(t){let e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);let i=this.queues.get(e);i.has(t)||i.add(t)}flush(){for(;this.dirtyEffectCount>0;){let t=!1;for(let[e,i]of this.queues)e===null?t||=this.flushQueue(i):t||=e.run(()=>this.flushQueue(i));t||(this.dirtyEffectCount=0)}}flushQueue(t){let e=!1;for(let i of t)i.dirty&&(this.dirtyEffectCount--,e=!0,i.run());return e}};function jv(o){return{toString:o}.toString()}function EB(o){return typeof o=="function"}var Ev=class{previousValue;currentValue;firstChange;constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}};function IA(o,t,e,i){t!==null?t.applyValueToInputSignal(t,i):o[e]=i}function TB(o){return o.type.prototype.ngOnChanges&&(o.setInput=LB),AB}function AB(){let o=DA(this),t=o?.current;if(t){let e=o.previous;if(e===Xl)o.previous=t;else for(let i in t)e[i]=t[i];o.current=null,this.ngOnChanges(t)}}function LB(o,t,e,i,r){let n=this.declaredInputs[i],s=DA(o)||NB(o,{previous:Xl,current:null}),a=s.current||(s.current={}),l=s.previous,h=l[n];a[n]=new Ev(h&&h.currentValue,e,l===Xl),IA(o,t,r,e)}var MA="__ngSimpleChanges__";function DA(o){return o[MA]||null}function NB(o,t){return o[MA]=t}var XT=[];var ir=function(o,t=null,e){for(let i=0;i<XT.length;i++){let r=XT[i];r(o,t,e)}};function kB(o,t,e){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:n}=t.type.prototype;if(i){let s=TB(t);(e.preOrderHooks??=[]).push(o,s),(e.preOrderCheckHooks??=[]).push(o,s)}r&&(e.preOrderHooks??=[]).push(0-o,r),n&&((e.preOrderHooks??=[]).push(o,n),(e.preOrderCheckHooks??=[]).push(o,n))}function FB(o,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){let n=o.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:h,ngOnDestroy:c}=n;s&&(o.contentHooks??=[]).push(-e,s),a&&((o.contentHooks??=[]).push(e,a),(o.contentCheckHooks??=[]).push(e,a)),l&&(o.viewHooks??=[]).push(-e,l),h&&((o.viewHooks??=[]).push(e,h),(o.viewCheckHooks??=[]).push(e,h)),c!=null&&(o.destroyHooks??=[]).push(e,c)}}function xv(o,t,e){EA(o,t,3,e)}function Iv(o,t,e,i){(o[Vt]&3)===e&&EA(o,t,e,i)}function cC(o,t){let e=o[Vt];(e&3)===t&&(e&=16383,e+=1,o[Vt]=e)}function EA(o,t,e,i){let r=i!==void 0?o[Zh]&65535:0,n=i??-1,s=t.length-1,a=0;for(let l=r;l<s;l++)if(typeof t[l+1]=="number"){if(a=t[l],i!=null&&a>=i)break}else t[l]<0&&(o[Zh]+=65536),(a<n||n==-1)&&(RB(o,e,t,l),o[Zh]=(o[Zh]&4294901760)+l+2),l++}function KT(o,t){ir(4,o,t);let e=di(null);try{t.call(o)}finally{di(e),ir(5,o,t)}}function RB(o,t,e,i){let r=e[i]<0,n=e[i+1],s=r?-e[i]:e[i],a=o[s];r?o[Vt]>>14<o[Zh]>>16&&(o[Vt]&3)===t&&(o[Vt]+=16384,KT(a,n)):KT(a,n)}var Cu=-1,Ip=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,i,r){this.factory=t,this.name=r,this.canSeeViewProviders=e,this.injectImpl=i}};function OB(o){return(o.flags&8)!==0}function zB(o){return(o.flags&16)!==0}function PB(o,t,e){let i=0;for(;i<e.length;){let r=e[i];if(typeof r=="number"){if(r!==0)break;i++;let n=e[i++],s=e[i++],a=e[i++];o.setAttribute(t,s,a,n)}else{let n=r,s=e[++i];jB(n)?o.setProperty(t,n,s):o.setAttribute(t,n,s),i++}}return i}function BB(o){return o===3||o===4||o===6}function jB(o){return o.charCodeAt(0)===64}function Tv(o,t){if(!(t===null||t.length===0))if(o===null||o.length===0)o=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){let r=t[i];typeof r=="number"?e=r:e===0||(e===-1||e===2?$T(o,e,r,null,t[++i]):$T(o,e,r,null,null))}}return o}function $T(o,t,e,i,r){let n=0,s=o.length;if(t===-1)s=-1;else for(;n<o.length;){let a=o[n++];if(typeof a=="number"){if(a===t){s=-1;break}else if(a>t){s=n-1;break}}}for(;n<o.length;){let a=o[n];if(typeof a=="number")break;if(a===e){r!==null&&(o[n+1]=r);return}n++,r!==null&&n++}s!==-1&&(o.splice(s,0,t),n=s+1),o.splice(n++,0,e),r!==null&&o.splice(n++,0,r)}function TA(o){return o!==Cu}function Av(o){return o&32767}function HB(o){return o>>16}function Lv(o,t){let e=HB(o),i=t;for(;e>0;)i=i[yu],e--;return i}var vC=!0;function ZT(o){let t=vC;return vC=o,t}var VB=256,AA=VB-1,LA=5,_B=0,Do={};function UB(o,t,e){let i;typeof e=="string"?i=e.charCodeAt(0)||0:e.hasOwnProperty(Xh)&&(i=e[Xh]),i==null&&(i=e[Xh]=_B++);let r=i&AA,n=1<<r;t.data[o+(r>>LA)]|=n}function NA(o,t){let e=kA(o,t);if(e!==-1)return e;let i=t[_t];i.firstCreatePass&&(o.injectorIndex=t.length,uC(i.data,o),uC(t,null),uC(i.blueprint,null));let r=OC(o,t),n=o.injectorIndex;if(TA(r)){let s=Av(r),a=Lv(r,t),l=a[_t].data;for(let h=0;h<8;h++)t[n+h]=a[s+h]|l[s+h]}return t[n+8]=r,n}function uC(o,t){o.push(0,0,0,0,0,0,0,0,t)}function kA(o,t){return o.injectorIndex===-1||o.parent&&o.parent.injectorIndex===o.injectorIndex||t[o.injectorIndex+8]===null?-1:o.injectorIndex}function OC(o,t){if(o.parent&&o.parent.injectorIndex!==-1)return o.parent.injectorIndex;let e=0,i=null,r=t;for(;r!==null;){if(i=PA(r),i===null)return Cu;if(e++,r=r[yu],i.injectorIndex!==-1)return i.injectorIndex|e<<16}return Cu}function WB(o,t,e){UB(o,t,e)}function FA(o,t,e){if(e&8||o!==void 0)return o;sv(t,"NodeInjector")}function RA(o,t,e,i){if(e&8&&i===void 0&&(i=null),(e&3)===0){let r=o[Kl],n=Vs(void 0);try{return r?r.get(t,i,e&8):PS(t,i,e&8)}finally{Vs(n)}}return FA(i,t,e)}function OA(o,t,e,i=0,r){if(o!==null){if(t[Vt]&2048&&!(i&2)){let s=QB(o,t,e,i,Do);if(s!==Do)return s}let n=zA(o,t,e,i,Do);if(n!==Do)return n}return RA(t,e,i,r)}function zA(o,t,e,i,r){let n=YB(e);if(typeof n=="function"){if(!nC(t,o,i))return i&1?FA(r,e,i):RA(t,e,i,r);try{let s;if(s=n(i),s==null&&!(i&8))sv(e);else return s}finally{sC()}}else if(typeof n=="number"){let s=null,a=kA(o,t),l=Cu,h=i&1?t[Ua][ua]:null;for((a===-1||i&4)&&(l=a===-1?OC(o,t):t[a+8],l===Cu||!eA(i,!1)?a=-1:(s=t[_t],a=Av(l),t=Lv(l,t)));a!==-1;){let c=t[_t];if(JT(n,a,c.data)){let u=qB(a,t,e,s,i,h);if(u!==Do)return u}l=t[a+8],l!==Cu&&eA(i,t[_t].data[a+8]===h)&&JT(n,a,t)?(s=c,a=Av(l),t=Lv(l,t)):a=-1}}return r}function qB(o,t,e,i,r,n){let s=t[_t],a=s.data[o+8],l=i==null?ec(a)&&vC:i!=s&&(a.type&3)!==0,h=r&1&&n===a,c=Mv(a,s,e,l,h);return c!==null?Nv(t,s,c,a,r):Do}function Mv(o,t,e,i,r){let n=o.providerIndexes,s=t.data,a=n&1048575,l=o.directiveStart,h=o.directiveEnd,c=n>>20,u=i?a:a+c,d=r?a+c:h;for(let p=u;p<d;p++){let f=s[p];if(p<l&&e===f||p>=l&&f.type===e)return p}if(r){let p=s[l];if(p&&rl(p)&&p.type===e)return l}return null}function Nv(o,t,e,i,r){let n=o[e],s=t.data;if(n instanceof Ip){let a=n;if(a.resolving){let p=aT(s[e]);throw zS(p)}let l=ZT(a.canSeeViewProviders);a.resolving=!0;let h=s[e].type||s[e],c,u=a.injectImpl?Vs(a.injectImpl):null,d=nC(o,i,0);try{n=o[e]=a.factory(void 0,r,s,o,i),t.firstCreatePass&&e>=i.directiveStart&&kB(e,s[e],t)}finally{u!==null&&Vs(u),ZT(l),a.resolving=!1,sC()}}return n}function YB(o){if(typeof o=="string")return o.charCodeAt(0)||0;let t=o.hasOwnProperty(Xh)?o[Xh]:void 0;return typeof t=="number"?t>=0?t&AA:GB:t}function JT(o,t,e){let i=1<<o;return!!(e[t+(o>>LA)]&i)}function eA(o,t){return!(o&2)&&!(o&1&&t)}var rc=class{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return OA(this._tNode,this._lView,t,Yh(i),e)}};function GB(){return new rc(da(),cn())}function QB(o,t,e,i,r){let n=o,s=t;for(;n!==null&&s!==null&&s[Vt]&2048&&!bu(s);){let a=zA(n,s,e,i|2,Do);if(a!==Do)return a;let l=n.parent;if(!l){let h=s[qS];if(h){let c=h.get(e,Do,i);if(c!==Do)return c}l=PA(s),s=s[yu]}n=l}return r}function PA(o){let t=o[_t],e=t.type;return e===2?t.declTNode:e===1?o[ua]:null}function XB(){return Mu(da(),cn())}function Mu(o,t){return new ih(Mo(o,t))}var ih=(()=>{class o{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=XB}return o})();function KB(o){return o instanceof ih?o.nativeElement:o}function $B(){return this._results[Symbol.iterator]()}var kv=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Yl}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;let i=uT(t);(this._changesDetected=!cT(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=$B};function BA(o){return(o.flags&128)===128}var zC=(function(o){return o[o.OnPush=0]="OnPush",o[o.Default=1]="Default",o})(zC||{}),jA=new Map,ZB=0;function JB(){return ZB++}function e2(o){jA.set(o[gp],o)}function mC(o){jA.delete(o[gp])}var tA="__ngContext__";function Mp(o,t){Io(t)?(o[tA]=t[gp],e2(t)):o[tA]=t}function HA(o){return _A(o[mu])}function VA(o){return _A(o[ca])}function _A(o){for(;o!==null&&!Wa(o);)o=o[ca];return o}var yC;function PC(o){yC=o}function UA(){if(yC!==void 0)return yC;if(typeof document<"u")return document;throw new pi(210,!1)}var Hv=new Ti("",{providedIn:"root",factory:()=>t2}),t2="ng",Vv=new Ti(""),Ap=new Ti("",{providedIn:"platform",factory:()=>"unknown"});var _v=new Ti("",{providedIn:"root",factory:()=>UA().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var i2="h",r2="b";var WA=!1,qA=new Ti("",{providedIn:"root",factory:()=>WA});var n2=(o,t,e,i)=>{};function s2(o,t,e,i){n2(o,t,e,i)}function BC(o){return(o.flags&32)===32}var a2=()=>null;function YA(o,t,e=!1){return a2(o,t,e)}function GA(o,t){let e=o.contentQueries;if(e!==null){let i=di(null);try{for(let r=0;r<e.length;r+=2){let n=e[r],s=e[r+1];if(s!==-1){let a=o.data[s];yv(n),a.contentQueries(2,t[s],s)}}}finally{di(i)}}}function bC(o,t,e){yv(0);let i=di(null);try{t(o,e)}finally{di(i)}}function QA(o,t,e){if(YS(t)){let i=di(null);try{let r=t.directiveStart,n=t.directiveEnd;for(let s=r;s<n;s++){let a=o.data[s];if(a.contentQueries){let l=e[s];a.contentQueries(1,l,s)}}}finally{di(i)}}}var nl=(function(o){return o[o.Emulated=0]="Emulated",o[o.None=2]="None",o[o.ShadowDom=3]="ShadowDom",o})(nl||{});function o2(o,t,e){let i=o.length;for(;;){let r=o.indexOf(t,e);if(r===-1)return r;if(r===0||o.charCodeAt(r-1)<=32){let n=t.length;if(r+n===i||o.charCodeAt(r+n)<=32)return r}e=r+1}}var XA="ng-template";function l2(o,t,e,i){let r=0;if(i){for(;r<t.length&&typeof t[r]=="string";r+=2)if(t[r]==="class"&&o2(t[r+1].toLowerCase(),e,0)!==-1)return!0}else if(jC(o))return!1;if(r=t.indexOf(1,r),r>-1){let n;for(;++r<t.length&&typeof(n=t[r])=="string";)if(n.toLowerCase()===e)return!0}return!1}function jC(o){return o.type===4&&o.value!==XA}function h2(o,t,e){let i=o.type===4&&!e?XA:o.value;return t===i}function c2(o,t,e){let i=4,r=o.attrs,n=r!==null?p2(r):0,s=!1;for(let a=0;a<t.length;a++){let l=t[a];if(typeof l=="number"){if(!s&&!Qa(i)&&!Qa(l))return!1;if(s&&Qa(l))continue;s=!1,i=l|i&1;continue}if(!s)if(i&4){if(i=2|i&1,l!==""&&!h2(o,l,e)||l===""&&t.length===1){if(Qa(i))return!1;s=!0}}else if(i&8){if(r===null||!l2(o,r,l,e)){if(Qa(i))return!1;s=!0}}else{let h=t[++a],c=u2(l,r,jC(o),e);if(c===-1){if(Qa(i))return!1;s=!0;continue}if(h!==""){let u;if(c>n?u="":u=r[c+1].toLowerCase(),i&2&&h!==u){if(Qa(i))return!1;s=!0}}}}return Qa(i)||s}function Qa(o){return(o&1)===0}function u2(o,t,e,i){if(t===null)return-1;let r=0;if(i||!e){let n=!1;for(;r<t.length;){let s=t[r];if(s===o)return r;if(s===3||s===6)n=!0;else if(s===1||s===2){let a=t[++r];for(;typeof a=="string";)a=t[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=n?1:2}return-1}else return f2(t,o)}function d2(o,t,e=!1){for(let i=0;i<t.length;i++)if(c2(o,t[i],e))return!0;return!1}function p2(o){for(let t=0;t<o.length;t++){let e=o[t];if(BB(e))return t}return o.length}function f2(o,t){let e=o.indexOf(4);if(e>-1)for(e++;e<o.length;){let i=o[e];if(typeof i=="number")return-1;if(i===t)return e;e++}return-1}function iA(o,t){return o?":not("+t.trim()+")":t}function g2(o){let t=o[0],e=1,i=2,r="",n=!1;for(;e<o.length;){let s=o[e];if(typeof s=="string")if(i&2){let a=o[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Qa(s)&&(t+=iA(n,r),r=""),i=s,n=n||!Qa(i);e++}return r!==""&&(t+=iA(n,r)),t}function v2(o){return o.map(g2).join(",")}function m2(o){let t=[],e=[],i=1,r=2;for(;i<o.length;){let n=o[i];if(typeof n=="string")r===2?n!==""&&t.push(n,o[++i]):r===8&&e.push(n);else{if(!Qa(r))break;r=n}i++}return e.length&&t.push(1,...e),t}var Uv={};function KA(o,t,e){return o.createElement(t,e)}function Fv(o,t,e,i,r){o.insertBefore(t,e,i,r)}function $A(o,t,e){o.appendChild(t,e)}function rA(o,t,e,i,r){i!==null?Fv(o,t,e,i,r):$A(o,t,e)}function y2(o,t,e,i){o.removeChild(null,t,e,i)}function b2(o,t,e){o.setAttribute(t,"style",e)}function S2(o,t,e){e===""?o.removeAttribute(t,"class"):o.setAttribute(t,"class",e)}function ZA(o,t,e){let{mergedAttrs:i,classes:r,styles:n}=e;i!==null&&PB(o,t,i),r!==null&&S2(o,t,r),n!==null&&b2(o,t,n)}function JA(o,t,e,i,r,n,s,a,l,h,c){let u=xo+i,d=u+r,p=C2(u,d),f=typeof h=="function"?h():h;return p[_t]={type:o,blueprint:p,template:e,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof n=="function"?n():n,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1,ssrId:c}}function C2(o,t){let e=[];for(let i=0;i<t;i++)e.push(i<o?null:Uv);return e}function w2(o){let t=o.tView;return t===null||t.incompleteFirstPass?o.tView=JA(1,null,o.template,o.decls,o.vars,o.directiveDefs,o.pipeDefs,o.viewQuery,o.schemas,o.consts,o.id):t}function HC(o,t,e,i,r,n,s,a,l,h,c){let u=t.blueprint.slice();return u[_a]=r,u[Vt]=i|4|128|8|64|1024,(h!==null||o&&o[Vt]&2048)&&(u[Vt]|=2048),QS(u),u[xn]=u[yu]=o,u[ds]=e,u[il]=s||o&&o[il],u[ps]=a||o&&o[ps],u[Kl]=l||o&&o[Kl]||null,u[ua]=n,u[gp]=JB(),u[fp]=c,u[qS]=h,u[Ua]=t.type==2?o[Ua]:u,u}function x2(o,t,e){let i=Mo(t,o),r=w2(e),n=o[il].rendererFactory,s=i1(o,HC(o,r,null,e1(e),i,t,null,n.createRenderer(i,e),null,null,null));return o[t.index]=s}function e1(o){let t=16;return o.signals?t=4096:o.onPush&&(t=64),t}function t1(o,t,e,i){if(e===0)return-1;let r=t.length;for(let n=0;n<e;n++)t.push(i),o.blueprint.push(i),o.data.push(null);return r}function i1(o,t){return o[mu]?o[WS][ca]=t:o[mu]=t,o[WS]=t,t}function rh(o=1){r1(Jl(),cn(),aC()+o,!1)}function r1(o,t,e,i){if(!i)if((t[Vt]&3)===3){let n=o.preOrderCheckHooks;n!==null&&xv(t,n,e)}else{let n=o.preOrderHooks;n!==null&&Iv(t,n,0,e)}eh(e)}var Wv=(function(o){return o[o.None=0]="None",o[o.SignalBased=1]="SignalBased",o[o.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",o})(Wv||{});function SC(o,t,e,i){let r=di(null);try{let[n,s,a]=o.inputs[e],l=null;(s&Wv.SignalBased)!==0&&(l=t[n][PE]),l!==null&&l.transformFn!==void 0?i=l.transformFn(i):a!==null&&(i=a.call(t,i)),o.setInput!==null?o.setInput(t,l,i,e,n):IA(t,l,n,i)}finally{di(r)}}var sc=(function(o){return o[o.Important=1]="Important",o[o.DashCase=2]="DashCase",o})(sc||{}),I2;function VC(o,t){return I2(o,t)}var wu=new Set,_C=(function(o){return o[o.CHANGE_DETECTION=0]="CHANGE_DETECTION",o[o.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",o})(_C||{}),Lp=new Ti(""),nA=new Set;function n1(o){nA.has(o)||(nA.add(o),performance?.mark?.("mark_feature_usage",{detail:{feature:o}}))}var s1=!1,CC=class extends Yl{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,mT()&&(this.destroyRef=Si(Cv,{optional:!0})??void 0,this.pendingTasks=Si(ic,{optional:!0})??void 0)}emit(t){let e=di(null);try{super.next(t)}finally{di(e)}}subscribe(t,e,i){let r=t,n=e||(()=>null),s=i;if(t&&typeof t=="object"){let l=t;r=l.next?.bind(l),n=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(n=this.wrapInTimeout(n),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:n,complete:s});return t instanceof us&&t.add(a),a}wrapInTimeout(t){return e=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{t(e)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},As=CC;function a1(o){let t,e;function i(){o=Cp;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{o(),i()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{o(),i()})),()=>i()}function sA(o){return queueMicrotask(()=>o()),()=>{o=Cp}}var UC="isAngularZone",Rv=UC+"_ID",M2=0,Rn=class o{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new As(!1);onMicrotaskEmpty=new As(!1);onStable=new As(!1);onError=new As(!1);constructor(t){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:n=s1}=t;if(typeof Zone>"u")throw new pi(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=n,T2(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(UC)===!0}static assertInAngularZone(){if(!o.isInAngularZone())throw new pi(909,!1)}static assertNotInAngularZone(){if(o.isInAngularZone())throw new pi(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){let n=this._inner,s=n.scheduleEventTask("NgZoneEvent: "+r,t,D2,Cp,Cp);try{return n.runTask(s,e,i)}finally{n.cancelTask(s)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}},D2={};function WC(o){if(o._nesting==0&&!o.hasPendingMicrotasks&&!o.isStable)try{o._nesting++,o.onMicrotaskEmpty.emit(null)}finally{if(o._nesting--,!o.hasPendingMicrotasks)try{o.runOutsideAngular(()=>o.onStable.emit(null))}finally{o.isStable=!0}}}function E2(o){if(o.isCheckStableRunning||o.callbackScheduled)return;o.callbackScheduled=!0;function t(){a1(()=>{o.callbackScheduled=!1,wC(o),o.isCheckStableRunning=!0,WC(o),o.isCheckStableRunning=!1})}o.scheduleInRootZone?Zone.root.run(()=>{t()}):o._outer.run(()=>{t()}),wC(o)}function T2(o){let t=()=>{E2(o)},e=M2++;o._inner=o._inner.fork({name:"angular",properties:{[UC]:!0,[Rv]:e,[Rv+e]:!0},onInvokeTask:(i,r,n,s,a,l)=>{if(A2(l))return i.invokeTask(n,s,a,l);try{return aA(o),i.invokeTask(n,s,a,l)}finally{(o.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||o.shouldCoalesceRunChangeDetection)&&t(),oA(o)}},onInvoke:(i,r,n,s,a,l,h)=>{try{return aA(o),i.invoke(n,s,a,l,h)}finally{o.shouldCoalesceRunChangeDetection&&!o.callbackScheduled&&!L2(l)&&t(),oA(o)}},onHasTask:(i,r,n,s)=>{i.hasTask(n,s),r===n&&(s.change=="microTask"?(o._hasPendingMicrotasks=s.microTask,wC(o),WC(o)):s.change=="macroTask"&&(o.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,n,s)=>(i.handleError(n,s),o.runOutsideAngular(()=>o.onError.emit(s)),!1)})}function wC(o){o._hasPendingMicrotasks||(o.shouldCoalesceEventChangeDetection||o.shouldCoalesceRunChangeDetection)&&o.callbackScheduled===!0?o.hasPendingMicrotasks=!0:o.hasPendingMicrotasks=!1}function aA(o){o._nesting++,o.isStable&&(o.isStable=!1,o.onUnstable.emit(null))}function oA(o){o._nesting--,WC(o)}var Ov=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new As;onMicrotaskEmpty=new As;onStable=new As;onError=new As;run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}};function A2(o){return o1(o,"__ignore_ng_zone__")}function L2(o){return o1(o,"__scheduler_tick__")}function o1(o,t){return!Array.isArray(o)||o.length!==1?!1:o[0]?.data?.[t]===!0}var l1=(()=>{class o{impl=null;execute(){this.impl?.execute()}static \u0275prov=Pr({token:o,providedIn:"root",factory:()=>new o})}return o})();var N2=new Ti("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function h1(o,t,e){let i=o.get(N2);if(Array.isArray(t))for(let r of t)i.queue.add(r),e?.detachedLeaveAnimationFns?.push(r);else i.queue.add(t),e?.detachedLeaveAnimationFns?.push(t);i.scheduler&&i.scheduler(o)}function k2(o,t){for(let[e,i]of t)h1(o,i.animateFns)}function lA(o,t,e,i){let r=o?.[mp]?.enter;t!==null&&r&&r.has(e.index)&&k2(i,r)}function Su(o,t,e,i,r,n,s,a){if(r!=null){let l,h=!1;Wa(r)?l=r:Io(r)&&(h=!0,r=r[_a]);let c=qa(r);o===0&&i!==null?(lA(a,i,n,e),s==null?$A(t,i,c):Fv(t,i,c,s||null,!0)):o===1&&i!==null?(lA(a,i,n,e),Fv(t,i,c,s||null,!0)):o===2?hA(a,n,e,u=>{y2(t,c,h,u)}):o===3&&hA(a,n,e,()=>{t.destroyNode(c)}),l!=null&&Y2(t,o,e,l,n,i,s)}}function F2(o,t){c1(o,t),t[_a]=null,t[ua]=null}function R2(o,t,e,i,r,n){i[_a]=r,i[ua]=t,qv(o,i,e,1,r,n)}function c1(o,t){t[il].changeDetectionScheduler?.notify(9),qv(o,t,t[ps],2,null,null)}function O2(o){let t=o[mu];if(!t)return dC(o[_t],o);for(;t;){let e=null;if(Io(t))e=t[mu];else{let i=t[fs];i&&(e=i)}if(!e){for(;t&&!t[ca]&&t!==o;)Io(t)&&dC(t[_t],t),t=t[xn];t===null&&(t=o),Io(t)&&dC(t[_t],t),e=t&&t[ca]}t=e}}function qC(o,t){let e=o[Jh],i=e.indexOf(t);e.splice(i,1)}function u1(o,t){if(tc(t))return;let e=t[ps];e.destroyNode&&qv(o,t,e,3,null,null),O2(t)}function dC(o,t){if(tc(t))return;let e=di(null);try{t[Vt]&=-129,t[Vt]|=256,t[Us]&&oS(t[Us]),B2(o,t),P2(o,t),t[_t].type===1&&t[ps].destroy();let i=t[$l];if(i!==null&&Wa(t[xn])){i!==t[xn]&&qC(i,t);let r=t[wo];r!==null&&r.detachView(o)}mC(t)}finally{di(e)}}function hA(o,t,e,i){let r=o?.[mp];if(r==null||r.leave==null||!r.leave.has(t.index))return i(!1);o&&wu.add(o),h1(e,()=>{if(r.leave&&r.leave.has(t.index)){let s=r.leave.get(t.index),a=[];if(s){for(let l=0;l<s.animateFns.length;l++){let h=s.animateFns[l],{promise:c}=h();a.push(c)}r.detachedLeaveAnimationFns=void 0}r.running=Promise.allSettled(a),z2(o,i)}else o&&wu.delete(o),i(!1)},r)}function z2(o,t){let e=o[mp]?.running;if(e){e.then(()=>{o[mp].running=void 0,wu.delete(o),t(!0)});return}t(!1)}function P2(o,t){let e=o.cleanup,i=t[vu];if(e!==null)for(let s=0;s<e.length-1;s+=2)if(typeof e[s]=="string"){let a=e[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[e[s+1]];e[s].call(a)}i!==null&&(t[vu]=null);let r=t[el];if(r!==null){t[el]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let n=t[vp];if(n!==null){t[vp]=null;for(let s of n)s.destroy()}}function B2(o,t){let e;if(o!=null&&(e=o.destroyHooks)!=null)for(let i=0;i<e.length;i+=2){let r=t[e[i]];if(!(r instanceof Ip)){let n=e[i+1];if(Array.isArray(n))for(let s=0;s<n.length;s+=2){let a=r[n[s]],l=n[s+1];ir(4,a,l);try{l.call(a)}finally{ir(5,a,l)}}else{ir(4,r,n);try{n.call(r)}finally{ir(5,r,n)}}}}}function j2(o,t,e){return H2(o,t.parent,e)}function H2(o,t,e){let i=t;for(;i!==null&&i.type&168;)t=i,i=t.parent;if(i===null)return e[_a];if(ec(i)){let{encapsulation:r}=o.data[i.directiveStart+i.componentOffset];if(r===nl.None||r===nl.Emulated)return null}return Mo(i,e)}function V2(o,t,e){return U2(o,t,e)}function _2(o,t,e){return o.type&40?Mo(o,e):null}var U2=_2,cA;function W2(o,t,e,i){let r=j2(o,i,t),n=t[ps],s=i.parent||t[ua],a=V2(s,i,t);if(r!=null)if(Array.isArray(e))for(let l=0;l<e.length;l++)rA(n,r,e[l],a,!1);else rA(n,r,e,a,!1);cA!==void 0&&cA(n,i,t,e,r)}function wp(o,t){if(t!==null){let e=t.type;if(e&3)return Mo(t,o);if(e&4)return xC(-1,o[t.index]);if(e&8){let i=t.child;if(i!==null)return wp(o,i);{let r=o[t.index];return Wa(r)?xC(-1,r):qa(r)}}else{if(e&128)return wp(o,t.next);if(e&32)return VC(t,o)()||qa(o[t.index]);{let i=d1(o,t);if(i!==null){if(Array.isArray(i))return i[0];let r=Gl(o[Ua]);return wp(r,i)}else return wp(o,t.next)}}}return null}function d1(o,t){if(t!==null){let i=o[Ua][ua],r=t.projection;return i.projection[r]}return null}function xC(o,t){let e=fs+o+1;if(e<t.length){let i=t[e],r=i[_t].firstChild;if(r!==null)return wp(i,r)}return t[Zl]}function YC(o,t,e,i,r,n,s){for(;e!=null;){let a=i[Kl];if(e.type===128){e=e.next;continue}let l=i[e.index],h=e.type;if(s&&t===0&&(l&&Mp(qa(l),i),e.flags|=2),!BC(e))if(h&8)YC(o,t,e.child,i,r,n,!1),Su(t,o,a,r,l,e,n,i);else if(h&32){let c=VC(e,i),u;for(;u=c();)Su(t,o,a,r,u,e,n,i);Su(t,o,a,r,l,e,n,i)}else h&16?q2(o,t,i,e,r,n):Su(t,o,a,r,l,e,n,i);e=s?e.projectionNext:e.next}}function qv(o,t,e,i,r,n){YC(e,i,o.firstChild,t,r,n,!1)}function q2(o,t,e,i,r,n){let s=e[Ua],l=s[ua].projection[i.projection];if(Array.isArray(l))for(let h=0;h<l.length;h++){let c=l[h];Su(t,o,e[Kl],r,c,i,n,e)}else{let h=l,c=s[xn];BA(i)&&(h.flags|=128),YC(o,t,h,c,r,n,!0)}}function Y2(o,t,e,i,r,n,s){let a=i[Zl],l=qa(i);a!==l&&Su(t,o,e,n,a,r,s);for(let h=fs;h<i.length;h++){let c=i[h];qv(c[_t],c,o,t,n,a)}}function p1(o,t,e,i,r){let n=aC(),s=i&2;try{eh(-1),s&&t.length>xo&&r1(o,t,xo,!1),ir(s?2:0,r,e),e(i,r)}finally{eh(n),ir(s?3:1,r,e)}}function f1(o,t,e){tj(o,t,e),(e.flags&64)===64&&ij(o,t,e)}function G2(o,t,e=Mo){let i=t.localNames;if(i!==null){let r=t.index+1;for(let n=0;n<i.length;n+=2){let s=i[n+1],a=s===-1?e(t,o):o[s];o[r++]=a}}}function Q2(o,t,e,i){let n=i.get(qA,WA)||e===nl.ShadowDom,s=o.selectRootElement(t,n);return X2(s),s}function X2(o){K2(o)}var K2=()=>null;function $2(o){return o==="class"?"className":o==="for"?"htmlFor":o==="formaction"?"formAction":o==="innerHtml"?"innerHTML":o==="readonly"?"readOnly":o==="tabindex"?"tabIndex":o}function Z2(o,t,e,i,r,n){let s=t[_t];if(GC(o,s,t,e,i)){ec(o)&&ej(t,o.index);return}o.type&3&&(e=$2(e)),J2(o,t,e,i,r,n)}function J2(o,t,e,i,r,n){if(o.type&3){let s=Mo(o,t);i=n!=null?n(i,o.value||"",e):i,r.setProperty(s,e,i)}else o.type&12}function ej(o,t){let e=Ya(t,o);e[Vt]&16||(e[Vt]|=64)}function tj(o,t,e){let i=e.directiveStart,r=e.directiveEnd;ec(e)&&x2(t,e,o.data[i+e.componentOffset]),o.firstCreatePass||NA(e,t);let n=e.initialInputs;for(let s=i;s<r;s++){let a=o.data[s],l=Nv(t,o,s,e);if(Mp(l,t),n!==null&&sj(t,s-i,l,a,e,n),rl(a)){let h=Ya(e.index,t);h[ds]=Nv(t,o,s,e)}}}function ij(o,t,e){let i=e.directiveStart,r=e.directiveEnd,n=e.index,s=BT();try{eh(n);for(let a=i;a<r;a++){let l=o.data[a],h=t[a];mv(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&rj(l,h)}}finally{eh(-1),mv(s)}}function rj(o,t){o.hostBindings!==null&&o.hostBindings(1,t)}function nj(o,t){let e=o.directiveRegistry,i=null;if(e)for(let r=0;r<e.length;r++){let n=e[r];d2(t,n.selectors,!1)&&(i??=[],rl(n)?i.unshift(n):i.push(n))}return i}function sj(o,t,e,i,r,n){let s=n[t];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],h=s[a+1];SC(i,e,l,h)}}function aj(o,t,e,i,r){let n=xo+e,s=t[_t],a=r(s,t,o,i,e);t[n]=a,vv(o,!0);let l=o.type===2;return l?(ZA(t[ps],a,o),(MT()===0||cv(o))&&Mp(a,t),DT()):Mp(a,t),qT()&&(!l||!BC(o))&&W2(s,t,a,o),o}function oj(o){let t=o;return eC()?FT():(t=t.parent,vv(t,!1)),t}function lj(o,t){let e=o[Kl];if(!e)return;let i;try{i=e.get(th,null)}catch{i=null}i?.(t)}function GC(o,t,e,i,r){let n=o.inputs?.[i],s=o.hostDirectiveInputs?.[i],a=!1;if(s)for(let l=0;l<s.length;l+=2){let h=s[l],c=s[l+1],u=t.data[h];SC(u,e[h],c,r),a=!0}if(n)for(let l of n){let h=e[l],c=t.data[l];SC(c,h,i,r),a=!0}return a}function hj(o,t){let e=Ya(t,o),i=e[_t];cj(i,e);let r=e[_a];r!==null&&e[fp]===null&&(e[fp]=YA(r,e[Kl])),ir(18),QC(i,e,e[ds]),ir(19,e[ds])}function cj(o,t){for(let e=t.length;e<o.blueprint.length;e++)t.push(o.blueprint[e])}function QC(o,t,e){bv(t);try{let i=o.viewQuery;i!==null&&bC(1,i,e);let r=o.template;r!==null&&p1(o,t,r,1,e),o.firstCreatePass&&(o.firstCreatePass=!1),t[wo]?.finishViewCreation(o),o.staticContentQueries&&GA(o,t),o.staticViewQueries&&bC(2,o.viewQuery,e);let n=o.components;n!==null&&uj(t,n)}catch(i){throw o.firstCreatePass&&(o.incompleteFirstPass=!0,o.firstCreatePass=!1),i}finally{t[Vt]&=-5,Sv()}}function uj(o,t){for(let e=0;e<t.length;e++)hj(o,t[e])}function dj(o,t,e,i){let r=di(null);try{let n=t.tView,a=o[Vt]&4096?4096:16,l=HC(o,n,e,a,null,t,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),h=o[t.index];l[$l]=h;let c=o[wo];return c!==null&&(l[wo]=c.createEmbeddedView(n)),QC(n,l,e),l}finally{di(r)}}function uA(o,t){return!t||t.firstChild===null||BA(o)}function Dp(o,t,e,i,r=!1){for(;e!==null;){if(e.type===128){e=r?e.projectionNext:e.next;continue}let n=t[e.index];n!==null&&i.push(qa(n)),Wa(n)&&g1(n,i);let s=e.type;if(s&8)Dp(o,t,e.child,i);else if(s&32){let a=VC(e,t),l;for(;l=a();)i.push(l)}else if(s&16){let a=d1(t,e);if(Array.isArray(a))i.push(...a);else{let l=Gl(t[Ua]);Dp(l[_t],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function g1(o,t){for(let e=fs;e<o.length;e++){let i=o[e],r=i[_t].firstChild;r!==null&&Dp(i[_t],i,r,t)}o[Zl]!==o[_a]&&t.push(o[Zl])}function v1(o){if(o[hv]!==null){for(let t of o[hv])t.impl.addSequence(t);o[hv].length=0}}var m1=[];function pj(o){return o[Us]??fj(o)}function fj(o){let t=m1.pop()??Object.create(vj);return t.lView=o,t}function gj(o){o.lView[Us]!==o&&(o.lView=null,m1.push(o))}var vj=oa(cs({},nS),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:o=>{Sp(o.lView)},consumerOnSignalRead(){this.lView[Us]=this}});function mj(o){let t=o[Us]??Object.create(yj);return t.lView=o,t}var yj=oa(cs({},nS),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:o=>{let t=Gl(o.lView);for(;t&&!y1(t[_t]);)t=Gl(t);t&&XS(t)},consumerOnSignalRead(){this.lView[Us]=this}});function y1(o){return o.type!==2}function b1(o){if(o[vp]===null)return;let t=!0;for(;t;){let e=!1;for(let i of o[vp])i.dirty&&(e=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));t=e&&!!(o[Vt]&8192)}}var bj=100;function S1(o,t=0){let i=o[il].rendererFactory,r=!1;r||i.begin?.();try{Sj(o,t)}finally{r||i.end?.()}}function Sj(o,t){let e=tC();try{iC(!0),IC(o,t);let i=0;for(;bp(o);){if(i===bj)throw new pi(103,!1);i++,IC(o,1)}}finally{iC(e)}}function Cj(o,t,e,i){if(tc(t))return;let r=t[Vt],n=!1,s=!1;bv(t);let a=!0,l=null,h=null;n||(y1(o)?(h=pj(t),l=sS(h)):rS()===null?(a=!1,h=mj(t),l=sS(h)):t[Us]&&(oS(t[Us]),t[Us]=null));try{QS(t),RT(o.bindingStartIndex),e!==null&&p1(o,t,e,2,i);let c=(r&3)===3;if(!n)if(c){let p=o.preOrderCheckHooks;p!==null&&xv(t,p,null)}else{let p=o.preOrderHooks;p!==null&&Iv(t,p,0,null),cC(t,0)}if(s||wj(t),b1(t),C1(t,0),o.contentQueries!==null&&GA(o,t),!n)if(c){let p=o.contentCheckHooks;p!==null&&xv(t,p)}else{let p=o.contentHooks;p!==null&&Iv(t,p,1),cC(t,1)}Ij(o,t);let u=o.components;u!==null&&x1(t,u,0);let d=o.viewQuery;if(d!==null&&bC(2,d,i),!n)if(c){let p=o.viewCheckHooks;p!==null&&xv(t,p)}else{let p=o.viewHooks;p!==null&&Iv(t,p,2),cC(t,2)}if(o.firstUpdatePass===!0&&(o.firstUpdatePass=!1),t[lv]){for(let p of t[lv])p();t[lv]=null}n||(v1(t),t[Vt]&=-73)}catch(c){throw n||Sp(t),c}finally{h!==null&&(HE(h,l),a&&gj(h)),Sv()}}function C1(o,t){for(let e=HA(o);e!==null;e=VA(e))for(let i=fs;i<e.length;i++){let r=e[i];w1(r,t)}}function wj(o){for(let t=HA(o);t!==null;t=VA(t)){if(!(t[Vt]&2))continue;let e=t[Jh];for(let i=0;i<e.length;i++){let r=e[i];XS(r)}}}function xj(o,t,e){ir(18);let i=Ya(t,o);w1(i,e),ir(19,i[ds])}function w1(o,t){dv(o)&&IC(o,t)}function IC(o,t){let i=o[_t],r=o[Vt],n=o[Us],s=!!(t===0&&r&16);if(s||=!!(r&64&&t===0),s||=!!(r&1024),s||=!!(n?.dirty&&aS(n)),s||=!1,n&&(n.dirty=!1),o[Vt]&=-9217,s)Cj(i,o,i.template,o[ds]);else if(r&8192){let a=di(null);try{b1(o),C1(o,1);let l=i.components;l!==null&&x1(o,l,1),v1(o)}finally{di(a)}}}function x1(o,t,e){for(let i=0;i<t.length;i++)xj(o,t[i],e)}function Ij(o,t){let e=o.hostBindingOpCodes;if(e!==null)try{for(let i=0;i<e.length;i++){let r=e[i];if(r<0)eh(~r);else{let n=r,s=e[++i],a=e[++i];PT(s,n);let l=t[n];ir(24,l),a(2,l),ir(25,l)}}}finally{eh(-1)}}function XC(o,t){let e=tC()?64:1088;for(o[il].changeDetectionScheduler?.notify(t);o;){o[Vt]|=e;let i=Gl(o);if(bu(o)&&!i)return o;o=i}return null}function Mj(o,t,e,i){return[o,!0,0,t,null,i,null,e,null,null]}function Dj(o,t,e,i=!0){let r=t[_t];if(Ej(r,t,o,e),i){let s=xC(e,o),a=t[ps],l=a.parentNode(o[Zl]);l!==null&&R2(r,o[ua],a,t,l,s)}let n=t[fp];n!==null&&n.firstChild!==null&&(n.firstChild=null)}function MC(o,t){if(o.length<=fs)return;let e=fs+t,i=o[e];if(i){let r=i[$l];r!==null&&r!==o&&qC(r,i),t>0&&(o[e-1][ca]=i[ca]);let n=up(o,fs+t);F2(i[_t],i);let s=n[wo];s!==null&&s.detachView(n[_t]),i[xn]=null,i[ca]=null,i[Vt]&=-129}return i}function Ej(o,t,e,i){let r=fs+i,n=e.length;i>0&&(e[r-1][ca]=t),i<n-fs?(t[ca]=e[r],BS(e,fs+i,t)):(e.push(t),t[ca]=null),t[xn]=e;let s=t[$l];s!==null&&e!==s&&I1(s,t);let a=t[wo];a!==null&&a.insertView(o),pv(t),t[Vt]|=128}function I1(o,t){let e=o[Jh],i=t[xn];if(Io(i))o[Vt]|=2;else{let r=i[xn][Ua];t[Ua]!==r&&(o[Vt]|=2)}e===null?o[Jh]=[t]:e.push(t)}var xu=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let t=this._lView,e=t[_t];return Dp(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e}get context(){return this._lView[ds]}set context(t){this._lView[ds]=t}get destroyed(){return tc(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[xn];if(Wa(t)){let e=t[yp],i=e?e.indexOf(this):-1;i>-1&&(MC(t,i),up(e,i))}this._attachedToViewContainer=!1}u1(this._lView[_t],this._lView)}onDestroy(t){KS(this._lView,t)}markForCheck(){XC(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Vt]&=-129}reattach(){pv(this._lView),this._lView[Vt]|=128}detectChanges(){this._lView[Vt]|=1024,S1(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pi(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=bu(this._lView),e=this._lView[$l];e!==null&&!t&&qC(e,this._lView),c1(this._lView[_t],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new pi(902,!1);this._appRef=t;let e=bu(this._lView),i=this._lView[$l];i!==null&&!e&&I1(i,this._lView),pv(this._lView)}};var Iu=(()=>{class o{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Tj;constructor(e,i,r){this._declarationLView=e,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,i){return this.createEmbeddedViewImpl(e,i)}createEmbeddedViewImpl(e,i,r){let n=dj(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:i,dehydratedView:r});return new xu(n)}}return o})();function Tj(){return KC(da(),cn())}function KC(o,t){return o.type&4?new Iu(t,o,Mu(o,t)):null}function Aj(o,t,e,i,r){let n=o.data[t];if(n===null)n=Lj(o,t,e,i,r),zT()&&(n.flags|=32);else if(n.type&64){n.type=e,n.value=i,n.attrs=r;let s=kT();n.injectorIndex=s===null?-1:s.injectorIndex}return vv(n,!0),n}function Lj(o,t,e,i,r){let n=JS(),s=eC(),a=s?n:n&&n.parent,l=o.data[t]=kj(o,a,e,t,i,r);return Nj(o,l,n,s),l}function Nj(o,t,e,i){o.firstChild===null&&(o.firstChild=t),e!==null&&(i?e.child==null&&t.parent!==null&&(e.child=t):e.next===null&&(e.next=t,t.prev=e))}function kj(o,t,e,i,r,n){let s=t?t.injectorIndex:-1,a=0;return AT()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:n,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var QX=new RegExp(`^(\\d+)*(${r2}|${i2})*(.*)`);var Fj=()=>null;function dA(o,t){return Fj(o,t)}var M1=class{},Yv=class{},DC=class{resolveComponentFactory(t){throw new pi(917,!1)}},Gv=class{static NULL=new DC},nc=class{},Qv=(()=>{class o{destroyNode=null;static __NG_ELEMENT_ID__=()=>Rj()}return o})();function Rj(){let o=cn(),t=da(),e=Ya(t.index,o);return(Io(e)?e:o)[ps]}var D1=(()=>{class o{static \u0275prov=Pr({token:o,providedIn:"root",factory:()=>null})}return o})();var Dv={},EC=class{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){let r=this.injector.get(t,Dv,i);return r!==Dv||e===Dv?r:this.parentInjector.get(t,e,i)}};function pA(o,t,e){let i=e?o.styles:null,r=e?o.classes:null,n=0;if(t!==null)for(let s=0;s<t.length;s++){let a=t[s];if(typeof a=="number")n=a;else if(n==1)r=NS(r,a);else if(n==2){let l=a,h=t[++s];i=NS(i,l+": "+h+";")}}e?o.styles=i:o.stylesWithoutHost=i,e?o.classes=r:o.classesWithoutHost=r}function On(o,t=0){let e=cn();if(e===null)return Ui(o,t);let i=da();return OA(i,e,_s(o),t)}function Oj(o,t,e,i,r){let n=i===null?null:{"":-1},s=r(o,e);if(s!==null){let a=s,l=null,h=null;for(let c of s)if(c.resolveHostDirectives!==null){[a,l,h]=c.resolveHostDirectives(s);break}Bj(o,t,e,a,n,l,h)}n!==null&&i!==null&&zj(e,i,n)}function zj(o,t,e){let i=o.localNames=[];for(let r=0;r<t.length;r+=2){let n=e[t[r+1]];if(n==null)throw new pi(-301,!1);i.push(t[r],n)}}function Pj(o,t,e){t.componentOffset=e,(o.components??=[]).push(t.index)}function Bj(o,t,e,i,r,n,s){let a=i.length,l=!1;for(let d=0;d<a;d++){let p=i[d];!l&&rl(p)&&(l=!0,Pj(o,e,d)),WB(NA(e,t),o,p.type)}Wj(e,o.data.length,a);for(let d=0;d<a;d++){let p=i[d];p.providersResolver&&p.providersResolver(p)}let h=!1,c=!1,u=t1(o,t,a,null);a>0&&(e.directiveToIndex=new Map);for(let d=0;d<a;d++){let p=i[d];if(e.mergedAttrs=Tv(e.mergedAttrs,p.hostAttrs),Hj(o,e,t,u,p),Uj(u,p,r),s!==null&&s.has(p)){let[v,m]=s.get(p);e.directiveToIndex.set(p.type,[u,v+e.directiveStart,m+e.directiveStart])}else(n===null||!n.has(p))&&e.directiveToIndex.set(p.type,u);p.contentQueries!==null&&(e.flags|=4),(p.hostBindings!==null||p.hostAttrs!==null||p.hostVars!==0)&&(e.flags|=64);let f=p.type.prototype;!h&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((o.preOrderHooks??=[]).push(e.index),h=!0),!c&&(f.ngOnChanges||f.ngDoCheck)&&((o.preOrderCheckHooks??=[]).push(e.index),c=!0),u++}jj(o,e,n)}function jj(o,t,e){for(let i=t.directiveStart;i<t.directiveEnd;i++){let r=o.data[i];if(e===null||!e.has(r))fA(0,t,r,i),fA(1,t,r,i),vA(t,i,!1);else{let n=e.get(r);gA(0,t,n,i),gA(1,t,n,i),vA(t,i,!0)}}}function fA(o,t,e,i){let r=o===0?e.inputs:e.outputs;for(let n in r)if(r.hasOwnProperty(n)){let s;o===0?s=t.inputs??={}:s=t.outputs??={},s[n]??=[],s[n].push(i),E1(t,n)}}function gA(o,t,e,i){let r=o===0?e.inputs:e.outputs;for(let n in r)if(r.hasOwnProperty(n)){let s=r[n],a;o===0?a=t.hostDirectiveInputs??={}:a=t.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,n),E1(t,s)}}function E1(o,t){t==="class"?o.flags|=8:t==="style"&&(o.flags|=16)}function vA(o,t,e){let{attrs:i,inputs:r,hostDirectiveInputs:n}=o;if(i===null||!e&&r===null||e&&n===null||jC(o)){o.initialInputs??=[],o.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let l=i[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!e&&r.hasOwnProperty(l)){let h=r[l];for(let c of h)if(c===t){s??=[],s.push(l,i[a+1]);break}}else if(e&&n.hasOwnProperty(l)){let h=n[l];for(let c=0;c<h.length;c+=2)if(h[c]===t){s??=[],s.push(h[c+1],i[a+1]);break}}a+=2}o.initialInputs??=[],o.initialInputs.push(s)}function Hj(o,t,e,i,r){o.data[i]=r;let n=r.factory||(r.factory=gu(r.type,!0)),s=new Ip(n,rl(r),On,null);o.blueprint[i]=s,e[i]=s,Vj(o,t,i,t1(o,e,r.hostVars,Uv),r)}function Vj(o,t,e,i,r){let n=r.hostBindings;if(n){let s=o.hostBindingOpCodes;s===null&&(s=o.hostBindingOpCodes=[]);let a=~t.index;_j(s)!=a&&s.push(a),s.push(e,i,n)}}function _j(o){let t=o.length;for(;t>0;){let e=o[--t];if(typeof e=="number"&&e<0)return e}return 0}function Uj(o,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=o;rl(t)&&(e[""]=o)}}function Wj(o,t,e){o.flags|=1,o.directiveStart=t,o.directiveEnd=t+e,o.providerIndexes=t}function T1(o,t,e,i,r,n,s,a){let l=t[_t],h=l.consts,c=GS(h,s),u=Aj(l,o,e,i,c);return n&&Oj(l,t,u,GS(h,a),r),u.mergedAttrs=Tv(u.mergedAttrs,u.attrs),u.attrs!==null&&pA(u,u.attrs,!1),u.mergedAttrs!==null&&pA(u,u.mergedAttrs,!0),l.queries!==null&&l.queries.elementStart(l,u),u}function A1(o,t){FB(o,t),YS(t)&&o.queries.elementEnd(t)}function qj(o,t,e){if(e===Uv)return!1;let i=o[t];return Object.is(i,e)?!1:(o[t]=e,!0)}function pC(o,t,e){return function i(r){let n=ec(o)?Ya(o.index,t):t;XC(n,5);let s=t[ds],a=mA(t,s,e,r),l=i.__ngNextListenerFn__;for(;l;)a=mA(t,s,l,r)&&a,l=l.__ngNextListenerFn__;return a}}function mA(o,t,e,i){let r=di(null);try{return ir(6,t,e),e(i)!==!1}catch(n){return lj(o,n),!1}finally{ir(7,t,e),di(r)}}function Yj(o,t,e,i,r,n,s,a){let l=cv(o),h=!1,c=null;if(!i&&l&&(c=Qj(t,e,n,o.index)),c!==null){let u=c.__ngLastListenerFn__||c;u.__ngNextListenerFn__=s,c.__ngLastListenerFn__=s,h=!0}else{let u=Mo(o,e),d=i?i(u):u;s2(e,d,n,a);let p=r.listen(d,n,a);if(!Gj(n)){let f=i?v=>i(qa(v[o.index])):o.index;L1(f,t,e,n,a,p,!1)}}return h}function Gj(o){return o.startsWith("animation")||o.startsWith("transition")}function Qj(o,t,e,i){let r=o.cleanup;if(r!=null)for(let n=0;n<r.length-1;n+=2){let s=r[n];if(s===e&&r[n+1]===i){let a=t[vu],l=r[n+2];return a&&a.length>l?a[l]:null}typeof s=="string"&&(n+=2)}return null}function L1(o,t,e,i,r,n,s){let a=t.firstCreatePass?ZS(t):null,l=$S(e),h=l.length;l.push(r,n),a&&a.push(i,o,h,(h+1)*(s?-1:1))}function yA(o,t,e,i,r,n){let s=t[e],a=t[_t],h=a.data[e].outputs[i],u=s[h].subscribe(n);L1(o.index,a,t,r,n,u,!0)}var TC=Symbol("BINDING");var AC=class extends Gv{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let e=$h(t);return new Ep(e,this.ngModule)}};function Xj(o){return Object.keys(o).map(t=>{let[e,i,r]=o[t],n={propName:e,templateName:t,isSignal:(i&Wv.SignalBased)!==0};return r&&(n.transform=r),n})}function Kj(o){return Object.keys(o).map(t=>({propName:o[t],templateName:t}))}function $j(o,t,e){let i=t instanceof ha?t:t?.injector;return i&&o.getStandaloneInjector!==null&&(i=o.getStandaloneInjector(i)||i),i?new EC(e,i):e}function Zj(o){let t=o.get(nc,null);if(t===null)throw new pi(407,!1);let e=o.get(D1,null),i=o.get(Qh,null);return{rendererFactory:t,sanitizer:e,changeDetectionScheduler:i,ngReflect:!1}}function Jj(o,t){let e=N1(o);return KA(t,e,e==="svg"?bT:e==="math"?ST:null)}function N1(o){return(o.selectors[0][0]||"div").toLowerCase()}var Ep=class extends Yv{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=Xj(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=Kj(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=v2(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,i,r,n,s){ir(22);let a=di(null);try{let l=this.componentDef,h=eH(i,l,s,n),c=$j(l,r||this.ngModule,t),u=Zj(c),d=u.rendererFactory.createRenderer(null,l),p=i?Q2(d,i,l.encapsulation,c):Jj(l,d),f=s?.some(bA)||n?.some(y=>typeof y!="function"&&y.bindings.some(bA)),v=HC(null,h,null,512|e1(l),null,null,u,d,c,null,YA(p,c,!0));v[xo]=p,bv(v);let m=null;try{let y=T1(xo,v,2,"#host",()=>h.directiveRegistry,!0,0);ZA(d,p,y),Mp(p,v),f1(h,v,y),QA(h,y,v),A1(h,y),e!==void 0&&iH(y,this.ngContentSelectors,e),m=Ya(y.index,v),v[ds]=m[ds],QC(h,v,null)}catch(y){throw m!==null&&mC(m),mC(v),y}finally{ir(23),Sv()}return new zv(this.componentType,v,!!f)}finally{di(a)}}};function eH(o,t,e,i){let r=o?["ng-version","20.3.11"]:m2(t.selectors[0]),n=null,s=null,a=0;if(e)for(let c of e)a+=c[TC].requiredVars,c.create&&(c.targetIdx=0,(n??=[]).push(c)),c.update&&(c.targetIdx=0,(s??=[]).push(c));if(i)for(let c=0;c<i.length;c++){let u=i[c];if(typeof u!="function")for(let d of u.bindings){a+=d[TC].requiredVars;let p=c+1;d.create&&(d.targetIdx=p,(n??=[]).push(d)),d.update&&(d.targetIdx=p,(s??=[]).push(d))}}let l=[t];if(i)for(let c of i){let u=typeof c=="function"?c:c.type,d=VS(u);l.push(d)}return JA(0,null,tH(n,s),1,a,l,null,null,null,[r],null)}function tH(o,t){return!o&&!t?null:e=>{if(e&1&&o)for(let i of o)i.create();if(e&2&&t)for(let i of t)i.update()}}function bA(o){let t=o[TC].kind;return t==="input"||t==="twoWay"}var zv=class extends M1{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e,i){super(),this._rootLView=e,this._hasInputBindings=i,this._tNode=uv(e[_t],xo),this.location=Mu(this._tNode,e),this.instance=Ya(this._tNode.index,e)[ds],this.hostView=this.changeDetectorRef=new xu(e,void 0),this.componentType=t}setInput(t,e){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;let r=this._rootLView,n=GC(i,r[_t],r,t,e);this.previousInputValues.set(t,e);let s=Ya(i.index,r);XC(s,1)}get injector(){return new rc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function iH(o,t,e){let i=o.projection=[];for(let r=0;r<t.length;r++){let n=e[r];i.push(n!=null&&n.length?Array.from(n):null)}}var Zn=(()=>{class o{static __NG_ELEMENT_ID__=rH}return o})();function rH(){let o=da();return F1(o,cn())}var nH=Zn,k1=class extends nH{_lContainer;_hostTNode;_hostLView;constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return Mu(this._hostTNode,this._hostLView)}get injector(){return new rc(this._hostTNode,this._hostLView)}get parentInjector(){let t=OC(this._hostTNode,this._hostLView);if(TA(t)){let e=Lv(t,this._hostLView),i=Av(t),r=e[_t].data[i+8];return new rc(r,e)}else return new rc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let e=SA(this._lContainer);return e!==null&&e[t]||null}get length(){return this._lContainer.length-fs}createEmbeddedView(t,e,i){let r,n;typeof i=="number"?r=i:i!=null&&(r=i.index,n=i.injector);let s=dA(this._lContainer,t.ssrId),a=t.createEmbeddedViewImpl(e||{},n,s);return this.insertImpl(a,r,uA(this._hostTNode,s)),a}createComponent(t,e,i,r,n,s,a){let l=t&&!EB(t),h;if(l)h=e;else{let m=e||{};h=m.index,i=m.injector,r=m.projectableNodes,n=m.environmentInjector||m.ngModuleRef,s=m.directives,a=m.bindings}let c=l?t:new Ep($h(t)),u=i||this.parentInjector;if(!n&&c.ngModule==null){let y=(l?u:this.parentInjector).get(ha,null);y&&(n=y)}let d=$h(c.componentType??{}),p=dA(this._lContainer,d?.id??null),f=p?.firstChild??null,v=c.create(u,r,f,n,s,a);return this.insertImpl(v.hostView,h,uA(this._hostTNode,p)),v}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,i){let r=t._lView;if(wT(r)){let a=this.indexOf(t);if(a!==-1)this.detach(a);else{let l=r[xn],h=new k1(l,l[ua],l[xn]);h.detach(h.indexOf(t))}}let n=this._adjustIndex(e),s=this._lContainer;return Dj(s,r,n,i),t.attachToViewContainerRef(),BS(fC(s),n,t),t}move(t,e){return this.insert(t,e)}indexOf(t){let e=SA(this._lContainer);return e!==null?e.indexOf(t):-1}remove(t){let e=this._adjustIndex(t,-1),i=MC(this._lContainer,e);i&&(up(fC(this._lContainer),e),u1(i[_t],i))}detach(t){let e=this._adjustIndex(t,-1),i=MC(this._lContainer,e);return i&&up(fC(this._lContainer),e)!=null?new xu(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function SA(o){return o[yp]}function fC(o){return o[yp]||(o[yp]=[])}function F1(o,t){let e,i=t[o.index];return Wa(i)?e=i:(e=Mj(i,t,null,o),t[o.index]=e,i1(t,e)),aH(e,t,o,i),new k1(e,o,t)}function sH(o,t){let e=o[ps],i=e.createComment(""),r=Mo(t,o),n=e.parentNode(r);return Fv(e,n,i,e.nextSibling(r),!1),i}var aH=oH;function oH(o,t,e,i){if(o[Zl])return;let r;e.type&8?r=qa(i):r=sH(t,e),o[Zl]=r}var LC=class o{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new o(this.queryList)}setDirty(){this.queryList.setDirty()}},NC=class o{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){let e=t.queries;if(e!==null){let i=t.contentQueries!==null?t.contentQueries[0]:e.length,r=[];for(let n=0;n<i;n++){let s=e.getByIndex(n),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new o(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)$C(t,e).matches!==null&&this.queries[e].setDirty()}},Pv=class{flags;read;predicate;constructor(t,e,i=null){this.flags=e,this.read=i,typeof t=="string"?this.predicate=gH(t):this.predicate=t}},kC=class o{queries;constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){let r=e!==null?e.length:0,n=this.getByIndex(i).embeddedTView(t,r);n&&(n.indexInDeclarationView=i,e!==null?e.push(n):e=[n])}return e!==null?new o(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}},FC=class o{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,e=-1){this.metadata=t,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new o(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,i=t.parent;for(;i!==null&&i.type&8&&i.index!==e;)i=i.parent;return e===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let n=i[r];this.matchTNodeWithReadOption(t,e,lH(e,n)),this.matchTNodeWithReadOption(t,e,Mv(e,t,n,!1,!1))}else i===Iu?e.type&4&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Mv(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===ih||r===Zn||r===Iu&&e.type&4)this.addMatch(e.index,-2);else{let n=Mv(e,t,r,!1,!1);n!==null&&this.addMatch(e.index,n)}else this.addMatch(e.index,i)}}addMatch(t,e){this.matches===null?this.matches=[t,e]:this.matches.push(t,e)}};function lH(o,t){let e=o.localNames;if(e!==null){for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1]}return null}function hH(o,t){return o.type&11?Mu(o,t):o.type&4?KC(o,t):null}function cH(o,t,e,i){return e===-1?hH(t,o):e===-2?uH(o,t,i):Nv(o,o[_t],e,t)}function uH(o,t,e){if(e===ih)return Mu(t,o);if(e===Iu)return KC(t,o);if(e===Zn)return F1(t,o)}function R1(o,t,e,i){let r=t[wo].queries[i];if(r.matches===null){let n=o.data,s=e.matches,a=[];for(let l=0;s!==null&&l<s.length;l+=2){let h=s[l];if(h<0)a.push(null);else{let c=n[h];a.push(cH(t,c,s[l+1],e.metadata.read))}}r.matches=a}return r.matches}function RC(o,t,e,i){let r=o.queries.getByIndex(e),n=r.matches;if(n!==null){let s=R1(o,t,r,e);for(let a=0;a<n.length;a+=2){let l=n[a];if(l>0)i.push(s[a/2]);else{let h=n[a+1],c=t[-l];for(let u=fs;u<c.length;u++){let d=c[u];d[$l]===d[xn]&&RC(d[_t],d,h,i)}if(c[Jh]!==null){let u=c[Jh];for(let d=0;d<u.length;d++){let p=u[d];RC(p[_t],p,h,i)}}}}}return i}function dH(o,t){return o[wo].queries[t].queryList}function O1(o,t,e){let i=new kv((e&4)===4);return IT(o,t,i,i.destroy),(t[wo]??=new NC).queries.push(new LC(i))-1}function pH(o,t,e){let i=Jl();return i.firstCreatePass&&(z1(i,new Pv(o,t,e),-1),(t&2)===2&&(i.staticViewQueries=!0)),O1(i,cn(),t)}function fH(o,t,e,i){let r=Jl();if(r.firstCreatePass){let n=da();z1(r,new Pv(t,e,i),n.index),vH(r,o),(e&2)===2&&(r.staticContentQueries=!0)}return O1(r,cn(),e)}function gH(o){return o.split(",").map(t=>t.trim())}function z1(o,t,e){o.queries===null&&(o.queries=new kC),o.queries.track(new FC(t,e))}function vH(o,t){let e=o.contentQueries||(o.contentQueries=[]),i=e.length?e[e.length-1]:-1;t!==i&&e.push(o.queries.length-1,t)}function $C(o,t){return o.queries.getByIndex(t)}function mH(o,t){let e=o[_t],i=$C(e,t);return i.crossesNgTemplate?RC(e,o,t,[]):R1(e,o,i,t)}var Bv=class{};var Tp=class extends Bv{injector;componentFactoryResolver=new AC(this);instance=null;constructor(t){super();let e=new Gh([...t.providers,{provide:Bv,useValue:this},{provide:Gv,useValue:this.componentFactoryResolver}],t.parent||pp(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function P1(o,t,e=null){return new Tp({providers:o,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}var yH=(()=>{class o{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let i=_S(!1,e.type),r=i.length>0?P1([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Pr({token:o,providedIn:"environment",factory:()=>new o(Ui(ha))})}return o})();function Np(o){return jv(()=>{let t=B1(o),e=oa(cs({},t),{decls:o.decls,vars:o.vars,template:o.template,consts:o.consts||null,ngContentSelectors:o.ngContentSelectors,onPush:o.changeDetection===zC.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&o.dependencies||null,getStandaloneInjector:t.standalone?r=>r.get(yH).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:o.signals??!1,data:o.data||{},encapsulation:o.encapsulation||nl.Emulated,styles:o.styles||la,_:null,schemas:o.schemas||null,tView:null,id:""});t.standalone&&n1("NgStandalone"),j1(e);let i=o.dependencies;return e.directiveDefs=CA(i,bH),e.pipeDefs=CA(i,dT),e.id=wH(e),e})}function bH(o){return $h(o)||VS(o)}function ac(o){return jv(()=>({type:o.type,bootstrap:o.bootstrap||la,declarations:o.declarations||la,imports:o.imports||la,exports:o.exports||la,transitiveCompileScopes:null,schemas:o.schemas||null,id:o.id||null}))}function SH(o,t){if(o==null)return Xl;let e={};for(let i in o)if(o.hasOwnProperty(i)){let r=o[i],n,s,a,l;Array.isArray(r)?(a=r[0],n=r[1],s=r[2]??n,l=r[3]||null):(n=r,s=r,a=Wv.None,l=null),e[n]=[i,a,l],t[n]=s}return e}function CH(o){if(o==null)return Xl;let t={};for(let e in o)o.hasOwnProperty(e)&&(t[o[e]]=e);return t}function tn(o){return jv(()=>{let t=B1(o);return j1(t),t})}function B1(o){let t={};return{type:o.type,providersResolver:null,factory:null,hostBindings:o.hostBindings||null,hostVars:o.hostVars||0,hostAttrs:o.hostAttrs||null,contentQueries:o.contentQueries||null,declaredInputs:t,inputConfig:o.inputs||Xl,exportAs:o.exportAs||null,standalone:o.standalone??!0,signals:o.signals===!0,selectors:o.selectors||la,viewQuery:o.viewQuery||null,features:o.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:SH(o.inputs,t),outputs:CH(o.outputs),debugInfo:null}}function j1(o){o.features?.forEach(t=>t(o))}function CA(o,t){return o?()=>{let e=typeof o=="function"?o():o,i=[];for(let r of e){let n=t(r);n!==null&&i.push(n)}return i}:null}function wH(o){let t=0,e=typeof o.consts=="function"?"":o.consts,i=[o.selectors,o.ngContentSelectors,o.hostVars,o.hostAttrs,e,o.vars,o.decls,o.encapsulation,o.standalone,o.signals,o.exportAs,JSON.stringify(o.inputs),JSON.stringify(o.outputs),Object.getOwnPropertyNames(o.type.prototype),!!o.contentQueries,!!o.viewQuery];for(let n of i.join("|"))t=Math.imul(31,t)+n.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function xH(o){return Object.getPrototypeOf(o.prototype).constructor}function Xr(o){let t=xH(o.type),e=!0,i=[o];for(;t;){let r;if(rl(o))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new pi(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);let s=o;s.inputs=gC(o.inputs),s.declaredInputs=gC(o.declaredInputs),s.outputs=gC(o.outputs);let a=r.hostBindings;a&&TH(o,a);let l=r.viewQuery,h=r.contentQueries;if(l&&DH(o,l),h&&EH(o,h),IH(o,r),rT(o.outputs,r.outputs),rl(r)&&r.data.animation){let c=o.data;c.animation=(c.animation||[]).concat(r.data.animation)}}let n=r.features;if(n)for(let s=0;s<n.length;s++){let a=n[s];a&&a.ngInherit&&a(o),a===Xr&&(e=!1)}}t=Object.getPrototypeOf(t)}MH(i)}function IH(o,t){for(let e in t.inputs){if(!t.inputs.hasOwnProperty(e)||o.inputs.hasOwnProperty(e))continue;let i=t.inputs[e];i!==void 0&&(o.inputs[e]=i,o.declaredInputs[e]=t.declaredInputs[e])}}function MH(o){let t=0,e=null;for(let i=o.length-1;i>=0;i--){let r=o[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Tv(r.hostAttrs,e=Tv(e,r.hostAttrs))}}function gC(o){return o===Xl?{}:o===la?[]:o}function DH(o,t){let e=o.viewQuery;e?o.viewQuery=(i,r)=>{t(i,r),e(i,r)}:o.viewQuery=t}function EH(o,t){let e=o.contentQueries;e?o.contentQueries=(i,r,n)=>{t(i,r,n),e(i,r,n)}:o.contentQueries=t}function TH(o,t){let e=o.hostBindings;e?o.hostBindings=(i,r)=>{t(i,r),e(i,r)}:o.hostBindings=t}var ZC=new Ti("");function JC(o){return!!o&&typeof o.then=="function"}function H1(o){return!!o&&typeof o.subscribe=="function"}var V1=new Ti("");var ew=(()=>{class o{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i});appInits=Si(V1,{optional:!0})??[];injector=Si(tl);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let r of this.appInits){let n=ov(this.injector,r);if(JC(n))e.push(n);else if(H1(n)){let s=new Promise((a,l)=>{n.subscribe({complete:a,error:l})});e.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),e.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),_1=new Ti("");function U1(){hS(()=>{let o="";throw new pi(600,o)})}function W1(o){return o.isBoundToModule}var AH=10;var kp=(()=>{class o{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Si(th);afterRenderManager=Si(l1);zonelessEnabled=Si(wv);rootEffectScheduler=Si(hC);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Yl;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=Si(ic);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(mS(e=>!e))}constructor(){Si(Lp,{optional:!0})}whenStable(){let e;return new Promise(i=>{e=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{e.unsubscribe()})}_injector=Si(ha);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,i){return this.bootstrapImpl(e,i)}bootstrapImpl(e,i,r=tl.NULL){return this._injector.get(Rn).run(()=>{ir(10);let s=e instanceof Yv;if(!this._injector.get(ew).done){let f="";throw new pi(405,f)}let l;s?l=e:l=this._injector.get(Gv).resolveComponentFactory(e),this.componentTypes.push(l.componentType);let h=W1(l)?void 0:this._injector.get(Bv),c=i||l.selector,u=l.create(r,[],c,h),d=u.location.nativeElement,p=u.injector.get(ZC,null);return p?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),xp(this.components,u),p?.unregisterApplication(d)}),this._loadComponent(u),ir(11,u),u})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){ir(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(_C.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new pi(101,!1);let e=di(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,di(e),this.afterTick.next(),ir(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(nc,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<AH;)ir(14),this.synchronizeOnce(),ir(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let e=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!bp(r))continue;let n=i&&!this.zonelessEnabled?0:1;S1(r,n),e=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}e||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>bp(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){let i=e;xp(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(e),this._injector.get(_1,[]).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>xp(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new pi(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function xp(o,t){let e=o.indexOf(t);e>-1&&o.splice(e,1)}var eK=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function sl(o,t,e){let i=cn(),r=OT();if(qj(i,r,t)){let n=Jl(),s=_T();Z2(s,i,o,t,i[ps],e)}return sl}function wA(o,t,e,i,r){GC(t,o,e,r?"class":"style",i)}function Du(o,t,e,i){let r=cn(),n=r[_t],s=o+xo,a=n.firstCreatePass?T1(s,r,2,t,nj,TT(),e,i):n.data[s];if(aj(a,r,o,t,LH),cv(a)){let l=r[_t];f1(l,r,a),QA(l,a,r)}return i!=null&&G2(r,a),Du}function Fp(){let o=Jl(),t=da(),e=oj(t);return o.firstCreatePass&&A1(o,e),LT(e)&&NT(),ET(),e.classesWithoutHost!=null&&OB(e)&&wA(o,e,cn(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&zB(e)&&wA(o,e,cn(),e.stylesWithoutHost,!1),Fp}function Xv(o,t,e,i){return Du(o,t,e,i),Fp(),Xv}var LH=(o,t,e,i,r)=>(YT(!0),KA(t[ps],i,UT()));function tw(){return cn()}var Rp="en-US";var NH=Rp;function q1(o){typeof o=="string"&&(NH=o.toLowerCase().replace(/_/g,"-"))}function Kv(o,t,e){let i=cn(),r=Jl(),n=da();return kH(r,i,i[ps],n,o,t,e),Kv}function kH(o,t,e,i,r,n,s){let a=!0,l=null;if((i.type&3||s)&&(l??=pC(i,t,n),Yj(i,o,t,s,e,r,n,l)&&(a=!1)),a){let h=i.outputs?.[r],c=i.hostDirectiveOutputs?.[r];if(c&&c.length)for(let u=0;u<c.length;u+=2){let d=c[u],p=c[u+1];l??=pC(i,t,n),yA(i,t,d,p,r,l)}if(h&&h.length)for(let u of h)l??=pC(i,t,n),yA(i,t,u,r,r,l)}}function Kr(o,t,e,i){fH(o,t,e,i)}function iw(o,t,e){pH(o,t,e)}function Er(o){let t=cn(),e=Jl(),i=rC();yv(i+1);let r=$C(e,i);if(o.dirty&&CT(t)===((r.metadata.flags&2)===2)){if(r.matches===null)o.reset([]);else{let n=mH(t,i);o.reset(n,KB),o.notifyOnChanges()}return!0}return!1}function Tr(){return dH(cn(),rC())}var FH=(()=>{class o{zone=Si(Rn);changeDetectionScheduler=Si(Qh);applicationRef=Si(kp);applicationErrorHandler=Si(th);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(e){this.applicationErrorHandler(e)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function Y1({ngZoneFactory:o,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return o??=()=>new Rn(oa(cs({},G1()),{scheduleInRootZone:e})),[{provide:Rn,useFactory:o},{provide:Kh,multi:!0,useFactory:()=>{let i=Si(FH,{optional:!0});return()=>i.initialize()}},{provide:Kh,multi:!0,useFactory:()=>{let i=Si(RH);return()=>{i.initialize()}}},t===!0?{provide:oC,useValue:!0}:[],{provide:lC,useValue:e??s1},{provide:th,useFactory:()=>{let i=Si(Rn),r=Si(ha),n;return s=>{i.runOutsideAngular(()=>{r.destroyed&&!n?setTimeout(()=>{throw s}):(n??=r.get(Co),n.handleError(s))})}}}]}function G1(o){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:o?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:o?.runCoalescing??!1}}var RH=(()=>{class o{subscription=new us;initialized=!1;zone=Si(Rn);pendingTasks=Si(ic);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Rn.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Rn.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Q1=(()=>{class o{applicationErrorHandler=Si(th);appRef=Si(kp);taskService=Si(ic);ngZone=Si(Rn);zonelessEnabled=Si(wv);tracing=Si(Lp,{optional:!0});disableScheduling=Si(oC,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new us;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Rv):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Si(lC,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ov||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let i=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?sA:a1;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Rv+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(e),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,sA(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function OH(){return typeof $localize<"u"&&$localize.locale||Rp}var rw=new Ti("",{providedIn:"root",factory:()=>Si(rw,{optional:!0,skipSelf:!0})||OH()});var qH=new Ti("");qH.__NG_ELEMENT_ID__=o=>{let t=da();if(t===null)throw new pi(204,!1);if(t.type&2)return t.value;if(o&8)return null;throw new pi(204,!1)};var nw=new Ti(""),YH=new Ti("");function Op(o){return!o.moduleRef}function GH(o){let t=Op(o)?o.r3Injector:o.moduleRef.injector,e=t.get(Rn);return e.run(()=>{Op(o)?o.r3Injector.resolveInjectorInitializers():o.moduleRef.resolveInjectorInitializers();let i=t.get(th),r;if(e.runOutsideAngular(()=>{r=e.onError.subscribe({next:i})}),Op(o)){let n=()=>t.destroy(),s=o.platformInjector.get(nw);s.add(n),t.onDestroy(()=>{r.unsubscribe(),s.delete(n)})}else{let n=()=>o.moduleRef.destroy(),s=o.platformInjector.get(nw);s.add(n),o.moduleRef.onDestroy(()=>{xp(o.allPlatformModules,o.moduleRef),r.unsubscribe(),s.delete(n)})}return XH(i,e,()=>{let n=t.get(ic),s=n.add(),a=t.get(ew);return a.runInitializers(),a.donePromise.then(()=>{let l=t.get(rw,Rp);if(q1(l||Rp),!t.get(YH,!0))return Op(o)?t.get(kp):(o.allPlatformModules.push(o.moduleRef),o.moduleRef);if(Op(o)){let c=t.get(kp);return o.rootComponent!==void 0&&c.bootstrap(o.rootComponent),c}else return QH?.(o.moduleRef,o.allPlatformModules),o.moduleRef}).finally(()=>void n.remove(s))})})}var QH;function XH(o,t,e){try{let i=e();return JC(i)?i.catch(r=>{throw t.runOutsideAngular(()=>o(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>o(i)),i}}var $v=null;function KH(o=[],t){return tl.create({name:t,providers:[{provide:dp,useValue:"platform"},{provide:nw,useValue:new Set([()=>$v=null])},...o]})}function $H(o=[]){if($v)return $v;let t=KH(o);return $v=t,U1(),ZH(t),t}function ZH(o){let t=o.get(Vv,null);ov(o,()=>{t?.forEach(e=>e())})}function X1(o){let{rootComponent:t,appProviders:e,platformProviders:i,platformRef:r}=o;ir(8);try{let n=r?.injector??$H(i),s=[Y1({}),{provide:Qh,useExisting:Q1},QT,...e||[]],a=new Tp({providers:s,parent:n,debugName:"",runEnvironmentInitializers:!1});return GH({r3Injector:a.injector,platformInjector:n,rootComponent:t})}catch(n){return Promise.reject(n)}finally{ir(9)}}var K1=null;function Bp(){return K1}function sw(o){K1??=o}var Pp=class{};var jp=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=ac({type:o});static \u0275inj=Ql({})}return o})();function aw(o,t){t=encodeURIComponent(t);for(let e of o.split(";")){let i=e.indexOf("="),[r,n]=i==-1?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(n)}return null}var Hp=class{};var $1="browser";var Vp=class{_doc;constructor(t){this._doc=t}manager},Zv=(()=>{class o extends Vp{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r,n){return e.addEventListener(i,r,n),()=>this.removeEventListener(e,i,r,n)}removeEventListener(e,i,r,n){return e.removeEventListener(i,r,n)}static \u0275fac=function(i){return new(i||o)(Ui(Ga))};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})(),em=new Ti(""),uw=(()=>{class o{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,i){this._zone=i,e.forEach(s=>{s.manager=this});let r=e.filter(s=>!(s instanceof Zv));this._plugins=r.slice().reverse();let n=e.find(s=>s instanceof Zv);n&&this._plugins.push(n)}addEventListener(e,i,r,n){return this._findPluginFor(i).addEventListener(e,i,r,n)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(n=>n.supports(e)),!i)throw new pi(5101,!1);return this._eventNameToPlugin.set(e,i),i}static \u0275fac=function(i){return new(i||o)(Ui(em),Ui(Rn))};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})(),ow="ng-app-id";function Z1(o){for(let t of o)t.remove()}function J1(o,t){let e=t.createElement("style");return e.textContent=o,e}function eV(o,t,e,i){let r=o.head?.querySelectorAll(`style[${ow}="${t}"],link[${ow}="${t}"]`);if(r)for(let n of r)n.removeAttribute(ow),n instanceof HTMLLinkElement?i.set(n.href.slice(n.href.lastIndexOf("/")+1),{usage:0,elements:[n]}):n.textContent&&e.set(n.textContent,{usage:0,elements:[n]})}function hw(o,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",o),e}var dw=(()=>{class o{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,i,r,n={}){this.doc=e,this.appId=i,this.nonce=r,eV(e,i,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,i){for(let r of e)this.addUsage(r,this.inline,J1);i?.forEach(r=>this.addUsage(r,this.external,hw))}removeStyles(e,i){for(let r of e)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(e,i,r){let n=i.get(e);n?n.usage++:i.set(e,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(e,this.doc)))})}removeUsage(e,i){let r=i.get(e);r&&(r.usage--,r.usage<=0&&(Z1(r.elements),i.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])Z1(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(e,J1(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(e,hw(i,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,i){return this.nonce&&i.setAttribute("nonce",this.nonce),e.appendChild(i)}static \u0275fac=function(i){return new(i||o)(Ui(Ga),Ui(Hv),Ui(_v,8),Ui(Ap))};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})(),lw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},pw=/%COMP%/g;var tL="%COMP%",tV=`_nghost-${tL}`,iV=`_ngcontent-${tL}`,rV=!0,nV=new Ti("",{providedIn:"root",factory:()=>rV});function sV(o){return iV.replace(pw,o)}function aV(o){return tV.replace(pw,o)}function iL(o,t){return t.map(e=>e.replace(pw,o))}var fw=(()=>{class o{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,i,r,n,s,a,l=null,h=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=n,this.doc=s,this.ngZone=a,this.nonce=l,this.tracingService=h,this.platformIsServer=!1,this.defaultRenderer=new _p(e,s,a,this.platformIsServer,this.tracingService)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(e,i);return r instanceof Jv?r.applyToHost(e):r instanceof Up&&r.applyStyles(),r}getOrCreateRenderer(e,i){let r=this.rendererByCompId,n=r.get(i.id);if(!n){let s=this.doc,a=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,c=this.removeStylesOnCompDestroy,u=this.platformIsServer,d=this.tracingService;switch(i.encapsulation){case nl.Emulated:n=new Jv(l,h,i,this.appId,c,s,a,u,d);break;case nl.ShadowDom:return new cw(l,h,e,i,s,a,this.nonce,u,d);default:n=new Up(l,h,i,c,s,a,u,d);break}r.set(i.id,n)}return n}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(i){return new(i||o)(Ui(uw),Ui(dw),Ui(Hv),Ui(nV),Ui(Ga),Ui(Rn),Ui(_v),Ui(Lp,8))};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})(),_p=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,i,r,n){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.tracingService=n}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(lw[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(eL(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(eL(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){e.remove()}selectRootElement(t,e){let i=typeof t=="string"?this.doc.querySelector(t):t;if(!i)throw new pi(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;let n=lw[r];n?t.setAttributeNS(n,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){let r=lw[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(sc.DashCase|sc.Important)?t.style.setProperty(e,i,r&sc.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&sc.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t!=null&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i,r){if(typeof t=="string"&&(t=Bp().getGlobalEventTarget(this.doc,t),!t))throw new pi(5102,!1);let n=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(n=this.tracingService.wrapEventListener(t,e,n)),this.eventManager.addEventListener(t,e,n,r)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;t(e)===!1&&e.preventDefault()}}};function eL(o){return o.tagName==="TEMPLATE"&&o.content!==void 0}var cw=class extends _p{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,i,r,n,s,a,l,h){super(t,n,s,l,h),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=r.styles;c=iL(r.id,c);for(let d of c){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=d,this.shadowRoot.appendChild(p)}let u=r.getExternalStyles?.();if(u)for(let d of u){let p=hw(d,n);a&&p.setAttribute("nonce",a),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Up=class extends _p{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,i,r,n,s,a,l,h){super(t,n,s,a,l),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r;let c=i.styles;this.styles=h?iL(h,c):c,this.styleUrls=i.getExternalStyles?.(h)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&wu.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Jv=class extends Up{contentAttr;hostAttr;constructor(t,e,i,r,n,s,a,l,h){let c=r+"-"+i.id;super(t,e,i,n,s,a,l,h,c),this.contentAttr=sV(c),this.hostAttr=aV(c)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}};var tm=class o extends Pp{supportsDOMEvents=!0;static makeCurrent(){sw(new o)}onAndCancel(t,e,i,r){return t.addEventListener(e,i,r),()=>{t.removeEventListener(e,i,r)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=oV();return e==null?null:lV(e)}resetBaseElement(){Wp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return aw(document.cookie,t)}},Wp=null;function oV(){return Wp=Wp||document.head.querySelector("base"),Wp?Wp.getAttribute("href"):null}function lV(o){return new URL(o,document.baseURI).pathname}var hV=(()=>{class o{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||o)};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})(),rL=["alt","control","meta","shift"],cV={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},uV={alt:o=>o.altKey,control:o=>o.ctrlKey,meta:o=>o.metaKey,shift:o=>o.shiftKey},nL=(()=>{class o extends Vp{constructor(e){super(e)}supports(e){return o.parseEventName(e)!=null}addEventListener(e,i,r,n){let s=o.parseEventName(i),a=o.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Bp().onAndCancel(e,s.domEventName,a,n))}static parseEventName(e){let i=e.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let n=o._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),rL.forEach(h=>{let c=i.indexOf(h);c>-1&&(i.splice(c,1),s+=h+".")}),s+=n,i.length!=0||n.length===0)return null;let l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(e,i){let r=cV[e.key]||e.key,n="";return i.indexOf("code.")>-1&&(r=e.code,n="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),rL.forEach(s=>{if(s!==r){let a=uV[s];a(e)&&(n+=s+".")}}),n+=r,n===i)}static eventCallback(e,i,r){return n=>{o.matchEventFullKeyCode(n,e)&&r.runGuarded(()=>i(n))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(i){return new(i||o)(Ui(Ga))};static \u0275prov=Pr({token:o,factory:o.\u0275fac})}return o})();function gw(o,t,e){let i=cs({rootComponent:o,platformRef:e?.platformRef},dV(t));return X1(i)}function dV(o){return{appProviders:[...mV,...o?.providers??[]],platformProviders:vV}}function pV(){tm.makeCurrent()}function fV(){return new Co}function gV(){return PC(document),document}var vV=[{provide:Ap,useValue:$1},{provide:Vv,useValue:pV,multi:!0},{provide:Ga,useFactory:gV}];var mV=[{provide:dp,useValue:"root"},{provide:Co,useFactory:fV},{provide:em,useClass:Zv,multi:!0,deps:[Ga]},{provide:em,useClass:nL,multi:!0,deps:[Ga]},fw,dw,uw,{provide:nc,useExisting:fw},{provide:Hp,useClass:hV},[]];var sL="ej2_instances",yV=0,bV=!1;function nm(o,t){var e=t;return e.unshift(void 0),new(Function.prototype.bind.apply(o,e))}function SV(o){var t,e=new Uint16Array(5),i=window.msCrypto||window.crypto;i.getRandomValues(e);var r="ej2"+wV(e),n=function(s){s.source===window&&typeof s.data=="string"&&s.data.length<=32&&s.data===r&&(o(),t())};return window.addEventListener("message",n,!1),window.postMessage(r,window.location.origin),t=function(){window.removeEventListener("message",n),o=n=r=void 0}}function V(o,t){for(var e=t,i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=0;r<i.length&&!Te(e);r++)e=e[i[parseInt(r.toString(),10)]];return e}function it(o,t,e){var i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=e||{},n=r,s,a=i.length,l;for(s=0;s<a;s++)l=i[parseInt(s.toString(),10)],!(l==="__proto__"||l==="constructor"||l==="prototype")&&(s+1===a?n[""+l]=t===void 0?{}:t:g(n[""+l])&&(n[""+l]={}),n=n[""+l]);return r}function Gp(o,t){delete o[""+t]}var qp=typeof window<"u"?window:{};function Ls(o){var t={};return!g(o)&&o.constructor===t.constructor}function mt(o,t){if(!g(t))for(var e=o,i=t,r=Object.keys(t),n="deepMerge",s=0,a=r;s<a.length;s++){var l=a[s];!g(e[""+n])&&e[""+n].indexOf(l)!==-1&&(Ls(i[""+l])||Array.isArray(i[""+l]))?pe(e[""+l],e[""+l],i[""+l],!0):e[""+l]=i[""+l]}}function pe(o,t,e,i){var r=o&&typeof o=="object"?o:{},n=arguments.length,s=[o,t,e,i];i&&(n=n-1);for(var a=function(h){if(!s[parseInt(h.toString(),10)])return"continue";var c=s[parseInt(h.toString(),10)];Object.keys(c).forEach(function(u){var d=r[""+u],p=c[""+u],f,v=Array.isArray(p)&&Array.isArray(d)&&p.length!==d.length,m=$e()?!(d instanceof Event)&&!v:!0;i&&m&&(Ls(p)||Array.isArray(p))?Ls(p)?(f=d||{},Array.isArray(f)&&Object.prototype.hasOwnProperty.call(f,"isComplexArray")?pe(f,{},p,i):r[""+u]=pe(f,{},p,i)):(f=$e()?d&&Object.keys(p).length:d||[],r[""+u]=pe([],f,p,f&&f.length||p&&p.length)):r[""+u]=p})},l=1;l<n;l++)a(l);return r}function g(o){return o==null}function Te(o){return typeof o>"u"}function Lt(o){return o+"_"+yV++}function sm(o,t){var e;return function(){for(var i=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var s=function(){return e=null,o.apply(i,r)};clearTimeout(e),e=setTimeout(s,t)}}function am(o,t){var e=o;return e===t?!0:e===document||!e?!1:am(e.parentNode,t)}function lc(o){try{throw new Error(o)}catch(t){throw new Error(t.message+`
`+t.stack)}}function Aw(o,t){var e=document.createElement("div"),i=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),r=[].slice.call(document.getElementsByTagName("body")[0].querySelectorAll("link, style"));if(r.length)for(var n=0,s=r.length;n<s;n++)i.push(r[parseInt(n.toString(),10)]);var a="";g(t)&&(t=window.open("","print","height=452,width=1024,tabbar=no")),e.appendChild(o.cloneNode(!0));for(var l=0,s=i.length;l<s;l++)a+=i[parseInt(l.toString(),10)].outerHTML;t.document.write("<!DOCTYPE html> <html><head>"+a+"</head><body>"+e.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),t.document.close(),t.focus();var h=setInterval(function(){t.ready&&(t.print(),t.close(),clearInterval(h))},500);return t}function Ae(o){var t=o+"";return t.match(/auto|cm|mm|in|px|pt|pc|%|em|ex|ch|rem|vw|vh|vmin|vmax/)?t:t+"px"}function $e(){return bV}function Lw(o){var t="xPath";return!(o instanceof Node)&&$e()&&!g(o[""+t])?document.evaluate(o[""+t],document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:o}function Cr(o,t){var e=typeof o=="string"?document.querySelector(o):o;if(e[""+sL])for(var i=0,r=e[""+sL];i<r.length;i++){var n=r[i];if(n instanceof t)return n}return null}function CV(){if(!(typeof window>"u")){var o=new Uint16Array(5),t=window.msCrypto||window.crypto;return t.getRandomValues(o)}}function wV(o){for(var t="",e=0;e<5;e++)t+=(e?",":"")+o[parseInt(e.toString(),10)];return t}var xV={latn:{_digits:"0123456789",_type:"numeric"}},aL={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"\u221E",nan:"NaN",exponential:"E"},oL=[0,1,2,3,4,5,6,7,8,9],Sr=(function(){function o(){}return o.getMainObject=function(t,e){var i=$e()?e:"main."+e;return V(i,t)},o.getNumberingSystem=function(t){return V("supplemental.numberingSystems",t)||this.numberingSystems},o.reverseObject=function(t,e){for(var i=e||Object.keys(t),r={},n=0,s=i;n<s.length;n++){var a=s[n];Object.prototype.hasOwnProperty.call(r,t[""+a])||(r[t[""+a]]=a)}return r},o.getSymbolRegex=function(t){var e=t.map(function(r){return r.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}).join("|"),i=RegExp;return new i(e,"g")},o.getSymbolMatch=function(t){for(var e=Object.keys(aL),i={},r=0,n=e;r<n.length;r++){var s=n[r];i[t[""+s]]=aL[""+s]}return i},o.constructRegex=function(t){for(var e=t.length,i="",r=0;r<e;r++)r!==e-1?i+=t[parseInt(r.toString(),10)]+"|":i+=t[parseInt(r.toString(),10)];return i},o.convertValueParts=function(t,e,i){return t.replace(e,function(r){return i[""+r]})},o.getDefaultNumberingSystem=function(t){var e={};return e.obj=V("numbers",t),e.nSystem=V("defaultNumberingSystem",e.obj),e},o.getCurrentNumericOptions=function(t,e,i,r){var n={},s=this.getDefaultNumberingSystem(t);if(!Te(s.nSystem)||r){var a=r?V("obj.mapperDigits",s):V(s.nSystem+"._digits",e);if(!Te(a)){n.numericPair=this.reverseObject(a,oL);var l=RegExp;n.numberParseRegex=new l(this.constructRegex(a),"g"),n.numericRegex="["+a[0]+"-"+a[9]+"]",i&&(n.numericRegex=a[0]+"-"+a[9],n.symbolNumberSystem=V(r?"numberSymbols":"symbols-numberSystem-"+s.nSystem,s.obj),n.symbolMatch=this.getSymbolMatch(n.symbolNumberSystem),n.numberSystem=s.nSystem)}}return n},o.getNumberMapper=function(t,e,i){var r={mapper:{}},n=this.getDefaultNumberingSystem(t);if(!Te(n.nSystem)){r.numberSystem=n.nSystem,r.numberSymbols=V("symbols-numberSystem-"+n.nSystem,n.obj),r.timeSeparator=V("timeSeparator",r.numberSymbols);var s=V(n.nSystem+"._digits",e);if(!Te(s))for(var a=0,l=oL;a<l.length;a++){var h=l[a];r.mapper[parseInt(h.toString(),10)]=s[parseInt(h.toString(),10)]}}return r},o.nPair="numericPair",o.nRegex="numericRegex",o.numberingSystems=xV,o})(),IV={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH\u20B5",XDR:"XDR",AED:"\u062F.\u0625.",BHD:"\u062F.\u0628.",DZD:"\u062F.\u062C.",EGP:"\u062C.\u0645.",ILS:"\u20AA",IQD:"\u062F.\u0639.",JOD:"\u062F.\u0627.",KMF:"CF",KWD:"\u062F.\u0643.",LBP:"\u0644.\u0644.",LYD:"\u062F.\u0644.",MAD:"\u062F.\u0645.",MRU:"\u0623.\u0645.",OMR:"\u0631.\u0639.",QAR:"\u0631.\u0642.",SAR:"\u0631.\u0633.",SDG:"\u062C.\u0633.",SOS:"S",SSP:"\xA3",SYP:"\u0644.\u0633.",TND:"\u062F.\u062A.",YER:"\u0631.\u064A.",CLP:"$",INR:"\u20B9",TZS:"TSh",EUR:"\u20AC",AZN:"\u20BC",RUB:"\u20BD",BYN:"Br",ZMW:"K",BGN:"\u043B\u0432.",NGN:"\u20A6",XOF:"CFA",BDT:"\u09F3",CNY:"\xA5",BAM:"\u041A\u041C",UGX:"USh",USD:"$",CZK:"K\u010D",GBP:"\xA3",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"\u0783.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"\xA3",GIP:"\xA3",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"\u20B1",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"\xA3",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"\u20A1",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"\u20B2",UYU:"$",VES:"Bs.S",IRR:"\u0631\u064A\u0627\u0644",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"\u058F",ISK:"kr",JPY:"\xA5",GEL:"\u20BE",CVE:"\u200B",KZT:"\u20B8",KHR:"\u17DB",KPW:"\u20A9",KRW:"\u20A9",KGS:"\u0441\u043E\u043C",AOA:"Kz",LAK:"\u20AD",MZN:"MTn",MKD:"\u0434\u0435\u043D",MNT:"\u20AE",BND:"$",MMK:"K",NOK:"kr",NPR:"\u0930\u0941",AWG:"Afl.",SRD:"$",PLN:"z\u0142",AFN:"\u060B",STN:"Db",MDL:"L",RON:"lei",UAH:"\u20B4",LKR:"\u0DBB\u0DD4.",ALL:"Lek\xEB",RSD:"\u0434\u0438\u043D.",TJS:"\u0441\u043C\u043D",THB:"\u0E3F",TMT:"m.",TRY:"\u20BA",UZS:"\u0441\u045E\u043C",VND:"\u20AB",TWD:"NT$"};function MV(o){return V(o||"",IV)}var Ws="USD",TL=null,AL=null;function DV(o){TL=o}function EV(o){AL=o}var lL=RegExp,hL={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}},ut;(function(o){o.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,o.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*[0# ]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,o.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var t=/[0-9]/g;o.defaultCurrency="$";var e=["infinity","nan","group","decimal"],i=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,r={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};o.dateConverterMapper=/dddd|ddd/ig;var n="sun";o.islamicRegex=/^islamic/;var s={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};o.formatRegex=new lL("(^[ncpae]{1})([0-1]?[0-9]|20)?$","i"),o.currencyFormatRegex=new lL("(^[ca]{1})([0-1]?[0-9]|20)?$","i"),o.curWithoutNumberRegex=/(c|a)$/ig;var a={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};o.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,o.basicPatterns=["short","medium","long","full"],o.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhu\u02BBl-Q.",12:"Dhu\u02BBl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabi\u02BB I",4:"Rabi\u02BB II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Sha\u02BBban",9:"Ramadan",10:"Shawwal",11:"Dhu\u02BBl-Qi\u02BBdah",12:"Dhu\u02BBl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"\u20AC","symbol-alt-narrow":"\u20AC"},GBP:{displayName:"British Pound","symbol-alt-narrow":"\xA3"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"\xD7",perMille:"\u2030",infinity:"\u221E",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"\xA4#,##0.00",accounting:"\xA4#,##0.00;(\xA4#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},o.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"\u221E"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},o.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},o.month="months",o.days="days",o.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"};function l(P,k,B,F,O){var z,Y=B||"date";if(O)z=d({skeleton:P},O).format||d({skeleton:"d"},"en-US").format;else{if(o.basicPatterns.indexOf(P)!==-1){if(z=V(Y+"Formats."+P,k),Y==="dateTime"){var K=V("dateFormats."+P,k),U=V("timeFormats."+P,k);z=z.replace("{1}",K).replace("{0}",U)}}else z=V("dateTimeFormats.availableFormats."+P,k);Te(z)&&P==="yMd"&&(z="M/d/y")}return z}o.getResultantPattern=l;function h(P,k,B,F){var O={},z=B||"gregorian";if(O.parserObject=Sr.getMainObject(P,k)||($e()?o.blazorDefaultObject:o.defaultObject),F)O.numericObject=V("numbers",O.parserObject);else{var Y=$e()?"dates":"dates.calendars."+z;O.dateObject=V(Y,O.parserObject)}return O}o.getDependables=h;function c(P,k,B,F){return V(P+"Formats-numberSystem-"+k+(F?".accounting":".standard"),B)||(F?V(P+"Formats-numberSystem-"+k+".standard",B):"")}o.getSymbolPattern=c;function u(P){var k=P.match(o.dateConverterMapper);if(k&&$e()){var B=k[0].length===3?"EEE":"EEEE";return P.replace(o.dateConverterMapper,B)}return P}o.ConvertDateToWeekFormat=u;function d(P,k){var B=P.format||P.skeleton,F=V((k||"en-US")+"."+B,hL);return F||(F=V("en-US."+B,hL)),F&&(F=u(F),P.format=F.replace(/tt/,"a")),P}o.compareBlazorDateFormats=d;function p(P){var k=P.match(o.formatRegex),B={},F=k[1].toUpperCase();return B.isAccount=F==="A",B.type=o.patternMatcher[""+F],P.length>1&&(B.fractionDigits=parseInt(k[2],10)),B}o.getProperNumericSkeleton=p;function f(P,k,B,F){var O=F?{}:{nlead:"",nend:""},z=P.match(o.customRegex);if(z){F||(O.nlead=v(z[1],B),O.nend=v(z[10],B),O.groupPattern=z[4]);var Y=z[7];if(Y&&k){var K=Y.match(t);g(K)?O.minimumFraction=0:O.minimumFraction=K.length,O.maximumFraction=Y.length-1}}return O}o.getFormatData=f;function v(P,k){return P?(P=P.replace(o.defaultCurrency,k),k===""?P.trim():P):""}o.changeCurrencySymbol=v;function m(P,k,B,F){var O=B?"."+B:".symbol",z=F?"$":V("currencies."+k+O,P)||V("currencies."+k+".symbol-alt-narrow",P)||"$";return z}o.getCurrencySymbol=m;function y(P,k,B){for(var F={},O=P.split(";"),z=["pData","nData","zeroData"],Y=0;Y<O.length;Y++)F[""+z[parseInt(Y.toString(),10)]]=b(O[parseInt(Y.toString(),10)],k,B);return g(F.nData)&&(F.nData=pe({},F.pData),F.nData.nlead=g(k)?"-"+F.nData.nlead:k.minusSymbol+F.nData.nlead),F}o.customFormat=y;function b(P,k,B){var F={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},O=P.match(o.customRegex);if(g(O)||O[5]===""&&P!=="N/A")return F.type=void 0,F;F.nlead=O[1],F.nend=O[10];var z=O[6],Y=!!z.match(/ $/g),K=z.replace(/ $/g,"").indexOf(" ")!==-1;F.useGrouping=z.indexOf(",")!==-1||K,z=z.replace(/,/g,""),z=/\s$/.test(z)?z.replace(/ /g,""):z;var U=O[7];if(z.indexOf("0")!==-1&&(F.minimumIntegerDigits=z.length-z.indexOf("0")),g(U)||(F.minimumFractionDigits=U.lastIndexOf("0"),F.maximumFractionDigits=U.lastIndexOf("#"),F.minimumFractionDigits===-1&&(F.minimumFractionDigits=0),(F.maximumFractionDigits===-1||F.maximumFractionDigits<F.minimumFractionDigits)&&(F.maximumFractionDigits=F.minimumFractionDigits)),g(k)?pe(F,S([F.nlead,F.nend],"%","%")):(k.isCustomFormat=!0,pe(F,S([F.nlead,F.nend],"$",k.currencySymbol)),F.isCurrency||pe(F,S([F.nlead,F.nend],"%",k.percentSymbol))),!g(B)){var q=c(F.type,k.numberMapper.numberSystem,B,!1);F.useGrouping&&(F.groupSeparator=K?" ":k.numberMapper.numberSymbols[e[2]],F.groupData=TL.getGroupingDetails(q.split(";")[0])),F.nlead=F.nlead.replace(/'/g,""),F.nend=Y?" "+F.nend.replace(/'/g,""):F.nend.replace(/'/g,"")}return F}o.customNumberFormat=b;function S(P,k,B){for(var F={nlead:P[0],nend:P[1]},O=0;O<2;O++){var z=P[parseInt(O.toString(),10)],Y=z.indexOf(k);if(Y!==-1&&(Y<z.indexOf("'")||Y>z.lastIndexOf("'"))){F[""+a[parseInt(O.toString(),10)]]=z.substr(0,Y)+B+z.substr(Y+1),F[""+a[""+k]]=!0,F.type=F.isCurrency?"currency":"percent";break}}return F}o.isCurrencyPercent=S;function C(P){var k=(V("dateFormats.short",P)||"").match(/[dM]([^dM])[dM]/i);return k?k[1]:"/"}o.getDateSeparator=C;function x(P,k,B,F){var O=h(B,P,k.calendar);$e()&&(k=d(k,P));var z=k.format||l(k.skeleton,O.dateObject,k.type);if(F){if(z=z.replace(i,function(he){return r[""+he]}),z.indexOf("z")!==-1){var Y=z.match(/z/g).length,K=void 0,U={timeZone:{}};U.numMapper=Sr.getNumberMapper(O.parserObject,Sr.getNumberingSystem(B)),U.timeZone=V("dates.timeZoneNames",O.parserObject);var q=new Date,ae=q.getTimezoneOffset(),te=Y<4?"+H;-H":U.timeZone.hourFormat;te=te.replace(/:/g,U.numMapper.timeSeparator),ae===0?K=U.timeZone.gmtZeroFormat:(K=AL.getTimeZoneValue(ae,te),K=U.timeZone.gmtFormat.replace(/\{0\}/,K)),z=z.replace(/[z]+/,'"'+K+'"')}z=z.replace(/ $/,"")}return z}o.getActualDateTimeFormat=x;function I(P,k){if(P.indexOf(",")!==-1){var B=P.split(",");P=B[0]+V("numberMapper.numberSymbols.group",k)+B[1].replace(".",V("numberMapper.numberSymbols.decimal",k))}else P=P.replace(".",V("numberMapper.numberSymbols.decimal",k));return P}o.processSymbol=I;function D(P,k,B,F){var O=h(B,P,"",!0),z={custom:!0},Y=O.numericObject,K,U={},q=(k.format||"").match(o.currencyFormatRegex),ae=o.formatRegex.test(k.format)?p(k.format||"N"):{},te={};if(q){te.numberMapper=$e()?pe({},O.numericObject):Sr.getNumberMapper(O.parserObject,Sr.getNumberingSystem(B),!0);var he=$e()?V("currencySymbol",O.numericObject):m(O.numericObject,k.currency||Ws,k.altSymbol),ue=c("currency",te.numberMapper.numberSystem,O.numericObject,/a/i.test(k.format));ue=ue.replace(/\u00A4/g,he);var ne=ue.split(";");U.hasNegativePattern=$e()?!0:ne.length>1,U.nData=$e()?V(ae.type+"nData",Y):f(ne[1]||"-"+ne[0],!0,he),U.pData=$e()?V(ae.type+"pData",Y):f(ne[0],!1,he),!q[2]&&!k.minimumFractionDigits&&!k.maximumFractionDigits&&(K=f(ue.split(";")[0],!0,"",!0).minimumFraction)}var le;if(o.formatRegex.test(k.format)||!k.format){if(pe(z,p(k.format||"N")),z.custom=!1,le="###0",z.fractionDigits||k.minimumFractionDigits||k.maximumFractionDigits||K){var $=0;z.fractionDigits&&(k.minimumFractionDigits=k.maximumFractionDigits=z.fractionDigits),le=M(le,K||z.fractionDigits||k.minimumFractionDigits||$,k.maximumFractionDigits||$)}if(k.minimumIntegerDigits&&(le=E(le,k.minimumIntegerDigits)),k.useGrouping&&(le=A(le)),z.type==="currency"||z.type&&$e()){$e()&&z.type!=="currency"&&(U.pData=V(z.type+"pData",Y),U.nData=V(z.type+"nData",Y));var ee=le;le=U.pData.nlead+ee+U.pData.nend,(U.hasNegativePattern||$e())&&(le+=";"+U.nData.nlead+ee+U.nData.nend)}z.type==="percent"&&!$e()&&(le+=" %")}else le=k.format.replace(/'/g,'"');return Object.keys(te).length>0&&(le=F?le:I(le,te)),le}o.getActualNumberFormat=D;function M(P,k,B){P+=".";for(var F=0;F<k;F++)P+="0";if(k<B)for(var O=B-k,z=0;z<O;z++)P+="#";return P}o.fractionDigitsPattern=M;function E(P,k){for(var B=P.split("."),F="",O=0;O<k;O++)F+="0";return B[1]?F+"."+B[1]:F}o.minimumIntegerPattern=E;function A(P){var k=P.split("."),B=k[0],F=3-B.length%3,O=F&&F===1?"#":F===2?"##":"";B=O+B,P="";for(var z=B.length-1;z>0;z=z-3)P=","+B[z-2]+B[z-1]+B[parseInt(z.toString(),10)]+P;return P=P.slice(1),k[1]?P+"."+k[1]:P}o.groupingPattern=A;function L(P,k){var B=n,F=V("supplemental.weekData.firstDay",k),O=P;return/en-/.test(O)&&(O=O.slice(3)),O=O.slice(0,2).toUpperCase()+O.substr(2),F&&(B=F[""+O]||F[O.slice(0,2)]||n),s[""+B]}o.getWeekData=L;function N(P,k,B){var F=MV(B);if(k!==F)for(var O=0,z=P;O<z.length;O++){var Y=z[O];Y.nend=Y.nend.replace(k,F),Y.nlead=Y.nlead.replace(k,F)}}o.replaceBlazorCurrency=N;function R(P,k){var B=new Date(P.getFullYear(),0,1),F=B.getDay(),O;F=F>=0?F:F+7;var z=Math.floor((P.getTime()-B.getTime()-(P.getTimezoneOffset()-B.getTimezoneOffset())*6e4)/864e5)+1;if(F<4){if(O=Math.floor((z+F-k-1)/7)+1,O>52){var Y=new Date(P.getFullYear()+1,0,1),K=Y.getDay();K=K>=0?K:K+7,O=K<4?1:53}}else O=Math.floor((z+F-k-1)/7);return O}o.getWeekOfYear=R})(ut||(ut={}));var om=(function(){function o(t,e,i){this.type="GET",this.emitError=!0,typeof t=="string"?(this.url=t,this.type=g(e)?this.type:e.toUpperCase(),this.contentType=i):Ls(t)&&Object.keys(t).length>0&&mt(this,t),this.contentType=g(this.contentType)?"application/json; charset=utf-8":this.contentType}return o.prototype.send=function(t){var e=this,i={"application/json":"json","multipart/form-data":"formData","application/octet-stream":"blob","application/x-www-form-urlencoded":"formData"};try{g(this.fetchRequest)&&this.type==="GET"?this.fetchRequest=new Request(this.url,{method:this.type}):g(this.fetchRequest)&&(this.data=g(t)?this.data:t,this.fetchRequest=new Request(this.url,{method:this.type,headers:{"Content-Type":this.contentType},body:this.data}));var r={cancel:!1,fetchRequest:this.fetchRequest};return this.triggerEvent(this.beforeSend,r),r.cancel?null:(this.fetchResponse=fetch(this.fetchRequest),this.fetchResponse.then(function(n){if(e.triggerEvent(e.onLoad,n),!n.ok)throw n;for(var s="text",a=0,l=Object.keys(i);a<l.length;a++){var h=l[a];n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf(h)!==-1&&(s=i[h])}return n[s]()}).then(function(n){return e.triggerEvent(e.onSuccess,n,e),n}).catch(function(n){var s={};return e.emitError&&(e.triggerEvent(e.onFailure,n),s=Promise.reject(n)),s}))}catch(n){return n}},o.prototype.triggerEvent=function(t,e,i){!g(t)&&typeof t=="function"&&t(e,i)},o})(),TV=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,AV=/msie|trident/i,LV=/Trident\/7\./,NV=/(ipad|iphone|ipod touch)/i,kV=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,FV=/android/i,RV=/trident|windows phone|edge/i,OV=/(version)[ /]([\w.]+)/i,vw={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};typeof window<"u"&&(window.browserDetails=window.browserDetails||{});var j=(function(){function o(){}return o.extractBrowserDetail=function(){for(var t={culture:{}},e=Object.keys(vw),i=[],r=0,n=e;r<n.length;r++){var s=n[r];if(i=o.userAgent.match(vw[""+s]),i){if(t.name=i[1].toLowerCase()==="opr"?"opera":i[1].toLowerCase(),t.name=i[1].toLowerCase()==="crios"?"chrome":t.name,t.version=i[2],t.culture.name=t.culture.language=navigator.language,o.userAgent.match(LV)){t.name="msie";break}var a=o.userAgent.match(OV);t.name==="safari"&&a&&(t.version=a[2]);break}}return t},o.getEvent=function(t){var e={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return o.isPointer?e[""+t].isPointer:o.isTouch?e[""+t].isTouch+(o.isDevice?"":" "+e[""+t].isDevice):e[""+t].isDevice},o.getTouchStartEvent=function(){return o.getEvent("start")},o.getTouchEndEvent=function(){return o.getEvent("end")},o.getTouchMoveEvent=function(){return o.getEvent("move")},o.getTouchCancelEvent=function(){return o.getEvent("cancel")},o.isSafari=function(){return o.isDevice&&o.isIos&&o.isTouch&&typeof window<"u"&&window.navigator.userAgent.toLowerCase().indexOf("iphone")===-1&&window.navigator.userAgent.toLowerCase().indexOf("safari")>-1},o.getValue=function(t,e){var i=typeof window<"u"?window.browserDetails:{};return typeof navigator<"u"&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1&&o.isTouch===!0&&!vw.CHROME.test(navigator.userAgent)&&(i.isIos=!0,i.isDevice=!0,i.isTouch=!0,i.isPointer=!0,i.isPointer="pointerEnabled"in window.navigator),typeof window<"u"&&window.Capacitor&&window.Capacitor.getPlatform()==="ios"&&(i.isPointer=!1),typeof i[""+t]>"u"?i[""+t]=e.test(o.userAgent):i[""+t]},Object.defineProperty(o,"userAgent",{get:function(){return o.uA},set:function(t){o.uA=t,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(o,"info",{get:function(){return Te(window.browserDetails.info)?window.browserDetails.info=o.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIE",{get:function(){return o.getValue("isIE",AV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isTouch",{get:function(){return Te(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isPointer",{get:function(){return Te(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isMSPointer",{get:function(){return Te(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isDevice",{get:function(){return o.getValue("isDevice",TV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIos",{get:function(){return o.getValue("isIos",NV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isIos7",{get:function(){return o.getValue("isIos7",kV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isAndroid",{get:function(){return o.getValue("isAndroid",FV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isWebView",{get:function(){return Te(window.browserDetails.isWebView)&&(window.browserDetails.isWebView=!(Te(window.cordova)&&Te(window.PhoneGap)&&Te(window.phonegap)&&window.forge!=="object")),window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(o,"isWindows",{get:function(){return o.getValue("isWindows",RV)},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchStartEvent",{get:function(){return Te(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=o.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchMoveEvent",{get:function(){return Te(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=o.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchEndEvent",{get:function(){return Te(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=o.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(o,"touchCancelEvent",{get:function(){return Te(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=o.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),o.uA=typeof navigator<"u"?navigator.userAgent:"",o})(),T=(function(){function o(){}return o.addOrGetEventData=function(t){return"__eventList"in t?t.__eventList.events:(t.__eventList={},t.__eventList.events=[])},o.add=function(t,e,i,r,n){var s=o.addOrGetEventData(t),a;n?a=sm(i,n):a=i,r&&(a=a.bind(r));for(var l=e.split(" "),h=0;h<l.length;h++)s.push({name:l[parseInt(h.toString(),10)],listener:i,debounce:a}),j.isIE?t.addEventListener(l[parseInt(h.toString(),10)],a):t.addEventListener(l[parseInt(h.toString(),10)],a,{passive:!1});return a},o.remove=function(t,e,i){for(var r=o.addOrGetEventData(t),n=e.split(" "),s=function(l){var h=-1,c;r&&r.length!==0&&r.some(function(u,d){return u.name===n[parseInt(l.toString(),10)]&&u.listener===i?(h=d,c=u.debounce,!0):!1}),h!==-1&&r.splice(h,1),c&&t.removeEventListener(n[parseInt(l.toString(),10)],c)},a=0;a<n.length;a++)s(a)},o.clearEvents=function(t){for(var e=o.addOrGetEventData(t),i=pe([],void 0,e),r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)];t.removeEventListener(n.name,n.debounce),e.shift()}},o.trigger=function(t,e,i){for(var r=o.addOrGetEventData(t),n=0,s=r;n<s.length;n++){var a=s[n];a.name===e&&a.debounce.call(this,i)}},o})();var zV=/^svg|^path|^g/;function et(o,t){var e=zV.test(o)?document.createElementNS("http://www.w3.org/2000/svg",o):document.createElement(o);return typeof t>"u"||(e.innerHTML=t.innerHTML?t.innerHTML:"",t.className!==void 0&&(e.className=t.className),t.id!==void 0&&(e.id=t.id),t.styles!==void 0&&(e.style.cssText=t.styles),t.attrs!==void 0&&Ee(e,t.attrs)),e}function X(o,t){for(var e=LL(t),i=RegExp,r=0,n=o;r<n.length;r++)for(var s=n[r],a=0,l=e;a<l.length;a++){var h=l[a];if(Ls(s)){var c=V("attributes.className",s);g(c)?it("attributes.className",h,s):new i("\\b"+h+"\\b","i").test(c)||it("attributes.className",c+" "+h,s)}else s.classList.contains(h)||s.classList.add(h)}return o}function Z(o,t){for(var e=LL(t),i=0,r=o;i<r.length;i++){var n=r[i],s=Ls(n),a=s?V("attributes.className",n):n.className!=="";if(a)for(var l=0,h=e;l<h.length;l++){var c=h[l];if(s){var u=V("attributes.className",n),d=u.split(" "),p=d.indexOf(c);p!==-1&&d.splice(p,1),it("attributes.className",d.join(" "),n)}else n.classList.remove(c)}}return o}function LL(o){var t=[];return typeof o=="string"?t.push(o):t=o,t}function wr(o){var t=o;return t.style.visibility===""&&t.offsetWidth>0}function $r(o,t,e){for(var i=document.createDocumentFragment(),r=0,n=o;r<n.length;r++){var s=n[r];i.appendChild(s)}return t.insertBefore(i,t.firstElementChild),e&&NL(t),o}function bt(o,t,e){var i=document.createDocumentFragment();if(o instanceof NodeList)for(;o.length>0;)i.appendChild(o[0]);else for(var r=0,n=o;r<n.length;r++){var s=n[r];i.appendChild(s)}return t.appendChild(i),e&&NL(t),o}function NL(o){var t=o.querySelectorAll("script");t.forEach(function(e){var i=document.createElement("script");i.text=e.innerHTML,document.head.appendChild(i),se(i)})}function se(o){var t=o.parentNode;if(t)return t.removeChild(o)}function Qe(o){var t=o.parentNode;T.clearEvents(o),t.removeChild(o)}function Ee(o,t){for(var e=Object.keys(t),i=o,r=0,n=e;r<n.length;r++){var s=n[r];if(Ls(i)){var a=s;s==="tabindex"&&(a="tabIndex"),i.attributes[""+a]=t[""+s]}else i.setAttribute(s,t[""+s])}return i}function J(o,t,e){return t===void 0&&(t=document),o=kL(o),t.querySelector(o)}function ze(o,t,e){t===void 0&&(t=document),o=kL(o);var i=t.querySelectorAll(o);return i}function kL(o){var t=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(o.match(/#[0-9]/g)||o.match(t)){for(var e=o.split(","),i=0;i<e.length;i++){for(var r=e[parseInt(i.toString(),10)].split(" "),n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].indexOf("#")>-1&&!r[parseInt(n.toString(),10)].match(/\[.*\]/)){var s=r[parseInt(n.toString(),10)].split("#");if(s[1].match(/^\d/)||s[1].match(t)){var a=r[parseInt(n.toString(),10)].split(".");a[0]=a[0].replace(/#/,"[id='")+"']",r[parseInt(n.toString(),10)]=a.join(".")}}e[parseInt(i.toString(),10)]=r.join(" ")}return e.join(",")}return o}function H(o,t){var e=o;if(typeof e.closest=="function")return e.closest(t);for(;e&&e.nodeType===1;){if(Fu(e,t))return e;e=e.parentNode}return null}function Ze(o,t){t!==void 0&&Object.keys(t).forEach(function(e){o.style[""+e]=t[""+e]})}function Ai(o,t,e){X([o],t),Z([o],e)}function Fu(o,t){var e=o.matches||o.msMatchesSelector||o.webkitMatchesSelector;return e?e.call(o,t):[].indexOf.call(document.querySelectorAll(t),o)!==-1}var Lu=(function(){function o(t){this.ranArray=[],this.boundedEvents={},!g(t)&&(this.context=t)}return o.prototype.on=function(t,e,i,r){if(!g(e)){var n=i||this.context;if(this.notExist(t)){this.boundedEvents[""+t]=[{handler:e,context:n,id:r}];return}g(r)?this.isHandlerPresent(this.boundedEvents[""+t],e)||this.boundedEvents[""+t].push({handler:e,context:n}):this.ranArray.indexOf(r)===-1&&(this.ranArray.push(r),this.boundedEvents[""+t].push({handler:e,context:n,id:r}))}},o.prototype.off=function(t,e,i){if(!this.notExist(t)){var r=V(t,this.boundedEvents);if(e){for(var n=0;n<r.length;n++)if(i){if(r[parseInt(n.toString(),10)].id===i){r.splice(n,1);var s=this.ranArray.indexOf(i);s!==-1&&this.ranArray.splice(s,1);break}}else if(e===r[parseInt(n.toString(),10)].handler){r.splice(n,1);break}}else delete this.boundedEvents[""+t]}},o.prototype.notify=function(t,e,i,r){if(this.notExist(t)){i&&i.call(this,e);return}e&&(e.name=t);var n="Blazor",s=V(t,this.boundedEvents).slice(0);if(window[""+n])return this.blazorCallback(s,e,i,r,0);for(var a=0,l=s;a<l.length;a++){var h=l[a];h.handler.call(h.context,e)}i&&i.call(this,e)},o.prototype.blazorCallback=function(t,e,i,r,n){var s=this,a=n===t.length-1;if(n<t.length){var l=t[parseInt(n.toString(),10)],h=l.handler.call(l.context,e);if(h&&typeof h.then=="function"){if(!i)return h;h.then(function(c){if(c=typeof c=="string"&&s.isJson(c)?JSON.parse(c,s.dateReviver):c,pe(e,e,c,!0),i&&a)i.call(l.context,e);else return s.blazorCallback(t,e,i,r,n+1)}).catch(function(c){r&&r.call(l.context,typeof c=="string"&&s.isJson(c)?JSON.parse(c,s.dateReviver):c)})}else if(i&&a)i.call(l.context,e);else return this.blazorCallback(t,e,i,r,n+1)}},o.prototype.dateReviver=function(t,e){var i=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/;return $e&&typeof e=="string"&&e.match(i)!==null?new Date(e):e},o.prototype.isJson=function(t){try{JSON.parse(t)}catch{return!1}return!0},o.prototype.destroy=function(){this.boundedEvents=this.context=void 0},o.prototype.offIntlEvents=function(){var t=this.boundedEvents.notifyExternalChange;if(t){for(var e=0;e<t.length;e++){var i=t[parseInt(e.toString(),10)].context;i&&i.detectFunction&&i.randomId&&i.isReactMock&&(this.off("notifyExternalChange",i.detectFunction,i.randomId),e--)}this.boundedEvents.notifyExternalChange.length||delete this.boundedEvents.notifyExternalChange}},o.prototype.notExist=function(t){return Object.prototype.hasOwnProperty.call(this.boundedEvents,t)===!1||this.boundedEvents[""+t].length<=0},o.prototype.isHandlerPresent=function(t,e){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n.handler===e)return!0}return!1},o})(),PV=new RegExp("]"),pa=(function(){function o(t,e){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new Lu(this),Te(e)||(typeof e=="string"?this.element=document.querySelector(e):this.element=e,g(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),Te(t)||this.setProperties(t,!0),this.isDestroyed=!1}return o.prototype.setProperties=function(t,e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!e,mt(this,t),e!==!0?(mt(this.changedProperties,t),this.dataBind()):$e()&&this.isRendered&&this.serverDataBind(t),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},o.callChildDataBind=function(t,e){for(var i=Object.keys(t),r=0,n=i;r<n.length;r++){var s=n[r];if(e[""+s]instanceof Array)for(var a=0,l=e[""+s];a<l.length;a++){var h=l[a];h.dataBind!==void 0&&h.dataBind()}else e[""+s].dataBind()}},o.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},o.prototype.dataBind=function(){if(o.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var t=this.isProtectedOnChange,e=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(e,i),this.isProtectedOnChange=t}},o.prototype.serverDataBind=function(t){if($e()){t=t||{},pe(this.bulkChanges,{},t,!0);var e="sfBlazor";this.allowServerDataBinding&&window[""+e].updateModel&&(window[""+e].updateModel(this),this.bulkChanges={})}},o.prototype.saveChanges=function(t,e,i){if($e()){var r={};r[""+t]=e,this.serverDataBind(r)}this.isProtectedOnChange||(this.oldProperties[""+t]=i,this.changedProperties[""+t]=e,this.finalUpdate(),this.finalUpdate=SV(this.dataBind.bind(this)))},o.prototype.addEventListener=function(t,e){this.modelObserver.on(t,e)},o.prototype.removeEventListener=function(t,e){this.modelObserver.off(t,e)},o.prototype.trigger=function(t,e,i,r){var n=this;if(this.isDestroyed!==!0){var s=this.isProtectedOnChange;this.isProtectedOnChange=!1;var a=this.modelObserver.notify(t,e,i,r);if(PV.test(t)){var l=V(t,this);if(l){var h="Blazor";if(window[""+h]){var c=l.call(this,e);c&&typeof c.then=="function"?i?c.then(function(u){i&&(u=typeof u=="string"&&n.modelObserver.isJson(u)?JSON.parse(u):u,i.call(n,u))}).catch(function(u){r&&(u=typeof u=="string"&&n.modelObserver.isJson(u)?JSON.parse(u):u,r.call(n,u))}):a=c:i&&i.call(this,e)}else l.call(this,e),i&&i.call(this,e)}else i&&i.call(this,e)}return this.isProtectedOnChange=s,a}},o.prototype.addInstance=function(){var t="e-"+this.getModuleName().toLowerCase();X([this.element],["e-lib",t]),g(this.element.ej2_instances)?it("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},o.prototype.destroy=function(){var t=this;this.element.ej2_instances=this.element.ej2_instances?this.element.ej2_instances.filter(function(e){return mw?mw(e)!==mw(t):e!==t}):[],Z([this.element],["e-"+this.getModuleName()]),this.element.ej2_instances.length===0&&Z([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},o})();function ot(o,t){var e,i,r=typeof o=="string"?document.getElementById(o):o;if(r&&r.ej2_instances){for(i=0;i<r.ej2_instances.length;i++)if(e=r.ej2_instances[parseInt(i.toString(),10)],typeof t=="string"){var n=e.getModuleName();if(t===n)return e}else if(e instanceof t)return e}}var mw;function FL(o,t,e,i){return(!Object.prototype.hasOwnProperty.call(o.properties,t)||!(o.properties[""+t]instanceof i))&&(o.properties[""+t]=nm(i,[o,t,e])),o.properties[""+t]}function xw(o,t,e,i,r,n){for(var s=[],a=e?e.length:0,l=0;l<a;l++){var h=i;if(n&&(h=i(e[parseInt(l.toString(),10)],o)),r){var c=nm(h,[o,t,{},!0]);c.setProperties(e[parseInt(l.toString(),10)],!0),s.push(c)}else s.push(nm(h,[o,t,e[parseInt(l.toString(),10)],!1]))}return s}function RL(o,t){return function(){return Object.prototype.hasOwnProperty.call(this.properties,t)||(this.properties[""+t]=o),this.properties[""+t]}}function BV(o,t){return function(e){if(this.properties[""+t]!==e){var i=Object.prototype.hasOwnProperty.call(this.properties,t)?this.properties[""+t]:o;this.saveChanges(t,e,i),this.properties[""+t]=e}}}function jV(o,t,e){return function(){return FL(this,t,o,e)}}function HV(o,t,e){return function(i){FL(this,t,o,e).setProperties(i)}}function VV(o,t,e){return function(){var i=this;if(!Object.prototype.hasOwnProperty.call(this.properties,t)){var r=xw(this,t,o,e,!1);this.properties[""+t]=r}var n=this.controlParent!==void 0&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return!Object.prototype.hasOwnProperty.call(this.properties[""+t],"push")&&!n&&["push","pop"].forEach(function(s){var a={value:UV(s,t,e,i.properties[""+t]).bind(i),configurable:!0};Object.defineProperty(i.properties[""+t],s,a)}),Object.prototype.hasOwnProperty.call(this.properties[""+t],"isComplexArray")||Object.defineProperty(this.properties[""+t],"isComplexArray",{value:!0}),this.properties[""+t]}}function _V(o,t,e){return function(i){this.isComplexArraySetter=!0;var r=xw(this,t,o,e,!1),n=xw(this,t,i,e,!0);this.isComplexArraySetter=!1,this.saveChanges(t,n,r),this.properties[""+t]=n}}function UV(o,t,e,i){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var s=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(o){case"push":for(var a=0;a<r.length;a++){var l=r[parseInt(a.toString(),10)];Array.prototype[""+o].apply(i,[l]);var h=cL(s+(i.length-1),l,!this.controlParent,o);this.serverDataBind(h,r[parseInt(a.toString(),10)],!1,o)}break;case"pop":{Array.prototype[""+o].apply(i);var h=cL(s+i.length,null,!this.controlParent,o);this.serverDataBind(h,{ejsAction:"pop"},!1,o);break}}return i}}function cL(o,t,e,i){var r=o;if(e&&(r={},r[""+o]=t,t&&typeof t=="object")){var n="ejsAction";r[""+o][""+n]=i}return r}function w(o){return function(t,e){var i={set:BV(o,e),get:RL(o,e),enumerable:!0,configurable:!0};Object.defineProperty(t,e,i),lm(t,e,"prop",o)}}function Ce(o,t){return function(e,i){var r={set:HV(o,i,t),get:jV(o,i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,r),lm(e,i,"complexProp",o,t)}}function Gt(o,t){return function(e,i){var r={set:_V(o,i,t),get:VV(o,i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,r),lm(e,i,"colProp",o,t)}}function G(){return function(o,t){var e={set:function(i){var r=this.properties[""+t];if(r!==i){var n=OL(this,t);Te(r)===!1&&n.context.removeEventListener(n.prefix,r),n.context.addEventListener(n.prefix,i),this.properties[""+t]=i}},get:RL(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(o,t,e),lm(o,t,"event")}}function It(o){}function lm(o,t,e,i,r){Te(o.propList)&&(o.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),o.propList[e+"s"].push({propertyName:t,defaultValue:i,type:r}),o.propList[e+"Names"].push(t)}function OL(o,t){if(Object.prototype.hasOwnProperty.call(o,"parentObj")===!1)return{context:o,prefix:t};var e=V("propName",o);return e&&(t=e+"-"+t),OL(V("parentObj",o),t)}var WV=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),al=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Mt=(function(o){WV(t,o);function t(i){var r=o.call(this,i,void 0)||this;return r.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},r}e=t,t.prototype.animate=function(i,r){r=r||{};var n=this.getModel(r);if(typeof i=="string")for(var s=Array.prototype.slice.call(ze(i,document)),a=0,l=s;a<l.length;a++){var h=l[a];n.element=h,e.delayAnimation(n)}else n.element=i,e.delayAnimation(n)},t.stop=function(i,r){i.style.animation="",i.removeAttribute("e-animate");var n=i.getAttribute("e-animation-id");if(n){var s=parseInt(n,10);cancelAnimationFrame(s),i.removeAttribute("e-animation-id")}r&&r.end&&r.end.call(this,r)},t.delayAnimation=function(i){Yt==="Disable"||Yt===BL.Disable?(i.begin&&i.begin.call(this,i),i.end&&i.end.call(this,i)):i.delay?setTimeout(function(){e.applyAnimation(i)},i.delay):e.applyAnimation(i)},t.applyAnimation=function(i){var r=this;i.timeStamp=0;var n=0,s=0,a=0,l=i.duration;i.element.setAttribute("e-animate","true");var h=function(c){try{if(c){a=a===0?c:a,i.timeStamp=c+i.timeStamp-a,a=c,!n&&i.begin&&i.begin.call(r,i),n=n+1;var u=i.timeStamp/n;i.timeStamp<l&&i.timeStamp+u<l&&i.element.getAttribute("e-animate")?(i.element.style.animation=i.name+" "+i.duration+"ms "+i.timingFunction,i.progress&&i.progress.call(r,i),requestAnimationFrame(h)):(cancelAnimationFrame(s),i.element.removeAttribute("e-animation-id"),i.element.removeAttribute("e-animate"),i.element.style.animation="",i.end&&i.end.call(r,i))}else s=requestAnimationFrame(h),i.element.setAttribute("e-animation-id",s.toString())}catch(d){cancelAnimationFrame(s),i.element.removeAttribute("e-animation-id"),i.fail&&i.fail.call(r,d)}};h()},t.prototype.getModel=function(i){return{name:i.name||this.name,delay:i.delay||this.delay,duration:i.duration!==void 0?i.duration:this.duration,begin:i.begin||this.begin,end:i.end||this.end,fail:i.fail||this.fail,progress:i.progress||this.progress,timingFunction:this.easing[i.timingFunction]?this.easing[i.timingFunction]:i.timingFunction||this.easing[this.timingFunction]}},t.prototype.onPropertyChanged=function(i,r){},t.prototype.getModuleName=function(){return"animation"},t.prototype.destroy=function(){};var e;return al([w("FadeIn")],t.prototype,"name",void 0),al([w(400)],t.prototype,"duration",void 0),al([w("ease")],t.prototype,"timingFunction",void 0),al([w(0)],t.prototype,"delay",void 0),al([G()],t.prototype,"progress",void 0),al([G()],t.prototype,"begin",void 0),al([G()],t.prototype,"end",void 0),al([G()],t.prototype,"fail",void 0),t=e=al([It],t),t})(pa);function Wi(o,t,e){var i=qV(t);return i.rippleFlag===!1||i.rippleFlag===void 0&&!Xa?function(){}:(o.setAttribute("data-ripple","true"),T.add(o,"mousedown",uL,{parent:o,rippleOptions:i}),T.add(o,"mouseup",dL,{parent:o,rippleOptions:i,done:e}),T.add(o,"mouseleave",Au,{parent:o,rippleOptions:i}),j.isPointer&&T.add(o,"transitionend",Au,{parent:o,rippleOptions:i}),function(){o.removeAttribute("data-ripple"),T.remove(o,"mousedown",uL),T.remove(o,"mouseup",dL),T.remove(o,"mouseleave",Au),T.remove(o,"transitionend",Au)})}function qV(o){var t={selector:o&&o.selector?o.selector:null,ignore:o&&o.ignore?o.ignore:null,rippleFlag:o&&o.rippleFlag,isCenterRipple:o&&o.isCenterRipple,duration:o&&o.duration?o.duration:350};return t}function uL(o){var t=o.target,e=this.rippleOptions.selector,i=e?H(t,e):t;if(!(!i||this.rippleOptions&&H(t,this.rippleOptions.ignore))){var r=i.getBoundingClientRect(),n=o.pageX-document.body.scrollLeft,s=o.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(n-r.left),Math.abs(n-r.right)),l=Math.max(Math.abs(s-r.top),Math.abs(s-r.bottom)),h=Math.sqrt(a*a+l*l),c=h*2+"px",u=n-r.left-h,d=s-r.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(u=0,d=0,c="100%"),i.classList.add("e-ripple");var p=this.rippleOptions.duration.toString(),f="width: "+c+";height: "+c+";left: "+u+"px;top: "+d+"px;transition-duration: "+p+"ms;",v=et("div",{className:"e-ripple-element",styles:f});i.appendChild(v),window.getComputedStyle(v).getPropertyValue("opacity"),v.style.transform="scale(1)",i!==this.parent&&T.add(i,"mouseleave",Au,{parent:this.parent,rippleOptions:this.rippleOptions})}}function dL(o){zL(o,this)}function Au(o){zL(o,this)}function zL(o,t){var e=t.rippleOptions.duration,i=o.target,r=t.rippleOptions.selector,n=r?H(i,r):i;if(!(!n||n&&n.className.indexOf("e-ripple")===-1)){var s=ze(".e-ripple-element",n),a=s[s.length-1];a&&(a.style.opacity="0.5"),t.parent!==n&&T.remove(n,"mouseleave",Au),setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a),n.getElementsByClassName("e-ripple-element").length||n.classList.remove("e-ripple"),t.done&&t.done(o)},e)}}var Xa=!1;function PL(o){return Xa=o,Xa}var Yt;var BL=(function(o){return o.Default="Default",o.Enable="Enable",o.Disable="Disable",o})(BL||{}),YV="Module",GV=(function(){function o(t){this.loadedModules=[],this.parent=t}return o.prototype.inject=function(t,e){var i=t.length;if(i===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(t);for(var r=0;r<i;r++)for(var n=t[parseInt(r.toString(),10)],s=0,a=e;s<a.length;s++){var l=a[s],h=n.member;if(l&&l.prototype.getModuleName()===n.member&&!this.isModuleLoaded(h)){var c=nm(l,n.args),u=this.getMemberName(h);n.isProperty?it(u,l,this.parent):it(u,c,this.parent);var d=n;d.member=u,this.loadedModules.push(d)}}},o.prototype.clean=function(){for(var t=0,e=this.loadedModules;t<e.length;t++){var i=e[t];i.isProperty||V(i.member,this.parent).destroy()}this.loadedModules=[]},o.prototype.getNonInjectedModules=function(t){var e=this;return t.filter(function(i){return!e.isModuleLoaded(i.member)})},o.prototype.clearUnusedModule=function(t){for(var e=this,i=t.map(function(l){return e.getMemberName(l.member)}),r=this.loadedModules.filter(function(l){return i.indexOf(l.member)===-1}),n=0,s=r;n<s.length;n++){var a=s[n];a.isProperty||V(a.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(a),1),Gp(this.parent,a.member)}},o.prototype.getMemberName=function(t){return t[0].toLowerCase()+t.substring(1)+YV},o.prototype.isModuleLoaded=function(t){for(var e=0,i=this.loadedModules;e<i.length;e++){var r=i[e];if(r.member===this.getMemberName(t))return!0}return!1},o})(),Oe=(function(){function o(t,e,i,r){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=V("callChildDataBind",pa),this.parentObj=t,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=e,this.isParentArray=r,this.setProperties(i,!0)}return o.prototype.updateChange=function(t,e){t===!0?this.parentObj.childChangedProperties[""+e]=t:delete this.parentObj.childChangedProperties[""+e],this.parentObj.updateChange&&this.parentObj.updateChange(t,this.parentObj.propName)},o.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var t=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),e=function(){clearTimeout(t)};this.finalUpdate=e}},o.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},o.prototype.setProperties=function(t,e){e===!0?(mt(this,t),this.updateChange(!1,this.propName),this.clearChanges()):mt(this,t)},o.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var t=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(it(this.propName+"."+t,this.changedProperties,this.parentObj.changedProperties),it(this.propName+"."+t,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},o.prototype.saveChanges=function(t,e,i,r){this.controlParent.isProtectedOnChange||(r||this.serverDataBind(t,e,!0),this.oldProperties[""+t]=i,this.changedProperties[""+t]=e,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},o.prototype.serverDataBind=function(t,e,i,r){if($e()&&!this.parentObj.isComplexArraySetter){var n,s={},a=i?this.getParentKey(!0)+"."+t:t;if(a.indexOf(".")!==-1){var l=a.split(".");n=s;for(var h=0;h<l.length;h++){var c=h===l.length-1;n[l[parseInt(h.toString(),10)]]=c?e:{},n=c?n:n[l[parseInt(h.toString(),10)]]}}else s[""+a]={},n=s[""+a],s[""+a][""+t]=e;if(this.isParentArray){var u="ejsAction";n[""+u]=r||"none"}this.controlParent.serverDataBind(s)}},o.prototype.getParentKey=function(t){var e="",i=this.propName;if(this.isParentArray){e=this.parentObj[this.propName].indexOf(this);var r=this.parentObj[this.propName].length;r=t?r:r>0?r-1:0,e=e!==-1?"-"+e:"-"+r,i=i+e}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+e),i},o})(),Nu;(function(o){var t=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];function e(r){var n=r.getDate(),s=r.getMonth(),a=r.getFullYear(),l=s+1,h=a;l<3&&(h-=1,l+=12);var c=Math.floor(h/100),u=c-Math.floor(c/4)-2,d=Math.floor(365.25*(h+4716))+Math.floor(30.6001*(l+1))+n-u-1524;c=Math.floor((d-186721625e-2)/36524.25),u=c-Math.floor(c/4)+1;var p=d+u+1524,f=Math.floor((p-122.1)/365.25),v=Math.floor(365.25*f),m=Math.floor((p-v)/30.6001);n=p-v-Math.floor(30.6001*m),s=Math.floor((p-v)/20.6001),s>13&&(f+=1,s-=12),s-=1,a=f-4716;var y=d-24e5,b=10631/30,S=d-1948084,C=Math.floor(S/10631);S=S-10631*C;var x=Math.floor((S-.1335)/b),I=30*C+x;S=S-Math.floor(x*b+.1335);var D=Math.floor((S+28.5001)/29.5);D===13&&(D=12);for(var M=S-Math.floor(29.5001*D-29),E=0;E<t.length&&!(t[parseInt(E.toString(),10)]>y);E++);var A=E+16260,L=Math.floor((A-1)/12),N=L+1,R=A-12*L,P=y-t[E-1]+1;return(P+"").length>2&&(P=M,R=D,N=I),{year:N,month:R,date:P}}o.getHijriDate=e;function i(r,n,s){var a=r,l=n,h=s,c=a-1,u=c*12+1+(l-1),d=u-16260,p=h+t[d-1]-1,f=p+24e5,v=Math.floor(f+.5),m=Math.floor((v-186721625e-2)/36524.25);m=v+1+m-Math.floor(m/4);var y=m+1524,b=Math.floor((y-122.1)/365.25),S=Math.floor(365.25*b),C=Math.floor((y-S)/30.6001),x=y-S-Math.floor(C*30.6001),I=C-(C>13.5?13:1),D=b-(I>2.5?4716:4715);return D<=0&&I--,new Date(D+"/"+I+"/"+x)}o.toGregorian=i})(Nu||(Nu={}));var QV=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,pL="stand-alone",XV=["sun","mon","tue","wed","thu","fri","sat"],fL={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"},KV={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era",f:"milliseconds"},$V="timeSeparator",jL=(function(){function o(){}return o.dateFormat=function(t,e,i){var r=this,n=ut.getDependables(i,t,e.calendar),s=V("parserObject.numbers",n),a=n.dateObject,l={isIslamic:ut.islamicRegex.test(e.calendar)};l.firstDayOfWeek=ut.getWeekData(t,i),$e()&&e.isServerRendered&&(e=ut.compareBlazorDateFormats(e,t));var h=e.format||ut.getResultantPattern(e.skeleton,n.dateObject,e.type,!1,$e()?t:"");if(l.dateSeperator=$e()?V("dateSeperator",a):ut.getDateSeparator(n.dateObject),Te(h))lc("Format options or type given must be invalid");else{h=ut.ConvertDateToWeekFormat(h),$e()&&(h=h.replace(/tt/,"a")),l.pattern=h,l.numMapper=$e()?pe({},s):Sr.getNumberMapper(n.parserObject,Sr.getNumberingSystem(i));for(var c=h.match(QV)||[],u=0,d=c;u<d.length;u++){var p=d[u],f=p.length,v=p[0];switch(v==="K"&&(v="h"),v){case"E":case"c":$e()?l.weekday=V("days."+ut.monthIndex[""+f],a):l.weekday=n.dateObject[""+ut.days][""+pL][ut.monthIndex[""+f]];break;case"M":case"L":$e()?l.month=V("months."+ut.monthIndex[""+f],a):l.month=n.dateObject[""+ut.month][""+pL][ut.monthIndex[""+f]];break;case"a":l.designator=$e()?V("dayPeriods",a):V("dayPeriods.format.wide",a);break;case"G":{var m=f<=3?"eraAbbr":f===4?"eraNames":"eraNarrow";l.era=$e()?V("eras",a):V("eras."+m,n.dateObject);break}case"z":l.timeZone=V("dates.timeZoneNames",n.parserObject);break}}}return function(y){return isNaN(y.getDate())?null:r.intDateFormatter(y,l)}},o.intDateFormatter=function(t,e){for(var i=e.pattern,r="",n=i.match(ut.dateParseRegex),s=this.getCurrentDateValue(t,e.isIslamic),a=0,l=n;a<l.length;a++){var h=l[a],c=h.length,u=h[0];u==="K"&&(u="h");var d=void 0,p="",f=void 0,v=void 0,m="";switch(u){case"M":case"L":d=s.month,c>2?r+=e.month[""+d]:f=!0;break;case"E":case"c":r+=e.weekday[""+XV[t.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(f=!0,u==="d")d=s.date;else if(u==="f"){f=!1,v=!0,p=t[""+fL[""+u]]().toString(),p=p.substring(0,c);var y=p.length;if(c!==y){if(c>3)continue;for(var b=0;b<c-y;b++)p="0"+p.toString()}m+=p}else d=t[""+fL[""+u]]();u==="h"&&(d=d%12||12);break;case"y":v=!0,m+=s.year,c===2&&(m=m.substr(m.length-2));break;case"a":{var S=t.getHours()<12?"am":"pm";r+=e.designator[""+S];break}case"G":{var C=t.getFullYear()<0?0:1,x=e.era[""+C];g(x)&&(x=e.era[C?0:1]),r+=x||"";break}case"'":r+=h==="''"?"'":h.replace(/'/g,"");break;case"z":{var I=t.getTimezoneOffset(),D=c<4?"+H;-H":e.timeZone.hourFormat;D=D.replace(/:/g,e.numMapper.timeSeparator),I===0?r+=e.timeZone.gmtZeroFormat:(v=!0,m=this.getTimeZoneValue(I,D)),m=e.timeZone.gmtFormat.replace(/\{0\}/,m);break}case":":r+=e.numMapper.numberSymbols[""+$V];break;case"/":r+=e.dateSeperator;break;case"W":f=!0,d=ut.getWeekOfYear(t,e.firstDayOfWeek);break;default:r+=h}f&&(v=!0,m=this.checkTwodigitNumber(d,c)),v&&(r+=Sr.convertValueParts(m,ut.latnParseRegex,e.numMapper.mapper))}return r},o.getCurrentDateValue=function(t,e){return e?Nu.getHijriDate(t):{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate()}},o.checkTwodigitNumber=function(t,e){var i=t+"";return e===2&&i.length!==2?"0"+i:i},o.getTimeZoneValue=function(t,e){var i=this,r=e.split(";"),n=r[t>0?1:0],s=Math.abs(t);return n=n.replace(/HH?|mm/g,function(a){var l=a.length,h=a.indexOf("H")!==-1;return i.checkTwodigitNumber(Math.floor(h?s/60:s%60),l)})},o})();EV(jL);var gL={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},ZV="percentSign",JV="minusSign",oc=["infinity","nan","group","decimal","exponential"],HL=(function(){function o(){}return o.numberFormatter=function(t,e,i){var r=this,n=pe({},e),s={},a={},l,h=ut.getDependables(i,t,"",!0),c=h.numericObject;a.numberMapper=$e()?pe({},c):Sr.getNumberMapper(h.parserObject,Sr.getNumberingSystem(i),!0),a.currencySymbol=$e()?V("currencySymbol",c):ut.getCurrencySymbol(h.numericObject,n.currency||Ws,e.altSymbol,e.ignoreCurrency),a.percentSymbol=$e()?V("numberSymbols.percentSign",c):a.numberMapper.numberSymbols[""+ZV],a.minusSymbol=$e()?V("numberSymbols.minusSign",c):a.numberMapper.numberSymbols[""+JV];var u=a.numberMapper.numberSymbols;if(e.format&&!ut.formatRegex.test(e.format))s=ut.customFormat(e.format,a,h.numericObject),!Te(n.useGrouping)&&n.useGrouping&&(n.useGrouping=s.pData.useGrouping);else{if(pe(n,ut.getProperNumericSkeleton(e.format||"N")),n.isCurrency=n.type==="currency",n.isPercent=n.type==="percent",$e()||(l=ut.getSymbolPattern(n.type,a.numberMapper.numberSystem,h.numericObject,n.isAccount)),n.groupOne=this.checkValueRange(n.maximumSignificantDigits,n.minimumSignificantDigits,!0),this.checkValueRange(n.maximumFractionDigits,n.minimumFractionDigits,!1,!0),Te(n.fractionDigits)||(n.minimumFractionDigits=n.maximumFractionDigits=n.fractionDigits),Te(n.useGrouping)&&(n.useGrouping=!0),n.isCurrency&&!$e()&&(l=l.replace(/\u00A4/g,ut.defaultCurrency)),$e())s.nData=pe({},{},V(n.type+"nData",c)),s.pData=pe({},{},V(n.type+"pData",c)),n.type==="currency"&&e.currency&&ut.replaceBlazorCurrency([s.pData,s.nData],a.currencySymbol,e.currency);else{var d=l.split(";");s.nData=ut.getFormatData(d[1]||"-"+d[0],!0,a.currencySymbol),s.pData=ut.getFormatData(d[0],!1,a.currencySymbol),n.useGrouping&&(n.groupSeparator=u[oc[2]],n.groupData=this.getGroupingDetails(d[0]))}var p=Te(n.minimumFractionDigits);if(p&&(n.minimumFractionDigits=s.nData.minimumFraction),Te(n.maximumFractionDigits)){var f=s.nData.maximumFraction;n.maximumFractionDigits=Te(f)&&n.isPercent?0:f}var v=n.minimumFractionDigits,m=n.maximumFractionDigits;!Te(v)&&!Te(m)&&v>m&&(n.maximumFractionDigits=v)}return pe(s.nData,n),pe(s.pData,n),function(y){return isNaN(y)?u[oc[1]]:isFinite(y)?r.intNumberFormatter(y,s,a,e):u[oc[0]]}},o.getGroupingDetails=function(t){var e={},i=t.match(ut.negativeDataRegex);if(i&&i[4]){var r=i[4],n=r.lastIndexOf(",");if(n!==-1){var s=r.split(".")[0];e.primary=s.length-n-1;var a=r.lastIndexOf(",",n-1);a!==-1&&(e.secondary=n-1-a)}}return e},o.checkValueRange=function(t,e,i,r){var n=r?"f":"s",s=0,a=gL["l"+n],l=gL["m"+n];if(Te(t)||(this.checkRange(t,a,r),s++),Te(e)||(this.checkRange(e,l,r),s++),s===2)if(t<e)lc(l+"specified must be less than the"+a);else return!0;else i&&s===1&&lc("Both"+l+"and"+l+"must be present");return!1},o.checkRange=function(t,e,i){var r=i?[0,20]:[1,21];(t<r[0]||t>r[1])&&lc(e+"value must be within the range"+r[0]+"to"+r[1])},o.intNumberFormatter=function(t,e,i,r){var n;if(!Te(e.nData.type)){t<0?(t=t*-1,n=e.nData):t===0?n=e.zeroData||e.pData:n=e.pData;var s="";if(n.isPercent&&(t=t*100),n.groupOne)s=this.processSignificantDigits(t,n.minimumSignificantDigits,n.maximumSignificantDigits);else if(s=this.processFraction(t,n.minimumFractionDigits,n.maximumFractionDigits,r),n.minimumIntegerDigits&&(s=this.processMinimumIntegers(s,n.minimumIntegerDigits)),i.isCustomFormat&&n.minimumFractionDigits<n.maximumFractionDigits&&/\d+\.\d+/.test(s)){for(var a=s.split("."),l=a[1],h=l.length,c=h-1;c>=0&&(l[parseInt(c.toString(),10)]==="0"&&c>=n.minimumFractionDigits);c--)l=l.slice(0,c);var u=i.numberMapper.numberSymbols[oc[3]]||".";l===""?s=a[0]:s=a[0]+u+l}return n.type==="scientific"&&(s=t.toExponential(n.maximumFractionDigits),s=s.replace("e",i.numberMapper.numberSymbols[oc[4]])),s=s.replace(".",i.numberMapper.numberSymbols[oc[3]]),s=n.format==="#,###,,;(#,###,,)"?this.customPivotFormat(parseInt(s,10)):s,n.useGrouping&&(s=this.groupNumbers(s,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[oc[3]]||".",n.groupData.secondary)),s=Sr.convertValueParts(s,ut.latnParseRegex,i.numberMapper.mapper),n.nlead==="N/A"?n.nlead:s==="0"&&r&&r.format==="0"?s+n.nend:n.nlead+s+n.nend}},o.processSignificantDigits=function(t,e,i){var r=t+"",n,s=r.length;return s<e?t.toPrecision(e):(r=t.toPrecision(i),n=+r,n+"")},o.groupNumbers=function(t,e,i,r,n){for(var s=!g(n)&&n!==0,a=t.split(r),l=a[0],h=l.length,c="";h>e;)c=l.slice(h-e,h)+(c.length?i+c:""),h-=e,s&&(e=n,s=!1);return a[0]=l.slice(0,h)+(c.length?i:"")+c,a.join(r)},o.roundTo=function(t,e){var i=Math.pow(10,e);return(Math.round(t*i)/i).toFixed(e)},o.processFraction=function(t,e,i,r){if(t!=null&&(t.toString().indexOf("e")!==-1||t.toString().indexOf("E")!==-1))return t.toFixed(e);var n=(t+"").split(".")[1],s=n?n.length:0;if(e&&s<e){var a="";if(s===0)a=t.toFixed(e);else{a+=t;for(var l=0;l<e-s;l++)a+="0";return a}return t.toFixed(e)}else if(!g(i)&&(s>i||i===0))return this.roundTo(t,i);var h=t+"";return h[0]==="0"&&r&&r.format==="###.00"&&(h=h.slice(1)),h},o.processMinimumIntegers=function(t,e){var i=t.split("."),r=i[0],n=r.length;if(n<e){for(var s=0;s<e-n;s++)r="0"+r;i[0]=r}return i.join(".")},o.customPivotFormat=function(t){if(t>=5e5){t/=1e6;var e=t.toString().split("."),i=e[0],r=e[1];return r&&+r.substring(0,1)>=5?Math.ceil(t).toString():Math.floor(t).toString()}return""},o})();DV(HL);var vL="stand-alone",e4=/^[0-9]*$/,mL={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth",milliseconds:"setMilliseconds"},t4="months",i4=(function(){function o(){}return o.dateParser=function(t,e,i){var r=this,n=ut.getDependables(i,t,e.calendar),s=Sr.getCurrentNumericOptions(n.parserObject,Sr.getNumberingSystem(i),!1,$e()),a={};$e()&&e.isServerRendered&&(e=ut.compareBlazorDateFormats(e,t));var l=e.format||ut.getResultantPattern(e.skeleton,n.dateObject,e.type,!1,$e()?t:""),h="",c;if(Te(l))lc("Format options or type given must be invalid");else{l=ut.ConvertDateToWeekFormat(l),a={isIslamic:ut.islamicRegex.test(e.calendar),pattern:l,evalposition:{},culture:t};for(var u=l.match(ut.dateParseRegex)||[],d=u.length,p=0,f=0,v=!1,m=s.numericRegex,y=$e()?n.parserObject.numbers:Sr.getNumberMapper(n.parserObject,Sr.getNumberingSystem(i)),b=0;b<d;b++){var S=u[parseInt(b.toString(),10)],C=S.length,x=S[0]==="K"?"h":S[0],I=void 0,D=void 0,M=KV[""+x],E=C===2?"":"?";switch(v&&(p=f,v=!1),x){case"E":case"c":{var A=void 0;$e()?A=V("days."+ut.monthIndex[""+C],n.dateObject):A=n.dateObject[""+ut.days][""+vL][ut.monthIndex[""+C]];var L=Sr.reverseObject(A);h+="("+Object.keys(L).join("|")+")";break}case"M":case"L":case"d":case"m":case"s":case"h":case"H":case"f":if(D=!0,(x==="M"||x==="L")&&C>2){var N=void 0;$e()?N=V("months."+ut.monthIndex[""+C],n.dateObject):N=n.dateObject[""+t4][""+vL][ut.monthIndex[""+C]],a[""+M]=Sr.reverseObject(N),h+="("+Object.keys(a[""+M]).join("|")+")"}else if(x==="f"){if(C>3)continue;I=!0,h+="("+m+m+"?"+m+"?)"}else I=!0,h+="("+m+m+E+")";x==="h"&&(a.hour12=!0);break;case"W":{var R=C===1?"?":"";h+="("+m+R+m+")";break}case"y":D=I=!0,C===2?h+="("+m+m+")":h+="("+m+"{"+C+",})";break;case"a":{D=!0;var P=$e()?V("dayPeriods",n.dateObject):V("dayPeriods.format.wide",n.dateObject);a[""+M]=Sr.reverseObject(P),h+="("+Object.keys(a[""+M]).join("|")+")";break}case"G":{D=!0;var k=C<=3?"eraAbbr":C===4?"eraNames":"eraNarrow";a[""+M]=Sr.reverseObject($e()?V("eras",n.dateObject):V("eras."+k,n.dateObject)),h+="("+Object.keys(a[""+M]).join("|")+"?)";break}case"z":{var B=new Date().getTimezoneOffset();D=B!==0,a[""+M]=V("dates.timeZoneNames",n.parserObject);var F=a[""+M];c=C<4;var O=c?"+H;-H":F.hourFormat;O=O.replace(/:/g,y.timeSeparator),h+="("+this.parseTimeZoneRegx(O,F,m)+")?",v=!0,f=c?6:12;break}case"'":{var z=S.replace(/'/g,"");h+="("+z+")?";break}default:h+="([\\D])";break}if(D&&(a.evalposition[""+M]={isNumber:I,pos:b+1+p,hourOnly:c}),b===d-1&&!g(h)){var Y=RegExp;a.parserRegex=new Y("^"+h+"$","i")}}}return function(K){var U=r.internalDateParse(K,a,s);if(g(U)||!Object.keys(U).length)return null;if(a.isIslamic){var q={},ae=U.year,te=U.day,he=U.month,ue=ae?ae+"":"",ne=ue.length===2;(!ae||!he||!te||ne)&&(q=Nu.getHijriDate(new Date)),ne&&(ae=parseInt((q.year+"").slice(0,2)+ue,10));var le=Nu.toGregorian(ae||q.year,he||q.month,te||q.date);U.year=le.getFullYear(),U.month=le.getMonth()+1,U.day=le.getDate()}return r.getDateObject(U)}},o.getDateObject=function(t,e){var i=e||new Date;i.setMilliseconds(0);var r=["hour","minute","second","milliseconds","month","day"],n=t.year,s=t.designator,a=t.timeZone;if(!Te(n)){var l=(n+"").length;if(l<=2){var h=Math.floor(i.getFullYear()/100)*100;n+=h}i.setFullYear(n)}for(var c=0,u=r;c<u.length;c++){var d=u[c],p=t[""+d];if(Te(p)&&d==="day"&&i.setDate(1),!Te(p))if(d==="month"){if(p-=1,p<0||p>11)return new Date("invalid");var f=i.getDate();i.setDate(1),i[mL[""+d]](p);var v=new Date(i.getFullYear(),p+1,0).getDate();i.setDate(f<v?f:v)}else{if(d==="day"){var m=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(p<1||p>m)return null}if(d==="hour"){var y=t.hour12;if(y){if(p<1||p>12)return null}else if(p<0||p>23)return null}else if(d==="minute"||d==="second"){if(p<0||p>59)return null}else if(d==="milliseconds"&&(p<0||p>999))return null;i[""+mL[""+d]](p)}}if(!Te(s)){var b=i.getHours();s==="pm"?i.setHours(b+(b===12?0:12)):b===12&&i.setHours(0)}if(!Te(a)){var S=a-i.getTimezoneOffset();S!==0&&i.setMinutes(i.getMinutes()+S)}return i},o.internalDateParse=function(t,e,i){var r=t.match(e.parserRegex),n={hour:0,minute:0,second:0};if(g(r))return null;for(var s=Object.keys(e.evalposition),a=0,l=s;a<l.length;a++){var h=l[a],c=e.evalposition[""+h],u=r[c.pos];if(c.isNumber)n[""+h]=this.internalNumberParser(u,i);else if(h==="timeZone"&&!Te(u)){var d=c.pos,p=void 0,f=r[d+1],v=!Te(f);c.hourOnly?p=this.getZoneValue(v,f,r[d+4],i)*60:(p=this.getZoneValue(v,f,r[d+7],i)*60,p+=this.getZoneValue(v,r[d+4],r[d+10],i)),g(p)||(n[""+h]=p)}else{var m=["en-US","en-MH","en-MP"];u=h==="month"&&!e.isIslamic&&(e.culture==="en"||e.culture==="en-GB"||e.culture==="en-US")?u[0].toUpperCase()+u.substring(1).toLowerCase():u,u=h!=="month"&&h==="designator"&&e.culture&&e.culture.indexOf("en-")!==-1&&m.indexOf(e.culture)===-1?u.toLowerCase():u,n[""+h]=e[""+h][""+u]}}return e.hour12&&(n.hour12=!0),n},o.internalNumberParser=function(t,e){return t=Sr.convertValueParts(t,e.numberParseRegex,e.numericPair),e4.test(t)?+t:null},o.escapeRegex=function(t){var e="__TEMP__",i=t.replace("{0}",e),r=/[.*+?^${}()|[\]\\]/g,n=i.replace(r,"\\$&");return n.replace(e,"{0}")},o.parseTimeZoneRegx=function(t,e,i){var r=e.gmtFormat,n,s="("+i+")("+i+")";n=t.replace("+","\\+"),t.indexOf("HH")!==-1?n=n.replace(/HH|mm/g,"("+s+")"):n=n.replace(/H|m/g,"("+s+"?)"),r=this.escapeRegex(r);var a=n.split(";").map(function(h){return r.replace("{0}",h)}),l=this.escapeRegex(e.gmtZeroFormat);return n=a.join("|")+"|"+l,n},o.getZoneValue=function(t,e,i,r){var n=t?e:i;if(!n)return 0;var s=this.internalNumberParser(n,r);return t?-s:s},o})(),r4=RegExp,n4=new r4("^([^0-9]*)(([0-9,]*[0-9]+)(.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$"),s4=/,/g,a4=["minusSign","infinity"],o4=(function(){function o(){}return o.numberParser=function(t,e,i){var r=this,n=ut.getDependables(i,t,"",!0),s={custom:!0};ut.formatRegex.test(e.format)||!e.format?(pe(s,ut.getProperNumericSkeleton(e.format||"N")),s.custom=!1,s.fractionDigits||e.maximumFractionDigits&&(s.maximumFractionDigits=e.maximumFractionDigits)):pe(s,ut.customFormat(e.format,null,null));var a=V("numbers",n.parserObject),l=Sr.getCurrentNumericOptions(n.parserObject,Sr.getNumberingSystem(i),!0,$e());s.symbolRegex=Sr.getSymbolRegex(Object.keys(l.symbolMatch)),s.infinity=l.symbolNumberSystem[a4[1]];var h;if($e())s.nData=pe({},{},V(s.type+"nData",a)),s.pData=pe({},{},V(s.type+"pData",a)),s.type==="currency"&&e.currency&&ut.replaceBlazorCurrency([s.pData,s.nData],V("currencySymbol",a),e.currency);else if(h=ut.getSymbolPattern(s.type,l.numberSystem,n.numericObject,s.isAccount),h){h=h.replace(/\u00A4/g,ut.defaultCurrency);var c=h.split(";");s.nData=ut.getFormatData(c[1]||"-"+c[0],!0,""),s.pData=ut.getFormatData(c[0],!0,"")}return function(u){return r.getParsedNumber(u,s,l)}},o.getParsedNumber=function(t,e,i){var r,n,s,a,l,h;if(t.indexOf(e.infinity)!==-1)return 1/0;t=Sr.convertValueParts(t,e.symbolRegex,i.symbolMatch),t=Sr.convertValueParts(t,i.numberParseRegex,i.numericPair),t=t.indexOf("-")!==-1?t.replace("-.","-0."):t,t.indexOf(".")===0&&(t="0"+t);var c=t.match(n4);if(g(c))return NaN;a=c[1],s=c[2];var u=c[5];return l=c[6],r=e.custom?a===e.nData.nlead&&l===e.nData.nend:a.indexOf(e.nData.nlead)!==-1&&l.indexOf(e.nData.nend)!==-1,n=r?e.nData.isPercent:e.pData.isPercent,s=s.replace(s4,""),u&&(s+=u),h=+s,(e.type==="percent"||n)&&(h=h/100),(e.custom||e.fractionDigits)&&(h=parseFloat(h.toFixed(e.custom?r?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.fractionDigits))),e.maximumFractionDigits&&(h=this.convertMaxFracDigits(s,e,h,r)),r&&(h*=-1),h},o.convertMaxFracDigits=function(t,e,i,r){var n=t.split(".");return n[1]&&n[1].length>e.maximumFractionDigits&&(i=+i.toFixed(e.custom?r?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.maximumFractionDigits)),i},o})(),ku=new Lu,l4=!1,Br={},Yp="en-US",Iw=["numericObject","dateObject"],Nt=(function(){function o(t){t&&(this.culture=t)}return o.prototype.getDateFormat=function(t){return jL.dateFormat(this.getCulture(),t||{type:"date",skeleton:"short"},Br)},o.prototype.getNumberFormat=function(t){return t&&!t.currency&&(t.currency=Ws),$e()&&t&&!t.format&&(t.minimumFractionDigits=0),HL.numberFormatter(this.getCulture(),t||{},Br)},o.prototype.getDateParser=function(t){return i4.dateParser(this.getCulture(),t||{skeleton:"short",type:"date"},Br)},o.prototype.getNumberParser=function(t){return $e()&&t&&!t.format&&(t.minimumFractionDigits=0),o4.numberParser(this.getCulture(),t||{format:"N"},Br)},o.prototype.formatNumber=function(t,e){return this.getNumberFormat(e)(t)},o.prototype.formatDate=function(t,e){return this.getDateFormat(e)(t)},o.prototype.parseDate=function(t,e){return this.getDateParser(e)(t)},o.prototype.parseNumber=function(t,e){return this.getNumberParser(e)(t)},o.prototype.getDatePattern=function(t,e){return ut.getActualDateTimeFormat(this.getCulture(),t,Br,e)},o.prototype.getNumberPattern=function(t,e){return ut.getActualNumberFormat(this.getCulture(),t,Br,e)},o.prototype.getFirstDayOfWeek=function(){return ut.getWeekData(this.getCulture(),Br)},o.prototype.getCulture=function(){return this.culture||Yp},o})();function VL(o){Yp=o,ku.notify("notifyExternalChange",{locale:Yp})}function Ki(o,t){var e=ut.getDependables(Br,o,"",!0)[Iw[0]],i=ut.getDependables(Br,o,"")[Iw[1]],r=V("defaultNumberingSystem",e),n=$e()?V("numberSymbols",e):V("symbols-numberSystem-"+r,e),s=ut.getSymbolPattern(t||"decimal",r,e,!1);return pe(n,ut.getFormatData(s,!0,"",!0),{dateSeparator:ut.getDateSeparator(i)})}function nh(o,t){var e=ut.getDependables(Br,o,"",!0);return ut.getCurrencySymbol(e.numericObject,t)}function hm(o){return ut.getDependables(Br,"",o,!1)[Iw[1]]}var h4=["grid","pivotview","treegrid","spreadsheet","rangeNavigator","DocumentEditor","listbox","inplaceeditor","PdfViewer","richtexteditor","DashboardLayout","chart","stockChart","circulargauge","diagram","heatmap","lineargauge","maps","slider","smithchart","barcode","sparkline","treemap","bulletChart","kanban","daterangepicker","schedule","gantt","signature","query-builder","drop-down-tree","carousel","filemanager","uploader","accordion","tab","treeview"],c4=["grid","chart","maps","schedule","gantt","richtexteditor","kanban","treegrid","filemanager","pivotview","diagram","blockeditor","spreadsheet","DocumentEditor"],u4=["maps","schedule","gantt","richtexteditor","kanban","treegrid","filemanager","pivotview","diagram","blockeditor","PdfViewer","DocumentEditor"],d4=["grid","chart","maps","schedule","gantt","richtexteditor","kanban","treegrid","filemanager","pivotview","diagram","blockeditor","PdfViewer","spreadsheet"],p4=[115,121,110,99,102,117,115,105,111,110,46,105,115,76,105,99,86,97,108,105,100,97,116,101,100],Mw,yL=!0,_L=(function(){function o(t){this.isLicensed=!0,this.version="31",this.platform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats|essentialstudio/i,this.prefixRegex=/essentialui|pdfviewersdk|spreadsheeteditorsdk|docxeditorsdk/i,this.incorrectPlatform=/JavaScript|ASPNET|ASPNETCORE|ASPNETMVC|FileFormats/i,this.errors={noLicense:"<span>This application was built using a trial version of Syncfusion<sup>\xAE</sup> Essential Studio<sup>\xAE</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",trailExpired:"<span>This application was built using a trial version of Syncfusion<sup>\xAE</sup> Essential Studio<sup>\xAE</sup>. To remove the license validation message permanently, a valid license key must be included.</span>",versionMismatched:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>",platformMismatched:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>",invalidKey:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>",componentRestricted:"<span>The included Syncfusion<sup>\xAE</sup> license key is invalid.</span>"},this.validatedPlatforms=[],this.minVersion=null,this.allowedComponentsMap={pdfviewersdk:c4,spreadsheeteditorsdk:u4,docxeditorsdk:d4},this.manager=(function(){var e=null;function i(n){e=n}function r(){return e}return{setKey:i,getKey:r}})(),this.npxManager=(function(){var e="npxKeyReplace";function i(){return e}return{getKey:i}})(),this.manager.setKey(t)}return o.prototype.validate=function(t){var e=[115,121,110,99,102,117,115,105,111,110,46,108,105,99,101,110,115,101,67,111,110,116,101,110,116],i=[115,121,110,99,102,117,115,105,111,110,46,99,108,97,105,109,65,99,99,111,117,110,116,85,82,76];if(qp&&!V(yw(p4),qp)&&!V("Blazor",qp)){var r=void 0,n=void 0;if(this.manager&&this.manager.getKey()||this.npxManager&&this.npxManager.getKey()!=="npxKeyReplace"){var s=this.getInfoFromKey();if(s&&s.length){for(var a=void 0,l=0,h=s;l<h.length;l++){var c=h[l],u=!1;if(!this.platform.test(c.platform)&&!this.prefixRegex.test(c.platform)||c.invalidPlatform)r=this.errors.platformMismatched;else if(this.incorrectPlatform.test(c.platform)&&parseInt(c.version.split(".")[0],10)>30)r=this.errors.platformMismatched;else if(this.prefixRegex.test(c.platform)&&parseInt(c.version.split(".")[0],10)>30){var d=this.restrictComponent(t,c.platform);if(d?(a=d,u=!0):a=null,c.minVersion>=c.lastValue&&c.minVersion!==c.lastValue||c.lastValue<parseInt(this.version,10)?(r=this.errors.versionMismatched,r=r.replace("##LicenseVersion",c.version),r=r.replace("##Requireversion",this.version+".x")):(c.lastValue==null||isNaN(c.lastValue))&&(r=this.errors.versionMismatched,r=r.replace("##LicenseVersion",c.version),r=r.replace("##Requireversion",this.version+".x")),c.expiryDate){var p=new Date(c.expiryDate),f=new Date;p<f&&p!==f&&(r=this.errors.trailExpired,u=!0)}if(!r&&!a)break}else if(c.minVersion>=c.lastValue&&c.minVersion!==c.lastValue||c.lastValue<parseInt(this.version,10)?(r=this.errors.versionMismatched,r=r.replace("##LicenseVersion",c.version),r=r.replace("##Requireversion",this.version+".x")):(c.lastValue==null||isNaN(c.lastValue))&&(r=this.errors.versionMismatched,r=r.replace("##LicenseVersion",c.version),r=r.replace("##Requireversion",this.version+".x")),c.expiryDate){var p=new Date(c.expiryDate),f=new Date;if(p!==f&&p<f)r=this.errors.trailExpired;else break}!u&&this.prefixRegex.test(c.platform)&&this.validatedPlatforms.push(c.platform)}(!this.validatedPlatforms.length||a)&&(r=r||a)}else r=this.errors.invalidKey}else{var v=V(yw(e),qp);n=V(yw(i),qp),v&&v!==""?r=v:r=this.errors.noLicense}if(r&&typeof document<"u"&&!g(document)){if(yL){Mw=n&&n!==""?n:"https://www.syncfusion.com/account/claim-license-key?pl=SmF2YVNjcmlwdA==&vs=MzE=&utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information";var m=et("div",{innerHTML:`<img src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzE5OV80KSI+CjxwYXRoIGQ9Ik0xMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM0M3LjAyOTQ0IDMgMyA3LjAyOTQ0IDMgMTJDMyAxNi45NzA2IDcuMDI5NDQgMjEgMTIgMjFaIiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBmaWxsPSIjNjE2MDYzIi8+CjxwYXRoIGQ9Ik0xMS4yNSAxMS4yNUgxMlYxNi41SDEyLjc1IiBzdHJva2U9IiM3MzczNzMiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMS44MTI1IDlDMTIuNDMzOCA5IDEyLjkzNzUgOC40OTYzMiAxMi45Mzc1IDcuODc1QzEyLjkzNzUgNy4yNTM2OCAxMi40MzM4IDYuNzUgMTEuODEyNSA2Ljc1QzExLjE5MTIgNi43NSAxMC42ODc1IDcuMjUzNjggMTAuNjg3NSA3Ljg3NUMxMC42ODc1IDguNDk2MzIgMTEuMTkxMiA5IDExLjgxMjUgOVoiIGZpbGw9IiM3MzczNzMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xOTlfNCI+CjxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K' style="top: 6px;
                    position: absolute;
                    left: 16px;
                    width: 24px;
                    height: 24px;"/>`+r+' <a style="text-decoration: none;color: #0D6EFD;font-weight: 500;" href='+Mw+">Claim your free account</a>"});m.setAttribute("style",`position: fixed;
                top: 10px;
                left: 10px;
                right: 10px;
                font-size: 14px;
                background: #EEF2FF;
                color: #222222;
                z-index: 999999999;
                text-align: left;
                border: 1px solid #EEEEEE;
                padding: 10px 11px 10px 50px;
                border-radius: 8px;
                font-family: Helvetica Neue, Helvetica, Arial;`),document.body.appendChild(m),yL=!1}this.isLicensed=!1}}return this.isLicensed},o.prototype.restrictComponent=function(t,e){var i=["DocumentEditor","spreadsheet","PdfViewer"];if(e==="essentialui")return i.indexOf(t)===-1?null:this.errors.componentRestricted;var r=this.allowedComponentsMap[e]||[];return r.indexOf(t)===-1?null:this.errors.componentRestricted},o.prototype.getDecryptedData=function(t){try{return atob(t)}catch{return""}},o.prototype.getInfoFromKey=function(){try{var t="",e=[5439488,7929856,5111808,6488064,4587520,7667712,5439488,6881280,5177344,7208960,4194304,4456448,6619136,7733248,5242880,7077888,6356992,7602176,4587520,7274496,7471104,7143424],i=[],r=[],n=!1,s=!1;this.manager.getKey()?t=this.manager.getKey():(s=!0,t=this.npxManager.getKey().split("npxKeyReplace")[1]);for(var a=t.split(";"),l=0,h=a;l<h.length;l++){var c=h[l],u=this.getDecryptedData(c);if(u){var d=0,p="";if(s){for(var m=u[u.length-1],y=[],f=0;f<u.length;f++)y[parseInt(f.toString(),10)]=u[parseInt(f.toString(),10)].charCodeAt(0)-m.charCodeAt(0);for(var f=0;f<y.length;f++)p+=String.fromCharCode(y[parseInt(f.toString(),10)])}else for(var f=0;f<u.length;f++,d++){d===e.length&&(d=0);var v=u.charCodeAt(f);p+=String.fromCharCode(v^e[parseInt(d.toString(),10)]>>16)}if(this.platform.test(p)||this.prefixRegex.test(p)){if(i=p.split(";"),n=!1,i.length>3){var b=parseInt(i[1].split(".")[0],10),S=parseInt(i[4],10);r.push({platform:i[0],version:i[1],expiryDate:i[2],lastValue:S,minVersion:b})}}else p&&p.split(";").length>3&&(n=!0)}}return n&&!r.length?[{invalidPlatform:n}]:r.length?r:null}catch{return null}},o})(),UL=new _L;function yw(o){for(var t="",e=0,i=o;e<i.length;e++){var r=i[e];t+=String.fromCharCode(r)}return t}function f4(o){UL=new _L(o)}var g4=function(o,t){return t&&f4(t),UL.validate(o)};var v4=function(){var o=`
    <div style="
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 99999;
    ">
        <div style="
    background: #FFFFFF;
    height: 455px;
    width: 840px;
    font-family: Helvetica Neue, Helvetica, Arial;
    color: #000000;
    box-shadow: 0px 4.8px 14.4px rgb(0 0 0 / 18%), 0px 25.6px 57.6px rgb(0 0 0 / 22%);
    display: block;
    margin: 8% auto;
    border-radius: 20px;
    ">
            <div style="
    position: absolute;
width: 838px;
height: 62px;
background-color: #F9F9F9;
border: 1px solid #EEEEEE;
border-top-left-radius: 20px;
border-top-right-radius: 20px;
">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ2IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ2IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNNDAuNTk2NSAxNS4wMDc4SDMyLjQyNUMzMS41NTU3IDE1LjAwNzggMzAuOTAzNyAxNS4xODEyIDMwLjUxMjUgMTUuNDg0NkMzMC4xMjEzIDE1LjgzMTQgMjkuOTA0IDE2LjMwODIgMjkuOTA0IDE3LjA0NTFDMjkuOTA0IDE3LjYwODYgMzAuMDc3OCAxOC4wNDIxIDMwLjQyNTYgMTguMzAyMkMzMC43NzMzIDE4LjYwNTYgMzEuMjk0OSAxOC43MzU2IDMxLjk5MDMgMTguNzM1NkgzNi4zMzY5QzM4LjExODkgMTguNzM1NiAzOS40MjI5IDE5LjA4MjQgNDAuMTYxOCAxOS43MzI2QzQwLjk0NDIgMjAuNDI2MiA0MS4yOTE5IDIxLjU1MzIgNDEuMjkxOSAyMy4xMTM3QzQxLjI5MTkgMjQuNzE3NiA0MC44NTcyIDI1Ljg4OCAzOS45ODc5IDI2LjY2ODJDMzkuMTE4NiAyNy40MDUxIDM3LjcyNzcgMjcuNzk1MyAzNS44NTg3IDI3Ljc5NTNIMjcuMDc4N1YyNS4wMjFIMzUuMzM3MkMzNi4yOTM0IDI1LjAyMSAzNi45NDU0IDI0Ljg5MSAzNy4zMzY2IDI0LjYzMDlDMzcuNzI3NyAyNC4zNzA4IDM3LjkwMTYgMjMuODk0IDM3LjkwMTYgMjMuMjg3MUMzNy45MDE2IDIyLjYzNjkgMzcuNzI3NyAyMi4xNjAxIDM3LjM4IDIxLjlDMzcuMDMyMyAyMS42Mzk5IDM2LjQyMzggMjEuNDY2NSAzNS41NTQ1IDIxLjQ2NjVIMzEuNjQyNkMyOS44NjA1IDIxLjQ2NjUgMjguNTEzMSAyMS4xMTk4IDI3LjY4NzMgMjAuMzgyOEMyNi44NjE0IDE5LjY0NTkgMjYuNDI2OCAxOC41MTg5IDI2LjQyNjggMTcuMDAxN0MyNi40MjY4IDE1LjM1NDUgMjYuODYxNCAxNC4xNDA4IDI3LjczMDcgMTMuMzYwNkMyOC42IDEyLjU4MDMgMjkuOTkwOSAxMi4yMzM1IDMxLjkwMzQgMTIuMjMzNUg0MC41OTY1VjE1LjAwNzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik00OC4wNzI3IDI1LjI4MTFINTAuNTA2OFYxNi4zOTQ5SDUzLjU0OTNWMjcuNTM1MkM1My41NDkzIDI5LjA1MjQgNTMuMjAxNiAzMC4xNzk0IDUyLjUwNjIgMzAuOTE2M0M1MS44MTA3IDMxLjY1MzIgNTAuNzI0MSAzMiA0OS4yNDYzIDMySDQzLjMzNVYyOS42NTkySDQ4LjcyNDdDNDkuMjg5NyAyOS42NTkyIDQ5Ljc2NzkgMjkuNTI5MiA1MC4wNzIxIDI5LjIyNThDNTAuMzc2NCAyOC45NjU3IDUwLjU1MDIgMjguNTMyMiA1MC41NTAyIDI4LjAxMlYyNy44Mzg2SDQ3Ljg5ODlDNDYuMjAzNyAyNy44Mzg2IDQ0Ljk0MzIgMjcuNDkxOSA0NC4yNDc4IDI2Ljg0MTZDNDMuNTA4OSAyNi4xNDgxIDQzLjE2MTEgMjUuMDY0NCA0My4xNjExIDIzLjQ2MDVWMTYuMzk0OUg0Ni4xNjAyVjIzLjIwMDVDNDYuMTYwMiAyNC4wNjc0IDQ2LjI5MDYgMjQuNjMwOSA0Ni41NTE0IDI0Ljg5MUM0Ni43MjUzIDI1LjE1MTEgNDcuMjQ2OSAyNS4yODExIDQ4LjA3MjcgMjUuMjgxMVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTU1Ljg5NjUgMTYuMzk0OUg2MS41OTA0QzYzLjMyOTEgMTYuMzk0OSA2NC41NDYxIDE2LjY5ODMgNjUuMjg1IDE3LjM0ODVDNjYuMDIzOSAxNy45OTg4IDY2LjM3MTYgMTkuMDgyNCA2Ni4zNzE2IDIwLjU1NjNWMjcuNzk1M0g2My4zMjkxVjIwLjk0NjRDNjMuMzI5MSAyMC4wNzk0IDYzLjE5ODcgMTkuNTE1OSA2Mi45Mzc5IDE5LjI5OTJDNjIuNjc3MSAxOS4wMzkxIDYyLjE1NTUgMTguOTA5MSA2MS4zMjk3IDE4LjkwOTFINTguODk1NlYyNy44Mzg2SDU1Ljg1M1YxNi4zOTQ5SDU1Ljg5NjVaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03NC45MzQyIDI1LjM2NzhINzguMTUwNlYyNy43OTUySDc0LjAyMTRDNzIuOTc4MiAyNy43OTUyIDcyLjEwODkgMjcuNjY1MiA3MS40NTcgMjcuNDkxOEM3MC44MDUgMjcuMjc1IDcwLjE5NjUgMjYuOTI4MyA2OS43MTgzIDI2LjQ1MTRDNjkuMTk2OCAyNS45MzEzIDY4Ljc2MjEgMjUuMjgxMSA2OC40NTc4IDI0LjU0NDJDNjguMTUzNiAyMy44MDcyIDY4LjAyMzIgMjIuOTgzNiA2OC4wMjMyIDIyLjE2QzY4LjAyMzIgMjEuMjkzMSA2OC4xNTM2IDIwLjQ2OTUgNjguNDU3OCAxOS42ODkyQzY4Ljc2MjEgMTguOTA5IDY5LjE1MzMgMTguMzAyMSA2OS43MTgzIDE3Ljc4MTlDNzAuMjM5OSAxNy4zMDUxIDcwLjgwNSAxNi45NTgzIDcxLjUwMDQgMTYuNzQxNkM3Mi4xOTU5IDE2LjUyNDkgNzMuMDIxNyAxNi40MzgyIDc0LjA2NDkgMTYuNDM4Mkg3OC4xOTQxVjE4LjkwOUg3NC45MzQyQzczLjQ5OTggMTguOTA5IDcyLjU0MzYgMTkuMTY5MSA3MS45Nzg1IDE5LjY0NTlDNzEuNDU2OSAyMC4xMjI3IDcxLjE1MjcgMjAuOTg5NyA3MS4xNTI3IDIyLjIwMzRDNzEuMTUyNyAyMi44OTY5IDcxLjI4MzEgMjMuNDYwNSA3MS41MDA0IDIzLjkzNzNDNzEuNzE3NyAyNC40MTQxIDcyLjA2NTUgMjQuNzYwOSA3Mi41MDAxIDI1LjA2NDNDNzIuNzE3NCAyNS4xOTQ0IDcyLjk3ODIgMjUuMjgxMSA3My4yODI1IDI1LjM2NzhDNzMuNjMwMiAyNS4zMjQ0IDc0LjE1MTggMjUuMzY3OCA3NC45MzQyIDI1LjM2NzhaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik04MC44NDU2IDE4LjY0ODlINzguNjcyNFYxNi4zNTE1SDgwLjg0NTZWMTUuMTgxMUM4MC44NDU2IDE0LjAxMDggODEuMDYzIDEzLjIzMDUgODEuNDk3NiAxMi44NDA0QzgxLjkzMjMgMTIuNDUwMyA4Mi43NTgxIDEyLjIzMzUgODMuOTc1MSAxMi4yMzM1SDg2Ljg0MzhWMTQuNDAwOUg4NS40MDk1Qzg0Ljg4NzkgMTQuNDAwOSA4NC41NDAyIDE0LjQ4NzYgODQuMzIyOSAxNC42NjFDODQuMTA1NSAxNC44MzQ0IDgzLjk3NTEgMTUuMDk0NSA4My45NzUxIDE1LjQ0MTJWMTYuMzUxNUg4Ni44NDM4VjE4LjY0ODlIODMuOTc1MVYyNy43OTUzSDgwLjg0NTZWMTguNjQ4OVoiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTk4LjQwNTYgMjcuNzk1M0g5Mi43MTE2QzkxLjAxNjUgMjcuNzk1MyA4OS44NDI5IDI3LjQ0ODUgODkuMDYwNSAyNi43OTgzQzg4LjMyMTYgMjYuMTQ4MSA4Ny45MzA0IDI1LjA2NDQgODcuOTMwNCAyMy41OTA2VjE2LjM5NDlIOTAuOTI5NVYyMy40MTcyQzkwLjkyOTUgMjQuMTk3NCA5MS4wNTk5IDI0LjY3NDMgOTEuMzIwNyAyNC45MzQ0QzkxLjU4MTUgMjUuMTk0NCA5Mi4xMDMxIDI1LjMyNDUgOTIuOTI4OSAyNS4zMjQ1SDk1LjM2M1YxNi4zOTQ5SDk4LjQwNTZWMjcuNzk1M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTEwMC42MjIgMjUuNDExMkgxMDcuMDExQzEwNy41NzcgMjUuNDExMiAxMDguMDExIDI1LjMyNDUgMTA4LjI3MiAyNS4xNTExQzEwOC41MzMgMjQuOTc3NyAxMDguNjYzIDI0LjY3NDMgMTA4LjY2MyAyNC4zMjc1QzEwOC42NjMgMjMuOTM3NCAxMDguNTMzIDIzLjY3NzMgMTA4LjI3MiAyMy40NjA1QzEwOC4wMTEgMjMuMjg3MSAxMDcuNTc3IDIzLjIwMDUgMTA3LjA1NSAyMy4yMDA1SDEwNC40NDdDMTAyLjg4MiAyMy4yMDA1IDEwMS44MzkgMjIuOTgzNyAxMDEuMzE4IDIyLjUwNjlDMTAwLjc1MiAyMi4wMzAxIDEwMC40OTIgMjEuMjA2NSAxMDAuNDkyIDE5Ljk5MjdDMTAwLjQ5MiAxOC43NzkgMTAwLjgzOSAxNy44Njg3IDEwMS40OTEgMTcuMjYxOEMxMDIuMTQzIDE2LjY5ODMgMTAzLjE4NyAxNi4zOTQ5IDEwNC41MzQgMTYuMzk0OUgxMTEuMDU0VjE4Ljc3OUgxMDUuNzA4QzEwNC44MzggMTguNzc5IDEwNC4yNzMgMTguODY1NyAxMDQuMDEyIDE4Ljk5NTdDMTAzLjc1MiAxOS4xNjkxIDEwMy42MjEgMTkuNDI5MiAxMDMuNjIxIDE5LjgxOTRDMTAzLjYyMSAyMC4xNjYxIDEwMy43NTIgMjAuNDI2MiAxMDMuOTY5IDIwLjU5OTZDMTA0LjE4NiAyMC43NzMgMTA0LjU3NyAyMC44NTk3IDEwNS4wNTYgMjAuODU5N0gxMDcuNzk0QzEwOS4wNTQgMjAuODU5NyAxMTAuMDExIDIxLjE2MzEgMTEwLjY2MyAyMS43MjY2QzExMS4zMTUgMjIuMjkwMiAxMTEuNjYyIDIzLjE1NzEgMTExLjY2MiAyNC4yNDA4QzExMS42NjIgMjUuMjgxMSAxMTEuMzU4IDI2LjE0ODEgMTEwLjc5MyAyNi43OTgzQzExMC4yMjggMjcuNDQ4NSAxMDkuNDQ2IDI3Ljc5NTMgMTA4LjUzMyAyNy43OTUzSDEwMC43MDlWMjUuNDExMkgxMDAuNjIyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTE2LjU3NCAxNS4wOTQ0SDExMy40MDFWMTIuMjc2OUgxMTYuNTc0VjE1LjA5NDRaTTExNi41NzQgMjcuNzk1M0gxMTMuNDAxVjE2LjM5NDlIMTE2LjU3NFYyNy43OTUzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMwLjMwOSAyMi4xMTY3QzEzMC4zMDkgMjMuODkzOSAxMjkuNzQ0IDI1LjMyNDQgMTI4LjY1NyAyNi40MDgxQzEyNy41NzEgMjcuNDkxOCAxMjYuMDkzIDI4LjAxMiAxMjQuMjI0IDI4LjAxMkMxMjIuMzU1IDI4LjAxMiAxMjAuODc3IDI3LjQ5MTggMTE5Ljc5IDI2LjQwODFDMTE4LjcwNCAyNS4zMjQ0IDExOC4xMzkgMjMuODkzOSAxMTguMTM5IDIyLjExNjdDMTE4LjEzOSAyMC4zMzk0IDExOC43MDQgMTguOTA5IDExOS43OSAxNy44MjUzQzEyMC44NzcgMTYuNzQxNiAxMjIuMzk4IDE2LjIyMTQgMTI0LjIyNCAxNi4yMjE0QzEyNi4wNDkgMTYuMjIxNCAxMjcuNTI3IDE2Ljc0MTYgMTI4LjY1NyAxNy44MjUzQzEyOS43NDQgMTguODY1NiAxMzAuMzA5IDIwLjI5NjEgMTMwLjMwOSAyMi4xMTY3Wk0xMjEuMjY4IDIyLjExNjdDMTIxLjI2OCAyMy4yMDA0IDEyMS41MjkgMjQuMDY3MyAxMjIuMDUxIDI0LjY3NDJDMTIyLjU3MiAyNS4yODExIDEyMy4yNjggMjUuNTg0NSAxMjQuMTggMjUuNTg0NUMxMjUuMDkzIDI1LjU4NDUgMTI1Ljc4OSAyNS4yODExIDEyNi4zMSAyNC42NzQyQzEyNi44MzIgMjQuMDY3MyAxMjcuMDkzIDIzLjIwMDQgMTI3LjA5MyAyMi4xMTY3QzEyNy4wOTMgMjEuMDMzIDEyNi44MzIgMjAuMTY2MSAxMjYuMzEgMTkuNjAyNUMxMjUuNzg5IDE4Ljk5NTcgMTI1LjA5MyAxOC42OTIyIDEyNC4xMzcgMTguNjkyMkMxMjMuMjI0IDE4LjY5MjIgMTIyLjUyOSAxOC45OTU3IDEyMi4wMDcgMTkuNjAyNUMxMjEuNTI5IDIwLjE2NjEgMTIxLjI2OCAyMS4wMzMgMTIxLjI2OCAyMi4xMTY3WiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMTMxLjc4NyAxNi4zOTQ5SDEzNy40ODFDMTM5LjIxOSAxNi4zOTQ5IDE0MC40MzYgMTYuNjk4MyAxNDEuMTc1IDE3LjM0ODVDMTQxLjkxNCAxNy45OTg4IDE0Mi4yNjIgMTkuMDgyNCAxNDIuMjYyIDIwLjU1NjNWMjcuNzk1M0gxMzkuMjE5VjIwLjk0NjRDMTM5LjIxOSAyMC4wNzk0IDEzOS4wODkgMTkuNTE1OSAxMzguODI4IDE5LjI5OTJDMTM4LjU2NyAxOS4wMzkxIDEzOC4wNDYgMTguOTA5MSAxMzcuMjIgMTguOTA5MUgxMzQuNzg2VjI3LjgzODZIMTMxLjc0M1YxNi4zOTQ5SDEzMS43ODdaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDMuNzM3NDNIMFYxMC44NDY0SDcuMTI4MzFWMy43Mzc0M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTIzLjI1MTMgLTIuMTU3MjVlLTA1TDE4LjU1MTMgNS41MTY4NUwyNC4wODMxIDEwLjIwNDFMMjguNzgzMSA0LjY4NzI1TDIzLjI1MTMgLTIuMTU3MjVlLTA1WiIgZmlsbD0iI0ZGODYwMCIvPgo8cGF0aCBkPSJNMTUuNjA0MSAzLjczNzQzSDguNDc1ODNWMTAuODQ2NEgxNS42MDQxVjMuNzM3NDNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik03LjEyODMxIDEyLjE5MDJIMFYxOS4yOTkySDcuMTI4MzFWMTIuMTkwMloiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMTIuMTkwMkg4LjQ3NTgzVjE5LjI5OTJIMTUuNjA0MVYxMi4xOTAyWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMDc5NyAxMi4xOTAySDE2Ljk1MTRWMTkuMjk5MkgyNC4wNzk3VjEyLjE5MDJaIiBmaWxsPSIjRkY4NjAwIi8+CjxwYXRoIGQ9Ik03LjEyODMxIDIwLjY4NjNIMFYyNy43OTUzSDcuMTI4MzFWMjAuNjg2M1oiIGZpbGw9IiMzNTQzQTgiLz4KPHBhdGggZD0iTTE1LjYwNDEgMjAuNjg2M0g4LjQ3NTgzVjI3Ljc5NTNIMTUuNjA0MVYyMC42ODYzWiIgZmlsbD0iIzM1NDNBOCIvPgo8cGF0aCBkPSJNMjQuMTIzMiAyMC42ODYzSDE2Ljk5NDlWMjcuNzk1M0gyNC4xMjMyVjIwLjY4NjNaIiBmaWxsPSIjMzU0M0E4Ii8+CjxwYXRoIGQ9Ik0xNDYgMTUuODMxM0MxNDYgMTYuODcxNyAxNDUuMTc0IDE3LjY5NTMgMTQ0LjEzMSAxNy42OTUzQzE0My4wODggMTcuNjk1MyAxNDIuMjYyIDE2Ljg3MTcgMTQyLjI2MiAxNS44MzEzQzE0Mi4yNjIgMTQuNzkxIDE0My4wODggMTQuMDEwNyAxNDQuMTMxIDE0LjAxMDdDMTQ1LjEzMSAxMy45Njc0IDE0NiAxNC43OTEgMTQ2IDE1LjgzMTNaTTE0Mi45NTcgMTQuNzkxQzE0Mi42OTcgMTUuMDUxMSAxNDIuNTY2IDE1LjQ0MTIgMTQyLjU2NiAxNS44MzEzQzE0Mi41NjYgMTYuNjk4MyAxNDMuMjYyIDE3LjM5MTggMTQ0LjEzMSAxNy4zOTE4QzE0NSAxNy4zOTE4IDE0NS42OTYgMTYuNjk4MyAxNDUuNjk2IDE1LjgzMTNDMTQ1LjY5NiAxNS4wMDc3IDE0NSAxNC4yNzA4IDE0NC4xNzQgMTQuMjcwOEMxNDMuNjUzIDE0LjI3MDggMTQzLjI2MiAxNC40NDQyIDE0Mi45NTcgMTQuNzkxWk0xNDQuODcgMTYuOTE1SDE0NC40NzlMMTQzLjkxNCAxNi4wOTE0VjE2LjkxNUgxNDMuNjA5VjE0Ljc0NzZIMTQzLjk1N0MxNDQuNDM1IDE0Ljc0NzYgMTQ0LjY1MyAxNC45NjQ0IDE0NC42NTMgMTUuMzU0NUMxNDQuNjUzIDE1LjY1NzkgMTQ0LjQ3OSAxNS44NzQ3IDE0NC4xNzQgMTUuOTYxNEwxNDQuODcgMTYuOTE1Wk0xNDQuMDQ0IDE1LjY1NzlDMTQ0LjI2MSAxNS42NTc5IDE0NC4zOTIgMTUuNTI3OSAxNDQuMzkyIDE1LjM1NDVDMTQ0LjM5MiAxNS4xMzc4IDE0NC4yNjEgMTUuMDUxMSAxNDQuMDAxIDE1LjA1MTFIMTQzLjkxNFYxNS42NTc5SDE0NC4wNDRaIiBmaWxsPSIjMzU0M0E4Ii8+Cjwvc3ZnPgo=" style="
    text-align: left;
    width: 146px;
    position: absolute;
    top: 14px;
    left: 31px;
">
            </div>
            <div style="
    position: relative;
    top: 80px;
    left: 32px;
    font-size: 20px;
    text-align: left;
    font-weight: 700;
    letter-spacing: 0.02em;
    font-style: normal;
    line-height: 125%;
    ">Claim your FREE account and get a key in less than a minute</div>
            <ul style="
        font-size: 15px;
        font-weight: 400;
        color: #333333;
        letter-spacing: 0.01em;
        position: relative;
        left: 32px;
        top: 88px;
        line-height: 180%;
        ">
                <li><span>Access to a 30-day free trial of any of our products.</span></li>
                <li><span>Access to 24x5 support by developers via the <a href="https://support.syncfusion.com/create?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">support tickets</a>, <a href="https://www.syncfusion.com/forums?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">forum</a>, <a href="https://www.syncfusion.com/feedback?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">feature &amp; feedback page</a> and chat.</span></li>
                <li><span>200+ <a href="https://www.syncfusion.com/succinctly-free-ebooks?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">ebooks </a>on the latest technologies, industry trends, and research topics.</span>
                </li>
                <li><span>Largest collection of over 7500 flat and wireframe icons for free with Syncfusion<sup>\xAE</sup> <a href="https://www.syncfusion.com/downloads/metrostudio?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">Metro Studio.</a></span></li>
                <li><span>Free and unlimited access to Syncfusion<sup>\xAE</sup> technical <a href="https://www.syncfusion.com/blogs/?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information
                " style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">blogs</a> and <a href="https://www.syncfusion.com/resources/techportal/whitepapers?utm_source=es_license_validation_banner&utm_medium=listing&utm_campaign=license-information" style="text-decoration: none;
                color: #0D6EFD;
                font-weight: 500;">whitepapers.</a></span></li>
            </ul>
            <div style="
            font-size: 18px;
            font-weight: 700;
            position: relative;
            line-height: 125%;
            letter-spacing: 0.02em;
            top: 90px;
            left: 32px;
    ">Syncfusion is trusted by 29,000+ businesses worldwide</div>
            <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIyMzAiIGhlaWdodD0iMTU2Ij4KPHBhdGggZD0iTTAgMCBDMTAuMjAxNTE3OTEgOC44MjE1MTgwNSAxNi4yMjU4NjAxNyAxOS4zODQ1MTIyMiAxNy4yODEyNSAzMi45NzI2NTYyNSBDMTcuNDE3OTUwMTYgNDUuOTc2MjU4NTUgMTMuMTkyNTE4MDQgNTcuNjM2ODk1NzMgNC4yNDYwOTM3NSA2Ny4xMzI4MTI1IEMtNS44MzQzNzk4NyA3Ni42NDQzNzA1IC0xNi43MjM2MTUyMyA4MC40NzU4MTc3IC0zMC40MTAxNTYyNSA4MC4yMjI2NTYyNSBDLTQzLjEyNjA0NDAyIDc5LjI2MTgzMzU2IC01NC4yMDMwOTQ1MyA3My40MDM0NzMyNCAtNjIuNzE4NzUgNjMuOTcyNjU2MjUgQy03MS4xNDgwNjkyNSA1MS44OTg2NTk5MiAtNzMuMTk0NzM3MSA0MC4zOTM3NzYxNCAtNzEuNzE4NzUgMjUuOTcyNjU2MjUgQy02OS4wOTkxNjQzNyAxNC41NTg3NDc0NCAtNjIuMzc0NTczNzggNC42NDI1NDI1NiAtNTIuNzE4NzUgLTIuMDI3MzQzNzUgQy0zNS45MDE4NDE2MSAtMTEuOTUyMDc2NTcgLTE1Ljg5MjUyMDU5IC0xMi4xNTE1ODYzNiAwIDAgWiAiIGZpbGw9IiMwODY4NDIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzODguNzE4NzUsNDIuMDI3MzQzNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMzY3MjM5MTYgNC4wNDIzMjQxMSAxMS4xMDI1Mzc1MyAxMS4zOTA0MDEzMyAxNCAxOSBDMTQuMzg5NjU4MjYgMjAuOTg5NzkzMzQgMTQuNzQwMDUyODkgMjIuOTg5MTQ0ODEgMTUgMjUgQzE1LjY2IDI1IDE2LjMyIDI1IDE3IDI1IEMxNy4xMDA1NDY4NyAyNC4xNDQwNjI1IDE3LjIwMTA5Mzc1IDIzLjI4ODEyNSAxNy4zMDQ2ODc1IDIyLjQwNjI1IEMxOC45MTc0Mjc1NSAxNC41MDU2MzU4IDIzLjYwODM5NDI3IDUuNzcxNDMyNzMgMzAuMTc5Njg3NSAwLjg5NDUzMTI1IEMzMy43MzEzMzY1NCAtMC44NTA4MDcwMSAzNi4wNzI1NTM3NiAtMC42MjM0MDQxNyA0MCAwIEM0Ny43ODg2NDkxMyAzLjU4Mjc3ODYgNTEuMzQ3MDc2MTEgMTAuOTI1MDE3NDYgNTQuMzUyNzgzMiAxOC41ODg4NjcxOSBDNjAuNjYxMjYyNjMgMzUuNzMzMjUxOTkgNjMuMjM3ODY0ODggNTQuNDE0MDMxNTkgNjMuMDYyNSA3Mi42MjUgQzYzLjA1Nzk4ODI4IDczLjUzMzc4OTA2IDYzLjA1MzQ3NjU2IDc0LjQ0MjU3ODEyIDYzLjA0ODgyODEyIDc1LjM3ODkwNjI1IEM2My4wMzcyMTIwMiA3Ny41ODU5NjY5NSA2My4wMTkyODQ1MyA3OS43OTI5OTI5OSA2MyA4MiBDNTkuMDQgODIgNTUuMDggODIgNTEgODIgQzUwLjkzMDA2ODM2IDgwLjkwMzQ5MTIxIDUwLjg2MDEzNjcyIDc5LjgwNjk4MjQyIDUwLjc4ODA4NTk0IDc4LjY3NzI0NjA5IEM1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyA1MC4zMzA4MzIxNSA0MS45ODYzMDU3MyAzOSA4IEMzOC4wMSA3LjY3IDM3LjAyIDcuMzQgMzYgNyBDMjUuMTQyMTkxNjggMTYuMjQ0MTIxMzEgMjQuODI2NDcwMzkgMzguNDA3NTg2NzUgMjMuNjgzNTkzNzUgNTEuNjcyMzYzMjggQzIzLjA0MTM0NzcxIDU5Ljc3NjY1NDY5IDIyLjUwMDE0OTM2IDY3Ljg4NTgxMjE3IDIyIDc2IEMxOC4wNCA3NiAxNC4wOCA3NiAxMCA3NiBDOS44OTUxMDI1NCA3NC40NzU4NDQ3MyA5Ljg5NTEwMjU0IDc0LjQ3NTg0NDczIDkuNzg4MDg1OTQgNzIuOTIwODk4NDQgQzkuMjg4Njk2MTIgMzkuNjQwNjkzMTMgOS4yODg2OTYxMiAzOS42NDA2OTMxMyAtMSA5IEMtMy4wMzU2NDA0IDcuNzQxNDM2NTkgLTMuMDM1NjQwNCA3Ljc0MTQzNjU5IC01IDcgQy0xNS44NDgzODY5NyAxNi40OTIzMzg2IC0xNi4wNTg3MjYyNSA0MC4yNTk3NTY0MSAtMTcgNTQgQy0xNy40NzQyMTEwMiA2My4zMjgyOTc4NCAtMTcuNzQ3NjYxNTkgNzIuNjYzNDc4NzQgLTE4IDgyIEMtMjIuMjkgODIgLTI2LjU4IDgyIC0zMSA4MiBDLTMxLjg5MjU5MjA1IDU1LjgxNzI5OTc3IC0yOS45NTA2NDQ2MiAyMi44Mzc1NTI0MSAtMTIgMiBDLTguNDczMzg5NDMgLTAuNjQ0OTU3OTMgLTQuMjE5NTgzOTggLTAuOTU4OTk2MzYgMCAwIFogIiBmaWxsPSIjRkZDQzAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MjgsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzUuODg3MjkwNzMgMS40NDk4NTUxOCA5LjE2NjM4NTEzIDEuMjgxNTYyNTYgMTQuNzUgLTAuODM5ODQzNzUgQzIwLjM1Nzc0OTYyIC0yLjU0NjE0OTE0IDI1LjU0MDY3MjkyIC0xLjM4Mjk1NTEgMzAuNjI1IDEuMjUgQzMyLjkzNzM1MDYzIDMuMjczMzA2OCAzNC4xMDM0MzU0MiA0LjU3NzExOTE4IDM1LjEyNSA3LjQzNzUgQzM0LjM0MTI1IDguMTggMzMuNTU3NSA4LjkyMjUgMzIuNzUgOS42ODc1IEMyOS4xMTkwMTcwMyAxMy40OTEzODY5MiAyOC4yMzgzODk0NyAxNS4wMzE0NzA1OCAyNy44MTI1IDIwLjMxMjUgQzI3Ljk2MDg4MjA0IDI1LjAxNzA4MzQ0IDI5LjE5MzUzOTM2IDI4LjU3NDg0NDU4IDMyLjY2MDE1NjI1IDMxLjkxNzk2ODc1IEMzNC4xMDgzOTEwMSAzMy4xNDAyMzc4IDM1LjYxMjk3ODE1IDM0LjI5NTA4MzQ5IDM3LjEyNSAzNS40Mzc1IEMzNi4wNzAxOTM1MiA0Mi40Njk1NDMyIDMyLjAzNjA5MDQ5IDQ3Ljk3MzE5OTEgMjcuNzUgNTMuNSBDMjQuMjczODU5MzcgNTYuMDY1NzIyODUgMjEuNDA5Njc2NTkgNTYuNjI0MTU5MTggMTcuMTI1IDU2LjQzNzUgQzE1LjExMjc3OTUzIDU1LjgwODY4MTEgMTMuMTEyMjMyNjggNTUuMTQxMzExNTcgMTEuMTI1IDU0LjQzNzUgQzcuMTMyMjAwNjEgNTQuMDEwODUwMDcgMy44Njk5NzIwNCA1NC4xNzkwNDAzMSAwLjA2MjUgNTUuNSBDLTMuNzQ1OTgyNzYgNTYuNzE1NDczMjIgLTYuMDIwMDcxMDYgNTYuNDcwMDcwMjUgLTkuODc1IDU1LjQzNzUgQy0xNy44OTY4MjA0OCA1MC4zNjI0NzA3MiAtMjMuMjI0ODkxNjcgNDAuMjQ1NjM5MjYgLTI1LjQzMzU5Mzc1IDMxLjEzMjgxMjUgQy0yNi42OTE4Nzk2IDIzLjQ0OTQ3NDE1IC0yNy4zMTA4Njc4MiAxNC4yMDI1NjkzMiAtMjIuODc1IDcuNDM3NSBDLTE5LjE4NzExNTEzIDMuMTY0NjQwMjkgLTE0Ljk1ODc1MDk1IC0wLjQ2NDczMTYxIC05LjI2NTYyNSAtMS41NzQyMTg3NSBDLTYuMDIyMDAxNTYgLTEuNTU4MzE4NjQgLTMuMTQ1MDkxMDYgLTAuNzc5NDY1MjEgMCAwIFogIiBmaWxsPSIjMDAwMDAwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjIuODc1LDU1LjU2MjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTk4NjY1NzYgNi41NjU2MTQ1OCAxMy4yMzU0MjQ3IDEzLjIxNDc1OTU1IDE0LjE3OTY4NzUgMjMuMTg3NSBDMTMuOTYxMTk2MzQgMjguMjczOTc0MSAxMi4yNTY2NDk1NCAzMi4wNjY5ODMyNiA5LjAzNTE1NjI1IDM1Ljk3NjU2MjUgQzAuNTMzMzg4MDQgNDMuNTgzNDA3NzQgLTguOTc3NTY4MjUgNDUuMDAzODkwNjcgLTE5Ljg1NTQ2ODc1IDQ0Ljg5ODQzNzUgQy0yMS4xODA5NDcyNyA0NC44OTE2Njk5MiAtMjEuMTgwOTQ3MjcgNDQuODkxNjY5OTIgLTIyLjUzMzIwMzEyIDQ0Ljg4NDc2NTYyIEMtMjQuNzAzMTU0MzQgNDQuODczMDM2MTYgLTI2Ljg3MzA3MDQ3IDQ0Ljg1NTEwMjQ1IC0yOS4wNDI5Njg3NSA0NC44MzU5Mzc1IEMtMjkuMzcyOTY4NzUgNDUuNDk1OTM3NSAtMjkuNzAyOTY4NzUgNDYuMTU1OTM3NSAtMzAuMDQyOTY4NzUgNDYuODM1OTM3NSBDLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTMyLjQxNzk2ODc1IDQ2Ljk2MDkzNzUgLTM1LjA0Mjk2ODc1IDQ2LjgzNTkzNzUgQy0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy4wNDI5Njg3NSA0NC44MzU5Mzc1IC0zNy40MTQwNjI1IDQyLjM1NTQ2ODc1IEMtMzcuNzgyMzI5OTcgMzkuNzMzNjQ1MzEgLTM3Ljc4MjMyOTk3IDM5LjczMzY0NTMxIC0zOS44MjgxMjUgMzguNTM1MTU2MjUgQy00MC41Nzk2NDg0NCAzOC4yMDEyODkwNiAtNDEuMzMxMTcxODcgMzcuODY3NDIxODcgLTQyLjEwNTQ2ODc1IDM3LjUyMzQzNzUgQy00Ny4zNTI0NjU4MyAzNC44NTM3NjUzOCAtNTEuNDU1NzUyNzEgMzEuNTMwNDMxOTUgLTU1LjA0Mjk2ODc1IDI2LjgzNTkzNzUgQy01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMy4zMzU5Mzc1IC01Ni4wNDI5Njg3NSAyMC44MzU5Mzc1IEMtNTEuMzM2NTk3OTUgMTYuMTI5NTY2NyAtNDUuMzAzOTE4MTcgMTQuNTc0NTc2MzMgLTM5LjA0Mjk2ODc1IDEyLjgzNTkzNzUgQy0zOC4zODI5Njg3NSAxMi44MzU5Mzc1IC0zNy43MjI5Njg3NSAxMi44MzU5Mzc1IC0zNy4wNDI5Njg3NSAxMi44MzU5Mzc1IEMtMzYuOTIxNzk2ODggMTEuOTA5MTAxNTYgLTM2LjgwMDYyNSAxMC45ODIyNjU2MiAtMzYuNjc1NzgxMjUgMTAuMDI3MzQzNzUgQy0zNi41MDgyMDMxMyA4LjgyOTgwNDY5IC0zNi4zNDA2MjUgNy42MzIyNjU2MyAtMzYuMTY3OTY4NzUgNi4zOTg0Mzc1IEMtMzYuMDA1NTQ2ODggNS4yMDM0NzY1NiAtMzUuODQzMTI1IDQuMDA4NTE1NjMgLTM1LjY3NTc4MTI1IDIuNzc3MzQzNzUgQy0zNS40NjY5NTMxMyAxLjgwNjY3OTY5IC0zNS4yNTgxMjUgMC44MzYwMTU2MyAtMzUuMDQyOTY4NzUgLTAuMTY0MDYyNSBDLTM0LjM4Mjk2ODc1IC0wLjQ5NDA2MjUgLTMzLjcyMjk2ODc1IC0wLjgyNDA2MjUgLTMzLjA0Mjk2ODc1IC0xLjE2NDA2MjUgQy0zMC4wNzc2OTExNyAxLjI4MTI3NiAtMjkuNDg3MTQ2NjEgMy4yODE5NjA5NyAtMjguODU1NDY4NzUgNy4wMjM0Mzc1IEMtMjguNjk2OTE0MDYgNy45MjQ0OTIxOSAtMjguNTM4MzU5MzggOC44MjU1NDY4OCAtMjguMzc1IDkuNzUzOTA2MjUgQy0yOC4yNjU0Mjk2OSAxMC40NDA5NzY1NiAtMjguMTU1ODU5MzcgMTEuMTI4MDQ2ODcgLTI4LjA0Mjk2ODc1IDExLjgzNTkzNzUgQy0yNy4xMjUxNTYyNSAxMS45MzM5MDYyNSAtMjYuMjA3MzQzNzUgMTIuMDMxODc1IC0yNS4yNjE3MTg3NSAxMi4xMzI4MTI1IEMtMTguMDQ1MDgyNTkgMTMuMDEyMTUwNTIgLTEyLjIzNzYzMDI1IDEzLjk0OTA5MTA3IC02LjA0Mjk2ODc1IDE3LjgzNTkzNzUgQy00LjY2MTcxODU3IDIwLjU5ODQzNzg2IC00Ljg1MjE3NTY5IDIyLjc4MzI0ODQ5IC01LjA0Mjk2ODc1IDI1LjgzNTkzNzUgQy03LjA0Mjk2ODc1IDI3LjgzNTkzNzUgLTcuMDQyOTY4NzUgMjcuODM1OTM3NSAtMTAuNjY3OTY4NzUgMjcuOTYwOTM3NSBDLTExLjc4MTcxODc1IDI3LjkxOTY4NzUgLTEyLjg5NTQ2ODc1IDI3Ljg3ODQzNzUgLTE0LjA0Mjk2ODc1IDI3LjgzNTkzNzUgQy0xMy4zODI5Njg3NSAyNi41MTU5Mzc1IC0xMi43MjI5Njg3NSAyNS4xOTU5Mzc1IC0xMi4wNDI5Njg3NSAyMy44MzU5Mzc1IEMtMTUuNzk1MjI3MTUgMjIuMTc5MDk2MTMgLTE5LjMwNjQ5OTM2IDIxLjMzMzg1NTg3IC0yMy4zNTU0Njg3NSAyMC43MTA5Mzc1IEMtMjUuMjMyMzQzNzUgMjAuNDIyMTg3NSAtMjcuMTA5MjE4NzUgMjAuMTMzNDM3NSAtMjkuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjU0Nzk2ODc1IDI4LjI1MDkzNzUgLTI4LjA0Mjk2ODc1IDM2LjgzNTkzNzUgQy0xMi4wNjE3Nzk5MSAzNy4zODI2NDE3MiAtMTIuMDYxNzc5OTEgMzcuMzgyNjQxNzIgMi4wODIwMzEyNSAzMC42NDg0Mzc1IEM0Ljc2MDcwNTQxIDI2LjYzMDQyNjI2IDQuNzc1MjY3NDcgMjMuNTI1MDYwNDMgMy45NTcwMzEyNSAxOC44MzU5Mzc1IEMxLjAxMTM1NTYzIDguNTI2MDcyODEgLTguODY3NTEyMiAyLjM4NDg3MDU4IC0xNy43MzQzNzUgLTIuNTYyNSBDLTMxLjY3NjMzMzk0IC05LjMxMTI2NDA3IC00NS42NDMxNzQyMiAtMTEuNTY4NzI4NjMgLTYxLjA0Mjk2ODc1IC0xMS4xNjQwNjI1IEMtNjEuMDQyOTY4NzUgLTEwLjE3NDA2MjUgLTYxLjA0Mjk2ODc1IC05LjE4NDA2MjUgLTYxLjA0Mjk2ODc1IC04LjE2NDA2MjUgQy02My4wMjI5Njg3NSAtOC4xNjQwNjI1IC02NS4wMDI5Njg3NSAtOC4xNjQwNjI1IC02Ny4wNDI5Njg3NSAtOC4xNjQwNjI1IEMtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjcuNzkyOTY4NzUgLTkuOTE0MDYyNSAtNjguMDQyOTY4NzUgLTEyLjE2NDA2MjUgQy02NS45Njg1NDMxOCAtMTUuNTIyNjU2MjggLTYzLjQ3ODY1NTM5IC0xNi41NTA0NzkzNSAtNTkuNzkyOTY4NzUgLTE3LjQ3NjU2MjUgQy0zOS4xODA0NTMyNSAtMjAuODM2MzExNzIgLTE1Ljg1MjQ2NDU2IC0xMy4zOTczMDI3NCAwIDAgWiBNLTQ3LjM1NTQ2ODc1IDIwLjgzNTkzNzUgQy00OC4yMzg0NzY1NiAyMS4wMjE1NjI1IC00OS4xMjE0ODQzOCAyMS4yMDcxODc1IC01MC4wMzEyNSAyMS4zOTg0Mzc1IEMtNTAuNjk1MTE3MTkgMjEuNTQyODEyNSAtNTEuMzU4OTg0MzcgMjEuNjg3MTg3NSAtNTIuMDQyOTY4NzUgMjEuODM1OTM3NSBDLTUyLjUwMDI0MDQ0IDI1LjcyNDc4Mzk5IC01Mi41MDAyNDA0NCAyNS43MjQ3ODM5OSAtNTAuNTAzOTA2MjUgMjcuNDY4NzUgQy00Ni40NjI2MDg1IDMwLjM1OTcxNTgxIC00Mi45NDE1MjEwNyAzMi42MTEyOTk0MiAtMzguMDQyOTY4NzUgMzMuODM1OTM3NSBDLTM2LjcwMzk1MDgzIDMyLjcyNDY3MDkxIC0zNi43MDM5NTA4MyAzMi43MjQ2NzA5MSAtMzYuOTQ1MzEyNSAyOS44OTQ1MzEyNSBDLTM2Ljk1NjkxNDA2IDI4LjY5OTU3MDMxIC0zNi45Njg1MTU2MyAyNy41MDQ2MDkzOCAtMzYuOTgwNDY4NzUgMjYuMjczNDM3NSBDLTM2Ljk4OTQ5MjE5IDI1LjA3NTg5ODQ0IC0zNi45OTg1MTU2MiAyMy44NzgzNTkzOCAtMzcuMDA3ODEyNSAyMi42NDQ1MzEyNSBDLTM3LjAxOTQxNDA2IDIxLjcxNzY5NTMxIC0zNy4wMzEwMTU2MyAyMC43OTA4NTkzNyAtMzcuMDQyOTY4NzUgMTkuODM1OTM3NSBDLTQwLjYzODE2MTY3IDE5LjczMjI5MjMgLTQzLjg0MDg2MTA3IDIwLjA4NjE1NDUzIC00Ny4zNTU0Njg3NSAyMC44MzU5Mzc1IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NTEuMDQyOTY4NzUsNTguMTY0MDYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTMuOTk1NTQ4MTcgOC40NTIxMjExMyAxNi45NDE0Njg4MSAxNy4xNzE5NjY3OSAyMCAyNiBDMjAuMzMgMTcuNDIgMjAuNjYgOC44NCAyMSAwIEMyNC42MyAwIDI4LjI2IDAgMzIgMCBDMzIgMTguNDggMzIgMzYuOTYgMzIgNTYgQzI4IDU3IDI4IDU3IDIwIDU3IEMxNy4zNiA0OS40MSAxNC43MiA0MS44MiAxMiAzNCBDMTEuNjcgNDIuMjUgMTEuMzQgNTAuNSAxMSA1OSBDNS41NTUgNTkuNDk1IDUuNTU1IDU5LjQ5NSAwIDYwIEMwIDQwLjIgMCAyMC40IDAgMCBaICIgZmlsbD0iI0Q4MUYyNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTk1LDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjE3MDQ2ODc1IDAuMDI3MDcwMzEgMi4zNDA5Mzc1IDAuMDU0MTQwNjMgMy41NDY4NzUgMC4wODIwMzEyNSBDNC40Mzg5MDYyNSAwLjExNjgzNTk0IDUuMzMwOTM3NSAwLjE1MTY0MDYyIDYuMjUgMC4xODc1IEM3LjUzODE4NzMxIDYuMjE4NDU0OTcgOC44MTk3NDQ4OSAxMi4yNTA3NjY0NyAxMC4wOTUyMTQ4NCAxOC4yODQ0MjM4MyBDMTAuNTI5OTIzMzUgMjAuMzM2MjQxNDggMTAuOTY2NDMxOTEgMjIuMzg3Njc4NjMgMTEuNDA0Nzg1MTYgMjQuNDM4NzIwNyBDMTIuMDM1MDI5NTggMjcuMzg5MTUwNjYgMTIuNjU4NzU5NzQgMzAuMzQwODk0MzcgMTMuMjgxMjUgMzMuMjkyOTY4NzUgQzEzLjQ3ODExNDAxIDM0LjIwNzczNDgzIDEzLjY3NDk3ODAzIDM1LjEyMjUwMDkyIDEzLjg3NzgwNzYyIDM2LjA2NDk4NzE4IEMxNC4wNTc5OTQzOCAzNi45MjU1MDE4NiAxNC4yMzgxODExNSAzNy43ODYwMTY1NCAxNC40MjM4MjgxMiAzOC42NzI2MDc0MiBDMTQuNTgzNzEyMTYgMzkuNDI1Mzk0NzQgMTQuNzQzNTk2MTkgNDAuMTc4MTgyMDcgMTQuOTA4MzI1MiA0MC45NTM3ODExMyBDMTUuMjUgNDMuMTg3NSAxNS4yNSA0My4xODc1IDE1LjI1IDQ4LjE4NzUgQzExLjI5IDQ4LjE4NzUgNy4zMyA0OC4xODc1IDMuMjUgNDguMTg3NSBDMi45MiA0NS44Nzc1IDIuNTkgNDMuNTY3NSAyLjI1IDQxLjE4NzUgQy0yLjcgNDEuNTE3NSAtNy42NSA0MS44NDc1IC0xMi43NSA0Mi4xODc1IEMtMTMuNDEgNDQuMTY3NSAtMTQuMDcgNDYuMTQ3NSAtMTQuNzUgNDguMTg3NSBDLTE5LjM3IDQ4LjE4NzUgLTIzLjk5IDQ4LjE4NzUgLTI4Ljc1IDQ4LjE4NzUgQy0yNi44MDgzMTEyNiA0Mi4yMDY0MzQ4NSAtMjQuNzAyMzE0NTggMzYuMzU1OTk3NzMgLTIyLjMxNjQwNjI1IDMwLjUzOTA2MjUgQy0yMS45OTcxOTcxMSAyOS43NTk4NTQ0MyAtMjEuNjc3OTg3OTggMjguOTgwNjQ2MzYgLTIxLjM0OTEwNTgzIDI4LjE3NzgyNTkzIEMtMjAuNjc5NDY4MTMgMjYuNTQ4NjI2IC0yMC4wMDc5ODYzNCAyNC45MjAxODI4OSAtMTkuMzM0NzE2OCAyMy4yOTI0ODA0NyBDLTE4LjY0OTcxMDY3IDIxLjYzMDYwMDMgLTE3Ljk3MDA3MDg4IDE5Ljk2NjQ5ODY1IC0xNy4yOTU2NTQzIDE4LjMwMDI5Mjk3IEMtMTYuMzEzOTk1MTggMTUuODc1MDE3NSAtMTUuMzE3MDg2OTUgMTMuNDU2NTQxMzggLTE0LjMxNjQwNjI1IDExLjAzOTA2MjUgQy0xNC4wMTgzNTU4NyAxMC4yOTUzMjM3OSAtMTMuNzIwMzA1NDggOS41NTE1ODUwOCAtMTMuNDEzMjIzMjcgOC43ODUzMDg4NCBDLTEwLjMyNjYxNzczIDEuNDMzOTIzMTMgLTcuOTE5NDc2MjUgLTAuMjM3NTg0MjkgMCAwIFogTS0zLjc1IDE1LjE4NzUgQy01LjQgMjAuMTM3NSAtNy4wNSAyNS4wODc1IC04Ljc1IDMwLjE4NzUgQy02LjExIDMwLjE4NzUgLTMuNDcgMzAuMTg3NSAtMC43NSAzMC4xODc1IEMtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMS40MDM0OTYzMyAyMi42MzcxMTU3OCAtMi43NSAxNS4xODc1IEMtMy4wOCAxNS4xODc1IC0zLjQxIDE1LjE4NzUgLTMuNzUgMTUuMTg3NSBaICIgZmlsbD0iIzIzNDM5QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcwLjc1LDUzLjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNzg5Mjg3NzggMi4zMDgzNzYwOSAzLjc1MTc2ODg4IDQuMjY1OTI4MzQgNC4yNzM0Mzc1IDcuOTEwMTU2MjUgQzQuNjM2ODE4NzQgMTUuNjExMDQzMzQgMS45NDAyMDM5IDIxLjI4NjM5NDY0IC0yLjc5Njg3NSAyNy4yNjk1MzEyNSBDLTkuMDAxNDUwMzQgMzMuOTU4MDYzNDcgLTE1LjA5NjEwOTIxIDM3LjE0MTAyMzg5IC0yNC4yNSAzNy41IEMtMjguMDQyMTE1NTYgMzcuMzY0OTExOTEgLTI5Ljc2NDgxODA0IDM3LjEzMTcwMTkgLTMzLjEyNSAzNS4yNSBDLTM2LjYxNDUyNjY5IDMxLjA2MjU2Nzk3IC0zNy40NTgyNTE2IDI3Ljc5OTc2MzM3IC0zNy4zMDg1OTM3NSAyMi40Mjk2ODc1IEMtMzYuMzE4MDI0MjMgMTQuNjMwNTE5ODYgLTMxLjc1MTQwMDU4IDguMTU2MDQwNzUgLTI2IDMgQy0xNy42OTY1MDc2NiAtMi42NTI1NDYzMSAtOS4yMjAwNTQ5MyAtNS42NTc3NjA5OCAwIDAgWiAiIGZpbGw9IiMwNjg4MkYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNzQ5ODUzMjUgLTAuMDg3MTc0NyA3LjQ5OTQ0NTU1IC0wLjE0MDQ1MDAzIDExLjI1IC0wLjE4NzUgQzEyLjMxMzQ3NjU2IC0wLjIxMjYzNjcyIDEzLjM3Njk1MzEyIC0wLjIzNzc3MzQ0IDE0LjQ3MjY1NjI1IC0wLjI2MzY3MTg4IEMxNS40OTc0NjA5NCAtMC4yNzMzMzk4NCAxNi41MjIyNjU2MyAtMC4yODMwMDc4MSAxNy41NzgxMjUgLTAuMjkyOTY4NzUgQzE4LjUyMDc1MTk1IC0wLjMwODY3OTIgMTkuNDYzMzc4OTEgLTAuMzI0Mzg5NjUgMjAuNDM0NTcwMzEgLTAuMzQwNTc2MTcgQzIzLjU2MjEwMzM5IDAuMDc0NjIyNTkgMjQuODI1NjM1MDMgMC43MTY2NzQ2NSAyNyAzIEMyNy45MTMwODU5NCA1LjYzNTQ5ODA1IDI3LjkxMzA4NTk0IDUuNjM1NDk4MDUgMjguNDg0Mzc1IDguNzYxNzE4NzUgQzI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI4LjgwMzQxNzk3IDEwLjQzOTExMTMzIDI5LjEyODkwNjI1IDEyLjE1MDM5MDYyIEMyOS4zMzM4NjcxOSAxMy4zMTc2MzY3MiAyOS41Mzg4MjgxMiAxNC40ODQ4ODI4MSAyOS43NSAxNS42ODc1IEMyOS45NzA0Mjk2OSAxNi44NjYzNDc2NiAzMC4xOTA4NTkzOCAxOC4wNDUxOTUzMSAzMC40MTc5Njg3NSAxOS4yNTk3NjU2MiBDMzAuOTYwMTAyNjQgMjIuMTcwNzg4OTEgMzEuNDg2NzY4MjIgMjUuMDgzNzY2MzEgMzIgMjggQzM1LjA3NTc1MDg3IDIxLjMyMzQ4NDU3IDM4LjA0NTYyMTcyIDE0LjYyMjgwNzQ2IDQwLjgxMjUgNy44MTI1IEM0MS4xMjM4MDg1OSA3LjA1MTMwODU5IDQxLjQzNTExNzE5IDYuMjkwMTE3MTkgNDEuNzU1ODU5MzggNS41MDU4NTkzOCBDNDIuNTA1ODE1MTcgMy42NzEzNTIxMyA0My4yNTMxOTk4MiAxLjgzNTc5NDExIDQ0IDAgQzQ4LjI5IDAgNTIuNTggMCA1NyAwIEM1NS44NzQ5NzQ1OCA2Ljc1MDE1MjU0IDU1Ljg3NDk3NDU4IDYuNzUwMTUyNTQgNTQuMzQxNzk2ODggMTAuMzIxMjg5MDYgQzU0LjAwNDc0NzMxIDExLjExNTIxMDU3IDUzLjY2NzY5Nzc1IDExLjkwOTEzMjA4IDUzLjMyMDQzNDU3IDEyLjcyNzExMTgyIEM1Mi45NTY4Nzg2NiAxMy41NjQ4MjExNyA1Mi41OTMzMjI3NSAxNC40MDI1MzA1MiA1Mi4yMTg3NSAxNS4yNjU2MjUgQzUxLjg0NTIwMzg2IDE2LjE0MDIzMzc2IDUxLjQ3MTY1NzcxIDE3LjAxNDg0MjUzIDUxLjA4Njc5MTk5IDE3LjkxNTk1NDU5IEM0OS44OTczNDQ2IDIwLjY5NjY1Mjc4IDQ4LjY5ODc0NTQ1IDIzLjQ3MzI5OTM5IDQ3LjUgMjYuMjUgQzQ2LjY5MzQyMDAxIDI4LjEzMjU1OTY1IDQ1Ljg4NzQyNDAyIDMwLjAxNTM2OTYzIDQ1LjA4MjAzMTI1IDMxLjg5ODQzNzUgQzQzLjYxMDkxMDIyIDM1LjMzMjU2NDA1IDQyLjEzODAzMjE4IDM4Ljc2NTkwNDg3IDQwLjY1ODIwMzEyIDQyLjE5NjI4OTA2IEM0MC4zNjE0MzY3NyA0Mi44ODQzNDYzMSA0MC4wNjQ2NzA0MSA0My41NzI0MDM1NiAzOS43NTg5MTExMyA0NC4yODEzMTEwNCBDMzkuMjA1MDIxMiA0NS41MzU2OTMxMSAzOC42MTMyMzIxNyA0Ni43NzM1MzU2NyAzOCA0OCBDMzMuMzggNDggMjguNzYgNDggMjQgNDggQzIzLjcxODAxNzU4IDQ2Ljg2OTgxNDQ1IDIzLjQzNjAzNTE2IDQ1LjczOTYyODkxIDIzLjE0NTUwNzgxIDQ0LjU3NTE5NTMxIEMyMi4wOTM1MjM1MyA0MC4zNzQ2MTE1MyAyMS4wMjMxNzA3NiAzNi4xNzg4ODk2NSAxOS45NDcyNjU2MiAzMS45ODQzNzUgQzE5LjQ4NDU3MjAzIDMwLjE2OTg5MDMxIDE5LjAyNjgzOTQ1IDI4LjM1NDEzMjkyIDE4LjU3NDIxODc1IDI2LjUzNzEwOTM4IEMxNy45MjE5MzU4OSAyMy45MjIyNTYxNiAxNy4yNTE4MjE4MSAyMS4zMTI1MzE3MyAxNi41NzgxMjUgMTguNzAzMTI1IEMxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNi4yODA5ODYwMiAxNy40ODcyODcyOSAxNS45Nzc4NDQyNCAxNi4yNDY4ODcyMSBDMTQuODEwMjA5MzQgMTEuODA0OTMzNDYgMTMuNzk5Njc2MzYgOC44OTA1NzQxMSAxMCA2IEM3LjQ0MzcyNDc1IDQuODk3OTA2NjcgNy40NDM3MjQ3NSA0Ljg5NzkwNjY3IDQuNzUgNC4yNSBDMy44NTc5Njg3NSA0LjAwNzY1NjI1IDIuOTY1OTM3NSAzLjc2NTMxMjUgMi4wNDY4NzUgMy41MTU2MjUgQzEuMzcxNDA2MjUgMy4zNDU0Njg3NSAwLjY5NTkzNzUgMy4xNzUzMTI1IDAgMyBDMCAyLjAxIDAgMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTI5NjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM2LDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjYzIDAgNy4yNiAwIDExIDAgQzE1IDkuNjI1IDE1IDkuNjI1IDE1IDEzIEMxNS42NiAxMyAxNi4zMiAxMyAxNyAxMyBDMTcuMTkzMzU5MzggMTIuMzk2NzE4NzUgMTcuMzg2NzE4NzUgMTEuNzkzNDM3NSAxNy41ODU5Mzc1IDExLjE3MTg3NSBDMTcuODQ2MzI4MTIgMTAuMzcyNjU2MjUgMTguMTA2NzE4NzUgOS41NzM0Mzc1IDE4LjM3NSA4Ljc1IEMxOC43NTc4NTE1NiA3LjU2NjY0MDYyIDE4Ljc1Nzg1MTU2IDcuNTY2NjQwNjIgMTkuMTQ4NDM3NSA2LjM1OTM3NSBDMjAgNCAyMCA0IDIyIDAgQzI1LjYzIDAgMjkuMjYgMCAzMyAwIEMzMS42MTIzNzc3OCA0LjQ4OTM2NjAxIDMwLjA5OTAyNzU4IDguODM1MTMyMDUgMjguMjA3MDMxMjUgMTMuMTM2NzE4NzUgQzI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjcyNjY1NDA1IDE0LjI0Mjg1NTIyIDI3LjIzNjU3MjI3IDE1LjM3MTMzNzg5IEMyNi41ODgzNzkzNiAxNi44NTIwMjc5OSAyNS45MjY0NjI4MyAxOC4zMjY4MDAwNiAyNS4yNDk3NTU4NiAxOS43OTQ2Nzc3MyBDMjEuMjM0Nzg2MTQgMjkuMDI3NTEyNzMgMjUuMDc1MDY3NzkgMzYuMzYzMTg5NTkgMjguNTYyNSA0NS4yNSBDMjkuNDAxNTk1MTQgNDcuMzk5MzA1OTEgMzAuMjM2NDQwNzggNDkuNTUwMjc3MTYgMzEuMDY2NDA2MjUgNTEuNzAzMTI1IEMzMS40MzcwOTIyOSA1Mi42NDgzMzAwOCAzMS44MDc3NzgzMiA1My41OTM1MzUxNiAzMi4xODk2OTcyNyA1NC41NjczODI4MSBDMzMgNTcgMzMgNTcgMzMgNjAgQzMxLjU2MTYzMjQ5IDU5Ljg4NTQxMzA3IDMwLjEyNDI5MDM0IDU5Ljc1NzkwODg0IDI4LjY4NzUgNTkuNjI1IEMyNy44ODY5OTIxOSA1OS41NTUzOTA2MyAyNy4wODY0ODQzOCA1OS40ODU3ODEyNSAyNi4yNjE3MTg3NSA1OS40MTQwNjI1IEMyNCA1OSAyNCA1OSAyMSA1NyBDMTkuNjEzMjgxMjUgNTMuOTYwOTM3NSAxOS42MTMyODEyNSA1My45NjA5Mzc1IDE4LjMxMjUgNTAuMzc1IEMxNy44NzU1MDc4MSA0OS4xODY0ODQzNyAxNy40Mzg1MTU2MyA0Ny45OTc5Njg3NSAxNi45ODgyODEyNSA0Ni43NzM0Mzc1IEMxNi42NjIxNDg0NCA0NS44NTgyMDMxMyAxNi4zMzYwMTU2MyA0NC45NDI5Njg3NSAxNiA0NCBDMTQuMjExNzgyMjYgNDYuNjgyMzI2NjEgMTIuNzk4NTczOTYgNDkuMzAyODg5NjEgMTEuMzc1IDUyLjE4NzUgQzEwLjkyODk4NDM4IDUzLjA4ODU1NDY5IDEwLjQ4Mjk2ODc1IDUzLjk4OTYwOTM4IDEwLjAyMzQzNzUgNTQuOTE3OTY4NzUgQzkuNjg1NzAzMTIgNTUuNjA1MDM5MDYgOS4zNDc5Njg3NSA1Ni4yOTIxMDkzNyA5IDU3IEM1LjcgNTYuNjcgMi40IDU2LjM0IC0xIDU2IEMtMC4zOTQ5ODQ5MyA0OS4xNzY3NzQ1NCAyLjkyNjY1MjAyIDQzLjQ2Njc3Nzg3IDUuOTM3NSAzNy40MzE2NDA2MiBDOC40NDU2MTQ0IDMyLjE0NzgyNjM3IDkuNzA2Nzk0NDIgMjguODM0MjUxNjYgOCAyMyBDNi43NTQ5MDE0NiAxOS41MzQxMTc5NSA1LjM3Mjc0NjExIDE2LjE0MTA0NzgxIDMuOTM3NSAxMi43NSBDMy4xOTE5Mjc4NyAxMC45NzU5MjA2OSAyLjQ1MDgyOTQ5IDkuMTk5OTUyNjcgMS43MTQ4NDM3NSA3LjQyMTg3NSBDMS4zODYwNTIyNSA2LjY0NDI0ODA1IDEuMDU3MjYwNzQgNS44NjY2MjEwOSAwLjcxODUwNTg2IDUuMDY1NDI5NjkgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDgxRTI1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTgzLDUyKSIvPgo8cGF0aCBkPSJNMCAwIEMtMC42NiAzLjYzIC0xLjMyIDcuMjYgLTIgMTEgQy0yLjgyNSAxMC44MzUgLTMuNjUgMTAuNjcgLTQuNSAxMC41IEMtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTEuNDA5NDk0MjQgOS40MzI1NTU0MyAtMTggMTEgQy0xNy45MDQ4MDU0NiAxMi44OTU3NjM2NiAtMTcuOTA0ODA1NDYgMTIuODk1NzYzNjYgLTE3IDE1IEMtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTQuNTcyODYxMyAxNi44NzM4MTgyMSAtMTEuNjI1IDE4LjUgQy03LjkzODczNzE5IDIwLjYzOTc4MzE2IC01LjIyOTM2OTIyIDIyLjMxNTc1MDIyIC0zIDI2IEMtMS41MDg4MTc1MSAzMS42NDUxOTA4NSAtMi4xNzg0MTgzNiAzNC45MjExNTMwNiAtNSA0MCBDLTkuMzQ2NDcyNTcgNDUuMTQ3MTM4NTcgLTEzLjQ5MjA4MjkgNDcuMDc2ODA4NDEgLTIwLjEyNSA0Ny43NSBDLTI1Ljk4NTQzMDQyIDQ4LjIyMDQyOTExIC0zMS4zMDM1NDk3NiA0Ny4zMzMyMTE3NiAtMzcgNDYgQy0zOC4wOTg5ODcwMiA0Mi43MDMwMzg5NSAtMzcuODcxMjQ0NDQgNDEuNTk1MDUwOTcgLTM3LjA2MjUgMzguMzEyNSBDLTM2Ljg2Nzg1MTU2IDM3LjUwNDI1NzgxIC0zNi42NzMyMDMxMyAzNi42OTYwMTU2MyAtMzYuNDcyNjU2MjUgMzUuODYzMjgxMjUgQy0zNi4zMTY2Nzk2OSAzNS4yNDgzOTg0NCAtMzYuMTYwNzAzMTIgMzQuNjMzNTE1NjMgLTM2IDM0IEMtMzQuODQ1IDM0LjMzIC0zMy42OSAzNC42NiAtMzIuNSAzNSBDLTI4LjE4MjA3NzU3IDM2LjA3MzcyODQ5IC0yNC40NDM3NDM0NCAzNi4zMDEyNzA3NCAtMjAgMzYgQy0xOS4wMSAzNS4zNCAtMTguMDIgMzQuNjggLTE3IDM0IEMtMTcuMTc4MjU1OTkgMzIuMDY3MDg1MjEgLTE3LjE3ODI1NTk5IDMyLjA2NzA4NTIxIC0xOCAzMCBDLTE5LjkwMzM3ODEzIDI4LjYwODcxNTU2IC0xOS45MDMzNzgxMyAyOC42MDg3MTU1NiAtMjIuMjUgMjcuNTYyNSBDLTMxLjA3MTA4MzE3IDIyLjkxMzE3MTEzIC0zMS4wNzEwODMxNyAyMi45MTMxNzExMyAtMzIuNjYwMTU2MjUgMTcuOTI5Njg3NSBDLTMzLjUwOTcyNjg3IDEzLjA2MzIxNTAxIC0zMy4wODExMzgwMSA5LjYxMDg4NDM3IC0zMC4yOTI5Njg3NSA1LjUgQy0yMi4zNjg4Mzc3IC0zLjY5Mjk0OTYyIC0xMC42NjIyMzUzMyAtMi42NjU1NTg4MyAwIDAgWiAiIGZpbGw9IiMyMjM5ODUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDNC4yNTM4MDEzOCAxLjUxOTIxNDc4IDUuODUwNjA1NjkgNC4xMzEwOTAyNCA4IDggQzEwLjIxNjIxNjM0IDE0LjEzODE3MjIyIDExLjE3ODUwNDM3IDIwLjIzMzA3NjcgOC41NjI1IDI2LjM3NSBDNyAyOSA3IDI5IDYgMzAgQzMuNjM2NzE4NzUgMzAuMjk2ODc1IDMuNjM2NzE4NzUgMzAuMjk2ODc1IDEgMzAgQy0wLjczMDQ2ODc1IDI4LjM5MDYyNSAtMC43MzA0Njg3NSAyOC4zOTA2MjUgLTIuMTg3NSAyNi4yNSBDLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTIuOTIwMzMyMDMgMjUuMjA1ODU5MzggLTMuNjY3OTY4NzUgMjQuMTQwNjI1IEMtNC45MTMwODMwNCAyMi4xMzk2Nzg4OCAtNS45ODkwNDQ2MiAyMC4xMjczMTg0MyAtNyAxOCBDLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuMTk5MTYwMTYgMTkuMjY0NTcwMzEgLTcuNDAyMzQzNzUgMjAuNTU0Njg3NSBDLTcuNTc4OTQ1MzEgMjEuNjUwMzkwNjIgLTcuNzU1NTQ2ODggMjIuNzQ2MDkzNzUgLTcuOTM3NSAyMy44NzUgQy04LjExMTUyMzQ0IDI0Ljk2NTU0Njg4IC04LjI4NTU0Njg4IDI2LjA1NjA5Mzc1IC04LjQ2NDg0Mzc1IDI3LjE3OTY4NzUgQy05IDMwIC05IDMwIC0xMCAzMiBDLTExLjg3NSAzMS43NSAtMTEuODc1IDMxLjc1IC0xNCAzMSBDLTE1LjI1IDI4LjkzNzUgLTE1LjI1IDI4LjkzNzUgLTE2IDI3IEMtMTYuNDMzMTI1IDI3LjQ3NDM3NSAtMTYuODY2MjUgMjcuOTQ4NzUgLTE3LjMxMjUgMjguNDM3NSBDLTIxLjI2ODUzMTg1IDMyLjEwMDQ5MjQ1IC0yNi43NTQ4NDI1IDMxLjMyNjM3NjY4IC0zMS44MjAzMTI1IDMxLjI4MTI1IEMtMzYuMjA3MDY0MDkgMzAuODkzMjMyNjYgLTM3LjkwMzMwOTI4IDMwLjA5NjY5MDcyIC00MSAyNyBDLTQyLjU2MjUgMjQuNSAtNDIuNTYyNSAyNC41IC00MyAyMiBDLTQxLjYyNSAxOS42ODc1IC00MS42MjUgMTkuNjg3NSAtNDAgMTggQy00MS4zMiAxNy4wMSAtNDIuNjQgMTYuMDIgLTQ0IDE1IEMtNDQgMTEuNzUgLTQ0IDExLjc1IC00MyA4IEMtMzcuODIzNzMwOTQgMy44MDUyMDc0OSAtMzIuMDE2MTEwNTQgMy40NTA1OTcyMiAtMjUuNjI1IDMuNjg3NSBDLTI0LjgxOTMzNTk0IDMuNjk3MTY3OTcgLTI0LjAxMzY3MTg4IDMuNzA2ODM1OTQgLTIzLjE4MzU5Mzc1IDMuNzE2Nzk2ODggQy0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNy4zNDEzMjczMSAzLjgyOTMzNjM1IC0xNSA1IEMtMTUuMzEyNSA2LjkzNzUgLTE1LjMxMjUgNi45Mzc1IC0xNiA5IEMtMjAuMjg5NzAxMzQgMTAuNDI5OTAwNDUgLTI0LjU3MTM0MzI0IDEwLjQzODEyMTc2IC0yOS4wNjY0MDYyNSAxMC43MTg3NSBDLTMxLjkzMTY1NzQ2IDEwLjgxNTkwNjYxIC0zMS45MzE2NTc0NiAxMC44MTU5MDY2MSAtMzQgMTIgQy0zMy4wMzU3ODEyNSAxMi4xMDk1NzAzMSAtMzIuMDcxNTYyNSAxMi4yMTkxNDA2MiAtMzEuMDc4MTI1IDEyLjMzMjAzMTI1IEMtMjkuODE0ODQzNzUgMTIuNDkwNTg1OTQgLTI4LjU1MTU2MjUgMTIuNjQ5MTQwNjMgLTI3LjI1IDEyLjgxMjUgQy0yNS4zNzA1NDY4NyAxMy4wMzg3MzA0NyAtMjUuMzcwNTQ2ODcgMTMuMDM4NzMwNDcgLTIzLjQ1MzEyNSAxMy4yNjk1MzEyNSBDLTIwLjA1NDQ1OTUzIDEzLjk4ODQ3OTcxIC0xOC40MjUxMDM5MSAxNC41NjkwMDk5MSAtMTYgMTcgQy0xNS42NyAxNy45OSAtMTUuMzQgMTguOTggLTE1IDIwIEMtMTQuODc4ODI4MTMgMTkuMzI0NTMxMjUgLTE0Ljc1NzY1NjI1IDE4LjY0OTA2MjUgLTE0LjYzMjgxMjUgMTcuOTUzMTI1IEMtMTQuNDY1MjM0MzggMTcuMDYxMDkzNzUgLTE0LjI5NzY1NjI1IDE2LjE2OTA2MjUgLTE0LjEyNSAxNS4yNSBDLTEzLjk2MjU3ODEzIDE0LjM2ODI4MTI1IC0xMy44MDAxNTYyNSAxMy40ODY1NjI1IC0xMy42MzI4MTI1IDEyLjU3ODEyNSBDLTEzLjAzMjAzNzM2IDEwLjEzMDUyMjU2IC0xMi4yMjAwMjg4MyA4LjE5NDAwMTQzIC0xMSA2IEMtOC43Njk1MzEyNSA2LjEyMTA5Mzc1IC04Ljc2OTUzMTI1IDYuMTIxMDkzNzUgLTYgNyBDLTMuNzYxNzE4NzUgOS43MjI2NTYyNSAtMy43NjE3MTg3NSA5LjcyMjY1NjI1IC0xLjY4NzUgMTMuMDYyNSBDLTAuOTkwMTE3MTkgMTQuMTY3MjI2NTYgLTAuMjkyNzM0MzggMTUuMjcxOTUzMTIgMC40MjU3ODEyNSAxNi40MTAxNTYyNSBDMS4yMDUwMTk1MyAxNy42OTIxMjg5MSAxLjIwNTAxOTUzIDE3LjY5MjEyODkxIDIgMTkgQzEuODAwODM5ODQgMTcuODA1MDM5MDYgMS44MDA4Mzk4NCAxNy44MDUwMzkwNiAxLjU5NzY1NjI1IDE2LjU4NTkzNzUgQzEuMDY1MTA0MTcgMTMuMzkwNjI1IDAuNTMyNTUyMDggMTAuMTk1MzEyNSAwIDcgQy0wLjIwNzUzOTA2IDUuODk5MTQwNjMgLTAuNDE1MDc4MTMgNC43OTgyODEyNSAtMC42Mjg5MDYyNSAzLjY2NDA2MjUgQy0wLjc1MTM2NzE5IDIuNzg0OTIxODcgLTAuODczODI4MTMgMS45MDU3ODEyNSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogTS0yOCAxOCBDLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI2LjE4Nzc3NDY2IDIwLjA2MjQ5OTQgLTI0IDIyIEMtMjMuMDEgMjIgLTIyLjAyIDIyIC0yMSAyMiBDLTIxLjMzIDIxLjAxIC0yMS42NiAyMC4wMiAtMjIgMTkgQy0yNC45NyAxOC41MDUgLTI0Ljk3IDE4LjUwNSAtMjggMTggWiBNLTM5IDIyIEMtMzkgMjIuNjYgLTM5IDIzLjMyIC0zOSAyNCBDLTM2LjAzIDI0LjMzIC0zMy4wNiAyNC42NiAtMzAgMjUgQy0zMi4zNTk2ODc0NCAyMi45MDI1MDAwNSAtMzMuNTQ2MTY5OTQgMjIuMDMwOTQyOTYgLTM2Ljc1IDIxLjgxMjUgQy0zNy40OTI1IDIxLjg3NDM3NSAtMzguMjM1IDIxLjkzNjI1IC0zOSAyMiBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjIwLDY3KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjA1NDY4NzUgLTAuMTk5MjE4NzUgMi4wNTQ2ODc1IC0wLjE5OTIxODc1IDUuODY3MTg3NSAwLjM2MzI4MTI1IEM4LjI4Mjg5NDcyIDIuNDI4NzM2NjggMTAuMDk2NDE2NDkgNC43MzM5NTQ2IDExLjg2NzE4NzUgNy4zNjMyODEyNSBDMTIuMTQ5NDkyMTkgNi44NDYzNjcxOSAxMi40MzE3OTY4NyA2LjMyOTQ1MzEzIDEyLjcyMjY1NjI1IDUuNzk2ODc1IEMxNC4yNzE2ODgxMyAzLjQ3NTU5ODQ4IDE1LjU3MTg3NDIgMS45NzEyNTAyOCAxNy44NjcxODc1IDAuMzYzMjgxMjUgQzI2LjQ3NDM3MzUgLTAuNzg0MzQzNTUgMzQuOTQxNzAyNzcgMi4yOTMwNDg0MyA0Mi44NjcxODc1IDUuMzYzMjgxMjUgQzQxLjE2MTc1MzAxIDkuMTA0MjM0MzIgMzkuMjkzODYwOCAxMS4wMjMxMTQxMiAzNS44NjcxODc1IDEzLjM2MzI4MTI1IEMzNC44NzcxODc1IDEzLjM2MzI4MTI1IDMzLjg4NzE4NzUgMTMuMzYzMjgxMjUgMzIuODY3MTg3NSAxMy4zNjMyODEyNSBDMzIuMjA3MTg3NSAxMi4zNzMyODEyNSAzMS41NDcxODc1IDExLjM4MzI4MTI1IDMwLjg2NzE4NzUgMTAuMzYzMjgxMjUgQzI4LjY3MjY0MDY5IDkuNzgzMzQ0MjYgMjguNjcyNjQwNjkgOS43ODMzNDQyNiAyNi4yNDIxODc1IDkuNjc1NzgxMjUgQzI1LjQyNDkyMTg4IDkuNjEwMDM5MDYgMjQuNjA3NjU2MjUgOS41NDQyOTY4OCAyMy43NjU2MjUgOS40NzY1NjI1IEMyMi44MjU4OTg0NCA5LjQyMDQ4ODI4IDIyLjgyNTg5ODQ0IDkuNDIwNDg4MjggMjEuODY3MTg3NSA5LjM2MzI4MTI1IEMyMS43NTg4NzYwNCA5Ljk5OTk5MjUyIDIxLjY1MDU2NDU4IDEwLjYzNjcwMzggMjEuNTM4OTcwOTUgMTEuMjkyNzA5MzUgQzIwLjQxMzg1NTQzIDE3Ljg5NjI5MTI1IDE5LjI3NjQ4MDM1IDI0LjQ5NzY3NjE0IDE4LjEzMTgzNTk0IDMxLjA5NzkwMDM5IEMxNy43MDU4MDczNiAzMy41NjQxNTA1NiAxNy4yODI5NDkwNyAzNi4wMzA5NTA1MSAxNi44NjMyODEyNSAzOC40OTgyOTEwMiBDMTYuMjYwODYwODcgNDIuMDM2ODAwMzYgMTUuNjQ3MjEwNTMgNDUuNTczMjAwOSAxNS4wMzEyNSA0OS4xMDkzNzUgQzE0Ljg0NDcwODU2IDUwLjIxOTc3NjQ2IDE0LjY1ODE2NzExIDUxLjMzMDE3NzkyIDE0LjQ2NTk3MjkgNTIuNDc0MjI3OTEgQzE0LjI4NTkzNzE5IDUzLjQ5NTIxMDcyIDE0LjEwNTkwMTQ5IDU0LjUxNjE5MzU0IDEzLjkyMDQxMDE2IDU1LjU2ODExNTIzIEMxMy42ODcyNDU5NCA1Ni45MjM3OTg2IDEzLjY4NzI0NTk0IDU2LjkyMzc5ODYgMTMuNDQ5MzcxMzQgNTguMzA2ODY5NTEgQzEzLjI1NzI1MDY3IDU4Ljk4NTQ4NTM4IDEzLjA2NTEzIDU5LjY2NDEwMTI2IDEyLjg2NzE4NzUgNjAuMzYzMjgxMjUgQzExLjg3NzE4NzUgNjAuODU4MjgxMjUgMTEuODc3MTg3NSA2MC44NTgyODEyNSAxMC44NjcxODc1IDYxLjM2MzI4MTI1IEM5LjU4MDQ1Mjg0IDU0LjQ1OTA5MjQzIDguMjk5Mjc3MDIgNDcuNTUzODg4ODYgNy4wMjE5NzI2NiA0MC42NDc5NDkyMiBDNi41ODY3MzE3NyAzOC4yOTg0Mjc0MSA2LjE1MDIxNTc5IDM1Ljk0OTE0MTQ1IDUuNzEyNDAyMzQgMzMuNjAwMDk3NjYgQzUuMDgzNTYyMzcgMzAuMjI0ODk1MzcgNC40NTkzMDI5NCAyNi44NDg4NzMzNSAzLjgzNTkzNzUgMjMuNDcyNjU2MjUgQzMuNTQwNjQxNDggMjEuODk1OTAxMTggMy41NDA2NDE0OCAyMS44OTU5MDExOCAzLjIzOTM3OTg4IDIwLjI4NzI5MjQ4IEMzLjA1OTE5MzEyIDE5LjMwNjU3Nzc2IDIuODc5MDA2MzUgMTguMzI1ODYzMDQgMi42OTMzNTkzOCAxNy4zMTU0Mjk2OSBDMi41MzM0NzUzNCAxNi40NTM4MzI0IDIuMzczNTkxMzEgMTUuNTkyMjM1MTEgMi4yMDg4NjIzIDE0LjcwNDUyODgxIEMxLjg2NzE4NzUgMTIuMzYzMjgxMjUgMS44NjcxODc1IDEyLjM2MzI4MTI1IDEuODY3MTg3NSA4LjM2MzI4MTI1IEMtMS43NjI4MTI1IDkuMDIzMjgxMjUgLTUuMzkyODEyNSA5LjY4MzI4MTI1IC05LjEzMjgxMjUgMTAuMzYzMjgxMjUgQy05LjQ2MjgxMjUgMTEuMzUzMjgxMjUgLTkuNzkyODEyNSAxMi4zNDMyODEyNSAtMTAuMTMyODEyNSAxMy4zNjMyODEyNSBDLTE1LjA4OTc3ODMxIDEyLjEyNDAzOTggLTE3LjI0OTM5NzE2IDEwLjU3NzUwMzY3IC0yMC4xMzI4MTI1IDYuMzYzMjgxMjUgQy0xMy40NzU0Nzc3IDMuMTIxMTc0OTQgLTcuMjY2ODA3MzkgMS4yMzc3NTI5MSAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NzUuMTMyODEyNSwzNS42MzY3MTg3NSkiLz4KPHBhdGggZD0iTTAgMCBDOC41OCAwIDE3LjE2IDAgMjYgMCBDMjYgMy4zIDI2IDYuNiAyNiAxMCBDMjAuNzIgMTAgMTUuNDQgMTAgMTAgMTAgQzEwIDEzLjYzIDEwIDE3LjI2IDEwIDIxIEMxMy45NiAyMSAxNy45MiAyMSAyMiAyMSBDMjIgMjQuMyAyMiAyNy42IDIyIDMxIEMxOC4wNCAzMSAxNC4wOCAzMSAxMCAzMSBDMTAgMzUuMjkgMTAgMzkuNTggMTAgNDQgQzE3LjkyIDQzLjUwNSAxNy45MiA0My41MDUgMjYgNDMgQzI2IDQ2LjMgMjYgNDkuNiAyNiA1MyBDMjIuODY0NjI0MDIgNTQuMDQ1MTI1MzMgMjAuMjI4NTQ5MDIgNTQuMzE1Mzc3MTMgMTYuOTM3NSA1NC41NjI1IEMxNS44NzQwMjM0NCA1NC42NDYyODkwNiAxNC44MTA1NDY4OCA1NC43MzAwNzgxMyAxMy43MTQ4NDM3NSA1NC44MTY0MDYyNSBDOS4xNDgzOTI5NSA1NS4wNDIwODc4NCA0LjU3MjAyNDE4IDU1IDAgNTUgQzAgMzYuODUgMCAxOC43IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAzNSw1MikiLz4KPHBhdGggZD0iTTAgMCBDMS45MTAxNTYyNSAwLjgyMDMxMjUgMS45MTAxNTYyNSAwLjgyMDMxMjUgNC41MzUxNTYyNSAyLjMyMDMxMjUgQzQuNTM1MTU2MjUgNC45NjAzMTI1IDQuNTM1MTU2MjUgNy42MDAzMTI1IDQuNTM1MTU2MjUgMTAuMzIwMzEyNSBDMS43NzIzOTQ0OCA5Ljc5NzYyNzg0IC0wLjc5MDkzMTM1IDkuMjExNjE2NjMgLTMuNDY0ODQzNzUgOC4zMjAzMTI1IEMtNS4wMjYwMjgwMyA4LjI1MjkwMzg1IC02LjU4OTg2ODk1IDguMjM1MTY3OTQgLTguMTUyMzQzNzUgOC4yNTc4MTI1IEMtOC45NjA1ODU5NCA4LjI2NjgzNTk0IC05Ljc2ODgyODEzIDguMjc1ODU5MzcgLTEwLjYwMTU2MjUgOC4yODUxNTYyNSBDLTExLjIxNjQ0NTMxIDguMjk2NzU3ODEgLTExLjgzMTMyODEzIDguMzA4MzU5MzggLTEyLjQ2NDg0Mzc1IDguMzIwMzEyNSBDLTEyLjc5NDg0Mzc1IDkuMzEwMzEyNSAtMTMuMTI0ODQzNzUgMTAuMzAwMzEyNSAtMTMuNDY0ODQzNzUgMTEuMzIwMzEyNSBDLTEyLjU4NDQxNDA2IDExLjcwNzAzMTI1IC0xMS43MDM5ODQzNyAxMi4wOTM3NSAtMTAuNzk2ODc1IDEyLjQ5MjE4NzUgQy05LjYzNTQyOTY5IDEzLjAxMjk2ODc1IC04LjQ3Mzk4NDM4IDEzLjUzMzc1IC03LjI3NzM0Mzc1IDE0LjA3MDMxMjUgQy01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC01LjU1NDUxMTcyIDE0LjgzNjAxNTYzIC0zLjc5Njg3NSAxNS42MTcxODc1IEMwLjI0MTM3MzEyIDE3LjY4MTI4NjE5IDMuNTY0NTg1NyAxOS42ODc5ODkzIDUuOTEwMTU2MjUgMjMuNjMyODEyNSBDNi45OTYzOTk0NiAyOC4zMDM2NTgzIDYuMzE4NTczOSAzMS44ODQwNDY4MSA0LjAzNTE1NjI1IDM2LjA3MDMxMjUgQy0wLjE5NDIwMDc5IDM5Ljg3NjczMzg0IC00LjYxMjE4MDA4IDQxLjI1NzA5NTU4IC0xMC4yODUxNTYyNSA0MS4zODI4MTI1IEMtMTUuNjc4ODQ0MzEgNDEuMDMwMDkxNzUgLTE5Ljg2NjQ0MTQ4IDQwLjE3ODc3ODc4IC0yNC40NjQ4NDM3NSAzNy4zMjAzMTI1IEMtMjQuNDY0ODQzNzUgMzQuMDIwMzEyNSAtMjQuNDY0ODQzNzUgMzAuNzIwMzEyNSAtMjQuNDY0ODQzNzUgMjcuMzIwMzEyNSBDLTIzLjE2NTQ2ODc1IDI3Ljk4MDMxMjUgLTIxLjg2NjA5Mzc1IDI4LjY0MDMxMjUgLTIwLjUyNzM0Mzc1IDI5LjMyMDMxMjUgQy0xNS41OTQwNTE2OSAzMS41NDQyMDkyNCAtMTEuODI1MTI2MDMgMzEuNjYwNjQ3ODggLTYuNDY0ODQzNzUgMzEuMzIwMzEyNSBDLTYuNDY0ODQzNzUgMzAuMDAwMzEyNSAtNi40NjQ4NDM3NSAyOC42ODAzMTI1IC02LjQ2NDg0Mzc1IDI3LjMyMDMxMjUgQy03LjQxNzQ2MDk0IDI2Ljk1Njc5Njg3IC04LjM3MDA3ODEyIDI2LjU5MzI4MTI1IC05LjM1MTU2MjUgMjYuMjE4NzUgQy0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yMi40OTU3MTQwNSAyMS4wMzAxNzczIC0yNS40NjQ4NDM3NSAxNS4zMjAzMTI1IEMtMjYuMjE3MDIwNTkgMTEuNDI4OTQ4NjQgLTI1LjgyMjM5NTM5IDguMjE0MTkxNTkgLTI0LjMzOTg0Mzc1IDQuNTA3ODEyNSBDLTE4LjQ5MTUxODczIC0yLjMxNTIzMzM1IC04LjEzNzk4MzIgLTIuMjQ0MDcxNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxOTY5LjQ2NDg0Mzc1LDQwLjY3OTY4NzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzguOTEgMCAxNy44MiAwIDI3IDAgQzI3IDMuMyAyNyA2LjYgMjcgMTAgQzIxLjM5IDEwIDE1Ljc4IDEwIDEwIDEwIEMxMCAxMy42MyAxMCAxNy4yNiAxMCAyMSBDMTQuMjkgMjEgMTguNTggMjEgMjMgMjEgQzIzIDI0LjMgMjMgMjcuNiAyMyAzMSBDMTguNzEgMzEgMTQuNDIgMzEgMTAgMzEgQzEwIDM3LjkzIDEwIDQ0Ljg2IDEwIDUyIEM2LjcgNTIgMy40IDUyIDAgNTIgQzAgMzQuODQgMCAxNy42OCAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMDEsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDEzLjUzIDkgMjcuMDYgOSA0MSBDNS4zNyA0MSAxLjc0IDQxIC0yIDQxIEMtMy4yMTY4NzUgNDEuMjQ3NSAtNC40MzM3NSA0MS40OTUgLTUuNjg3NSA0MS43NSBDLTEwLjMxMDAyNjQxIDQyLjA5ODg2OTkyIC0xMy4zMDg5OTE4NSA0MC43MzUwMDM3OSAtMTcgMzggQy0yMC42ODY4MTg5NSAzMy4xNjEwNTAxMyAtMjAuNjk0NzYzNjEgMjcuODUzMTQ1NTEgLTIwIDIyIEMtMTguNzI2MDcyMzggMTguMzEyMzE0NzcgLTE3Ljc0NDY5MDYyIDE2LjU4MzY3NjQzIC0xNC42ODc1IDE0LjE4NzUgQy05LjYzMTE5NDU5IDExLjk1MzMxODU0IC02LjQ1NjIyNjA3IDExLjkwODc1NDc5IC0xIDEzIEMtMC42NyA4LjcxIC0wLjM0IDQuNDIgMCAwIFogTS05LjQzNzUgMjEuMDYyNSBDLTExLjI1OTI1OTU5IDI0LjQ4NzQwODAyIC0xMS42MzY3NDE4MyAyNi4xNzk1NDkgLTExIDMwIEMtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtOS40NTY2NDk3MSAzMi45NTA0NzU1MyAtNyAzNSBDLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTQuNDE0MTc4NzIgMzUuNTg0MDIxMzMgLTIgMzUgQzAuMzI4NjYyMjkgMzMuMTExNTM4MTcgMC4zMjg2NjIyOSAzMy4xMTE1MzgxNyAwLjE5NTMxMjUgMjkuOTYwOTM3NSBDMC4xNzIxMDkzOCAyOC43Nzc1NzgxMiAwLjE0ODkwNjI1IDI3LjU5NDIxODc1IDAuMTI1IDI2LjM3NSBDMC4xMDY5NTMxMyAyNS4xODY0ODQzNyAwLjA4ODkwNjI1IDIzLjk5Nzk2ODc1IDAuMDcwMzEyNSAyMi43NzM0Mzc1IEMwLjA0NzEwOTM4IDIxLjg1ODIwMzEzIDAuMDIzOTA2MjUgMjAuOTQyOTY4NzUgMCAyMCBDLTUuMTAxNDUzNyAxOC41Nzg2MzU2MiAtNS4xMDE0NTM3IDE4LjU3ODYzNTYyIC05LjQzNzUgMjEuMDYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjEzMSw0MCkiLz4KPHBhdGggZD0iTTAgMCBDOS45IDAgMTkuOCAwIDMwIDAgQzMwIDMuMyAzMCA2LjYgMzAgMTAgQzI2LjcgMTAgMjMuNCAxMCAyMCAxMCBDMjAgMjMuODYgMjAgMzcuNzIgMjAgNTIgQzE1LjA1IDUyLjQ5NSAxNS4wNSA1Mi40OTUgMTAgNTMgQzEwIDM4LjgxIDEwIDI0LjYyIDEwIDEwIEM2LjcgMTAgMy40IDEwIDAgMTAgQzAgNi43IDAgMy40IDAgMCBaICIgZmlsbD0iI0Q4MUUyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTA2Niw1MikiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDgxMTQ5MSA1Ljc3Mzc4OTI1IC0yLjE4NDY3MTgxIDkuOTU4NTk4MzYgLTUgMTUgQy00LjMxOTM3NSAxNC4yOTg3NSAtMy42Mzg3NSAxMy41OTc1IC0yLjkzNzUgMTIuODc1IEMtMS45NjMyMDUxNCAxMS45MTE3MTQxMyAtMC45ODM1MTk0NiAxMC45NTM4NjU2MSAwIDEwIEMwLjU1NDI5Njg3IDkuNDYxMTcxODggMS4xMDg1OTM3NSA4LjkyMjM0Mzc1IDEuNjc5Njg3NSA4LjM2NzE4NzUgQzUuMjUwOTM2OCA1LjA4MTYzODE0IDcuODk2NjgzMzIgMi44ODQwMTU1MyAxMyAzIEMxNS4wMDY0OTYwNyA0LjUzNjM3NTAxIDE1Ljg3Mzg5MDQ5IDUuNTg4MTQ4NyAxNi42MTcxODc1IDguMDE1NjI1IEMxNy4yNTE1NjExIDEzLjUxMzUyOTUzIDE2Ljg0OTMwMTA3IDE3LjA2MTIxMTQ3IDE0IDIyIEMxMS4wNTUwNzk0MyAyNS40MDk5MDgwMyA4LjEyMTcwMjE1IDI4LjEzNTQyMDQ2IDQgMzAgQzEuNjY3MTQ1MiAzMC4wNDcyNTM5OSAtMC42NjcyNDM5MyAzMC4wNTE4OTk3MyAtMyAzMCBDLTMuMjY1NTQ2ODggMzEuMDczNzg5MDYgLTMuNTMxMDkzNzUgMzIuMTQ3NTc4MTIgLTMuODA0Njg3NSAzMy4yNTM5MDYyNSBDLTQuMTYxMzk0MjEgMzQuNjkwMTIwMSAtNC41MTgxNjg2NiAzNi4xMjYzMTcxMiAtNC44NzUgMzcuNTYyNSBDLTUuMDQ5MDIzNDQgMzguMjY2OTcyNjYgLTUuMjIzMDQ2ODggMzguOTcxNDQ1MzEgLTUuNDAyMzQzNzUgMzkuNjk3MjY1NjIgQy02LjUxMjk0ODE1IDQ0LjE2MDI0OTk4IC03LjcxMjAxMjE2IDQ4LjU4NDg3MDUyIC05IDUzIEMtMTMuODc1IDUxLjI1IC0xMy44NzUgNTEuMjUgLTE1IDQ5IEMtMTUuODA3NzM2NjkgNDEuNjExMTk1NTcgLTE0LjQ0MzM4Mzc0IDM1LjkyMzE3NjkzIC0xMS44NzEwOTM3NSAyOS4wNDI5Njg3NSBDLTEwLjkzNjk5MDk5IDI1Ljc3OTg5MjMxIC0xMC44OTM4OTA4MiAyMy4yNTE1MDY5MSAtMTEuMDYyNSAxOS44NzUgQy0xMS4zNDcwMDEzMyAxMi4zOTk0ODI0MiAtOC41MjkxMDMxNSA3LjAzNDkyMzc4IC0zLjgxMjUgMS4zNzUgQy0yIDAgLTIgMCAwIDAgWiBNMTAgMTAgQzcuOTU1NDM5NDEgMTIuMTcyNjQ2NTUgNy45NTU0Mzk0MSAxMi4xNzI2NDY1NSA1Ljg3NSAxNC44NzUgQzUuMTUwNTQ2ODggMTUuNzc5OTIxODcgNC40MjYwOTM3NSAxNi42ODQ4NDM3NSAzLjY3OTY4NzUgMTcuNjE3MTg3NSBDMS44MDc5NDc2NiAxOS43ODY1NTgxMSAxLjgwNzk0NzY2IDE5Ljc4NjU1ODExIDIgMjIgQzYuMDE1MzA1MDUgMjEuMDg3NDMwNjcgNy43MTEyODI3NSAyMC4zNDk0OTk4MyAxMC4zNzUgMTcuMTI1IEMxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMi4zMDc1Njg0OSAxMy45OTU1NjM5MiAxMiAxMCBDMTEuMzQgMTAgMTAuNjggMTAgMTAgMTAgWiAiIGZpbGw9IiMyMjFFMjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY2NSw3MCkiLz4KPHBhdGggZD0iTTAgMCBDMy4zIDAgNi42IDAgMTAgMCBDMTAgMTQuMTkgMTAgMjguMzggMTAgNDMgQzEzLjk2IDQzIDE3LjkyIDQzIDIyIDQzIEMyMy4zMiA0My4zMyAyNC42NCA0My42NiAyNiA0NCBDMjYgNDcuMyAyNiA1MC42IDI2IDU0IEMxMy4xMyA1My41MDUgMTMuMTMgNTMuNTA1IDAgNTMgQzAgMzUuNTEgMCAxOC4wMiAwIDAgWiAiIGZpbGw9IiNEODFFMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMzMsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwLjMzIDQuNjIgMTAuNjYgOS4yNCAxMSAxNCBDMTIuNTQ2ODc1IDEzLjQ0MzEyNSAxMi41NDY4NzUgMTMuNDQzMTI1IDE0LjEyNSAxMi44NzUgQzE4LjM5OTA1MzgzIDExLjkwOTg5MTA3IDIwLjEwMjI4MDU4IDEyLjEzOTcyNDgyIDI0IDE0IEMyNS45NTA0Njk0MiAxNS42MTQxODE1OSAyNi44NzAxODY5MyAxNi43NDAzNzM4NiAyOCAxOSBDMjguMDcxODE4MjEgMjEuNzE3NjAxMDggMjguMDkyOTk1MDYgMjQuNDA4NTkzODggMjguMDYyNSAyNy4xMjUgQzI4LjA1Nzk4ODI4IDI3Ljg3OTEwMTU2IDI4LjA1MzQ3NjU2IDI4LjYzMzIwMzEyIDI4LjA0ODgyODEyIDI5LjQxMDE1NjI1IEMyOC4wMzcwMzQ5OSAzMS4yNzM0NzEyNyAyOC4wMTkwOTk0MiAzMy4xMzY3NDU1NSAyOCAzNSBDMjMuNTQ1IDM1LjQ5NSAyMy41NDUgMzUuNDk1IDE5IDM2IEMxOC45Mzk0MTQwNiAzNS4wODQ3NjU2MyAxOC44Nzg4MjgxMiAzNC4xNjk1MzEyNSAxOC44MTY0MDYyNSAzMy4yMjY1NjI1IEMxOC43MzI2MTcxOSAzMi4wMzgwNDY4NyAxOC42NDg4MjgxMiAzMC44NDk1MzEyNSAxOC41NjI1IDI5LjYyNSBDMTguNDgxMjg5MDYgMjguNDQxNjQwNjMgMTguNDAwMDc4MTIgMjcuMjU4MjgxMjUgMTguMzE2NDA2MjUgMjYuMDM5MDYyNSBDMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTguMTg5MTUwNjQgMjMuMDg0ODEwOTkgMTcgMjEgQzE1LjMzMzg4MDk1IDIwLjk1NzI3OSAxMy42NjYxNzExNSAyMC45NTkzNjE2OCAxMiAyMSBDMTAuNDUwNDk3MzIgMjIuNTQ5NTAyNjggMTAuNzgzNDQ4MDcgMjQuMDk5OTA1OTQgMTAuNjgzNTkzNzUgMjYuMjUzOTA2MjUgQzEwLjY0MTY5OTIyIDI3LjEwNzkxMDE2IDEwLjU5OTgwNDY5IDI3Ljk2MTkxNDA2IDEwLjU1NjY0MDYyIDI4Ljg0MTc5Njg4IEMxMC41MTczMjQyMiAyOS43Mzk2Mjg5MSAxMC40NzgwMDc4MSAzMC42Mzc0NjA5NCAxMC40Mzc1IDMxLjU2MjUgQzEwLjM5NDMxNjQxIDMyLjQ2NDE5OTIyIDEwLjM1MTEzMjgxIDMzLjM2NTg5ODQ0IDEwLjMwNjY0MDYyIDM0LjI5NDkyMTg4IEMxMC4yMDAyMjAxNiAzNi41Mjk3NTE1NiAxMC4wOTk1NzUxOSAzOC43NjQ4NTQ4NiAxMCA0MSBDNi43IDQxIDMuNCA0MSAwIDQxIEMwIDI3LjQ3IDAgMTMuOTQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA1LDQwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzkuOTk1NDE0NiAxNi4wODQxMjA5OCA2Ljc1MDQyOTQ2IDMyLjA3MjY0NDI3IDMgNDggQy0xLjI5IDQ4IC01LjU4IDQ4IC0xMCA0OCBDLTkuMzUyMDc5OTYgNDIuMjQzMTY0OTggLTguMzkyNDE1OTEgMzYuNjQxMDIxMyAtNy4xODc1IDMwLjk3NjU2MjUgQy03LjAxMzcxODI2IDMwLjE0OTE3NTcyIC02LjgzOTkzNjUyIDI5LjMyMTc4ODk0IC02LjY2MDg4ODY3IDI4LjQ2OTMyOTgzIEMtNi4yOTYwMjY4NiAyNi43MzYyMTU3NCAtNS45Mjk1NTA3IDI1LjAwMzQ0MDc3IC01LjU2MTUyMzQ0IDIzLjI3MDk5NjA5IEMtNC45OTczNjgxOSAyMC42MTI1OTg0NyAtNC40Mzk3NTU1NCAxNy45NTI4ODU2NSAtMy44ODI4MTI1IDE1LjI5Mjk2ODc1IEMtMy41MjY0Mjg0MSAxMy42MDQwODUwMSAtMy4xNjk2NzA5OSAxMS45MTUyOCAtMi44MTI1IDEwLjIyNjU2MjUgQy0yLjY0NTgwODExIDkuNDMwNzc3ODkgLTIuNDc5MTE2MjEgOC42MzQ5OTMyOSAtMi4zMDczNzMwNSA3LjgxNTA5Mzk5IEMtMS4xMTUxOTMxMyAyLjIzMDM4NjI2IC0xLjExNTE5MzEzIDIuMjMwMzg2MjYgMCAwIFogIiBmaWxsPSIjMjIzMTc1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5OCw1NCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtMTMuMDQyMzMyOTIgNTUuOTEzMzA3NzkgLTE5LjIzMTExMzk5IDQ5LjIyNDI2NTc5IC0yNC42ODc1IDQyLjExMzI4MTI1IEMtMjUuOTc2NzY1MDIgNDAuMDM3NDExMDkgLTI2LjU2ODUwMjU3IDM4LjM4OTQxNzA0IC0yNyAzNiBDLTIyLjM3NSAzMyAtMjIuMzc1IDMzIC0xOSAzMyBDLTE5IDMzLjk5IC0xOSAzNC45OCAtMTkgMzYgQy0xNi4wMjk4MjMwNiAzNS4zNzE4OTgyNyAtMTYuMDI5ODIzMDYgMzUuMzcxODk4MjcgLTEzIDM0IEMtMTEuODAxNjE3OTEgMzEuNjcxNDU1MzcgLTExLjgwMTYxNzkxIDMxLjY3MTQ1NTM3IC0xMSAyOSBDLTEwLjMyMzI0MjE5IDI4LjI5NDg4MjgxIC05LjY0NjQ4NDM4IDI3LjU4OTc2NTYyIC04Ljk0OTIxODc1IDI2Ljg2MzI4MTI1IEMtNi4yODY2NTkzNyAyMi45NTIxNDY5MyAtNi42NDc5NDA5OCAyMC4wOTMyNzg3OCAtNi45Mzc1IDE1LjUgQy03LjQ2Nzc4NzQgNi4zMzQ3MzQyNSAtNy40Njc3ODc0IDYuMzM0NzM0MjUgLTQgMiBDLTEuODEyNSAwLjY4NzUgLTEuODEyNSAwLjY4NzUgMCAwIFogIiBmaWxsPSIjMTg3MjRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIyNzM1OTE0IDUuMDI2MTMzNCA0LjM0Mzc1IDYuNjc1NjQ0OTEgNC4zNDM3NSAxMy41OTc2NTYyNSBDLTEuOTI2MjUgMTMuNTk3NjU2MjUgLTguMTk2MjUgMTMuNTk3NjU2MjUgLTE0LjY1NjI1IDEzLjU5NzY1NjI1IEMtMTIuMzAwNDg3NzkgMTguNzcwMzg3NjYgLTEyLjMwMDQ4Nzc5IDE4Ljc3MDM4NzY2IC04LjUzMTI1IDE5LjU5NzY1NjI1IEMtMy43NTI5OTc1NyAxOS41OTc2NTYyNSAtMC4wNTEzNDIxNSAxOC4zNjE2NzI4MyA0LjM0Mzc1IDE2LjU5NzY1NjI1IEM0LjY1NjI1IDE5LjQxMDE1NjI1IDQuNjU2MjUgMTkuNDEwMTU2MjUgNC4zNDM3NSAyMi41OTc2NTYyNSBDMC45MDEyMjIwNSAyNS45MjU0MzMyNyAtMy40MTQ1NjU0OCAyNi4zMjk5Njg0IC04LjAyMzQzNzUgMjYuNjYwMTU2MjUgQy0xMy42ODcyNjY0IDI2LjUyNTcwMzM0IC0xOC4xMzQxNTE4MiAyNS4xMTk3NTQ0MyAtMjIuMTU2MjUgMjEuMDk3NjU2MjUgQy0yNC43NzM1ODM1MyAxNi43MzU0MzM3IC0yNS4zMTY1NTAzOCAxMi41OTU3NjMyOCAtMjQuNjU2MjUgNy41OTc2NTYyNSBDLTIzLjI5NDg1NjcgMy44NjEyMjM1NSAtMjEuNDAxMzMxNDIgMS4xNzA3OTU4IC0xOC4yMTg3NSAtMS4yNzczNDM3NSBDLTEyLjMxODQ0Njg5IC0zLjg2NzcyMDcyIC01LjI1NTA1Mjk0IC00LjQ0OTQ0MzQxIDAgMCBaIE0tMTMuNjU2MjUgNC41OTc2NTYyNSBDLTEzLjk4NjI1IDUuOTE3NjU2MjUgLTE0LjMxNjI1IDcuMjM3NjU2MjUgLTE0LjY1NjI1IDguNTk3NjU2MjUgQy0xMS4wMjYyNSA4LjU5NzY1NjI1IC03LjM5NjI1IDguNTk3NjU2MjUgLTMuNjU2MjUgOC41OTc2NTYyNSBDLTQuOTgzMjM1NTkgMy42NzQ2NDYzMyAtNC45ODMyMzU1OSAzLjY3NDY0NjMzIC03LjUzMTI1IDIuNjYwMTU2MjUgQy0xMC4yMTA5NzMzNSAyLjU4MTM0MDg2IC0xMS40ODU2NTkxNSAzLjAyNTg0OTA4IC0xMy42NTYyNSA0LjU5NzY1NjI1IFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDkxLjY1NjI1LDU1LjQwMjM0Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjUyMDkwNTk1IDQuNTExMTYwNzUgMyA2LjQxMTcwNDg5IDMgMTIuNTYyNSBDLTMuMjcgMTIuNTYyNSAtOS41NCAxMi41NjI1IC0xNiAxMi41NjI1IEMtMTMuNjQ0MjM3NzkgMTcuNzM1MjMxNDEgLTEzLjY0NDIzNzc5IDE3LjczNTIzMTQxIC05Ljg3NSAxOC41NjI1IEMtNS4wOTY3NDc1NyAxOC41NjI1IC0xLjM5NTA5MjE1IDE3LjMyNjUxNjU4IDMgMTUuNTYyNSBDMy4zMTI1IDE4LjM3NSAzLjMxMjUgMTguMzc1IDMgMjEuNTYyNSBDLTAuNDQyNTI3OTUgMjQuODkwMjc3MDIgLTQuNzU4MzE1NDggMjUuMjk0ODEyMTUgLTkuMzY3MTg3NSAyNS42MjUgQy0xNS4wMzEwMTY0IDI1LjQ5MDU0NzA5IC0xOS40Nzc5MDE4MiAyNC4wODQ1OTgxOCAtMjMuNSAyMC4wNjI1IEMtMjYuMTE3MzMzNTMgMTUuNzAwMjc3NDUgLTI2LjY2MDMwMDM4IDExLjU2MDYwNzAzIC0yNiA2LjU2MjUgQy0yNC42Mzg2MDY3IDIuODI2MDY3MyAtMjIuNzQ1MDgxNDIgMC4xMzU2Mzk1NSAtMTkuNTYyNSAtMi4zMTI1IEMtMTIuNjA1NTU1NjYgLTUuMzY2NzY4MjUgLTUuOTgyNDU3MiAtNC44NjA3NDY0OCAwIDAgWiBNLTE1IDMuNTYyNSBDLTE1LjMzIDQuODgyNSAtMTUuNjYgNi4yMDI1IC0xNiA3LjU2MjUgQy0xMi4zNyA3LjU2MjUgLTguNzQgNy41NjI1IC01IDcuNTYyNSBDLTYuMzI2OTg1NTkgMi42Mzk0OTAwOCAtNi4zMjY5ODU1OSAyLjYzOTQ5MDA4IC04Ljg3NSAxLjYyNSBDLTExLjU1NDcyMzM1IDEuNTQ2MTg0NjEgLTEyLjgyOTQwOTE1IDEuOTkwNjkyODMgLTE1IDMuNTYyNSBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE2OSw1Ni40Mzc1KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjMgMCA2LjYgMCAxMCAwIEMxMCAxOC4xNSAxMCAzNi4zIDEwIDU1IEM3LjAzIDU1IDQuMDYgNTUgMSA1NSBDMCA1NCAwIDU0IC0wLjEyMDI1NDUyIDUxLjgyOTY5NjY2IEMtMC4xMTgwMzM5MSA1MC44NzI2MTMwNyAtMC4xMTU4MTMyOSA0OS45MTU1Mjk0OCAtMC4xMTM1MjUzOSA0OC45Mjk0NDMzNiBDLTAuMTEzNDQ5ODYgNDcuODQ4Mzk4MjggLTAuMTEzMzc0MzMgNDYuNzY3MzUzMjEgLTAuMTEzMjk2NTEgNDUuNjUzNTQ5MTkgQy0wLjEwODEzNTIyIDQ0LjQ3NzUyNjQgLTAuMTAyOTczOTQgNDMuMzAxNTAzNiAtMC4wOTc2NTYyNSA0Mi4wODk4NDM3NSBDLTAuMDk2MjQxMyA0MC44OTI2NzIyNyAtMC4wOTQ4MjYzNSAzOS42OTU1MDA3OSAtMC4wOTMzNjg1MyAzOC40NjIwNTEzOSBDLTAuMDg3NzQ5NzkgMzQuNjIwNTA5MzQgLTAuMDc1MTk0MTEgMzAuNzc5MDI0NTcgLTAuMDYyNSAyNi45Mzc1IEMtMC4wNTc0ODc0MSAyNC4zNDA0OTU2MyAtMC4wNTI5MjQwOSAyMS43NDM0OTAzNSAtMC4wNDg4MjgxMiAxOS4xNDY0ODQzOCBDLTAuMDM3Nzc0MjcgMTIuNzY0MzAwNjggLTAuMDIwNDk3MDggNi4zODIxNjAwNyAwIDAgWiAiIGZpbGw9IiNEODFGMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExNjYsNTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMyAwIDYuNiAwIDEwIDAgQzEwIDAuNjYgMTAgMS4zMiAxMCAyIEMxMC45OSAxLjM0IDExLjk4IDAuNjggMTMgMCBDMTYuMzkyMTAyODcgLTAuNTQ2MTg2MDYgMTkuNjA2NTQzNSAtMC41MzU4MDg5MiAyMyAwIEMyNi42MTk5NTgyMSAyLjY1OTU2MTEzIDI4LjIwNjgzODE3IDQuNjQ4NDIzNTEgMjkgOSBDMjkuMDc4MTg2MzYgMTAuNTEzOTU2OTYgMjkuMTA3ODk5MDkgMTIuMDMwOTM1MDcgMjkuMDk3NjU2MjUgMTMuNTQ2ODc1IEMyOS4wOTQ0MzM1OSAxNC4zOTEyMTA5NCAyOS4wOTEyMTA5NCAxNS4yMzU1NDY4NyAyOS4wODc4OTA2MiAxNi4xMDU0Njg3NSBDMjkuMDc5NTExNzIgMTYuOTc4MTY0MDYgMjkuMDcxMTMyODEgMTcuODUwODU5MzcgMjkuMDYyNSAxOC43NSBDMjkuMDU3OTg4MjggMTkuNjM4MTY0MDYgMjkuMDUzNDc2NTYgMjAuNTI2MzI4MTIgMjkuMDQ4ODI4MTIgMjEuNDQxNDA2MjUgQzI5LjAzNzA3NDIyIDIzLjYyNzYzMzE2IDI5LjAxOTEzOTY2IDI1LjgxMzgyNTI4IDI5IDI4IEMyNS43IDI4IDIyLjQgMjggMTkgMjggQzE4LjUwNSAxOC4xIDE4LjUwNSAxOC4xIDE4IDggQzE2LjY4IDcuNjcgMTUuMzYgNy4zNCAxNCA3IEMxMy4wMSA3LjY2IDEyLjAyIDguMzIgMTEgOSBDMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuNDE0MDczNjYgMTIuMTE2MTA1NTQgMTAuMzEyNSAxNS42MjUgQzEwLjI0Njc1NzgxIDE2LjgxMzUxNTYzIDEwLjE4MTAxNTYzIDE4LjAwMjAzMTI1IDEwLjExMzI4MTI1IDE5LjIyNjU2MjUgQzEwLjA3NTg5ODQ0IDIwLjE0MTc5Njg3IDEwLjAzODUxNTYyIDIxLjA1NzAzMTI1IDEwIDIyIEM2LjcgMjEuNjcgMy40IDIxLjM0IDAgMjEgQzAgMTQuMDcgMCA3LjE0IDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzNiw1MykiLz4KPHBhdGggZD0iTTAgMCBDNy44MjQzNDA1OCAtMC4xMTcwMzA3NCA3LjgyNDM0MDU4IC0wLjExNzAzMDc0IDEwLjQ4ODI4MTI1IDIuNDE0MDYyNSBDMTIuNzg3NDM3MTMgNi4yMDk3NTk4NSAxMy43NDA2OTg2IDkuNTU1ODA4MzkgMTMgMTQgQzExLjk1MTAwNjYgMTUuNzE2NTM0NjYgMTAuOTAxMjc3MjcgMTcuNDMyNzI1OTggOS44MzIwMzEyNSAxOS4xMzY3MTg3NSBDOC4yODEzNDc3OCAyMi42MDkzNzYxMSA5LjE2NDUxNTkyIDI1LjM1OTY3NjUzIDEwIDI5IEMxMC4zNTA2MjUgMjkuNzAxMjUgMTAuNzAxMjUgMzAuNDAyNSAxMS4wNjI1IDMxLjEyNSBDMTIuMzk2NjM0OTIgMzMuNzkzMjY5ODUgMTIuMTk1NTczOTMgMzYuMDY2MzkwOTggMTIgMzkgQzExIDQwIDExIDQwIDguMTI4OTA2MjUgNDAuMTMyODEyNSBDNi45NTE5OTIxOSA0MC4xMzAyMzQzOCA1Ljc3NTA3ODEyIDQwLjEyNzY1NjI1IDQuNTYyNSA0MC4xMjUgQzMuMzg4MTY0MDYgNDAuMTI3NTc4MTIgMi4yMTM4MjgxMiA0MC4xMzAxNTYyNSAxLjAwMzkwNjI1IDQwLjEzMjgxMjUgQy0yIDQwIC0yIDQwIC00IDM5IEMtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMy4yNDgxNzUxOCAzMS40ODE3NTE4MiAtMS45Mzc1IDI4LjkzNzUgQy0wLjQzNzQ4NjY0IDI1LjgzNzQ3MjM5IC0wLjY0OTM5MDYgMjMuMzg5MjI0MiAtMSAyMCBDLTIuMzE0MzE2OTUgMTcuOTg3NDUyMTggLTMuNjQ3MjE4ODUgMTUuOTg2ODk3MzEgLTUgMTQgQy01Ljg1NTE0NzQgOS42MjkyNDY2MSAtNC43NjA4MzQzNiA3LjI4MzU1ODE3IC0yLjUgMy42MjUgQy0xLjY3OTQ5NTggMi40MDc5MTg3NiAtMC44NTAyODE2NCAxLjE5NjQ2NzczIDAgMCBaICIgZmlsbD0iI0ZBRkJGQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Nyw4MikiLz4KPHBhdGggZD0iTTAgMCBDMy45MDkzODcwMyAzLjczOTQxMzY4IDMuOTA5Mzg3MDMgMy43Mzk0MTM2OCA0LjEzMjgxMjUgNi44NDc2NTYyNSBDNC4xMzAyMzQzOCA3LjU3ODU1NDY5IDQuMTI3NjU2MjUgOC4zMDk0NTMxMyA0LjEyNSA5LjA2MjUgQzQuMTIzNzEwOTQgOS44NjU1ODU5NCA0LjEyMjQyMTg4IDEwLjY2ODY3MTg4IDQuMTIxMDkzNzUgMTEuNDk2MDkzNzUgQzQuMDAyNzk5MjggMTMuOTQyMTE4MSAzLjYyMDk4NDQgMTYuMjE4MTI5NDkgMy4xODc1IDE4LjYyNSBDMi43MDMyNTg3MiAyMi4yNzU5MjQ0MiAzLjIxMzk4MTIzIDIzLjg4MzIwMTQgNS40Mzc1IDI2LjgxMjUgQzUuOTEwNTg1OTQgMjcuMzM0NTcwMzEgNi4zODM2NzE4NyAyNy44NTY2NDA2MiA2Ljg3MTA5Mzc1IDI4LjM5NDUzMTI1IEM4IDMwIDggMzAgOCAzNCBDOC42NiAzNCA5LjMyIDM0IDEwIDM0IEM3Ljk4MzAzMjM0IDI5LjA1NjczNDA2IDcuOTgzMDMyMzQgMjkuMDU2NzM0MDYgNS4yNSAyNC41IEMzLjUwMjExMTMyIDIxLjAwNDIyMjYzIDQuMzAxODA1ODYgMTguODA4MzMxNjUgNSAxNSBDNS4yMjA5MzE1MSAxMC40OTc1NjgxMyA1LjIzOTU1NzQ5IDYuMzU4MTI2NzUgNCAyIEM3LjQ0NTAwNjYgNC45MzU2NjQyMyA3LjU3NDgyNDY0IDcuMjU3NDQyOTQgNy45Njg3NSAxMS41OTc2NTYyNSBDNy45OTg4MzUyIDEzLjkxMDQ1NTggNy43MDc4ODYzOCAxNS44NjYzODczNSA3LjI1IDE4LjEyNSBDNi45ODQxMjA2MSAyMi4yNDYxMzA1MyA3LjEwOTg0MDQyIDIyLjY4NTU3NDIyIDkuNDM3NSAyNS43NSBDOS45MTA1ODU5NCAyNi4yODEwOTM3NSAxMC4zODM2NzE4NyAyNi44MTIxODc1IDEwLjg3MTA5Mzc1IDI3LjM1OTM3NSBDMTIgMjkgMTIgMjkgMTIgMzMgQzE0LjMxIDMzLjY2IDE2LjYyIDM0LjMyIDE5IDM1IEMxOSAzNS45OSAxOSAzNi45OCAxOSAzOCBDMTkuNjM5Mzc1IDM4LjI4ODc1IDIwLjI3ODc1IDM4LjU3NzUgMjAuOTM3NSAzOC44NzUgQzIzIDQwIDIzIDQwIDI0IDQyIEMxOS4yNDAwNTc5OSA0OC4wNjgxMzc5OSAxMy45MjU3ODgzNiA1My40MjgxMzM2MyA3IDU3IEM0IDU2IDQgNTYgMi43OTY4NzUgNTMuOTI1NzgxMjUgQy0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIC0wLjc2MDI4NTczIDQ1LjA0NjE1MjQyIDEgNDAgQzEuNTE1NjI1IDM5LjE3NSAyLjAzMTI1IDM4LjM1IDIuNTYyNSAzNy41IEM0LjM4NzAyNzU2IDM0LjMyNjkwODU4IDQuNTE2NDQxMTggMzIuNjE1MDg4MjUgNCAyOSBDMy4zNCAyOC4wMzA2MjUgMi42OCAyNy4wNjEyNSAyIDI2LjA2MjUgQy0wLjQxMDU3NzgyIDIyLjM3MTMwMjcyIC0wLjQwODMyNzU1IDIwLjMyODI3MTk5IDAgMTYgQzAuMzMgMTUuMDEgMC42NiAxNC4wMiAxIDEzIEMxLjA5MjQ3MzgxIDExLjUyMzEzODg5IDEuMTI5OTkwNzEgMTAuMDQyMjQ0OTkgMS4xMjUgOC41NjI1IEMxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMjg4NjcxOSA3LjQxOTc0NjA5IDEuMTMyODEyNSA2LjI1MzkwNjI1IEMxLjAwMjc2MDE1IDQuMDQ2ODQxNDEgMC42MDg1NjE5OSAyLjEyMDMwNzI0IDAgMCBaICIgZmlsbD0iIzI5N0Q1QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3NCw2MSkiLz4KPHBhdGggZD0iTTAgMCBDMCAyLjY0IDAgNS4yOCAwIDggQy0wLjk5IDcuNjcgLTEuOTggNy4zNCAtMyA3IEMtNi41NTg4MDA1MSA2LjYyNjg5OTk1IC05LjgyNzU4NTIyIDYuMzQwNTE2NjkgLTEzIDguMTI1IEMtMTQuNDYyMjEyMTcgMTAuODY2NjQ3ODEgLTE0LjMxODMzNzMzIDEyLjk0Mzk2MTYyIC0xNCAxNiBDLTEyLjMyMDg1NTg1IDE5LjIyNTQwMTU2IC0xMi4zMjA4NTU4NSAxOS4yMjU0MDE1NiAtOS4zMTI1IDE5Ljc1IEMtNS43MDcwOTgyNCAyMC4wMjIxMDU3OSAtMi41NTAxMDA2NiAxOS42MzkwMTgxMiAxIDE5IEMxIDIxLjMxIDEgMjMuNjIgMSAyNiBDLTYuMzQ1MjM2NzIgMjguMjcwMzQ1ODkgLTEyLjM4MTY4ODY4IDI4Ljg3NjE2MTQyIC0xOS4zNzUgMjUuMjUgQy0yMi44MjkzNDgyMSAyMi4yODkxMzAxIC0yNC42OTA4NzcyNCAyMC4yNzgzNDkyMiAtMjUuMzE2NDA2MjUgMTUuNjY3OTY4NzUgQy0yNS41ODIxMzY1MiA5Ljk1MDQ4MTkxIC0yNC45Njg0NzE1MiA2LjM5NzQ5NTQ3IC0yMSAyIEMtMTQuMTcwMDE0MTEgLTMuMjEyMzU3NjUgLTcuODE4OTkzNjcgLTEuODY5NzU5MzYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDAyLDU0KSIvPgo8cGF0aCBkPSJNMCAwIEMzIDMuMTkwMzcxOTkgMyAzLjE5MDM3MTk5IDMgNiBDLTAuMDkyNjI3NjcgNy41NDYzMTM4NCAtMy4zNjcwODkxIDcuMzkwNjA3MTYgLTYuNzg1MTU2MjUgNy42MjEwOTM3NSBDLTcuODgxNTAzOTEgNy44MDg2NTIzNCAtNy44ODE1MDM5MSA3LjgwODY1MjM0IC05IDggQy05LjMzIDguNjYgLTkuNjYgOS4zMiAtMTAgMTAgQy03LjY5IDEwLjMzIC01LjM4IDEwLjY2IC0zIDExIEMtMi40Mzc1IDEyLjkzNzUgLTIuNDM3NSAxMi45Mzc1IC0yIDE1IEMtMyAxNiAtMyAxNiAtNS4yODUxNTYyNSAxNi4wOTc2NTYyNSBDLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTYuNjU5OTQxNDEgMTYuMDgwMjUzOTEgLTguMDYyNSAxNi4wNjI1IEMtOC45ODE2MDE1NiAxNi4wNTM0NzY1NiAtOS45MDA3MDMxMiAxNi4wNDQ0NTMxMyAtMTAuODQ3NjU2MjUgMTYuMDM1MTU2MjUgQy0xMS41NTc5Mjk2OSAxNi4wMjM1NTQ2OSAtMTIuMjY4MjAzMTMgMTYuMDExOTUzMTMgLTEzIDE2IEMtMTMuMzMgMTcuNjUgLTEzLjY2IDE5LjMgLTE0IDIxIEMtMTIuNzYyNSAyMC42NDkzNzUgLTExLjUyNSAyMC4yOTg3NSAtMTAuMjUgMTkuOTM3NSBDLTcuMDk2NzA4IDE5LjA0NDA2NzI3IC01LjEzMjI1ODM2IDE4Ljk5MTE4NzA2IC0yIDIwIEMtMS42NyAyMS4zMiAtMS4zNCAyMi42NCAtMSAyNCBDLTcuMDgzMDUwMzggMjguMTkwNTQ1ODIgLTExLjYyMjE1Nzc3IDI5Ljk3NTQ2ODkgLTE5IDI5IEMtMjEuMDYyNSAyNy4zNzUgLTIxLjA2MjUgMjcuMzc1IC0yMiAyNSBDLTIyLjU2NDA4OTkgMjAuMDM2MDA4OTIgLTIxLjQ2ODAwNjg0IDE1LjcxMzA3NDU4IC0yMCAxMSBDLTE4LjM3NSA5IC0xOC4zNzUgOSAtMTcgOCBDLTE3LjQ5NSA3LjU2Njg3NSAtMTcuOTkgNy4xMzM3NSAtMTguNSA2LjY4NzUgQy0yMCA1IC0yMCA1IC0yMCAyIEMtNi4wODE1NDUwNiAtMS4zMTY3MzgyIC02LjA4MTU0NTA2IC0xLjMxNjczODIgMCAwIFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2NTIsNzEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4zMTI1IDUuMTg3NSBDMS45Njk4MjgxOCA5LjM2ODA5NjIyIDAuNjY2NjA4NjQgMTIuMTgwNjg4NTMgLTEgMTYgQy0xLjU4NzYzMjQ0IDIwLjExMzQyNzEgLTEuMzMwNDM1NTggMjEuNTA0MzQ2NjQgMSAyNSBDMy4zMzQ1ODYzNSAyOC41MDE4Nzk1MyAzLjY3MjYwNzI3IDI5Ljg4MDI4MDQ3IDMgMzQgQzEuOTUxMDA2NiAzNS43MTY1MzQ2NiAwLjkwMTI3NzI3IDM3LjQzMjcyNTk4IC0wLjE2Nzk2ODc1IDM5LjEzNjcxODc1IEMtMS43MTg2NTIyMiA0Mi42MDkzNzYxMSAtMC44MzU0ODQwOCA0NS4zNTk2NzY1MyAwIDQ5IEMwLjM1MDYyNSA0OS43MDEyNSAwLjcwMTI1IDUwLjQwMjUgMS4wNjI1IDUxLjEyNSBDMi4zODM4NTAwOCA1My43Njc3MDAxNyAyLjEzMjA5ODM3IDU2LjA5MzgzNTkxIDIgNTkgQzEuMDEgNTkgMC4wMiA1OSAtMSA1OSBDLTEuMjg4NzUgNTcuNzgzMTI1IC0xLjU3NzUgNTYuNTY2MjUgLTEuODc1IDU1LjMxMjUgQy0yLjQ4MDE5MTExIDUyLjgzMDc4MTA3IC0zLjEwNzk3MDM0IDUwLjc2NzAxMTM3IC00LjE4NzUgNDguNDM3NSBDLTUuMzQyMzE4NDQgNDQuOTczMDQ0NjggLTQuODE4NjU2ODYgNDIuNTI2NTIxODcgLTQgMzkgQy0zLjIyNjU2MjUgMzcuNzMxNTYyNSAtMy4yMjY1NjI1IDM3LjczMTU2MjUgLTIuNDM3NSAzNi40Mzc1IEMtMC42MTEwNTMyMSAzMy4zNDA0ODE1MiAtMC41NTY2MDA4MSAzMS41NDcxOTM1MyAtMSAyOCBDLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTIuNDI2MjE2ODQgMjUuMjg4NzM2MTYgLTQgMjMgQy00IDIyLjM0IC00IDIxLjY4IC00IDIxIEMtNi45NyAyMSAtOS45NCAyMSAtMTMgMjEgQy0xNi44OTY3Nzg1MSAyNy4wMDIyMTQ0NSAtMTYuODk2Nzc4NTEgMjcuMDAyMjE0NDUgLTE3IDM0IEMtMTYuMzQgMzQuOTY5Mzc1IC0xNS42OCAzNS45Mzg3NSAtMTUgMzYuOTM3NSBDLTEyLjUzNTY0NjkzIDQwLjcxMTA0MDY0IC0xMi40NTUwODUxNiA0Mi41NjI4MzYyOCAtMTMgNDcgQy0xMy45MzU3ODk5NSA0OS4zNTk4MTgxMyAtMTQuOTMzNDc4MDggNTEuNjk2MzEyNjQgLTE2IDU0IEMtMTYuNjkxNDA1MjIgNTYuNzc4ODg2MTMgLTE2LjY5MTQwNTIyIDU2Ljc3ODg4NjEzIC0xNyA1OSBDLTE3Ljk5IDU5IC0xOC45OCA1OSAtMjAgNTkgQy0yMC4yNTgxMzMwMiA1NS4zODYxMzc3NCAtMjAuMTY4MTU2NjcgNTMuMzI5MzA2OCAtMTguNSA1MC4wNjI1IEMtMTYuNjczNDE0OTMgNDYuMzMzMjIyMTUgLTE2LjQ4NjE3MTMzIDQ0LjExMDYyOTM5IC0xNyA0MCBDLTE4LjMxNDMxNjk1IDM3Ljk4NzQ1MjE4IC0xOS42NDcyMTg4NSAzNS45ODY4OTczMSAtMjEgMzQgQy0yMS41IDMxIC0yMS41IDMxIC0yMSAyOCBDLTIwLjMxOTM3NSAyNy4wNzE4NzUgLTE5LjYzODc1IDI2LjE0Mzc1IC0xOC45Mzc1IDI1LjE4NzUgQy0xNi4yOTQzMTIzNCAyMC44MzkwMjk5NyAtMTYuODYxMjA4MTUgMTcuODI0MTczMzMgLTE4IDEzIEMtMTguNjU5OTY3OSAxMS4zMzA2Njk0MiAtMTkuMzI1NTg4NjkgOS42NjM1NDc5IC0yMCA4IEMtMjAuMTI1IDQuNjg3NSAtMjAuMTI1IDQuNjg3NSAtMjAgMiBDLTE5LjM0IDIgLTE4LjY4IDIgLTE4IDIgQy0xOCAyLjY2IC0xOCAzLjMyIC0xOCA0IEMtMTYuNjggNCAtMTUuMzYgNCAtMTQgNCBDLTE0IDQuNjYgLTE0IDUuMzIgLTE0IDYgQy0xNC45OSA2IC0xNS45OCA2IC0xNyA2IEMtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTUuOTcwMjgxNCAxMS4yMzU1MDE3NyAtMTMuNzUgMTYgQy0xMC45NzQxNDAxOSAxNy41ODYyMDU2MSAtOS4xMjcxMzUyNSAxNy41MTA1NTI2OSAtNiAxNyBDLTIuMzk2ODM5NzggMTMuNjg4OTg3OTEgLTEuNDQ3Mjk0NzYgMTAuODA4NDE4NyAtMSA2IEMtMy4zMSA2LjMzIC01LjYyIDYuNjYgLTggNyBDLTguMDQyNzIxIDUuMzMzODgwOTUgLTguMDQwNjM4MzIgMy42NjYxNzExNSAtOCAyIEMtNS45NTQ0Nzk1OCAtMC4wNDU1MjA0MiAtMi43Mjk0MTkxNCAwLjIzOTQyMjczIDAgMCBaICIgZmlsbD0iIzIyNzg1NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw2MikiLz4KPHBhdGggZD0iTTAgMCBDMC45NDg3NSAwLjY2IDEuODk3NSAxLjMyIDIuODc1IDIgQzMuMzAxNTM3MjcgNi4zNTA2ODAxOCAzLjQ1MjcyODcyIDguMjkzODg3MTIgMC42MjUgMTEuNzUgQy0wLjI4MjUgMTIuNDkyNSAtMS4xOSAxMy4yMzUgLTIuMTI1IDE0IEMtMi43MDYzNjcxOSAxNC41MTY5MTQwNiAtMy4yODc3MzQzOCAxNS4wMzM4MjgxMiAtMy44ODY3MTg3NSAxNS41NjY0MDYyNSBDLTYuNzk2MjA2MzYgMTcuNDI5OTAwMDYgLTkuMjc0ODQ0NzUgMTcuNzMzMjU1NzkgLTEyLjY4NzUgMTguMTg3NSBDLTEzLjgyMzE2NDA2IDE4LjM0NjA1NDY5IC0xNC45NTg4MjgxMiAxOC41MDQ2MDkzOCAtMTYuMTI4OTA2MjUgMTguNjY3OTY4NzUgQy0xOS4xMjUgMTkgLTE5LjEyNSAxOSAtMjIuMTI1IDE5IEMtMjMuOTMxNDYxMTggMTUuMzg3MDc3NjQgLTI1LjEyNSAxMi45OTMwMDYgLTI1LjEyNSA4LjkzNzUgQy0yMy41NjkwNzIyNyA0LjM2Njk2MjI5IC0yMS4wMzM3Mjg5IDEuMTk5NzcyNDUgLTE2LjkzNzUgLTEuMzc1IEMtMTEuMDE1MDAyNTMgLTIuNjkxMTEwNTUgLTUuMzkzODE5MTMgLTMuMDkxNTc5MjYgMCAwIFogTS0xOC4xMjUgNSBDLTE4Ljc4NSA2LjMyIC0xOS40NDUgNy42NCAtMjAuMTI1IDkgQy0xOC44MDUgNy42OCAtMTcuNDg1IDYuMzYgLTE2LjEyNSA1IEMtMTYuNzg1IDUgLTE3LjQ0NSA1IC0xOC4xMjUgNSBaIE0tMTIuMTI1IDkgQy0xMy45NTgwMDkwOSAxMS4xMDU3NTY0MyAtMTMuOTU4MDA5MDkgMTEuMTA1NzU2NDMgLTE1LjEyNSAxMyBDLTkuMzI4NzM4OTMgMTIuNjAwMjU3ODYgLTUuNzEwMjc1MzcgMTEuODk3NDg0MDcgLTEuMTI1IDggQy0xLjEyNSA3LjAxIC0xLjEyNSA2LjAyIC0xLjEyNSA1IEMtNS45NTc3NzI2OCA0LjQzMTQzODUxIC04LjM2ODA4Njg2IDYuMDU5ODA3MTEgLTEyLjEyNSA5IFogIiBmaWxsPSIjMjIxRTIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1ODUuMTI1LDQ5KSIvPgo8cGF0aCBkPSJNMCAwIEMyLjk3IDAgNS45NCAwIDkgMCBDOS4zMyAxLjMyIDkuNjYgMi42NCAxMCA0IEMxMC41MTU2MjUgMy4zNCAxMS4wMzEyNSAyLjY4IDExLjU2MjUgMiBDMTQuODI2NDEzMTkgLTAuNjc4MDgyNjIgMTYuODgzOTk1MjUgLTAuMzgxMTExNTUgMjEgMCBDMjEuNjYgMC4zMyAyMi4zMiAwLjY2IDIzIDEgQzIyLjY3IDMuNjQgMjIuMzQgNi4yOCAyMiA5IEMxOSAxMCAxOSAxMCAxNy4wNjI1IDkuMzEyNSBDMTYuMzgxODc1IDkuMjA5Mzc1IDE1LjcwMTI1IDkuMTA2MjUgMTUgOSBDMTEuNjQ5OTE3OTUgMTEuNzc1NzgyMjcgMTAuMTM2Mzk1ODYgMTMuNjg5OTI2MiA5LjY4MzU5Mzc1IDE4LjAzOTA2MjUgQzkuNjAyMzgyODEgMTkuMjIyNDIxODcgOS41MjExNzE4OCAyMC40MDU3ODEyNSA5LjQzNzUgMjEuNjI1IEM5LjM1MzcxMDk0IDIyLjgxMzUxNTYzIDkuMjY5OTIxODcgMjQuMDAyMDMxMjUgOS4xODM1OTM3NSAyNS4yMjY1NjI1IEM5LjEyMzAwNzgxIDI2LjE0MTc5Njg3IDkuMDYyNDIxODcgMjcuMDU3MDMxMjUgOSAyOCBDNi4wMyAyOCAzLjA2IDI4IDAgMjggQzAgMTguNzYgMCA5LjUyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE3Niw1MykiLz4KPHBhdGggZD0iTTAgMCBDMC40OTUgMS40ODUgMC40OTUgMS40ODUgMSAzIEMwLjAxIDMuOTkgLTAuOTggNC45OCAtMiA2IEMtMi43MjcwMzEyNSA1LjczNDQ1MzEzIC0zLjQ1NDA2MjUgNS40Njg5MDYyNSAtNC4yMDMxMjUgNS4xOTUzMTI1IEMtMjUuMTQ4Njk1MTMgLTIuMTYyNDkwMzQgLTQ1LjE2MzM2MjQ5IC0xLjA2MjQxOCAtNjYgNiBDLTY2LjMzIDQuMzUgLTY2LjY2IDIuNyAtNjcgMSBDLTQ4Ljc3Mzk1ODUzIC05LjkzNTYyNDg4IC0xOC43MTE0Nzg5MyAtOC4zODU4NDYyMiAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MjAsMzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi45MDc1IDEyLjQ4NDM3NSA3LjgxNSAxMS45Njg3NSA4Ljc1IDExLjQzNzUgQzEyIDEwIDEyIDEwIDE0LjM3NSAxMC4zMTI1IEMxNC45MTEyNSAxMC41MzkzNzUgMTUuNDQ3NSAxMC43NjYyNSAxNiAxMSBDMTUuNjcgMTIuMzIgMTUuMzQgMTMuNjQgMTUgMTUgQzE2Ljk4IDE0LjY3IDE4Ljk2IDE0LjM0IDIxIDE0IEMxOS42OCAxNi42NCAxOC4zNiAxOS4yOCAxNyAyMiBDMTYuMjM4MTY0MDYgMjEuNzgzNDM3NSAxNS40NzYzMjgxMyAyMS41NjY4NzUgMTQuNjkxNDA2MjUgMjEuMzQzNzUgQzMuNTQ5MjExNDUgMTguMzM5MTEzMiAtMy45OTQ5NjA1MyAxOC41NDQyMTE5MSAtMTUgMjIgQy0xNi4zMiAxOS4zNiAtMTcuNjQgMTYuNzIgLTE5IDE0IEMtMTYuNjkgMTQuMzMgLTE0LjM4IDE0LjY2IC0xMiAxNSBDLTEyLjY2IDEzLjM1IC0xMy4zMiAxMS43IC0xNCAxMCBDLTEwLjI4MTExNzYxIDEwLjUwNzEyMDMzIC03LjI2NTQ1NzYxIDExLjExNjA4MjE1IC00IDEzIEMtMy43OTkxMzU1NyA5LjI4NDAwODA5IC0zLjg0ODA1NjMgOC4yMjc5MTU1NSAtNiA1IEMtNC4zNSA1IC0yLjcgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiNGM0Y4RjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjAsMzcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNzQyMTY3OTcgMC4wNTQxNDA2MyAxLjc0MjE2Nzk3IDAuMDU0MTQwNjMgMy41MTk1MzEyNSAwLjEwOTM3NSBDNC4zOTk5NjA5NCAwLjE1NTc4MTI1IDUuMjgwMzkwNjMgMC4yMDIxODc1IDYuMTg3NSAwLjI1IEM1Ljg1NzUgMS45IDUuNTI3NSAzLjU1IDUuMTg3NSA1LjI1IEMzLjIwNzUgNS41OCAxLjIyNzUgNS45MSAtMC44MTI1IDYuMjUgQy0xLjA1MDMzMjAzIDcuMzU0MDgyMDMgLTEuMDUwMzMyMDMgNy4zNTQwODIwMyAtMS4yOTI5Njg3NSA4LjQ4MDQ2ODc1IEMtMi43NDE2MTc3NyAxNC41MzkxODMxOCAtMy44MTM2MDk0MSAxOC40MDQ2OTk1NSAtOC44MTI1IDIyLjI1IEMtMTEuNTc3MDIwMzMgMjMuNjMyMjYwMTYgLTEzLjg1ODYzNjMgMjMuMzQ1MjUzODcgLTE2LjkzNzUgMjMuMzEyNSBDLTE4LjAzMzIwMzEyIDIzLjMwMzQ3NjU2IC0xOS4xMjg5MDYyNSAyMy4yOTQ0NTMxMyAtMjAuMjU3ODEyNSAyMy4yODUxNTYyNSBDLTIxLjUyMjM4MjgxIDIzLjI2Nzc1MzkxIC0yMS41MjIzODI4MSAyMy4yNjc3NTM5MSAtMjIuODEyNSAyMy4yNSBDLTIyLjQ4MjUgMjEuNiAtMjIuMTUyNSAxOS45NSAtMjEuODEyNSAxOC4yNSBDLTE5LjgzMjUgMTcuOTIgLTE3Ljg1MjUgMTcuNTkgLTE1LjgxMjUgMTcuMjUgQy0xNS41ODE3NTc4MSAxNi4zNTc5Njg3NSAtMTUuMzUxMDE1NjIgMTUuNDY1OTM3NSAtMTUuMTEzMjgxMjUgMTQuNTQ2ODc1IEMtMTQuNzg3MTQ4NDQgMTMuMzc2NDA2MjUgLTE0LjQ2MTAxNTYzIDEyLjIwNTkzNzUgLTE0LjEyNSAxMSBDLTEzLjgxMTc1NzgxIDkuODM5ODQzNzUgLTEzLjQ5ODUxNTYyIDguNjc5Njg3NSAtMTMuMTc1NzgxMjUgNy40ODQzNzUgQy0xMC40NDExMzY5OSAwLjk5NjQ1MTA5IC02Ljc2ODAwODc1IC0wLjI3MzQ1NDkgMCAwIFogIiBmaWxsPSIjRjVGOUY2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDM2LjgxMjUsODQuNzUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuOTcgMCA1Ljk0IDAgOSAwIEM5IDkuMjQgOSAxOC40OCA5IDI4IEM2LjAzIDI4IDMuMDYgMjggMCAyOCBDMCAxOC43NiAwIDkuNTIgMCAwIFogIiBmaWxsPSIjMDA4NDJBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDk5LDUzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjgwODE5NTIyIDAuMDEzNzU3MzUgNC44MDgxOTUyMiAwLjAxMzc1NzM1IDcuODEyNSAyLjg3NSBDOC40OTMxMjUgNC4xMTI1IDguNDkzMTI1IDQuMTEyNSA5LjE4NzUgNS4zNzUgQzYuODc3NSA1LjcwNSA0LjU2NzUgNi4wMzUgMi4xODc1IDYuMzc1IEMxLjg1NzUgOC4wMjUgMS41Mjc1IDkuNjc1IDEuMTg3NSAxMS4zNzUgQzQuNjUyNSAxMC44OCA0LjY1MjUgMTAuODggOC4xODc1IDEwLjM3NSBDOC42ODA5ODE3NSAxNC41MjAyNDY3MSA4LjMyNjA0MzA3IDE2LjE1NDk2MSA2LjA2MjUgMTkuNzUgQzMuMTg3NSAyMi4zNzUgMy4xODc1IDIyLjM3NSAwLjE4NzUgMjMuMTI1IEMtNC4xMzU1MDE1OSAyMi4wNDQyNDk2IC01LjQ3Mjc4ODMxIDIwLjA5MTAxMjY4IC03LjgxMjUgMTYuMzc1IEMtOC4xMjUgMTMgLTguMTI1IDEzIC03LjgxMjUgMTAuMzc1IEMtNS41MDI1IDEwLjM3NSAtMy4xOTI1IDEwLjM3NSAtMC44MTI1IDEwLjM3NSBDLTEuMTQyNSA5LjA1NSAtMS40NzI1IDcuNzM1IC0xLjgxMjUgNi4zNzUgQy00Ljc4MjUgNS44OCAtNC43ODI1IDUuODggLTcuODEyNSA1LjM3NSBDLTUuNjI4MjEwMTUgMC44NjA4MDA5NyAtNS4wOTkzMDg2NyAwLjE5NDExNzE3IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MC44MTI1LDU3LjYyNSkiLz4KPHBhdGggZD0iTTAgMCBDMTUuNTEgMCAzMS4wMiAwIDQ3IDAgQzQ3IDEuNjUgNDcgMy4zIDQ3IDUgQzMxLjQ5IDUgMTUuOTggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuNjIgMCA5LjI0IDAgMTQgMCBDMTQgMS4zMiAxNCAyLjY0IDE0IDQgQzEwLjcgNCA3LjQgNCA0IDQgQzQgNS45OCA0IDcuOTYgNCAxMCBDNy4zIDEwIDEwLjYgMTAgMTQgMTAgQzE0IDExLjMyIDE0IDEyLjY0IDE0IDE0IEMxMC43IDE0IDcuNCAxNCA0IDE0IEM0IDE1Ljk4IDQgMTcuOTYgNCAyMCBDNy4zIDIwIDEwLjYgMjAgMTQgMjAgQzE0LjMzIDIxLjMyIDE0LjY2IDIyLjY0IDE1IDI0IEMxMC4wNSAyNCA1LjEgMjQgMCAyNCBDMCAxNi4wOCAwIDguMTYgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDU2LDg1KSIvPgo8cGF0aCBkPSJNMCAwIEMxNC41MiAwIDI5LjA0IDAgNDQgMCBDNDMuMzQgMS42NSA0Mi42OCAzLjMgNDIgNSBDMjguMTQgNSAxNC4yOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMTMuODYgMCAyNy43MiAwIDQyIDAgQzQyLjY2IDEuNjUgNDMuMzIgMy4zIDQ0IDUgQzI5LjQ4IDUgMTQuOTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTUxOTMyMjEgNS44NTU3OTY2MyAzLjYyOTIyNzk1IDE1LjU1OTg2NzYxIDAuOTE0MDYyNSAyMS4yOTI5Njg3NSBDMC40NDc0MjE4NyAyMS44MzU2NjQwNiAtMC4wMTkyMTg3NSAyMi4zNzgzNTkzOCAtMC41IDIyLjkzNzUgQy0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjIyMjkwNTM0IDI1LjY1Mjg1NDI2IC0zLjExMzI4MTI1IDI4LjQwNjI1IEMtMi44NDc1MjI1NiAzMC42NDI3NjQ2OSAtMi41MDI2MTIyNCAzMi44MDU0MjU3OCAtMiAzNSBDLTYuNjI1IDM4IC02LjYyNSAzOCAtMTAgMzggQy0xMC4zMyAzOS4zMiAtMTAuNjYgNDAuNjQgLTExIDQyIEMtMTIuMzIgNDIgLTEzLjY0IDQyIC0xNSA0MiBDLTE2LjcwMzEyNSA0MC4xMDE1NjI1IC0xNi43MDMxMjUgNDAuMTAxNTYyNSAtMTguMjUgMzcuNjI1IEMtMTguNzcwNzgxMjUgMzYuODEyODkwNjIgLTE5LjI5MTU2MjUgMzYuMDAwNzgxMjUgLTE5LjgyODEyNSAzNS4xNjQwNjI1IEMtMjEgMzMgLTIxIDMzIC0yMSAzMSBDLTE4LjA5NDUxMTE4IDI4Ljk1ODMwNTE1IC0xNi41OTg1Nzk1NCAyOCAtMTMgMjggQy0xMyAyOC45OSAtMTMgMjkuOTggLTEzIDMxIEMtMTAuMDI5ODIzMDYgMzAuMzcxODk4MjcgLTEwLjAyOTgyMzA2IDMwLjM3MTg5ODI3IC03IDI5IEMtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNS44MDE2MTc5MSAyNi42NzE0NTUzNyAtNSAyNCBDLTQuMzI1ODIwMzEgMjMuMjk4NzUgLTMuNjUxNjQwNjMgMjIuNTk3NSAtMi45NTcwMzEyNSAyMS44NzUgQy0wLjI3MTkxNzk2IDE3LjkzMDQwMjQ0IC0wLjU4MDIxNDc2IDE0Ljk1NDI2NzczIC0wLjgxMjUgMTAuMzEyNSBDLTEuMDkwOTg5MDUgMi4xODE5NzgxMSAtMS4wOTA5ODkwNSAyLjE4MTk3ODExIDAgMCBaICIgZmlsbD0iI0VCRjNFRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDLTAuNDAyODE3NzEgNS44NDA4NTY3NCAtMS4xMTI3NzkgOS4zNzczNTg4MSAtNSAxNCBDLTguMjkwNzY2NiAxNi43MTg0NTkzNyAtMTAuMDk2NDA4NjQgMTcuOTMzMDY3MzEgLTE0LjM3NSAxOC4yNSBDLTE1LjI0MTI1IDE4LjE2NzUgLTE2LjEwNzUgMTguMDg1IC0xNyAxOCBDLTE2LjY2ODA5NTE4IDExLjY5MzgwODQyIC0xNS41MDUxNjQ5NyA3LjU2NTU1NTkzIC0xMSAzIEMtNy4yMTg5MzIxOCAwLjU1ODA2MDM3IC00LjQ5MzYzOTc2IC0wLjM5NjQ5NzYzIDAgMCBaICIgZmlsbD0iIzAwMDAwMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ1LDM3KSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1MDUzNTExIC0wLjA3NDM1MjIyIDkuNTAwNzI4ODcgLTAuMTI4Njk2OTEgMTQuMjUxNzA4OTggLTAuMTY0Nzk0OTIgQzE1Ljg2NjY3Nzg5IC0wLjE3OTg0ODc2IDE3LjQ4MTYwNjEzIC0wLjIwMDI5NjQ4IDE5LjA5NjQzNTU1IC0wLjIyNjMxODM2IEMyMS40MjI0NjU1NSAtMC4yNjI4NTI4NiAyMy43NDc5NTM0MSAtMC4yNzk3NjAxNSAyNi4wNzQyMTg3NSAtMC4yOTI5Njg3NSBDMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjcuMTUxMDcxODUgLTAuMzE2MTk0NTMgMjguMjQ5Njc5NTcgLTAuMzM5ODg5NTMgQzMyLjY1ODMwNTk5IC0wLjM0MTM1Nzg4IDM1LjUyNjI3Nzc5IDAuMjE1ODYwOTQgMzkgMyBDMzkgMy42NiAzOSA0LjMyIDM5IDUgQzI2LjEzIDUgMTMuMjYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDEsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNDgyMDk2ODIgMjMuMDU2OTA4MjUgMi42OTk5NDI5NCAyNC41NDk5MTQ0MSA1IDI4IEM3LjMzNDU4NjM1IDMxLjUwMTg3OTUzIDcuNjcyNjA3MjcgMzIuODgwMjgwNDcgNyAzNyBDNi4zNDg5OTE3IDM4LjE2Njk1MjY0IDUuNjU4MzE0NjEgMzkuMzEyMzI1OTggNC45Mzc1IDQwLjQzNzUgQzMuMTY4MTQxMTcgNDMuMjg2MDQyMjIgMi45OTk2OTkxNiA0My45ODI4NTIyOSAzLjA2MjUgNDcuNTYyNSBDNC4wMDI5NTg2MSA1MS4wMTA4NDgyMyA1LjM3ODg4Njc3IDUzLjgyODI1NjcyIDcgNTcgQzcgNTguMzIgNyA1OS42NCA3IDYxIEM1LjAyIDYxLjQ5NSA1LjAyIDYxLjQ5NSAzIDYyIEMyLjcxMTI1IDYwLjc4MzEyNSAyLjQyMjUgNTkuNTY2MjUgMi4xMjUgNTguMzEyNSBDMS41MTk4MDg4OSA1NS44MzA3ODEwNyAwLjg5MjAyOTY2IDUzLjc2NzAxMTM3IC0wLjE4NzUgNTEuNDM3NSBDLTEuMzQyMzE4NDQgNDcuOTczMDQ0NjggLTAuODE4NjU2ODYgNDUuNTI2NTIxODcgMCA0MiBDMC43NzM0Mzc1IDQwLjczMTU2MjUgMC43NzM0Mzc1IDQwLjczMTU2MjUgMS41NjI1IDM5LjQzNzUgQzMuNDExMzY2MjEgMzYuMzAyNDY1OTkgMy41MTMyNzU5MiAzNC41OTI5MzE0MSAzIDMxIEMyLjM0IDMwLjAxIDEuNjggMjkuMDIgMSAyOCBDLTEuMzMwNDM1NTggMjQuNTA0MzQ2NjQgLTEuNTg3NjMyNDQgMjMuMTEzNDI3MSAtMSAxOSBDLTAuNTA1IDE3Ljg2NTYyNSAtMC4wMSAxNi43MzEyNSAwLjUgMTUuNTYyNSBDMi41NDM3NjAwOCAxMC43MDg1Njk4MSAyLjY5NzAxMDU0IDcuMDQ3NDY4NDUgMSAyLjA2MjUgQzAuNjcgMS4zODE4NzUgMC4zNCAwLjcwMTI1IDAgMCBaICIgZmlsbD0iI0U5RjFFRSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OSw1OSkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwLjMzIDIuNjQgMC42NiA0IDEgQzUuMTU2NjQ3MzcgNi40ODI2OTA2OSA1LjExNDE2MjU1IDExLjgwMzM5Mjc0IDUuMDYyNSAxNy4zNzUgQzUuMDU3OTg4MjggMTguMzAxODM1OTQgNS4wNTM0NzY1NiAxOS4yMjg2NzE4OCA1LjA0ODgyODEyIDIwLjE4MzU5Mzc1IEM1LjAzNzExNTc0IDIyLjQ1NTc5NzA5IDUuMDIwNzEzNzIgMjQuNzI3ODYzODggNSAyNyBDMy4zNSAyNy4zMyAxLjcgMjcuNjYgMCAyOCBDLTIuNjA1MTM5NTkgMjQuMDkyMjkwNjIgLTIuMjkzNjc1NjUgMjAuNzc3NzA5MjEgLTIuMjUgMTYuMjUgQy0yLjI1NzczNDM4IDE1LjQ2MzY3MTg4IC0yLjI2NTQ2ODc1IDE0LjY3NzM0Mzc1IC0yLjI3MzQzNzUgMTMuODY3MTg3NSBDLTIuMjU2ODM4MzYgOC44NzA4NDc1NSAtMS41OTU2NjE5NSA0LjczNjMyOTkxIDAgMCBaICIgZmlsbD0iIzIyMUUyMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTY5LDcxKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNi4wNjgwODM3NCA3LjI3NDk5MTk3IDcuMDQzNjc4MzkgMTMuODY4OTY0ODMgNSAyMCBDNC40NDQ5NTIwOSAyNS44ODM1MDc4OCA1Ljc0ODA2MTcyIDI4LjIyMzcxNTY1IDkgMzMgQzkuNjgyNDU2MDcgMzcuMDA5NDI5NCA5LjA2MjU0MzA2IDM5LjEyMDM1OTYxIDYuOTM3NSA0Mi40Mzc1IEM1LjE4NzQ3ODQxIDQ1LjI2MTExNjM5IDQuOTk5MzU1NTggNDUuOTYzOTEyNyA1LjA2MjUgNDkuNSBDNi4wNjQxNTYzNSA1My4yMzk1MTcwMiA3LjQxMDgyMDg0IDU2LjQ3NjE2Nzk1IDkgNjAgQzkgNjAuNjYgOSA2MS4zMiA5IDYyIEM4LjAxIDYyIDcuMDIgNjIgNiA2MiBDNS4xMjcyMDEzOCA2MC4xMzM2MDAxOSA0LjI3NzQ4OTczIDU4LjI1NjM5Mzg5IDMuNDM3NSA1Ni4zNzUgQzIuOTYxODM1OTQgNTUuMzMwODU5MzggMi40ODYxNzE4OCA1NC4yODY3MTg3NSAxLjk5NjA5Mzc1IDUzLjIxMDkzNzUgQzAuODc4NDcyMzMgNDkuNjA4MjUxOTcgMS4wMTg2Mjk2NiA0Ny42MDg1ODA1MSAyIDQ0IEMyLjUxNTYyNSA0My4xNzUgMy4wMzEyNSA0Mi4zNSAzLjU2MjUgNDEuNSBDNS4zODcwMjc1NiAzOC4zMjY5MDg1OCA1LjUxNjQ0MTE4IDM2LjYxNTA4ODI1IDUgMzMgQzQuMzE5Mzc1IDMyLjA3MTg3NSAzLjYzODc1IDMxLjE0Mzc1IDIuOTM3NSAzMC4xODc1IEMwLjMyMzM1MDI2IDI1Ljg4NjgwMjA0IDAuODgyMTgxNzcgMjIuNzc3MDAxIDIgMTggQzIuMzMgMTcuMzQgMi42NiAxNi42OCAzIDE2IEMzLjQxNzQwMjY4IDExLjA1OTExNzE1IDMuNDg3NDY4NzMgNi40MjIxNjY2NCAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxRDc1NTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMC42NiAwLjY2IDEuMzIgMSAyIEMwLjY3IDIuNjYgMC4zNCAzLjMyIDAgNCBDMC4wMjM3OTA0IDYuMzExMDc4NzggMC4wMjM3OTA0IDYuMzExMDc4NzggMC4zMTI1IDguODc1IEMwLjM5MTEzMjgxIDkuNzM4NjcxODcgMC40Njk3NjU2MyAxMC42MDIzNDM3NSAwLjU1MDc4MTI1IDExLjQ5MjE4NzUgQzEuMDAzMjA3MjQgMTQuMDE3OTA0NzUgMS44MTI2MDgzMyAxNS43NDgyMTM0IDMgMTggQzMuNzA0NDkyODkgMjMuNDAxMTEyMTcgMS45Mjk0NDIzOSAyNS42MDU4MzY0MiAtMSAzMCBDLTEuNjc4NzgwNTkgMzQuMDcyNjgzNTYgLTEuMzQxNzI0MDYgMzUuNDk4MDkyNzkgMSAzOC45Mzc1IEMzLjQ1MjU5MTI5IDQyLjY5MzAzMDQxIDMuNTUxNTQyOTEgNDQuNTg3NjU2NyAzIDQ5IEMyLjA2NTUzNDY1IDUxLjAzMTQ0NjQxIDEuMDY3NzUyMjQgNTMuMDM1MzM1ODcgMCA1NSBDLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTAuNjk5MDc0MTQgNTcuNzM1NzI1ODUgLTEgNjAgQy0yLjMyIDU5LjY3IC0zLjY0IDU5LjM0IC01IDU5IEMtNC41MjI2OTE2MiA1Ny41NDEwNTc0IC00LjA0MzA4OTU4IDU2LjA4Mjg2NTA0IC0zLjU2MjUgNTQuNjI1IEMtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMy4xNjIyNDYwOSA1My40MDY4MzU5NCAtMi43NTM5MDYyNSA1Mi4xNjQwNjI1IEMtMiA1MCAtMiA1MCAtMSA0OCBDLTAuNTQzMTA3NzYgNDQuMDcwNzI2NzUgLTAuOTU5NzA3MDkgNDEuNzM5NDU4MTMgLTMgMzguNDM3NSBDLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUuNzU4MjkzODQgMzMuNjk2NjgyNDYgLTUgMzAgQy00LjM0IDI5LjA1MTI1IC0zLjY4IDI4LjEwMjUgLTMgMjcuMTI1IEMtMC41ODgzOTUzIDIzLjM1Njg2NzY2IC0wLjUyMDEwNzIzIDIxLjM5OTAxNzAyIC0xIDE3IEMtMS4zMyAxNi4xOTU2MjUgLTEuNjYgMTUuMzkxMjUgLTIgMTQuNTYyNSBDLTMuNDY1MDU4MjkgMTAuODA4Mjg4MTIgLTMuMzIwMjAxNTkgOC4wMzQ1NDAwMiAtMyA0IEMtMS41IDEuNSAtMS41IDEuNSAwIDAgWiAiIGZpbGw9IiNGMUY2RjQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTEsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzMgMSAzIDEgNSA0IEM1IDQuOTkgNSA1Ljk4IDUgNyBDNS42NiA2LjY3IDYuMzIgNi4zNCA3IDYgQzguNTQwMjM5OTYgNS45MzA0OTQ1OSAxMC4wODMzNDk4OCA1LjkxNTQ3NjQzIDExLjYyNSA1LjkzNzUgQzEyLjg1MDg5ODQ0IDUuOTUxMDM1MTYgMTIuODUwODk4NDQgNS45NTEwMzUxNiAxNC4xMDE1NjI1IDUuOTY0ODQzNzUgQzE1LjA0MTI4OTA2IDUuOTgyMjQ2MDkgMTUuMDQxMjg5MDYgNS45ODIyNDYwOSAxNiA2IEMxNS4yMzY4NzUgNi43NDI1IDE0LjQ3Mzc1IDcuNDg1IDEzLjY4NzUgOC4yNSBDMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgMTEuMDU1OTU5NzIgMTAuNzU4MDE3NDUgOS42NTIzNDM3NSAxMy4wOTc2NTYyNSBDNy41MTM0ODk4OSAxNS41NjAxMTkyIDYuMDYwMDUxNDUgMTUuNzE4NTYzODUgMi44NzUgMTYuMTg3NSBDLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTAuMzYzMTQzNTQgMTYuNDU4MzM3OTMgLTMgMTggQy00LjY2NjE3MTE1IDE4LjA0MDYzODMyIC02LjMzMzg4MDk1IDE4LjA0MjcyMSAtOCAxOCBDLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTcuMjU5NDMzNTkgMTYuOTMwNzIyNjYgLTYuNTAzOTA2MjUgMTUuODM5ODQzNzUgQy0xLjU0NzYwNyA4LjUwMTAxOTAzIC0xLjU0NzYwNyA4LjUwMTAxOTAzIDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNiw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMS44NzUgMS4xMjUgMS44NzUgMS4xMjUgMyAzIEMzLjY4NzUgNi4xODc1IDMuNjg3NSA2LjE4NzUgNCA5IEMwLjM3IDkgLTMuMjYgOSAtNyA5IEMtNi4wMSA5Ljk5IC01LjAyIDEwLjk4IC00IDEyIEMtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAtMC4zNTQ1ODE1NSAxMS43NjUyMjgwMSAzIDExIEMyLjY3IDEyLjY1IDIuMzQgMTQuMyAyIDE2IEMtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNC4yNDE1OTc5NyAxNy4zNDYyMjcwMSAtNy44NzUgMTUuNjg3NSBDLTEwIDE0IC0xMCAxNCAtMTEgMTIgQy0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC0xMS41NzE0Mjg1NyA0LjkxNDI4NTcxIC05LjQzNzUgMS41IEMtNi4wODk2NTY1MSAtMC41NjAyMTEzOCAtMy44NTk4NTc1MyAtMC40OTEyNTQ1OSAwIDAgWiBNLTUgMyBDLTUuOTkgNC40ODUgLTUuOTkgNC40ODUgLTcgNiBDLTQuNjkgNiAtMi4zOCA2IDAgNiBDLTAuNjYgNS4wMSAtMS4zMiA0LjAyIC0yIDMgQy0yLjk5IDMgLTMuOTggMyAtNSAzIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTAwLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEMxMC44OSAwIDIxLjc4IDAgMzMgMCBDMzIuNjcgMS4zMiAzMi4zNCAyLjY0IDMyIDQgQzI5LjA3ODAyMzEgNS40NjA5ODg0NSAyNi41MDEwNjUyNSA1LjExMTM0OTAxIDIzLjI0MjE4NzUgNS4wOTc2NTYyNSBDMjIuMjQ3NjEwMzIgNS4wOTU1MzM4MyAyMi4yNDc2MTAzMiA1LjA5NTUzMzgzIDIxLjIzMjk0MDY3IDUuMDkzMzY4NTMgQzE5LjExMzU4MTM3IDUuMDg3NzY3NTQgMTYuOTk0MzI3NDEgNS4wNzUyMTUgMTQuODc1IDUuMDYyNSBDMTMuNDM4ODAzNjEgNS4wNTc0ODUxMiAxMi4wMDI2MDU1NiA1LjA1MjkyMjE5IDEwLjU2NjQwNjI1IDUuMDQ4ODI4MTIgQzcuMDQ0MjM2NTUgNS4wMzc3OTc4MiAzLjUyMjEyODU1IDUuMDIwNTMyNTkgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTQ5LDcyKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjIxNzQ5MjE5IC0wLjA3NDE5MTM0IDguNDM0NjM4MTEgLTAuMTI4NjIwNCAxMi42NTI1ODc4OSAtMC4xNjQ3OTQ5MiBDMTQuMDg3MjI1NTIgLTAuMTc5ODc1ODkgMTUuNTIxODE3MDggLTAuMjAwMzQzOCAxNi45NTYyOTg4MyAtMC4yMjYzMTgzNiBDMTkuMDE5MTU4NTkgLTAuMjYyNzM0MzcgMjEuMDgxNDA4NTggLTAuMjc5NzMyNDMgMjMuMTQ0NTMxMjUgLTAuMjkyOTY4NzUgQzI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI1LjAwNjIxOTQ4IC0wLjMxNjUzNDQyIDI2LjkwNTUxNzU4IC0wLjM0MDU3NjE3IEMzMCAwIDMwIDAgMzEuOTI4NDY2OCAxLjM5MzMxMDU1IEMzMyAzIDMzIDMgMzMgNSBDMjIuMTEgNSAxMS4yMiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDMC42NiAwIDEuMzIgMCAyIDAgQzIuMDg2MzY3MTkgMC41Njg0NzY1NiAyLjE3MjczNDM3IDEuMTM2OTUzMTIgMi4yNjE3MTg3NSAxLjcyMjY1NjI1IEMzLjM1MjcwNTM2IDcuNzE4MDc4MSA1LjI4MTQzMTU2IDExLjIwNTAwMzg1IDkgMTYgQzkgMTYuNjYgOSAxNy4zMiA5IDE4IEM4LjI3NTU0Njg3IDE3Ljg0NjYwMTU2IDcuNTUxMDkzNzUgMTcuNjkzMjAzMTIgNi44MDQ2ODc1IDE3LjUzNTE1NjI1IEM0LjA3MzM2NjA3IDE2Ljk3MzE0OTc3IDQuMDczMzY2MDcgMTYuOTczMTQ5NzcgMS41NzAzMTI1IDE2Ljc0NjA5Mzc1IEMtNC45MDkwNjM1OCAxNS45Mjg0MDg5MSAtNy44MDY5NTYzOCAxMy44OTExMzYyMyAtMTEuODIwMzEyNSA4Ljc3NzM0Mzc1IEMtMTMgNyAtMTMgNyAtMTMgNiBDLTYuMzc1IDUuODc1IC02LjM3NSA1Ljg3NSAtMyA3IEMtMi44NzYyNSA2LjQwMTg3NSAtMi43NTI1IDUuODAzNzUgLTIuNjI1IDUuMTg3NSBDLTIgMyAtMiAzIDAgMCBaICIgZmlsbD0iI0YyRjdGNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5NCw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS44MTI1IEMwLjg3OTY0ODA4IDkuMzg2NDYzMTggMS42NDA2MzE3NyAxMS42ODY1Mzk5NCAzIDE1IEMzLjQ3NzIyODgxIDE5LjM3NDU5NzM5IDMuNDk4NjQwNDQgMjEuMjg5ODE1MTMgMC45Mzc1IDI0LjkzNzUgQy0xLjA1MTY1MDY5IDI4LjA4MTY0MTQxIC0xLjI4MzkwMDM2IDI4LjY1NDU4MTU5IC0wLjkzNzUgMzIuMTI1IEMtMC4wNDE1OTEyMiAzNS44MjgwODk2MSAwLjc4Mzk2MDg3IDM3LjEwOTUxNDE4IDMgNDAgQzMuNjQwNzA0NzggNDQuOTEyMDY5OTQgMi4yODAwNjUxNiA0Ny43MTM0Nzc1IDAgNTIgQy0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0wLjY5OTA3NDE0IDU0LjczNTcyNTg1IC0xIDU3IEMtMS45OSA1NyAtMi45OCA1NyAtNCA1NyBDLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTMuMjQ3ODEzNDEgNTAuNDgxMDQ5NTYgLTEuOTM3NSA0Ny45Mzc1IEMtMC41NTU0NjYzNyA0NS4wODEyOTcxNyAtMC42Mjk3ODY4MiA0My4xNDY4MTIgLTEgNDAgQy0xLjkyMzQ0MjExIDM4LjIzNzkyNDggLTEuOTIzNDQyMTEgMzguMjM3OTI0OCAtMy4wNjI1IDM2LjUgQy00LjcyOTM3MDExIDMzLjgyMjM2ODIyIC01LjAwMjU5OTI2IDMzLjEzMjU2MjEgLTQuOTM3NSAyOS44MTI1IEMtNCAyNyAtNCAyNyAtMi40Mzc1IDI1LjE4NzUgQy0wLjE2NjczOTU4IDIxLjczMTk5NTAyIC0wLjYxNDU0MzE5IDE4LjAyNTA1ODY1IC0xIDE0IEMtMS4zMyAxMy4wMSAtMS42NiAxMi4wMiAtMiAxMSBDLTIuMTY3OTY4NzUgOS4wNjI1IC0yLjE2Nzk2ODc1IDkuMDYyNSAtMi4xODc1IDcgQy0yLjIwMTY3OTY5IDYuMzE5Mzc1IC0yLjIxNTg1OTM4IDUuNjM4NzUgLTIuMjMwNDY4NzUgNC45Mzc1IEMtMiAzIC0yIDMgMCAwIFogIiBmaWxsPSIjMTQ3MDRCIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMxMi44NyAwIDI1Ljc0IDAgMzkgMCBDMzUuMDM1MDk2OTkgMy45NjQ5MDMwMSAzNS4wMzUwOTY5OSAzLjk2NDkwMzAxIDMwLjY1MTg1NTQ3IDQuMTEzNTI1MzkgQzI5LjIyMzYyMzAzIDQuMTEzMzY2ODggMjcuNzk1Mzg0NTggNC4xMDc3MDczNSAyNi4zNjcxODc1IDQuMDk3NjU2MjUgQzI1LjIzOTQzNDA1IDQuMDk1NTMzODMgMjUuMjM5NDM0MDUgNC4wOTU1MzM4MyAyNC4wODg4OTc3MSA0LjA5MzM2ODUzIEMyMS42ODQyMjQ5IDQuMDg3NzY0NjUgMTkuMjc5NjQ0NzMgNC4wNzUyMTE1NyAxNi44NzUgNC4wNjI1IEMxNS4yNDYwOTUwOSA0LjA1NzQ4NTUgMTMuNjE3MTg4NzMgNC4wNTI5MjI1IDExLjk4ODI4MTI1IDQuMDQ4ODI4MTIgQzcuOTkyMTUxNzMgNC4wMzc3OTM5NyAzLjk5NjA5MTU4IDQuMDIwNTI2NzkgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0MSwxMDIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNDQ1MDA2NiAyLjkzNTY2NDIzIDMuNTc0ODI0NjQgNS4yNTc0NDI5NCAzLjk2ODc1IDkuNTk3NjU2MjUgQzMuOTk4ODM1MiAxMS45MTA0NTU4IDMuNzA3ODg2MzggMTMuODY2Mzg3MzUgMy4yNSAxNi4xMjUgQzIuOTg0MTIwNjEgMjAuMjQ2MTMwNTMgMy4xMDk4NDA0MiAyMC42ODU1NzQyMiA1LjQzNzUgMjMuNzUgQzUuOTEwNTg1OTQgMjQuMjgxMDkzNzUgNi4zODM2NzE4NyAyNC44MTIxODc1IDYuODcxMDkzNzUgMjUuMzU5Mzc1IEM4IDI3IDggMjcgOCAzMSBDMTAuMzEgMzEuNjYgMTIuNjIgMzIuMzIgMTUgMzMgQzE1IDMzLjk5IDE1IDM0Ljk4IDE1IDM2IEMxNi4zMiAzNi42NiAxNy42NCAzNy4zMiAxOSAzOCBDMTkgMzguOTkgMTkgMzkuOTggMTkgNDEgQzE3LjkxNzE4NzUgNDAuNDc0MDYyNSAxNy45MTcxODc1IDQwLjQ3NDA2MjUgMTYuODEyNSAzOS45Mzc1IEMxNC4wNzY4ODc3IDM4Ljc1NjQ4MjEyIDE0LjA3Njg4NzcgMzguNzU2NDgyMTIgMTEuNSAzOS41NjI1IEM5IDQwIDkgNDAgNi4xODc1IDM4LjU2MjUgQzUuNDY1NjI1IDM4LjA0Njg3NSA0Ljc0Mzc1IDM3LjUzMTI1IDQgMzcgQzQuMTk1MjkyOTcgMzYuMTY0Njg3NSA0LjE5NTI5Mjk3IDM2LjE2NDY4NzUgNC4zOTQ1MzEyNSAzNS4zMTI1IEM1LjMwMzg2MTMxIDMwLjQ2NzI5MzAxIDUuMzAzODYxMzEgMzAuNDY3MjkzMDEgMy45MTc5Njg3NSAyNS44NjcxODc1IEMyLjk3NDUwMDc2IDI0LjU0MTY1Mzk2IDIuMDI5MTkzNjQgMjMuMjE3NDI3NDggMS4wODIwMzEyNSAyMS44OTQ1MzEyNSBDLTAuNjgwNTA5NzQgMTguODA4NDkzNzggMC4yMzQyODE5NyAxNi4zNTczNzkwNyAxIDEzIEMxLjA4MjI5MTcgMTEuNDM5MTEyMjkgMS4xMjI0NDU5OSA5Ljg3NTU1MzM3IDEuMTI1IDguMzEyNSBDMS4xMjg4NjcxOSA3LjIyMzg4NjcyIDEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEzMjgxMjUgNi4xMTMyODEyNSBDMC45OTc4MDczMiAzLjk2NTExMDU5IDAuNTg3NzI5NCAyLjA2NjM4MTk1IDAgMCBaICIgZmlsbD0iI0VGRjVGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw2MykiLz4KPHBhdGggZD0iTTAgMCBDOS4yNCAwIDE4LjQ4IDAgMjggMCBDMjggMS42NSAyOCAzLjMgMjggNSBDMTguNzYgNSA5LjUyIDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDk0KSIvPgo8cGF0aCBkPSJNMCAwIEM5LjI0IDAgMTguNDggMCAyOCAwIEMyOCAxLjY1IDI4IDMuMyAyOCA1IEMxOC43NiA1IDkuNTIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuNjUgMjggMy4zIDI4IDUgQzE4Ljc2IDUgOS41MiA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxMCw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjc1NDE0MjM1IDIyLjQ5MDU2OTM3IC0wLjI2NzY1MDE5IDI1LjU4MjA3Mjg1IC00IDMxIEMtMy45Mjc0OTIxNCAzNC41NTI4ODQ5NCAtMy4zMTc3NDE2NCAzNi40OTE2MTMzNyAtMS40Mzc1IDM5LjUgQzAuNDMyMjMyNTQgNDIuNzUxNzA4NzYgMC40OTI4MjA0OCA0NC4yNjg2NDQ5NCAwIDQ4IEMtMS4xNzkwNDA1IDUxLjQwNDQxNTYzIC0yLjU0MTk2MzU0IDU0LjcwNjM5OTc4IC00IDU4IEMtNC45OSA1Ny42NyAtNS45OCA1Ny4zNCAtNyA1NyBDLTYuNTc1MjcyMSA1NC40NTE2MzI2IC02LjE4NjYwNjY3IDUyLjM0MDI4Mjc1IC00LjkzNzUgNTAuMDYyNSBDLTMuNjI5MDkzODEgNDcuMTg0MDA2MzkgLTMuNjg2MTgxNDMgNDUuMTM4MTg1NzMgLTQgNDIgQy00LjQ5NSA0MS4wMSAtNC45OSA0MC4wMiAtNS41IDM5IEMtNy4yMTc0NTA3IDM1LjU2NTA5ODYgLTcuNTUyMzU3MzMgMzMuNzg3NTkzMTMgLTcgMzAgQy01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC01Ljk4MjkyOTY5IDI4LjY2Nzc1MzkxIC00Ljk0NTMxMjUgMjcuMzA4NTkzNzUgQy0yLjU3NzgwMDU3IDIzLjI4MTkyMTg1IC0yLjgyMDAzNjc0IDIwLjUwMjM1NDg2IC0zLjQzNzUgMTYuMDYyNSBDLTQuMjQwNTQ3MzkgMTAuMDc2NjY0NDYgLTMuNzgyNzc2OTMgNi4zMjc0MTg5MSAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjRTRFRUVBIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ4LDYwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjkwOTM4NzAzIDMuNzM5NDEzNjggMy45MDkzODcwMyAzLjczOTQxMzY4IDQuMTMyODEyNSA2Ljg0NzY1NjI1IEM0LjEzMDIzNDM4IDcuNTc4NTU0NjkgNC4xMjc2NTYyNSA4LjMwOTQ1MzEzIDQuMTI1IDkuMDYyNSBDNC4xMjI0MjE4OCA5Ljg2MzAwNzgxIDQuMTE5ODQzNzUgMTAuNjYzNTE1NjMgNC4xMTcxODc1IDExLjQ4ODI4MTI1IEM0LjAwMTcwMTk1IDEzLjk2MzUyMTY0IDMuNjUxMDI0NzkgMTYuMzA3MDIyNDggMy4yNSAxOC43NSBDMi43NjIwMjY5NSAyMi40MjA4OTQxOCAyLjc2MjAyNjk1IDIyLjQyMDg5NDE4IDQuOTM3NSAyNS41NjI1IEM1Ljk1ODQzNzUgMjYuNzY5MDYyNSA1Ljk1ODQzNzUgMjYuNzY5MDYyNSA3IDI4IEM4LjA0NzU1MTk0IDMzLjMxNDE0MzcgNi44NDIyMzI0NCAzNi40OTk3OTg2MyA0IDQxIEMzLjM3MDk3MDM5IDQ1LjkyNzM5ODU3IDQuNzQ3ODkzNDUgNDguNjgzNDYyNDQgNyA1MyBDNyA1NC4zMiA3IDU1LjY0IDcgNTcgQzQgNTYgNCA1NiAyLjc5Njg3NSA1My45MjU3ODEyNSBDLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgLTAuNzYwMjg1NzMgNDUuMDQ2MTUyNDIgMSA0MCBDMS41MTU2MjUgMzkuMTc1IDIuMDMxMjUgMzguMzUgMi41NjI1IDM3LjUgQzQuMzg3MDI3NTYgMzQuMzI2OTA4NTggNC41MTY0NDExOCAzMi42MTUwODgyNSA0IDI5IEMzLjM0IDI4LjAzMDYyNSAyLjY4IDI3LjA2MTI1IDIgMjYuMDYyNSBDLTAuNDEwNTc3ODIgMjIuMzcxMzAyNzIgLTAuNDA4MzI3NTUgMjAuMzI4MjcxOTkgMCAxNiBDMC4zMyAxNS4wMSAwLjY2IDE0LjAyIDEgMTMgQzEuMDkyNDczODEgMTEuNTIzMTM4ODkgMS4xMjk5OTA3MSAxMC4wNDIyNDQ5OSAxLjEyNSA4LjU2MjUgQzEuMTI4ODY3MTkgNy40MTk3NDYwOSAxLjEyODg2NzE5IDcuNDE5NzQ2MDkgMS4xMzI4MTI1IDYuMjUzOTA2MjUgQzEuMDAyNzYwMTUgNC4wNDY4NDE0MSAwLjYwODU2MTk5IDIuMTIwMzA3MjQgMCAwIFogIiBmaWxsPSIjRTZGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc0LDYxKSIvPgo8cGF0aCBkPSJNMCAwIEM4LjI1IDAgMTYuNSAwIDI1IDAgQzI1LjY2IDEuNjUgMjYuMzIgMy4zIDI3IDUgQzE4LjA5IDUgOS4xOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw1NykiLz4KPHBhdGggZD0iTTAgMCBDOC4yNSAwIDE2LjUgMCAyNSAwIEMyNSAxLjY1IDI1IDMuMyAyNSA1IEMxNi40MiA1IDcuODQgNSAtMSA1IEMtMC42NyAzLjM1IC0wLjM0IDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjQsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyLjMzIDEuNjUgMi42NiAzLjMgMyA1IEM0LjY1IDUgNi4zIDUgOCA1IEM3LjAxIDYuNDg1IDcuMDEgNi40ODUgNiA4IEM1LjgzMjg2NDMxIDEwLjYyNTMxNTI0IDUuODMyODY0MzEgMTAuNjI1MzE1MjQgNiAxMyBDNi42NiAxMy4zMyA3LjMyIDEzLjY2IDggMTQgQzcuMzQgMTQgNi42OCAxNCA2IDE0IEM2IDE0LjY2IDYgMTUuMzIgNiAxNiBDMi43IDE2IC0wLjYgMTYgLTQgMTYgQy00IDE1LjM0IC00IDE0LjY4IC00IDE0IEMtNC42NiAxMy42NyAtNS4zMiAxMy4zNCAtNiAxMyBDLTUuMzQgMTMgLTQuNjggMTMgLTQgMTMgQy0zLjc5OTEzNTU3IDkuMjg0MDA4MDkgLTMuODQ4MDU2MyA4LjIyNzkxNTU1IC02IDUgQy00LjM1IDUgLTIuNyA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iI0Q4RTdFMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2MCwzNykiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNzYzMTI1IDQuNzczMTI1IC0xLjUyNjI1IDQuNTQ2MjUgLTIuMzEyNSA0LjMxMjUgQy0zLjE5OTM3NSA0LjIwOTM3NSAtNC4wODYyNSA0LjEwNjI1IC01IDQgQy02LjgzNTQ3OTkgNS4zMzM3ODU3NSAtNi44MzU0Nzk5IDUuMzMzNzg1NzUgLTggNyBDLTcuMzQgOC42NSAtNi42OCAxMC4zIC02IDEyIEMtMy42OSAxMiAtMS4zOCAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTUuMjAwODE5NjcgMTcuMzM3NDMxNjkgLTguODEyNSAxNS44MTI1IEMtMTEuMTQwMzY2MTcgMTMuODgzNjk2NiAtMTIuMTcyMjU2MTEgMTIuODk3MTAzNjEgLTEzIDEwIEMtMTIuODU1NzAyNCA2LjUzNjg1NzUgLTEyLjM0NTYyNDk3IDQuNTI1MzQ5OTYgLTEwLjQzNzUgMS42MjUgQy02Ljg1NzUyODY3IC0wLjc2MTY0NzU1IC00LjI0ODUyOTc0IC0wLjI4MzIzNTMyIDAgMCBaICIgZmlsbD0iIzAwODQyOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjE5Miw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQzEuNjUgMyAzLjMgMyA1IDMgQzUgNC4zMiA1IDUuNjQgNSA3IEMzLjM1IDcgMS43IDcgMCA3IEMwIDkuOTcgMCAxMi45NCAwIDE2IEMxLjY1IDE1LjY3IDMuMyAxNS4zNCA1IDE1IEM1IDE2LjMyIDUgMTcuNjQgNSAxOSBDMS43MTMwMzc2NyAxOS43OTk1MzEzOCAwLjI4OTc2ODA4IDIwLjA5NjU4OTM2IC0zIDE5IEMtNC4yNjIzNzczMSAxNi40NzUyNDUzOCAtNC4wOTg1NjQwNCAxNC42ODc5OTUzNCAtNC4wNjI1IDExLjg3NSBDLTQuMDUzNDc2NTYgMTAuOTY0OTIxODggLTQuMDQ0NDUzMTMgMTAuMDU0ODQzNzUgLTQuMDM1MTU2MjUgOS4xMTcxODc1IEMtNC4wMjM1NTQ2OSA4LjQxODUxNTYyIC00LjAxMTk1MzEzIDcuNzE5ODQzNzUgLTQgNyBDLTQuOTkgNyAtNS45OCA3IC03IDcgQy0zLjg2MjA2ODk3IDAgLTMuODYyMDY4OTcgMCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMzcsOTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMS42NSAwLjY2IDMuMyAxIDUgQzAuMDUxMjUgNC43OTM3NSAtMC44OTc1IDQuNTg3NSAtMS44NzUgNC4zNzUgQy0zLjQyMTg3NSA0LjE4OTM3NSAtMy40MjE4NzUgNC4xODkzNzUgLTUgNCBDLTcuMzQ5NzM4MTggNS44OTc1NTE0NCAtNy4zNDk3MzgxOCA1Ljg5NzU1MTQ0IC03LjEyNSA5LjEyNSBDLTcuMDYzMTI1IDEwLjU0ODEyNSAtNy4wNjMxMjUgMTAuNTQ4MTI1IC03IDEyIEMtNC4zNiAxMiAtMS43MiAxMiAxIDEyIEMxIDEzLjMyIDEgMTQuNjQgMSAxNiBDLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTUuMzI5OTc5ODggMTcuMjE3MzAzODIgLTguMzEyNSAxNi4yNSBDLTEwIDE1IC0xMCAxNSAtMTIgMTIgQy0xMi40NDUwNTU3NiA3Ljk5NDQ5ODEzIC0xMi4zNDMxOTE2NyA1LjY3MjA4MzY5IC0xMC41IDIuMDYyNSBDLTYuODg4MjI0MDkgLTAuOTE3MjE1MTMgLTQuNTg5MTk0MjEgLTAuMzgyNDMyODUgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTIyLDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM3LjU5IDAgMTUuMTggMCAyMyAwIEMyMy4zMyAxLjY1IDIzLjY2IDMuMyAyNCA1IEMxNi4wOCA1IDguMTYgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1ODcsNTApIi8+CjxwYXRoIGQ9Ik0wIDAgQzcuMjYgMCAxNC41MiAwIDIyIDAgQzIyIDEuNjUgMjIgMy4zIDIyIDUgQzE0LjQxIDUgNi44MiA1IC0xIDUgQy0wLjY3IDMuMzUgLTAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYyNyw1MCkiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAzLjY2NjY2NjY3IDEyIDcuMzMzMzMzMzMgMTIgMTEgQzguMDQgMTEgNC4wOCAxMSAwIDExIEMwIDcuMzMzMzMzMzMgMCAzLjY2NjY2NjY3IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc4MiwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzkuMjQgMCAxOC40OCAwIDI4IDAgQzI4IDEuMzIgMjggMi42NCAyOCA0IEMxOC43NiA0IDkuNTIgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEwLDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMCAxLjY1IDAgMy4zIDAgNSBDLTAuNTU1NTg1OTQgNC41MTQwMjM0NCAtMS4xMTExNzE4OCA0LjAyODA0Njg4IC0xLjY4MzU5Mzc1IDMuNTI3MzQzNzUgQy00LjM3OTY1MzUgMS43NDk2NzE5NyAtNS44NjQwNjM4NiAxLjU2NzMyNDE5IC05LjA2MjUgMS41NjI1IEMtOS45MTk3MjY1NiAxLjU0MzE2NDA2IC0xMC43NzY5NTMxMyAxLjUyMzgyODEzIC0xMS42NjAxNTYyNSAxLjUwMzkwNjI1IEMtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTQuMTc3NTgwNDEgMS43OTY0NDEzNyAtMTUuODA4NTkzNzUgNC4wMjczNDM3NSBDLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE2LjM5ODMzOTg0IDUuMDAzODA4NTkgLTE3IDYgQy0xNS4wMiA2IC0xMy4wNCA2IC0xMSA2IEMtMTAuNjcgNy42NSAtMTAuMzQgOS4zIC0xMCAxMSBDLTExLjMyIDExIC0xMi42NCAxMSAtMTQgMTEgQy0xNCAxMC4zNCAtMTQgOS42OCAtMTQgOSBDLTE1LjMyIDkgLTE2LjY0IDkgLTE4IDkgQy0xOC4zMyA3LjM1IC0xOC42NiA1LjcgLTE5IDQgQy0xOS42NiA0LjY2IC0yMC4zMiA1LjMyIC0yMSA2IEMtMjEgNC4wMiAtMjEgMi4wNCAtMjEgMCBDLTEzLjk3OTM2NDY0IC0yLjM5MDAwMzUzIC02Ljg1MjIxNDU0IC0zLjUzNjYyNjg2IDAgMCBaICIgZmlsbD0iIzE5NzM0RiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw1NykiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS42NSAyMSAzLjMgMjEgNSBDMTQuMDcgNSA3LjE0IDUgMCA1IEMwIDMuMzUgMCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTAuOTkgMyAtMS45OCAzIC0zIDMgQy0zIDMuNjYgLTMgNC4zMiAtMyA1IEMtMi4wMSA1LjMzIC0xLjAyIDUuNjYgMCA2IEMwIDcuMzIgMCA4LjY0IDAgMTAgQy02LjYyNSAxMi44NzUgLTYuNjI1IDEyLjg3NSAtMTAgMTQgQy0xMS4xOTI4NzQxMSAxMC4xMjMxNTkxMyAtMTIgNy4wODM3ODA3NyAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjMUM3NTUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS42NSAyMCAzLjMgMjAgNSBDMTMuNCA1IDYuOCA1IDAgNSBDMCAzLjM1IDAgMS43IDAgMCBaICIgZmlsbD0iIzFFNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU4Nyw5NCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgNy45MiA0IDE1Ljg0IDQgMjQgQzIuNjggMjQgMS4zNiAyNCAwIDI0IEMwIDE2LjA4IDAgOC4xNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNzcsODUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuNjA4NzUgLTAuMDIwNjI1IDMuMjE3NSAtMC4wNDEyNSA0Ljg3NSAtMC4wNjI1IEM1Ljc3OTkyMTg4IC0wLjA3NDEwMTU2IDYuNjg0ODQzNzUgLTAuMDg1NzAzMTIgNy42MTcxODc1IC0wLjA5NzY1NjI1IEMxMCAwIDEwIDAgMTIgMSBDMTEuMzQgMi4zMiAxMC42OCAzLjY0IDEwIDUgQzguMzUgNSA2LjcgNSA1IDUgQzQuNjcgOC42MyA0LjM0IDEyLjI2IDQgMTYgQzIuNjggMTYgMS4zNiAxNiAwIDE2IEMwIDEwLjcyIDAgNS40NCAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNDksOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuMjcgMCAxMi41NCAwIDE5IDAgQzE4LjY3IDEuNjUgMTguMzQgMy4zIDE4IDUgQzEyLjM5IDUgNi43OCA1IDEgNSBDMC42NyAzLjM1IDAuMzQgMS43IDAgMCBaICIgZmlsbD0iIzFGNzBDMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTYwOSw3OSkiLz4KPHBhdGggZD0iTTAgMCBDNi45MyAwIDEzLjg2IDAgMjEgMCBDMjEgMS4zMiAyMSAyLjY0IDIxIDQgQzEzLjc0IDQgNi40OCA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjEsNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuODEyNSAyLjE4NzUgMC44MTI1IDIuMTg3NSAxIDUgQy0xLjEyNSA3Ljg3NSAtMS4xMjUgNy44NzUgLTQgMTAgQy02LjgxMjUgOS44MTI1IC02LjgxMjUgOS44MTI1IC05IDkgQy05Ljc1IDYuNzUgLTkuNzUgNi43NSAtMTAgNCBDLTcuMTk2NDEzNTIgLTAuMTQ5MzA3OTkgLTQuODI5NDYzOCAtMC40MzkwNDIxNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxMDgsNDApIi8+CjxwYXRoIGQ9Ik0wIDAgQzYuOTMgMCAxMy44NiAwIDIxIDAgQzIxIDEuMzIgMjEgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjI5LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNi42IDAgMTMuMiAwIDIwIDAgQzIwLjMzIDEuMzIgMjAuNjYgMi42NCAyMSA0IEMxNC4wNyA0IDcuMTQgNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTk1LDY1KSIvPgo8cGF0aCBkPSJNMCAwIEM2LjYgMCAxMy4yIDAgMjAgMCBDMjAgMS4zMiAyMCAyLjY0IDIwIDQgQzEzLjQgNCA2LjggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTg3LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwLjY2IDAuNjYgMS4zMiAxIDIgQzAuNjcgMi42NiAwLjM0IDMuMzIgMCA0IEMwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjAyMzc5MDQgNi4zMTEwNzg3OCAwLjMxMjUgOC44NzUgQzAuMzkxMTMyODEgOS43Mzg2NzE4NyAwLjQ2OTc2NTYzIDEwLjYwMjM0Mzc1IDAuNTUwNzgxMjUgMTEuNDkyMTg3NSBDMS4wMDMyMDcyNCAxNC4wMTc5MDQ3NSAxLjgxMjYwODMzIDE1Ljc0ODIxMzQgMyAxOCBDMy42ODc1MDI5NCAyMy4yNzA4NTU4NiAyLjE2OTQxODg1IDI1Ljg0MDEzNzc1IC0xIDMwIEMtMS42NiAyOS42NyAtMi4zMiAyOS4zNCAtMyAyOSBDLTIuNTA1IDI3Ljk3OTA2MjUgLTIuNTA1IDI3Ljk3OTA2MjUgLTIgMjYuOTM3NSBDLTAuNTQwNjAwMTQgMjIuNjUwNTEyOSAtMC4yNjA1MDE3MyAxOC44MDI1MjcwNCAtMiAxNC41NjI1IEMtMy40NjUwNTgyOSAxMC44MDgyODgxMiAtMy4zMjAyMDE1OSA4LjAzNDU0MDAyIC0zIDQgQy0xLjUgMS41IC0xLjUgMS41IDAgMCBaICIgZmlsbD0iI0U1RUZFQiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw2MCkiLz4KPHBhdGggZD0iTTAgMCBDMC4zMyAwIDAuNjYgMCAxIDAgQzAuOTg4Mzk4NDQgMC43NTAyMzQzNyAwLjk3Njc5Njg3IDEuNTAwNDY4NzUgMC45NjQ4NDM3NSAyLjI3MzQzNzUgQzAuOTE5NjU0NTMgNy4zOTkxODY2NiAwLjk4NDI4NjYxIDEyLjMwMTE4MTk1IDEuNzUgMTcuMzc1IEMyLjE5NjY0NjM5IDIxLjE0NzM1MTI3IDIuMTA3NDI3NTkgMjEuODEwMjExMjYgMC4xMjUgMjUuMzEyNSBDLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTAuOTI2ODc1IDI2LjY0MjgxMjUgLTIgMjggQy0yLjc4MjE1NTg4IDMwLjcyODI1MDQgLTIuNzgyMTU1ODggMzAuNzI4MjUwNCAtMyAzMyBDLTMuOTkgMzMgLTQuOTggMzMgLTYgMzMgQy01LjY2Mzk0OTIgMjkuMzg3NDUzODUgLTUuNDU0NzA0MzIgMjcuNDg1NTg5OSAtMi45Mjk2ODc1IDI0Ljc4OTA2MjUgQy0wLjM4MTE3MzczIDIxLjEwNTU4MzA5IC0wLjgyNDUyNDMzIDE4LjI5NzIzMDcyIC0xLjM3NSAxNC4wNjI1IEMtMS45OTMyNTI0NiA4Ljg4OTQ2NTc5IC0yLjA0NDM3NzU4IDQuOTExMTE3NTYgMCAwIFogIiBmaWxsPSIjMkE3RDVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQ0LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjE2MTE1Nzc2IDEuMzY5ODM1MDMgMy45OTI3MDkyIDEuOTg5MDYzOCA2IDUgQzYuNTMwNzQ3NDEgMTAuNTE5NzczMDggNS4zMDE0OTUxMSAxNC4wMjg3NzA1NSAzIDE5IEMyLjMwODU5NDc4IDIxLjc3ODg4NjEzIDIuMzA4NTk0NzggMjEuNzc4ODg2MTMgMiAyNCBDMS4wMSAyNCAwLjAyIDI0IC0xIDI0IEMtMS4yNTgxMzMwMiAyMC4zODYxMzc3NCAtMS4xNjgxNTY2NyAxOC4zMjkzMDY4IDAuNSAxNS4wNjI1IEMyLjczMzE5NzQyIDEwLjUwMzA1NTI2IDIuNjIzNDM0NjEgNi44MzEzMzkxNiAxIDIuMDYyNSBDMC42NyAxLjM4MTg3NSAwLjM0IDAuNzAxMjUgMCAwIFogIiBmaWxsPSIjMTc3MjREIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzUxLDk3KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDAuOTkgMC42NiAxLjk4IDEgMyBDMC41MDUgMy45MDc1IDAuMDEgNC44MTUgLTAuNSA1Ljc1IEMtMi4zNzE1ODI0MSA5LjgwNTA5NTIzIC0yLjA1NTkwNDQyIDExLjcwMDk2MDU3IC0xIDE2IEMtMC4wODA4Mzc4IDE4LjM3NzMwOTU2IDAuOTUxMzM0NzMgMjAuNjc0Njk4NzUgMiAyMyBDMiAyMy42NiAyIDI0LjMyIDIgMjUgQzEuMDEgMjUgMC4wMiAyNSAtMSAyNSBDLTEuODcyNzk4NjIgMjMuMTMzNjAwMTkgLTIuNzIyNTEwMjcgMjEuMjU2MzkzODkgLTMuNTYyNSAxOS4zNzUgQy00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC00LjI3NTk5NjA5IDE3LjgwODc4OTA2IC01LjAwMzkwNjI1IDE2LjIxMDkzNzUgQy02LjEzMjU2NzY4IDEyLjU3MjY2NDE5IC02LjAzOTIzNjQyIDEwLjYzNzMyNzQ1IC01IDcgQy0zLjU1NDMxMTQ1IDQuNDMwOTQwMzUgLTEuODIzMDY5ODYgMi4zMzcyNjkwNSAwIDAgWiAiIGZpbGw9IiMxMzZGNEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzcsOTQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEM1LjE4NDE5OTU5IDMuNzk2NTQ1NjcgNS4zODczNDU0OCA3LjExNjc2MjIgNS4yMzgyODEyNSAxMS44NjMyODEyNSBDNC45NDYwNDkxMyAxNC40ODM3ODg5NyA0LjA0MjM4MTk1IDE2LjU4OTQ5MTczIDMgMTkgQzIuNzkzNDQ5MzQgMjIuNDQyNTEwOTcgMi45MDYxNjA2OSAyNC43MTg0ODIwOCA0IDI4IEMyLjA2MjUgMjcuNjI1IDIuMDYyNSAyNy42MjUgMCAyNyBDLTEuNDIxNTEzNDUgMjQuMTU2OTczMDkgLTEuMjM5MjI2MDYgMjIuMTY5NzQ1MjggLTEgMTkgQy0wLjUwNSAxNy44NjU2MjUgLTAuMDEgMTYuNzMxMjUgMC41IDE1LjU2MjUgQzIuNTQzNzYwMDggMTAuNzA4NTY5ODEgMi42OTcwMTA1NCA3LjA0NzQ2ODQ1IDEgMi4wNjI1IEMwLjY3IDEuMzgxODc1IDAuMzQgMC43MDEyNSAwIDAgWiAiIGZpbGw9IiNEREVBRTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjksNTkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMiAyIDIgMi4yNSA1LjMxMjUgQzIuMDE4NjM0NTIgOC43MjUxNDA4NCAxLjQ3NjUyODggMTAuOTU0NjU5MzUgMCAxNCBDLTAuNjYgMTMuMzQgLTEuMzIgMTIuNjggLTIgMTIgQy0xLjYyNSA4Ljg3NSAtMS42MjUgOC44NzUgLTEgNiBDLTMuMzEgNi4zMyAtNS42MiA2LjY2IC04IDcgQy04LjA0MjcyMSA1LjMzMzg4MDk1IC04LjA0MDYzODMyIDMuNjY2MTcxMTUgLTggMiBDLTUuOTU0NDc5NTggLTAuMDQ1NTIwNDIgLTIuNzI5NDE5MTQgMC4yMzk0MjI3MyAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTMgMS42NSAxMyAzLjMgMTMgNSBDOC43MSA1IDQuNDIgNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMCAyLjY0IDAgNCAwIEM0IDUuMjggNCAxMC41NiA0IDE2IEMyLjY4IDE2IDEuMzYgMTYgMCAxNiBDMCAxMC43MiAwIDUuNDQgMCAwIFogIiBmaWxsPSIjMDA4NDI5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTY5LDkzKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEyLjY3IDAuOTkgMTIuMzQgMS45OCAxMiAzIEMxMC42OCAzIDkuMzYgMyA4IDMgQzggNS42NCA4IDguMjggOCAxMSBDNy4wMSAxMSA2LjAyIDExIDUgMTEgQzUgOC4zNiA1IDUuNzIgNSAzIEMzLjM1IDIuNjcgMS43IDIuMzQgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc0OSwxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzkpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS42NSAxMiAzLjMgMTIgNSBDOC4wNCA1IDQuMDggNSAwIDUgQzAgMy4zNSAwIDEuNyAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1MTgsNzIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMzIDIuNjQgMyA1LjI4IDMgOCBDNS42NCA4IDguMjggOCAxMSA4IEMxMC42NyA4Ljk5IDEwLjM0IDkuOTggMTAgMTEgQzYuNyAxMSAzLjQgMTEgMCAxMSBDMCA3LjM3IDAgMy43NCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3OTgsMTE2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjEyMTE3MTg4IDAuNjAzMjgxMjUgMC4yNDIzNDM3NSAxLjIwNjU2MjUgMC4zNjcxODc1IDEuODI4MTI1IEMwLjUzNDc2NTYzIDIuNjI3MzQzNzUgMC43MDIzNDM3NSAzLjQyNjU2MjUgMC44NzUgNC4yNSBDMS4wMzc0MjE4OCA1LjAzODkwNjI1IDEuMTk5ODQzNzUgNS44Mjc4MTI1IDEuMzY3MTg3NSA2LjY0MDYyNSBDMS45MTcxMzYxNyA5LjAxNDkwNDM4IDEuOTE3MTM2MTcgOS4wMTQ5MDQzOCAzLjA2MjUgMTEuMDkzNzUgQzQuMzcxMjUzNjQgMTMuNzU0ODgyNCA0LjEzMjY4NDUxIDE2LjA4MDk0MDc2IDQgMTkgQzMuMDEgMTkgMi4wMiAxOSAxIDE5IEMwLjcxMTI1IDE3Ljc4MzEyNSAwLjQyMjUgMTYuNTY2MjUgMC4xMjUgMTUuMzEyNSBDLTAuNDgzNjM3NyAxMi44NDMxNjk5MSAtMS4xMzkxMzY4MSAxMC42Njc2MTc2MyAtMi4xMjUgOC4zMTI1IEMtMy4xMDE2MzIyIDUuNzMxNDAwNjMgLTMuMTU2Mzg1NjggMy43MzY3NDk0NSAtMyAxIEMtMSAwIC0xIDAgMCAwIFogIiBmaWxsPSIjMEU2QzQ3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDEwMikiLz4KPHBhdGggZD0iTTAgMCBDNC45NSAwIDkuOSAwIDE1IDAgQzE0LjM0IDEuMzIgMTMuNjggMi42NCAxMyA0IEM5LjA0IDQgNS4wOCA0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTEsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjI1NDM5MjIgMC41MTc5MTk4OSA3LjI1MDczNjc2IDEuMDM2Mzk3MjcgMTAuODc1IDEuNTYyNSBDMTIuOTMwODIyNzEgMS44NzcxMDUwMiAxMi45MzA4MjI3MSAxLjg3NzEwNTAyIDE1IDIgQzE1IDMuNjUgMTUgNS4zIDE1IDcgQzkuNTQ1MjA4MTUgNi40MzE3OTI1MiA1LjA4OTQwNzQ0IDUuMDUzNjIwNTUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0VFRjRGMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MSw3MykiLz4KPHBhdGggZD0iTTAgMCBDMy42MyAwIDcuMjYgMCAxMSAwIEMxMSAyLjMxIDExIDQuNjIgMTEgNyBDMTAuMzQgNyA5LjY4IDcgOSA3IEM5IDUuNjggOSA0LjM2IDkgMyBDNy4wMiAzIDUuMDQgMyAzIDMgQzIuNjcgNC4zMiAyLjM0IDUuNjQgMiA3IEMxLjM0IDcgMC42OCA3IDAgNyBDMCA0LjY5IDAgMi4zOCAwIDAgWiAiIGZpbGw9IiNFODIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTMsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEM0LjI5IDAgOC41OCAwIDEzIDAgQzEzIDEuMzIgMTMgMi42NCAxMyA0IEM4LjcxIDQgNC40MiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRjcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIuMzMgMS4zMiAxMi42NiAyLjY0IDEzIDQgQzguNzEgNCA0LjQyIDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy40NDQ0NzI5OSAyLjkzNTIwOTUxIDMuNTc3ODc2MSA1LjI1NjU4Mjc0IDMuOTY0ODQzNzUgOS41OTc2NTYyNSBDMy45OTg0NTQwNiAxMS44OTQzNjEgMy43Mzc5MTUwOSAxMy44NzUxMjQzMyAzLjMxMjUgMTYuMTI1IEMyLjkwNDY5NjM3IDIxLjE4MTc2NSA0LjE4MDYwNDkgMjIuODk5MDYxNjcgNyAyNyBDNi4zNCAyNy4zMyA1LjY4IDI3LjY2IDUgMjggQy0wLjA2ODA5Mzg0IDIxLjI0ODM4NzEgLTAuMDY4MDkzODQgMjEuMjQ4Mzg3MSAwLjE4NzUgMTYuNTYyNSBDMC40NTU2MjUgMTUuMzg2ODc1IDAuNzIzNzUgMTQuMjExMjUgMSAxMyBDMS4wODIyOTE3IDExLjQzOTExMjI5IDEuMTIyNDQ1OTkgOS44NzU1NTMzNyAxLjEyNSA4LjMxMjUgQzEuMTI4ODY3MTkgNy4yMjM4ODY3MiAxLjEyODg2NzE5IDcuMjIzODg2NzIgMS4xMzI4MTI1IDYuMTEzMjgxMjUgQzAuOTk3ODA3MzIgMy45NjUxMTA1OSAwLjU4NzcyOTQgMi4wNjYzODE5NSAwIDAgWiAiIGZpbGw9IiNEMEUyREIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMjkgMCA4LjU4IDAgMTMgMCBDMTIuNjcgMS4zMiAxMi4zNCAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU3Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0xLjU3OTY3ODA3IDMuNjc1MjgyMjMgLTMuMTYzOTE5MDMgNC4zMzk4OTY5NCAtNC43NSA1IEMtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNi4wNzI1NzgxMyA1LjU1Njg3NSAtNy40MjE4NzUgNi4xMjUgQy0xMCA3IC0xMCA3IC0xNCA3IEMtMTQgNS42OCAtMTQgNC4zNiAtMTQgMyBDLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgLTQuNTg5OTc3MjIgLTAuNDQ0MTkxMzQgMCAwIFogIiBmaWxsPSIjRUZGNUYzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzMxLDczKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OTUsODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU0OSw4NykiLz4KPHBhdGggZD0iTTAgMCBDMy45NiAwIDcuOTIgMCAxMiAwIEMxMiAxLjMyIDEyIDIuNjQgMTIgNCBDOC4wNCA0IDQuMDggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjMUU3MEMwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTE4LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzEyIDEuMzIgMTIgMi42NCAxMiA0IEM4LjA0IDQgNC4wOCA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1NDksNjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTIgMS4zMiAxMiAyLjY0IDEyIDQgQzguMDQgNCA0LjA4IDQgMCA0IEMwIDIuNjggMCAxLjM2IDAgMCBaICIgZmlsbD0iIzFFNzBDMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUxOCw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMy4zNzQ2MjcxNSAwLjU0NzIzNjgzIDUuMDgyMzUgMS4wNTQ5IDggMyBDNy4zNCA0Ljk4IDYuNjggNi45NiA2IDkgQzQgOCAyIDcgMCA2IEMwIDQuMDIgMCAyLjA0IDAgMCBaICIgZmlsbD0iIzFENzY1MiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5Myw5MykiLz4KPHBhdGggZD0iTTAgMCBDMCAzIDAgMyAtMSA1IEMtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAtMS4yMTM3NzcyMSAxMC42MDcwMzIxMyAwIDE2IEMwLjEyNzgxNzg2IDE4LjY3Mzk0OTY0IDAuMDQzOTE4NzEgMjEuMzIwOTU4NTcgMCAyNCBDLTAuNjYgMjQgLTEuMzIgMjQgLTIgMjQgQy0zLjcyNzI5MzA0IDE3LjI5MDY3OTkxIC00Ljc4MjM1NDYyIDEwLjgxODQwMzYgLTMgNCBDLTEuNDQ5MjE4NzUgMS43MTA5Mzc1IC0xLjQ0OTIxODc1IDEuNzEwOTM3NSAwIDAgWiAiIGZpbGw9IiNEOUU4RTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjApIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuMzMgMCAwLjY2IDAgMSAwIEMxIDEuNjUgMSAzLjMgMSA1IEMxLjg4Njg3NSA0LjY5MDYyNSAyLjc3Mzc1IDQuMzgxMjUgMy42ODc1IDQuMDYyNSBDOS4xNjA2NzE0NiAyLjMwNjk1NDQ0IDkuMTYwNjcxNDYgMi4zMDY5NTQ0NCAxMiAyIEMxMi45OSAyLjY2IDEzLjk4IDMuMzIgMTUgNCBDMTQuNjcgNC42NiAxNC4zNCA1LjMyIDE0IDYgQzExLjY4MDI1NzY2IDYuNDE3NTUzNjIgOS4zNDIxNDIwNyA2LjczNTU2NDYgNyA3IEM1LjA1MDkzNzUgNy4yNzg0Mzc1IDUuMDUwOTM3NSA3LjI3ODQzNzUgMy4wNjI1IDcuNTYyNSBDMi4wNTE4NzUgNy43MDY4NzUgMS4wNDEyNSA3Ljg1MTI1IDAgOCBDMCA1LjM2IDAgMi43MiAwIDAgWiAiIGZpbGw9IiMxODcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMTcsNjgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMzMzMzMzMzMgMCA2LjY2NjY2NjY3IDAgMTAgMCBDMTAgMS45OCAxMCAzLjk2IDEwIDYgQzcuMzYgNiA0LjcyIDYgMiA2IEMyIDQuNjggMiAzLjM2IDIgMiBDMS4zNCAyIDAuNjggMiAwIDIgQzAgMS4zNCAwIDAuNjggMCAwIFogIiBmaWxsPSIjMDA2NDNDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzg1LDExNykiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS42NSA4LjM0IDMuMyA4IDUgQzUuNjkgNSAzLjM4IDUgMSA1IEMwLjY3IDMuMzUgMC4zNCAxLjcgMCAwIFogIiBmaWxsPSIjMUU3MEMxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjE0LDk0KSIvPgo8cGF0aCBkPSJNMCAwIEMwIDAuOTkgMCAxLjk4IDAgMyBDLTMuNjMgNC4zMiAtNy4yNiA1LjY0IC0xMSA3IEMtMTEuMzMgNS42OCAtMTEuNjYgNC4zNiAtMTIgMyBDLTEwLjc1MzM2NjY5IDIuNDkxNjY0MDkgLTkuNTAyNTA2MTMgMS45OTM2ODg1NSAtOC4yNSAxLjUgQy03LjU1MzkwNjI1IDEuMjIxNTYyNSAtNi44NTc4MTI1IDAuOTQzMTI1IC02LjE0MDYyNSAwLjY1NjI1IEMtNCAwIC00IDAgMCAwIFogIiBmaWxsPSIjRUZGNUYyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzI5LDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjA3MDc3Mzc1IDMuMjEyMzIxMjUgMSA1LjYzOTM3ODA3IDEgOSBDMS4zMyA5Ljk5IDEuNjYgMTAuOTggMiAxMiBDMS4wMSAxMiAwLjAyIDEyIC0xIDEyIEMtMS4zMyAxMC4zNSAtMS42NiA4LjcgLTIgNyBDLTMuOTggNyAtNS45NiA3IC04IDcgQy03LjIzNjg3NSA2LjQwMTg3NSAtNi40NzM3NSA1LjgwMzc1IC01LjY4NzUgNS4xODc1IEMtMy42NTE2NDI1IDMuNTMwNDA2NjggLTEuODAyMTcyMSAxLjg5NzAyMzI2IDAgMCBaICIgZmlsbD0iIzBENkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM2OCw3NSkiLz4KPHBhdGggZD0iTTAgMCBDMS4yMDE1NzEzMSAzLjYwNDcxMzkzIDEuNTQ5ODEzNDggNy4xMTUwMzA4OCAxLjg3NSAxMC44NzUgQzEuOTYwMDc4MTMgMTEuNTgyNjk1MzEgMi4wNDUxNTYyNSAxMi4yOTAzOTA2MyAyLjEzMjgxMjUgMTMuMDE5NTMxMjUgQzIuNDc2OTI2MjggMTcuMjE5MjgzNTEgMi4yMzk3Mzc5MiAxOC43MTA2NjExMyAtMC40OTIxODc1IDIyLjAwNzgxMjUgQy0xLjMxOTc2NTYyIDIyLjY2NTIzNDM3IC0yLjE0NzM0Mzc1IDIzLjMyMjY1NjI1IC0zIDI0IEMtMi4xMjUgMjAuMTI1IC0yLjEyNSAyMC4xMjUgLTEgMTkgQy0wLjkzOTY4OTYzIDE1LjM4NTE0NzQyIC0wLjk4MDA1NDkzIDExLjc4NDEzNTc2IC0xLjAzOTA2MjUgOC4xNjk5MjE4OCBDLTEuMTAwMTMzMTUgMi4yMDAyNjYyOSAtMS4xMDAxMzMxNSAyLjIwMDI2NjI5IDAgMCBaICIgZmlsbD0iI0RERUFFNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0Miw2NSkiLz4KPHBhdGggZD0iTTAgMCBDMSAyIDEgMiAwLjkzNzUgNS42ODc1IEMwLjg2OTQ3NzA3IDkuODIxNzgyMyAxLjY5NjU0Mzg5IDEzLjA4OTYzMTY4IDMgMTcgQzIuMzQgMTcgMS42OCAxNyAxIDE3IEMwLjY3IDE4LjMyIDAuMzQgMTkuNjQgMCAyMSBDLTEuMzk3NzM2NjEgMTQuOTA5ODYxOSAtMi40MzkxOTg3NCA5LjI1ODU4MjExIC0yIDMgQy0xLjM0IDIuMDEgLTAuNjggMS4wMiAwIDAgWiAiIGZpbGw9IiMyMTc4NTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNDgsNjIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzQuMTk0Njk1NzEgMC41OTkyNDIyNCA4LjAwOTk5ODM0IDEuNTc0OTk5NDEgMTIgMyBDMTIgMy45OSAxMiA0Ljk4IDEyIDYgQzcuNjgyMjU0MiA1LjQ5MjAyOTkxIDMuOTY2OTc4ODYgNC44MDMxNzIyMSAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjRTdGMEVDIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzkzLDgwKSIvPgo8cGF0aCBkPSJNMCAwIEMxLjY3NTQyOTc2IDAuMjg2MDQ4OTggMy4zNDM4NTM0MyAwLjYxNzgxMjMzIDUgMSBDNS44NDY4MTEzMyA2LjA4MDg2Nzk2IDYuMDkwMzgwOTkgMTAuODQ4MjgzNzcgNiAxNiBDNS4zNCAxNiA0LjY4IDE2IDQgMTYgQzMuOTUxMDE1NjMgMTUuNDA4MzIwMzEgMy45MDIwMzEyNSAxNC44MTY2NDA2MyAzLjg1MTU2MjUgMTQuMjA3MDMxMjUgQzMuMjYxOTU4IDcuODg5NzQ5MDkgMy4yNjE5NTggNy44ODk3NDkwOSAxIDIgQzAuMzQgMS42NyAtMC4zMiAxLjM0IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiMxNzcyNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzAsNTcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjA4ODEzMSAwLjgzNTA2MTE3IDMuNjA4ODEzMSAwLjgzNTA2MTE3IDUuODEyNSAtMC41IEM1LjgxMjUgMS4xNSA1LjgxMjUgMi44IDUuODEyNSA0LjUgQzMuNDc5MTY2NjcgNC4xNjY2NjY2NyAxLjE0NTgzMzMzIDMuODMzMzMzMzMgLTEuMTg3NSAzLjUgQy0yLjQ2NjI1IDMuMzU1NjI1IC0zLjc0NSAzLjIxMTI1IC01LjA2MjUgMy4wNjI1IEMtNi4wOTM3NSAyLjg3Njg3NSAtNy4xMjUgMi42OTEyNSAtOC4xODc1IDIuNSBDLTguNTE3NSAxLjg0IC04Ljg0NzUgMS4xOCAtOS4xODc1IDAuNSBDLTUuOTIyMjU5MDcgLTAuNDE4MzQ5MDEgLTMuMzE1NTMyMDkgLTAuNDc3MDk4NDIgMCAwIFogIiBmaWxsPSIjMUI3NDUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk5LjE4NzUsNzEuNSkiLz4KPHBhdGggZD0iTTAgMCBDMi45NyAwIDUuOTQgMCA5IDAgQzguNjcgMS4zMiA4LjM0IDIuNjQgOCA0IEM1LjAzIDQgMi4wNiA0IC0xIDQgQy0wLjY3IDIuNjggLTAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiNEQ0VERTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIwNDAsOTIpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuOTYgMCA3LjkyIDAgMTIgMCBDMTEuNjcgMC45OSAxMS4zNCAxLjk4IDExIDMgQzcuNyAzIDQuNCAzIDEgMyBDMC42NyAyLjAxIDAuMzQgMS4wMiAwIDAgWiAiIGZpbGw9IiNFNzIwMjYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3NjYsMTIwKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjY3IDAuOTkgMTEuMzQgMS45OCAxMSAzIEM3LjcgMyA0LjQgMyAxIDMgQzAuNjcgMi4wMSAwLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRTkyMDI2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzY2LDExNikiLz4KPHBhdGggZD0iTTAgMCBDOS40MTAwMjI3OCAtMC4zNjkwMjA1IDkuNDEwMDIyNzggLTAuMzY5MDIwNSAxNCAyIEMxNCAzLjY1IDE0IDUuMyAxNCA3IEMxMy41MDUgNi41MjU2MjUgMTMuMDEgNi4wNTEyNSAxMi41IDUuNTYyNSBDOS45MzI3MzUyOSAzLjk1Nzk1OTU1IDguODAwMzY5MDkgMy43NDk5ODYwOSA1Ljg3NSAzLjUgQzQuNTk2MjUgMy4zMzUgMy4zMTc1IDMuMTcgMiAzIEMxLjM0IDIuMDEgMC42OCAxLjAyIDAgMCBaICIgZmlsbD0iIzNEODk2QiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1Niw1NSkiLz4KPHBhdGggZD0iTTAgMCBDMC4yODQ4ODI4MSAwLjU3NDkyMTg4IDAuNTY5NzY1NjIgMS4xNDk4NDM3NSAwLjg2MzI4MTI1IDEuNzQyMTg3NSBDMS41OTM5MzI5NyAzLjE5MzQ0NzYyIDIuMzQwMTUwNTEgNC42MzcwMzEgMy4xMDU0Njg3NSA2LjA3MDMxMjUgQzMuNDYyNTM5MDYgNi43NDgzNTkzOCAzLjgxOTYwOTM4IDcuNDI2NDA2MjUgNC4xODc1IDguMTI1IEM0LjU1MjMwNDY5IDguODA4MjAzMTMgNC45MTcxMDkzOCA5LjQ5MTQwNjI1IDUuMjkyOTY4NzUgMTAuMTk1MzEyNSBDNS41MjYyODkwNiAxMC43OTA4NTkzNyA1Ljc1OTYwOTM4IDExLjM4NjQwNjI1IDYgMTIgQzUuNjcgMTIuNjYgNS4zNCAxMy4zMiA1IDE0IEM0LjM0IDE0IDMuNjggMTQgMyAxNCBDLTEuMDc4Nzc0NjIgNS45NjQ5ODkwNiAtMS4wNzg3NzQ2MiA1Ljk2NDk4OTA2IC0wLjc1IDEuOTM3NSBDLTAuNTAyNSAxLjI5ODEyNSAtMC4yNTUgMC42NTg3NSAwIDAgWiAiIGZpbGw9IiMwQzZCNDUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzgsMTAzKSIvPgo8cGF0aCBkPSJNMCAwIEMzLjk2IDAgNy45MiAwIDEyIDAgQzExLjAxIDEuNDg1IDExLjAxIDEuNDg1IDEwIDMgQzguMTI1IDMuMzI4MTI1IDguMTI1IDMuMzI4MTI1IDYgMy4yNSBDNS4yOTg3NSAzLjIzNDUzMTI1IDQuNTk3NSAzLjIxOTA2MjUgMy44NzUgMy4yMDMxMjUgQzIgMyAyIDMgMCAyIEMwIDEuMzQgMCAwLjY4IDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc2NiwxMjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuNjMgMCA3LjI2IDAgMTEgMCBDMTAuNjcgMC45OSAxMC4zNCAxLjk4IDEwIDMgQzcuMDMgMyA0LjA2IDMgMSAzIEMwLjY3IDIuMDEgMC4zNCAxLjAyIDAgMCBaICIgZmlsbD0iI0U4MjAyNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgxMywxMTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNDk1IDAuMzkxODc1IDAuOTkgMC43ODM3NSAxLjUgMS4xODc1IEMwLjE2NjY2NjY3IDEuODU0MTY2NjcgLTEuMTY2NjY2NjcgMi41MjA4MzMzMyAtMi41IDMuMTg3NSBDLTMuNDkgMy43NDQzNzUgLTMuNDkgMy43NDQzNzUgLTQuNSA0LjMxMjUgQy02LjUgNS4xODc1IC02LjUgNS4xODc1IC0xMC41IDUuMTg3NSBDLTEwLjUgNC4xOTc1IC0xMC41IDMuMjA3NSAtMTAuNSAyLjE4NzUgQy0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIC0zLjI4Nzc0NjE3IC0xLjA2ODUxNzUxIDAgMCBaICIgZmlsbD0iIzEyNkY0QSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNy41LDc3LjgxMjUpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuNjQgMCA1LjI4IDAgOCAwIEM3LjY3IDEuMzIgNy4zNCAyLjY0IDcgNCBDNC42OSA0IDIuMzggNCAwIDQgQzAgMi42OCAwIDEuMzYgMCAwIFogIiBmaWxsPSIjRDdFQkRFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDA5LDk2KSIvPgo8cGF0aCBkPSJNMCAwIEMzLjU1NzgwMTk2IDAuNjA5OTA4OTEgNi42ODI4NTg5IDEuNTc4MzY4MSAxMCAzIEM5LjY3IDMuOTkgOS4zNCA0Ljk4IDkgNiBDNS44NTI2MjgxOCA1LjMwMDU4NDA0IDIuOTc0MTExMjQgNC4yMzkyMTMwMiAwIDMgQzAgMi4wMSAwIDEuMDIgMCAwIFogIiBmaWxsPSIjREZFQkU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzk0LDg3KSIvPgo8cGF0aCBkPSJNMCAwIEMtMSAzIC0xIDMgLTIuODQ3NjU2MjUgNC4xNjc5Njg3NSBDLTMuNTc4NTU0NjkgNC41MDQ0MTQwNiAtNC4zMDk0NTMxMiA0Ljg0MDg1OTM3IC01LjA2MjUgNS4xODc1IEMtNS43OTU5NzY1NiA1LjUzMTY3OTY5IC02LjUyOTQ1MzEyIDUuODc1ODU5MzggLTcuMjg1MTU2MjUgNi4yMzA0Njg3NSBDLTguMTM0MDAzOTEgNi42MTEzODY3MiAtOC4xMzQwMDM5MSA2LjYxMTM4NjcyIC05IDcgQy05LjMzIDUuNjggLTkuNjYgNC4zNiAtMTAgMyBDLTYuMjcwMzQ4NjEgMC45NjU2NDQ2OSAtNC4zMzA5NDk1OCAwIDAgMCBaICIgZmlsbD0iI0U4RjFFRCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOCw4NykiLz4KPHBhdGggZD0iTTAgMCBDMi4zOTI3MzIzNSAzLjU4OTA5ODUzIDMuMTUzMTA5ODYgNS4yNjMxMzQ3OCAzLjE4NzUgOS41IEMzLjIwMTY3OTY5IDEwLjI5NDA2MjUgMy4yMTU4NTkzOCAxMS4wODgxMjUgMy4yMzA0Njg3NSAxMS45MDYyNSBDMyAxNCAzIDE0IDEgMTYgQy0wLjE1NzAzOTggMTIuNTI4ODgwNTkgLTAuMDMzOTY0ODkgOS43NzM2ODM0NiAwLjA2MjUgNi4xNTYyNSBDMC4wOTg0MjE3OSAzLjgxNDI1MTIzIDAuMDk4NDIxNzkgMy44MTQyNTEyMyAtMSAxIEMtMC42NyAwLjY3IC0wLjM0IDAuMzQgMCAwIFogIiBmaWxsPSIjMjI3OTU2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc3LDYyKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjY2IDAuMzMgMS4zMiAwLjY2IDIgMSBDMS4zNCAzLjk3IDAuNjggNi45NCAwIDEwIEMtMC45OSA5LjY3IC0xLjk4IDkuMzQgLTMgOSBDLTIuNDQyNzEwODcgNS42NTYyNjUyNSAtMS42NDgyNjExMSAyLjk2Njg3MDAxIDAgMCBaICIgZmlsbD0iI0RDRUFFNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM0NCwxMDgpIi8+CjxwYXRoIGQ9Ik0wIDAgQzMuMjcyODY2ODIgMi43ODE5MzY4IDQuOTY0Mjc2OTcgNi4yNzk1NDA2NyA3IDEwIEM2LjAxIDEwLjMzIDUuMDIgMTAuNjYgNCAxMSBDMy4zMjU5MTY5MiA5LjczMzA4NDkzIDIuNjYwOTk1MDMgOC40NjEyOTI1MSAyIDcuMTg3NSBDMS42Mjg3NSA2LjQ3OTgwNDY5IDEuMjU3NSA1Ljc3MjEwOTM3IDAuODc1IDUuMDQyOTY4NzUgQzAgMyAwIDMgMCAwIFogIiBmaWxsPSIjRDVFNURGIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzc5LDEwNCkiLz4KPHBhdGggZD0iTTAgMCBDMi42NCAwIDUuMjggMCA4IDAgQzcuMzQgMS4zMiA2LjY4IDIuNjQgNiA0IEMzLjAzIDMuNTA1IDMuMDMgMy41MDUgMCAzIEMwIDIuMDEgMCAxLjAyIDAgMCBaICIgZmlsbD0iI0ZDRkRGQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjAzOCw5OSkiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0zLjQ2NSA0LjQ4NSAtMy40NjUgNC40ODUgLTcgNiBDLTcuMzMgNS4wMSAtNy42NiA0LjAyIC04IDMgQy0zLjM3NSAwIC0zLjM3NSAwIDAgMCBaICIgZmlsbD0iI0Q2RTZERiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyOSw5MykiLz4KPHBhdGggZD0iTTAgMCBDLTAuNzUgNy43NSAtMC43NSA3Ljc1IC0zIDEwIEMtNC40NzgzMjI2IDcuMDQzMzU0ODEgLTQuMDYwMzI3ODMgNC4yNTc3MDI2MyAtNCAxIEMtMiAwIC0yIDAgMCAwIFogIiBmaWxsPSIjMkM3RTVEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzcyLDY2KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjkzMDQ1OTMzIDIuNTUxNDQ4MjQgMS4wODU2NDA5MSAzLjc0MDA2NDc4IDAuMjIyNjU2MjUgNi4zNTkzNzUgQy0wLjE2MDE5NTMxIDcuMTQ4MjgxMjUgLTAuNTQzMDQ2ODggNy45MzcxODc1IC0wLjkzNzUgOC43NSBDLTEuNTA3OTEwMTYgOS45NDg4MjgxMyAtMS41MDc5MTAxNiA5Ljk0ODgyODEzIC0yLjA4OTg0Mzc1IDExLjE3MTg3NSBDLTIuMzkwMTk1MzEgMTEuNzc1MTU2MjUgLTIuNjkwNTQ2ODggMTIuMzc4NDM3NSAtMyAxMyBDLTMuNjYgMTIuNjcgLTQuMzIgMTIuMzQgLTUgMTIgQy00LjQ2MjMxMTI4IDguMTI4NjQxMiAtMy40MjI1MjcgNi4wMjgxNTg3NSAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRENFOUU0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzQyLDEwMykiLz4KPHBhdGggZD0iTTAgMCBDMC45OSAwLjMzIDEuOTggMC42NiAzIDEgQzIuNTQ2MjUgMS43NDI1IDIuMDkyNSAyLjQ4NSAxLjYyNSAzLjI1IEMwLjMxMzU5MjA0IDUuNDY5MzA1NzggLTAuODgyODA4MDMgNy42Nzk2NzgyMiAtMiAxMCBDLTMuMDYzNTE2NzUgNi42MTYwODMwNyAtMy4yMTQ0Mjk4MiA1LjQxOTUzNjYgLTEuNTYyNSAyLjE4NzUgQy0xLjA0Njg3NSAxLjQ2NTYyNSAtMC41MzEyNSAwLjc0Mzc1IDAgMCBaICIgZmlsbD0iI0RCRTlFMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3OCw5NikiLz4KPHBhdGggZD0iTTAgMCBDMCAwLjk5IDAgMS45OCAwIDMgQy0yLjUgNC42ODc1IC0yLjUgNC42ODc1IC01IDYgQy01LjY2IDUuMDEgLTYuMzIgNC4wMiAtNyAzIEMtMy4zNzUgMCAtMy4zNzUgMCAwIDAgWiAiIGZpbGw9IiMwRDZDNDYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjksOTYpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuNjYgMCAxLjMyIDAgMiAwIEMyIDAuNjYgMiAxLjMyIDIgMiBDMy4zMiAyIDQuNjQgMiA2IDIgQzYgMi42NiA2IDMuMzIgNiA0IEM0LjY4IDQgMy4zNiA0IDIgNCBDMS42NyA1LjMyIDEuMzQgNi42NCAxIDggQy0wLjM1NDM5NjY4IDUuMjkxMjA2NjUgLTAuMDY1MDE0NTEgMi45OTA2NjczMiAwIDAgWiAiIGZpbGw9IiMxOTczNEYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTAsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuMzIgMC42NiAyLjY0IDEuMzIgNCAyIEM0IDIuOTkgNCAzLjk4IDQgNSBDMSA1IDEgNSAtMC42ODc1IDMuNSBDLTEuMTIwNjI1IDMuMDA1IC0xLjU1Mzc1IDIuNTEgLTIgMiBDLTEuMzQgMS4zNCAtMC42OCAwLjY4IDAgMCBaICIgZmlsbD0iIzE1NzI0QyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM5MiwxMDEpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMC4zMyAxLjk4IDAuNjYgMyAxIEMyLjM0IDMuOTcgMS42OCA2Ljk0IDEgMTAgQzAuMDEgOS4wMSAtMC45OCA4LjAyIC0yIDcgQy0xLjM0IDQuNjkgLTAuNjggMi4zOCAwIDAgWiAiIGZpbGw9IiMyOTdENUIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNzMsNzMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzIgMC42NjY2NjY2NyA0IDEuMzMzMzMzMzMgNiAyIEM1LjY3IDIuNjYgNS4zNCAzLjMyIDUgNCBDMi4zNTEzOTU3MyA0LjU5MzU1NjE0IC0wLjI5MTk3MzIyIDQuNzQyMDkyNjkgLTMgNSBDLTIuNjI1IDMuMDYyNSAtMi42MjUgMy4wNjI1IC0yIDEgQy0xLjM0IDAuNjcgLTAuNjggMC4zNCAwIDAgWiAiIGZpbGw9IiMzMzgzNjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjYsNzApIi8+CjxwYXRoIGQ9Ik0wIDAgQzIuMzEgMCA0LjYyIDAgNyAwIEM3IDEuMzIgNyAyLjY0IDcgNCBDNS42OCA0IDQuMzYgNCAzIDQgQzMgMy4zNCAzIDIuNjggMyAyIEMyLjAxIDIgMS4wMiAyIDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiM2N0EyOEEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNTMsNjQpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjY4NzUgMS44NzUgMi42ODc1IDEuODc1IDIgNCBDMS4wMSA0LjY2IDAuMDIgNS4zMiAtMSA2IEMtMS42MjUgNC4xMjUgLTEuNjI1IDQuMTI1IC0yIDIgQy0xLjM0IDEuMzQgLTAuNjggMC42OCAwIDAgWiAiIGZpbGw9IiMxNDcwNEIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMjgsMTAxKSIvPgo8cGF0aCBkPSJNMCAwIEM0Ljc1IDEuODc1IDQuNzUgMS44NzUgNyAzIEM2LjY3IDMuOTkgNi4zNCA0Ljk4IDYgNiBDMy45NjE2NjU3NiA0LjcyNjA0MTEgMS45NjE0Nzg3NCAzLjM4OTM4MDc3IDAgMiBDMCAxLjM0IDAgMC42OCAwIDAgWiAiIGZpbGw9IiNFOEYxRUUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzOTQsOTMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTggMCAzLjk2IDAgNiAwIEM2IDAuOTkgNiAxLjk4IDYgMyBDMy42OSAzIDEuMzggMyAtMSAzIEMtMC42NyAyLjAxIC0wLjM0IDEuMDIgMCAwIFogIiBmaWxsPSIjRjhGQkY5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMDEyLDkwKSIvPgo8cGF0aCBkPSJNMCAwIEMwLjMzIDEuMzIgMC42NiAyLjY0IDEgNCBDMS42NiA0IDIuMzIgNCAzIDQgQzMuNjYgNS42NSA0LjMyIDcuMyA1IDkgQzMuMDYyNSA4LjYyNSAzLjA2MjUgOC42MjUgMSA4IEMtMC4zNTQzOTY2OCA1LjI5MTIwNjY1IC0wLjA2NTAxNDUxIDIuOTkwNjY3MzIgMCAwIFogIiBmaWxsPSIjRDRFNERFIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzY4LDc4KSIvPgo8cGF0aCBkPSJNMCAwIEMwLjk5IDAuMzMgMS45OCAwLjY2IDMgMSBDMi4zNCAzLjMxIDEuNjggNS42MiAxIDggQzAuMzQgOCAtMC4zMiA4IC0xIDggQy0xLjEyNSAyLjI1IC0xLjEyNSAyLjI1IDAgMCBaICIgZmlsbD0iI0VGRjVGMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM3MCw3NCkiLz4KPHBhdGggZD0iTTAgMCBDMi4wMDcyMDkyMyAwLjI4Njc0NDE4IDQuMDA4NTk0NCAwLjYxODY2NzAxIDYgMSBDNiAxLjY2IDYgMi4zMiA2IDMgQzQuMzUgMyAyLjcgMyAxIDMgQzEgMy45OSAxIDQuOTggMSA2IEMwLjM0IDYgLTAuMzIgNiAtMSA2IEMtMS4wNDI3MjEgNC4zMzM4ODA5NSAtMS4wNDA2MzgzMiAyLjY2NjE3MTE1IC0xIDEgQy0wLjY3IDAuNjcgLTAuMzQgMC4zNCAwIDAgWiAiIGZpbGw9IiM3MkE5OTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzNjMsNjMpIi8+CjxwYXRoIGQ9Ik0wIDAgQzEuOTM3NSAwLjY4NzUgMS45Mzc1IDAuNjg3NSA0IDIgQzQuNzUgNC42MjUgNC43NSA0LjYyNSA1IDcgQzQuMzQgNyAzLjY4IDcgMyA3IEMwIDIuNjE1Mzg0NjIgMCAyLjYxNTM4NDYyIDAgMCBaICIgZmlsbD0iIzBDNkI0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTM1MSw5NykiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzQgMC45OSA0IDEuOTggNCAzIEMyLjAyIDMuNjYgMC4wNCA0LjMyIC0yIDUgQy0xLjM0IDMuMzUgLTAuNjggMS43IDAgMCBaICIgZmlsbD0iI0U2RjBFQyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTMyNSw4MCkiLz4KPHBhdGggZD0iTTAgMCBDMS4zMiAwIDIuNjQgMCA0IDAgQzMuNjcgMS4zMiAzLjM0IDIuNjQgMyA0IEMyLjAxIDQgMS4wMiA0IDAgNCBDMCAyLjY4IDAgMS4zNiAwIDAgWiAiIGZpbGw9IiMwMDg0MjgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNjksODcpIi8+CjxwYXRoIGQ9Ik0wIDAgQzAuOTkgMCAxLjk4IDAgMyAwIEMyLjM0IDEuMzIgMS42OCAyLjY0IDEgNCBDMC42NyAyLjY4IDAuMzQgMS4zNiAwIDAgWiAiIGZpbGw9IiMxRTcwQzEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MTcsMTAyKSIvPgo8L3N2Zz4K" style="
            width: 742.5px;
            position: relative;
            top: 107px;
            left: 32px;
            ">
            <a href=`+Mw+` style="
        float: left;
        border-radius: 56px;
        background: #0D6EFD;
        padding-top: 8px;
        width: 280px;
        height: 38px;
        text-align: center;
        position: relative;
        top: 127px;
        left: 274px;
        font-size: 16px;
        color: white;
        text-decoration: none;
        letter-spacing: 0.02em;
    ">Claim your FREE account</a>
            <div style="
    font-size: 14px;
    position: relative;
    top: 180px;
    left: 19px;
    letter-spacing: 0.02em;
    font-weight: 500;
    line-height: 125%;
">have a Syncfusion<sup>\xAE</sup> account? <a href="https://www.syncfusion.com/account/login?ReturnUrl=/account/login" style="text-decoration: none;
color: #0D6EFD;
font-weight: 500;">Sign In</a></div>
        </div>
    </div>`;if(typeof document<"u"&&!g(document)){var t=et("div",{innerHTML:o});document.body.appendChild(t)}},m4=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),im=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Dw=0,bw,bL=0,Sw=0,SL=!0,CL=!1,Cw=!1;var ti=(function(o){m4(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.randomId=CV(),r.isStringTemplate=!1,r.needsID=!1,r.isReactHybrid=!1,r.isAngular=!1,r.isReact=!1,r.isVue=!1,g(r.enableRtl)&&r.setProperties({enableRtl:l4},!0),g(r.locale)&&r.setProperties({locale:Yp},!0),r.moduleLoader=new GV(r),r.localObserver=new Lu(r),ku.on("notifyExternalChange",r.detectFunction,r,r.randomId),typeof window<"u"&&typeof document<"u"&&!g4(r.getModuleName())&&h4.indexOf(r.getModuleName())!==-1&&(Sw=Sw+1,Sw>5&&(SL=!1)),Te(i)||r.appendTo(),r}return t.prototype.requiredModules=function(){return[]},t.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&(this.setPersistData(),this.detachUnloadEvent()),this.localObserver.destroy(),!this.refreshing&&(Z([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),o.prototype.destroy.call(this),this.moduleLoader.clean(),ku.off("notifyExternalChange",this.detectFunction,this.randomId)))},t.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.enablePersistence&&this.attachUnloadEvent(),this.localObserver=new Lu(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},t.prototype.accessMount=function(){this.mount&&!this.isReactHybrid&&this.mount()},t.prototype.getRootElement=function(){return this.isReactHybrid?this.actualElement:this.element},t.prototype.getLocalData=function(){var e=this.getModuleName()+this.element.id;return Cw?window.localStorage.getItem(e+this.ej2StatePersistenceVersion):window.localStorage.getItem(e)},t.prototype.attachUnloadEvent=function(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("pagehide",this.handleUnload)},t.prototype.handleUnload=function(){this.setPersistData()},t.prototype.detachUnloadEvent=function(){window.removeEventListener("pagehide",this.handleUnload)},t.prototype.appendTo=function(e){if(!g(e)&&typeof e=="string"?this.element=J(e,document):g(e)||(this.element=e),!g(this.element)){var i="e-"+this.getModuleName().toLowerCase();X([this.element],["e-control",i]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),this.attachUnloadEvent());var r=V("ej2_instances",this.element);(!r||r.indexOf(this)===-1)&&o.prototype.addInstance.call(this),this.preRender(),this.injectModules();var n={schedule:"all",diagram:"all",PdfViewer:"all",grid:["logger"],richtexteditor:["link","table","image","audio","video","formatPainter","emojiPicker","pasteCleanup","htmlEditor","toolbar","importExport","codeBlock"],treegrid:["filter"],gantt:["tooltip"],chart:["Export","Zoom"],accumulationchart:["Export"],"query-builder":"all"},s=this.getModuleName();if(this.requiredModules&&(!n[""+s]||n[""+s]!=="all"))for(var a=this.requiredModules(),l=0,h=this.moduleLoader.getNonInjectedModules(a);l<h.length;l++){var c=h[l],u=c.name?c.name:c.member;if(!(n[""+s]&&n[""+s].indexOf(c.member)!==-1)){var d=s.charAt(0).toUpperCase()+s.slice(1);console.warn('[WARNING] :: Module "'+u+'" is not available in '+d+" component! You either misspelled the module name or forgot to load it.")}}!SL&&!CL&&(v4(),CL=!0),this.render(),this.mount?this.accessMount():this.trigger("created")}},t.prototype.renderComplete=function(e){if($e()){var i="sfBlazor";window[""+i].renderComplete(this.element,e)}this.isRendered=!0},t.prototype.dataBind=function(){this.injectModules(),o.prototype.dataBind.call(this)},t.prototype.on=function(e,i,r){if(typeof e=="string")this.localObserver.on(e,i,r);else for(var n=0,s=e;n<s.length;n++){var a=s[n];this.localObserver.on(a.event,a.handler,a.context)}},t.prototype.off=function(e,i){if(typeof e=="string")this.localObserver.off(e,i);else for(var r=0,n=e;r<n.length;r++){var s=n[r];this.localObserver.off(s.event,s.handler)}},t.prototype.notify=function(e,i){this.isDestroyed!==!0&&this.localObserver.notify(e,i)},t.prototype.getInjectedModules=function(){return this.injectedModules},t.Inject=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var r=0;r<e.length;r++)this.prototype.injectedModules.indexOf(e[parseInt(r.toString(),10)])===-1&&this.prototype.injectedModules.push(e[parseInt(r.toString(),10)])},t.prototype.createElement=function(e,i,r){return et(e,i)},t.prototype.triggerStateChange=function(e,i){this.isReactHybrid&&(this.setState(),this.currentContext={calls:e,args:i})},t.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},t.prototype.detectFunction=function(e){var i=Object.keys(e);i.length&&(this[i[0]]=e[i[0]])},t.prototype.mergePersistData=function(){var e;Cw?e=window.localStorage.getItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion):e=window.localStorage.getItem(this.getModuleName()+this.element.id),g(e)||e===""||this.setProperties(JSON.parse(e),!0)},t.prototype.setPersistData=function(){this.isDestroyed||(Cw?window.localStorage.setItem(this.getModuleName()+this.element.id+this.ej2StatePersistenceVersion,this.getPersistData()):window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData()))},t.prototype.renderReactTemplates=function(e){g(e)||e()},t.prototype.clearTemplate=function(e,i,r){g(r)||r()},t.prototype.getUniqueID=function(e){return this.isHistoryChanged()&&(Dw=0),bw=this.pageID(location.href),bL=history.length,e+"_"+bw+"_"+Dw++},t.prototype.pageID=function(e){var i=0;if(e.length===0)return i;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);i=(i<<5)-i+n,i=i&i}return Math.abs(i)},t.prototype.isHistoryChanged=function(){return bw!==this.pageID(location.href)||bL!==history.length},t.prototype.addOnPersist=function(e){for(var i=this,r={},n=0,s=e;n<s.length;n++){var a=s[n],l=V(a,this);Te(l)||it(a,this.getActualProperties(l),r)}return JSON.stringify(r,function(h,c){return i.getActualProperties(c)})},t.prototype.getActualProperties=function(e){return e instanceof Oe?V("properties",e):e},t.prototype.ignoreOnPersist=function(e){return JSON.stringify(this.iterateJsonProperties(this.properties,e))},t.prototype.iterateJsonProperties=function(e,i){for(var r={},n=function(c){if(i.indexOf(c)===-1){var u=e[""+c];if(typeof u=="object"&&!(u instanceof Array)){var d=i.filter(function(p){var f=RegExp;return new f(c+".").test(p)}).map(function(p){return p.replace(c+".","")});r[""+c]=s.iterateJsonProperties(s.getActualProperties(u),d)}else r[""+c]=u}},s=this,a=0,l=Object.keys(e);a<l.length;a++){var h=l[a];n(h)}return r},im([w(!1)],t.prototype,"enablePersistence",void 0),im([w()],t.prototype,"enableRtl",void 0),im([w()],t.prototype,"locale",void 0),t=im([It],t),t})(pa);(function(){typeof window<"u"&&window.addEventListener("popstate",function(){Dw=0})})();var WL=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Xi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},y4={left:0,top:0,bottom:0,right:0},ww={isDragged:!1},b4=(function(o){WL(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Xi([w(0)],t.prototype,"left",void 0),Xi([w(0)],t.prototype,"top",void 0),t})(Oe),sh=(function(o){WL(t,o);function t(i,r){var n=o.call(this,r,i)||this;return n.dragLimit=e.getDefaultPosition(),n.borderWidth=e.getDefaultPosition(),n.padding=e.getDefaultPosition(),n.diffX=0,n.prevLeft=0,n.prevTop=0,n.dragProcessStarted=!1,n.eleTop=0,n.tapHoldTimer=0,n.externalInitialize=!1,n.diffY=0,n.parentScrollX=0,n.parentScrollY=0,n.droppables={},n.bind(),n}e=t,t.prototype.bind=function(){this.toggleEvents(),j.isIE&&X([this.element],"e-block-touch"),this.droppables[this.scope]={}},t.getDefaultPosition=function(){return pe({},y4)},t.prototype.toggleEvents=function(i){var r;Te(this.handle)||(r=J(this.handle,this.element));var n=this.enableTapHold&&j.isDevice&&j.isTouch?this.mobileInitialize:this.initialize;i?T.remove(r||this.element,j.isSafari()?"touchstart":j.touchStartEvent,n):T.add(r||this.element,j.isSafari()?"touchstart":j.touchStartEvent,n,this)},t.prototype.mobileInitialize=function(i){var r=this,n=i.currentTarget;this.tapHoldTimer=setTimeout(function(){r.externalInitialize=!0,r.removeTapholdTimer(),r.initialize(i,n)},this.tapHoldThreshold),T.add(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.removeTapholdTimer,this),T.add(document,j.isSafari()?"touchend":j.touchEndEvent,this.removeTapholdTimer,this)},t.prototype.removeTapholdTimer=function(){clearTimeout(this.tapHoldTimer),T.remove(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.removeTapholdTimer),T.remove(document,j.isSafari()?"touchend":j.touchEndEvent,this.removeTapholdTimer)},t.prototype.getScrollableParent=function(i,r){var n={vertical:"scrollHeight",horizontal:"scrollWidth"},s={vertical:"clientHeight",horizontal:"clientWidth"};return g(i)?null:i[n[""+r]]>i[s[""+r]]?(r==="vertical"?i.scrollTop>0:i.scrollLeft>0)?(r==="vertical"?(this.parentScrollY=this.parentScrollY+(this.parentScrollY===0?i.scrollTop:i.scrollTop-this.parentScrollY),this.tempScrollHeight=i.scrollHeight):(this.parentScrollX=this.parentScrollX+(this.parentScrollX===0?i.scrollLeft:i.scrollLeft-this.parentScrollX),this.tempScrollWidth=i.scrollWidth),g(i)?i:this.getScrollableParent(i.parentNode,r)):this.getScrollableParent(i.parentNode,r):this.getScrollableParent(i.parentNode,r)},t.prototype.getScrollableValues=function(){this.parentScrollX=0,this.parentScrollY=0;var i=this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),r=this.getScrollableParent(this.element.parentNode,"vertical"),n=this.getScrollableParent(this.element.parentNode,"horizontal")},t.prototype.initialize=function(i,r){if(this.currentStateTarget=i.target,!this.isDragStarted()){if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=i.currentTarget||r,this.dragProcessStarted=!1,this.abort){var n=this.abort;typeof n=="string"&&(n=[n]);for(var s=0;s<n.length;s++)if(!g(H(i.target,n[parseInt(s.toString(),10)]))){this.isDragStarted()&&this.isDragStarted(!0);return}}this.preventDefault&&!Te(i.changedTouches)&&i.type!=="touchstart"&&i.preventDefault(),this.element.setAttribute("aria-grabbed","true");var a=this.getCoordinates(i);if(this.initialPosition={x:a.pageX,y:a.pageY},!this.clone){var l=this.element.getBoundingClientRect();this.getScrollableValues(),i.clientX===i.pageX&&(this.parentScrollX=0),i.clientY===i.pageY&&(this.parentScrollY=0),this.relativeXPosition=a.pageX-(l.left+this.parentScrollX),this.relativeYPosition=a.pageY-(l.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(i):(T.add(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.intDragStart,this),T.add(document,j.isSafari()?"touchend":j.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),i.type!=="touchstart"&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,T.trigger(document.documentElement,j.isSafari()?"touchstart":j.touchStartEvent,i)}},t.prototype.intDragStart=function(i){this.removeTapholdTimer();var r=!Te(i.changedTouches);if(!(r&&i.changedTouches.length!==1)){var n=this.getCoordinates(i),s,a=getComputedStyle(this.element);this.margin={left:parseInt(a.marginLeft,10),top:parseInt(a.marginTop,10),right:parseInt(a.marginRight,10),bottom:parseInt(a.marginBottom,10)};var l=this.element;if(this.clone&&this.dragTarget){var h=H(i.target,this.dragTarget);g(h)||(l=h)}this.isReplaceDragEle&&(l=this.currentStateCheck(i.target,l)),this.offset=this.calculateParentPosition(l),this.position=this.getMousePosition(i,this.isDragScroll);var c=this.initialPosition.x-n.pageX,u=this.initialPosition.y-n.pageY,d=Math.sqrt(c*c+u*u);if(d>=this.distance||this.externalInitialize){var p=this.getHelperElement(i);if(!p||g(p))return;r&&i.preventDefault();var f=this.helperElement=p;if(this.parentClientRect=this.calculateParentPosition(f.offsetParent),this.dragStart){var v=this.getProperTargetElement(i),m={event:i,element:l,target:v,bindEvents:$e()?this.bindDragEvents.bind(this):null,dragElement:f};this.trigger("dragStart",m)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),s={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();var y=getComputedStyle(l),b=parseFloat(y.marginTop);this.clone&&b!==0&&(s.top+=b),this.eleTop=isNaN(parseFloat(y.top))?0:parseFloat(y.top)-this.offset.top,this.enableScrollHandler&&!this.clone&&(s.top-=this.parentScrollY,s.left-=this.parentScrollX);var S=this.getProcessedPositionValue({top:s.top-this.diffY+"px",left:s.left-this.diffX+"px"});this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(s.top+=this.dragArea.scrollTop),this.dragElePosition={top:s.top,left:s.left},Ze(f,this.getDragPosition({position:"absolute",left:S.left,top:S.top})),T.remove(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.intDragStart),T.remove(document,j.isSafari()?"touchend":j.touchEndEvent,this.intDestroy),$e()||this.bindDragEvents(f)}}},t.prototype.bindDragEvents=function(i){wr(i)?(T.add(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.intDrag,this),T.add(document,j.isSafari()?"touchend":j.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,i)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))},t.prototype.elementInViewport=function(i){for(this.top=i.offsetTop,this.left=i.offsetLeft,this.width=i.offsetWidth,this.height=i.offsetHeight;i.offsetParent;)i=i.offsetParent,this.top+=i.offsetTop,this.left+=i.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},t.prototype.getProcessedPositionValue=function(i){return this.queryPositionInfo?this.queryPositionInfo(i):i},t.prototype.calculateParentPosition=function(i){if(g(i))return{left:0,top:0};var r=i.getBoundingClientRect(),n=getComputedStyle(i);return{left:r.left+window.pageXOffset-parseInt(n.marginLeft,10),top:r.top+window.pageYOffset-parseInt(n.marginTop,10)}},t.prototype.intDrag=function(i){if(!(!Te(i.changedTouches)&&i.changedTouches.length!==1)){this.clone&&i.changedTouches&&j.isDevice&&j.isTouch&&i.preventDefault();var r,n;this.position=this.getMousePosition(i,this.isDragScroll);var s=this.getDocumentWidthHeight("Height");s<this.position.top&&(this.position.top=s);var a=this.getDocumentWidthHeight("Width");if(a<this.position.left&&(this.position.left=a),this.drag){var l=this.getProperTargetElement(i);this.trigger("drag",{event:i,element:this.element,target:l})}var h=this.checkTargetElement(i);if(h.target&&h.instance){var c=!0;this.hoverObject&&(this.hoverObject.instance!==h.instance?this.triggerOutFunction(i,h):c=!1),c&&(h.instance.dragData[this.scope]=this.droppables[this.scope],h.instance.intOver(i,h.target),this.hoverObject=h)}else this.hoverObject&&this.triggerOutFunction(i,h);var u=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var d=this.parentClientRect.left,p=this.parentClientRect.top,f=this.getCoordinates(i),v=f.pageX,m=f.pageY,y=this.position.left-this.diffX,b=this.position.top-this.diffY,S=getComputedStyle(u);if(this.dragArea){if(this.enableAutoScroll&&this.setDragArea(),this.pageX!==v||this.skipDistanceCheck){var C=u.offsetWidth+(parseFloat(S.marginLeft)+parseFloat(S.marginRight));this.dragLimit.left>y&&y>0?r=this.dragLimit.left:this.dragLimit.right+window.pageXOffset<y+C&&y>0?r=y-(y-this.dragLimit.right)+window.pageXOffset-C:r=y<0?this.dragLimit.left:y}if(this.pageY!==m||this.skipDistanceCheck){var x=u.offsetHeight+(parseFloat(S.marginTop)+parseFloat(S.marginBottom));this.dragLimit.top>b&&b>0?n=this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<b+x&&b>0?n=b-(b-this.dragLimit.bottom)+window.pageYOffset-x:n=b<0?this.dragLimit.top:b}}else r=y,n=b;var I=p+this.borderWidth.top,D=d+this.borderWidth.left;this.dragProcessStarted&&(g(n)&&(n=this.prevTop),g(r)&&(r=this.prevLeft));var M,E;if(this.helperElement.classList.contains("e-treeview"))this.dragArea?(this.dragLimit.top=this.clone?this.dragLimit.top:0,M=n-I<0?this.dragLimit.top:n-this.borderWidth.top,E=r-D<0?this.dragLimit.left:r-this.borderWidth.left):(M=n-this.borderWidth.top,E=r-this.borderWidth.left);else if(this.dragArea){var A=this.helperElement.classList.contains("e-dialog");this.dragLimit.top=this.clone?this.dragLimit.top:0,M=n-I<0?this.dragLimit.top:n-I,E=r-D<0?A?r-(D-this.borderWidth.left):this.dragElePosition.left:r-D}else M=n-I,E=r-D;var L=parseFloat(getComputedStyle(this.element).marginTop);if(L>0&&(this.clone&&(M+=L,b<0&&(L+b>=0?M=L+b:M-=L),this.dragArea&&(M=this.dragLimit.bottom<M?this.dragLimit.bottom:M)),n-I<0))if(b+L+(u.offsetHeight-I)>=0){var N=this.dragLimit.top+b-I;N+L+I<0?M-=L+I:M=N}else M-=L+I;if(this.dragArea&&this.helperElement.classList.contains("e-treeview")){var x=u.offsetHeight+(parseFloat(S.marginTop)+parseFloat(S.marginBottom));M=M+x>this.dragLimit.bottom?this.dragLimit.bottom-x:M}this.enableScrollHandler&&!this.clone&&(M-=this.parentScrollY,E-=this.parentScrollX),this.dragArea&&typeof this.dragArea!="string"&&this.dragArea.classList.contains("e-kanban-content")&&this.dragArea.style.position==="relative"&&(M+=this.dragArea.scrollTop);var R=this.getProcessedPositionValue({top:M+"px",left:E+"px"});this.isPreventScroll&&(R=this.getProcessedPositionValue({top:this.position.top-this.parentClientRect.top-2+"px",left:this.position.left-this.parentClientRect.left-2+"px"})),Ze(u,this.getDragPosition(R)),!this.elementInViewport(u)&&this.enableAutoScroll&&!this.helperElement.classList.contains("e-treeview")&&this.helperElement.scrollIntoView();var P=document.querySelectorAll(":hover");if(this.enableAutoScroll&&this.helperElement.classList.contains("e-treeview")){P.length===0&&(P=this.getPathElements(i));var k=this.getScrollParent(P,!1);this.elementInViewport(this.helperElement)?this.getScrollPosition(k,M):this.elementInViewport(this.helperElement)||(P=[].slice.call(document.querySelectorAll(":hover")),P.length===0&&(P=this.getPathElements(i)),k=this.getScrollParent(P,!0),this.getScrollPosition(k,M))}this.dragProcessStarted=!0,this.prevLeft=r,this.prevTop=n,this.position.left=r,this.position.top=n,this.pageX=v,this.pageY=m}},t.prototype.getScrollParent=function(i,r){for(var n=r?i.reverse():i,s,a=n.length-1;a>=0;a--)if(s=window.getComputedStyle(n[parseInt(a.toString(),10)])["overflow-y"],(s==="auto"||s==="scroll")&&n[parseInt(a.toString(),10)].scrollHeight>n[parseInt(a.toString(),10)].clientHeight)return n[parseInt(a.toString(),10)];if(s=window.getComputedStyle(document.scrollingElement)["overflow-y"],s==="visible")return document.scrollingElement.style.overflow="auto",document.scrollingElement},t.prototype.getScrollPosition=function(i,r){if(i&&i===document.scrollingElement)i.clientHeight+document.scrollingElement.scrollTop-this.helperElement.clientHeight<r&&i.getBoundingClientRect().height+this.parentClientRect.top>r?i.scrollTop+=this.helperElement.clientHeight:i.scrollTop>r-this.helperElement.clientHeight&&(i.scrollTop-=this.helperElement.clientHeight);else if(i&&i!==document.scrollingElement){var n=document.scrollingElement.scrollTop,s=this.helperElement.clientHeight;i.clientHeight+i.getBoundingClientRect().top-s+n<r?i.scrollTop+=this.helperElement.clientHeight:i.getBoundingClientRect().top>r-s-n&&(i.scrollTop-=this.helperElement.clientHeight)}},t.prototype.getPathElements=function(i){var r=i.clientX>0?i.clientX:0,n=i.clientY>0?i.clientY:0;return document.elementsFromPoint(r,n)},t.prototype.triggerOutFunction=function(i,r){this.hoverObject.instance.intOut(i,r.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null},t.prototype.getDragPosition=function(i){var r=pe({},i);return this.axis&&(this.axis==="x"?delete r.top:this.axis==="y"&&delete r.left),r},t.prototype.getDocumentWidthHeight=function(i){var r=document.body,n=document.documentElement,s=Math.max(r["scroll"+i],n["scroll"+i],r["offset"+i],n["offset"+i],n["client"+i]);return s},t.prototype.intDragStop=function(i){if(this.dragProcessStarted=!1,!(!Te(i.changedTouches)&&i.changedTouches.length!==1)){var r=["touchend","pointerup","mouseup"];if(r.indexOf(i.type)!==-1){if(this.dragStop){var n=this.getProperTargetElement(i);this.trigger("dragStop",{event:i,element:this.element,target:n,helper:this.helperElement})}this.intDestroy(i)}else this.element.setAttribute("aria-grabbed","false");var s=this.checkTargetElement(i);s.target&&s.instance&&(s.instance.dragStopCalled=!0,s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intDrop(i,s.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},t.prototype.intDestroy=function(i){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),T.remove(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.intDragStart),T.remove(document,j.isSafari()?"touchend":j.touchEndEvent,this.intDragStop),T.remove(document,j.isSafari()?"touchend":j.touchEndEvent,this.intDestroy),T.remove(document,j.isSafari()?"touchmove":j.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)},t.prototype.onPropertyChanged=function(i,r){},t.prototype.getModuleName=function(){return"draggable"},t.prototype.isDragStarted=function(i){return i&&(ww.isDragged=!ww.isDragged),ww.isDragged},t.prototype.setDragArea=function(){var i,r,n=0,s=0,a,l=typeof this.dragArea;if(l==="string"?a=J(this.dragArea):a=this.dragArea,a){var h=a.getBoundingClientRect();i=a.scrollWidth?a.scrollWidth:h.right-h.left,r=a.scrollHeight?this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?a.clientHeight:a.scrollHeight:h.bottom-h.top;for(var c=["Top","Left","Bottom","Right"],u=getComputedStyle(a),d=0;d<c.length;d++){var p=c[parseInt(d.toString(),10)],f=u["border"+p+"Width"],v=u["padding"+p],m=p.toLowerCase();this.borderWidth[""+m]=isNaN(parseFloat(f))?0:parseFloat(f),this.padding[""+m]=isNaN(parseFloat(v))?0:parseFloat(v)}this.dragArea&&!g(this.helperElement)&&this.helperElement.classList.contains("e-treeview")?n=h.top+document.scrollingElement.scrollTop:n=h.top,s=h.left,this.dragLimit.left=s+this.borderWidth.left+this.padding.left,this.dragLimit.top=a.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=s+i-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+r-(this.borderWidth.bottom+this.padding.bottom)}},t.prototype.getProperTargetElement=function(i){var r=this.getCoordinates(i),n,s=this.helperElement.style.pointerEvents||"",a=i.type.indexOf("pointer")!==-1&&j.info.name==="safari"&&parseInt(j.info.version,10)>12;return am(i.target,this.helperElement)||i.type.indexOf("touch")!==-1||a?(this.helperElement.style.pointerEvents="none",n=document.elementFromPoint(r.clientX,r.clientY),this.helperElement.style.pointerEvents=s):n=i.target,n},t.prototype.currentStateCheck=function(i,r){var n;return!g(this.currentStateTarget)&&this.currentStateTarget!==i?n=this.currentStateTarget:n=g(r)?i:r,n},t.prototype.getMousePosition=function(i,r){var n=i.srcElement!==void 0?i.srcElement:i.target,s=this.getCoordinates(i),a,l,h=g(n.offsetParent);if(r?(a=this.clone?s.pageX:s.pageX+(h?0:n.offsetParent.scrollLeft)-this.relativeXPosition,l=this.clone?s.pageY:s.pageY+(h?0:n.offsetParent.scrollTop)-this.relativeYPosition):(a=this.clone?s.pageX:s.pageX+window.pageXOffset-this.relativeXPosition,l=this.clone?s.pageY:s.pageY+window.pageYOffset-this.relativeYPosition),document.scrollingElement&&!r&&!this.clone){var c=document.scrollingElement,u=c.scrollHeight>0&&c.scrollHeight>c.clientHeight&&c.scrollTop>0,d=c.scrollWidth>0&&c.scrollWidth>c.clientWidth&&c.scrollLeft>0;a=d?a-c.scrollLeft:a,l=u?l-c.scrollTop:l}return{left:a-(this.margin.left+this.cursorAt.left),top:l-(this.margin.top+this.cursorAt.top)}},t.prototype.getCoordinates=function(i){return i.type.indexOf("touch")>-1?i.changedTouches[0]:i},t.prototype.getHelperElement=function(i){var r;return this.clone?this.helper?r=this.helper({sender:i,element:this.target,currentTargetElement:this.currentStateTarget}):(r=et("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(r)):r=this.element,r},t.prototype.setGlobalDroppables=function(i,r,n){this.droppables[this.scope]=i?null:{draggable:r,helper:n,draggedElement:this.element}},t.prototype.checkTargetElement=function(i){var r=this.getProperTargetElement(i),n=this.getDropInstance(r);if(!n&&r&&!g(r.parentNode)){var s=H(r.parentNode,".e-droppable")||r.parentElement;s&&(n=this.getDropInstance(s))}return{target:r,instance:n}},t.prototype.getDropInstance=function(i){var r="getModuleName",n,s=i&&i.ej2_instances;if(s)for(var a=0,l=s;a<l.length;a++){var h=l[a];if(h[""+r]()==="droppable"){n=h;break}}return n},t.prototype.destroy=function(){this.toggleEvents(!0),o.prototype.destroy.call(this)};var e;return Xi([Ce({},b4)],t.prototype,"cursorAt",void 0),Xi([w(!0)],t.prototype,"clone",void 0),Xi([w()],t.prototype,"dragArea",void 0),Xi([w()],t.prototype,"isDragScroll",void 0),Xi([w()],t.prototype,"isReplaceDragEle",void 0),Xi([w(!0)],t.prototype,"isPreventSelect",void 0),Xi([w(!1)],t.prototype,"isPreventScroll",void 0),Xi([G()],t.prototype,"drag",void 0),Xi([G()],t.prototype,"dragStart",void 0),Xi([G()],t.prototype,"dragStop",void 0),Xi([w(1)],t.prototype,"distance",void 0),Xi([w()],t.prototype,"handle",void 0),Xi([w()],t.prototype,"abort",void 0),Xi([w()],t.prototype,"helper",void 0),Xi([w("default")],t.prototype,"scope",void 0),Xi([w("")],t.prototype,"dragTarget",void 0),Xi([w()],t.prototype,"axis",void 0),Xi([w()],t.prototype,"queryPositionInfo",void 0),Xi([w(!1)],t.prototype,"enableTailMode",void 0),Xi([w(!1)],t.prototype,"skipDistanceCheck",void 0),Xi([w(!0)],t.prototype,"preventDefault",void 0),Xi([w(!1)],t.prototype,"enableAutoScroll",void 0),Xi([w(!1)],t.prototype,"enableTapHold",void 0),Xi([w(750)],t.prototype,"tapHoldThreshold",void 0),Xi([w(!1)],t.prototype,"enableScrollHandler",void 0),t=e=Xi([It],t),t})(pa),S4=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Eu=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Nw=(function(o){S4(t,o);function t(e,i){var r=o.call(this,i,e)||this;return r.mouseOver=!1,r.dragData={},r.dragStopCalled=!1,r.bind(),r}return t.prototype.bind=function(){this.wireEvents()},t.prototype.wireEvents=function(){T.add(this.element,j.isSafari()?"touchend":j.touchEndEvent,this.intDrop,this)},t.prototype.onPropertyChanged=function(e,i){},t.prototype.getModuleName=function(){return"droppable"},t.prototype.intOver=function(e,i){if(!this.mouseOver){var r=this.dragData[this.scope];this.trigger("over",{event:e,target:i,dragData:r}),this.mouseOver=!0}},t.prototype.intOut=function(e,i){this.mouseOver&&(this.trigger("out",{evt:e,target:i}),this.mouseOver=!1)},t.prototype.intDrop=function(e,i){if(this.dragStopCalled)this.dragStopCalled=!1;else return;var r=!0,n=this.dragData[this.scope],s=n?n.helper&&wr(n.helper):!1,a;s&&(a=this.isDropArea(e,n.helper,i),this.accept&&(r=Fu(n.helper,this.accept))),s&&this.drop&&a.canDrop&&r&&this.trigger("drop",{event:e,target:a.target,droppedElement:n.helper,dragData:n}),this.mouseOver=!1},t.prototype.isDropArea=function(e,i,r){var n={canDrop:!0,target:r||e.target},s=e.type==="touchend";if(s||n.target===i){i.style.display="none";var a=s?e.changedTouches[0]:e,l=document.elementFromPoint(a.clientX,a.clientY);n.canDrop=!1,n.canDrop=am(l,this.element),n.canDrop&&(n.target=l),i.style.display=""}return n},t.prototype.destroy=function(){T.remove(this.element,j.isSafari()?"touchend":j.touchEndEvent,this.intDrop),o.prototype.destroy.call(this)},Eu([w()],t.prototype,"accept",void 0),Eu([w("default")],t.prototype,"scope",void 0),Eu([G()],t.prototype,"drop",void 0),Eu([G()],t.prototype,"over",void 0),Eu([G()],t.prototype,"out",void 0),t=Eu([It],t),t})(pa),C4=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),rm=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},w4={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},rr=(function(o){C4(t,o);function t(i,r){var n=o.call(this,r,i)||this;return n.keyPressHandler=function(s){for(var a=s.altKey,l=s.ctrlKey,h=s.shiftKey,c=s.which,u=Object.keys(n.keyConfigs),d=0,p=u;d<p.length;d++)for(var f=p[d],v=n.keyConfigs[""+f].split(","),m=0,y=v;m<y.length;m++){var b=y[m],S=e.getKeyConfigData(b.trim());a===S.altKey&&l===S.ctrlKey&&h===S.shiftKey&&c===S.keyCode&&(s.action=f,n.keyAction&&n.keyAction(s))}},n.bind(),n}e=t,t.prototype.destroy=function(){this.unwireEvents(),o.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(i,r){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(i){if(i in this.configCache)return this.configCache[""+i];var r=i.toLowerCase().split("+"),n={altKey:r.indexOf("alt")!==-1,ctrlKey:r.indexOf("ctrl")!==-1,shiftKey:r.indexOf("shift")!==-1,keyCode:null};return r[r.length-1].length>1&&Number(r[r.length-1])?n.keyCode=Number(r[r.length-1]):n.keyCode=e.getKeyCode(r[r.length-1]),e.configCache[""+i]=n,n},t.getKeyCode=function(i){return w4[""+i]||i.toUpperCase().charCodeAt(0)};var e;return t.configCache={},rm([w({})],t.prototype,"keyConfigs",void 0),rm([w("keyup")],t.prototype,"eventName",void 0),rm([G()],t.prototype,"keyAction",void 0),t=e=rm([It],t),t})(pa),Ri=(function(){function o(t,e,i){this.controlName=t,this.localeStrings=e,this.setLocale(i||Yp)}return o.prototype.setLocale=function(t){var e=this.intGetControlConstant(o.locale,t);this.currentLocale=e||this.localeStrings},o.load=function(t){this.locale=pe(this.locale,t,{},!0)},o.prototype.getConstant=function(t){return g(this.currentLocale[""+t])?this.localeStrings[""+t]||"":this.currentLocale[""+t]},o.prototype.intGetControlConstant=function(t,e){return t[""+e]?t[""+e][this.controlName]:null},o.locale={},o})(),qL=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ol=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},x4=(function(o){qL(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ol([w(50)],t.prototype,"swipeThresholdDistance",void 0),t})(Oe),I4=/(Up|Down)/,jr=(function(o){qL(t,o);function t(e,i){var r=o.call(this,i,e)||this;return r.touchAction=!0,r.tapCount=0,r.startEvent=function(n){if(r.touchAction===!0){var s=r.updateChangeTouches(n);n.changedTouches!==void 0&&(r.touchAction=!1),r.isTouchMoved=!1,r.movedDirection="",r.startPoint=r.lastMovedPoint={clientX:s.clientX,clientY:s.clientY},r.startEventData=s,r.hScrollLocked=r.vScrollLocked=!1,r.tStampStart=Date.now(),r.timeOutTapHold=setTimeout(function(){r.tapHoldEvent(n)},r.tapHoldThreshold),T.add(r.element,j.touchMoveEvent,r.moveEvent,r),T.add(r.element,j.touchEndEvent,r.endEvent,r),T.add(r.element,j.touchCancelEvent,r.cancelEvent,r)}},r.moveEvent=function(n){var s=r.updateChangeTouches(n);r.movedPoint=s,r.isTouchMoved=!(s.clientX===r.startPoint.clientX&&s.clientY===r.startPoint.clientY);var a={};if(r.isTouchMoved){clearTimeout(r.timeOutTapHold),r.calcScrollPoints(n);var l={startEvents:r.startEventData,originalEvent:n,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,scrollDirection:r.scrollDirection,velocity:r.getVelocity(s)};a=pe(a,{},l),r.trigger("scroll",a),r.lastMovedPoint={clientX:s.clientX,clientY:s.clientY}}},r.cancelEvent=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap),r.tapCount=0,r.swipeFn(n),T.remove(r.element,j.touchCancelEvent,r.cancelEvent)},r.endEvent=function(n){r.swipeFn(n),r.isTouchMoved||typeof r.tap=="function"&&(r.trigger("tap",{originalEvent:n,tapCount:++r.tapCount}),r.timeOutTap=setTimeout(function(){r.tapCount=0},r.tapThreshold)),r.modeclear()},r.swipeFn=function(n){clearTimeout(r.timeOutTapHold),clearTimeout(r.timeOutTap);var s=r.updateChangeTouches(n),a=s.clientX-r.startPoint.clientX,l=s.clientY-r.startPoint.clientY;a=Math.floor(a<0?-1*a:a),l=Math.floor(l<0?-1*l:a),r.isTouchMoved=a>1||l>1;var h=/Firefox/.test(j.userAgent);h&&s.clientX===0&&s.clientY===0&&n.type==="mouseup"&&(r.isTouchMoved=!1),r.endPoint=s,r.calcPoints(n);var c={originalEvent:n,startEvents:r.startEventData,startX:r.startPoint.clientX,startY:r.startPoint.clientY,distanceX:r.distanceX,distanceY:r.distanceY,swipeDirection:r.movedDirection,velocity:r.getVelocity(s)};if(r.isTouchMoved){var u=r.swipeSettings.swipeThresholdDistance,d=pe(void 0,r.defaultArgs,c),p=!1,f=r.element,v=r.isScrollable(f),m=I4.test(r.movedDirection);(u<r.distanceX&&!m||u<r.distanceY&&m)&&(v?p=r.checkSwipe(f,m):p=!0),p&&r.trigger("swipe",d)}r.modeclear()},r.modeclear=function(){r.modeClear=setTimeout(function(){r.touchAction=!0},typeof r.tap!="function"?0:20),r.lastTapTime=new Date().getTime(),T.remove(r.element,j.touchMoveEvent,r.moveEvent),T.remove(r.element,j.touchEndEvent,r.endEvent),T.remove(r.element,j.touchCancelEvent,r.cancelEvent)},r.bind(),r}return t.prototype.onPropertyChanged=function(e,i){},t.prototype.bind=function(){this.wireEvents(),j.isIE&&this.element.classList.add("e-block-touch")},t.prototype.destroy=function(){this.unwireEvents(),o.prototype.destroy.call(this)},t.prototype.wireEvents=function(){T.add(this.element,j.touchStartEvent,this.startEvent,this)},t.prototype.unwireEvents=function(){T.remove(this.element,j.touchStartEvent,this.startEvent)},t.prototype.getModuleName=function(){return"touch"},t.prototype.isScrollable=function(e){var i=getComputedStyle(e),r=i.overflow+i.overflowX+i.overflowY;return!!/(auto|scroll)/.test(r)},t.prototype.tapHoldEvent=function(e){this.tapCount=0,this.touchAction=!0,T.remove(this.element,j.touchMoveEvent,this.moveEvent),T.remove(this.element,j.touchEndEvent,this.endEvent);var i={originalEvent:e};this.trigger("tapHold",i),T.remove(this.element,j.touchCancelEvent,this.cancelEvent)},t.prototype.calcPoints=function(e){var i=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=i.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=i.clientY<this.startPoint.clientY?"Up":"Down"},t.prototype.calcScrollPoints=function(e){var i=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(i.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(i.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||this.hScrollLocked===!0)&&this.vScrollLocked===!1?(this.scrollDirection=i.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=i.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},t.prototype.getVelocity=function(e){var i=e.clientX,r=e.clientY,n=Date.now(),s=i-this.startPoint.clientX,a=r-this.startPoint.clientX,l=n-this.tStampStart;return Math.sqrt(s*s+a*a)/l},t.prototype.checkSwipe=function(e,i){var r=["scroll","offset"],n=i?["Height","Top"]:["Width","Left"];return e[r[0]+n[0]]<=e[r[1]+n[0]]?!0:e[r[0]+n[1]]===0||e[r[1]+n[0]]+e[r[0]+n[1]]>=e[r[0]+n[0]]},t.prototype.updateChangeTouches=function(e){var i=e.changedTouches&&e.changedTouches.length!==0?e.changedTouches[0]:e;return i},ol([G()],t.prototype,"tap",void 0),ol([G()],t.prototype,"tapHold",void 0),ol([G()],t.prototype,"swipe",void 0),ol([G()],t.prototype,"scroll",void 0),ol([w(350)],t.prototype,"tapThreshold",void 0),ol([w(750)],t.prototype,"tapHoldThreshold",void 0),ol([Ce({},x4)],t.prototype,"swipeSettings",void 0),t=ol([It],t),t})(pa),M4=new RegExp("\\n|\\r|\\s\\s+","g"),D4=new RegExp(/'|"/g),E4=new RegExp("if ?\\("),T4=new RegExp("else if ?\\("),wL=new RegExp("else"),A4=new RegExp("for ?\\("),xL=new RegExp("(/if|/for)"),L4=new RegExp("\\((.*)\\)",""),kw=new RegExp("^[0-9]+$","g"),N4=new RegExp(`[\\w"'.\\s+]+`,"g"),k4=new RegExp('"(.*?)"',"g"),F4=new RegExp(`[\\w"'@#$.\\s-+]+`,"g"),IL=new RegExp("\\${([^}]*)}","g"),R4=/^\..*/gm,Ew=/\\/gi,O4=/\\\\/gi,z4=new RegExp(`[\\w"'@#$.\\s+]+`,"g"),P4=/\window\./gm;function B4(o,t,e){if(typeof o=="function")return o;var i="data",r=j4(o,i,t,e),n=`var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-\u25A0\\s]+)['])/g);
        var hrefRegex = (/(?:href)([\\s='"./]+)([\\w-./?=&\\\\#"]+)((.)([\\w)(!-;/?-\u25A0\\s]+)['])/g);
        if(str.match(valueRegEx)){
            var check = str.match(valueRegEx);
            var str1 = str;
            for (var i=0; i < check.length; i++) {
                var check1 = str.match(valueRegEx)[i].split('value=')[1];
                var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                str1 = str1.replace(check1, change);
            }
            str = str.replace(str, str1);
        }
        else if (str.match(/(?:href='')/) === null) {
            if(str.match(hrefRegex)) {
                var check = str.match(hrefRegex);
                var str1 = str;
                for (var i=0; i < check.length; i++) {
                    var check1 = str.match(hrefRegex)[i].split('href=')[1];
                    if (check1) {
                        var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '"') : check1;
                        change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'"') : change;
                        str1 = str1.replace(check1, change);
                    }
                }
                str = str.replace(str, str1);
            }
        }
        `,s='var str="'+r+'";'+n+" return str;",a=new Function(i,s);return a.bind(t)}function j4(o,t,e,i){var r=0,n=[],s=o.match(/class="([^"]+|)\s{2}/g),a="";if(s&&s.forEach(function(u){a=u.replace(/\s\s+/g," "),o=o.replace(u,a)}),IL.test(o)){for(var l=!1,h="",c=0;c<o.length;c++)o[c+""]==="$"&&o[c+1]==="{"?l=!0:o[c+""]==="}"&&(l=!1),h+=o[c+""]==='"'&&!l?'\\"':o[c+""];o=h}else o=o.replace(/\\?"/g,'\\"');return o.replace(M4,"").replace(k4,"'$1'").replace(IL,function(u,d,p,f){var v=/@|#|\$/gm,m=d.match(L4);if(m){var y=m[1];if(T4.test(d))d='";} '+d.replace(m[1],y.replace(N4,function(E){return E=E.trim(),Tu(E,!D4.test(E)&&n.indexOf(E)===-1,t,n,i)}))+`{ 
 str = str + "`;else if(E4.test(d))d='"; '+d.replace(m[1],y.replace(F4,function(E){return DL(E,t,n,i)}))+`{ 
 str = str + "`;else if(A4.test(d)){var b=m[1].split(" of ");d='"; '+d.replace(m[1],function(E){return n.push(b[0]),n.push(b[0]+"Index"),r=r+1,"var i"+r+"=0; i"+r+" < "+Tu(b[1],!0,t,n,i)+".length; i"+r+"++"})+`{ 
 `+b[0]+"= "+Tu(b[1],!0,t,n,i)+"[i"+r+`]; 
 var `+b[0]+"Index=i"+r+`; 
 str = str + "`}else{var S=d.split("("),C=e&&Object.prototype.hasOwnProperty.call(e,S[0])?"this.":"global";C=/\./.test(S[0])?"":C;var x=m[1].split(",");m[1].length!==0&&!/data/.test(x[0])&&!/window./.test(x[0])&&(m[1]=C==="global"?t+"."+m[1]:m[1]);var I=/@|\$|#/gm,D=/\]\./gm;if(P4.test(d)&&D.test(d)||I.test(d)){var M=/@|\$|#|\]\./gm;M.test(d)&&(d='"+ '+(C==="global"?"":C)+d.replace(m[1],y.replace(z4,function(E){return DL(E,t,n,i)}))+'+ "')}else d='" + '+(C==="global"?"":C)+d.replace(y,Tu(m[1].replace(/,( |)data.|,/gi,","+t+".").replace(/,( |)data.window/gi,",window"),C!=="global",t,n,i))+'+"'}}else wL.test(d)?d='"; '+d.replace(wL,`} else { 
 str = str + "`):d.match(xL)?d=d.replace(xL,`"; 
 } 
 str = str + "`):v.test(d)?(d.match(Ew)&&(d=ML(d)),d='"+'+Tw(d,n.indexOf(d)===-1,t,n)+'"]+"'):d.match(Ew)?(d=ML(d),d='"+'+Tw(d,n.indexOf(d)===-1,t,n)+'"]+"'):d=d!==""?'"+'+Tu(d.replace(/,/gi,"+"+t+"."),n.indexOf(d)===-1,t,n,i)+'+"':"${}";return d})}function Tu(o,t,e,i,r){return t&&!kw.test(o)&&i.indexOf(o.split(".")[0])===-1&&!r&&o!=="true"&&o!=="false"?e+"."+o:o}function H4(o,t,e,i){var r=/^\..*/gm;return t&&!kw.test(o)&&i.indexOf(o.split(".")[0])===-1&&!r.test(o)?e+"."+o:o}function Tw(o,t,e,i){return t&&!kw.test(o)&&i.indexOf(o.split(".")[0])===-1?e+'["'+o:o}function ML(o){var t="\\\\";return o.match(O4)?o:o.replace(Ew,t)}function DL(o,t,e,i){o=o.trim();var r=/\window\./gm;if(r.test(o))return o;var n=/'|"/gm,s=/@|\$|#/gm;return s.test(o)&&(o=Tw(o,e.indexOf(o)===-1,t,e)+'"]'),R4.test(o)?H4(o,!n.test(o)&&e.indexOf(o)===-1,t,e):Tu(o,!n.test(o)&&e.indexOf(o)===-1,t,e,i)}var V4=/^[\n\r.]+<tr|^<tr/,_4=/^[\n\r.]+<svg|^<path|^<g/,ll={};function Fw(){return"-"+Math.random().toString(36).substr(2,5)}function Et(o,t,e){var i=Ow.compile(o,t,e);return function(r,n,s,a,l,h,c,u){var d=i(r,n,s,c,u),p="BlazorTemplateId";if($e()&&!l){var f=Fw(),v=a+f;if(ll[""+a]||(ll[""+a]=[]),g(h))r[""+p]=v,ll[""+a].push(r);else for(var m=Object.keys(ll[""+a][parseInt(h.toString(),10)]),y=0,b=m;y<b.length;y++){var S=b[y];S!==p&&r[""+S]&&(ll[""+a][parseInt(h.toString(),10)][""+S]=r[""+S]),S===p&&(v=ll[""+a][parseInt(h.toString(),10)][""+S])}return s==="rowTemplate"?[et("tr",{id:v,className:"e-blazor-template"})]:[et("div",{id:v,className:"e-blazor-template"})]}if(typeof d=="string")if(_4.test(d)){var C=et("svg",{innerHTML:d});return C.childNodes}else{var C=et(V4.test(d)?"table":"div",{innerHTML:d});return C.childNodes}else return d}}function Rw(o,t,e,i,r){if($e()){var n="sfBlazor";window[""+n].updateTemplate(t,ll[""+o],o,e,r),i!==!1&&(ll[""+o]=[])}}function cm(o,t,e){var i=document.getElementById(o);if(i)for(var r=i.getElementsByClassName("blazor-inner-template"),n=0;n<r.length;n++){var s=" ";g(e)?s=r[parseInt(n.toString(),10)].getAttribute("data-templateId"):s=r[parseInt(e.toString(),10)].getAttribute("data-templateId");var a=document.getElementById(s);if(a)for(var l=a.childNodes.length,h=0;h<l;h++)g(e)?r[parseInt(n.toString(),10)].appendChild(a.childNodes[0]):(r[parseInt(e.toString(),10)].appendChild(a.childNodes[0]),n=r.length)}}function YL(o){Ow.compile=o.compile}function GL(){return Ow.compile}function fa(o,t){var e;return o.prototype.CSPTemplate=!0,g(t)?e=o:(e=o.bind(t),e.prototype=Object.create(o.prototype)),e}var U4=(function(){function o(){}return o.prototype.compile=function(t,e,i){return e===void 0&&(e={}),B4(t,e)},o})(),Ow={compile:new U4().compile},W4=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],q4=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"href",selector:"a[href]"},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],EL=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","oncanplay","oncanplaythrough","oncontentvisibilityautostatechange","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeypress","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onstart","onpropertychange","oncopy","ontoggle","onpointerout","onpointermove","onpointerleave","onpointerenter","onpointerrawupdate","onpointerover","onbeforecopy","onbeforecut","onbeforeinput"],Pt=(function(){function o(){}return o.beforeSanitize=function(){return{selectors:{tags:W4,attributes:q4}}},o.sanitize=function(t){if(g(t))return t;var e=this.beforeSanitize(),i=this.serializeValue(e,t);return i},o.serializeValue=function(t,e){this.removeAttrs=t.selectors.attributes,this.removeTags=t.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=e,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();var i=this.wrapElement.innerHTML;return this.removeElement(),this.wrapElement=null,i.replace(/&amp;/g,"&")},o.removeElement=function(){for(var t=this.wrapElement.children,e=0;e<t.length;e++)for(var i=t[parseInt(e.toString(),10)].attributes,r=0;r<i.length;r++)this.wrapElement.children[parseInt(e.toString(),10)].removeAttribute(i[parseInt(r.toString(),10)].localName)},o.removeXssTags=function(){var t=this.wrapElement.querySelectorAll(this.removeTags.join(","));if(t.length>0)t.forEach(function(e){se(e)});else return},o.removeJsEvents=function(){var t=this.wrapElement.querySelectorAll("["+EL.join("],[")+"]");if(t.length>0)t.forEach(function(e){EL.forEach(function(i){e.hasAttribute(i)&&e.removeAttribute(i)})});else return},o.removeXssAttrs=function(){var t=this;this.removeAttrs.forEach(function(e,i){var r=t.wrapElement.querySelectorAll(e.selector);r.length>0&&(e.selector==="a[href]"?r.forEach(function(n){n.getAttribute(e.attribute).replace(/\t|\s|&/,"").indexOf("javascript:alert")!==-1&&n.removeAttribute(e.attribute)}):r.forEach(function(n){n.removeAttribute(e.attribute)}))})},o})();function Y4(o,t){t.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(i){(!Object.prototype.hasOwnProperty.call(o.prototype,i)||e.isFormBase&&i!=="constructor")&&(o.prototype["".concat(i)]=e.prototype["".concat(i)])})})}function QL(o){return function(t){Y4(t,o)}}function um(o,t,e){var i={};if(o&&o.length){for(var r=0,n=o;r<n.length;r++){var s=n[r];e===!0?(t.propCollection["".concat(s)]=new As(!1),t["".concat(s)]=t.propCollection["".concat(s)]):i["".concat(s)]=new As(!1)}e!==!0&&t.setProperties(i,!0)}}function dm(o,t,e){var i,r=Object.keys(o.registeredTemplate);if(r.length)for(var n=t&&t.filter(function(x){return!/\./g.test(x)}),s=/tab|accordion|toolbar/.test((i=o.getModuleName)===null||i===void 0?void 0:i.call(o)),a=0,l=n&&n||r;a<l.length;a++){var h=l[a];if(e&&e.length)for(var c=0;c<e.length;c++)if(s)for(var u=0;u<o.registeredTemplate["".concat(h)].length;u++){var d=o.registeredTemplate["".concat(h)][parseInt(u.toString(),10)];d&&d===e["".concat(c)]&&(d.destroy(),o.registeredTemplate["".concat(h)].splice(u,1))}else for(var u=0;u<o.registeredTemplate.template.length;u++){var d=o.registeredTemplate.template[parseInt(u.toString(),10)].rootNodes[0];if(d===e["".concat(c)]){var p=o.registeredTemplate["".concat(h)];p[parseInt(u.toString(),10)].destroy()}}else if(o.registeredTemplate["".concat(h)])for(var f=0,v=o.registeredTemplate["".concat(h)];f<v.length;f++){var p=v[f];if(!p.destroyed){if(p._view){var m=p._view.renderer.parentNode(p.rootNodes[0]);if(!g(m))for(var u=0;u<p.rootNodes.length;u++)m.appendChild(p.rootNodes[parseInt(u.toString(),10)])}p.destroy()}}(!s||!e)&&delete o.registeredTemplate["".concat(h)]}for(var y=function(x){x.instance&&x.instance.clearTemplate(t&&t.filter(function(I){var D=RegExp;return!!new D(x.name).test(I)}))},b=0,S=o.tagObjects;b<S.length;b++){var C=S[b];y(C)}}function Ka(o,t,e){for(var i=o.replace(/\[/g,".").replace(/\]/g,"").split("."),r=e||{},n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)];n+1===i.length?r["".concat(s)]=t===void 0?{}:t:r["".concat(s)]===void 0&&(r["".concat(s)]={}),r=r["".concat(s)]}return r}var G4=/Ref$/,Eo=(function(){function o(){this.hasChanges=!1,this.propCollection={},this.dataSource={},this.tags=[],this.tagObjects=[]}return o.prototype.ngOnInit=function(){this.registeredTemplate={};for(var t=0,e=this.tags;t<e.length;t++){var i=e[t],r=V("child"+i.substring(0,1).toUpperCase()+i.substring(1),this);r&&this.tagObjects.push({instance:r,name:i})}for(var n=Object.keys(this),s=0;s<n.length;s++){var a=V(n[parseInt(s.toString(),10)],this);typeof a=="object"&&a&&a.elementRef&&(V(n[parseInt(s.toString(),10)].indexOf("Ref")!==-1?n[parseInt(s.toString(),10)]:n[parseInt(s.toString(),10)]+"Ref",this)||it(n[parseInt(s.toString(),10)].indexOf("Ref")!==-1?n[parseInt(s.toString(),10)]:n[parseInt(s.toString(),10)]+"Ref",a,this),V("viewContainerRef",this)&&!V("_viewContainerRef",a.elementRef.nativeElement)&&!V("propName",a.elementRef.nativeElement)&&(it("_viewContainerRef",V("viewContainerRef",this),a.elementRef.nativeElement),it("propName",n[parseInt(s.toString(),10)].replace("Ref",""),a.elementRef.nativeElement)))}n=Object.keys(this),n=n.filter(function(v){return/Ref$/i.test(v)});for(var l=0,h=n;l<h.length;l++){var c=h[l],u=c.replace("Ref","");it(u.replace("_","."),V(u,this),this.propCollection)}var d=Object.keys(this);if(this.directivePropList){for(var p=0;p<this.directivePropList.length;p++){var f=this.directivePropList[parseInt(p.toString(),10)];d.indexOf(f)!==-1&&(V(f,this)===!1||V(f,this))&&it(f,V(f,this),this.propCollection)}this.hasChanges=!0}this.isInitChanges=!0},o.prototype.registerEvents=function(t){um(t,this,!0)},o.prototype.ngOnChanges=function(t){for(var e=0,i=Object.keys(t);e<i.length;e++){var r=i[e],n=t["".concat(r)];this.propCollection["".concat(r)]=n.currentValue}this.isUpdated=!1,this.hasChanges=!0},o.prototype.clearTemplate=function(t){dm(this,t)},o.prototype.getProperties=function(){for(var t=0,e=this.tagObjects;t<e.length;t++){var i=e[t];this.propCollection[i.name]=i.instance.getProperties()}return this.propCollection},o.prototype.isChanged=function(){var t=this.hasChanges;if(!g(this.propCollection[this.property])){for(var e=this.propCollection[this.property],i=Object.keys(e[0]),r=0;r<i.length;r++)if(!g(this.propCollection[i[parseInt(r.toString(),10)]])){var n=V(i[parseInt(r.toString(),10)],this),s=this.propCollection[this.property][0][i[parseInt(r.toString(),10)]];!g(n)&&this.propCollection[i[parseInt(r.toString(),10)]]!==n&&s!==n&&(it(i[parseInt(r.toString(),10)],n,this.propCollection[this.property][0]),it(i[parseInt(r.toString(),10)],n,this.propCollection),this.hasChanges=!0,this.isUpdated=!1)}}for(var a=0,l=this.tagObjects;a<l.length;a++){var h=l[a];t=t||h.instance.hasChanges}return t||this.hasChanges},o.prototype.ngAfterContentChecked=function(){if(this.hasChanges=this.isChanged(),this.isInitChanges||this.hasChanges){var t=Object.keys(this);t=t.filter(function(s){return G4.test(s)});for(var e=0,i=t;e<i.length;e++){var r=i[e],n=r.replace("Ref","");it(n.replace("_","."),V(n,this),this.propCollection)}}},o.prototype.ngAfterViewChecked=function(){this.isUpdated&&(this.hasChanges=!1)},o.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},o.prototype.ngOnDestroy=function(){this.directivePropList=[]},o})();var To=(function(){function o(t){this.list=[],this.hasChanges=!1,this.propertyName=t}return o.prototype.ngOnInit=function(){this.isInitChanges=!0},o.prototype.ngAfterContentInit=function(){var t=this,e=0;this.list=this.children.map(function(i){return i.dirIndex=e++,i.property=t.propertyName,i}),this.hasChanges=!0},o.prototype.getProperties=function(){for(var t=[],e=0,i=this.list;e<i.length;e++){var r=i[e];t.push(r.getProperties())}return t},o.prototype.isChanged=function(){var t=this,e=!1,i=0,r=!1,n=this.children.map(function(c){return c});if(this.list.length===this.children.length)for(var s=0;s<this.list.length;s++)this.list[parseInt(s.toString(),10)].propCollection.dataSource&&(this.list[parseInt(s.toString(),10)].dataSource&&this.list[parseInt(s.toString(),10)].propCollection.dataSource!==this.list[parseInt(s.toString(),10)].dataSource&&(this.list[parseInt(s.toString(),10)].propCollection.dataSource=this.list[parseInt(s.toString(),10)].dataSource,this.list[parseInt(s.toString(),10)].hasChanges=!0),this.list[parseInt(s.toString(),10)].property!=="series"&&(r=JSON.stringify(this.list[parseInt(s.toString(),10)].propCollection.dataSource)!==JSON.stringify(n[parseInt(s.toString(),10)].propCollection.dataSource))),r=this.list[parseInt(s.toString(),10)].hasChanges!==n[parseInt(s.toString(),10)].hasChanges;this.hasNewChildren=this.list.length!==this.children.length||r?!0:null,this.hasNewChildren&&(this.list=this.children.map(function(c){return c.dirIndex=i++,c.property=t.propertyName,c}));for(var a=0,l=this.list;a<l.length;a++){var h=l[a];e=e||h.hasChanges}return!!this.list.length&&e},o.prototype.clearTemplate=function(t){for(var e=this,i=0,r=this.list;i<r.length;i++){var n=r[i];n.clearTemplate(t&&t.map(function(s){var a=RegExp;return new a(e.propertyName).test(s)?s.replace(e.propertyName+".",""):s}))}},o.prototype.ngAfterContentChecked=function(){this.hasChanges=this.isChanged();for(var t=0;t<this.list.length;t++)V("childColumns",this.list[parseInt(t.toString(),10)])&&V("property",this.list[parseInt(t.toString(),10)])==="columns"&&it("columns",V("childColumns",this.list[parseInt(t.toString(),10)]).getProperties(),this.list[parseInt(t.toString(),10)].propCollection),this.list[parseInt(t.toString(),10)].isUpdated=!0},o.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},o.prototype.ngOnDestroy=function(){this.list=[]},o})();var zw=(function(){function o(){this.isProtectedOnChange=!0,this.isFormInit=!0}return o.prototype.saveChanges=function(t,e,i){if(!this.isProtectedOnChange){this.oldProperties["".concat(t)]=i,this.changedProperties["".concat(t)]=e,this.finalUpdate();var r=setTimeout(this.dataBind.bind(this)),n=function(){clearTimeout(r)};this.finalUpdate=n}},o.prototype.ngOnInit=function(t){var e=t||this;e.registeredTemplate={},e.ngBoundedEvents={},e.isAngular=!0,e.isFormInit=!0,t&&(this.tags=t.tags),e.tags=this.tags||[],e.complexTemplate=this.complexTemplate||[],e.tagObjects=[],e.ngAttr=this.getAngularAttr(e.element),e.createElement=function(v,m){var y=e.srenderer?e.srenderer.createElement(v):et(v);return typeof m>"u"||(y.innerHTML=m.innerHTML?m.innerHTML:"",m.className!==void 0&&(y.className=m.className),m.id!==void 0&&(y.id=m.id),m.styles!==void 0&&y.setAttribute("style",m.styles),e.ngAttr!==void 0&&y.setAttribute(e.ngAttr,""),m.attrs!==void 0&&Ee(y,m.attrs)),y};for(var i=0,r=e.tags;i<r.length;i++){var n=r[i],s={instance:V("child"+n.substring(0,1).toUpperCase()+n.substring(1),e),name:n};e.tagObjects.push(s)}for(var a=Object.keys(e),l=0;l<a.length;l++){var h=V(a[parseInt(l.toString(),10)],e);typeof h=="object"&&h&&h.elementRef&&(typeof h=="object"&&h&&h.elementRef&&a[parseInt(l.toString(),10)].indexOf("_")!==-1&&a[parseInt(l.toString(),10)].indexOf("Ref")===-1&&it(a[parseInt(l.toString(),10)]+"Ref",h,e),e.viewContainerRef&&!V("_viewContainerRef",h.elementRef.nativeElement)&&!V("propName",h.elementRef.nativeElement)&&(it("_viewContainerRef",e.viewContainerRef,h.elementRef.nativeElement),it("propName",a[parseInt(l.toString(),10)].replace("Ref",""),h.elementRef.nativeElement)))}a=Object.keys(e),a=a.filter(function(v){return/Ref$/i.test(v)&&/_/i.test(v)});for(var c=0,u=a;c<u.length;c++){var d=u[c],p=d.replace("Ref",""),f={};it(p.replace("_","."),V(p,e),f),e.setProperties(f,!0)}},o.prototype.getAngularAttr=function(t){for(var e=t.attributes,i=e.length,r,n=0;n<i;n++)/_ngcontent/g.test(e[parseInt(n.toString(),10)].name)&&(r=e[parseInt(n.toString(),10)].name);return r},o.prototype.ngAfterViewInit=function(t){var e=t||this,i=/ejs-tab|ejs-accordion/g;i.test(e.ngEle.nativeElement.outerHTML)&&(e.ngEle.nativeElement.style.visibility="hidden");var r=Object.keys(e);r=r.filter(function(u){return/Ref$/i.test(u)});for(var n=e.getModuleName()==="DocumentEditor",s=0,a=r;s<a.length;s++){var l=a[s],h=l.replace("Ref","");it(h.replace("_","."),V(h+"Ref",e),e)}var c=function(u){typeof window<"u"&&u.element&&(u.appendTo(u.element),u.ngEle.nativeElement.style.visibility="")};!n&&!e.getModuleName().includes("btn")?setTimeout(function(){c(e)}):c(e)},o.prototype.ngOnDestroy=function(t){var e=t||this;setTimeout(function(){if(typeof window<"u"&&e.element.classList.contains("e-control")){if(e.ngOnFocus!==void 0&&e.ngOnBlur!==void 0){var i=e.inputElement||e.element;i.removeEventListener("focus",e.ngOnFocusBound),i.removeEventListener("blur",e.ngOnBlurBound),e.ngOnFocusBound=null,e.ngOnBlurBound=null}e.destroy(),e.clearTemplate(null),setTimeout(function(){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r],a=e["".concat(s)];if(a&&/object/.test(typeof a)&&Object.keys(a).length!==0)if(/properties|changedProperties|childChangedProperties|oldProperties|moduleLoader/.test(s))for(var l=0,h=Object.keys(e["".concat(s)]);l<h.length;l++){var c=h[l],u=a["".concat(c)];u&&/object/.test(typeof u)&&Object.keys(u).length!==0&&(u.parent||u.parentObj)&&(e["".concat(s)]["".concat(c)]=null)}else(a.parent||a.parentObj)&&(e["".concat(s)]=null)}})}})},o.prototype.clearTemplate=function(t,e){dm(this,t,e)},o.prototype.ngAfterContentChecked=function(t){for(var e=t||this,i=0,r=e.tagObjects;i<r.length;i++){var n=r[i];if(!Te(n.instance)&&(n.instance.isInitChanges||n.instance.hasChanges||n.instance.hasNewChildren)){var s={};if(n.instance.isInitChanges){var a=void 0,l=V("instance.list",n);l&&l.length&&(a=l[0].directivePropList);var h=!0;if(e.getModuleName&&e.getModuleName()==="gantt"&&(h=!1),a&&h&&a.indexOf(n.instance.propertyName)===-1)for(var c=Object.keys(n.instance.list[0].propCollection),u=0;u<n.instance.list.length;u++){n.instance.list["".concat(u)].propCollection[n.instance.propertyName]=[];for(var d={},p=0;p<c.length;p++){var f=c[parseInt(p.toString(),10)];d["".concat(f)]=n.instance.list["".concat(u)].propCollection["".concat(f)]}for(var v=function(R){var P=n.instance.list["".concat(u)].tags[parseInt(R.toString(),10)],k=V("child"+P.substring(0,1).toUpperCase()+P.substring(1),n.instance.list["".concat(u)]);if(k){var B=n.instance.list["".concat(u)]["child"+P.substring(0,1).toUpperCase()+P.substring(1)],F=function(O){var z=[];if(O)for(var Y=0;Y<O.list.length;Y++){var K=O.list[0].tags[0];if(K){var U=V("child"+K.substring(0,1).toUpperCase()+K.substring(1),O.list[parseInt(Y.toString(),10)]);U&&(O.list[parseInt(Y.toString(),10)].tagObjects.push({instance:U,name:K}),z.push(U))}}if(z.length!==0)for(var q=0;q<z.length;q++)F(z[parseInt(q.toString(),10)])};F(B),n.instance.list["".concat(u)].tagObjects.push({instance:k,name:P})}},m=0;m<n.instance.list["".concat(u)].tags.length;m++)v(m);n.instance.list["".concat(u)].propCollection[n.instance.propertyName].push(d)}s[n.name]=n.instance.getProperties(),e.setProperties(s,n.instance.isInitChanges)}else{var y=!1;(e[n.name].length!==n.instance.list.length||/diagram|DashboardLayout/.test(e.getModuleName()))&&(e[n.name]=n.instance.list,y=!0);for(var b=0,S=n.instance.list;b<S.length;b++){var l=S[b];if(l.tags)for(var C=0,x=l.tags;C<x.length;C++){var I=x[C],D=V("child"+I.substring(0,1).toUpperCase()+I.substring(1),l);D&&l.tagObjects.push({instance:D,name:I})}var M=n.instance.list.indexOf(l),E=V(n.name,e)["".concat(M)],A=Object.keys(E);if(A=A.filter(function(P){return/Ref$/i.test(P)}),E.properties&&Object.keys(E.properties).length!==0)for(var L=0,N=A;L<N.length;L++){var f=N[L];f=f.replace(/Ref/,""),E.properties["".concat(f)]=E.properties["".concat(f)]?E.properties["".concat(f)]:E.propCollection["".concat(f)]}!Te(E)&&!Te(E.setProperties)&&(/diagram|DashboardLayout/.test(e.getModuleName())?E.setProperties(l.getProperties(),!0):E.setProperties(l.getProperties())),l.isUpdated=!0}(/grid/.test(e.getModuleName())&&y||/chart/.test(e.getModuleName()))&&(s[n.name]=n.instance.getProperties(),e.setProperties(s,n.instance.isInitChanges))}}}},o.prototype.registerEvents=function(t){um(t,this)},o.prototype.twoWaySetter=function(t,e){var i=V(e,this.properties);i!==t&&(this.saveChanges(e,t,i),it(e,g(t)?null:t,this.properties),V(e+"Change",this).emit(t))},o.prototype.addTwoWay=function(t){for(var e=this,i=function(l){V(l,r),Object.defineProperty(r,l,{get:function(){return V(l,e.properties)},set:function(h){return e.twoWaySetter(h,l)}}),it(l+"Change",new As,r)},r=this,n=0,s=t;n<s.length;n++){var a=s[n];i(a)}},o.prototype.addEventListener=function(t,e){var i=V(t,this);Te(i)||(this.ngBoundedEvents["".concat(t)]||(this.ngBoundedEvents["".concat(t)]=new Map),this.ngBoundedEvents["".concat(t)].set(e,i.subscribe(e)))},o.prototype.removeEventListener=function(t,e){var i=V(t,this);Te(i)||this.ngBoundedEvents["".concat(t)].get(e).unsubscribe()},o.prototype.trigger=function(t,e,i){var r=V(t,this),n=this.isProtectedOnChange;this.isProtectedOnChange=!1,e&&(e.name=t),Te(r)||r.next(e);var s=V("local"+t.charAt(0).toUpperCase()+t.slice(1),this);Te(s)||s.call(this,e),this.isProtectedOnChange=n,i&&(this.preventChange=this.isPreventChange,i.call(this,e)),this.isPreventChange=!1},o})();var Mse=(function(){function o(){}return o.prototype.propagateChange=function(t){},o.prototype.propagateTouch=function(){},o.prototype.localChange=function(t){var e=t.checked===void 0?t.value:t.checked;if(this.objCheck=Ls(e),this.isUpdated===!0&&(this.angularValue=this.oldValue),this.objCheck===!0)this.duplicateValue=JSON.stringify(e),this.duplicateAngularValue=JSON.stringify(this.angularValue),this.duplicateValue!==this.duplicateAngularValue&&this.propagateChange!==void 0&&e!==void 0&&(this.propagateChange(e),this.angularValue=e);else if(e!==this.angularValue&&this.propagateChange!==void 0&&e!==void 0)if(e!==""&&e!==null)this.propagateChange(e),this.angularValue=e;else{var i=e;this.propagateChange(i),this.angularValue=e}this.cdr.markForCheck()},o.prototype.registerOnChange=function(t){this.propagateChange=t},o.prototype.registerOnTouched=function(t){this.propagateTouch=t},o.prototype.twoWaySetter=function(t,e){var i=this.oldValue||V(e,this.properties),r=this.inputElement||this.element;r&&i===t&&this.value===t&&(r.value===void 0||r.value==="")||(this.saveChanges(e,t,i),it(e,g(t)?null:t,this.properties),V(e+"Change",this).emit(t))},o.prototype.ngAfterViewInit=function(t){var e=t||this;if(e.ngOnBlurBound=this.ngOnBlur.bind(this),e.ngOnFocusBound=this.ngOnFocus.bind(this),typeof window<"u"){e.getModuleName().includes("dropdowntree")?setTimeout(function(){e.appendTo(e.element)}):e.appendTo(e.element);var i=e.inputElement||e.element;i.addEventListener("focus",e.ngOnFocusBound),i.addEventListener("blur",e.ngOnBlurBound)}this.isFormInit=!1},o.prototype.setDisabledState=function(t){this.enabled=!t,this.disabled=t},o.prototype.writeValue=function(t){var e=/ejs-radiobutton/g;this.checked===void 0?this.value=t:this.ngEle&&(typeof t=="boolean"?e.test(this.ngEle.nativeElement.outerHTML)?this.checked=t===this.value:this.checked=t:this.checked=t===this.value);var i=this.angularValue==null;if(this.angularValue=t,this.isUpdated=!0,this.preventChange=!this.isFormInit,this.cdr.markForCheck(),t===null){i&&(this.preventChange=!1);return}},o.prototype.ngOnFocus=function(t){this.skipFromEvent!==!0&&this.focus.emit(t),this.cdr.markForCheck()},o.prototype.ngOnBlur=function(t){this.propagateTouch(),this.skipFromEvent!==!0&&this.blur.emit(t),this.cdr.markForCheck()},o.isFormBase=!0,o})();var Q4=GL();function X4(o,t){if(typeof o=="string"||typeof o=="function"&&o.prototype&&o.prototype.CSPTemplate)return Q4(o,t);var e=o.elementRef.nativeElement._viewContainerRef,i=o.elementRef.nativeElement.propName;return function(r,n,s){var a={$implicit:r},l=e||n.viewContainerRef,h=l.createEmbeddedView(o,a);/EJS-MENTION|EJS-DROPDOWNLIST/.test(V("currentInstance.element.nodeName",l))||/E-TABITEM/.test(V("element.nativeElement.nodeName",l))&&V("currentInstance.headerTemplateRef",l)?h.detectChanges():h.markForCheck();var c=n&&n.registeredTemplate?n.registeredTemplate:V("currentInstance.registeredTemplate",l);return s=s&&n.registeredTemplate?s:i,typeof c["".concat(s)]>"u"&&(c["".concat(s)]=[]),c["".concat(s)].push(h),h.rootNodes}}function Pw(o){return function(t,e){var i={set:K4(e),get:$4(e,o),enumerable:!0,configurable:!0};Object.defineProperty(t,e,i)}}function K4(o){return function(t){t!==void 0&&(it(o+"Ref",t,this),typeof t!="string"&&!(typeof t=="function"&&t.prototype&&t.prototype.CSPTemplate)?(t.elementRef.nativeElement._viewContainerRef=this.viewContainerRef,t.elementRef.nativeElement.propName=o):this.saveChanges&&(this.saveChanges(o,t,void 0),this.dataBind()))}}function $4(o,t){return function(){return V(o+"Ref",this)||t}}YL({compile:X4});var Pe=(function(){function o(t){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="",typeof t=="string"?this.fromTable=t:t&&t instanceof Array&&(this.lookups=t),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return Object.defineProperty(o.prototype,"moduleName",{get:function(){return"query"},enumerable:!0,configurable:!0}),o.prototype.setKey=function(t){return this.key=t,this},o.prototype.using=function(t){return this.dataManager=t,this},o.prototype.execute=function(t,e,i,r){return t=t||this.dataManager,t?t.executeQuery(this,e,i,r):ge.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},o.prototype.executeLocal=function(t){return t=t||this.dataManager,t?t.executeLocal(this):ge.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},o.prototype.clone=function(){var t=new o;return t.queries=this.queries.slice(0),t.key=this.key,t.isChild=this.isChild,t.dataManager=this.dataManager,t.fromTable=this.fromTable,t.params=this.params.slice(0),t.expands=this.expands.slice(0),t.sortedColumns=this.sortedColumns.slice(0),t.groupedColumns=this.groupedColumns.slice(0),t.subQuerySelector=this.subQuerySelector,t.subQuery=this.subQuery,t.fKey=this.fKey,t.isCountRequired=this.isCountRequired,t.distincts=this.distincts.slice(0),t.lazyLoad=this.lazyLoad.slice(0),t},o.prototype.from=function(t){return this.fromTable=t,this},o.prototype.addParams=function(t,e){return typeof e=="function"?this.params.push({key:t,fn:e}):this.params.push({key:t,value:e}),this},o.prototype.distinct=function(t){return typeof t=="string"?this.distincts=[].slice.call([t],0):this.distincts=t.slice(0),this},o.prototype.expand=function(t){return typeof t=="string"?this.expands=[].slice.call([t],0):this.expands=t.slice(0),this},o.prototype.where=function(t,e,i,r,n,s){e=e?e.toLowerCase():null;var a=null;return typeof t=="string"?a=new xt(t,e,i,r,n,s):t instanceof xt&&(a=t),this.queries.push({fn:"onWhere",e:a}),this},o.prototype.search=function(t,e,i,r,n){typeof e=="string"&&(e=[e]),(!i||i==="none")&&(i="contains");var s=ge.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:e,operator:i,searchKey:t,ignoreCase:r,ignoreAccent:n,comparer:s}}),this},o.prototype.sortBy=function(t,e,i){return this.sortByForeignKey(t,e,i)},o.prototype.sortByForeignKey=function(t,e,i,r){var n=g(r)?"ascending":r,s,a;if(typeof t=="string"&&ge.endsWith(t.toLowerCase()," desc")&&(t=t.replace(/ desc$/i,""),e="descending"),(!e||typeof e=="string")&&(n=e?e.toLowerCase():"ascending",e=ge.fnSort(e)),i){s=o.filterQueries(this.queries,"onSortBy");for(var l=0;l<s.length;l++)if(a=s[l].e.fieldName,typeof a=="string"){if(a===t)return this}else if(a instanceof Array){for(var h=0;h<a.length;h++)if(a[h]===t||t.toLowerCase()===a[h]+" desc")return this}}return this.queries.push({fn:"onSortBy",e:{fieldName:t,comparer:e,direction:n}}),this},o.prototype.sortByDesc=function(t){return this.sortBy(t,"descending")},o.prototype.group=function(t,e,i){return this.sortBy(t,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:t,comparer:e||null,format:i||null}}),this},o.prototype.page=function(t,e){return this.queries.push({fn:"onPage",e:{pageIndex:t,pageSize:e}}),this},o.prototype.range=function(t,e){return this.queries.push({fn:"onRange",e:{start:t,end:e}}),this},o.prototype.take=function(t){return this.queries.push({fn:"onTake",e:{nos:t}}),this},o.prototype.skip=function(t){return this.queries.push({fn:"onSkip",e:{nos:t}}),this},o.prototype.select=function(t){return typeof t=="string"&&(t=[].slice.call([t],0)),this.queries.push({fn:"onSelect",e:{fieldNames:t}}),this},o.prototype.hierarchy=function(t,e){return this.subQuerySelector=e,this.subQuery=t,this},o.prototype.foreignKey=function(t){return this.fKey=t,this},o.prototype.requiresCount=function(){return this.isCountRequired=!0,this},o.prototype.aggregate=function(t,e){return this.queries.push({fn:"onAggregates",e:{field:e,type:t}}),this},o.filterQueries=function(t,e){return t.filter(function(i){return i.fn===e})},o.filterQueryLists=function(t,e){for(var i=t.filter(function(s){return e.indexOf(s.fn)!==-1}),r={},n=0;n<i.length;n++)r[i[n].fn]||(r[i[n].fn]=i[n].e);return r},o})(),xt=(function(){function o(t,e,i,r,n,s){return r===void 0&&(r=!1),this.ignoreAccent=!1,this.isComplex=!1,typeof t=="string"?(this.field=t,this.operator=e.toLowerCase(),this.value=i,this.matchCase=s,this.ignoreCase=r,this.ignoreAccent=n,this.isComplex=!1,this.comparer=ge.fnOperators.processOperator(this.operator)):(t instanceof o&&i instanceof o||i instanceof Array)&&(this.isComplex=!0,this.condition=e.toLowerCase(),this.predicates=[t],this.matchCase=t.matchCase,this.ignoreCase=t.ignoreCase,this.ignoreAccent=t.ignoreAccent,i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}return o.and=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.combinePredicates([].slice.call(t,0),"and")},o.prototype.and=function(t,e,i,r,n){return o.combine(this,t,e,i,"and",r,n)},o.or=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.combinePredicates([].slice.call(t,0),"or")},o.prototype.or=function(t,e,i,r,n){return o.combine(this,t,e,i,"or",r,n)},o.ornot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.combinePredicates([].slice.call(t,0),"or not")},o.prototype.ornot=function(t,e,i,r,n){return o.combine(this,t,e,i,"ornot",r,n)},o.andnot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.combinePredicates([].slice.call(t,0),"and not")},o.prototype.andnot=function(t,e,i,r,n){return o.combine(this,t,e,i,"andnot",r,n)},o.fromJson=function(t){if(t instanceof Array){for(var e=[],i=0,r=t.length;i<r;i++)e.push(this.fromJSONData(t[i]));return e}var n=t;return this.fromJSONData(n)},o.prototype.validate=function(t){var e=this.predicates?this.predicates:[],i,r;if(!this.isComplex&&this.comparer)return this.condition&&this.condition.indexOf("not")!==-1?(this.condition=this.condition.split("not")[0]===""?void 0:this.condition.split("not")[0],!this.comparer.call(this,ge.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent)):this.comparer.call(this,ge.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent);this.condition&&this.condition.indexOf("not")!==-1?r=this.condition.indexOf("and")!==-1:r=this.condition==="and";for(var n=0;n<e.length;n++)if(n>0&&this.condition&&this.condition.indexOf("not")!==-1&&(e[n].condition=e[n].condition?e[n].condition+"not":"not"),i=e[n].validate(t),r){if(!i)return!1}else if(i)return!0;return r},o.prototype.toJson=function(){var t,e;if(this.isComplex){t=[],e=this.predicates;for(var i=0;i<e.length;i++)t.push(e[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:t,matchCase:this.matchCase}},o.combinePredicates=function(t,e){if(t.length===1){if(!(t[0]instanceof Array))return t[0];t=t[0]}return new o(t[0],e,t.slice(1))},o.combine=function(t,e,i,r,n,s,a){return e instanceof o?o[n](t,e):typeof e=="string"?o[n](t,new o(e,i,r,s,a)):ge.throwError("Predicate - "+n+" : invalid arguments")},o.fromJSONData=function(t){for(var e=t.predicates||[],i=e.length,r=[],n,s=0;s<i;s++)r.push(this.fromJSONData(e[s]));return t.isComplex?n=new o(r[0],t.condition,r.slice(1)):n=new o(t.field,t.operator,t.value,t.ignoreCase,t.ignoreAccent),n},o})(),XL={GroupGuid:"{271bbba0-1ee7}"},ge=(function(){function o(){}return o.getValue=function(t,e){return typeof t=="function"?t.call(e||{}):t},o.endsWith=function(t,e){return t.slice&&t.slice(-e.length)===e},o.notEndsWith=function(t,e){return t.slice&&t.slice(-e.length)!==e},o.startsWith=function(t,e){return t.slice(0,e.length)===e},o.notStartsWith=function(t,e){return t.slice(0,e.length)!==e},o.wildCard=function(t,e){var i,r;if(e.indexOf("[")!==-1&&(e=e.split("[").join("[[]")),e.indexOf("(")!==-1&&(e=e.split("(").join("[(]")),e.indexOf(")")!==-1&&(e=e.split(")").join("[)]")),e.indexOf("\\")!==-1&&(e=e.split("\\").join("[\\\\]")),e.indexOf("*")!==-1){e.charAt(0)!=="*"&&(e="^"+e),e.charAt(e.length-1)!=="*"&&(e=e+"$"),i=e.split("*");for(var n=0;n<i.length;n++)i[n].indexOf(".")===-1?i[n]=i[n]+".*":i[n]=i[n]+"*";e=i.join("")}(e.indexOf("%3f")!==-1||e.indexOf("?")!==-1)&&(r=e.indexOf("%3f")!==-1?e.split("%3f"):e.split("?"),e=r.join("."));var s=new RegExp(e,"g");return s.test(t)},o.like=function(t,e){return e.indexOf("%")!==-1?e.charAt(0)==="%"&&e.lastIndexOf("%")<2?(e=e.substring(1,e.length),o.startsWith(o.toLowerCase(t),o.toLowerCase(e))):e.charAt(e.length-1)==="%"&&e.indexOf("%")>e.length-3?(e=e.substring(0,e.length-1),o.endsWith(o.toLowerCase(t),o.toLowerCase(e))):(e.lastIndexOf("%")!==e.indexOf("%")&&e.lastIndexOf("%")>e.indexOf("%")+1&&(e=e.substring(e.indexOf("%")+1,e.lastIndexOf("%"))),t.indexOf(e)!==-1):!1},o.fnSort=function(t){return t=t?o.toLowerCase(t):"ascending",t==="ascending"?this.fnAscending:this.fnDescending},o.fnAscending=function(t,e){return g(t)&&g(e)?0:e==null?-1:typeof t=="string"?t.localeCompare(e):t==null?1:t-e},o.fnDescending=function(t,e){return g(t)&&g(e)?0:e==null?1:typeof t=="string"?t.localeCompare(e)*-1:t==null?-1:e-t},o.extractFields=function(t,e){for(var i={},r=0;r<e.length;r++)i=this.setValue(e[r],this.getObject(e[r],t),i);return i},o.select=function(t,e){for(var i=[],r=0;r<t.length;r++)i.push(this.extractFields(t[r],e));return i},o.group=function(t,e,i,r,n,s,a){r=r||1;var l=t,h="GroupGuid";if(l.GroupGuid===XL[h]){for(var c=function(S){if(g(n))l[S].items=u.group(l[S].items,e,i,l.level+1,null,s,a),l[S].count=l[S].items.length;else{var C=-1,x=n.filter(function(I){return I.key===l[S].key});C=n.indexOf(x[0]),l[S].items=u.group(l[S].items,e,i,l.level+1,n[C].items,s,a),l[S].count=n[C].count}},u=this,d=0;d<l.length;d++)c(d);return l.childLevels+=1,l}var p={},f=[];f.GroupGuid=XL[h],f.level=r,f.childLevels=0,f.records=l;for(var v=function(S){var C=m.getVal(l,S,e);if(g(s)||(C=s(C,e)),!p[C]&&(p[C]={key:C,count:0,items:[],aggregates:{},field:e},f.push(p[C]),!g(n))){var x=n.filter(function(I){return I.key===p[C].key});p[C].count=x[0].count}p[C].count=g(n)?p[C].count+=1:p[C].count,(!a||a&&i.length)&&p[C].items.push(l[S])},m=this,y=0;y<l.length;y++)v(y);if(i&&i.length)for(var b=function(S){for(var C={},x=void 0,I=i,D=0;D<i.length;D++)if(x=o.aggregates[i[D].type],g(n))x&&(C[I[D].field+" - "+I[D].type]=x(f[S].items,I[D].field));else{var M=n.filter(function(E){return E.key===f[S].key});x&&(C[I[D].field+" - "+I[D].type]=x(M[0].items,I[D].field))}f[S].aggregates=C},y=0;y<f.length;y++)b(y);if(a&&f.length&&i.length)for(var y=0;y<f.length;y++)f[y].items=[];return l.length&&f||l},o.buildHierarchy=function(t,e,i,r,n){var s,a={},l;for(r.result&&(r=r.result),r.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),s=0;s<r.length;s++){var h=this.getObject(t,r[s]);l=a[h]||(a[h]=[]),l.push(r[s])}for(s=0;s<i.length;s++){var h=this.getObject(n||t,i[s]);i[s][e]=a[h]}},o.getFieldList=function(t,e,i){if(i===void 0&&(i=""),e==null)return this.getFieldList(t,[],i);for(var r=t,n=Object.keys(t),s=0,a=n;s<a.length;s++){var l=a[s];typeof r[l]=="object"&&!(r[l]instanceof Array)?this.getFieldList(r[l],e,i+l+"."):e.push(i+l)}return e},o.getObject=function(t,e){if(!t)return e;if(e){if(t.indexOf(".")===-1)if(g(e[t])){var i=t.charAt(0).toLowerCase()+t.slice(1),r=t.charAt(0).toUpperCase()+t.slice(1);return g(e[i])?g(e[r])?null:e[r]:e[i]}else return e[t];for(var n=e,s=t.split("."),a=0;a<s.length&&n!=null;a++){if(n=n[s[a]],n===void 0){var l=s[a].charAt(0).toUpperCase()+s[a].slice(1);n=e[l]||e[l.charAt(0).toLowerCase()+l.slice(1)]||null}e=n}return n}},o.setValue=function(t,e,i){var r=t.toString().split("."),n=i||{},s=n,a,l=r.length,h;for(a=0;a<l;a++)h=r[a],a+1===l?s[h]=e===void 0?void 0:e:g(s[h])&&(s[h]={}),s=s[h];return n},o.sort=function(t,e,i){var r=this;return t.length<=1?t:t.slice().sort(function(n,s){return i(r.getVal([n],0,e),r.getVal([s],0,e),n,s)})},o.ignoreDiacritics=function(t){if(typeof t!="string")return t;var e=t.split(""),i=e.map(function(r){return r in o.diacritics?o.diacritics[r]:r});return i.join("")},o.ignoreDiacriticsForArrays=function(t){return Array.isArray(t)?t.map(function(e){return o.ignoreDiacritics(e)}):[]},o.merge=function(t,e,i,r){for(var n=[],s;t.length>0||e.length>0;)t.length>0&&e.length>0?r?s=r(this.getVal(t,0,i),this.getVal(e,0,i),t[0],e[0])<=0?t:e:s=t[0][i]<t[0][i]?t:e:s=t.length>0?t:e,n.push(s.shift());return n},o.getVal=function(t,e,i){return i?this.getObject(i,t[e]):t[e]},o.toLowerCase=function(t){return g(t)?"":typeof t=="string"?t.toLowerCase():t instanceof Date?t.toString().toLowerCase():t.toString()},o.callAdaptorFunction=function(t,e,i,r){if(e in t){var n=t[e](i,r);g(n)||(i=n)}return i},o.getAddParams=function(t,e,i){var r={};return o.callAdaptorFunction(t,"addParams",{dm:e,query:i,params:i?i.params:[],reqParams:r}),r},o.isPlainObject=function(t){return!!t&&t.constructor===Object},o.isCors=function(){var t=null,e="XMLHttpRequest";try{t=new window[e]}catch{}return!!t&&"withCredentials"in t},o.getGuid=function(t){var e="0123456789abcdef",i;return(t||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(r,n){if("crypto"in window&&"getRandomValues"in crypto){var s=new Uint8Array(1);window.crypto.getRandomValues(s),i=s[0]%16|0}return e[n===19?i&3|8:i]})},o.isNull=function(t){return t==null},o.getItemFromComparer=function(t,e,i){var r,n,s,a=0,l=typeof o.getVal(t,0,e)=="string";if(t.length)for(;g(r)&&a<t.length;)r=o.getVal(t,a,e),s=t[a++];for(;a<t.length;a++)n=o.getVal(t,a,e),!g(n)&&(l&&(r=+r,n=+n),i(r,n)>0&&(r=n,s=t[a]));return s},o.distinct=function(t,e,i){i=g(i)?!1:i;var r=[],n,s={};return t.forEach(function(a,l){n=typeof t[l]=="object"?o.getVal(t,l,e):t[l],n in s||(r.push(i?t[l]:n),s[n]=1)}),r},o.processData=function(t,e){var i=this.prepareQuery(t),r=new oe(e);t.requiresCounts&&i.requiresCount();var n=r.executeLocal(i),s={result:t.requiresCounts?n.result:n,count:n.count,aggregates:JSON.stringify(n.aggregates)};return t.requiresCounts?s:n},o.prepareQuery=function(t){var e=this,i=new Pe;if(t.select&&i.select(t.select),t.where){var r=o.parse.parseJson(t.where);r.filter(function(s){if(g(s.condition))i.where(s.field,s.operator,s.value,s.ignoreCase,s.ignoreAccent);else{var a=[];s.field?a.push(new xt(s.field,s.operator,s.value,s.ignoreCase,s.ignoreAccent)):a=a.concat(e.getPredicate(s.predicates)),s.condition==="or"?i.where(xt.or(a)):s.condition==="and"&&i.where(xt.and(a))}})}if(t.search){var n=o.parse.parseJson(t.search);n.filter(function(s){return i.search(s.key,s.fields,s.operator,s.ignoreCase,s.ignoreAccent)})}return t.aggregates&&t.aggregates.filter(function(s){return i.aggregate(s.type,s.field)}),t.sorted&&t.sorted.filter(function(s){return i.sortBy(s.name,s.direction)}),t.skip&&i.skip(t.skip),t.take&&i.take(t.take),t.group&&t.group.filter(function(s){return i.group(s)}),i},o.getPredicate=function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];if(r.field)e.push(new xt(r.field,r.operator,r.value,r.ignoreCase,r.ignoreAccent));else{for(var n=[],s=this.getPredicate(r.predicates),a=0,l=Object.keys(s);a<l.length;a++){var h=l[a];n.push(s[h])}e.push(r.condition==="or"?xt.or(n):xt.and(n))}}return e},o.serverTimezoneOffset=null,o.timeZoneHandling=!0,o.throwError=function(t){try{throw new Error(t)}catch(e){throw e.message+`
`+e.stack}},o.aggregates={sum:function(t,e){for(var i=0,r,n=typeof o.getVal(t,0,e)!="number",s=0;s<t.length;s++)r=o.getVal(t,s,e),!isNaN(r)&&r!==null&&(n&&(r=+r),i+=r);return i},average:function(t,e){return o.aggregates.sum(t,e)/t.length},min:function(t,e){var i;return typeof e=="function"&&(i=e,e=null),o.getObject(e,o.getItemFromComparer(t,e,i||o.fnAscending))},max:function(t,e){var i;return typeof e=="function"&&(i=e,e=null),o.getObject(e,o.getItemFromComparer(t,e,i||o.fnDescending))},truecount:function(t,e){return new oe(t).executeLocal(new Pe().where(e,"equal",!0,!0)).length},falsecount:function(t,e){return new oe(t).executeLocal(new Pe().where(e,"equal",!1,!0)).length},count:function(t,e){return t.length}},o.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},o.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},o.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not substringof",wildcard:"wildcard",like:"like"},o.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains",doesnotendwith:"not endswith",doesnotstartwith:"not startswith",doesnotcontain:"not contains",wildcard:"wildcard",like:"like"},o.diacritics={"\u24B6":"A",\uFF21:"A",\u00C0:"A",\u00C1:"A",\u00C2:"A",\u1EA6:"A",\u1EA4:"A",\u1EAA:"A",\u1EA8:"A",\u00C3:"A",\u0100:"A",\u0102:"A",\u1EB0:"A",\u1EAE:"A",\u1EB4:"A",\u1EB2:"A",\u0226:"A",\u01E0:"A",\u00C4:"A",\u01DE:"A",\u1EA2:"A",\u00C5:"A",\u01FA:"A",\u01CD:"A",\u0200:"A",\u0202:"A",\u1EA0:"A",\u1EAC:"A",\u1EB6:"A",\u1E00:"A",\u0104:"A","\u023A":"A","\u2C6F":"A","\uA732":"AA",\u00C6:"AE",\u01FC:"AE",\u01E2:"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B",\uFF22:"B",\u1E02:"B",\u1E04:"B",\u1E06:"B","\u0243":"B",\u0182:"B",\u0181:"B","\u24B8":"C",\uFF23:"C",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u00C7:"C",\u1E08:"C",\u0187:"C","\u023B":"C","\uA73E":"C","\u24B9":"D",\uFF24:"D",\u1E0A:"D",\u010E:"D",\u1E0C:"D",\u1E10:"D",\u1E12:"D",\u1E0E:"D",\u0110:"D",\u018B:"D",\u018A:"D",\u0189:"D","\uA779":"D",\u01F1:"DZ",\u01C4:"DZ",\u01F2:"Dz",\u01C5:"Dz","\u24BA":"E",\uFF25:"E",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u1EC0:"E",\u1EBE:"E",\u1EC4:"E",\u1EC2:"E",\u1EBC:"E",\u0112:"E",\u1E14:"E",\u1E16:"E",\u0114:"E",\u0116:"E",\u00CB:"E",\u1EBA:"E",\u011A:"E",\u0204:"E",\u0206:"E",\u1EB8:"E",\u1EC6:"E",\u0228:"E",\u1E1C:"E",\u0118:"E",\u1E18:"E",\u1E1A:"E",\u0190:"E",\u018E:"E","\u24BB":"F",\uFF26:"F",\u1E1E:"F",\u0191:"F","\uA77B":"F","\u24BC":"G",\uFF27:"G",\u01F4:"G",\u011C:"G",\u1E20:"G",\u011E:"G",\u0120:"G",\u01E6:"G",\u0122:"G",\u01E4:"G",\u0193:"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H",\uFF28:"H",\u0124:"H",\u1E22:"H",\u1E26:"H",\u021E:"H",\u1E24:"H",\u1E28:"H",\u1E2A:"H",\u0126:"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I",\uFF29:"I",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u0128:"I",\u012A:"I",\u012C:"I",\u0130:"I",\u00CF:"I",\u1E2E:"I",\u1EC8:"I",\u01CF:"I",\u0208:"I",\u020A:"I",\u1ECA:"I",\u012E:"I",\u1E2C:"I",\u0197:"I","\u24BF":"J",\uFF2A:"J",\u0134:"J","\u0248":"J","\u24C0":"K",\uFF2B:"K",\u1E30:"K",\u01E8:"K",\u1E32:"K",\u0136:"K",\u1E34:"K",\u0198:"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L",\uFF2C:"L",\u013F:"L",\u0139:"L",\u013D:"L",\u1E36:"L",\u1E38:"L",\u013B:"L",\u1E3C:"L",\u1E3A:"L",\u0141:"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L",\u01C7:"LJ",\u01C8:"Lj","\u24C2":"M",\uFF2D:"M",\u1E3E:"M",\u1E40:"M",\u1E42:"M","\u2C6E":"M",\u019C:"M","\u24C3":"N",\uFF2E:"N",\u01F8:"N",\u0143:"N",\u00D1:"N",\u1E44:"N",\u0147:"N",\u1E46:"N",\u0145:"N",\u1E4A:"N",\u1E48:"N","\u0220":"N",\u019D:"N","\uA790":"N","\uA7A4":"N",\u01CA:"NJ",\u01CB:"Nj","\u24C4":"O",\uFF2F:"O",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u1ED2:"O",\u1ED0:"O",\u1ED6:"O",\u1ED4:"O",\u00D5:"O",\u1E4C:"O",\u022C:"O",\u1E4E:"O",\u014C:"O",\u1E50:"O",\u1E52:"O",\u014E:"O",\u022E:"O",\u0230:"O",\u00D6:"O",\u022A:"O",\u1ECE:"O",\u0150:"O",\u01D1:"O",\u020C:"O",\u020E:"O",\u01A0:"O",\u1EDC:"O",\u1EDA:"O",\u1EE0:"O",\u1EDE:"O",\u1EE2:"O",\u1ECC:"O",\u1ED8:"O",\u01EA:"O",\u01EC:"O",\u00D8:"O",\u01FE:"O",\u0186:"O",\u019F:"O","\uA74A":"O","\uA74C":"O",\u01A2:"OI","\uA74E":"OO",\u0222:"OU","\u24C5":"P",\uFF30:"P",\u1E54:"P",\u1E56:"P",\u01A4:"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q",\uFF31:"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R",\uFF32:"R",\u0154:"R",\u1E58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1E5A:"R",\u1E5C:"R",\u0156:"R",\u1E5E:"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S",\uFF33:"S","\u1E9E":"S",\u015A:"S",\u1E64:"S",\u015C:"S",\u1E60:"S",\u0160:"S",\u1E66:"S",\u1E62:"S",\u1E68:"S",\u0218:"S",\u015E:"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T",\uFF34:"T",\u1E6A:"T",\u0164:"T",\u1E6C:"T",\u021A:"T",\u0162:"T",\u1E70:"T",\u1E6E:"T",\u0166:"T",\u01AC:"T",\u01AE:"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U",\uFF35:"U",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u0168:"U",\u1E78:"U",\u016A:"U",\u1E7A:"U",\u016C:"U",\u00DC:"U",\u01DB:"U",\u01D7:"U",\u01D5:"U",\u01D9:"U",\u1EE6:"U",\u016E:"U",\u0170:"U",\u01D3:"U",\u0214:"U",\u0216:"U",\u01AF:"U",\u1EEA:"U",\u1EE8:"U",\u1EEE:"U",\u1EEC:"U",\u1EF0:"U",\u1EE4:"U",\u1E72:"U",\u0172:"U",\u1E76:"U",\u1E74:"U","\u0244":"U","\u24CB":"V",\uFF36:"V",\u1E7C:"V",\u1E7E:"V",\u01B2:"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W",\uFF37:"W",\u1E80:"W",\u1E82:"W",\u0174:"W",\u1E86:"W",\u1E84:"W",\u1E88:"W","\u2C72":"W","\u24CD":"X",\uFF38:"X",\u1E8A:"X",\u1E8C:"X","\u24CE":"Y",\uFF39:"Y",\u1EF2:"Y",\u00DD:"Y",\u0176:"Y",\u1EF8:"Y",\u0232:"Y",\u1E8E:"Y",\u0178:"Y",\u1EF6:"Y",\u1EF4:"Y",\u01B3:"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z",\uFF3A:"Z",\u0179:"Z",\u1E90:"Z",\u017B:"Z",\u017D:"Z",\u1E92:"Z",\u1E94:"Z",\u01B5:"Z",\u0224:"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a",\uFF41:"a",\u1E9A:"a",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u1EA7:"a",\u1EA5:"a",\u1EAB:"a",\u1EA9:"a",\u00E3:"a",\u0101:"a",\u0103:"a",\u1EB1:"a",\u1EAF:"a",\u1EB5:"a",\u1EB3:"a",\u0227:"a",\u01E1:"a",\u00E4:"a",\u01DF:"a",\u1EA3:"a",\u00E5:"a",\u01FB:"a",\u01CE:"a",\u0201:"a",\u0203:"a",\u1EA1:"a",\u1EAD:"a",\u1EB7:"a",\u1E01:"a",\u0105:"a","\u2C65":"a",\u0250:"a","\uA733":"aa",\u00E6:"ae",\u01FD:"ae",\u01E3:"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b",\uFF42:"b",\u1E03:"b",\u1E05:"b",\u1E07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24D2":"c",\uFF43:"c",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u00E7:"c",\u1E09:"c",\u0188:"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d",\uFF44:"d",\u1E0B:"d",\u010F:"d",\u1E0D:"d",\u1E11:"d",\u1E13:"d",\u1E0F:"d",\u0111:"d",\u018C:"d",\u0256:"d",\u0257:"d","\uA77A":"d",\u01F3:"dz",\u01C6:"dz","\u24D4":"e",\uFF45:"e",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u1EC1:"e",\u1EBF:"e",\u1EC5:"e",\u1EC3:"e",\u1EBD:"e",\u0113:"e",\u1E15:"e",\u1E17:"e",\u0115:"e",\u0117:"e",\u00EB:"e",\u1EBB:"e",\u011B:"e",\u0205:"e",\u0207:"e",\u1EB9:"e",\u1EC7:"e",\u0229:"e",\u1E1D:"e",\u0119:"e",\u1E19:"e",\u1E1B:"e","\u0247":"e",\u025B:"e",\u01DD:"e","\u24D5":"f",\uFF46:"f",\u1E1F:"f",\u0192:"f","\uA77C":"f","\u24D6":"g",\uFF47:"g",\u01F5:"g",\u011D:"g",\u1E21:"g",\u011F:"g",\u0121:"g",\u01E7:"g",\u0123:"g",\u01E5:"g",\u0260:"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h",\uFF48:"h",\u0125:"h",\u1E23:"h",\u1E27:"h",\u021F:"h",\u1E25:"h",\u1E29:"h",\u1E2B:"h",\u1E96:"h",\u0127:"h","\u2C68":"h","\u2C76":"h",\u0265:"h",\u0195:"hv","\u24D8":"i",\uFF49:"i",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u0129:"i",\u012B:"i",\u012D:"i",\u00EF:"i",\u1E2F:"i",\u1EC9:"i",\u01D0:"i",\u0209:"i",\u020B:"i",\u1ECB:"i",\u012F:"i",\u1E2D:"i",\u0268:"i",\u0131:"i","\u24D9":"j",\uFF4A:"j",\u0135:"j",\u01F0:"j","\u0249":"j","\u24DA":"k",\uFF4B:"k",\u1E31:"k",\u01E9:"k",\u1E33:"k",\u0137:"k",\u1E35:"k",\u0199:"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l",\uFF4C:"l",\u0140:"l",\u013A:"l",\u013E:"l",\u1E37:"l",\u1E39:"l",\u013C:"l",\u1E3D:"l",\u1E3B:"l",\u017F:"l",\u0142:"l",\u019A:"l",\u026B:"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l",\u01C9:"lj","\u24DC":"m",\uFF4D:"m",\u1E3F:"m",\u1E41:"m",\u1E43:"m",\u0271:"m",\u026F:"m","\u24DD":"n",\uFF4E:"n",\u01F9:"n",\u0144:"n",\u00F1:"n",\u1E45:"n",\u0148:"n",\u1E47:"n",\u0146:"n",\u1E4B:"n",\u1E49:"n",\u019E:"n",\u0272:"n",\u0149:"n","\uA791":"n","\uA7A5":"n",\u01CC:"nj","\u24DE":"o",\uFF4F:"o",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u1ED3:"o",\u1ED1:"o",\u1ED7:"o",\u1ED5:"o",\u00F5:"o",\u1E4D:"o",\u022D:"o",\u1E4F:"o",\u014D:"o",\u1E51:"o",\u1E53:"o",\u014F:"o",\u022F:"o",\u0231:"o",\u00F6:"o",\u022B:"o",\u1ECF:"o",\u0151:"o",\u01D2:"o",\u020D:"o",\u020F:"o",\u01A1:"o",\u1EDD:"o",\u1EDB:"o",\u1EE1:"o",\u1EDF:"o",\u1EE3:"o",\u1ECD:"o",\u1ED9:"o",\u01EB:"o",\u01ED:"o",\u00F8:"o",\u01FF:"o",\u0254:"o","\uA74B":"o","\uA74D":"o",\u0275:"o",\u01A3:"oi",\u0223:"ou","\uA74F":"oo","\u24DF":"p",\uFF50:"p",\u1E55:"p",\u1E57:"p",\u01A5:"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q",\uFF51:"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r",\uFF52:"r",\u0155:"r",\u1E59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1E5B:"r",\u1E5D:"r",\u0157:"r",\u1E5F:"r","\u024D":"r",\u027D:"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s",\uFF53:"s",\u00DF:"s",\u015B:"s",\u1E65:"s",\u015D:"s",\u1E61:"s",\u0161:"s",\u1E67:"s",\u1E63:"s",\u1E69:"s",\u0219:"s",\u015F:"s","\u023F":"s","\uA7A9":"s","\uA785":"s",\u1E9B:"s","\u24E3":"t",\uFF54:"t",\u1E6B:"t",\u1E97:"t",\u0165:"t",\u1E6D:"t",\u021B:"t",\u0163:"t",\u1E71:"t",\u1E6F:"t",\u0167:"t",\u01AD:"t",\u0288:"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u",\uFF55:"u",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u0169:"u",\u1E79:"u",\u016B:"u",\u1E7B:"u",\u016D:"u",\u00FC:"u",\u01DC:"u",\u01D8:"u",\u01D6:"u",\u01DA:"u",\u1EE7:"u",\u016F:"u",\u0171:"u",\u01D4:"u",\u0215:"u",\u0217:"u",\u01B0:"u",\u1EEB:"u",\u1EE9:"u",\u1EEF:"u",\u1EED:"u",\u1EF1:"u",\u1EE5:"u",\u1E73:"u",\u0173:"u",\u1E77:"u",\u1E75:"u",\u0289:"u","\u24E5":"v",\uFF56:"v",\u1E7D:"v",\u1E7F:"v",\u028B:"v","\uA75F":"v",\u028C:"v","\uA761":"vy","\u24E6":"w",\uFF57:"w",\u1E81:"w",\u1E83:"w",\u0175:"w",\u1E87:"w",\u1E85:"w",\u1E98:"w",\u1E89:"w","\u2C73":"w","\u24E7":"x",\uFF58:"x",\u1E8B:"x",\u1E8D:"x","\u24E8":"y",\uFF59:"y",\u1EF3:"y",\u00FD:"y",\u0177:"y",\u1EF9:"y",\u0233:"y",\u1E8F:"y",\u00FF:"y",\u1EF7:"y",\u1E99:"y",\u1EF5:"y",\u01B4:"y","\u024F":"y","\u1EFF":"y","\u24E9":"z",\uFF5A:"z",\u017A:"z",\u1E91:"z",\u017C:"z",\u017E:"z",\u1E93:"z",\u1E95:"z",\u01B6:"z",\u0225:"z","\u0240":"z","\u2C6C":"z","\uA763":"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038A:"\u0399",\u03AA:"\u0399",\u038C:"\u039F",\u038E:"\u03A5",\u03AB:"\u03A5",\u038F:"\u03A9",\u03AC:"\u03B1",\u03AD:"\u03B5",\u03AE:"\u03B7",\u03AF:"\u03B9",\u03CA:"\u03B9",\u0390:"\u03B9",\u03CC:"\u03BF",\u03CD:"\u03C5",\u03CB:"\u03C5",\u03B0:"\u03C5",\u03C9:"\u03C9",\u03C2:"\u03C3"},o.fnOperators={equal:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?o.toLowerCase(t)===o.toLowerCase(e):t===e},notequal:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),!o.fnOperators.equal(t,e,i)},lessthan:function(t,e,i){return i?o.toLowerCase(t)<o.toLowerCase(e):(g(t)&&(t=void 0),t<e)},greaterthan:function(t,e,i){return i?o.toLowerCase(t)>o.toLowerCase(e):(g(t)&&(t=void 0),t>e)},lessthanorequal:function(t,e,i){return i?o.toLowerCase(t)<=o.toLowerCase(e):(g(t)&&(t=void 0),t<=e)},greaterthanorequal:function(t,e,i){return i?o.toLowerCase(t)>=o.toLowerCase(e):t>=e},contains:function(t,e,i,r){return e===""?!0:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?!g(t)&&!g(e)&&o.toLowerCase(t).indexOf(o.toLowerCase(e))!==-1:!g(t)&&!g(e)&&t.toString().indexOf(e)!==-1)},doesnotcontain:function(t,e,i,r){return e===""?!1:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?!g(t)&&!g(e)&&o.toLowerCase(t).indexOf(o.toLowerCase(e))===-1:!g(t)&&!g(e)&&t.toString().indexOf(e)===-1)},isnotnull:function(t){return t!=null},isnull:function(t){return t==null},startswith:function(t,e,i,r){return e===""?!0:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?t&&e&&o.startsWith(o.toLowerCase(t),o.toLowerCase(e)):t&&e&&o.startsWith(t,e))},doesnotstartwith:function(t,e,i,r){return e===""?!1:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?t&&e&&o.notStartsWith(o.toLowerCase(t),o.toLowerCase(e)):t&&e&&o.notStartsWith(t,e))},like:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?t&&e&&o.like(o.toLowerCase(t),o.toLowerCase(e)):t&&e&&o.like(t,e)},isempty:function(t){return t===void 0||t===""},isnotempty:function(t){return t!==void 0&&t!==""},wildcard:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?(t||typeof t=="boolean")&&e&&typeof t!="object"&&o.wildCard(o.toLowerCase(t),o.toLowerCase(e)):(t||typeof t=="boolean")&&e&&o.wildCard(t,e)},endswith:function(t,e,i,r){return e===""?!0:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?t&&e&&o.endsWith(o.toLowerCase(t),o.toLowerCase(e)):t&&e&&o.endsWith(t,e))},doesnotendwith:function(t,e,i,r){return e===""?!1:(r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacritics(e)),i?t&&e&&o.notEndsWith(o.toLowerCase(t),o.toLowerCase(e)):t&&e&&o.notEndsWith(t,e))},processSymbols:function(t){var e=o.operatorSymbols[t];if(e){var i=o.fnOperators[e];return i}return o.throwError("Query - Process Operator : Invalid operator")},processOperator:function(t){var e=o.fnOperators[t];return e||o.fnOperators.processSymbols(t)},in:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacriticsForArrays(e)),i?!g(t)&&e&&e.length>0&&e.map(function(n){return o.toLowerCase(n)}).indexOf(o.toLowerCase(t))>-1:t instanceof Date?!g(t)&&e&&e.length>0&&Array.isArray(e)&&e.some(function(n){return n instanceof Date&&n.getTime()===t.getTime()}):!g(t)&&e&&e.length>0&&e.indexOf(t)>-1},notin:function(t,e,i,r){return r&&(t=o.ignoreDiacritics(t),e=o.ignoreDiacriticsForArrays(e)),i?!g(t)&&e&&e.length>0&&e.map(function(n){return o.toLowerCase(n)}).indexOf(o.toLowerCase(t))===-1:t instanceof Date?!g(t)&&e&&e.length>0&&Array.isArray(e)&&e.every(function(n){return!(n instanceof Date)||n.getTime()!==t.getTime()}):!g(t)&&e&&e.length>0&&e.indexOf(t)===-1}},o.parse={parseJson:function(t){return typeof t=="string"&&(/^[\s]*\[|^[\s]*\{[^:]+:/.test(t)||t.indexOf('"')===-1)?t=JSON.parse(t,o.parse.jsonReviver):t instanceof Array?o.parse.iterateAndReviveArray(t):typeof t=="object"&&t!==null&&o.parse.iterateAndReviveJson(t),t},iterateAndReviveArray:function(t){for(var e=0;e<t.length;e++)typeof t[e]=="object"&&t[e]!==null?o.parse.iterateAndReviveJson(t[e]):typeof t[e]=="string"&&(!/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[e])||t[e].toString().indexOf('"')===-1)?t[e]=o.parse.jsonReviver("",t[e]):t[e]=o.parse.parseJson(t[e])},iterateAndReviveJson:function(t){for(var e,i=Object.keys(t),r=0,n=i;r<n.length;r++){var s=n[r];o.startsWith(s,"__")||(e=t[s],typeof e=="object"?e instanceof Array?o.parse.iterateAndReviveArray(e):e&&o.parse.iterateAndReviveJson(e):t[s]=o.parse.jsonReviver(t[s],e))}},jsonReviver:function(t,e){if(typeof e=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(e),r=o.timeZoneHandling?o.serverTimezoneOffset:null;if(i)return o.dateParse.toTimeZone(new Date(parseInt(i[1],10)),r,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(e)){var n=e.indexOf("Z")>-1||e.indexOf("z")>-1,s=e.split(/[^0-9.]/);if(n){if(s[5].indexOf(".")>-1){var a=s[5].split(".");s[5]=a[0],s[6]=new Date(e).getUTCMilliseconds().toString()}else s[6]="00";e=o.dateParse.toTimeZone(new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5]?s[5]:"00",10),parseInt(s[6],10)),o.serverTimezoneOffset,!1)}else{var l=new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5]?s[5]:"00",10)),h=parseInt(s[6],10),c=parseInt(s[7],10);if(isNaN(h)&&isNaN(c))return l;e.indexOf("+")>-1?l.setHours(l.getHours()-h,l.getMinutes()-c):l.setHours(l.getHours()+h,l.getMinutes()+c),e=o.dateParse.toTimeZone(l,o.serverTimezoneOffset,!1)}o.serverTimezoneOffset==null&&(e=o.dateParse.addSelfOffset(e))}}return e},isJson:function(t){return typeof t[0]=="string"?t:o.parse.parseJson(t)},isGuid:function(t){var e=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i,i=e.exec(t);return i!=null},replacer:function(t,e){return o.isPlainObject(t)?o.parse.jsonReplacer(t,e):t instanceof Array?o.parse.arrayReplacer(t):t instanceof Date?o.parse.jsonReplacer({val:t},e).val:t},jsonReplacer:function(t,e){for(var i,r=Object.keys(t),n=0,s=r;n<s.length;n++){var a=s[n];if(i=t[a],i instanceof Date){var l=i;o.serverTimezoneOffset==null?t[a]=o.dateParse.toTimeZone(l,null).toJSON():(l=new Date(+l+o.serverTimezoneOffset*36e5),t[a]=o.dateParse.toTimeZone(o.dateParse.addSelfOffset(l),null).toJSON())}}return t},arrayReplacer:function(t){for(var e=0;e<t.length;e++)o.isPlainObject(t[e])?t[e]=o.parse.jsonReplacer(t[e]):t[e]instanceof Date&&(t[e]=o.parse.jsonReplacer({date:t[e]}).date);return t},jsonDateReplacer:function(t,e){if(t==="value"&&e){if(typeof e=="string"){var i=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(e);if(i)e=o.dateParse.toTimeZone(new Date(parseInt(i[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(e)){var r=e.split(/[^0-9]/);e=o.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),null,!0)}}if(e instanceof Date)return e=o.dateParse.addSelfOffset(e),o.serverTimezoneOffset===null?o.dateParse.toTimeZone(o.dateParse.addSelfOffset(e),null).toJSON():(e=o.dateParse.toTimeZone(e,e.getTimezoneOffset()/60-o.serverTimezoneOffset,!1),e.toJSON())}return e}},o.dateParse={addSelfOffset:function(t){return new Date(+t-t.getTimezoneOffset()*6e4)},toUTC:function(t){return new Date(+t+t.getTimezoneOffset()*6e4)},toTimeZone:function(t,e,i){if(e===null)return t;var r=i?o.dateParse.toUTC(t):t;return new Date(+r-e*36e5)},toLocalTime:function(t){var e=t,i=-e.getTimezoneOffset(),r=i>=0?"+":"-",n=function(a){var l=Math.floor(Math.abs(a));return(l<10?"0":"")+l},s=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+r+n(i/60)+":"+n(i%60);return s}},o})(),Ru=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Z4={GroupGuid:"{271bbba0-1ee7}"},KL=(function(){function o(t){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=o,this.dataSource=t,this.pvt={}}return o.prototype.processResponse=function(t,e,i,r){return t},o})(),Qp=(function(o){Ru(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.processQuery=function(e,i){for(var r=e.dataSource.json.slice(0),n=r.length,s=!0,a,l,h={},c=0,u=[],d=[],p,f=0;f<i.lazyLoad.length;f++)c++,h[i.lazyLoad[f].key]=i.lazyLoad[f].value;var v={},m=!1;if(i.lazyLoad.length){for(var f=0;f<i.queries.length;f++)if(l=i.queries[f],l.fn==="onGroup"&&!g(l.e.format)){m=!0;break}}for(var f=0;f<i.queries.length;f++){if(l=i.queries[f],(l.fn==="onPage"||l.fn==="onGroup"||l.fn==="onSortBy"&&!m)&&i.lazyLoad.length){l.fn==="onGroup"&&u.push(l.e),l.fn==="onPage"&&(p=l.e),l.fn==="onSortBy"&&d.unshift(l.e);continue}a=this[l.fn].call(this,r,l.e,i),l.fn==="onAggregates"?v[l.e.field+" - "+l.e.type]=a:r=a!==void 0?a:r,(l.fn==="onPage"||l.fn==="onSkip"||l.fn==="onTake"||l.fn==="onRange")&&(s=!1),s&&(n=r.length)}if(c){var y={query:i,lazyLoad:h,result:r,group:u,page:p,sort:d},b=this.lazyLoadGroup(y);r=b.result,n=b.count}return i.isCountRequired&&(r={result:r,count:n,aggregates:v}),r},t.prototype.lazyLoadGroup=function(e){var i=0,r=this.getAggregate(e.query),n=e.result;if(g(e.lazyLoad.onDemandGroupInfo)){var c=e.group[0].fieldName;n=ge.group(n,c,r,null,null,e.group[0].comparer,!0),i=n.length;var h=n;if(e.sort.length){var u=e.sort.length>1?e.sort.filter(function(p){return p.fieldName===c})[0]:e.sort[0];n=this.onSortBy(n,u,e.query,!0)}e.page&&(n=this.onPage(n,e.page,e.query)),this.formGroupResult(n,h)}else{for(var s=e.lazyLoad.onDemandGroupInfo,a=s.where.length-1;a>=0;a--)n=this.onWhere(n,s.where[a]);if(e.group.length!==s.level){var l=e.group[s.level].fieldName;n=ge.group(n,l,r,null,null,e.group[s.level].comparer,!0),e.sort.length&&(n=this.onSortBy(n,e.sort[parseInt(s.level.toString(),10)],e.query,!0))}else for(var a=e.sort.length-1;a>=s.level;a--)n=this.onSortBy(n,e.sort[parseInt(a.toString(),10)],e.query,!1);i=n.length;var h=n;n=n.slice(s.skip),n=n.slice(0,s.take),e.group.length!==s.level&&this.formGroupResult(n,h)}return{result:n,count:i}},t.prototype.formGroupResult=function(e,i){if(e.length&&i.length){var r="GroupGuid",n="childLevels",s="level",a="records";e[r]=i[r],e[n]=i[n],e[s]=i[s],e[a]=i[a]}return e},t.prototype.getAggregate=function(e){var i=Pe.filterQueries(e.queries,"onAggregates"),r=[];if(i.length)for(var n=void 0,s=0;s<i.length;s++)n=i[s].e,r.push({type:n.type,field:ge.getValue(n.field,e)});return r},t.prototype.batchRequest=function(e,i,r){var n,s=i.deletedRecords.length;for(n=0;n<i.addedRecords.length;n++)this.insert(e,i.addedRecords[n]);for(n=0;n<i.changedRecords.length;n++)this.update(e,r.key,i.changedRecords[n]);for(n=0;n<s;n++)this.remove(e,r.key,i.deletedRecords[n]);return i},t.prototype.onWhere=function(e,i){return!e||!e.length?e:e.filter(function(r){if(i)return i.validate(r)})},t.prototype.onAggregates=function(e,i){var r=ge.aggregates[i.type];return!e||!r||e.length===0?null:r(e,i.field)},t.prototype.onSearch=function(e,i){return!e||!e.length?e:(i.fieldNames.length===0&&ge.getFieldList(e[0],i.fieldNames),e.filter(function(r){for(var n=0;n<i.fieldNames.length;n++)if(i.comparer.call(r,ge.getObject(i.fieldNames[n],r),i.searchKey,i.ignoreCase,i.ignoreAccent))return!0;return!1}))},t.prototype.onSortBy=function(e,i,r,n){if(!e||!e.length)return e;var s,a=ge.getValue(i.fieldName,r);if(!a)return e.sort(i.comparer);if(a instanceof Array){a=a.slice(0);for(var l=a.length-1;l>=0;l--)a[l]&&(s=i.comparer,ge.endsWith(a[l]," desc")&&(s=ge.fnSort("descending"),a[l]=a[l].replace(" desc","")),e=ge.sort(e,a[l],s));return e}return ge.sort(e,n?"key":a,i.comparer)},t.prototype.onGroup=function(e,i,r){if(!e||!e.length)return e;var n=this.getAggregate(r);return ge.group(e,ge.getValue(i.fieldName,r),n,null,null,i.comparer)},t.prototype.onPage=function(e,i,r){var n=ge.getValue(i.pageSize,r),s=(ge.getValue(i.pageIndex,r)-1)*n,a=s+n;return!e||!e.length?e:e.slice(s,a)},t.prototype.onRange=function(e,i){return!e||!e.length?e:e.slice(ge.getValue(i.start),ge.getValue(i.end))},t.prototype.onTake=function(e,i){return!e||!e.length?e:e.slice(0,ge.getValue(i.nos))},t.prototype.onSkip=function(e,i){return!e||!e.length?e:e.slice(ge.getValue(i.nos))},t.prototype.onSelect=function(e,i){return!e||!e.length?e:ge.select(e,ge.getValue(i.fieldNames))},t.prototype.insert=function(e,i,r,n,s){return g(s)?e.dataSource.json.push(i):e.dataSource.json.splice(s,0,i)},t.prototype.remove=function(e,i,r,n){var s=e.dataSource.json,a;for(typeof r=="object"&&!(r instanceof Date)&&(r=ge.getObject(i,r)),a=0;a<s.length&&ge.getObject(i,s[a])!==r;a++);return a!==s.length?s.splice(a,1):null},t.prototype.update=function(e,i,r,n){var s=e.dataSource.json,a,l;for(g(i)||(l=V(i,r)),a=0;a<s.length&&!(!g(i)&&V(i,s[a])===l);a++);return a<s.length?mt(s[a],r):null},t})(KL),hc=(function(o){Ru(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.processQuery=function(e,i,r){var n=this.getQueryRequest(i),s=Pe.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=i.params,l=e.dataSource.url,h,c,u=null,d=this.options,p={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in s?(h=s.onPage,c=ge.getValue(h.pageIndex,i),u=ge.getValue(h.pageSize,i),c=(c-1)*u):"onRange"in s&&(h=s.onRange,c=h.start,u=h.end-h.start);for(var f=0;f<n.sorts.length;f++)h=ge.getValue(n.sorts[f].e.fieldName,i),p.sorts.push(ge.callAdaptorFunction(this,"onEachSort",{name:h,direction:n.sorts[f].e.direction},i));r&&(h=this.getFiltersFrom(r,i),h&&p.filters.push(ge.callAdaptorFunction(this,"onEachWhere",h.toJson(),i)));for(var f=0;f<n.filters.length;f++){var v=ge.callAdaptorFunction(this,"onEachWhere",n.filters[f].e.toJson(),i);this.getModuleName&&this.getModuleName()==="ODataV4Adaptor"&&!g(n.filters[f].e.key)&&n.filters.length>1&&(v="("+v+")"),p.filters.push(v);for(var m=typeof p.filters[f]=="object"?Object.keys(p.filters[f]):[],y=0,b=m;y<b.length;y++){var S=b[y];ge.isNull(p[S])&&delete p[S]}}for(var f=0;f<n.searches.length;f++)h=n.searches[f].e,p.searches.push(ge.callAdaptorFunction(this,"onEachSearch",{fields:h.fieldNames,operator:h.operator,key:h.searchKey,ignoreCase:h.ignoreCase,ignoreAccent:h.ignoreAccent},i));for(var f=0;f<n.groups.length;f++)p.groups.push(ge.getValue(n.groups[f].e.fieldName,i));for(var f=0;f<n.aggregates.length;f++)h=n.aggregates[f].e,p.aggregates.push({type:h.type,field:ge.getValue(h.field,i)});var C={};if(this.getRequestQuery(d,i,s,p,C),ge.callAdaptorFunction(this,"addParams",{dm:e,query:i,params:a,reqParams:C}),i.lazyLoad.length)for(var f=0;f<i.lazyLoad.length;f++)C[i.lazyLoad[f].key]=i.lazyLoad[f].value;for(var x=Object.keys(C),I=0,D=x;I<D.length;I++){var S=D[I];(ge.isNull(C[S])||C[S]===""||C[S].length===0)&&delete C[S]}!(d.skip in C&&d.take in C)&&u!==null&&(C[d.skip]=ge.callAdaptorFunction(this,"onSkip",c,i),C[d.take]=ge.callAdaptorFunction(this,"onTake",u,i));var M=this.pvt;return this.pvt={},this.options.requestType==="json"?{data:JSON.stringify(C,ge.parse.jsonDateReplacer),url:l,pvtData:M,type:"POST",contentType:"application/json; charset=utf-8"}:(h=this.convertToQueryString(C,i,e),h=(e.dataSource.url.indexOf("?")!==-1?"&":"/")+h,{type:"GET",url:h.length?l.replace(/\/*$/,h):l,pvtData:M})},t.prototype.getRequestQuery=function(e,i,r,n,s){var a="param",l=s;l[e.from]=i.fromTable,e.apply&&i.distincts.length&&(l[e.apply]="onDistinct"in this?ge.callAdaptorFunction(this,"onDistinct",i.distincts):""),!i.distincts.length&&e.expand&&(l[e.expand]="onExpand"in this&&"onSelect"in r?ge.callAdaptorFunction(this,"onExpand",{selects:ge.getValue(r.onSelect.fieldNames,i),expands:i.expands},i):i.expands),l[e.select]="onSelect"in r&&!i.distincts.length?ge.callAdaptorFunction(this,"onSelect",ge.getValue(r.onSelect.fieldNames,i),i):"",l[e.count]=i.isCountRequired?ge.callAdaptorFunction(this,"onCount",i.isCountRequired,i):"",l[e.search]=n.searches.length?ge.callAdaptorFunction(this,"onSearch",n.searches,i):"",l[e.skip]="onSkip"in r?ge.callAdaptorFunction(this,"onSkip",ge.getValue(r.onSkip.nos,i),i):"",l[e.take]="onTake"in r?ge.callAdaptorFunction(this,"onTake",ge.getValue(r.onTake.nos,i),i):"",l[e.where]=n.filters.length||n.searches.length?ge.callAdaptorFunction(this,"onWhere",n.filters,i):"",l[e.sortBy]=n.sorts.length?ge.callAdaptorFunction(this,"onSortBy",n.sorts,i):"",l[e.group]=n.groups.length?ge.callAdaptorFunction(this,"onGroup",n.groups,i):"",l[e.aggregates]=n.aggregates.length?ge.callAdaptorFunction(this,"onAggregates",n.aggregates,i):"",l[a]=[]},t.prototype.convertToQueryString=function(e,i,r){return""},t.prototype.processResponse=function(e,i,r,n,s,a){if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("application/json")!==-1){var l=ge.timeZoneHandling;i&&!i.timeZoneHandling&&(ge.timeZoneHandling=!1),i.enableCache||(e=ge.parse.parseJson(e)),ge.timeZoneHandling=l}var h=s,c=h.pvtData||{},u=e?e.groupDs:[];if(n&&n.headers.get("Content-Type")&&n.headers.get("Content-Type").indexOf("xml")!==-1)return r.isCountRequired?{result:[],count:0}:[];var d=JSON.parse(h.data);if(d&&d.action==="batch"&&e&&e.addedRecords&&!g(a))return a.addedRecords=e.addedRecords,a;e&&e.d&&(e=e.d);var p={};e&&"count"in e&&(p.count=e.count),p.result=e&&e.result?e.result:e;var f=!1;if(Array.isArray(e.result)&&e.result.length){var v="key",m="value",y="level";if(g(e.result[0][v])||(p.result=this.formRemoteGroupedData(p.result,1,c.groups.length-1)),r&&r.lazyLoad.length&&c.groups.length){for(var b=0;b<r.lazyLoad.length;b++)if(r.lazyLoad[b][v]==="onDemandGroupInfo"){var S=r.lazyLoad[b][m][y];c.groups.length===S&&(f=!0)}}}return f||this.getAggregateResult(c,e,p,u,r),ge.isNull(p.count)?p.result:{result:p.result,count:p.count,aggregates:p.aggregates}},t.prototype.formRemoteGroupedData=function(e,i,r){for(var n=0;n<e.length;n++)e[n].items.length&&Object.keys(e[n].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[n].items,i+1,r-1);var s="GroupGuid",a="childLevels",l="level",h="records";return e[s]=Z4[s],e[l]=i,e[a]=r,e[h]=e[0].items.length?this.getGroupedRecords(e,!g(e[0].items[h])):[],e},t.prototype.getGroupedRecords=function(e,i){for(var r=[],n="records",s=0;s<e.length;s++)if(i)r=r.concat(e[s].items[n]);else for(var a=0;a<e[s].items.length;a++)r.push(e[s].items[a]);return r},t.prototype.onGroup=function(e){return this.pvt.groups=e,e},t.prototype.onAggregates=function(e){this.pvt.aggregates=e},t.prototype.batchRequest=function(e,i,r,n,s){var a,l;return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(pe({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r[a],key:r[l]},ge.getAddParams(this,e,n)))}},t.prototype.beforeSend=function(e,i,r){},t.prototype.insert=function(e,i,r,n){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{value:i,table:r,action:"insert"},ge.getAddParams(this,e,n)))}},t.prototype.remove=function(e,i,r,n,s){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{key:r,keyColumn:i,table:n,action:"remove"},ge.getAddParams(this,e,s)))}},t.prototype.update=function(e,i,r,n,s){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{value:r,action:"update",keyColumn:i,key:ge.getObject(i,r),table:n},ge.getAddParams(this,e,s)))}},t.prototype.getFiltersFrom=function(e,i){var r=i.fKey,n,s=r,a=i.key,l=[];typeof e[0]!="object"&&(s=null);for(var h=0;h<e.length;h++)typeof e[0]=="object"?n=ge.getObject(a||s,e[h]):n=e[h],l.push(new xt(r,"equal",n));return xt.or(l)},t.prototype.getAggregateResult=function(e,i,r,n,s){var a=i;if(i&&i.result&&(a=i.result),e&&e.aggregates&&e.aggregates.length){var l=e.aggregates,h=void 0,c=a,u={};i.aggregate&&(c=i.aggregate);for(var d=0;d<l.length;d++)h=ge.aggregates[l[d].type],h&&(u[l[d].field+" - "+l[d].type]=h(c,l[d].field));r.aggregates=u}var p="key",f=Array.isArray(i.result)&&i.result.length&&!g(i.result[0][p]);if(e&&e.groups&&e.groups.length&&!f){for(var v=e.groups,d=0;d<v.length;d++){var m=null;g(n)||(n=ge.group(n,v[d]));var y=Pe.filterQueries(s.queries,"onGroup")[d].e;a=ge.group(a,v[d],e.aggregates,m,n,y.comparer)}r.result=a}return r},t.prototype.getQueryRequest=function(e){var i={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return i.sorts=Pe.filterQueries(e.queries,"onSortBy"),i.groups=Pe.filterQueries(e.queries,"onGroup"),i.filters=Pe.filterQueries(e.queries,"onWhere"),i.searches=Pe.filterQueries(e.queries,"onSearch"),i.aggregates=Pe.filterQueries(e.queries,"onAggregates"),i},t.prototype.addParams=function(e){var i=e.reqParams;e.params.length&&(i.params={});for(var r=0,n=e.params;r<n.length;r++){var s=n[r];if(i[s.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");i[s.key]=s.value,s.fn&&(i[s.key]=s.fn.call(e.query,s.key,e.query,e.dm)),i.params[s.key]=i[s.key]}},t})(KL),Bw=(function(o){Ru(t,o);function t(e){var i=o.call(this)||this;return i.options=pe({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),pe(i.options,e||{}),i}return t.prototype.getModuleName=function(){return"ODataAdaptor"},t.prototype.onPredicate=function(e,i,r){var n="",s,a,l=e.value,h=typeof l,c=e.field?t.getField(e.field):null;if(l instanceof Date&&(l="datetime'"+ge.parse.replacer(l)+"'"),h==="string"&&(l=l.replace(/'/g,"''"),e.ignoreCase&&(l=l.toLowerCase()),e.operator!=="like"&&(l=encodeURIComponent(l)),e.operator!=="wildcard"&&e.operator!=="like"&&(l="'"+l+"'"),r&&(c="cast("+c+", 'Edm.String')"),ge.parse.isGuid(l)&&(a="guid"),e.ignoreCase&&(a||(c="tolower("+c+")"),l=l.toLowerCase())),e.operator==="isempty"||e.operator==="isnull"||e.operator==="isnotempty"||e.operator==="isnotnull"?(s=e.operator.indexOf("isnot")!==-1?ge.odBiOperator.notequal:ge.odBiOperator.equal,l=e.operator==="isnull"||e.operator==="isnotnull"?null:"''"):s=ge.odBiOperator[e.operator],s)return n+=c,n+=s,a&&(n+=a),n+l;if(!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?s=ge.odv4UniOperator[e.operator]:s=ge.odUniOperator[e.operator],s==="like")l=l,l.indexOf("%")!==-1&&(l.charAt(0)==="%"&&l.lastIndexOf("%")<2?(l=l.substring(1,l.length),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.startswith:ge.odUniOperator.startswith):l.charAt(l.length-1)==="%"&&l.indexOf("%")>l.length-3?(l=l.substring(0,l.length-1),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.endswith:ge.odUniOperator.endswith):l.lastIndexOf("%")!==l.indexOf("%")&&l.lastIndexOf("%")>l.indexOf("%")+1?(l=l.substring(l.indexOf("%")+1,l.lastIndexOf("%")),s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.contains:ge.odUniOperator.contains):s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.contains:ge.odUniOperator.contains),l=encodeURIComponent(l),l="'"+l+"'";else if(s==="wildcard")if(l=l,l.indexOf("*")!==-1){var u=l.split("*"),d=void 0,p=0;if(l.indexOf("*")!==0&&u[0].indexOf("%3f")===-1&&u[0].indexOf("?")===-1&&(d=u[0],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.startswith:ge.odUniOperator.startswith,n+=s+"(",n+=c+",",a&&(n+=a),n+=d+")",p++),l.lastIndexOf("*")!==l.length-1&&u[u.length-1].indexOf("%3f")===-1&&u[u.length-1].indexOf("?")===-1&&(d=u[u.length-1],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.endswith:ge.odUniOperator.endswith,p>0&&(n+=" and "),n+=s+"(",n+=c+",",a&&(n+=a),n+=d+")",p++),u.length>2){for(var f=1;f<u.length-1;f++)if(u[f].indexOf("%3f")===-1&&u[f].indexOf("?")===-1){if(d=u[f],d="'"+d+"'",s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.contains:ge.odUniOperator.contains,p>0&&(n+=" and "),s==="substringof"||s==="not substringof"){var v=d;d=c,c=v}n+=s+"(",n+=c+",",a&&(n+=a),n+=d+")",p++}}p===0?(s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.contains:ge.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'"):s="wildcard"}else s=!g(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?ge.odv4UniOperator.contains:ge.odUniOperator.contains,(l.indexOf("?")!==-1||l.indexOf("%3f")!==-1)&&(l=l.indexOf("?")!==-1?l.split("?").join(""):l.split("%3f").join("")),l="'"+l+"'";if(s==="substringof"||s==="not substringof"){var v=l;l=c,c=v}return s!=="wildcard"&&(n+=s+"(",n+=c+",",a&&(n+=a),n+=l+")"),n},t.prototype.addParams=function(e){o.prototype.addParams.call(this,e),delete e.reqParams.params},t.prototype.onComplexPredicate=function(e,i,r){for(var n=[],s=0;s<e.predicates.length;s++)n.push("("+this.onEachWhere(e.predicates[s],i,r)+")");return n.join(" "+e.condition+" ")},t.prototype.onEachWhere=function(e,i,r){return e.isComplex?this.onComplexPredicate(e,i,r):this.onPredicate(e,i,r)},t.prototype.onWhere=function(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")},t.prototype.onEachSearch=function(e){e.fields&&e.fields.length===0&&ge.throwError("Query() - Search : oData search requires list of field names to search");for(var i=this.pvt.search||[],r=0;r<e.fields.length;r++)i.push(new xt(e.fields[r],e.operator,e.key,e.ignoreCase));this.pvt.search=i},t.prototype.onSearch=function(e){return this.pvt.search=xt.or(this.pvt.search),""},t.prototype.onEachSort=function(e){var i=[];if(e.name instanceof Array)for(var r=0;r<e.name.length;r++)i.push(t.getField(e.name[r])+(e.direction==="descending"?" desc":""));else i.push(t.getField(e.name)+(e.direction==="descending"?" desc":""));return i.join(",")},t.prototype.onSortBy=function(e){return e.reverse().join(",")},t.prototype.onGroup=function(e){return this.pvt.groups=e,[]},t.prototype.onSelect=function(e){for(var i=0;i<e.length;i++)e[i]=t.getField(e[i]);return e.join(",")},t.prototype.onAggregates=function(e){return this.pvt.aggregates=e,""},t.prototype.onCount=function(e){return e===!0?"allpages":""},t.prototype.beforeSend=function(e,i,r){ge.endsWith(r.url,this.options.batch)&&r.type.toLowerCase()==="post"?(i.headers.set("Accept",this.options.multipartAccept),i.headers.set("DataServiceVersion","2.0")):i.headers.set("Accept",this.options.accept),i.headers.set("DataServiceVersion","2.0"),i.headers.set("MaxDataServiceVersion","2.0")},t.prototype.processResponse=function(e,i,r,n,s,a){var l="odata.metadata";if(s&&s.type==="GET"&&!this.rootUrl&&e[l]){var h=e[l].split("/$metadata#");this.rootUrl=h[0],this.resourceTableName=h[1]}var c="pvtData";if(!g(e.d)){var u=r&&r.isCountRequired?e.d.results:e.d,d="__metadata";if(!g(u))for(var p=0;p<u.length;p++)g(u[p][d])||delete u[p][d]}var f=s&&s[c],v=this.processBatchResponse(e,r,n,s,a);if(v)return v;var m=n&&s.fetchRequest.headers.get("DataServiceVersion"),y=null,b=m&&parseInt(m,10)||2;if(r&&r.isCountRequired){var S="__count";(e[S]||e["odata.count"])&&(y=e[S]||e["odata.count"]),e.d&&(e=e.d),(e[S]||e["odata.count"])&&(y=e[S]||e["odata.count"])}b===3&&e.value&&(e=e.value),e.d&&(e=e.d),b<3&&e.results&&(e=e.results);var C={};return C.count=y,C.result=e,this.getAggregateResult(f,e,C,null,r),ge.isNull(y)?C.result:{result:C.result,count:C.count,aggregates:C.aggregates}},t.prototype.convertToQueryString=function(e,i,r){var n=[],s="table",a=e[s]||"",l="$format";delete e[s],r.dataSource.requiresFormat&&(e[l]="json");for(var h=Object.keys(e),c=0,u=h;c<u.length;c++){var d=u[c];n.push(d+"="+e[d])}return n=n.join("&"),r.dataSource.url&&r.dataSource.url.indexOf("?")!==-1&&!a?n:n.length?a+"?"+n:a||""},t.prototype.localTimeReplacer=function(e,i){for(var r=0,n=g(i)?[]:Object.keys(i);r<n.length;r++){var s=n[r];i[s]instanceof Date&&(i[s]=ge.dateParse.toLocalTime(i[s]))}return i},t.prototype.insert=function(e,i,r){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null)}},t.prototype.remove=function(e,i,r,n){var s;return typeof r=="string"&&!ge.parse.isGuid(r)?s="('"+r+"')":s="("+r+")",{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+s}},t.prototype.update=function(e,i,r,n,s,a){this.options.updateType==="PATCH"&&!g(a)&&(r=this.compareAndRemove(r,a,i));var l;return typeof r[i]=="string"&&!ge.parse.isGuid(r[i])?l="('"+r[i]+"')":l="("+r[i]+")",{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+l,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},t.prototype.batchRequest=function(e,i,r,n,s){var a=r.guid=ge.getGuid(this.options.batchPre),l=e.dataSource.batchUrl||this.rootUrl?(e.dataSource.batchUrl||this.rootUrl)+"/"+this.options.batch:(e.dataSource.batchUrl||e.dataSource.url).replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;var h={url:r.url,key:r.key,cid:1,cSet:ge.getGuid(this.options.changeSet)},c="--"+a+`
`;return c+="Content-Type: multipart/mixed; boundary="+h.cSet.replace("--","")+`
`,this.pvt.changeSet=0,c+=this.generateInsertRequest(i.addedRecords,h,e),c+=this.generateUpdateRequest(i.changedRecords,h,e,s?s.changedRecords:[]),c+=this.generateDeleteRequest(i.deletedRecords,h,e),c+=h.cSet+`--
`,c+="--"+a+"--",{type:"POST",url:l,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+a,data:c}},t.prototype.generateDeleteRequest=function(e,i,r){if(!e)return"";var n="",s={method:"DELETE ",url:function(a,l,h){var c=ge.getObject(h,a[l]);if(typeof c=="number"||ge.parse.isGuid(c))return"("+c+")";if(c instanceof Date){var u=a[l][h];return"("+u.toJSON()+")"}else return"('"+c+"')"},data:function(a,l){return""}};return n=this.generateBodyContent(e,i,s,r),n+`
`},t.prototype.generateInsertRequest=function(e,i,r){if(!e)return"";var n="",s={method:"POST ",url:function(a,l,h){return""},data:function(a,l){return JSON.stringify(a[l])+`

`}};return n=this.generateBodyContent(e,i,s,r),n},t.prototype.generateUpdateRequest=function(e,i,r,n){var s=this;if(!e)return"";var a="";e.forEach(function(h){return h=s.compareAndRemove(h,n.filter(function(c){return ge.getObject(i.key,c)===ge.getObject(i.key,h)})[0],i.key)});var l={method:this.options.updateType+" ",url:function(h,c,u){if(typeof h[c][u]=="number"||ge.parse.isGuid(h[c][u]))return"("+h[c][u]+")";if(h[c][u]instanceof Date){var d=h[c][u];return"("+d.toJSON()+")"}else return"('"+h[c][u]+"')"},data:function(h,c){return JSON.stringify(h[c])+`

`}};return a=this.generateBodyContent(e,i,l,r),a},t.getField=function(e){return e.replace(/\./g,"/")},t.prototype.generateBodyContent=function(e,i,r,n){for(var s="",a=0;a<e.length;a++)s+=`
`+i.cSet+`
`,s+=this.options.changeSetContent+`

`,s+=r.method,r.method==="POST "?s+=(n.dataSource.insertUrl||n.dataSource.crudUrl||i.url)+r.url(e,a,i.key)+` HTTP/1.1
`:r.method==="PUT "||r.method==="PATCH "?s+=(n.dataSource.updateUrl||n.dataSource.crudUrl||i.url)+r.url(e,a,i.key)+` HTTP/1.1
`:r.method==="DELETE "&&(s+=(n.dataSource.removeUrl||n.dataSource.crudUrl||i.url)+r.url(e,a,i.key)+` HTTP/1.1
`),s+="Accept: "+this.options.accept+`
`,s+="Content-Id: "+this.pvt.changeSet+++`
`,s+=this.options.batchChangeSetContentType+`
`,g(e[a]["@odata.etag"])?s+=`
`:(s+="If-Match: "+e[a]["@odata.etag"]+`

`,delete e[a]["@odata.etag"]),s+=r.data(e,a);return s},t.prototype.processBatchResponse=function(e,i,r,n,s){if(r&&r.headers.get("Content-Type")&&r.headers.get("Content-Type").indexOf("xml")!==-1)return i.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&ge.endsWith(n.url,this.options.batch)&&n.type.toLowerCase()==="post"){var a=r.headers.get("Content-Type"),l=void 0,h=void 0,c=e+"";if(a=a.substring(a.indexOf("=batchresponse")+1),c=c.split(a),c.length<2)return{};c=c[1];var u=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(c);u&&c.replace(u[0],"");var d=u?u[1]:"";c=c.split(d);for(var p=c.length;p>-1;p--)!/\bContent-ID:/i.test(c[p])||!/\bHTTP.+201/.test(c[p])||(l=parseInt(/\bContent-ID: (\d+)/i.exec(c[p])[1],10),s.addedRecords[l]&&(h=ge.parse.parseJson(/^\{.+\}/m.exec(c[p])[0]),pe({},s.addedRecords[l],this.processResponse(h))));return s}return null},t.prototype.compareAndRemove=function(e,i,r){var n=this;return g(i)||Object.keys(e).forEach(function(s){if(s!==r&&s!=="@odata.etag")if(ge.isPlainObject(e[s])){n.compareAndRemove(e[s],i[s]);var a=Object.keys(e[s]).filter(function(l){return l!=="@odata.etag"});a.length===0&&delete e[s]}else(e[s]===i[s]||e[s]&&i[s]&&e[s].valueOf()===i[s].valueOf())&&delete e[s]}),e},t})(hc);var $L=(function(o){Ru(t,o);function t(){return o.call(this)||this}return t.prototype.insert=function(e,i,r,n,s){return this.pvt.position=s,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{value:i,table:r,action:"insert"},ge.getAddParams(this,e,n)))}},t.prototype.remove=function(e,i,r,n,s){return o.prototype.remove.call(this,e,i,r),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{key:r,keyColumn:i,table:n,action:"remove"},ge.getAddParams(this,e,s)))}},t.prototype.update=function(e,i,r,n,s){return this.updateType="update",this.updateKey=i,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(pe({},{value:r,action:"update",keyColumn:i,key:r[i],table:n},ge.getAddParams(this,e,s)))}},t.prototype.processResponse=function(e,i,r,n,s,a,l){var h,c=s?JSON.parse(s.data):e;if(e=c.action==="batch"?ge.parse.parseJson(e):e,this.updateType==="add"&&o.prototype.insert.call(this,i,e,null,null,this.pvt.position),this.updateType==="update"&&o.prototype.update.call(this,i,this.updateKey,e),this.updateType=void 0,e.added)for(h=0;h<e.added.length;h++)o.prototype.insert.call(this,i,e.added[h]);if(e.changed)for(h=0;h<e.changed.length;h++)o.prototype.update.call(this,i,l.key,e.changed[h]);if(e.deleted)for(h=0;h<e.deleted.length;h++)o.prototype.remove.call(this,i,l.key,e.deleted[h]);return e},t.prototype.batchRequest=function(e,i,r,n,s){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(pe({},{changed:i.changedRecords,added:i.addedRecords,deleted:i.deletedRecords,action:"batch",table:r.url,key:r.key},ge.getAddParams(this,e,n)))}},t.prototype.addParams=function(e){var i=new hc;i.addParams(e)},t.prototype.beforeSend=function(e,i,r){},t})(Qp),J4=(function(o){Ru(t,o);function t(e){var i=o.call(this)||this;return i.options=pe({},i.options,{getData:function(){},addRecord:function(){},updateRecord:function(){},deleteRecord:function(){},batchUpdate:function(){}}),pe(i.options,e||{}),i}return t.prototype.getModuleName=function(){return"CustomDataAdaptor"},t})(hc);var e3=(function(o){Ru(t,o);function t(e,i,r){var n=o.call(this)||this;n.isCrudAction=!1,n.isInsertAction=!1,g(e)||(n.cacheAdaptor=e),n.pageSize=r,n.guidId=ge.getGuid("cacheAdaptor");var s={keys:[],results:[]};window.localStorage.setItem(n.guidId,JSON.stringify(s));var a=n.guidId;return g(i)||setInterval(function(){for(var l=ge.parse.parseJson(window.localStorage.getItem(a)),h=[],c=0;c<l.results.length;c++){var u=+new Date,d=+new Date(l.results[c].timeStamp);l.results[c].timeStamp=u-d,u-d>i&&h.push(c)}for(var c=0;c<h.length;c++)l.results.splice(h[c],1),l.keys.splice(h[c],1);window.localStorage.removeItem(a),window.localStorage.setItem(a,JSON.stringify(l))},i),n}return t.prototype.generateKey=function(e,i){var r=this.getQueryRequest(i),n=Pe.filterQueryLists(i.queries,["onSelect","onPage","onSkip","onTake","onRange"]),s=e,a="onPage";a in n&&(s+=n[a].pageIndex),r.sorts.forEach(function(d){s+=d.e.direction+d.e.fieldName}),r.groups.forEach(function(d){s+=d.e.fieldName}),r.searches.forEach(function(d){s+=d.e.searchKey});for(var l=0;l<r.filters.length;l++){var h=r.filters[l];if(h.e.isComplex){var c=i.clone();c.queries=[];for(var u=0;u<h.e.predicates.length;u++)c.queries.push({fn:"onWhere",e:h.e.predicates[u],filter:i.queries.filter});s+=h.e.condition+this.generateKey(e,c)}else s+=h.e.field+h.e.operator+h.e.value}return s},t.prototype.processQuery=function(e,i,r){var n=this.generateKey(e.dataSource.url,i),s=ge.parse.parseJson(window.localStorage.getItem(this.guidId)),a=s?s.results[s.keys.indexOf(n)]:null;return a!=null&&!this.isCrudAction&&!this.isInsertAction?a:(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0)))},t.prototype.processResponse=function(e,i,r,n,s,a){if(this.isInsertAction||s&&this.cacheAdaptor.options.batch&&ge.endsWith(s.url,this.cacheAdaptor.options.batch)&&s.type.toLowerCase()==="post")return this.cacheAdaptor.processResponse(e,i,r,n,s,a);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var l=r?this.generateKey(i.dataSource.url,r):i.dataSource.url,h={};h=ge.parse.parseJson(window.localStorage.getItem(this.guidId));var c=h.keys.indexOf(l);for(c!==-1&&(h.results.splice(c,1),h.keys.splice(c,1)),h.results[h.keys.push(l)-1]={keys:l,result:e.result,timeStamp:new Date,count:e.count};h.results.length>this.pageSize;)h.results.splice(0,1),h.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(h)),e},t.prototype.beforeSend=function(e,i,r){!g(this.cacheAdaptor.options.batch)&&ge.endsWith(r.url,this.cacheAdaptor.options.batch)&&r.type.toLowerCase()==="post"&&i.headers.set("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||i.headers.set("Accept",this.cacheAdaptor.options.accept)},t.prototype.update=function(e,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.update(e,i,r,n)},t.prototype.insert=function(e,i,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,i,r)},t.prototype.remove=function(e,i,r,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,i,r,n)},t.prototype.batchRequest=function(e,i,r){return this.cacheAdaptor.batchRequest(e,i,r)},t})(hc),pm=function(o,t,e,i){return new(e||(e=Promise))(function(r,n){function s(h){try{l(i.next(h))}catch(c){n(c)}}function a(h){try{l(i.throw(h))}catch(c){n(c)}}function l(h){h.done?r(h.value):new e(function(c){c(h.value)}).then(s,a)}l((i=i.apply(o,t||[])).next())})},fm=function(o,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(c){return l([h,c])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,r=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){e.label=h[1];break}if(h[0]===6&&e.label<n[1]){e.label=n[1],n=h;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(h);break}n[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(o,e)}catch(c){h=[6,c],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},oe=(function(){function o(t,e,i,r){var n=this;this.dateParse=!0,this.timeZoneHandling=!0,this.persistQuery={},this.isInitialLoad=!1,this.requests=[],this.isEnableCache=!1,this.isInitialLoad=!0,this.isEnableCache=!1,r&&r.applyPostRequestMiddlewares&&(this.applyPostRequestMiddlewares=r.applyPostRequestMiddlewares),r&&r.applyPreRequestMiddlewares&&(this.applyPreRequestMiddlewares=r.applyPreRequestMiddlewares),!t&&!this.dataSource&&(t=[]),i=i||t.adaptor,t&&t.timeZoneHandling===!1&&(this.timeZoneHandling=t.timeZoneHandling);var s;if(t instanceof Array?s={json:t,offline:!0}:typeof t=="object"?(t.json||(t.json=[]),t.enablePersistence||(t.enablePersistence=!1),t.id||(t.id=""),t.ignoreOnPersist||(t.ignoreOnPersist=[]),s={url:t.url,insertUrl:t.insertUrl,removeUrl:t.removeUrl,updateUrl:t.updateUrl,crudUrl:t.crudUrl,batchUrl:t.batchUrl,json:t.json,headers:t.headers,accept:t.accept,data:t.data,enableCache:t.enableCache,timeTillExpiration:t.timeTillExpiration,cachingPageSize:t.cachingPageSize,enableCaching:t.enableCaching,requestType:t.requestType,key:t.key,crossDomain:t.crossDomain,jsonp:t.jsonp,dataType:t.dataType,offline:t.offline!==void 0?t.offline:t.adaptor instanceof $L||t.adaptor instanceof J4?!1:!t.url,requiresFormat:t.requiresFormat,enablePersistence:t.enablePersistence,id:t.id,ignoreOnPersist:t.ignoreOnPersist}):ge.throwError("DataManager: Invalid arguments"),s.requiresFormat===void 0&&!ge.isCors()&&(s.requiresFormat=g(s.crossDomain)?!0:s.crossDomain),s.dataType===void 0&&(s.dataType="json"),this.isEnableCache=s.enableCache,this.dataSource=s,this.defaultQuery=e,this.dataSource.enablePersistence&&this.dataSource.id&&window.addEventListener("unload",this.setPersistData.bind(this)),s.url&&s.offline&&!s.json.length?(this.isDataAvailable=!1,this.adaptor=i||new Bw,this.dataSource.offline=!1,this.ready=this.executeQuery(e||new Pe),this.ready.then(function(l){n.dataSource.offline=!0,n.isDataAvailable=!0,s.json=l.result,n.adaptor=new Qp})):this.adaptor=s.offline?new Qp:new Bw,!s.jsonp&&this.adaptor instanceof Bw&&(s.jsonp="callback"),this.adaptor=i||this.adaptor,this.isEnableCache){this.guidId=ge.getGuid("cacheAdaptor");var a={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(a))}return s.enableCaching&&(this.adaptor=new e3(this.adaptor,s.timeTillExpiration,s.cachingPageSize)),this}return Object.defineProperty(o.prototype,"moduleName",{get:function(){return"datamanager"},enumerable:!0,configurable:!0}),o.prototype.getPersistedData=function(t){var e=localStorage.getItem(t||this.dataSource.id);return JSON.parse(e)},o.prototype.setPersistData=function(t,e,i){localStorage.setItem(e||this.dataSource.id,JSON.stringify(i||this.persistQuery))},o.prototype.setPersistQuery=function(t){var e=this,i=this.getPersistedData();if(this.isInitialLoad&&i&&Object.keys(i).length){this.persistQuery=i,this.persistQuery.queries=this.persistQuery.queries.filter(function(n){if(e.dataSource.ignoreOnPersist&&e.dataSource.ignoreOnPersist.length&&n.fn&&e.dataSource.ignoreOnPersist.some(function(l){return n.fn===l}))return!1;if(n.fn==="onWhere"){var s=n.e;if(s&&s.isComplex&&s.predicates instanceof Array){var a=s.predicates.map(function(l){if(l.predicates&&l.predicates instanceof Array){var h=l.predicates.map(function(m){var y=m.field,b=m.operator,S=m.value,C=m.ignoreCase,x=m.ignoreAccent,I=m.matchCase;return new xt(y,b,S,C,x,I)});return l.condition==="and"?xt.and(h):xt.or(h)}else{var c=l.field,u=l.operator,d=l.value,p=l.ignoreCase,f=l.ignoreAccent,v=l.matchCase;return new xt(c,u,d,p,f,v)}});n.e=new xt(a[0],s.condition,a.slice(1))}}return!0});var r=pe(new Pe,this.persistQuery);return this.isInitialLoad=!1,r}else return this.persistQuery=t,this.isInitialLoad=!1,t},o.prototype.setDefaultQuery=function(t){return this.defaultQuery=t,this},o.prototype.executeLocal=function(t){!this.defaultQuery&&!(t instanceof Pe)&&ge.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||ge.throwError("DataManager - executeLocal() : Json data is required to execute"),this.dataSource.enablePersistence&&this.dataSource.id&&(t=this.setPersistQuery(t)),t=t||this.defaultQuery;var e=this.adaptor.processQuery(this,t);if(t.subQuery){var i=t.subQuery.fromTable,r=t.subQuery.lookups,n=t.isCountRequired?e.result:e;r&&r instanceof Array&&ge.buildHierarchy(t.subQuery.fKey,i,n,r,t.subQuery.key);for(var s=0;s<n.length;s++)n[s][i]instanceof Array&&(n[s]=pe({},{},n[s]),n[s][i]=this.adaptor.processResponse(t.subQuery.using(new o(n[s][i].slice(0))).executeLocal(),this,t))}return this.adaptor.processResponse(e,this,t)},o.prototype.executeQuery=function(t,e,i,r){var n=this,s="makeRequest";this.dataSource.enablePersistence&&this.dataSource.id&&(t=this.setPersistQuery(t)),typeof t=="function"&&(r=i,i=e,e=t,t=null),t||(t=this.defaultQuery),t instanceof Pe||ge.throwError("DataManager - executeQuery() : A query is required to execute");var a=new zn,l={query:t};if(!this.dataSource.offline&&this.dataSource.url!==void 0&&this.dataSource.url!==""||!g(this.adaptor[s])||this.isCustomDataAdaptor(this.adaptor)){var h=this.isEnableCache?this.processQuery(t):this.adaptor.processQuery(this,t);g(this.adaptor[s])?!g(h.url)||this.isCustomDataAdaptor(this.adaptor)?(this.requests=[],this.makeRequest(h,a,l,t)):(l=o.getDeferedArgs(t,h,l),a.resolve(l)):this.adaptor[s](h,a,l,t)}else o.nextTick(function(){var c=n.executeLocal(t);l=o.getDeferedArgs(t,c,l),a.resolve(l)});return(e||i)&&a.promise.then(e,i),r&&a.promise.then(r,r),a.promise},o.prototype.getQueryRequest=function(t){var e={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return e.sorts=Pe.filterQueries(t.queries,"onSortBy"),e.groups=Pe.filterQueries(t.queries,"onGroup"),e.filters=Pe.filterQueries(t.queries,"onWhere"),e.searches=Pe.filterQueries(t.queries,"onSearch"),e.aggregates=Pe.filterQueries(t.queries,"onAggregates"),e},o.prototype.generateKey=function(t,e){var i=this.getQueryRequest(e),r=Pe.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),n=t,s="onPage";i.sorts.forEach(function(d){n+=d.e.direction+d.e.fieldName}),i.groups.forEach(function(d){n+=d.e.fieldName}),i.searches.forEach(function(d){n+=d.e.searchKey});for(var a=0;a<i.filters.length;a++){var l=i.filters[a];if(l.e.isComplex){var h=e.clone();h.queries=[];for(var c=0;c<l.e.predicates.length;c++)h.queries.push({fn:"onWhere",e:l.e.predicates[c],filter:e.queries.filter});n+=l.e.condition+this.generateKey(t,h)}else n+=l.e.field+l.e.operator+l.e.value}if(!g(this.previousCacheQuery)&&this.previousCacheQuery!==n){var u={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(u))}return this.previousCacheQuery=n,s in r&&(n+=r[s].pageIndex),n},o.prototype.processQuery=function(t){var e=this.generateKey(this.dataSource.url,t),i=JSON.parse(window.localStorage.getItem(this.guidId)),r=i?i.results[i.keys.indexOf(e)]:null;return r!=null?ge.parse.parseJson(r):this.adaptor.processQuery(this,t)},o.getDeferedArgs=function(t,e,i){return t.isCountRequired?(i.result=e.result,i.count=e.count,i.aggregates=e.aggregates):i.result=e,i},o.nextTick=function(t){(window.setImmediate||window.setTimeout)(t,0)},o.prototype.extendRequest=function(t,e,i){return pe({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:e,onFailure:i},t)},o.prototype.makeRequest=function(t,e,i,r){var n=this,s=!!r.subQuerySelector,a=function(m){i.error=m,e.reject(i)},l=function(m,y,b,S,C,x,I){i.xhr=b,i.count=y?parseInt(y.toString(),10):0,i.result=m,i.request=S,i.aggregates=x,i.actual=C,i.virtualSelectRecords=I,e.resolve(i)},h=function(m,y){var b=new zn,S={parent:i};r.subQuery.isChild=!0;var C=n.adaptor.processQuery(n,r.subQuery,m?n.adaptor.processResponse(m):y),x=n.makeRequest(C,b,S,r.subQuery);return s||b.then(function(I){m&&(ge.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,m,I,r.subQuery.key),l(m,I.count,I.xhr))},a),x},c=function(m,y){if(n.isGraphQLAdaptor(n.adaptor)&&!g(m.errors))return a(m.errors);n.isCustomDataAdaptor(n.adaptor)&&(y=pe({},n.fetchReqOption,y)),y.contentType.indexOf("xml")===-1&&n.dateParse&&!n.isEnableCache&&(m=ge.parse.parseJson(m));var b,S=n.afterReponseRequest(m);S.then(function(C){if(b=n.adaptor.processResponse(C,n,r,y.fetchRequest,y),n.isEnableCache){var x=r?n.generateKey(n.dataSource.url,r):n.dataSource.url,I={};I=JSON.parse(window.localStorage.getItem(n.guidId));var D=I.keys.indexOf(x);D!==-1&&(I.results.splice(D,1),I.keys.splice(D,1)),I.results[I.keys.push(x)-1]={keys:x,result:b.result,timeStamp:new Date,count:b.count},window.localStorage.setItem(n.guidId,JSON.stringify(I))}y.contentType.indexOf("xml")===-1&&n.dateParse&&n.isEnableCache&&(b=ge.parse.parseJson(b));var M=0,E=null,A="virtualSelectRecords",L=C[A];if(r.isCountRequired&&(M=b.count,E=b.aggregates,b=b.result),!r.subQuery){l(b,M,y.fetchRequest,y.type,C,E,L);return}s||h(b,y)}).catch(function(C){return n.dataManagerFailure(C,e,i)})},u=this.extendRequest(t,c,a);if(this.isCustomDataAdaptor(this.adaptor)){this.fetchReqOption=u;var f=u;this.adaptor.options.getData({data:f.data,onSuccess:f.onSuccess,onFailure:f.onFailure})}else{var d=this.useMiddleware(u),p;d.then(function(m){p=new om(u),p.beforeSend=function(){n.beforeSend(p.fetchRequest,p,m)},u=p.send(),u.catch(function(y){return!0}),n.requests.push(p)}).catch(function(m){return n.dataManagerFailure(m,e,i)})}if(s){var d=void 0,v=r.subQuerySelector.call(this,{query:r.subQuery,parent:r});v&&v.length?(d=Promise.all([u,h(null,v)]),d.then(function(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];var S=y[0],C=n.adaptor.processResponse(S[0],n,r,n.requests[0].fetchRequest,n.requests[0]),x=0;r.isCountRequired&&(x=C.count,C=C.result);var I=n.adaptor.processResponse(S[1],n,r.subQuery,n.requests[1].fetchRequest,n.requests[1]);x=0,r.subQuery.isCountRequired&&(x=I.count,I=I.result),ge.buildHierarchy(r.subQuery.fKey,r.subQuery.fromTable,C,I,r.subQuery.key),s=!1,l(C,x,n.requests[0].fetchRequest)})):s=!1}return u},o.prototype.dataManagerFailure=function(t,e,i){i.error=t,e.reject(i)},o.prototype.afterReponseRequest=function(t){return pm(this,void 0,void 0,function(){var e,i;return fm(this,function(r){switch(r.label){case 0:return[4,this.applyPostRequestMiddlewares(t)];case 1:return e=r.sent(),i=new zn,i.resolve(e),[2,i.promise]}})})},o.prototype.applyPostRequestMiddlewares=function(t){return pm(this,void 0,void 0,function(){return fm(this,function(e){return[2,t]})})},o.prototype.useMiddleware=function(t){return pm(this,void 0,void 0,function(){var e,i;return fm(this,function(r){switch(r.label){case 0:return[4,this.applyPreRequestMiddlewares(t)];case 1:return e=r.sent(),i=new zn,i.resolve(e),[2,i.promise]}})})},o.prototype.applyPreRequestMiddlewares=function(t){return pm(this,void 0,void 0,function(){return fm(this,function(e){return[2,t]})})},o.prototype.beforeSend=function(t,e,i){this.adaptor.beforeSend(this,t,e);var r=[];this.dataSource.headers&&(r=r.concat(this.dataSource.headers));var n;i&&i.headers&&(r=r.concat(i.headers));for(var s=0;r&&s<r.length;s++){n=[];for(var a=Object.keys(r[s]),l=0,h=a;l<h.length;l++){var c=h[l];n.push(c),t.headers.set(c,r[s][c])}}},o.prototype.saveChanges=function(t,e,i,r,n){var s=this;i instanceof Pe&&(r=i,i=null);var a={url:i,key:e||this.dataSource.key},l=this.adaptor.batchRequest(this,t,a,r||new Pe,n),h="dofetchRequest";if(this.dataSource.offline)return l;if(g(this.adaptor[h])){if(this.isCustomDataAdaptor(this.adaptor))return this.dofetchRequest(l,this.adaptor.options.batchUpdate,t);var c=new zn,u=new om(l);return u.beforeSend=function(){s.beforeSend(u.fetchRequest,u)},u.onSuccess=function(d,p){s.isGraphQLAdaptor(s.adaptor)&&(g(d.errors)||u.onFailure(JSON.stringify(d.errors))),c.resolve(s.adaptor.processResponse(d,s,null,p.fetchRequest,p,t,a))},u.onFailure=function(d){c.reject([{error:d}])},u.send().catch(function(d){return!0}),c.promise}else return this.adaptor[h](l)},o.prototype.insert=function(t,e,i,r){e instanceof Pe&&(i=e,e=null);var n=this.adaptor.insert(this,t,e,i,r),s="dofetchRequest";return this.dataSource.offline?n:g(this.adaptor[s])?this.dofetchRequest(n,this.adaptor.options.addRecord):this.adaptor[s](n)},o.prototype.remove=function(t,e,i,r){typeof e=="object"&&(e=ge.getObject(t,e)),i instanceof Pe&&(r=i,i=null);var n=this.adaptor.remove(this,t,e,i,r),s="dofetchRequest";if(this.dataSource.offline)return n;if(g(this.adaptor[s])){var a=this.adaptor.options.deleteRecord;return this.dofetchRequest(n,a)}else return this.adaptor[s](n)},o.prototype.update=function(t,e,i,r,n){i instanceof Pe&&(r=i,i=null),this.isEnableCache&&(this.cacheQuery=this.generateKey(this.dataSource.url,r));var s=this.adaptor.update(this,t,e,i,r,n),a="dofetchRequest";if(this.dataSource.offline)return s;if(g(this.adaptor[a])){var l=this.adaptor.options.updateRecord;return this.dofetchRequest(s,l)}else return this.adaptor[a](s)},o.prototype.isCustomDataAdaptor=function(t){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="CustomDataAdaptor"},o.prototype.isGraphQLAdaptor=function(t){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="GraphQLAdaptor"},o.prototype.successFunc=function(t,e,i){if(this.isGraphQLAdaptor(this.adaptor)){var r=typeof t=="object"?t:JSON.parse(t);g(r.errors)||this.failureFunc(JSON.stringify(r.errors))}this.isCustomDataAdaptor(this.adaptor)&&(e=pe({},this.fetchReqOption,e));try{ge.parse.parseJson(t)}catch{t=[]}if(this.isEnableCache){var n=JSON.parse(e.data);if(n.action==="insert"||n.action==="remove"){var s={keys:[],results:[]};window.localStorage.setItem(this.guidId,JSON.stringify(s))}else if(n.action==="update"){var a=JSON.parse(window.localStorage.getItem(this.guidId)),r=a?a.results[a.keys.indexOf(this.cacheQuery)]:null;if(r&&r.result){for(var l=r.result,h=0;h<l.length;h++)if(l[h][n.keyColumn]===n.key){l[h]=n.value,window.localStorage.setItem(this.guidId,JSON.stringify(a));break}}}}t=this.adaptor.processResponse(ge.parse.parseJson(t),this,null,e.fetchRequest,e,i),this.fetchDeffered.resolve(t)},o.prototype.failureFunc=function(t){this.isEnableCache&&(this.cacheQuery=""),this.fetchDeffered.reject([{error:t}])},o.prototype.dofetchRequest=function(t,e,i){var r=this;if(t=pe({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},t),this.fetchDeffered=new zn,this.isCustomDataAdaptor(this.adaptor))this.fetchReqOption=t,e.call(this,{data:t.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this),changes:i});else{var n=this.useMiddleware(t),s;n.then(function(a){s=new om(t),s.beforeSend=function(){r.beforeSend(s.fetchRequest,s,a)},s.onSuccess=r.successFunc.bind(r),s.onFailure=r.failureFunc.bind(r),t=s.send(),t.catch(function(l){return!0})}).catch(function(a){return r.dataManagerFailure(a,r.fetchDeffered,{})})}return this.fetchDeffered.promise},o.prototype.clearPersistence=function(){window.removeEventListener("unload",this.setPersistData.bind(this)),this.dataSource.enablePersistence=!1,this.persistQuery={},window.localStorage.setItem(this.dataSource.id,"[]")},o})(),zn=(function(){function o(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return o})();function JL(o,t,e,i,r,n){var s=i;if(i.tagName===t){var a=V("ej2_instances",i);s=o("input",{attrs:{type:e}});for(var l=["change","cssClass","label","labelPosition","id"],h=0,c=i.attributes.length;h<c;h++)l.indexOf(i.attributes[h].nodeName)===-1&&s.setAttribute(i.attributes[h].nodeName,i.attributes[h].nodeValue);Ee(i,{class:r}),i.appendChild(s),i.classList.add(n),i.classList.remove(n),it("ej2_instances",a,s),Gp(i,"ej2_instances")}return s}function t3(o){for(var t,e=o.childNodes,i=0;i<e.length;i++)if(t=e[i],t.nodeType===3)return t;return null}function hl(o,t,e){t===void 0&&(t=!1),e===void 0&&(e={});var i=o("div",{className:"e-checkbox-wrapper e-css"});if(e.cssClass&&X([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl"),t){var r=o("span",{className:"e-ripple-container"});Wi(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var n=o("span",{className:"e-frame e-icons"});if(e.checked&&n.classList.add("e-check"),i.appendChild(n),e.label){var s=o("span",{className:"e-label"});e.disableHtmlEncode?s.textContent=e.label:s.innerHTML=e.label,i.appendChild(s)}return i}function ah(o,t){if(t){var e=document.createEvent("MouseEvents");e.initEvent(o.type,!1,!0),t.dispatchEvent(e)}}function i3(o,t){o.element.getAttribute("ejs-for")&&t.appendChild(o.createElement("input",{attrs:{name:o.name||o.element.name,value:"false",type:"hidden"}}))}var r3=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),$a=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};var Vse=new Lu,ga={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},Jn=(function(o){r3(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.initialize(),this.removeRippleEffect=Wi(this.element,{selector:"."+ga.BUTTON}),this.renderComplete()},t.prototype.initialize=function(){if(this.cssClass&&X([this.element],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPrimary&&this.element.classList.add(ga.PRIMARY),!$e()||$e()&&this.getModuleName()!=="progress-btn"){if(this.content){var e=this.enableHtmlSanitizer?Pt.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss()}this.enableRtl&&this.element.classList.add(ga.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},t.prototype.controlStatus=function(e){this.element.disabled=e},t.prototype.setIconCss=function(){if(this.iconCss){var e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(ga.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(e,i):this.element.appendChild(e)}},t.prototype.wireEvents=function(){this.isToggle&&T.add(this.element,"click",this.btnClickHandler,this)},t.prototype.unWireEvents=function(){this.isToggle&&T.remove(this.element,"click",this.btnClickHandler)},t.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},t.prototype.destroy=function(){var e=[ga.PRIMARY,ga.RTL,ga.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(/\s+/).filter(function(r){return r.length>0}))),o.prototype.destroy.call(this),Z([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&se(i),this.unWireEvents(),Xa&&this.removeRippleEffect()},t.prototype.getModuleName=function(){return"btn"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.Inject=function(){},t.prototype.onPropertyChanged=function(e,i){for(var r=this.element.querySelector("span.e-btn-icon"),n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"isPrimary":e.isPrimary?this.element.classList.add(ga.PRIMARY):this.element.classList.remove(ga.PRIMARY);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":{r=this.element.querySelector("span.e-btn-icon"),r?e.iconCss?(r.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):se(r):this.setIconCss();break}case"iconPosition":Z([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&se(r),this.setIconCss();break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(/\s+/).filter(function(h){return h.length>0})),e.cssClass&&X([this.element],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(ga.RTL):this.element.classList.remove(ga.RTL);break;case"content":{var l=t3(this.element);l||this.element.classList.remove(ga.ICONBTN),(!$e()||$e()&&!this.isServerRendered&&this.getModuleName()!=="progress-btn")&&(this.enableHtmlSanitizer&&(e.content=Pt.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss());break}case"isToggle":e.isToggle?T.add(this.element,"click",this.btnClickHandler,this):(T.remove(this.element,"click",this.btnClickHandler),Z([this.element],["e-active"]));break}}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},$a([w("Left")],t.prototype,"iconPosition",void 0),$a([w("")],t.prototype,"iconCss",void 0),$a([w(!1)],t.prototype,"disabled",void 0),$a([w(!1)],t.prototype,"isPrimary",void 0),$a([w("")],t.prototype,"cssClass",void 0),$a([w("")],t.prototype,"content",void 0),$a([w(!1)],t.prototype,"isToggle",void 0),$a([w()],t.prototype,"locale",void 0),$a([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),$a([G()],t.prototype,"created",void 0),t=$a([It],t),t})(ti),n3=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),qs=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},jw="e-check",ZL="e-checkbox-disabled",Xp="e-frame",Hw="e-stop",Vw="e-label",Kp="e-ripple-container",_w="e-ripple-check",Uw="e-ripple-stop",Ww="e-rtl",qw="e-checkbox-wrapper",s3=["title","class","style","disabled","readonly","name","value","id","tabindex","aria-label","required"],ma=(function(o){n3(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isFocused=!1,r.isMouseClick=!1,r.clickTriggered=!1,r.validCheck=!0,r.type="checkbox",r}return t.prototype.changeState=function(e,i,r){var n=this.getWrapper(),s=null,a=null;n&&(a=n.getElementsByClassName(Xp)[0],Xa&&(s=n.getElementsByClassName(Kp)[0])),e==="check"?(a&&(a.classList.remove(Hw),a.classList.add(jw)),s&&(s.classList.remove(Uw),s.classList.add(_w)),this.element.checked=!0,(this.element.required||H(this.element,"form")&&H(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!1,this.validCheck=!1):(this.element.required||H(this.element,"form")&&H(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):e==="uncheck"?(a&&Z([a],[jw,Hw]),s&&Z([s],[_w,Uw]),this.element.checked=!1,(this.element.required||H(this.element,"form")&&H(this.element,"form").classList.contains("e-formvalidator"))&&this.validCheck&&!i&&r?(this.element.checked=!0,this.validCheck=!1):(this.element.required||H(this.element,"form")&&H(this.element,"form").classList.contains("e-formvalidator"))&&(this.validCheck=!0)):(a&&(a.classList.remove(jw),a.classList.add(Hw)),s&&(s.classList.remove(_w),s.classList.add(Uw)),this.element.indeterminate=!0,this.indeterminate=!0)},t.prototype.clickHandler=function(e){if(e.target.tagName==="INPUT"&&this.clickTriggered){this.changeState(this.checked?"check":"uncheck"),this.clickTriggered=!1;return}(e.target.tagName==="SPAN"||e.target.tagName==="LABEL"||H(e.target,".e-label"))&&(this.clickTriggered=!0),this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck",!1,!0),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck",!1,!0),this.checked=!1):(this.changeState("check",!1,!0),this.checked=!0);var i={checked:this.updateVueArrayModel(!1),event:e};this.trigger("change",i),e.stopPropagation()},t.prototype.destroy=function(){var e=this,i=this.getWrapper();o.prototype.destroy.call(this),this.wrapper&&(i=this.wrapper,this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(this.getWrapper()&&i.parentNode&&i.parentNode.insertBefore(this.element,i),se(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(r){e.element.removeAttribute(r)})):(["class"].forEach(function(r){i.removeAttribute(r)}),i.innerHTML="",this.element=i,this.refreshing&&(["e-control","e-checkbox","e-lib"].forEach(function(r){e.element.classList.add(r)}),it("ej2_instances",[this],this.element))))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var e=this.getWrapper();e&&e.classList.remove("e-focus"),this.isFocused=!1},t.prototype.getModuleName=function(){return"checkbox"},t.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},t.prototype.getWrapper=function(){return this.element&&this.element.parentElement?this.element.parentElement.parentElement:null},t.prototype.getLabel=function(){return this.element?this.element.parentElement:null},t.prototype.initialize=function(){g(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.element.setAttribute("tabindex","0"),this.value&&(this.element.setAttribute("value",this.value),this.isVue&&typeof this.value=="boolean"&&this.value===!0&&this.setProperties({checked:!0},!0)),this.checked&&this.changeState("check",!0),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var e=this.element.parentElement;e.classList.contains(qw)||(e=this.createElement("div",{className:qw}),this.element.parentNode&&this.element.parentNode.insertBefore(e,this.element));var i=this.createElement("label",{attrs:{for:this.htmlAttributes.id?this.htmlAttributes.id:this.element.id}}),r=this.createElement("span",{className:"e-icons "+Xp});if(e.classList.add("e-wrapper"),this.enableRtl&&e.classList.add(Ww),this.cssClass&&X([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),e.appendChild(i),i.appendChild(this.element),i3(this,i),i.appendChild(r),Xa){var n=this.createElement("span",{className:Kp});this.labelPosition==="Before"?i.appendChild(n):i.insertBefore(n,r),Wi(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getWrapper().classList.add("e-focus")},t.prototype.labelMouseDownHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(Kp)[0];ah(e,i)},t.prototype.labelMouseLeaveHandler=function(e){var i=this.getLabel().getElementsByClassName(Kp)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=r.length-1;n>0;n--)i.removeChild(i.childNodes[n]);ah(e,i)}},t.prototype.labelMouseUpHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(Kp)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=0;n<r.length-1;n++)i.removeChild(i.childNodes[n]);ah(e,i)}},t.prototype.onPropertyChanged=function(e,i){for(var r=this.getWrapper(),n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(e.checked?"check":"uncheck");break;case"indeterminate":e.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":e.disabled?(this.setDisabled(),this.wrapper=this.getWrapper(),this.unWireEvents()):(this.element.disabled=!1,r.classList.remove(ZL),r.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":i.cssClass&&Z([r],i.cssClass.split(/\s+/).filter(function(c){return c.length>0})),e.cssClass&&X([r],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?r.classList.add(Ww):r.classList.remove(Ww);break;case"label":this.setText(e.label);break;case"labelPosition":{var l=r.getElementsByClassName(Vw)[0],h=r.getElementsByTagName("label")[0];se(l),e.labelPosition==="After"?h.appendChild(l):h.insertBefore(l,r.getElementsByClassName(Xp)[0]);break}case"name":this.element.setAttribute("name",e.name);break;case"value":if(this.isVue&&typeof e.value=="object")break;this.element.setAttribute("value",e.value);break;case"htmlAttributes":this.updateHtmlAttributeToWrapper();break}}},t.prototype.preRender=function(){var e=this.element;this.tagName=this.element.tagName,e=JL(this.createElement,"EJS-CHECKBOX","checkbox",e,qw,"checkbox"),this.element.hasAttribute("id")&&this.isAngular&&this.element.tagName==="EJS-CHECKBOX"&&(e.id=this.element.id,this.element.removeAttribute("id")),this.element=e,this.element.getAttribute("type")!=="checkbox"&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=Lt("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.updateHtmlAttributeToWrapper(),this.updateVueArrayModel(!0),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){var e=this.getWrapper();this.element.disabled=!0,e.classList.add(ZL),e.setAttribute("aria-disabled","true")},t.prototype.setText=function(e){var i=this.getWrapper();if(i){var r=i.getElementsByClassName(Vw)[0];if(r)r.innerHTML=this.enableHtmlSanitizer?Pt.sanitize(e):e;else{e=this.enableHtmlSanitizer?Pt.sanitize(e):e,r=this.createElement("span",{className:Vw,innerHTML:e});var n=i.getElementsByTagName("label")[0];this.labelPosition==="Before"?n.insertBefore(r,i.getElementsByClassName(Xp)[0]):n.appendChild(r)}}},t.prototype.changeHandler=function(e){e.stopPropagation()},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.element.checked=this.initialCheckedValue},t.prototype.unWireEvents=function(){var e=this.wrapper;if(T.remove(this.element,"keyup",this.keyUpHandler),T.remove(this.element,"focus",this.focusHandler),T.remove(this.element,"focusout",this.focusOutHandler),e){T.remove(e,"click",this.clickHandler);var i=e.getElementsByTagName("label")[0];i&&(T.remove(i,"mousedown",this.labelMouseDownHandler),T.remove(i,"mouseup",this.labelMouseUpHandler),T.remove(i,"mouseleave",this.labelMouseLeaveHandler))}var r=H(this.element,"form");r&&T.remove(r,"reset",this.formResetHandler),this.tagName==="EJS-CHECKBOX"&&T.remove(this.element,"change",this.changeHandler)},t.prototype.wireEvents=function(){var e=this.getWrapper();T.add(e,"click",this.clickHandler,this),T.add(this.element,"keyup",this.keyUpHandler,this),T.add(this.element,"focus",this.focusHandler,this),T.add(this.element,"focusout",this.focusOutHandler,this);var i=e.getElementsByTagName("label")[0];T.add(i,"mousedown",this.labelMouseDownHandler,this),T.add(i,"mouseup",this.labelMouseUpHandler,this),T.add(i,"mouseleave",this.labelMouseLeaveHandler,this);var r=H(this.element,"form");r&&T.add(r,"reset",this.formResetHandler,this),this.tagName==="EJS-CHECKBOX"&&T.add(this.element,"change",this.changeHandler,this)},t.prototype.updateVueArrayModel=function(e){if(this.isVue&&typeof this.value=="object"){var i=this.element.value;if(i&&this.value)if(e)for(var r=0;r<this.value.length;r++)i===this.value[r]&&(this.changeState("check"),this.setProperties({checked:!0},!0));else{var n=this.value.indexOf(i);return this.checked?n<0&&this.value.push(i):n>-1&&this.value.splice(n,1),this.value}}return this.validCheck?this.element.checked:!this.element.checked},t.prototype.updateHtmlAttributeToWrapper=function(){if(!g(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e],n=this.getWrapper();if(s3.indexOf(r)>-1)if(r==="class")X([n],this.htmlAttributes[""+r].split(" "));else if(r==="title")n.setAttribute(r,this.htmlAttributes[""+r]);else if(r==="style"){var s=this.getWrapper().getElementsByClassName(Xp)[0];s.setAttribute(r,this.htmlAttributes[""+r])}else r==="disabled"?(this.htmlAttributes[""+r]==="true"&&this.setDisabled(),this.element.setAttribute(r,this.htmlAttributes[""+r])):this.element.setAttribute(r,this.htmlAttributes[""+r]);else n.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},qs([G()],t.prototype,"change",void 0),qs([G()],t.prototype,"created",void 0),qs([w(!1)],t.prototype,"checked",void 0),qs([w("")],t.prototype,"cssClass",void 0),qs([w(!1)],t.prototype,"disabled",void 0),qs([w(!1)],t.prototype,"indeterminate",void 0),qs([w("")],t.prototype,"label",void 0),qs([w("After")],t.prototype,"labelPosition",void 0),qs([w("")],t.prototype,"name",void 0),qs([w("")],t.prototype,"value",void 0),qs([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),qs([w({})],t.prototype,"htmlAttributes",void 0),t=qs([It],t),t})(ti),a3=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),va=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Yw="e-label",gm="e-ripple-container",Gw="e-rtl",Qw="e-radio-wrapper",o3=["title","class","style","disabled","readonly","name","value","id"],Ou=(function(o){a3(t,o);function t(i,r){var n=o.call(this,i,r)||this;return n.isFocused=!1,n.type="radio",n}e=t,t.prototype.changeHandler=function(i){this.checked=!0,this.dataBind();var r=this.element.getAttribute("value");r=this.isVue&&r?this.element.value:this.value;var n=typeof this.value;this.isVue&&n==="boolean"&&(r=r==="true"),this.trigger("change",{value:r,event:i}),this.isAngular&&i.stopPropagation()},t.prototype.updateChange=function(){for(var i,r,n=this.getRadioGroup(),s=0;s<n.length;s++)i=n[s],i!==this.element&&(r=Cr(i,e),r.checked=!1,this.tagName==="EJS-RADIOBUTTON"&&(r.angularValue=this.value))},t.prototype.destroy=function(){var i=this,r=this.wrapper;o.prototype.destroy.call(this),r&&(this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(r.parentNode&&r.parentNode.insertBefore(this.element,r),se(r),this.element.checked=!1,["name","value","disabled"].forEach(function(n){i.element.removeAttribute(n)})):(["role","aria-checked","class"].forEach(function(n){r.removeAttribute(n)}),r.innerHTML="",this.element=this.wrapper,this.refreshing&&(["e-control","e-radio","e-lib"].forEach(function(n){i.element.classList.add(n)}),it("ej2_instances",[this],this.element))))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var i=this.getLabel();i&&i.classList.remove("e-focus")},t.prototype.getModuleName=function(){return"radio"},t.prototype.getSelectedValue=function(){for(var i,r=this.getRadioGroup(),n=0,s=r.length;n<s;n++)if(i=r[n],i.checked)return i.value;return""},t.prototype.getRadioGroup=function(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')},t.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},t.prototype.getWrapper=function(){return this.element.parentElement?this.element.parentElement:null},t.prototype.getLabel=function(){return this.element.nextElementSibling?this.element.nextElementSibling:null},t.prototype.initialize=function(){g(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.updateHtmlAttribute(),this.name&&this.element.setAttribute("name",this.name);var i=this.element.getAttribute("value"),r=typeof this.value;this.isVue&&r==="boolean"&&(i=i==="true"),(this.isVue?this.value&&r!=="boolean"&&!i:this.value)&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var i,r=this.element.parentElement;r.classList.contains(Qw)||(r=this.createElement("div",{className:Qw}),this.element.parentNode&&this.element.parentNode.insertBefore(r,this.element));var n=this.createElement("label",{attrs:{for:this.element.id}});r.appendChild(this.element),r.appendChild(n),Xa&&(i=this.createElement("span",{className:gm}),n.appendChild(i),Wi(i,{duration:400,isCenterRipple:!0})),r.classList.add("e-wrapper"),this.enableRtl&&n.classList.add(Gw),this.cssClass&&X([r],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getLabel().classList.add("e-focus")},t.prototype.labelMouseDownHandler=function(i){var r=this.getLabel().getElementsByClassName(gm)[0];ah(i,r)},t.prototype.labelMouseLeaveHandler=function(i){var r=this.getLabel().getElementsByClassName(gm)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),s=n.length-1;s>0;s--)r.removeChild(r.childNodes[s]);ah(i,r)}},t.prototype.labelMouseUpHandler=function(i){var r=this.getLabel().getElementsByClassName(gm)[0];if(r){for(var n=r.querySelectorAll(".e-ripple-element"),s=n.length-1;s>0;s--)r.removeChild(r.childNodes[s]);ah(i,r)}},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&Ee(this.element,{checked:"true"})},t.prototype.onPropertyChanged=function(i,r){for(var n=this.getWrapper(),s=this.getLabel(),a=0,l=Object.keys(i);a<l.length;a++){var h=l[a];switch(h){case"checked":i.checked&&this.updateChange(),this.element.checked=i.checked;break;case"disabled":i.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":r.cssClass&&Z([n],r.cssClass.split(/\s+/).filter(function(u){return u.length>0})),i.cssClass&&X([n],i.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":i.enableRtl?s.classList.add(Gw):s.classList.remove(Gw);break;case"label":this.setText(i.label);break;case"labelPosition":i.labelPosition==="Before"?s.classList.add("e-right"):s.classList.remove("e-right");break;case"name":this.element.setAttribute("name",i.name);break;case"value":var c=typeof this.htmlAttributes.value;if(!g(this.htmlAttributes)&&(this.htmlAttributes.value||c==="boolean"&&!this.htmlAttributes.value))break;this.element.setAttribute("value",i.value);break;case"htmlAttributes":this.updateHtmlAttribute();break}}},t.prototype.preRender=function(){var i=this.element;if(this.formElement=H(this.element,"form"),this.tagName=this.element.tagName,i=JL(this.createElement,"EJS-RADIOBUTTON","radio",i,Qw,"radio"),this.element=i,this.element.getAttribute("type")!=="radio"&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=Lt("e-"+this.getModuleName())),this.tagName==="EJS-RADIOBUTTON"){var r=this.element.getAttribute("formcontrolname");r&&(this.setProperties({name:r},!0),this.element.setAttribute("name",r))}},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){this.element.disabled=!0},t.prototype.setText=function(i){var r=this.getLabel(),n=r.getElementsByClassName(Yw)[0];n?n.textContent=i:(i=this.enableHtmlSanitizer?Pt.sanitize(i):i,n=this.createElement("span",{className:Yw,innerHTML:i}),r.appendChild(n)),this.labelPosition==="Before"?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},t.prototype.updateHtmlAttribute=function(){if(!g(this.htmlAttributes))for(var i=0,r=Object.keys(this.htmlAttributes);i<r.length;i++){var n=r[i],s=this.element.parentElement;o3.indexOf(n)>-1?n==="class"?X([s],this.htmlAttributes[""+n].replace(/\s+/g," ").trim().split(" ")):n==="title"||n==="style"?s.setAttribute(n,this.htmlAttributes[""+n]):this.element.setAttribute(n,this.htmlAttributes[""+n]):s.setAttribute(n,this.htmlAttributes[""+n])}},t.prototype.unWireEvents=function(){var i=this.wrapper;if(T.remove(this.element,"change",this.changeHandler),T.remove(this.element,"focus",this.focusHandler),T.remove(this.element,"focusout",this.focusOutHandler),T.remove(this.element,"keyup",this.keyUpHandler),i){var r=i.getElementsByTagName("label")[0];r&&(T.remove(r,"mousedown",this.labelMouseDownHandler),T.remove(r,"mouseup",this.labelMouseUpHandler),T.remove(r,"mouseleave",this.labelMouseLeaveHandler))}this.formElement&&T.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.wireEvents=function(){var i=this.getLabel();T.add(this.element,"change",this.changeHandler,this),T.add(this.element,"keyup",this.keyUpHandler,this),T.add(this.element,"focus",this.focusHandler,this),T.add(this.element,"focusout",this.focusOutHandler,this);var r=i.getElementsByClassName(Yw)[0];r&&(T.add(r,"mousedown",this.labelMouseDownHandler,this),T.add(r,"mouseup",this.labelMouseUpHandler,this),T.add(r,"mouseleave",this.labelMouseLeaveHandler,this)),this.formElement&&T.add(this.formElement,"reset",this.formResetHandler,this)},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()};var e;return va([G()],t.prototype,"change",void 0),va([G()],t.prototype,"created",void 0),va([w(!1)],t.prototype,"checked",void 0),va([w("")],t.prototype,"cssClass",void 0),va([w(!1)],t.prototype,"disabled",void 0),va([w("")],t.prototype,"label",void 0),va([w("After")],t.prototype,"labelPosition",void 0),va([w("")],t.prototype,"name",void 0),va([w("")],t.prototype,"value",void 0),va([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),va([w({})],t.prototype,"htmlAttributes",void 0),t=e=va([It],t),t})(ti);var Lo,oh,Ys,ef,Sx=!1;function Nm(o,t){var e=!1,i={left:0,top:0},r=o;if(!o||!t)return i;for(g(t.offsetParent)&&t.style.position==="fixed"&&(e=!0);(t.offsetParent||e)&&o&&t.offsetParent!==o;)i.left+=o.offsetLeft,i.top+=o.offsetTop,o=o.offsetParent;for(o=r;(t.offsetParent||e)&&o&&t.offsetParent!==o;)i.left-=o.scrollLeft,i.top-=o.scrollTop,o=o.parentElement;return i}function Ar(o,t,e,i,r){if(oh=void 0,oh=r,Sx=!!i,!o)return{left:0,top:0};t||(t="left"),e||(e="top"),ef=o.ownerDocument,Ys=o;var n={left:0,top:0};return l3(t.toLowerCase(),e.toLowerCase(),n)}function cl(o,t){t.left=o}function ul(o,t){t.top=o}function l3(o,t,e){switch(Lo=Ys.getBoundingClientRect(),t+o){case"topcenter":cl(Zw(),e),ul(wm(),e);break;case"topright":cl($w(),e),ul(wm(),e);break;case"centercenter":cl(Zw(),e),ul(Kw(),e);break;case"centerright":cl($w(),e),ul(Kw(),e);break;case"centerleft":cl(xm(),e),ul(Kw(),e);break;case"bottomcenter":cl(Zw(),e),ul(Xw(),e);break;case"bottomright":cl($w(),e),ul(Xw(),e);break;case"bottomleft":cl(xm(),e),ul(Xw(),e);break;default:case"topleft":cl(xm(),e),ul(wm(),e);break}return Ys=null,e}function BN(){return ef.documentElement.scrollTop||ef.body.scrollTop}function jN(){return ef.documentElement.scrollLeft||ef.body.scrollLeft}function Xw(){return Sx?Lo.bottom:Lo.bottom+BN()}function Kw(){return wm()+Lo.height/2}function wm(){return Sx?Lo.top:Lo.top+BN()}function xm(){return Lo.left+jN()}function $w(){var o=Ys&&((Ys.classList.contains("e-date-wrapper")||Ys.classList.contains("e-datetime-wrapper"))&&Ys.classList.contains("e-rtl")||Ys.classList.contains("e-ddl")&&Ys.classList.contains("e-rtl")||Ys.classList.contains("e-date-range-wrapper"))?oh?oh.width:0:oh&&Lo.width>=oh.width?oh.width:0;return Ys&&Ys.classList.contains("e-rtl")&&Ys.classList.contains("e-multiselect")&&(o=oh.width),Lo.right+jN()-o}function Zw(){return xm()+Lo.width/2}var hh,Ns;function km(o,t,e,i){if(t===void 0&&(t=null),e===void 0&&(e={X:!1,Y:!1}),!e.Y&&!e.X)return{left:0,top:0};var r=o.getBoundingClientRect();if(Ns=t,hh=o.ownerDocument,i||(i=Ar(o,"left","top")),e.X){var n=Ns?qN():KN(),s=Ix(),a=Mx(),l=s-i.left,h=i.left+r.width-a;r.width>n?l>0&&h<=0?i.left=a-r.width:h>0&&l<=0?i.left=s:i.left=l>h?a-r.width:s:l>0?i.left+=l:h>0&&(i.left-=h)}if(e.Y){var c=Ns?YN():XN(),u=xx(),d=Dx(),p=u-i.top,f=i.top+r.height-d;r.height>c?p>0&&f<=0?i.top=d-r.height:f>0&&p<=0?i.top=u:i.top=p>f?d-r.height:u:p>0?i.top+=p:f>0&&(i.top-=f)}return i}function gs(o,t,e,i){t===void 0&&(t=null);var r=Ar(o,"left","top");e&&(r.left=e),i&&(r.top=i);var n=[];Ns=t,hh=o.ownerDocument;var s=o.getBoundingClientRect(),a=r.top,l=r.left,h=r.left+s.width,c=r.top+s.height,u=WN(a,c),d=VN(l,h);return u.topSide&&n.push("top"),d.rightSide&&n.push("right"),d.leftSide&&n.push("left"),u.bottomSide&&n.push("bottom"),n}function h3(o,t,e,i,r,n,s,a,l){if(s===void 0&&(s=null),a===void 0&&(a={X:!0,Y:!0}),!(!t||!o||!r||!n||!a.X&&!a.Y)){var h={TL:null,TR:null,BL:null,BR:null},c={TL:null,TR:null,BL:null,BR:null},u;if(window.getComputedStyle(o).display==="none"){var d=o.style.visibility;o.style.visibility="hidden",o.style.display="block",u=o.getBoundingClientRect(),o.style.removeProperty("display"),o.style.visibility=d}else u=o.getBoundingClientRect();var p={posX:r,posY:n,offsetX:e,offsetY:i,position:{left:0,top:0}};Ns=s,hh=t.ownerDocument,u3(t,h,p,l,u),wx(c,p,u),a.X&&_N(t,c,h,p,u,!0),a.Y&&h.TL.top>-1&&UN(t,c,h,p,u,!0),c3(o,p,u)}}function c3(o,t,e){var i=0,r=0;if(o.offsetParent!=null&&(getComputedStyle(o.offsetParent).position==="absolute"||getComputedStyle(o.offsetParent).position==="relative")){var n=Ar(o.offsetParent,"left","top",!1,e);i=n.left,r=n.top}var s=1,a=1,l=HN(o);if(l){var h=getComputedStyle(l).transform;if(h!=="none"){var c=new DOMMatrix(h);s=c.a,a=c.d}var u=getComputedStyle(l).zoom;if(u!=="none"){var d=Cx(document.body);s=d*s,a=d*a}}o.style.top=t.position.top/a+t.offsetY-r/a+"px",o.style.left=t.position.left/s+t.offsetX-i/s+"px"}function Cx(o){var t=getComputedStyle(o).zoom;return parseFloat(t)||1}function HN(o){for(;o;){var t=window.getComputedStyle(o).transform,e=Cx(document.body);if(t&&t!=="none"||e&&e!==1)return o;if(o===document.body)return null;o=o.offsetParent||o.parentElement}return null}function u3(o,t,e,i,r){e.position=Ar(o,e.posX,e.posY,i,r),t.TL=Ar(o,"left","top",i,r),t.TR=Ar(o,"right","top",i,r),t.BR=Ar(o,"left","bottom",i,r),t.BL=Ar(o,"right","bottom",i,r)}function wx(o,t,e){o.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},o.TR={top:o.TL.top,left:o.TL.left+e.width},o.BL={top:o.TL.top+e.height,left:o.TL.left},o.BR={top:o.TL.top+e.height,left:o.TL.left+e.width}}function VN(o,t){var e=!1,i=!1;return o-Dm()<Ix()&&(e=!0),t>Mx()&&(i=!0),{leftSide:e,rightSide:i}}function _N(o,t,e,i,r,n){var s=VN(t.TL.left,t.TR.left);e.TL.left-Dm()<=Ix()&&(s.leftSide=!1),e.TR.left>Mx()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=Ar(o,i.posX,i.posY,!1),wx(t,i,r),n&&_N(o,t,e,i,r,!1))}function UN(o,t,e,i,r,n){var s=WN(t.TL.top,t.BL.top);e.TL.top-Mm()<=xx()&&(s.topSide=!1),e.BL.top>=Dx()&&o.getBoundingClientRect().bottom<window.innerHeight&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=Ar(o,i.posX,i.posY,!1,r),wx(t,i,r),n&&UN(o,t,e,i,r,!1))}function WN(o,t){var e=!1,i=!1;return o-Mm()<xx()&&(e=!0),t>Dx()&&(i=!0),{topSide:e,bottomSide:i}}function qN(){return Ns.getBoundingClientRect().width}function YN(){return Ns.getBoundingClientRect().height}function GN(){return Ns.getBoundingClientRect().left}function QN(){return Ns.getBoundingClientRect().top}function xx(){return Ns?QN():0}function Ix(){return Ns?GN():0}function Mx(){return Ns?Dm()+GN()+qN():Dm()+KN()}function Dx(){return Ns?Mm()+QN()+YN():Mm()+XN()}function Mm(){return hh.documentElement.scrollTop||hh.body.scrollTop}function Dm(){return hh.documentElement.scrollLeft||hh.body.scrollLeft}function XN(){return window.innerHeight}function KN(){var o=window.innerWidth,t=document.documentElement.getBoundingClientRect(),e=g(document.documentElement)?0:t.width;return o-(o-e)}function $N(){Ns=null,hh=null}var ZN=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),rn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},JN=(function(o){ZN(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return rn([w("left")],t.prototype,"X",void 0),rn([w("top")],t.prototype,"Y",void 0),t})(Oe),yn={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},es=(function(o){ZN(t,o);function t(e,i){return o.call(this,i,e)||this}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"width":Ze(this.element,{width:Ae(e.width)});break;case"height":Ze(this.element,{height:Ae(e.height)});break;case"zIndex":Ze(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":{var a=e.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+a).toString()+"px";break}case"offsetY":{var l=e.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+l).toString()+"px";break}case"content":this.setContent();break;case"actionOnScroll":e.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},t.prototype.getModuleName=function(){return"popup"},t.prototype.resolveCollision=function(){this.checkCollision()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(yn.ROOT,yn.RTL,yn.OPEN,yn.CLOSE),this.content=null,this.relateTo=null,$N(),o.prototype.destroy.call(this)},t.prototype.render=function(){this.element.classList.add(yn.ROOT);var e={};this.zIndex!==1e3&&(e.zIndex=this.zIndex),this.width!=="auto"&&(e.width=Ae(this.width)),this.height!=="auto"&&(e.height=Ae(this.height)),Ze(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},t.prototype.wireEvents=function(){j.isDevice&&T.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},t.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];T.add(r,"scroll",this.scrollRefresh,this)}},t.prototype.unwireEvents=function(){j.isDevice&&T.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},t.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];T.remove(r,"scroll",this.scrollRefresh)}},t.prototype.getRelateToElement=function(){var e=this.relateTo===""||g(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},t.prototype.scrollRefresh=function(e){if(this.actionOnScroll==="reposition"?!g(this.element)&&!(this.element.offsetParent===e.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&e.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),e.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},t.prototype.isElementOnViewport=function(e,i){for(var r=this.getScrollableParent(e),n=0;n<r.length;n++)if(!this.isElementVisible(e,r[n]))return!1;return!0},t.prototype.isElementVisible=function(e,i){var r=this.checkGetBoundingClientRect(e);if(!r.height||!r.width)return!1;if(g(this.checkGetBoundingClientRect(i))){var s=window,a={top:s.scrollY,left:s.scrollX,right:s.scrollX+s.outerWidth,bottom:s.scrollY+s.outerHeight},l=Ar(e),h={top:l.top,left:l.left,right:l.left+r.width,bottom:l.top+r.height},c={top:a.bottom-h.top,left:a.right-h.left,bottom:h.bottom-a.top,right:h.right-a.left};return c.top>0&&c.left>0&&c.right>0&&c.bottom>0}else{var n=i.getBoundingClientRect();return!(r.bottom<n.top)&&!(r.bottom>n.bottom)&&!(r.right>n.right)&&!(r.left<n.left)}},t.prototype.preRender=function(){},t.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(yn.RTL):this.element.classList.remove(yn.RTL)},t.prototype.setContent=function(){if(!g(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var e=this.getRelateToElement(),i=this.content.props;(!e.classList.contains("e-dropdown-btn")||g(i))&&this.element.appendChild(this.content)}},t.prototype.orientationOnChange=function(){var e=this;setTimeout(function(){e.refreshPosition()},200)},t.prototype.refreshPosition=function(e,i){g(e)||this.checkFixedParent(e),this.reposition(),i||this.checkCollision()},t.prototype.reposition=function(){var e,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")e={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var n=void 0,s=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?e={left:i.left,top:this.position.Y}:e={left:this.position.X,top:i.top},this.element.style.display=s,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(r){var a=this.element.clientHeight,s=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,a),this.element.style.display=s}else e={left:0,top:0};g(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")},t.prototype.checkGetBoundingClientRect=function(e){var i;try{return i=e.getBoundingClientRect(),i}catch{return null}},t.prototype.getAnchorPosition=function(e,i,r,n,s,a){a===void 0&&(a=0);var l=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(e);if(g(l)||g(h))return null;var c=e,u={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&e.tagName==="BODY"?u=Ar(e):(i.classList.contains("e-dlg-modal")&&c.tagName!=="BODY"&&(i=i.parentElement),u=Nm(c,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.left+=window.innerWidth/2-l.width/2:this.targetType==="container"?u.left+=h.width/2-l.width/2:u.left+=h.width/2;break;case"right":if(i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container")u.left+=window.innerWidth-l.width;else if(this.targetType==="container"){var d=1,p=HN(i);if(p){var f=getComputedStyle(p).transform;if(f!=="none"){var v=new DOMMatrix(f);d=v.a}var m=getComputedStyle(p).zoom;if(m!=="none"){var y=Cx(document.body);d=y*d}}u.left+=(h.width-l.width)/d}else u.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight/2-l.height/2:this.targetType==="container"?u.top+=h.height/2-l.height/2:u.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight-l.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?u.top+=h.height-l.height:this.targetType==="container"&&i.classList.contains("e-dialog")?u.top+=h.height-a:u.top+=h.height;break}return u.left+=n,u.top+=s,u},t.prototype.callFlip=function(e){var i=this.getRelateToElement();h3(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)},t.prototype.callFit=function(e){if(gs(this.element,this.viewPortElement).length!==0)if(g(this.viewPortElement)){var i=km(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=i.left+"px"),e.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),n=this.checkGetBoundingClientRect(this.viewPortElement);if(g(r)||g(n))return null;e&&e.Y===!0&&(n.top>r.top?this.element.style.top="0px":n.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-n.bottom)+"px")),e&&e.X===!0&&(n.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-n.right)+"px":n.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-r.left)+"px"))}},t.prototype.checkCollision=function(){var e=this.collision.X,i=this.collision.Y;e==="none"&&i==="none"||(e==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):e==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(e==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),e==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},t.prototype.show=function(e,i){var r=this;if(this.wireEvents(),this.getRelateToElement(),this.zIndex===1e3||!g(i)){var n=g(i)?this.element:i;this.zIndex=Gs(n),Ze(this.element,{zIndex:this.zIndex})}e=!g(e)&&typeof e=="object"?e:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(Z([this.element],yn.CLOSE),X([this.element],yn.OPEN),this.checkCollision(),Z([this.element],yn.OPEN),X([this.element],yn.CLOSE)),g(e)?(Z([this.element],yn.CLOSE),X([this.element],yn.OPEN),this.trigger("open")):(e.begin=function(){r.isDestroyed||(Z([r.element],yn.CLOSE),X([r.element],yn.OPEN))},e.end=function(){r.isDestroyed||r.trigger("open")},new Mt(e).animate(this.element))},t.prototype.hide=function(e){var i=this;e=!g(e)&&typeof e=="object"?e:this.hideAnimation,g(e)?(Z([this.element],yn.OPEN),X([this.element],yn.CLOSE),this.trigger("close")):(e.end=function(){i.isDestroyed||(Z([i.element],yn.OPEN),X([i.element],yn.CLOSE),i.trigger("close"))},new Mt(e).animate(this.element)),this.unwireEvents()},t.prototype.getScrollableParent=function(e){return this.checkFixedParent(e),Fm(e,this.fixedParent)},t.prototype.checkFixedParent=function(e){for(var i=e.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);(r.position==="fixed"||r.position==="sticky")&&!g(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?Ae(window.scrollY-parseInt(this.element.style.top,10)):Ae(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!g(this.element)&&g(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},rn([w("auto")],t.prototype,"height",void 0),rn([w("auto")],t.prototype,"width",void 0),rn([w(null)],t.prototype,"content",void 0),rn([w("container")],t.prototype,"targetType",void 0),rn([w(null)],t.prototype,"viewPortElement",void 0),rn([w({X:"none",Y:"none"})],t.prototype,"collision",void 0),rn([w("")],t.prototype,"relateTo",void 0),rn([Ce({},JN)],t.prototype,"position",void 0),rn([w(0)],t.prototype,"offsetX",void 0),rn([w(0)],t.prototype,"offsetY",void 0),rn([w(1e3)],t.prototype,"zIndex",void 0),rn([w(!1)],t.prototype,"enableRtl",void 0),rn([w("reposition")],t.prototype,"actionOnScroll",void 0),rn([w(null)],t.prototype,"showAnimation",void 0),rn([w(null)],t.prototype,"hideAnimation",void 0),rn([G()],t.prototype,"open",void 0),rn([G()],t.prototype,"close",void 0),rn([G()],t.prototype,"targetExitViewport",void 0),t=rn([It],t),t})(ti);function Fm(o,t){for(var e=getComputedStyle(o),i=[],r=/(auto|scroll)/,n=o.parentElement;n&&n.tagName!=="HTML";){var s=getComputedStyle(n);!(e.position==="absolute"&&s.position==="static")&&r.test(s.overflow+s.overflowY+s.overflowX)&&i.push(n),n=n.parentElement}return t||i.push(document),i}function Gs(o){for(var t=o.parentElement,e=[];t&&t.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&e.push(i),t=t.parentElement}for(var n=[],s=0;s<document.body.children.length;s++)if(!o.isEqualNode(document.body.children[s])){var i=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}n.push("999");var a=[];if(!g(o.parentElement)&&o.parentElement.tagName!=="BODY"){for(var l=[].slice.call(o.parentElement.children),s=0;s<l.length;s++)if(!o.isEqualNode(l[s])){var i=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&a.push(i)}}var h=e.concat(n,a),c=Math.max.apply(Math,h)+1;return c>2147483647?2147483647:c}var Jw=["north-west","north","north-east","west","east","south-west","south","south-east"],nf="e-resize-handle",lh="e-focused-handle",d3="e-dlg-resizable",eN=["e-restrict-left"],ek="e-resize-viewport",p3=["north","west","east","south"],Mi,Ja,Ex=0,Tx=0,tk=0,ik=0,tf=0,rf=0,Bu,pl,Ax,fl,Xt,ju=null,Em=null,Tm=null,dl,vx=0,Am=!0,tN=0,ex=!0;function f3(o){ju=o.resizeBegin,Em=o.resizing,Tm=o.resizeComplete,Mi=iN(o.element),Xt=iN(o.boundary);for(var t=o.direction.split(" "),e=0;e<t.length;e++)if(p3.indexOf(t[e])>=0&&t[e])g3(t[e]);else if(t[e].trim()!==""){var i=et("div",{className:"e-icons "+nf+" e-"+t[e]});Mi.appendChild(i)}Bu=o.minHeight,Ax=o.minWidth,fl=o.maxWidth,pl=o.maxHeight,vx++,o.proxy&&o.proxy.element&&o.proxy.element.classList.contains("e-dialog")?rN(o.proxy):rN()}function g3(o){Lx();var t=et("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+o),o==="south"&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),o==="north"&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),o==="east"&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),o==="west"&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),Mi.appendChild(t)}function iN(o){var t;return g(o)||(typeof o=="string"?t=document.querySelector(o):t=o),t}function rN(o){for(var t=o||this,e=Mi.querySelectorAll("."+nf),i=0;i<e.length;i++){Ja=e[i],T.add(Ja,"mousedown",nN,t);var r=j.info.name==="msie"?"pointerdown":"touchstart";T.add(Ja,r,sN,t)}var n=Mi.querySelectorAll(".e-dialog-border-resize");if(!g(n))for(var i=0;i<n.length;i++){Ja=n[i],T.add(Ja,"mousedown",nN,t);var r=j.info.name==="msie"?"pointerdown":"touchstart";T.add(Ja,r,sN,t)}}function rk(o){return o.indexOf("mouse")>-1?"mouse":"touch"}function nN(o){if(o.preventDefault(),Mi=o.target.parentElement,Lx(),tf=o.pageX,rf=o.pageY,o.target.classList.add(lh),!g(ju)){var t=this;if(ju(o,t)===!0)return}this.targetEle&&Mi&&Mi.querySelector("."+d3)&&(Xt=this.target==="body"?null:this.targetEle,fl=this.targetEle.clientWidth,pl=this.targetEle.clientHeight);var e=g(Xt)?document:Xt;T.add(e,"mousemove",Jp,this),T.add(document,"mouseup",Lm,this);for(var i=0;i<eN.length;i++)Mi.classList.contains(eN[i])?Am=!1:Am=!0}function Lm(o){var t=j.info.name==="msie"?"pointermove":"touchmove",e=j.info.name==="msie"?"pointerup":"touchend",i=g(Xt)?document:Xt,r=j.info.name==="msie"?"pointerdown":"touchstart";if(T.remove(i,"mousemove",Jp),T.remove(i,t,Jp),T.remove(i,r,Jp),g(document.body.querySelector("."+lh))||document.body.querySelector("."+lh).classList.remove(lh),!g(Tm)){var n=this;Tm(o,n)}T.remove(document,"mouseup",Lm),T.remove(document,e,Lm)}function Lx(){Ex=parseFloat(getComputedStyle(Mi,null).getPropertyValue("width").replace("px","")),Tx=parseFloat(getComputedStyle(Mi,null).getPropertyValue("height").replace("px","")),tk=Mi.getBoundingClientRect().left,ik=Mi.getBoundingClientRect().top}function sN(o){Mi=o.target.parentElement,Lx();var t=Mi.classList.contains("e-dialog");(o.target.classList.contains(nf)||o.target.classList.contains("e-dialog-border-resize"))&&t&&o.target.classList.add(lh);var e=o.touches?o.changedTouches[0]:o;if(tf=e.pageX,rf=e.pageY,!g(ju)){var i=this;if(ju(o,i)===!0)return}var r=j.info.name==="msie"?"pointermove":"touchmove",n=j.info.name==="msie"?"pointerup":"touchend",s=g(Xt)?document:Xt;T.add(s,r,Jp,this),T.add(document,n,Lm,this)}function Jp(o){if(o.target.classList.contains(nf)&&o.target.classList.contains(lh)?Ja=o.target:g(document.body.querySelector("."+lh))||(Ja=document.body.querySelector("."+lh)),!g(Ja)){for(var t="",e=0;e<Jw.length;e++)Ja.classList.contains("e-"+Jw[e])&&(t=Jw[e]);if(!g(Em)){var i=this;Em(o,i)}switch(t){case"south":tx(o);break;case"north":ix(o);break;case"west":rx(o);break;case"east":nx(o);break;case"south-east":tx(o),nx(o);break;case"south-west":tx(o),rx(o);break;case"north-east":ix(o),nx(o);break;case"north-west":ix(o),rx(o);break}}}function ch(o){return o.getBoundingClientRect()}function tx(o){var t=document.documentElement.clientHeight,e=!1,i=o.touches?o.changedTouches[0]:o,r=i.pageY,n=ch(Mi),s;g(Xt)||(s=ch(Xt)),g(Xt)?g(Xt)&&(t-r>=0||n.top<0)&&(e=!0):e=!0;var a=Tx+(r-rf);a=a>Bu?a:Bu;var l=0;g(Xt)||(l=s.top);var h=g(Xt)?0:Xt.offsetHeight-Xt.clientHeight,c=n.top-l-h/2;if(c=c<0?0:c,n.top>0&&c+a>pl){if(e=!1,Mi.classList.contains(ek))return;Mi.style.height=pl-parseInt(c.toString(),10)+"px";return}var u=0;if(e){n.top<0&&t+(n.height+n.top)>0&&(u=n.top,a+u<=30&&(a=n.height-(n.height+n.top)+30)),a+n.top>=pl&&(Mi.style.height=n.height+(t-(n.height+n.top))+"px");var d=g(Xt)?u:c;a>=Bu&&a+d<=pl&&(Mi.style.height=a+"px")}}function ix(o){var t=!1,e,i=rk(o.type)==="mouse"?o.pageY:o.touches[0].pageY,r=ch(Mi),n=g(Xt)?0:Xt.offsetHeight-Xt.clientHeight;g(Xt)||(e=ch(Xt)),(!g(Xt)&&r.top-e.top>0||g(Xt)&&i>0||!g(Xt)&&Math.floor(r.top-e.top+r.height+(e.bottom-r.bottom))-n<=pl)&&(t=!0);var s=Tx-(i-rf);if(t&&s>=Bu&&s<=pl){var a=0;g(Xt)||(a=e.top);var l=ik-a+(i-rf);l=l>0?l:1,Mi.style.height=s+"px",Mi.style.top=l+"px"}}function rx(o){var t=document.documentElement.clientWidth,e=!1,i;g(Xt)||(i=ch(Xt));var r=rk(o.type)==="mouse"?o.pageX:o.touches[0].pageX,n=ch(Mi),s=g(Xt)?0:Xt.offsetWidth-Xt.clientWidth,a=g(Xt)?0:i.left,l=g(Xt)?0:i.width;g(dl)&&(g(Xt)?dl=t:(dl=n.left-a-s/2+n.width,dl=dl+(l-s-dl))),(!g(Xt)&&Math.floor(n.left-i.left+n.width+(i.right-n.right))-s<=fl||g(Xt)&&r>=0)&&(e=!0);var h=Ex-(r-tf);if(Am&&(h=h>dl?dl:h),e&&h>=Ax&&h<=fl){var c=0;g(Xt)||(c=i.left);var u=tk-c+(r-tf);u=u>0?u:1,h!==tN&&ex&&(Mi.style.width=h+"px"),Am&&(Mi.style.left=u+"px",u===1?ex=!1:ex=!0)}tN=h}function nx(o){var t=document.documentElement.clientWidth,e=!1,i;g(Xt)||(i=ch(Xt));var r=o.touches?o.changedTouches[0]:o,n=r.pageX,s=ch(Mi);(!g(Xt)&&(s.left-i.left+s.width<=fl||s.right-i.left>=s.width)||g(Xt)&&t-n>0)&&(e=!0);var a=Ex+(n-tf),l=0;if(g(Xt)||(l=i.left),s.left-l+a>fl){if(e=!1,Mi.classList.contains(ek))return;Mi.style.width=fl-(s.left-l)+"px"}e&&a>=Ax&&a<=fl&&(Mi.style.width=a+"px")}function v3(o){Bu=o}function m3(o){fl=o}function y3(o){pl=o}function aN(){for(var o=Mi.querySelectorAll("."+nf),t=0;t<o.length;t++)se(o[t]);var e=Mi.querySelectorAll(".e-dialog-border-resize");if(!g(e))for(var t=0;t<e.length;t++)se(e[t])}function b3(){vx--,vx===0&&(Mi=null,Ja=null,Xt=null,dl=null,ju=null,Em=null,Tm=null)}var Nx=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Qt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},S3=(function(o){Nx(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Qt([w(!0)],t.prototype,"isFlat",void 0),Qt([w()],t.prototype,"buttonModel",void 0),Qt([w("Button")],t.prototype,"type",void 0),Qt([G()],t.prototype,"click",void 0),t})(Oe),C3=(function(o){Nx(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Qt([w("Fade")],t.prototype,"effect",void 0),Qt([w(400)],t.prototype,"duration",void 0),Qt([w(0)],t.prototype,"delay",void 0),t})(Oe),vm="e-dialog",sx="e-rtl",ax="e-dlg-header-content",oN="e-dlg-header",mm="e-footer-content",ym="e-dlg-modal",w3="e-dlg-content",lN="e-icon-dlg-close",x3="e-dlg-overlay",Za="e-dlg-target",I3="e-dlg-container",ya="e-scroll-disabled",M3="e-primary",D3="e-icons",E3="e-popup",hN="e-device",bm="e-dlg-fullscreen",cN="e-dlg-closeicon-btn",T3="e-popup-close",uN="e-popup-open",dN="Information",pN="e-scroll-disabled",nk="e-alert-dialog",sk="e-confirm-dialog",ox="e-dlg-resizable",zu="e-restrict-left",fN="e-resize-viewport",A3="e-dlg-ref-element",lx="user action",L3="close icon",N3="escape",k3="overlayClick",F3="e-draggable",gN='input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]',cc=(function(o){Nx(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.needsID=!0,r}return t.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.width==="100%"&&(this.element.style.width=""),this.minHeight!==""&&(this.element.style.minHeight=Ae(this.minHeight)),this.enableResize&&(this.setResize(),this.isModal&&(this.isModelResize=!0),this.animationSettings.effect==="None"&&this.getMinHeight()),this.renderComplete()},t.prototype.initializeValue=function(){this.dlgClosedBy=lx},t.prototype.preRender=function(){var e=this;this.initializeValue(),this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(n){e.dlgClosedBy=L3,e.hide(n)},this.dlgOverlayClickEventHandler=function(n){e.dlgClosedBy=k3,n.preventFocus=!1,e.trigger("overlayClick",n,function(s){s.preventFocus||e.focusContent(),e.dlgClosedBy=lx})};var i={close:"Close"};if(this.l10n=new Ri("dialog",i,this.locale),this.checkPositionData(),g(this.target)){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=r}},t.prototype.updatePersistData=function(){this.enablePersistence&&this.setProperties({width:parseFloat(this.element.style.width),height:parseFloat(this.element.style.height),position:{X:parseFloat(this.dragObj.element.style.left),Y:parseFloat(this.dragObj.element.style.top)}},!0)},t.prototype.isNumberValue=function(e){var i=/^[-+]?\d*\.?\d+$/.test(e);return i},t.prototype.checkPositionData=function(){if(!g(this.position)){if(!g(this.position.X)&&typeof this.position.X!="number"){var e=this.isNumberValue(this.position.X);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=i}}if(!g(this.position.Y)&&typeof this.position.Y!="number"){var e=this.isNumberValue(this.position.Y);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=i}}}},t.prototype.getEle=function(e,i){for(var r=void 0,n=0;n<e.length;n++)if(e[n].classList.contains(i)){r=e[n];break}return r},t.prototype.getMinHeight=function(){var e="0px",i="0px";g(this.element.querySelector("."+ax))||(e=getComputedStyle(this.headerContent).height);var r=this.getEle(this.element.children,mm);g(r)||(i=getComputedStyle(r).height);var n=parseInt(e.slice(0,e.indexOf("p")),10),s=parseInt(i.slice(0,i.indexOf("p")),10);return v3(n+30+(isNaN(s)?0:s)),n+30+s},t.prototype.onResizeStart=function(e,i){if(i.trigger("resizeStart",e),!e.cancel&&this.isModelResize&&!g(this.dlgContainer)&&this.dlgContainer.classList.contains("e-dlg-"+this.position.X+"-"+this.position.Y)){this.setPopupPosition(),this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y);var r=this.getTargetContainer(this.target);if(r instanceof Element){var n=window.getComputedStyle(r);n.getPropertyValue("direction")==="rtl"?this.element.style.position="absolute":this.element.style.position="relative"}else this.element.style.position="relative";this.element.classList.contains(zu)&&this.element.classList.remove(zu),this.isModelResize=!1}return e.cancel},t.prototype.onResizing=function(e,i){i.trigger("resizing",e)},t.prototype.onResizeComplete=function(e,i){i.trigger("resizeStop",e),this.updatePersistData()},t.prototype.setResize=function(){if(this.enableResize){this.element.classList.add(ox);for(var e=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth,r="",n=0;n<this.resizeHandles.length;n++)if(this.resizeHandles[n]==="All"){r="south north east west north-east north-west south-east south-west";break}else{var s="";switch(this.resizeHandles[n].toString()){case"SouthEast":s="south-east";break;case"SouthWest":s="south-west";break;case"NorthEast":s="north-east";break;case"NorthWest":s="north-west";break;default:s=this.resizeHandles[n].toString();break}r+=s.toLocaleLowerCase()+" "}this.enableRtl&&r.trim()==="south-east"?r="south-west":this.enableRtl&&r.trim()==="south-west"&&(r="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(zu):this.isModal&&this.target===document.body&&this.element.classList.add(fN),f3({element:this.element,direction:r,minHeight:parseInt(e.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else aN(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove(zu):this.element.classList.remove(fN),this.element.classList.remove(ox)},t.prototype.getFocusElement=function(e){var i=e.querySelectorAll(gN);return{element:i[i.length-1]}},t.prototype.keyDown=function(e){var i=this;if(e.keyCode===9&&this.isModal){var r=void 0;if(g(this.btnObj)||(r=this.btnObj[this.btnObj.length-1]),g(this.btnObj)&&!g(this.ftrTemplateContent)&&(r=this.getFocusElement(this.ftrTemplateContent),g(this.btnObj)&&(!r||g(r.element)))){var n=this.element.querySelectorAll(gN);n.length>0&&document.activeElement===n[n.length-1]&&(e.preventDefault(),this.focusableElements(this.element).focus())}g(this.btnObj)&&g(this.ftrTemplateContent)&&!g(this.contentEle)&&(r=this.getFocusElement(this.contentEle)),!g(r)&&document.activeElement===r.element&&!e.shiftKey&&(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),g(r)||r.element.focus())}var s=document.activeElement,a=["input","textarea"].indexOf(s.tagName.toLowerCase())>-1,l=!1;if(a||(l=s.hasAttribute("contenteditable")&&s.getAttribute("contenteditable")==="true"),e.keyCode===27&&this.closeOnEscape){this.dlgClosedBy=N3;var h=document.querySelector(".e-popup-open:not(.e-dialog)");!g(h)&&!h.classList.contains("e-toolbar-pop")&&!h.classList.contains("e-slider-tooltip")||this.hide(e)}if(e.keyCode===13&&!e.ctrlKey&&s.tagName.toLowerCase()!=="textarea"&&a&&!g(this.primaryButtonEle)||e.keyCode===13&&e.ctrlKey&&(s.tagName.toLowerCase()==="textarea"||l)&&!g(this.primaryButtonEle)){var c,u=this.buttons.some(function(d,p){c=p;var f=d.buttonModel;return!g(f)&&f.isPrimary===!0});u&&typeof this.buttons[c].click=="function"&&!this.primaryButtonEle.disabled&&setTimeout(function(){i.buttons[c].click.call(i,e)})}},t.prototype.initialize=function(){g(this.target)||(this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target),this.isBlazorServerRender()||X([this.element],vm),j.isDevice&&X([this.element],hN),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()},t.prototype.initRender=function(){var e=this;if(this.initialRender=!0,this.isBlazorServerRender()||Ee(this.element,{role:"dialog"}),this.zIndex===1e3?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.setTargetContent(),this.header!==""&&!g(this.header)&&this.setHeader(),this.renderCloseIcon(),this.setContent(),this.footerTemplate!==""&&!g(this.footerTemplate)?this.setFooterTemplate():!g(this.buttons[0])&&!g(this.buttons[0].buttonModel)&&this.setButton(),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging(),Ee(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),this.element.classList.contains(nk)!==!0&&this.element.classList.contains(sk)!==!0&&!g(this.element.parentElement)){var i=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:A3}),i.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}if(g(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new es(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:function(s){var a={container:e.isModal?e.dlgContainer:e.element,element:e.element,target:e.target,preventFocus:!1};e.enableResize&&e.resetResizeIcon(),e.trigger("open",a,function(l){l.preventFocus||e.focusContent()})},close:function(s){e.isModal&&X([e.dlgOverlay],"e-fade"),e.unBindEvent(e.element),e.isModal&&(e.dlgContainer.style.display="none"),e.trigger("close",e.closeArgs);var a=document.activeElement;!g(a)&&!g(a.blur)&&a.blur(),!g(e.storeActiveElement)&&!g(e.storeActiveElement.focus)&&!e.closeArgs.preventFocus&&e.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(X([this.element],T3),this.isModal&&this.setOverlayZindex()),this.visible){if(this.show(),this.isModal){var r=this.getTargetContainer(this.target);if(r instanceof Element){var n=window.getComputedStyle(r);n.getPropertyValue("direction")==="rtl"&&this.setPopupPosition()}}}else this.isModal&&(this.dlgOverlay.style.display="none");this.initialRender=!1},t.prototype.getTargetContainer=function(e){var i=null;if(typeof e=="string")if(e.startsWith("#"))i=document.getElementById(e.substring(1));else if(e.startsWith(".")){var r=document.getElementsByClassName(e.substring(1));i=r.length>0?r[0]:null}else!(e instanceof HTMLElement)&&e!==document.body&&(i=document.querySelector(e));else e instanceof HTMLElement&&(i=e);return i},t.prototype.resetResizeIcon=function(){var e=this.getMinHeight();if(this.targetEle.offsetHeight<e){var i=this.enableRtl?"e-south-west":"e-south-east",r=this.element.querySelector("."+i);g(r)||(r.style.bottom="-"+e.toString()+"px")}},t.prototype.setOverlayZindex=function(e){var i;g(e)?i=parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:i=e,this.dlgOverlay.style.zIndex=(i-1).toString(),this.dlgContainer.style.zIndex=i.toString()},t.prototype.positionChange=function(){this.isModal?!isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},t.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},t.prototype.setAllowDragging=function(){var e=this,i="."+ax;this.element.classList.contains(F3)||(this.dragObj=new sh(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:i,dragStart:function(r){e.trigger("dragStart",r,function(n){$e()&&n.bindEvents(r.dragElement)})},dragStop:function(r){if(e.isModal){e.IsDragStop=!0,g(e.position)||e.dlgContainer.classList.remove("e-dlg-"+e.position.X+"-"+e.position.Y);var n=e.getTargetContainer(e.target);if(n instanceof Element){var s=window.getComputedStyle(n);s.getPropertyValue("direction")==="rtl"?e.element.style.position="absolute":e.element.style.position="relative"}else e.element.style.position="relative"}e.trigger("dragStop",r),e.isModelResize=!1,e.element.classList.remove(zu),e.updatePersistData()},drag:function(r){e.trigger("drag",r)}}),g(this.targetEle)||(this.dragObj.dragArea=this.targetEle))},t.prototype.setButton=function(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(var e=0;e<this.buttons.length;e++)if(!g(this.buttons[e].buttonModel)){var i=g(this.buttons[e].type)?"button":this.buttons[e].type.toLowerCase(),r=this.createElement("button",{className:this.cssClass,attrs:{type:i,tabindex:"0"}});this.buttonContent.push(r.outerHTML)}this.setFooterTemplate()}for(var n,e=0,s=this.element.children;e<s.length;e++)s[e].classList.contains(mm)&&(n=s[e].querySelectorAll("button"));for(var e=0;e<this.buttons.length;e++)g(this.buttons[e].buttonModel)||(this.isBlazorServerRender()||(this.btnObj[e]=new Jn(this.buttons[e].buttonModel)),!g(this.ftrTemplateContent)&&n.length>0&&(typeof this.buttons[e].click=="function"&&T.add(n[e],"click",this.buttons[e].click,this),typeof this.buttons[e].click=="object"&&T.add(n[e],"click",this.buttonClickHandler.bind(this,e),this)),!this.isBlazorServerRender()&&!g(this.ftrTemplateContent)&&(this.btnObj[e].appendTo(this.ftrTemplateContent.children[e]),this.buttons[e].isFlat&&this.btnObj[e].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]))},t.prototype.buttonClickHandler=function(e){this.trigger("buttons["+e+"].click",{})},t.prototype.setContent=function(){this.contentEle=this.createElement("div",{className:w3,id:this.element.id+"_dialog-content"}),this.headerEle?Ee(this.element,{"aria-describedby":this.element.id+"_title "+this.element.id+"_dialog-content"}):Ee(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(!g(this.content)&&this.content!==""||!this.initialRender)&&(typeof this.content=="string"&&!$e()?this.setTemplate(this.content,this.contentEle,"content"):this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content")),g(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),this.height==="auto"&&(!this.isBlazorServerRender()&&j.isIE&&this.element.style.width===""&&!g(this.width)&&(this.element.style.width=Ae(this.width)),this.setMaxHeight())},t.prototype.setTemplate=function(e,i,r){var n,s;i.classList.contains(oN)?s=this.element.id+"header":i.classList.contains(mm)?s=this.element.id+"footerTemplate":s=this.element.id+"content";var a;g(e.outerHTML)?(typeof e=="string"||typeof e!="string"||$e()&&!this.isStringTemplate)&&(typeof e=="string"&&(e=this.sanitizeHelper(e)),this.isVue||typeof e!="string"?(n=Et(e),a=e):i.innerHTML=e):i.appendChild(e);var l=[];if(!g(n)){for(var h=$e()&&!this.isStringTemplate&&a.indexOf("<div>Blazor")===0?this.isStringTemplate:!0,c=0,u=n({},this,r,s,h);c<u.length;c++){var d=u[c];l.push(d)}bt([].slice.call(l),i)}},t.prototype.sanitizeHelper=function(e){if(this.enableHtmlSanitizer){var i=Pt.beforeSanitize(),r={cancel:!1,helper:null};pe(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!g(i.helper)?e=i.helper(e):i.cancel||(e=Pt.serializeValue(i,e))}return e},t.prototype.setMaxHeight=function(){if(this.allowMaxHeight){var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!g(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,j.isIE&&this.height==="auto"&&!g(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},t.prototype.setEnableRTL=function(){this.isBlazorServerRender()||(this.enableRtl?X([this.element],sx):Z([this.element],sx)),g(this.element.querySelector(".e-resize-handle"))||(aN(),this.setResize())},t.prototype.setTargetContent=function(){var e=this;if(g(this.content)||this.content===""){var i=this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"")!=="";(this.element.children.length>0||i)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(function(r){r.nodeType!==8&&e.innerContentElement.appendChild(r)}))}},t.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:oN}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),Ee(this.element,{"aria-describedby":this.element.id+"_title"}),Ee(this.element,{"aria-labelledby":this.element.id+"_dialog-header"}),this.element.insertBefore(this.headerContent,this.element.children[0]),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging()},t.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:mm}),this.footerTemplate!==""&&!g(this.footerTemplate)?this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"):this.ftrTemplateContent.innerHTML=this.buttonContent.join(""),this.element.appendChild(this.ftrTemplateContent)},t.prototype.createHeaderContent=function(){g(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:ax}))},t.prototype.renderCloseIcon=function(){this.showCloseIcon&&(this.closeIcon=this.createElement("button",{className:cN,attrs:{type:"button"}}),this.closeIconBtnObj=new Jn({cssClass:"e-flat",iconCss:lN+" "+D3}),this.closeIconTitle(),g(this.headerContent)?(this.createHeaderContent(),$r([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):$r([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon))},t.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var e=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",e),this.closeIcon.setAttribute("aria-label",e)},t.prototype.setCSSClass=function(e){e&&(Z([this.element],e.split(" ")),this.isModal&&!g(this.dlgContainer)&&Z([this.dlgContainer],e.split(" "))),this.cssClass&&(X([this.element],this.cssClass.split(" ")),this.isModal&&!g(this.dlgContainer)&&X([this.dlgContainer],this.cssClass.split(" ")))},t.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:I3}),this.setCSSClass(),this.element.classList.remove(uN),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),X([this.element],ym),this.dlgOverlay=this.createElement("div",{className:x3}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},t.prototype.getValidFocusNode=function(e){for(var i,r=0;r<e.length;r++){if(i=e[r],(i.clientHeight>0||i.tagName.toLowerCase()==="a"&&i.hasAttribute("href"))&&i.tabIndex>-1&&!i.disabled&&!this.disableElement(i,'[disabled],[aria-disabled="true"],[type="hidden"]'))return i;i=null}return i},t.prototype.focusableElements=function(e){if(!g(e)){var i='input,select,textarea,button,a,[contenteditable="true"],[tabindex]',r=e.querySelectorAll(i);return this.getValidFocusNode(r)}return null},t.prototype.getAutoFocusNode=function(e){var i=e.querySelector("."+cN),r="[autofocus]",n=e.querySelectorAll(r),s=this.getValidFocusNode(n);if($e()&&(this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]),!g(s))i=s;else if(s=this.focusableElements(this.contentEle),g(s)){if(!g(this.primaryButtonEle))return this.element.querySelector("."+M3)}else return i=s;return i},t.prototype.disableElement=function(e,i){var r=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(r){for(;e;e=e.parentNode)if(e instanceof Element&&r.call(e,i))return e}return null},t.prototype.focusContent=function(){var e=this.getAutoFocusNode(this.element),i=g(e)?this.element:e,r=j.userAgent;(r.indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&this.element.focus(),i.focus(),this.unBindEvent(this.element),this.bindEvent(this.element)},t.prototype.bindEvent=function(e){T.add(e,"keydown",this.keyDown,this)},t.prototype.unBindEvent=function(e){T.remove(e,"keydown",this.keyDown)},t.prototype.updateSanitizeContent=function(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))},t.prototype.isBlazorServerRender=function(){return $e()&&this.isServerRendered},t.prototype.getModuleName=function(){return"dialog"},t.prototype.onPropertyChanged=function(e,i){if(this.element.classList.contains(vm))for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"content":!g(this.content)&&this.content!==""?(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),!g(this.contentEle)&&this.contentEle.getAttribute("role")!=="dialog"?(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),typeof this.content=="function"?(this.clearTemplate(["content"]),se(this.contentEle),this.contentEle=null,this.setContent()):typeof this.content=="string"?this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()):this.setContent()):g(this.contentEle)||(se(this.contentEle),this.contentEle=null);break;case"header":this.header===""||g(this.header)?this.headerEle&&(se(this.headerEle),this.headerEle=null):this.setHeader();break;case"footerTemplate":if(this.footerTemplate===""||g(this.footerTemplate)){if(!this.ftrTemplateContent)return;se(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(lN).length>0?!this.showCloseIcon&&(this.header===""||g(this.header))?(se(this.headerContent),this.headerContent=null):this.showCloseIcon||se(this.closeIcon):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":Ze(this.element,{height:Ae(e.height)}),this.updatePersistData();break;case"width":Ze(this.element,{width:Ae(e.width)}),this.updatePersistData();break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(i.cssClass);break;case"buttons":{this.unWireButtonEvents(),this.destroyButtons(),g(this.ftrTemplateContent)||(se(this.ftrTemplateContent),this.ftrTemplateContent=null),this.footerTemplate="",this.setButton();break}case"allowDragging":this.allowDragging&&!g(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(e.target);break;case"position":if(this.checkPositionData(),this.isModal){var a=this.position.X,l=this.position.Y;g(i.position)||(g(i.position.X)||(a=i.position.X),g(i.position.Y)||(l=i.position.Y)),this.dlgContainer.classList.contains("e-dlg-"+a+"-"+l)&&this.dlgContainer.classList.remove("e-dlg-"+a+"-"+l)}this.positionChange(),this.updatePersistData();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize(),this.isModelResize=this.enableResize&&this.isModal,this.enableResize&&this.dialogOpen&&this.resetResizeIcon();break;case"minHeight":this.minHeight!==""&&(this.element.style.minHeight=Ae(this.minHeight));break}}},t.prototype.setTarget=function(e){this.popupObj.relateTo=e,this.target=e,this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize(),g(this.targetEle)||(this.isModal&&!g(this.dlgContainer)?this.targetEle.appendChild(this.dlgContainer):g(this.element)||this.targetEle.appendChild(this.element))},t.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)g(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",g(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for(Z([this.element],ym),Z([document.body],[Za,ya]),se(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&T.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.setzIndex=function(e,i){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0;var n=Gs(e);this.zIndex=n>this.zIndex?n:this.zIndex,this.isProtectedOnChange=r,i&&(this.popupObj.zIndex=this.zIndex)},t.prototype.windowResizeHandler=function(){m3(this.targetEle.clientWidth),y3(this.targetEle.clientHeight),this.setMaxHeight()},t.prototype.getPersistData=function(){return this.addOnPersist(["width","height","position"])},t.prototype.removeAllChildren=function(e){for(;e.children[0];)this.removeAllChildren(e.children[0]),e.removeChild(e.children[0])},t.prototype.destroy=function(){if(!this.isDestroyed){var e=[sx,ym,ox,zu,bm,hN],i=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];Z([this.targetEle],[Za,ya]),!g(this.element)&&this.element.classList.contains(bm)&&Z([document.body],[Za,ya]),this.isModal&&Z([g(this.targetEle)?document.body:this.targetEle],ya),this.unWireEvents(),this.unWireButtonEvents(),this.destroyButtons(),g(this.closeIconBtnObj)||this.closeIconBtnObj.destroy(),g(this.dragObj)||this.dragObj.destroy(),!g(this.popupObj.element)&&this.popupObj.element.classList.contains(E3)&&this.popupObj.destroy(),Z([this.element],e),!g(this.cssClass)&&this.cssClass!==""&&Z([this.element],this.cssClass.split(" ")),!g(this.refElement)&&!g(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),se(this.refElement),this.refElement=void 0),this.isModal&&(se(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),se(this.dlgContainer)),this.element.innerHTML=this.clonedEle.innerHTML;for(var r=0;r<i.length;r++)this.element.removeAttribute(i[r]);this.ftrTemplateContent=null,this.headerContent=null,!this.isReact&&!this.isVue&&!g(this.contentEle)&&this.removeAllChildren(this.contentEle),this.contentEle=null,this.enableResize&&b3(),o.prototype.destroy.call(this),this.isReact&&this.clearTemplate()}},t.prototype.wireWindowResizeEvent=function(){this.boundWindowResizeHandler=this.windowResizeHandler.bind(this),window.addEventListener("resize",this.boundWindowResizeHandler)},t.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.boundWindowResizeHandler),this.boundWindowResizeHandler=null},t.prototype.wireEvents=function(){this.showCloseIcon&&T.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&T.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.unWireEvents=function(){this.showCloseIcon&&T.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&T.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler)},t.prototype.refreshPosition=function(){this.popupObj.refreshPosition(),this.element.classList.contains(ym)&&this.positionChange()},t.prototype.getDimension=function(){var e=this.element.offsetWidth,i=this.element.offsetHeight;return{width:e,height:i}},t.prototype.show=function(e){var i=this;if(this.element.classList.contains(vm)){if(!this.element.classList.contains(uN)||!g(e)){g(e)||this.fullScreen(e);var r=$e()?{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,maxHeight:this.element.style.maxHeight}:{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(i.element.style.maxHeight!==r.maxHeight&&(i.allowMaxHeight=!1,i.element.style.maxHeight=r.maxHeight),i.enableResize&&i.boundWindowResizeHandler==null&&!i.initialRender&&i.wireWindowResizeEvent(),i.allowDragging&&!g(i.headerContent)&&i.refreshPosition(),i.storeActiveElement=document.activeElement,i.element.tabIndex=-1,i.isModal&&!g(i.dlgOverlay))if(i.dlgOverlay.style.display="block",i.dlgContainer.style.display="flex",Z([i.dlgOverlay],"e-fade"),g(i.targetEle))X([document.body],[Za,ya]);else{i.targetEle===document.body?i.dlgContainer.style.position="fixed":i.dlgContainer.style.position="absolute",i.dlgOverlay.style.position="absolute";var s=i.getTargetContainer(i.target);if(s instanceof Element){var a=window.getComputedStyle(s);a.getPropertyValue("direction")==="rtl"?i.element.style.position="absolute":i.element.style.position="relative"}else i.element.style.position="relative";X([i.targetEle],[Za,ya])}var l={name:i.animationSettings.effect==="None"&&Yt==="Enable"?"ZoomIn":i.animationSettings.effect+"In",duration:i.animationSettings.duration,delay:i.animationSettings.delay},h=i.isModal?i.element.parentElement:i.element;if(i.calculatezIndex&&(i.setzIndex(h,!0),Ze(i.element,{zIndex:i.zIndex}),i.isModal&&i.setOverlayZindex(i.zIndex)),i.animationSettings.effect==="None"&&Yt==="Enable"?i.popupObj.show(l):i.animationSettings.effect==="None"?i.popupObj.show():i.popupObj.show(l),i.isModal){var s=i.getTargetContainer(i.target);if(s instanceof Element){var a=window.getComputedStyle(s);a.getPropertyValue("direction")==="rtl"&&!i.IsDragStop&&i.setPopupPosition()}}i.dialogOpen=!0;var c=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!0,i.preventVisibility=!0,i.isProtectedOnChange=c}})}this.isReact&&this.renderReactTemplates()}},t.prototype.hide=function(e){var i=this;if(this.element.classList.contains(vm)&&this.preventVisibility){var r=$e()?{cancel:!1,isInteracted:!!e,element:this.element,container:this.isModal?this.dlgContainer:this.element,event:e,preventFocus:!1}:{cancel:!1,isInteracted:!!e,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:e,preventFocus:!1,closedBy:this.dlgClosedBy};this.closeArgs=r,this.trigger("beforeClose",r,function(n){if(!n.cancel){i.enableResize&&i.unWireWindowResizeEvent();var s={name:i.animationSettings.effect==="None"&&Yt==="Enable"?"ZoomOut":i.animationSettings.effect+"Out",duration:i.animationSettings.duration,delay:i.animationSettings.delay};i.animationSettings.effect==="None"&&Yt==="Enable"?i.popupObj.hide(s):i.animationSettings.effect==="None"?i.popupObj.hide():i.popupObj.hide(s),setTimeout(function(){i.isModal&&!g(i.targetEle)&&i.targetEle.classList.contains(Za)&&i.targetEle.classList.contains(ya)&&Z([i.targetEle],[Za,ya]),document.body.classList.contains(Za)&&document.body.classList.contains(ya)&&Z([document.body],[Za,ya])},i.animationSettings.duration+i.animationSettings.delay),i.dialogOpen=!1;var a=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!1,i.preventVisibility=!1,i.isProtectedOnChange=a}i.dlgClosedBy=lx})}},t.prototype.fullScreen=function(e){var i=this.element.offsetTop,r=this.element.offsetLeft;if(e){this.isModal||(this.element.style.top=document.scrollingElement.scrollTop+"px"),X([this.element],bm);var n=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=g(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=n,X([document.body],[Za,ya]),this.allowDragging&&!g(this.dragObj)&&this.dragObj.destroy()}else Z([this.element],bm),Z([document.body],[Za,ya]),this.allowDragging&&!g(this.headerContent)&&this.setAllowDragging();return e},t.prototype.getButtons=function(e){return g(e)?this.btnObj:this.btnObj[e]},t.prototype.unWireButtonEvents=function(){if(this.buttons.length>0&&this.footerTemplate===""&&this.ftrTemplateContent)for(var e=0;e<this.buttons.length;e++)this.buttons[e].click&&typeof this.buttons[e].click=="function"&&this.ftrTemplateContent.children[e]&&T.remove(this.ftrTemplateContent.children[e],"click",this.buttons[e].click)},t.prototype.destroyButtons=function(){if(!g(this.btnObj))for(var e=0;e<this.btnObj.length;e++)this.btnObj[e]&&!this.btnObj[e].isDestroyed&&this.btnObj[e].destroy()},Qt([w("")],t.prototype,"content",void 0),Qt([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Qt([w(!1)],t.prototype,"enablePersistence",void 0),Qt([w(!1)],t.prototype,"showCloseIcon",void 0),Qt([w(!1)],t.prototype,"isModal",void 0),Qt([w("")],t.prototype,"header",void 0),Qt([w(!0)],t.prototype,"visible",void 0),Qt([w(!1)],t.prototype,"enableResize",void 0),Qt([w(["South-East"])],t.prototype,"resizeHandles",void 0),Qt([w("auto")],t.prototype,"height",void 0),Qt([w("")],t.prototype,"minHeight",void 0),Qt([w("100%")],t.prototype,"width",void 0),Qt([w("")],t.prototype,"cssClass",void 0),Qt([w(1e3)],t.prototype,"zIndex",void 0),Qt([w(null)],t.prototype,"target",void 0),Qt([w("")],t.prototype,"footerTemplate",void 0),Qt([w(!1)],t.prototype,"allowDragging",void 0),Qt([Gt([{}],S3)],t.prototype,"buttons",void 0),Qt([w(!0)],t.prototype,"closeOnEscape",void 0),Qt([Ce({},C3)],t.prototype,"animationSettings",void 0),Qt([Ce({X:"center",Y:"center"},JN)],t.prototype,"position",void 0),Qt([G()],t.prototype,"created",void 0),Qt([G()],t.prototype,"open",void 0),Qt([G()],t.prototype,"beforeSanitizeHtml",void 0),Qt([G()],t.prototype,"beforeOpen",void 0),Qt([G()],t.prototype,"close",void 0),Qt([G()],t.prototype,"beforeClose",void 0),Qt([G()],t.prototype,"dragStart",void 0),Qt([G()],t.prototype,"dragStop",void 0),Qt([G()],t.prototype,"drag",void 0),Qt([G()],t.prototype,"overlayClick",void 0),Qt([G()],t.prototype,"resizeStart",void 0),Qt([G()],t.prototype,"resizing",void 0),Qt([G()],t.prototype,"resizeStop",void 0),Qt([G()],t.prototype,"destroyed",void 0),t=Qt([It],t),t})(ti),vN;(function(o){function t(c){var u=et("div",{className:nk});document.body.appendChild(u);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return typeof c=="string"?d=i({content:c,position:{X:"center",Y:"top"},isModal:!0,header:dN,buttons:p},u):d=i(r(c),u),d.close=function(){c&&c.close&&c.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(pN)):d.element.remove()},d}o.alert=t;function e(c){var u=et("div",{className:sk});document.body.appendChild(u);var d,p=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}];return typeof c=="string"?d=i({position:{X:"center",Y:"top"},content:c,isModal:!0,header:dN,buttons:p},u):d=i(n(c),u),d.close=function(){c&&c.close&&c.close.apply(d),d.destroy(),d.element.classList.contains("e-dlg-modal")?(d.element.parentElement.remove(),d.target.classList.remove(pN)):d.element.remove()},d}o.confirm=e;function i(c,u){var d=new cc(c);return d.appendTo(u),d}function r(c){var u={};return u.buttons=[],u=s(u,c),u=a(u,c),u}function n(c){var u={};return u.buttons=[],u=s(u,c),u=l(u,c),u}function s(c,u){return c.header=g(u.title)?null:u.title,c.content=g(u.content)?"":u.content,c.isModal=g(u.isModal)?!0:u.isModal,c.showCloseIcon=g(u.showCloseIcon)?!1:u.showCloseIcon,c.allowDragging=g(u.isDraggable)?!1:u.isDraggable,c.closeOnEscape=g(u.closeOnEscape)?!1:u.closeOnEscape,c.position=g(u.position)?{X:"center",Y:"top"}:u.position,c.animationSettings=g(u.animationSettings)?{effect:"Fade",duration:400,delay:0}:u.animationSettings,c.cssClass=g(u.cssClass)?"":u.cssClass,c.zIndex=g(u.zIndex)?1e3:u.zIndex,c.open=g(u.open)?null:u.open,c.width=g(u.width)?"auto":u.width,c.height=g(u.height)?"auto":u.height,c}function a(c,u){var d=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return g(u.okButton)?c.buttons=d:c.buttons[0]=h(c.buttons[0],u.okButton,d[0]),c}function l(c,u){var d={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},p={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return g(u.okButton)?c.buttons[0]=d:c.buttons[0]=h(c.buttons[0],u.okButton,d),g(u.cancelButton)?c.buttons[1]=p:c.buttons[1]=h(c.buttons[1],u.cancelButton,p),c}function h(c,u,d){var p=d;return g(u.text)||(p.buttonModel.content=u.text),g(u.icon)||(p.buttonModel.iconCss=u.icon),g(u.cssClass)||(p.buttonModel.cssClass=u.cssClass),g(u.click)||(p.click=u.click),g(u.isFlat)||(p.isFlat=u.isFlat),p}})(vN||(vN={}));var ak=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Li=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},R3=1500,O3=500,mN=0,yN=8,z3=2,Ao=2,hx="e-tooltip",bN="e-rtl",P3="e-bigger",SN="e-icons",CN="e-tooltip-close",cx="e-tooltip-wrap",wN="e-tip-content",Pu="e-arrow-tip",xN="e-arrow-tip-outer",Sm="e-arrow-tip-inner",$p="e-tip-bottom",ux="e-tip-top",IN="e-tip-left",dx="e-tip-right",px="e-popup",Zp="e-popup-open",fx="e-popup-close",Cm="e-lib",B3="e-hidden",MN="e-tooltip-popup-container",j3=(function(o){ak(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Li([w({effect:"FadeIn",duration:150,delay:0})],t.prototype,"open",void 0),Li([w({effect:"FadeOut",duration:150,delay:0})],t.prototype,"close",void 0),t})(Oe),uh=(function(o){ak(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return t.prototype.initialize=function(){this.formatPosition(),X([this.element],hx)},t.prototype.formatPosition=function(){var e,i;this.position&&(this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=e[0],this.tooltipPositionX=e[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1]))},t.prototype.renderArrow=function(){this.setTipClass(this.position);var e=this.createElement("div",{className:Pu+" "+this.tipClass});e.appendChild(this.createElement("div",{className:xN+" "+this.tipClass})),e.appendChild(this.createElement("div",{className:Sm+" "+this.tipClass})),this.tooltipEle.appendChild(e)},t.prototype.setTipClass=function(e){e.indexOf("Right")===0?this.tipClass=IN:e.indexOf("Bottom")===0?this.tipClass=ux:e.indexOf("Left")===0?this.tipClass=dx:this.tipClass=$p},t.prototype.renderPopup=function(e){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove(Cm),this.popupObj=new es(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},t.prototype.getScalingFactor=function(e){if(!e)return{x:1,y:1};var i={x:1,y:1},r=e.closest('[style*="transform: scale"]');if(r&&r!==this.tooltipEle&&r.contains(this.tooltipEle)){var n=window.getComputedStyle(r),s=n.getPropertyValue("transform"),a=s.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=a[0],i.y=a[3]}return i},t.prototype.getTooltipPosition=function(e){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=Ar(e,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),n=this.getScalingFactor(e),s=this.calculateTooltipOffset(this.position,n.x,n.y),a=this.calculateElementPosition(r,s),l=a[0],h=a[1],c=this.collisionFlipFit(e,l,h);return c.left=c.left/n.x,c.top=c.top/n.y,this.tooltipEle.style.display="",c},t.prototype.windowResize=function(){this.reposition(this.findTarget())},t.prototype.reposition=function(e){if(this.popupObj&&e){var i=this.getTooltipPosition(e);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},t.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},t.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear();var e={type:this.tooltipEventArgs.event?this.tooltipEventArgs.event.type:null,cancel:!1,target:this.tooltipEventArgs.target,event:this.tooltipEventArgs.event?this.tooltipEventArgs.event:null,element:this.tooltipEle,isInteracted:!g(this.tooltipEventArgs.event)};this.trigger("afterClose",e),e=null},t.prototype.calculateTooltipOffset=function(e,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var n={top:0,left:0},s,a,l,h,c,u,d,p;if(i!==1||r!==1){var f=this.tooltipEle.getBoundingClientRect(),v=void 0;l=Math.round(f.width),h=Math.round(f.height),c=J("."+Pu,this.tooltipEle),c&&(v=c.getBoundingClientRect()),s=c?Math.round(v.width):0,a=c?Math.round(v.height):0,u=this.showTipPointer?mN:yN,d=a/2+Ao+(h-this.tooltipEle.clientHeight*r),p=s/2+Ao+(l-this.tooltipEle.clientWidth*i)}else l=this.tooltipEle.offsetWidth,h=this.tooltipEle.offsetHeight,c=J("."+Pu,this.tooltipEle),s=c?c.offsetWidth:0,a=c?c.offsetHeight:0,u=this.showTipPointer?mN:yN,d=a/2+Ao+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),p=s/2+Ao+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(u+=z3),e){case"RightTop":n.left+=s+u,n.top-=h-d;break;case"RightCenter":n.left+=s+u,n.top-=h/2;break;case"RightBottom":n.left+=s+u,n.top-=d;break;case"BottomRight":n.top+=a+u,n.left-=p;break;case"BottomCenter":n.top+=a+u,n.left-=l/2;break;case"BottomLeft":n.top+=a+u,n.left-=l-p;break;case"LeftBottom":n.left-=s+l+u,n.top-=d;break;case"LeftCenter":n.left-=s+l+u,n.top-=h/2;break;case"LeftTop":n.left-=s+l+u,n.top-=h-d;break;case"TopLeft":n.top-=h+a+u,n.left-=l-p;break;case"TopRight":n.top-=h+a+u,n.left-=p;break;default:n.top-=h+a+u,n.left-=l/2;break}return n.left+=this.offsetX,n.top+=this.offsetY,n},t.prototype.updateTipPosition=function(e){var i=ze("."+Pu+",."+xN+",."+Sm,this.tooltipEle),r=[$p,ux,IN,dx];Z(i,r),this.setTipClass(e),X(i,this.tipClass)},t.prototype.adjustArrow=function(e,i,r,n){var s=J("."+Pu,this.tooltipEle);if(!(this.showTipPointer===!1||s===null)){this.updateTipPosition(i);var a,l;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,c=this.tooltipEle.clientHeight,u=J("."+Sm,this.tooltipEle),d=s.offsetWidth,p=s.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===$p||this.tipClass===ux){if(this.tipClass===$p?(l="99.9%",u.style.top="-"+(p-2)+"px"):(l=-(p-1)+"px",u.style.top="-"+(p-6)+"px"),e){var f=r!=="Center"||h>e.offsetWidth||this.mouseTrail;f&&r==="Left"||!f&&this.tipPointerPosition==="End"?a=h-d-Ao+"px":f&&r==="Right"||!f&&this.tipPointerPosition==="Start"?a=Ao+"px":f&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?a=this.tipPointerPosition==="End"?e.offsetWidth+(this.tooltipEle.offsetWidth-e.offsetWidth)/2-d/2-Ao+"px":(this.tooltipEle.offsetWidth-e.offsetWidth)/2-d/2+Ao+"px":a=h/2-d/2+"px"}}else{this.tipClass===dx?(a="99.9%",u.style.left="-"+(d-2)+"px"):(a=-(d-1)+"px",u.style.left=-d+(d-2)+"px");var f=n!=="Center"||c>e.offsetHeight||this.mouseTrail;f&&n==="Top"||!f&&this.tipPointerPosition==="End"?l=c-p-Ao+"px":f&&n==="Bottom"||!f&&this.tipPointerPosition==="Start"?l=Ao+"px":l=c/2-p/2+"px"}s.style.top=l,s.style.left=a}},t.prototype.renderContent=function(e){var i=this,r=J("."+wN,this.tooltipEle);if(this.cssClass&&X([this.tooltipEle],this.cssClass.split(" ")),e&&!g(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),g(this.content))e&&!g(e.getAttribute("data-content"))&&(r.innerHTML=e.getAttribute("data-content"));else if(r.innerHTML="",this.content instanceof HTMLElement)r.appendChild(this.content);else if(typeof this.content=="string")if(this.isAngular?this.setProperties({content:Pt.sanitize(this.content)},!0):this.content=this.enableHtmlSanitizer?Pt.sanitize(this.content):this.content,this.enableHtmlParse){var n=Et(this.content),s=n({},this,"content",this.element.id+"content",void 0,void 0,r,this.root);s&&bt(s,r)}else r.textContent=this.content;else{var a=Et(this.content),s=a({},this,"content",this.element.id+"content",void 0,void 0,r);s&&(this.isAngular&&this.animation.open.effect==="ZoomIn"&&setTimeout(function(){i.reposition(e)},1),bt(s,r)),this.renderReactTemplates()}},t.prototype.renderCloseIcon=function(){if(!this.isSticky){var e=this.tooltipEle.querySelector("."+SN+"."+CN);e&&Qe(e);return}var i=this.createElement("div",{className:SN+" "+CN,attrs:{role:"button","aria-label":"Press escape to close the Tooltip"}});this.tooltipEle.appendChild(i),T.add(i,j.touchStartEvent,this.onStickyClose,this)},t.prototype.addDescribedBy=function(e,i){var r=(e.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),Ee(e,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},t.prototype.removeDescribedBy=function(e){var i=e.getAttribute("data-tooltip-id"),r=(e.getAttribute("aria-describedby")||"").split(/\s+/),n=r.indexOf(i);n!==-1&&r.splice(n,1),e.removeAttribute("data-tooltip-id");var s=r.join(" ").trim();s?e.setAttribute("aria-describedby",s):e.removeAttribute("aria-describedby")},t.prototype.tapHoldHandler=function(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)},t.prototype.touchEndHandler=function(){var e=this;if(!this.isSticky){var i=function(){e.close()};this.autoCloseTimer=setTimeout(i,R3)}},t.prototype.targetClick=function(e){var i;if(this.target?i=H(e.target,this.target):i=this.element,!g(i)){var r=e;i.getAttribute("data-tooltip-id")===null?r.type==="mousedown"&&r.button===2||this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,i)}},t.prototype.targetHover=function(e){var i;if(this.target?i=H(e.target,this.target):i=this.element,!(g(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){!g(this.tooltipEle)&&this.tooltipEle.getAttribute("e-animation-id")&&(Mt.stop(this.tooltipEle),this.clear());for(var r=[].slice.call(ze('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),n=0,s=r;n<s.length;n++){var a=s[n];this.restoreElement(a)}this.showTooltip(i,this.animation.open,e)}},t.prototype.mouseMoveBeforeOpen=function(e){this.mouseMoveEvent=e},t.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&T.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},t.prototype.showTooltip=function(e,i,r){var n=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,T.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:e,event:r||null,element:this.tooltipEle,isInteracted:!g(r)};var s=function(a){n.beforeRenderCallback(a,e,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,s.bind(this))},t.prototype.beforeRenderCallback=function(e,i,r,n){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,g(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?Lt(this.element.getAttribute("id")):Lt("tooltip"),this.tooltipEle=this.createElement("div",{className:cx+" "+px+" "+Cm,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"}}),this.tooltipEle.style.width=Ae(this.width),this.tooltipEle.style.height=Ae(this.height),this.tooltipEle.style.position="absolute",this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,n,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),Mt.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,n,this)))},t.prototype.appendContainer=function(e){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=J(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||X([this.containerElement],MN),this.containerElement.appendChild(e.tooltipEle)},t.prototype.tooltipBeforeRender=function(e,i){e&&(j.isDevice&&X([i.tooltipEle],P3),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=Ae(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:wN})),this.appendContainer(i),Z([i.tooltipEle],B3),i.addDescribedBy(e,i.ctrlId+"_content"),i.renderContent(e),X([i.tooltipEle],Zp),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(e),i.adjustArrow(e,i.position,i.tooltipPositionX,i.tooltipPositionY),Mt.stop(i.tooltipEle),i.reposition(e))},t.prototype.tooltipAfterRender=function(e,i,r,n){if(e){Z([n.tooltipEle],Zp),X([n.tooltipEle],fx),n.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:n.tooltipEle,isInteracted:!g(i)},n.needTemplateReposition()&&!n.mouseTrail&&(r.effect==="None"||r.effect==="FadeIn"||this.isReact&&typeof n.content!="string")&&(n.tooltipEle.style.display="none");var s=function(a){n.beforeOpenCallback(a,e,r,i)};n.trigger("beforeOpen",n.tooltipEventArgs,s.bind(n))}},t.prototype.beforeOpenCallback=function(e,i,r,n){var s=this;if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var a={name:r.effect==="None"&&Yt==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(a=void 0),this.openDelay>0){var l=function(){s.mouseTrail&&T.add(i,"mousemove touchstart mouseenter",s.onMouseMove,s),s.popupObj&&(s.popupObj.show(a,i),s.mouseMoveEvent&&s.mouseTrail&&s.onMouseMove(s.mouseMoveEvent))};this.showTimer=setTimeout(l,this.openDelay)}else this.popupObj&&this.popupObj.show(a,i)}n&&this.wireMouseEvents(n,i)},t.prototype.needTemplateReposition=function(){var e=this;return!g(e.viewContainerRef)&&typeof e.viewContainerRef!="string"||this.isReact},t.prototype.checkCollision=function(e,i,r){var n={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},s=gs(this.tooltipEle,this.checkCollideTarget(),i,r);return s.length>0&&(n.horizontal=s.indexOf("left")>=0?"Right":s.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=s.indexOf("top")>=0?"Bottom":s.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},t.prototype.calculateElementPosition=function(e,i){return[this.isBodyContainer?e.left+i.left:e.left-this.containerElement.getBoundingClientRect().left+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?e.top+i.top:e.top-this.containerElement.getBoundingClientRect().top+i.top+window.pageYOffset+this.containerElement.scrollTop]},t.prototype.collisionFlipFit=function(e,i,r){var n=this.checkCollision(e,i,r),s=n.position;if(this.tooltipPositionY!==n.vertical&&(s=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(s.indexOf("Left")===0&&(n.vertical=s==="LeftTop"||s==="LeftCenter"?"Top":"Bottom",s=n.vertical+"Left"),s.indexOf("Right")===0&&(n.vertical=s==="RightTop"||s==="RightCenter"?"Top":"Bottom",s=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:s},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)s=this.position;else{var a=n.vertical,l=n.horizontal;if(n.position!==s){var h=Ar(e,l,a,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(e,s,l,a);var c=this.getScalingFactor(e),u=this.calculateTooltipOffset(s,c.x,c.y);u.top-=this.getOffSetPosition("TopBottom",s,this.offsetY),u.left-=this.getOffSetPosition("RightLeft",s,this.offsetX),n.position=s;var d=this.calculateElementPosition(h,u);n.left=d[0],n.top=d[1]}else this.adjustArrow(e,s,l,a)}var p={left:n.left,top:n.top},f=this.isBodyContainer?km(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},p):p;this.tooltipEle.style.display="block";var v=J("."+Pu,this.tooltipEle);if(this.showTipPointer&&v!=null&&(s.indexOf("Bottom")===0||s.indexOf("Top")===0)){var m=parseInt(v.style.left,10)-(f.left-n.left);m<0?m=0:m+v.offsetWidth>this.tooltipEle.clientWidth&&(m=this.tooltipEle.clientWidth-v.offsetWidth),v.style.left=m.toString()+"px"}return this.tooltipEle.style.display="",p.left=f.left,p.top=f.top,p},t.prototype.getOffSetPosition=function(e,i,r){return e.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&e.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},t.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},t.prototype.hideTooltip=function(e,i,r){var n=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var s=function(){n.closeDelay&&n.tooltipEle&&n.isTooltipOpen||n.tooltipHide(e,i,r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.tooltipHide(e,i,r)},t.prototype.tooltipHide=function(e,i,r){var n=this,s;i?s=this.target?r||i.target:this.element:s=J('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:s,event:i||null,element:this.tooltipEle,isInteracted:!g(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(a){a.cancel?n.isHidden=!1:(n.mouseMoveBeforeRemove(),n.popupHide(e,s,i))})},t.prototype.popupHide=function(e,i,r){i&&r&&this.restoreElement(i),this.isHidden=!0;var n={name:e.effect==="None"&&Yt==="Enable"?"FadeOut":this.animation.close.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};e.effect==="None"&&(n=void 0),this.popupObj&&this.popupObj.hide(n)},t.prototype.restoreElement=function(e){this.unwireMouseEvents(e),g(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)},t.prototype.clear=function(){var e=this.findTarget();e&&this.restoreElement(e),this.tooltipEle&&(Z([this.tooltipEle],fx),X([this.tooltipEle],Zp)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&Qe(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},t.prototype.tooltipHover=function(){this.tooltipEle&&(this.isTooltipOpen=!0)},t.prototype.tooltipMouseOut=function(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())},t.prototype.onMouseOut=function(e){var i=e.relatedTarget;if(i&&!this.mouseTrail){var r=H(i,"."+cx+"."+Cm+"."+px);r?T.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),this.closeDelay===0&&(this.animation.close.effect==="None"||this.isReact&&typeof this.content!="string")&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear();this.popupObj&&!this.popupObj.element.classList.contains(Zp)&&this.clear()},t.prototype.tooltipElementMouseOut=function(e){this.hideTooltip(this.animation.close,e,this.findTarget()),T.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},t.prototype.onStickyClose=function(){this.close()},t.prototype.onMouseMove=function(e){var i=0,r=0;if(e.type.indexOf("touch")>-1?(e.preventDefault(),i=e.touches[0].pageX,r=e.touches[0].pageY):(i=e.pageX,r=e.pageY),!g(this.tooltipEle)){Mt.stop(this.tooltipEle),Z([this.tooltipEle],fx),X([this.tooltipEle],Zp),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.getScalingFactor(e.target),s=this.calculateTooltipOffset(this.position,n.x,n.y),a=i+s.left+this.offsetX,l=r+s.top+this.offsetY,h=this.checkCollision(e.target,a,l);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var c=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=c,this.adjustArrow(e.target,h.position,h.horizontal,h.vertical);var u=this.calculateTooltipOffset(h.position,n.x,n.y);h.left=i+u.left-this.offsetX,h.top=r+u.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"}},t.prototype.keyDown=function(e){this.tooltipEle&&e.keyCode===27&&this.close()},t.prototype.touchEnd=function(e){this.tooltipEle&&H(e.target,"."+hx)===null&&!this.isSticky&&this.close()},t.prototype.scrollHandler=function(e){this.tooltipEle&&!this.isSticky&&!H(e.target,"."+cx+"."+Cm+"."+px)&&!this.isSticky&&this.close()},t.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},t.prototype.preRender=function(){this.tipClass=$p,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},t.prototype.wireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.wireFocusEvents(),s==="Click"&&(j.isIos7||j.isIos)&&T.add(this.element,"mousedown",this.targetClick,this),s==="Click"&&!(j.isIos7||j.isIos)&&T.add(this.element,j.touchStartEvent,this.targetClick,this),s==="Hover"&&(j.isDevice?(this.touchModule=new jr(this.element,{tapHoldThreshold:O3,tapHold:this.tapHoldHandler.bind(this)}),T.add(this.element,j.touchEndEvent,this.touchEndHandler,this)):T.add(this.element,"mouseover",this.targetHover,this))}this.windowResizeBound=this.windowResize.bind(this),this.keyDownBound=this.keyDown.bind(this),this.touchEndBound=this.touchEnd.bind(this),this.scrollWheelBound=this.scrollHandler.bind(this),document.addEventListener("wheel",this.scrollWheelBound),document.addEventListener("scroll",this.scrollWheelBound),document.addEventListener("touchend",this.touchEndBound),document.addEventListener("keydown",this.keyDownBound),window.addEventListener("resize",this.windowResizeBound)},t.prototype.getTriggerList=function(e){return e?(e==="Auto"&&(e=j.isDevice?"Hover":"Hover Focus"),e.split(" ")):[]},t.prototype.wireFocusEvents=function(){if(g(this.target))T.add(this.element,"focusin",this.targetHover,this);else{var e=[].slice.call(ze(this.target,this.element));if(this.targetsList=e,!g(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var n=r[i];T.add(n,"focus",this.targetHover,this)}else T.add(this.element,"focusin",this.targetHover,this)}},t.prototype.wireMouseEvents=function(e,i){this.tooltipEle&&(this.isSticky||(e.type==="focus"&&T.add(i,"blur",this.onMouseOut,this),e.type==="focusin"&&T.add(i,"focusout",this.onMouseOut,this),e.type==="mouseover"&&T.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(T.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),T.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&T.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},t.prototype.unwireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.unwireFocusEvents(),s==="Click"&&T.remove(this.element,j.touchStartEvent,this.targetClick),s==="Hover"&&(j.isDevice?(this.touchModule&&this.touchModule.destroy(),T.remove(this.element,j.touchEndEvent,this.touchEndHandler)):T.remove(this.element,"mouseover",this.targetHover))}document.removeEventListener("touchend",this.touchEndBound),this.touchEndBound=null,document.removeEventListener("wheel",this.scrollWheelBound),document.removeEventListener("scroll",this.scrollWheelBound),this.scrollWheelBound=null,window.removeEventListener("resize",this.windowResizeBound),this.windowResizeBound=null,document.removeEventListener("keydown",this.keyDownBound),this.keyDownBound=null},t.prototype.unwireFocusEvents=function(){if(g(this.target))T.remove(this.element,"focusin",this.targetHover);else{var e=[].slice.call(ze(this.target,this.element));if(!g(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=e;i<r.length;i++){var n=r[i];T.remove(n,"focus",this.targetHover)}else T.remove(this.element,"focusin",this.targetHover)}},t.prototype.unwireMouseEvents=function(e){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,n=i;r<n.length;r++){var s=n[r];s==="Focus"&&(T.remove(e,"blur",this.onMouseOut),T.remove(e,"focusout",this.onMouseOut)),s==="Hover"&&!j.isDevice&&T.remove(e,"mouseleave",this.onMouseOut)}this.closeDelay&&(T.remove(e,"mouseenter",this.tooltipHover),T.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&T.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)},t.prototype.findTarget=function(){var e=J('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return e},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=this.findTarget(),n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=Ae(e.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=Ae(e.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var l=J("."+Sm,this.tooltipEle);l&&(l.style.top=l.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var h=e.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+h).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var c=e.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+c).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&Z([this.tooltipEle],i.cssClass.split(" ")),e.cssClass&&X([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?X([this.tooltipEle],bN):Z([this.tooltipEle],bN));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":g(this.containerElement)||Z([this.containerElement],MN),this.container=e.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},t.prototype.open=function(e,i){g(i)&&(i=this.animation.open),g(e)&&(e=this.element),e.style.display!=="none"&&this.showTooltip(e,i)},t.prototype.close=function(e){e||(e=this.animation.close),this.hideTooltip(e)},t.prototype.refresh=function(e){if(this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e),!g(this.targetsList)&&!g(this.target)){var i=ze(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.tooltipEle&&Qe(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),$N(),Z([this.element],hx),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var e=ze('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=e;i<r.length;i++){var n=r[i];this.restoreElement(n)}this.containerElement=null,this.tipClass=null,this.tooltipPositionX=null,this.tooltipPositionY=null,this.ctrlId=null,this.tooltipEventArgs=null,this.touchModule=null,this.mouseMoveEvent=null,this.mouseMoveTarget=null,this.containerElement=null,this.targetsList=null},Li([w("auto")],t.prototype,"width",void 0),Li([w("auto")],t.prototype,"height",void 0),Li([w()],t.prototype,"content",void 0),Li([w("body")],t.prototype,"container",void 0),Li([w()],t.prototype,"target",void 0),Li([w("TopCenter")],t.prototype,"position",void 0),Li([w(0)],t.prototype,"offsetX",void 0),Li([w(0)],t.prototype,"offsetY",void 0),Li([w(!0)],t.prototype,"showTipPointer",void 0),Li([w(!0)],t.prototype,"enableHtmlParse",void 0),Li([w(!1)],t.prototype,"windowCollision",void 0),Li([w("Auto")],t.prototype,"tipPointerPosition",void 0),Li([w("Auto")],t.prototype,"opensOn",void 0),Li([w(!1)],t.prototype,"mouseTrail",void 0),Li([w(!1)],t.prototype,"isSticky",void 0),Li([Ce({},j3)],t.prototype,"animation",void 0),Li([w(0)],t.prototype,"openDelay",void 0),Li([w(0)],t.prototype,"closeDelay",void 0),Li([w()],t.prototype,"cssClass",void 0),Li([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Li([w("")],t.prototype,"htmlAttributes",void 0),Li([G()],t.prototype,"beforeRender",void 0),Li([G()],t.prototype,"beforeOpen",void 0),Li([G()],t.prototype,"afterOpen",void 0),Li([G()],t.prototype,"beforeClose",void 0),Li([G()],t.prototype,"afterClose",void 0),Li([G()],t.prototype,"beforeCollision",void 0),Li([G()],t.prototype,"created",void 0),Li([G()],t.prototype,"destroyed",void 0),t=Li([It],t),t})(ti),un={},H3=30,V3=30,DN=30,_3=30,U3=30,W3=30,q3=36,Y3=36,gx="e-spin-show",Im="e-spin-hide",EN="e-spin-material",TN="e-spin-material3",AN="e-spin-tailwind3",LN="e-spin-fabric",NN="e-spin-fluent",kN="e-spin-fluent2",FN="e-spin-tailwind",G3="e-spin-bootstrap",RN="e-spin-bootstrap4",ON="e-spin-bootstrap5",zN="e-spin-high-contrast",mx="e-spinner-pane",kx="e-spinner-inner",Rm="e-path-circle",Q3="e-path-arc",X3="e-spin-label",yx="e-spin-template",PN=null,K3=null;function Qs(o,t){var e;if(o.target){var i,r=g(t)?et:t,n=S_(o.target,r);if(!g(o.cssClass)){var s=o.cssClass.split(" ").filter(function(c){return c.trim()!==""});(e=n.wrap.classList).add.apply(e,s)}if(!g(o.template)||!g(PN)){var a=g(o.template)?PN:o.template;n.wrap.classList.add(yx),v_(n.wrap,a,K3)}else{var l=g(o.type)?h_(n.wrap):o.type,h=g(o.width)?void 0:o.width;i=m_(h,l),c_(l,n.wrap,i,r),g(o.label)||$3(n.inner_wrap,o.label,r)}n.wrap.classList.add(Im),n=null}}function $3(o,t,e){var i=e("div",{});return i.classList.add(X3),i.innerHTML=t,o.appendChild(i),i}function Z3(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Material",radius:t},af(o,i,e,EN),of(t,o,"Material",EN)}function J3(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Tailwind3",radius:t},af(o,i,e,AN),of(t,o,"Tailwind3",AN)}function e_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Material3",radius:t},af(o,i,e,TN),of(t,o,"Material3",TN)}function t_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Bootstrap4",radius:t},af(o,i,e,RN),of(t,o,"Bootstrap4",RN)}function i_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Bootstrap5",radius:t},af(o,i,e,ON),of(t,o,"Bootstrap5",ON)}function r_(o,t,e){var i={},r=0;un[""+t].timeOut=0,i[""+t]=y_(t,e,0,0);var n={uniqueID:t,container:o,globalInfo:i,timeOutVar:r};ok(n)}function n_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Fabric",radius:t},sf(o,i,LN),lf(t,o,LN)}function s_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Fluent",radius:t},sf(o,i,NN),lf(t,o,NN)}function a_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Fluent2",radius:t},sf(o,i,kN),lf(t,o,kN)}function o_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Tailwind",radius:t},sf(o,i,FN),lf(t,o,FN)}function l_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"HighContrast",radius:t},sf(o,i,zN),lf(t,o,zN)}function h_(o){var t=window.getComputedStyle(o,":after").getPropertyValue("content");return t.replace(/['"]+/g,"")}function c_(o,t,e,i){var r=t.querySelector("."+kx),n=r.querySelector("svg");switch(g(n)||r.removeChild(n),o){case"Material":Z3(r,e,i);break;case"Material3":e_(r,e,i);break;case"Fabric":n_(r,e);break;case"Fluent":s_(r,e);break;case"Fluent2":a_(r,e);break;case"Bootstrap":u_(r,e);break;case"HighContrast":l_(r,e);break;case"Bootstrap4":t_(r,e,i);break;case"Bootstrap5":i_(r,e,i);break;case"Tailwind":case"Tailwind-dark":o_(r,e);break;case"Tailwind3":J3(r,e,i);break}}function u_(o,t,e){var i=eo();un[""+i]={timeOut:0,type:"Bootstrap",radius:t},d_(o,i),p_(o,t)}function d_(o,t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,n=32,s=2;i.setAttribute("id",t),i.setAttribute("class",G3),i.setAttribute("viewBox","0 0 "+r+" "+r),o.insertBefore(i,o.firstChild);for(var a=0;a<=7;a++){var l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.setAttribute("class",Rm+"_"+a),l.setAttribute("r",s+""),l.setAttribute("transform","translate("+n+","+n+")"),i.appendChild(l)}}function p_(o,t){var e=o.querySelector("svg.e-spin-bootstrap"),i=0,r=0,n=24;e.style.width=e.style.height=t+"px";for(var s=90,a=0;a<=7;a++){var l=bx(i,r,n,s),h=e.querySelector("."+Rm+"_"+a);h.setAttribute("cx",l.x+""),h.setAttribute("cy",l.y+""),s=s>=360?0:s,s=s+45}}function f_(o,t){var e=[],i=o,r=t,n=!1,s=1;a(i);function a(l){e.push(l),(l!==r||s===1)&&(l<=i&&l>1&&!n?l=parseFloat((l-.2).toFixed(2)):l===1?(l=7,l=parseFloat((l+.2).toFixed(2)),n=!0):l<8&&n?(l=parseFloat((l+.2).toFixed(2)),l===8&&(n=!1)):l<=8&&!n&&(l=parseFloat((l-.2).toFixed(2))),++s,a(l))}return e}function g_(o){for(var t=o.querySelector("svg.e-spin-bootstrap"),e=t.getAttribute("id"),i=1;i<=8;i++){var r=o.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];n(r,i,i,f_(i,i),e)}function n(s,a,l,h,c){var u=0;d(a);function d(p){un[""+c].isAnimate&&(++u,s.setAttribute("r",p+""),u>=h.length&&(u=0),un[c].timeOut=setTimeout(d.bind(null,h[u]),18))}}}function v_(o,t,e){g(e)||o.classList.add(e);var i=o.querySelector(".e-spinner-inner");i.innerHTML=t}function m_(o,t){var e;switch(t){case"Material":e=H3;break;case"Material3":e=V3;break;case"Fabric":e=DN;break;case"Tailwind":case"Tailwind-dark":case"Tailwind3":e=DN;break;case"Fluent":e=_3;break;case"Fluent2":e=U3;break;case"Bootstrap4":e=q3;break;case"Bootstrap5":e=Y3;break;default:e=W3}return o=o?parseFloat(o+""):e,t==="Bootstrap"?o:o/2}function y_(o,t,e,i){return{radius:t,count:e,previousId:i}}function b_(){var o=new Uint32Array(1);return window.crypto.getRandomValues(o),o[0]/4294967296}function eo(){for(var o="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<5;e++)o+=t.charAt(Math.floor(b_()*t.length));return o}function sf(o,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",t),r.setAttribute("class",e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",Rm);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("class",Q3),o.insertBefore(r,o.firstChild),r.appendChild(n),r.appendChild(s)}function af(o,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",t),n.setAttribute("class",Rm),o.insertBefore(r,o.firstChild),r.appendChild(n)}function S_(o,t){var e=t("div",{}),i=t("div",{});return e.classList.add(mx),i.classList.add(kx),i.setAttribute("aria-disabled","true"),o.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function ok(o){var t=1,e=149,i=1333,r=75;C_(t,e,I_,i,o.globalInfo[o.uniqueID].count,r,o),o.globalInfo[o.uniqueID].count=++o.globalInfo[o.uniqueID].count%4}function C_(o,t,e,i,r,n,s){var a=++s.globalInfo[s.uniqueID].previousId,l=new Date().getTime(),h=t-o,c=w_(s.globalInfo[s.uniqueID].radius*2+""),u=lk(c),d=-90*(s.globalInfo[s.uniqueID].count||0);p(s);function p(v){var m=Math.max(0,Math.min(new Date().getTime()-l,i));f(e(m,o,h,i),v.container),a===v.globalInfo[v.uniqueID].previousId&&m<i?un[v.uniqueID].timeOut=setTimeout(p.bind(null,v),1):ok(v)}function f(v,m){if(!g(m.querySelector("svg.e-spin-material"))||!g(m.querySelector("svg.e-spin-material3"))||!g(m.querySelector("svg.e-spin-tailwind3"))){var y=void 0;if(!g(m.querySelector("svg.e-spin-material"))&&!g(m.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))?y=m.querySelector("svg.e-spin-material"):!g(m.querySelector("svg.e-spin-material3"))&&!g(m.querySelector("svg.e-spin-material3").querySelector("path.e-path-circle"))?y=m.querySelector("svg.e-spin-material3"):!g(m.querySelector("svg.e-spin-tailwind3"))&&!g(m.querySelector("svg.e-spin-tailwind3").querySelector("path.e-path-circle"))&&(y=m.querySelector("svg.e-spin-tailwind3")),!g(y)){var b=y.querySelector("path.e-path-circle");b.setAttribute("stroke-dashoffset",hk(c,u,v,n)+""),b.setAttribute("transform","rotate("+d+" "+c/2+" "+c/2+")")}}}}function of(o,t,e,i){var r=o*2,n=t.querySelector("svg."+i),s=n.querySelector("path.e-path-circle"),a=lk(r),l=r/2+"px";n.setAttribute("viewBox","0 0 "+r+" "+r),n.style.width=n.style.height=r+"px",n.style.transformOrigin=l+" "+l+" "+l,s.setAttribute("d",x_(r,a)),(e==="Material"||e==="Material3"||e==="Fluent2"||e==="Tailwind3")&&(s.setAttribute("stroke-width",a+""),s.setAttribute("stroke-dasharray",(r-a)*Math.PI*.75+""),s.setAttribute("stroke-dashoffset",hk(r,a,1,75)+""))}function w_(o){var t=parseFloat(o);return t}function x_(o,t){var e=o/2,i=t/2;return"M"+e+","+i+"A"+(e-i)+","+(e-i)+" 0 1 1 "+i+","+e}function lk(o){return 10/100*o}function hk(o,t,e,i){return(o-t)*Math.PI*(3*i/100-e/100)}function I_(o,t,e,i){var r=(o/=i)*o,n=r*o;return t+e*(6*n*r+-15*r*r+10*n)}function lf(o,t,e){var i=o,r=o,n=o*2,s=315,a=45,l=t.querySelector("."+e),h=l.querySelector(".e-path-circle"),c=l.querySelector(".e-path-arc"),u=n/2+"px";h.setAttribute("d",D_(i,r,o)),c.setAttribute("d",M_(i,r,o,s,a)),l.setAttribute("viewBox","0 0 "+n+" "+n),l.style.transformOrigin=u+" "+u+" "+u,l.style.width=l.style.height=n+"px"}function bx(o,t,e,i){var r=(i-90)*Math.PI/180;return{x:o+e*Math.cos(r),y:t+e*Math.sin(r)}}function M_(o,t,e,i,r){var n=bx(o,t,e,r),s=bx(o,t,e,i),a=["M",n.x,n.y,"A",e,e,0,0,0,s.x,s.y].join(" ");return a}function D_(o,t,e){var i=["M",o,t,"m",-e,0,"a",e,e,0,1,0,e*2,0,"a",e,e,0,1,0,-e*2,0].join(" ");return i}function vs(o){ck(o,!1),o=null}function ck(o,t){var e;if(o)if(o.classList.contains(mx))e=o;else{var i=o.querySelectorAll("."+mx);if(j.isIE){for(var r=0;r<i.length;r++)if(i[r].parentElement&&i[r].parentElement===o){e=i[r];break}}else e=Array.from(i).find(function(h){return h.parentElement===o})||null}if(o&&e){var n=e.querySelector("."+kx),s=t?!e.classList.contains(yx)&&!e.classList.contains(Im):!e.classList.contains(yx)&&!e.classList.contains(gx);if(s){var a=e.querySelector("svg");if(g(a))return;var l=a.getAttribute("id");switch(un[""+l].isAnimate=!t,un[""+l].type){case"Material":case"Material3":case"Tailwind3":t?clearTimeout(un[l].timeOut):r_(n,l,un[l].radius);break;case"Bootstrap":t?clearTimeout(un[l].timeOut):g_(n);break}}t?Ai(e,[Im],[gx]):Ai(e,[gx],[Im]),o=null}}function Xs(o){ck(o,!0),o=null}var si={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"},kt;(function(o){o.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};var t={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},e={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:o.defaultMappedFields,ariaAttributes:t,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function i(L,N,R,P,k){var B=pe({},e,R),F=pe({},t,B.ariaAttributes),O=f(N).typeof;return O==="string"||O==="number"?r(L,N,P,R,k):a(L,N,R,F.level,P,k)}o.createList=i;function r(L,N,R,P,k){var B=n(L,N,R,P,k);return E(L,B,null,P)}o.createListFromArray=r;function n(L,N,R,P,k){var B=[],F=pe({},e,P);si=I(F.moduleName);for(var O=S(),z=0;z<N.length;z++)if(!g(N[z])){var Y=void 0;if(F.itemCreating&&typeof F.itemCreating=="function"){var K={dataSource:N,curData:N[z],text:N[z],options:F};F.itemCreating(K)}if(R?Y=x(L,N[z],void 0,null,null,[],null,O,z,P):Y=M(L,N[z],void 0,null,null,P,k),F.itemCreated&&typeof F.itemCreated=="function"){var K={dataSource:N,curData:N[z],text:N[z],item:Y,options:F};F.itemCreated(K)}B.push(Y)}return B}o.createListItemFromArray=n;function s(L,N,R,P,k,B){var F=pe({},e,R);si=I(F.moduleName);var O=B&&(B.getModuleName()==="listview"||B.getModuleName()==="multiselect")?F.fields:pe({},o.defaultMappedFields,F.fields),z=pe({},t,F.ariaAttributes),Y,K=[];P&&(z.level=P);var U=[],q,ae;N&&N.length&&!g(f(N).item)&&!Object.prototype.hasOwnProperty.call(f(N).item,O.id)&&(Y=S());for(var te=0;te<N.length;te++){var he=In(N[te],O);if(!g(N[te])){if(F.itemCreating&&typeof F.itemCreating=="function"){var ue={dataSource:N,curData:N[te],text:he[O.text],options:F,fields:O};F.itemCreating(ue)}var ne=N[te];F.itemCreating&&typeof F.itemCreating=="function"&&(he=In(N[te],O)),Object.prototype.hasOwnProperty.call(he,O.id)&&!g(he[O.id])&&(Y=he[O.id]);var le=[];if(F.showCheckBox&&(F.itemNavigable&&(he[O.url]||he[O.urlAttributes])?K.push(L("input",{className:si.check,attrs:{type:"checkbox"}})):le.push(L("input",{className:si.check,attrs:{type:"checkbox"}}))),k===!0){if(F.showIcon&&Object.prototype.hasOwnProperty.call(he,O.iconCss)&&!g(he[O.iconCss])&&le.push(L("span",{className:si.icon+" "+he[O.iconCss]})),q=x(L,ne,he,O,F.itemClass,le,!!(Object.prototype.hasOwnProperty.call(ne,"isHeader")&&ne.isHeader),Y,te,R),ae=q.querySelector("."+si.anchorWrap),Object.prototype.hasOwnProperty.call(he,O.tooltip)){var $=he[O.tooltip];if(R&&R.enableHtmlSanitizer)$=Pt.sanitize($);else{var ee=L("span",{innerHTML:$});$=ee.innerText,ee=null}q.setAttribute("title",$)}F.itemNavigable&&K.length&&$r(K,q.firstElementChild)}else{if(q=M(L,ne,he,O,F.itemClass,R,B),q.classList.add(si.level+"-"+z.level),q.setAttribute("aria-level",z.level.toString()),(z.groupItemRole==="presentation"||z.itemRole==="presentation")&&q.removeAttribute("aria-level"),ae=q.querySelector("."+si.anchorWrap),Object.prototype.hasOwnProperty.call(he,O.tooltip)){var $=he[O.tooltip];if(R&&R.enableHtmlSanitizer)$=Pt.sanitize($);else{var ee=L("span",{innerHTML:$});$=ee.innerText,ee=null}q.setAttribute("title",$)}if(Object.prototype.hasOwnProperty.call(he,O.htmlAttributes)&&he[O.htmlAttributes]){var He=he[O.htmlAttributes];"class"in He&&typeof He.class=="string"&&He.class.trim()===""&&delete He.class,v(q,He)}if(Object.prototype.hasOwnProperty.call(he,O.enabled)&&he[O.enabled]===!1&&q.classList.add(si.disabled),Object.prototype.hasOwnProperty.call(he,O.isVisible)&&he[O.isVisible]===!1&&(q.style.display="none"),Object.prototype.hasOwnProperty.call(he,O.imageUrl)&&!g(he[O.imageUrl])&&!F.template){var qe={src:he[O.imageUrl],alt:g(he.name)?"Displaying Image":"Displaying "+he.name+" Image"};mt(qe,he[O.imageAttributes]);var we=L("img",{className:si.image,attrs:qe});ae?ae.insertAdjacentElement("afterbegin",we):$r([we],q.firstElementChild)}if(F.showIcon&&Object.prototype.hasOwnProperty.call(he,O.iconCss)&&!g(he[O.iconCss])&&!F.template){var je=L("div",{className:si.icon+" "+he[O.iconCss]});ae?ae.insertAdjacentElement("afterbegin",je):$r([je],q.firstElementChild)}le.length&&$r(le,q.firstElementChild),F.itemNavigable&&K.length&&$r(K,q.firstElementChild),C(L,he,O,N,F,q,z.level)}if(ae&&X([q],[si.navigable]),F.itemCreated&&typeof F.itemCreated=="function"){var ue={dataSource:N,curData:N[te],text:he[O.text],item:q,options:F,fields:O};F.itemCreated(ue)}K=[],U.push(q)}}return U}o.createListItemFromJson=s;function a(L,N,R,P,k,B){var F=pe({},e,R),O=s(L,N,R,P,k,B);return E(L,O,F.listClass,R)}o.createListFromJson=a;function l(L,N,R){if(si=I(e.moduleName),!(!L||!L.length)){var P,k,B=Array.prototype.slice.call(L);for(N?k=h(N,B):k=R===!0?B.length:-1,P=B[k+(R===!0?-1:1)];P&&(!wr(P)||P.classList.contains(si.disabled));)k=k+(R===!0?-1:1),P=B[k];return P}}o.getSiblingLI=l;function h(L,N){if(!(!N||!L)){var R=N;return R=Array.prototype.slice.call(N),R.indexOf(L)}}o.indexOf=h;function c(L,N,R){R===void 0&&(R="None");var P=pe({},o.defaultMappedFields,N),k=new Pe().group(P.groupBy);k=u(R,"key",k);var B=d(L,k);L=[];for(var F=0;F<B.length;F++){var O=B[F].items,z={},Y="isHeader";z[P.text]=B[F].key,z[""+Y]=!0;var K=P.text;K==="id"&&(K="text",z[""+K]=B[F].key),z._id="group-list-item-"+(B[F].key?B[F].key.toString().trim():"undefined"),z.items=O,L.push(z);for(var U=0;U<O.length;U++)L.push(O[U])}return L}o.groupDataSource=c;function u(L,N,R){if(R===void 0&&(R=new Pe),L==="Ascending")R.sortBy(N,"ascending",!0);else if(L==="Descending")R.sortBy(N,"descending",!0);else for(var P=0;P<R.queries.length;P++)R.queries[P].fn==="onSortBy"&&R.queries.splice(P,1);return R}o.addSorting=u;function d(L,N){return new oe(L).executeLocal(N)}o.getDataSource=d;function p(L,N){var R=pe({},e,N),P=pe({},o.defaultMappedFields,R.fields),k=L.cloneNode(!0),B=[];k.classList.add("json-parent");var F=k.querySelectorAll(".json-parent>li");k.classList.remove("json-parent");for(var O=0;O<F.length;O++){for(var z=F[O],Y=z.querySelector("a"),K=z.querySelector("ul"),U={},q=Y?Y.childNodes:z.childNodes,ae=Object.keys(q),te=0;te<q.length;te++)q[Number(ae[te])].hasChildNodes()||(U[P.text]=q[Number(ae[te])].textContent);var he=m(z);he.id?(U[P.id]=he.id,delete he.id):U[P.id]=S(),Object.keys(he).length&&(U[P.htmlAttributes]=he),Y&&(he=m(Y),Object.keys(he).length&&(U[P.urlAttributes]=he)),K&&(U[P.child]=p(K,N)),B.push(U)}return B}o.createJsonFromElement=p;function f(L){for(var N={typeof:null,item:null},R=0;R<L.length;R++)if(!g(L[R]))return N={typeof:typeof L[R],item:L[R]};return N}function v(L,N){var R={};mt(R,N),R.class&&(X([L],R.class.split(" ")),delete R.class),Ee(L,R)}function m(L){for(var N={},R=L.attributes,P=0;P<R.length;P++)N[R[P].nodeName]=R[P].nodeValue;return N}function y(L,N,R,P,k,B){si=I(e.moduleName);for(var F=L("ul",{className:si.ul,attrs:{role:"presentation"}}),O=pe({},e,k),z=pe({},o.defaultMappedFields,P),Y=Om(N),K=[],U,q=S(),ae=0;ae<R.length;ae++){var te=In(R[ae],z),he=R[ae],ue=he.isHeader;if(typeof R[ae]=="string"||typeof R[ae]=="number"?U=he:U=te[z.value],O.itemCreating&&typeof O.itemCreating=="function"){var ne={dataSource:R,curData:he,text:U,options:O,fields:z};O.itemCreating(ne)}O.itemCreating&&typeof O.itemCreating=="function"&&(te=In(R[ae],z),typeof R[ae]=="string"||typeof R[ae]=="number"?U=he:U=te[z.value]);var le=L("li",{id:q+"-"+ae,className:ue?si.group:si.li,attrs:{role:"presentation"}});if(ue)typeof R[ae]=="string"||typeof R[ae]=="number"?le.innerText=he:le.innerText=te[z.text];else{var $=ue?O.groupTemplateID:O.templateID;if(ue)if(B&&B.getModuleName()!=="listview"){var ee=Y(he,B,"headerTemplate",$,!!O.isStringTemplate,null,le);ee&&bt(ee,le)}else bt(Y(he,B,"headerTemplate",$,!!O.isStringTemplate),le);else if(B&&B.getModuleName()!=="listview"){var ee=Y(he,B,"template",$,!!O.isStringTemplate,null,le);ee&&bt(ee,le)}else bt(Y(he,B,"template",$,!!O.isStringTemplate),le);le.setAttribute("data-value",g(U)?"null":U),le.setAttribute("role","option")}if(O.itemCreated&&typeof O.itemCreated=="function"){var ne={dataSource:R,curData:he,text:U,item:le,options:O,fields:z};O.itemCreated(ne)}K.push(le)}return bt(K,F),F}o.renderContentTemplate=y;function b(L,N,R,P,k,B){for(var F=Om(L),O=pe({},o.defaultMappedFields,R),z=pe({},e,k),Y=O.groupBy,K=0,U=P;K<U.length;K++){var q=U[K],ae={};if(ae[""+Y]=q.textContent,q.innerHTML="",B&&B.getModuleName()!=="listview"){var te=F(ae,B,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate,null,q);te&&bt(te,q)}else bt(F(ae,B,"groupTemplate",z.groupTemplateID,!!z.isStringTemplate),q)}return P}o.renderGroupTemplate=b;function S(){var L=new Uint32Array(1);return window.crypto.getRandomValues(L),Math.floor((1+L[0]/4294967296)*65536).toString(16).substring(1)}o.generateId=S;function C(L,N,R,P,k,B,F){var O=N[R.child]||[],z=N[R.hasChildren];if(O.length&&(z=!0,B.classList.add(si.hasChild),k.processSubChild)){var Y=a(L,O,k,++F);B.appendChild(Y)}if(k.expandCollapse&&z&&!k.template){B.firstElementChild.classList.add(si.iconWrapper);var K=k.expandIconPosition==="Left"?$r:bt;K([L("div",{className:"e-icons "+k.expandIconClass})],B.querySelector("."+si.textContent))}}function x(L,N,R,P,k,B,F,O,z,Y){var K=pe({},e,Y),U=pe({},t,K.ariaAttributes),q=N,ae=N,te;typeof N!="string"&&typeof N!="number"&&typeof N!="boolean"&&(te=N,q=typeof R[P.text]=="boolean"||typeof R[P.text]=="number"?R[P.text]:R[P.text]||"",ae=R[P.value]);var he;!g(te)&&!g(R[P.id])&&R[P.id]!==""?he=O:he=O+"-"+z;var ue=L("li",{className:(F===!0?si.group:si.li)+" "+(g(k)?"":k),id:he,attrs:U.groupItemRole!==""&&U.itemRole!==""?{role:F===!0?U.groupItemRole:U.itemRole}:{}});return te&&Object.prototype.hasOwnProperty.call(R,P.enabled)&&R[P.enabled].toString()==="false"&&ue.classList.add(si.disabled),Y&&Y.enableHtmlSanitizer&&(q=Pt.sanitize(q)),F?ue.innerText=q:(ue.setAttribute("data-value",g(ae)?"null":ae),ue.setAttribute("role","option"),te&&Object.prototype.hasOwnProperty.call(R,P.htmlAttributes)&&R[P.htmlAttributes]&&v(ue,R[P.htmlAttributes]),B.length&&!K.itemNavigable&&bt(B,ue),te&&(R[P.url]||R[P.urlAttributes]&&R[P.urlAttributes].href)?ue.appendChild(D(L,te,P,q,B,K.itemNavigable)):(B.length&&K.itemNavigable&&bt(B,ue),ue.appendChild(document.createTextNode(q)))),ue}function I(L){var N;return N={li:"e-"+L+"-item",ul:"e-"+L+"-parent e-ul",group:"e-"+L+"-group-item",icon:"e-"+L+"-icon",text:"e-"+L+"-text",check:"e-"+L+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+L+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+L+"-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function D(L,N,R,P,k,B){var F=In(N,R),O={href:F[R.url]};Object.prototype.hasOwnProperty.call(F,R.urlAttributes)&&F[R.urlAttributes]&&(mt(O,F[R.urlAttributes]),O.href=F[R.url]?F[R.url]:F[R.urlAttributes].href);var z;if(!B)z=L("a",{className:si.text+" "+si.url,innerHTML:P});else{z=L("a",{className:si.text+" "+si.url});var Y=L("div",{className:si.anchorWrap});k&&k.length&&bt(k,Y),Y.appendChild(document.createTextNode(P)),bt([Y],z)}return v(z,O),z}function M(L,N,R,P,k,B,F){var O=pe({},e,B),z=pe({},t,O.ariaAttributes),Y=N,K,U,q;typeof N!="string"&&typeof N!="number"&&(q=N,Y=R[P.text]||"",K=g(R._id)?R[P.id]:R._id,U=!!(Object.prototype.hasOwnProperty.call(N,"isHeader")&&N.isHeader)),B&&B.enableHtmlSanitizer&&(Y=Pt.sanitize(Y));var ae=L("li",{className:(U===!0?si.group:si.li)+" "+(g(k)?"":k),attrs:z.groupItemRole!==""&&z.itemRole!==""?{role:U===!0?z.groupItemRole:z.itemRole}:{}});if(g(K)?ae.setAttribute("data-uid",S()):ae.setAttribute("data-uid",K),U&&B&&B.groupTemplate){var te=Om(B.groupTemplate);if(F&&F.getModuleName()!=="listview"){var he=te(N,F,"groupTemplate",O.groupTemplateID,!!O.isStringTemplate,null,ae);he&&bt(he,ae)}else bt(te(N,F,"groupTemplate",O.groupTemplateID,!!O.isStringTemplate),ae)}else if(!U&&B&&B.template){var te=Om(B.template);if(F&&F.getModuleName()!=="listview"){var he=te(N,F,"template",O.templateID,!!O.isStringTemplate,null,ae);he&&bt(he,ae)}else bt(te(N,F,"template",O.templateID,!!O.isStringTemplate),ae)}else{var ue=L("div",{className:si.textContent,attrs:z.wrapperRole!==""?{role:z.wrapperRole}:{}});if(q&&(R[P.url]||R[P.urlAttributes]&&R[P.urlAttributes].href))ue.appendChild(D(L,q,P,Y,null,O.itemNavigable));else{var ne=L("span",{className:si.text,attrs:z.itemText!==""?{role:z.itemText}:{}});B&&B.enableHtmlSanitizer?ne.innerText=Y:ne.innerHTML=Y,ue.appendChild(ne)}ae.appendChild(ue)}return ae}function E(L,N,R,P){var k=pe({},e,P),B=pe({},t,k.ariaAttributes);si=I(k.moduleName);var F=L("ul",{className:si.ul+" "+(g(R)?"":R),attrs:B.listRole!==""?{role:B.listRole}:{}});return bt(N,F),F}o.generateUL=E;function A(L,N,R,P){var k=pe({},e,P);si=I(k.moduleName);var B=k.expandIconPosition==="Left"?$r:bt;return B([L("div",{className:"e-icons "+k.expandIconClass+" "+(g(R)?"":R)})],N.querySelector("."+si.textContent)),N}o.generateIcon=A})(kt||(kt={}));function In(o,t){var e={};if(g(o)||typeof o=="string"||typeof o=="number"||!g(o.isHeader))return o;for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i],s=t[""+n],a=!g(s)&&typeof s=="string"?V(s,o):void 0;g(a)||(e[""+s]=a)}return e}function Om(o){if(o)try{return typeof o!="function"&&document.querySelector(o)?Et(document.querySelector(o).innerHTML.trim()):Et(o)}catch{return Et(o)}}var fk=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ai=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},uk={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},E_={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},ye={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",container:"e-list-container",icon:"e-icons",backIcon:"e-icon-back",backButton:"e-back-button",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist",virtualElementContainer:"e-list-virtualcontainer",listTemplate:"e-listview-template"},dk="Template",pk="GroupTemplate",T_="HeaderTemplate",A_=.5,L_=(function(o){fk(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ai([w("id")],t.prototype,"id",void 0),ai([w("text")],t.prototype,"text",void 0),ai([w("isChecked")],t.prototype,"isChecked",void 0),ai([w("isVisible")],t.prototype,"isVisible",void 0),ai([w("enabled")],t.prototype,"enabled",void 0),ai([w("iconCss")],t.prototype,"iconCss",void 0),ai([w("child")],t.prototype,"child",void 0),ai([w("tooltip")],t.prototype,"tooltip",void 0),ai([w("groupBy")],t.prototype,"groupBy",void 0),ai([w("text")],t.prototype,"sortBy",void 0),ai([w("htmlAttributes")],t.prototype,"htmlAttributes",void 0),ai([w("tableName")],t.prototype,"tableName",void 0),t})(Oe),hf=(function(o){fk(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.previousSelectedItems=[],r.hiddenItems=[],r.enabledItems=[],r.disabledItems=[],r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(i.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1,"header");break;case"query":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"showHeader":this.header(this.headerTitle,!1,"header");break;case"enableVirtualization":g(this.contentContainer)||se(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.previousScrollTop=this.element.scrollTop,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"template":this.enableVirtualization||this.refresh();break;case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList());break}}},t.prototype.setHTMLAttribute=function(){!g(this.htmlAttributes)&&Object.keys(this.htmlAttributes).length&&Ee(this.element,this.htmlAttributes)},t.prototype.setCSSClass=function(e){this.cssClass&&X([this.element],this.cssClass.split(" ").filter(function(i){return i})),e&&Z([this.element],e.split(" ").filter(function(i){return i}))},t.prototype.setSize=function(){this.element.style.height=Ae(this.height),this.element.style.width=Ae(this.width),this.isWindow=!this.element.clientHeight},t.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},t.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},t.prototype.enableElement=function(e,i){i?e.classList.remove(ye.disable):e.classList.add(ye.disable)},t.prototype.header=function(e,i,r){if(this.headerEle===void 0&&this.showHeader){this.headerEle=this.createElement("div",{className:ye.header});var n=this.createElement("span",{className:ye.headerText});this.enableHtmlSanitizer?(this.setProperties({headerTitle:Pt.sanitize(this.headerTitle)},!0),n.innerText=this.headerTitle):n.innerHTML=this.headerTitle;var s=this.createElement("div",{className:ye.text,innerHTML:n.outerHTML}),a=this.createElement("div",{className:ye.icon+" "+ye.backIcon+" "+ye.backButton,attrs:{style:"display:none;"}});if(this.headerEle.appendChild(a),this.headerEle.appendChild(s),this.headerTemplate){var l=Et(this.headerTemplate),h=this.createElement("div",{className:ye.headerTemplateText}),c=l({},this,r,this.LISTVIEW_HEADERTEMPLATE_ID,null,null,this.headerEle);c&&bt(c,h),bt([h],this.headerEle),this.isReact&&this.renderReactTemplates()}this.headerTemplate&&this.headerTitle&&s.classList.add("header"),this.element.classList.add("e-has-header"),$r([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var s=this.headerEle.querySelector("."+ye.headerText),a=this.headerEle.querySelector("."+ye.backIcon);this.enableHtmlSanitizer&&(e=Pt.sanitize(e)),s.innerHTML=e,this.headerTemplate&&i&&(s.parentElement.classList.remove("header"),this.headerEle.querySelector("."+ye.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!i&&(s.parentElement.classList.add("header"),this.headerEle.querySelector("."+ye.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+ye.headerTemplateText).classList.add("header")),i===!0?a.style.display="":a.style.display="none"}else this.headerEle.style.display="none"},t.prototype.switchView=function(e,i,r){var n=this;if(e&&i){var s=e.style.position,a=this.element.style.overflow!=="hidden"?this.element.style.overflow:"";e.style.position="absolute",e.classList.add("e-view");var l=void 0,h=this.animation.duration;if(this.animation.effect)l=this.enableRtl?E_[this.animation.effect]:uk[this.animation.effect];else{var c="SlideLeft";l=uk[""+c],r=this.enableRtl,h=0}this.element.style.overflow="hidden",this.aniObj.animate(e,{name:r===!0?l[0]:l[1],duration:h===0&&Yt==="Enable"?400:h,timingFunction:this.animation.easing,end:function(){e.style.display="none",n.element.style.overflow=a,e.style.position=s,e.classList.remove("e-view")}}),i.style.display="",this.aniObj.animate(i,{name:r===!0?l[2]:l[3],duration:h===0&&Yt==="Enable"?400:h,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=i}},t.prototype.preRender=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&this.setProperties({template:document.querySelector(this.template).innerHTML.trim()},!0)}catch{Et(this.template)}this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"listitem",listRole:"list",itemText:"",groupItemRole:"presentation",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this),templateID:""+this.element.id+dk,groupTemplateID:""+this.element.id+pk,enableHtmlSanitizer:this.enableHtmlSanitizer},this.initialization()},t.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=this.enablePersistence?this.selectedId:[],this.LISTVIEW_TEMPLATE_ID=""+this.element.id+dk,this.LISTVIEW_GROUPTEMPLATE_ID=""+this.element.id+pk,this.LISTVIEW_HEADERTEMPLATE_ID=""+this.element.id+T_,this.aniObj=new Mt(this.animateOptions),this.removeElement(this.curUL),this.removeElement(this.ulElement),this.removeElement(this.headerEle),this.removeElement(this.contentContainer),this.curUL=this.ulElement=this.liCollection=this.headerEle=this.contentContainer=void 0},t.prototype.renderCheckbox=function(e){var i=this;if(e.item.classList.contains(ye.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&e.item.classList.contains(ye.listItem)){var r,n=hl(this.createElement,!1,{checked:!1,enableRtl:this.enableRtl,cssClass:ye.listviewCheckbox});n.setAttribute("role","checkbox");var s=n.querySelector("."+ye.checkboxIcon);if(e.item.classList.add(ye.itemCheckList),e.item.firstElementChild.classList.add(ye.checkbox),this.template&&this.element?X([this.element],ye.listTemplate):this.template===null&&this.element&&this.element.classList&&this.element.classList.contains("e-listview-template")&&Z([this.element],ye.listTemplate),typeof this.dataSource[0]!="string"&&typeof this.dataSource[0]!="number")if(r=In(e.curData,this.listBaseOption.fields),this.enablePersistence&&!g(this.selectedId)){var a=this.selectedId.findIndex(function(l){return l===r[i.listBaseOption.fields.id].toString()});a!==-1&&this.checkInternally(e,n)}else r[this.listBaseOption.fields.isChecked]&&this.checkInternally(e,n);else(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")&&this.selectedData.indexOf(e.text)!==-1&&this.checkInternally(e,n);n.setAttribute("aria-checked",s.classList.contains(ye.checked)?"true":"false"),n.setAttribute("aria-label",e.text),this.checkBoxPosition==="Left"?(n.classList.add(ye.checkboxLeft),e.item.firstElementChild.classList.add(ye.checkboxLeft),e.item.firstElementChild.insertBefore(n,e.item.firstElementChild.childNodes[0])):(n.classList.add(ye.checkboxRight),e.item.firstElementChild.classList.add(ye.checkboxRight),e.item.firstElementChild.appendChild(n)),this.currentLiElements.push(e.item),this.checkBoxPosition==="Left"?this.virtualCheckBox=e.item.firstElementChild.children[0]:this.virtualCheckBox=e.item.firstElementChild.lastElementChild}},t.prototype.checkInternally=function(e,i){e.item.classList.add(ye.selected),i.querySelector("."+ye.checkboxIcon).classList.add(ye.checked),i.setAttribute("aria-checked","true")},t.prototype.checkItem=function(e){this.toggleCheckBase(e,!0)},t.prototype.toggleCheckBase=function(e,i){if(this.showCheckBox){var r=e;if(e instanceof Object&&e.constructor!==HTMLLIElement&&(r=this.getLiFromObjOrElement(e)),!g(r)){var n=r.querySelector("."+ye.checkboxIcon);i===!0?r.classList.add(ye.selected):r.classList.remove(ye.selected),i===!0?n.classList.add(ye.checked):n.classList.remove(ye.checked),n.parentElement.setAttribute("aria-checked",i?"true":"false")}this.setSelectedItemData(r),this.updateSelectedId()}},t.prototype.uncheckItem=function(e){this.toggleCheckBase(e,!1)},t.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},t.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},t.prototype.toggleAllCheckBase=function(e){if(this.showCheckBox){for(var i=0;i<this.liCollection.length;i++){var r=this.liCollection[i].querySelector("."+ye.checkboxIcon);r&&(e?r.classList.contains(ye.checked)||this.checkItem(this.liCollection[i]):r.classList.contains(ye.checked)&&this.uncheckItem(this.liCollection[i]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(e),this.updateSelectedId()}},t.prototype.setCheckbox=function(){if(this.showCheckBox)for(var e=Array.prototype.slice.call(this.element.querySelectorAll("."+ye.listItem)),i={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""},r=0;r<e.length;r++){var n=e[r];i.item=n,i.curData=this.getItemData(n),n.querySelector("."+ye.checkboxWrapper)&&this.removeElement(n.querySelector("."+ye.checkboxWrapper)),this.renderCheckbox(i),i.item.classList.contains(ye.selected)&&this.checkInternally(i,i.item.querySelector("."+ye.checkboxWrapper))}else{for(var e=Array.prototype.slice.call(this.element.querySelectorAll("."+ye.itemCheckList)),r=0;r<e.length;r++){var n=e[r];n.classList.remove(ye.selected),n.firstElementChild.classList.remove(ye.checkbox),this.removeElement(n.querySelector("."+ye.checkboxWrapper))}this.selectedItems&&this.selectedItems.item.classList.add(ye.selected)}},t.prototype.refreshItemHeight=function(){this.virtualizationModule&&this.virtualizationModule.refreshItemHeight()},t.prototype.handleCheckboxState=function(e,i,r,n,s,a,l,h){this.trigger("select",a,function(c){c.cancel&&((l?n:!n)?(i.classList.add(ye.checked),e.classList.add(ye.selected)):(i.classList.remove(ye.checked),e.classList.remove(ye.selected)),r.setAttribute("aria-checked",l?n?"true":"false":n?"false":"true"),mt(a,{isChecked:i.classList.contains(ye.checked)}),s&&(e.classList.remove(ye.focused),h&&h.classList.remove("e-focused")))})},t.prototype.clickHandler=function(e){if(!(Array.isArray(this.dataSource)&&this.dataSource.length===0)){var i=e.target;this.targetElement=i;var r=i.classList,n;if(r.contains(ye.backIcon)||r.contains(ye.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var s=H(i.parentNode,"."+ye.listItem);if(s===null&&(s=i),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(s))if(e.target.classList.contains(ye.checkboxIcon)){if(s.classList.add(ye.focused),g(s.querySelector("."+ye.checked))){var a={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:s};this.checkInternally(a,a.item.querySelector("."+ye.checkboxWrapper))}else this.uncheckItem(s),s.classList.add(ye.focused);if(this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(s,e),e){var l=this.selectEventData(s,e),h=s.querySelector("."+ye.checkboxIcon);mt(l,{isChecked:h.classList.contains(ye.checked)});var c=s.querySelector("."+ye.checkboxWrapper),u=h.classList.contains(ye.checked),d=s.classList.contains(ye.focused);this.handleCheckboxState(s,h,c,u,d,l,!1)}}else s.classList.contains(ye.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(s),this.setSelectLI(s,e),s.classList.remove(ye.selected)):(this.setCheckboxLI(s,e),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i));else this.setSelectLI(s,e),(i.nodeName==="INPUT"||i.nodeName==="TEXTAREA")&&(i.classList.add("e-focused"),this.targetElement=i);n=H(e.target,"li"),g(n)||n.classList.contains("e-has-child")&&!e.target.parentElement.classList.contains("e-listview-checkbox")&&n.classList.add(ye.disable)}this.updateSelectedId()}},t.prototype.removeElement=function(e){return e&&e.parentNode&&e.parentNode.removeChild(e)},t.prototype.hoverHandler=function(e){var i=H(e.target.parentNode,"."+ye.listItem);this.setHoverLI(i)},t.prototype.leaveHandler=function(){this.removeHover()},t.prototype.homeKeyHandler=function(e,i){if(e.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var r=this.curUL.querySelectorAll("."+ye.listItem),n=this.curUL.querySelector("."+ye.focused)||this.curUL.querySelector("."+ye.selected);n&&(n.classList.remove(ye.focused),this.showCheckBox||n.classList.remove(ye.selected));var s=i?r.length-1:0;r[s].classList.contains(ye.hasChild)||this.showCheckBox?r[s].classList.add(ye.focused):this.setSelectLI(r[s],e),r[s]?this.element.setAttribute("aria-activedescendant",r[s].id.toString()):this.element.removeAttribute("aria-activedescendant")}},t.prototype.onArrowKeyDown=function(e,i){var r,n,s=!g(this.curUL.querySelector("."+ye.hasChild));return s||this.showCheckBox?(n=this.curUL.querySelector("."+ye.focused)||this.curUL.querySelector("."+ye.selected),r=kt.getSiblingLI(this.curUL.querySelectorAll("."+ye.listItem),n,i),g(r)||(n&&(n.classList.remove(ye.focused),this.showCheckBox||n.classList.remove(ye.selected)),r.classList.contains(ye.hasChild)||this.showCheckBox?r.classList.add(ye.focused):this.setSelectLI(r,e))):(n=this.curUL.querySelector("."+ye.selected),r=kt.getSiblingLI(this.curUL.querySelectorAll("."+ye.listItem),n,i),this.setSelectLI(r,e)),r?this.element.setAttribute("aria-activedescendant",r.id.toString()):this.element.removeAttribute("aria-activedescendant"),r},t.prototype.arrowKeyHandler=function(e,i){var r=this;if(e.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(e,i),s=this.element.getBoundingClientRect().top,a=this.element.getBoundingClientRect().height,l=this.curUL.querySelector("."+ye.listItem).getBoundingClientRect(),h=void 0,c=void 0;if(this.fields.groupBy&&(c=this.curUL.querySelector("."+ye.groupListItem).getBoundingClientRect()),n){var u=n.getBoundingClientRect().top,d=n.getBoundingClientRect().height;if(i)h=this.isWindow?u:u-s,h<0&&(this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop+h);else{var p=this.isWindow?window.innerHeight:a;h=this.isWindow?u+d:u-s+d,h>p&&(this.isWindow===!0?window.scroll(0,pageYOffset+(h-p)):this.element.scrollTop=this.element.scrollTop+(h-p))}}else if(this.enableVirtualization&&i&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){r.onArrowKeyDown(e,i),r.onUIScrolled=void 0},h=this.virtualizationModule.listItemHeight,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=this.element.scrollTop-h;else if(i)if(this.showHeader&&this.headerEle){var f=c?c.top:l.top,v=this.headerEle.getBoundingClientRect();h=v.top<0?v.height-f:0,this.isWindow===!0?window.scroll(0,pageYOffset-h):this.element.scrollTop=0}else this.fields.groupBy&&(h=this.isWindow?c.top<0?c.top:0:s-l.top+c.height,this.isWindow===!0?window.scroll(0,pageYOffset+h):this.element.scrollTop=this.element.scrollTop-h)}},t.prototype.enterKeyHandler=function(e){if(Object.keys(this.dataSource).length&&this.curUL){var i=!g(this.curUL.querySelector("."+ye.hasChild)),r=this.curUL.querySelector("."+ye.focused);i&&r&&(r.classList.remove(ye.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(r),this.removeHover()),this.setSelectLI(r,e))}},t.prototype.spaceKeyHandler=function(e){if(this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){e.preventDefault();var i=this.curUL.querySelector("."+ye.focused),r=void 0,n=void 0;if(!g(i)&&g(i.querySelector("."+ye.checked))){var s={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:i};r=s.item.querySelector("."+ye.checkboxWrapper),this.checkInternally(s,r),n=r.querySelector("."+ye.checkboxIcon+"."+ye.icon)}else this.uncheckItem(i);var a=this.selectEventData(i,e);if(mt(a,{isChecked:n?n.classList.contains(ye.checked):!1}),!g(i)){var l=i.querySelector("."+ye.checkboxWrapper),h=i.querySelector("."+ye.checkboxIcon),c=h.classList.contains(ye.checked),u=i.classList.contains(ye.focused);this.handleCheckboxState(i,h,l,c,u,a,!1)}this.updateSelectedId()}},t.prototype.keyActionHandler=function(e){switch(e.keyCode){case 36:this.homeKeyHandler(e);break;case 35:this.homeKeyHandler(e,!0);break;case 40:this.arrowKeyHandler(e);break;case 38:this.arrowKeyHandler(e,!0);break;case 13:this.enterKeyHandler(e);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 32:(g(this.targetElement)||!this.targetElement.classList.contains("e-focused"))&&this.spaceKeyHandler(e);break}},t.prototype.swipeActionHandler=function(e){e.swipeDirection==="Right"&&e.velocity>A_&&e.originalEvent.type==="touchend"&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},t.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var e=this.curUL.querySelector("."+ye.focused);e&&(e.classList.remove(ye.focused),!this.showCheckBox&&!g(this.selectedLI)&&this.selectedLI.classList.add(ye.selected))}},t.prototype.wireEvents=function(){T.add(this.element,"keydown",this.keyActionHandler,this),T.add(this.element,"click",this.clickHandler,this),T.add(this.element,"mouseover",this.hoverHandler,this),T.add(this.element,"mouseout",this.leaveHandler,this),T.add(this.element,"focusout",this.focusout,this),this.touchModule=new jr(this.element,{swipe:this.swipeActionHandler.bind(this)}),g(this.scroll)||T.add(this.element,"scroll",this.onListScroll,this)},t.prototype.unWireEvents=function(){T.remove(this.element,"keydown",this.keyActionHandler),T.remove(this.element,"click",this.clickHandler),T.remove(this.element,"mouseover",this.hoverHandler),T.remove(this.element,"mouseout",this.leaveHandler),T.remove(this.element,"mouseover",this.hoverHandler),T.remove(this.element,"mouseout",this.leaveHandler),T.remove(this.element,"focusout",this.focusout),g(this.scroll)||T.remove(this.element,"scroll",this.onListScroll),this.touchModule&&this.touchModule.destroy(),this.touchModule=null},t.prototype.removeFocus=function(){for(var e=this.element.querySelectorAll("."+ye.focused),i=0,r=e;i<r.length;i++){var n=r[i];n.classList.remove(ye.focused)}},t.prototype.removeHover=function(){var e=this.element.querySelector("."+ye.hover);e&&e.classList.remove(ye.hover)},t.prototype.removeSelect=function(e){if(g(e))for(var i=this.element.querySelectorAll("."+ye.selected),r=0,n=i;r<n.length;r++){var s=n[r];this.showCheckBox&&s.querySelector("."+ye.checked)||s.classList.remove(ye.selected)}else e.classList.remove(ye.selected)},t.prototype.isValidLI=function(e){return e&&e.classList.contains(ye.listItem)&&!e.classList.contains(ye.groupListItem)&&!e.classList.contains(ye.disable)},t.prototype.setCheckboxLI=function(e,i){if(this.isValidLI(e)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+ye.focused)&&this.curUL.querySelector("."+ye.focused).classList.remove(ye.focused);var r=e.querySelector("textarea")||e.querySelector("input");e.classList.add(ye.focused),g(i)||i.target===r&&r.classList.add("e-focused");var n=e.querySelector("."+ye.checkboxWrapper),s=n.querySelector("."+ye.checkboxIcon+"."+ye.icon);this.removeHover();var a=s.classList.contains(ye.checked),l=e.classList.contains(ye.focused);a?(s.classList.remove(ye.checked),e.classList.remove(ye.selected)):(s.classList.add(ye.checked),e.classList.add(ye.selected)),n.setAttribute("aria-checked",s.classList.contains(ye.checked)?"true":"false");var h=this.selectEventData(e,i);mt(h,{isChecked:s.classList.contains(ye.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(e,i),this.handleCheckboxState(e,s,n,a,l,h,!0,r),this.setSelectedItemData(e),this.renderSubList(e)}},t.prototype.selectEventData=function(e,i){var r=this.getItemData(e),n=In(r,this.listBaseOption.fields),s;!g(r)&&typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number"?s={item:e,text:e&&e.innerText.trim(),data:this.dataSource}:s={item:e,text:n&&n[this.listBaseOption.fields.text],data:r};var a={};return mt(a,s),i&&mt(a,{isInteracted:!0,event:i,cancel:!1,index:this.curUL&&Array.prototype.indexOf.call(this.curUL.children,e)}),a},t.prototype.setSelectedItemData=function(e){var i=this.getItemData(e),r=In(i,this.listBaseOption.fields);!g(i)&&(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")?this.selectedItems={item:e,text:e&&e.innerText.trim(),data:this.dataSource}:this.selectedItems={item:e,text:r&&r[this.listBaseOption.fields.text],data:i}},t.prototype.setSelectLI=function(e,i){var r=this;if(this.isValidLI(e)&&!e.classList.contains(ye.selected)&&this.enable){this.showCheckBox||this.removeSelect(),e.classList.add(ye.selected),this.removeHover(),this.setSelectedItemData(e),this.enableVirtualization&&this.virtualizationModule.setSelectLI(e,i);var n=this.selectEventData(e,i);this.trigger("select",n,function(s){s.cancel?(e.classList.remove(ye.selected),r.selectedLI=e):(r.selectedLI=e,r.renderSubList(e))})}},t.prototype.setHoverLI=function(e){if(this.isValidLI(e)&&!e.classList.contains(ye.hover)&&this.enable){var i=this.element.querySelectorAll("."+ye.hover);i&&i.length&&Z(i,ye.hover),(!e.classList.contains(ye.selected)||this.showCheckBox)&&e.classList.add(ye.hover)}},t.prototype.getSubDS=function(){var e=this.curDSLevel;if(e.length){for(var i=this.localData,r=0,n=e;r<n.length;r++){var s=n[r],a={};a[this.fields.id]=s,this.curDSJSON=this.findItemFromDS(i,a);var l=In(this.curDSJSON,this.listBaseOption.fields);i=this.curDSJSON?l[this.fields.child]:i}return i}return this.localData},t.prototype.getItemData=function(e){var i=this.dataSource instanceof oe?this.localData:this.dataSource,r=this.getElementUID(e),n;return g(this.element.querySelector("."+ye.hasChild))&&this.fields.groupBy?n=this.curViewDS:n=i,this.findItemFromDS(n,r)},t.prototype.findItemFromDS=function(e,i,r){var n=this,s;return e&&e.length&&i?e.some(function(a){var l=In(a,n.listBaseOption.fields);if((i[n.fields.id]||i[n.fields.text])&&(!i[n.fields.id]||(!g(l[n.fields.id])&&l[n.fields.id].toString())===i[n.fields.id].toString())&&(!i[n.fields.text]||l[n.fields.text]===i[n.fields.text]))s=r?e:a;else if(typeof a!="object"&&e.indexOf(a)!==-1)s=r?e:a;else if(!g(i[n.fields.id])&&g(l[n.fields.id])){var h=n.element.querySelector('[data-uid="'+i[n.fields.id]+'"]');h&&h.innerText.trim()===l[n.fields.text]&&(s=a)}else Object.prototype.hasOwnProperty.call(l,n.fields.child)&&l[n.fields.child].length&&(s=n.findItemFromDS(l[n.fields.child],i,r));return!!s}):s=e,s},t.prototype.getQuery=function(){var e=[],i=this.query?this.query:new Pe;if(!this.query){for(var r=0,n=Object.keys(this.fields.properties);r<n.length;r++){var s=n[r];s!=="tableName"&&this.fields[""+s]&&this.fields[""+s]!==kt.defaultMappedFields[""+s]&&e.indexOf(this.fields[""+s])===-1&&e.push(this.fields[""+s])}i.select(e),Object.prototype.hasOwnProperty.call(this.fields.properties,"tableName")&&i.from(this.fields.tableName)}return i},t.prototype.setViewDataSource=function(e){e===void 0&&(e=this.localData);var i=g(this.fields.sortBy)?this.fields.text:this.fields.sortBy,r=kt.addSorting(this.sortOrder,i);e&&this.fields.groupBy?this.sortOrder!=="None"?this.curViewDS=kt.groupDataSource(kt.getDataSource(e,r),this.listBaseOption.fields,this.sortOrder):this.curViewDS=kt.groupDataSource(e,this.listBaseOption.fields,this.sortOrder):e&&this.sortOrder!=="None"?this.curViewDS=kt.getDataSource(e,r):this.curViewDS=e},t.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},t.prototype.renderRemoteLists=function(e,i){this.isDestroyed||(this.localData=e.result,i.removeElement(i.contentContainer),this.renderList(),this.trigger("actionComplete",e))},t.prototype.triggerActionFailure=function(e){this.isDestroyed||this.trigger("actionFailure",e)},t.prototype.setLocalData=function(){var e=this;if(this.trigger("actionBegin"),this.dataSource instanceof oe)this.dataSource.ready?this.dataSource.ready.then(function(r){e.isOffline=e.dataSource.dataSource.offline,e.dataSource instanceof oe&&e.isOffline&&e.renderRemoteLists(r,e)}).catch(function(r){e.triggerActionFailure(r)}):this.dataSource.executeQuery(this.getQuery()).then(function(r){e.renderRemoteLists(r,e)}).catch(function(r){e.triggerActionFailure(r)});else if(!this.dataSource||!this.dataSource.length){var i=this.element.querySelector("ul");i&&(Qe(i),this.setProperties({dataSource:kt.createJsonFromElement(i)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}else this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData})},t.prototype.reRender=function(){this.removeElement(this.headerEle),this.removeElement(this.ulElement),this.removeElement(this.contentContainer),this.isReact&&this.clearTemplate(),Object.keys(window).indexOf("ejsInterop")===-1&&(this.element.innerHTML=""),this.headerEle=this.ulElement=this.liCollection=void 0,this.header(),this.setLocalData()},t.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},t.prototype.setAttributes=function(e){for(var i=0;i<e.length;i++){var r=e[parseInt(i.toString(),10)];r.classList.contains("e-list-item")&&(r.setAttribute("id",this.element.id+"_"+r.getAttribute("data-uid")),r.setAttribute("tabindex","-1"))}},t.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=kt.createList(this.createElement,this.curViewDS,this.listBaseOption,null,this),this.liCollection=this.curUL.querySelectorAll("."+ye.listItem),this.setAttributes(this.liCollection)},t.prototype.renderSubList=function(e){this.liElement=e;var i=e.getAttribute("data-uid");if(e.classList.contains(ye.hasChild)&&i){var r=H(e.parentNode,"."+ye.parentItem),n=this.element.querySelector("[pid='"+i+"']");if(this.curDSLevel.push(i),this.setViewDataSource(this.getSubDS()),this.enableVirtualization&&this.virtualizationModule.updateDOMItemCount(),!n){var s=this.curViewDS;n=kt.createListFromJson(this.createElement,s,this.listBaseOption,this.curDSLevel.length,null,this),this.isReact&&this.renderReactTemplates();var a=n.querySelectorAll("."+ye.listItem);this.setAttributes(a),n.setAttribute("pID",i),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(r,n),this.liCollection=this.curUL.querySelectorAll("."+ye.listItem),this.selectedItems){var l=In(this.selectedItems.data,this.listBaseOption.fields);this.header(l[this.listBaseOption.fields.text],!0,"header")}this.selectedLI=void 0}},t.prototype.renderIntoDom=function(e){this.contentContainer.appendChild(e)},t.prototype.renderList=function(e){this.setViewDataSource(e),this.enableVirtualization?(Object.keys(this.dataSource).length&&(this.template||this.groupTemplate)&&!this.virtualizationModule.isNgTemplate()&&(this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=this.createElement("div",{className:ye.container}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement),this.isReact&&this.renderReactTemplates())},t.prototype.getElementUID=function(e){var i={};return e instanceof Element?i[this.fields.id]=e.getAttribute("data-uid"):i=e,i},t.prototype.render=function(){this.element.classList.add(ye.root),Ee(this.element,{tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=Wi(this.element,{selector:"."+ye.listItem}),this.renderComplete(),this.previousScrollTop=this.element.scrollTop},t.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unWireEvents();var e=[ye.root,ye.disable,"e-rtl","e-has-header","e-lib"].concat(this.cssClass?this.cssClass.split(" ").filter(function(i){return i}):[]);Z([this.element],e),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,this.element.innerHTML="",this.contentContainer=null,this.selectedItems=null,this.selectedLI=null,this.liElement=null,this.targetElement=null,this.currentLiElements=null,this.virtualCheckBox=null,o.prototype.destroy.call(this)},t.prototype.back=function(){var e=this.curDSLevel[this.curDSLevel.length-1];if(!(e===void 0||this.isInAnimation())){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS()),this.enableVirtualization&&this.virtualizationModule.updateDOMItemCount();var i=this.element.querySelector("[data-uid='"+e+"']"),r=this.curUL;i?i=i.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),i=this.curUL);var n=In(this.curDSJSON,this.listBaseOption.fields),s=n[this.fields.text];this.switchView(r,i,!0),this.removeFocus();var a=this.element.querySelector("[data-uid='"+e+"']");a.classList.remove(ye.disable),a.classList.add(ye.focused),this.showCheckBox&&a.querySelector("."+ye.checkboxIcon).classList.contains(ye.checked)||a.classList.remove(ye.selected),this.liCollection=this.curUL.querySelectorAll("."+ye.listItem),this.enableHtmlSanitizer&&this.setProperties({headerTitle:Pt.sanitize(this.headerTitle)},!0),this.header(this.curDSLevel.length?s:this.headerTitle,!!this.curDSLevel.length,"header")}},t.prototype.selectItem=function(e){this.enableVirtualization?this.virtualizationModule.selectItem(e):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(e)):g(e)===!0?this.removeSelect():this.setSelectLI(this.getLiFromObjOrElement(e))},t.prototype.unselectItem=function(e){if(g(e))this.removeSelect();else{var i=this.getLiFromObjOrElement(e);g(i)||this.removeSelect(i)}},t.prototype.getLiFromObjOrElement=function(e){var i,r=this.dataSource instanceof oe?this.localData:this.dataSource;if(!g(e))if(typeof r[0]=="string"||typeof r[0]=="number")if(e instanceof Element){for(var n=e.getAttribute("data-uid").toString(),s=0;s<this.liCollection.length;s++)if(this.liCollection[parseInt(s.toString(),10)].getAttribute("data-uid").toString()===n){i=this.liCollection[parseInt(s.toString(),10)];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+ye.listItem),function(c){return c.innerText.trim()===e.toString()?(i=c,!0):!1});else{var a=this.getItemData(e),l=In(a,this.listBaseOption.fields);if(a&&(i=this.element.querySelector('[data-uid="'+l[this.fields.id]+'"]'),!this.enableVirtualization&&g(i)))for(var h=this.element.querySelectorAll("."+ye.listItem),s=0;s<h.length;s++)h[parseInt(s.toString(),10)].innerText.trim()===l[this.fields.text]&&(i=h[parseInt(s.toString(),10)])}return i},t.prototype.selectMultipleItems=function(e){if(!g(e))for(var i=0;i<e.length;i++)g(e[parseInt(i.toString(),10)])||this.selectItem(e[parseInt(i.toString(),10)])},t.prototype.getParentId=function(){var e=[];if(this.isNestedList)for(var i=this.curDSLevel.length-1;i>=0;i--)e.push(this.curDSLevel[parseInt(i.toString(),10)]);return e},t.prototype.updateSelectedId=function(){this.selectedId=[];for(var e=this.curUL.getElementsByClassName(ye.selected),i=0;i<e.length;i++){var r=this.getItemData(e[parseInt(i.toString(),10)]);!g(r)&&r[this.listBaseOption.fields.id]&&this.selectedId.push(r[this.listBaseOption.fields.id])}},t.prototype.getSelectedItems=function(){var e,i=!1;this.selectedId=[];var r=this.dataSource instanceof oe?this.localData:this.dataSource;if(this.enableVirtualization&&!i)e=this.virtualizationModule.getSelectedItems(),i=!0;else if(this.showCheckBox&&!i){var n=this.curUL.getElementsByClassName(ye.selected),s=[],a=[];this.selectedId=[];for(var l=[],h=0;h<n.length;h++)if(typeof r[0]=="string"||typeof r[0]=="number")s.push(n[parseInt(h.toString(),10)].innerText.trim());else{var c=this.getItemData(n[parseInt(h.toString(),10)]),u=In(c,this.listBaseOption.fields);this.isNestedList?l.push({data:c,parentId:this.getParentId()}):a.push(c),u?(s.push(u[this.listBaseOption.fields.text]),this.selectedId.push(u[this.listBaseOption.fields.id])):(s.push(void 0),this.selectedId.push(void 0))}(typeof r[0]=="string"||typeof r[0]=="number")&&!i&&(e={item:n,data:r,text:s},i=!0),this.isNestedList&&!i?(e={item:n,data:l,text:s},i=!0):i||(e={item:n,data:a,text:s},i=!0)}else if(!i){var d=this.element.getElementsByClassName(ye.selected)[0],u=In(this.getItemData(d),this.listBaseOption.fields);(typeof r[0]=="string"||typeof r[0]=="number")&&!i?(e=g(d)?void 0:{item:d,data:r,text:d.innerText.trim()},i=!0):i||(g(u)||g(d)?(e=void 0,i=!0):(this.selectedId.push(u[this.listBaseOption.fields.id]),e={text:u[this.listBaseOption.fields.text],item:d,data:this.getItemData(d)},i=!0))}return e},t.prototype.findItem=function(e){return this.getItemData(e)},t.prototype.enableItem=function(e){this.setItemState(e,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(e)},t.prototype.disableItem=function(e){this.setItemState(e,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(e)},t.prototype.setItemState=function(e,i){var r=this.getItemData(e),n=In(r,this.listBaseOption.fields);if(r){var s=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');i?(s&&s.classList.remove(ye.disable),delete r[this.fields.enabled]):i||(s&&s.classList.add(ye.disable),r[this.fields.enabled]=!1)}},t.prototype.showItem=function(e){this.showHideItem(e,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(e)},t.prototype.hideItem=function(e){this.showHideItem(e,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(e)},t.prototype.showHideItem=function(e,i,r){var n=this.getItemData(e),s=In(n,this.listBaseOption.fields);if(n){var a=this.element.querySelector('[data-uid="'+s[this.fields.id]+'"]');a&&(a.style.display=r),i?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},t.prototype.addItem=function(e,i,r){i===void 0&&(i=void 0);var n=this.dataSource instanceof oe?this.localData:this.dataSource;this.addItemInternally(e,i,n,r)},t.prototype.addItemInternally=function(e,i,r,n){if(e instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(e,i,r,n);else{var s=this.findItemFromDS(r,i),a=void 0;if(s){var l=In(s,this.listBaseOption.fields);a=l[this.fields.child],a||(a=[]),a=a.concat(e)}if(s instanceof Array){for(var h=0;h<e.length;h++){r=this.addItemAtIndex(n,r,e[parseInt(h.toString(),10)]),this.setViewDataSource(r);var c=this.contentContainer?this.contentContainer.children[0]:null;this.contentContainer&&c?this.addItemIntoDom(e[parseInt(h.toString(),10)],c,this.curViewDS):this.reRender()}this.liCollection=this.curUL.querySelectorAll("."+ye.listItem)}else s&&(s[this.fields.child]=a,this.addItemInNestedList(s,e))}},t.prototype.addItemAtIndex=function(e,i,r){var n=!g(e)&&e>=0&&e<i.length&&g(this.listBaseOption.fields.groupBy);return n?i.splice(e,0,r):i.push(r),i},t.prototype.addItemInNestedList=function(e,i){var r=e[this.fields.id],n=e[this.fields.child],s=this.element.querySelector("[pid='"+r+"']"),a=this.element.querySelector("[data-uid='"+r+"']"),l=s||(a?H(a,"ul"):null),h=s?n:[e],c=a?!a.classList.contains(ye.hasChild):!1;if(c){var u=kt.createListItemFromJson(this.createElement,h,this.listBaseOption,null,null,this);this.setAttributes(u),l.insertBefore(u[0],a),se(a)}if(s&&i)for(var d=0;d<i.length;d++)h.push(i[parseInt(d.toString(),10)]),this.addItemIntoDom(i[parseInt(d.toString(),10)],l,h)},t.prototype.addItemIntoDom=function(e,i,r){var n=r.indexOf(e);this.addListItem(e,n,i,r);var s=r[n-1];s&&s.isHeader&&s.items.length===1&&this.addListItem(s,n-1,i,r)},t.prototype.addListItem=function(e,i,r,n){var s=this.getLiFromObjOrElement(n[i+1])||this.getLiFromObjOrElement(n[i+2])||null,a=kt.createListItemFromJson(this.createElement,[e],this.listBaseOption,null,null,this);if(this.setAttributes(a),this.template&&this.isReact&&this.renderReactTemplates(),this.fields.groupBy&&n[i+1]&&n[i+1].isHeader){var l=this.getLiFromObjOrElement(n[i-1]);l&&(s=l.nextElementSibling)}r.insertBefore(a[0],s)},t.prototype.removeItem=function(e){var i=this.dataSource instanceof oe?this.localData:this.dataSource;this.enableVirtualization?this.virtualizationModule.removeItem(e):this.removeItemFromList(e,i)},t.prototype.removeItemFromList=function(e,i){var r=this,n=this.curViewDS,s=e instanceof Element?this.getElementUID(e):e,a=this.findItemFromDS(i,s,!0);if(a){var l=this.findItemFromDS(a,s),h=n.indexOf(l),c=this.getLiFromObjOrElement(e),u=void 0;this.validateNestedView(c),this.fields.groupBy&&this.curViewDS[h-1]&&n[h-1].isHeader&&n[h-1].items.length===1&&c&&c.previousElementSibling.classList.contains(ye.groupListItem)&&(g(c.nextElementSibling)||c.nextElementSibling&&c.nextElementSibling.classList.contains(ye.groupListItem))&&(u=c.previousElementSibling),c&&se(c),u&&se(u);var d=a.length-1<=0?this.findParent(this.localData,this.fields.id,function(m){return m===l[r.fields.id]},null):null,p=a.indexOf(l);if(a.splice(p,1),this.setViewDataSource(i),d&&d.parent&&Array.isArray(d.parent[this.fields.child])&&d.parent[this.fields.child].length<=0){var f=this.getLiFromObjOrElement(d.parent);if(f){var v=kt.createListItemFromJson(this.createElement,[d.parent],this.listBaseOption,null,null,this);this.setAttributes(v),f.parentElement.insertBefore(v[0],f),f.parentElement.removeChild(f)}}a.length<=0&&this.back(),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+ye.listItem))}},t.prototype.validateNestedView=function(e){var i=e?e.getAttribute("data-uid").toString().toLowerCase():null;if(i&&this.curDSLevel&&this.curDSLevel.length>0)for(;this.curDSLevel.some(function(r){return r.toString().toLowerCase()===i});)this.back()},t.prototype.removeMultipleItems=function(e){if(e.length)for(var i=0;i<e.length;i++)this.removeItem(e[parseInt(i.toString(),10)])},t.prototype.findParent=function(e,i,r,n){if(Object.prototype.hasOwnProperty.call(e,i)&&r(e[i])===!0)return pe({},e);for(var s=0;s<Object.keys(e).length;s++)if(e[Object.keys(e)[parseInt(s.toString(),10)]]&&typeof e[Object.keys(e)[parseInt(s.toString(),10)]]=="object"){var a=this.findParent(e[Object.keys(e)[parseInt(s.toString(),10)]],i,r,e);if(a!=null)return a.parent||(a.parent=n),a}return null},t.prototype.getModuleName=function(){return"listview"},t.prototype.requiredModules=function(){var e=[];return this.enableVirtualization&&e.push({args:[this],member:"virtualization",name:"Virtualization"}),e},t.prototype.onListScroll=function(e){var i={originalEvent:e,scrollDirection:"Bottom",distanceY:this.element.scrollHeight-this.element.scrollTop},r=this.element.scrollTop;r>this.previousScrollTop?(i.scrollDirection="Bottom",i.distanceY=this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop,this.trigger("scroll",i)):this.previousScrollTop>r&&(i.scrollDirection="Top",i.distanceY=this.element.scrollTop,this.trigger("scroll",i)),this.previousScrollTop=r},t.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition","selectedId"])},ai([w("")],t.prototype,"cssClass",void 0),ai([w(!1)],t.prototype,"enableVirtualization",void 0),ai([w({})],t.prototype,"htmlAttributes",void 0),ai([w(!0)],t.prototype,"enable",void 0),ai([w([])],t.prototype,"dataSource",void 0),ai([w()],t.prototype,"query",void 0),ai([Ce(kt.defaultMappedFields,L_)],t.prototype,"fields",void 0),ai([w({effect:"SlideLeft",duration:400,easing:"ease"})],t.prototype,"animation",void 0),ai([w("None")],t.prototype,"sortOrder",void 0),ai([w(!1)],t.prototype,"showIcon",void 0),ai([w(!1)],t.prototype,"showCheckBox",void 0),ai([w("Left")],t.prototype,"checkBoxPosition",void 0),ai([w("")],t.prototype,"headerTitle",void 0),ai([w(!1)],t.prototype,"showHeader",void 0),ai([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),ai([w("")],t.prototype,"height",void 0),ai([w("")],t.prototype,"width",void 0),ai([w(null)],t.prototype,"template",void 0),ai([w(null)],t.prototype,"headerTemplate",void 0),ai([w(null)],t.prototype,"groupTemplate",void 0),ai([G()],t.prototype,"select",void 0),ai([G()],t.prototype,"actionBegin",void 0),ai([G()],t.prototype,"actionComplete",void 0),ai([G()],t.prototype,"actionFailure",void 0),ai([G()],t.prototype,"scroll",void 0),t=ai([It],t),t})(ti);var N_=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Hu=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};function Vu(o,t){for(var e=pe({},o),i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.indexOf(n)<0&&Gp(e,n)}return e}function k_(o,t){var e=t===40?0:o.childElementCount-1,i=e,r,n=o.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var s=0,a=o.children.length;s<a;s++)o.children[s].classList.contains("e-focused")&&(r=o.children[s],i=s,r.classList.remove("e-focused"),t===40?i++:i--,i===(t===40?o.childElementCount:-1)&&(i=e));r=o.children[i],i=gk(o,r,i,t),i!==-1&&(X([o.children[i]],"e-focused"),o.children[i].focus())}function gk(o,t,e,i,r){if(r===void 0&&(r=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(e===(i===40?o.childElementCount-1:0)?e=i===40?0:o.childElementCount-1:i===40?e++:e--),t=o.children[e],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(r++,r===o.childElementCount)return e=-1;e=gk(o,t,e,i,r)}return e}function F_(o,t){var e=[].slice.call(o.getElementsByClassName("e-blank-icon"));if(t){var i=[].slice.call(o.getElementsByClassName("e-item"));i.forEach(function(h){(h.style.paddingLeft||h.style.paddingRight)&&h.removeAttribute("style")})}if(e.length){var r=o.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!g(r)){r.classList.contains("e-url")&&(r=r.querySelector(".e-menu-url"));var n=r.querySelector(".e-menu-icon"),s,a=o.classList.contains("e-rtl");a?s={padding:"paddingRight",margin:"marginLeft"}:s={padding:"paddingLeft",margin:"marginRight"};var l=parseInt(getComputedStyle(n).fontSize,10)+parseInt(getComputedStyle(n)[s.margin],10)+parseInt(getComputedStyle(r).paddingLeft,10)+"px";e.forEach(function(h){h.classList.contains("e-url")&&h.querySelector(".e-menu-url")?h.querySelector(".e-menu-url").style[s.padding]=l:h.style[s.padding]=l})}}}var Rx=(function(o){N_(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Hu([w("")],t.prototype,"iconCss",void 0),Hu([w("")],t.prototype,"id",void 0),Hu([w(!1)],t.prototype,"separator",void 0),Hu([w("")],t.prototype,"text",void 0),Hu([w("")],t.prototype,"url",void 0),Hu([w(!1)],t.prototype,"disabled",void 0),t})(Oe),vk=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Lr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ms={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical",POPUPWIDTH:"e-dropdown-popup-width"},R_=(function(o){vk(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Lr([w("SlideDown")],t.prototype,"effect",void 0),Lr([w(400)],t.prototype,"duration",void 0),Lr([w("ease")],t.prototype,"easing",void 0),t})(Oe),Hr=(function(o){vk(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isPopupCreated=!0,r}return t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){for(var r,n=this.items.length,s=0,a=this.items.length;s<a;s++)if(i===this.items[s].text){n=s;break}for(var l=e.length-1;l>=0;l--)r=new Rx(this,"items",e[l],!0),this.items.splice(n,0,r);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,i){for(var r=!1,n=0,s=e.length;n<s;n++)for(var a=0,l=this.items.length;a<l;a++)if(e[n]===(i?this.items[a].id:this.items[a].text)){this.items.splice(a,1),r=!0;break}r&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,i=this.createElement("div",{className:this.popupWidth!=="auto"?ms.POPUP+" "+ms.POPUPWIDTH:ms.POPUP,id:this.element.id+"-popup"});if(document.body.appendChild(i),this.dropDown=new es(i,{width:this.popupWidth,relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),g(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),Ee(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e.type="button",e)),this.cssClass&&X([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0,this.createPopupOnClick){var r=ot(this.activeElem[0],"split-btn");r&&(r.isPopupCreated=!0)}},t.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!g(this.popupContent)?this.popupContent:typeof this.target=="string"?J(this.target):this.target},t.prototype.createItems=function(e){var i=this,r=this.items,n=this.hasIcon(this.items,"iconCss"),s,a,l,h,c=this.getULElement();if(c?c.innerHTML="":c=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),this.itemTemplate){var u=this.compiletemplate(this.itemTemplate);r.forEach(function(m){var y=i.createElement("li",{className:m.separator?ms.ITEM+" "+ms.SEPARATOR:ms.ITEM,attrs:m.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":m.text},id:m.id?m.id:Lt("e-"+i.getModuleName()+"-item")}),b=u(m,i,"template",null,!1,null,y);b&&bt(b,y),m.disabled&&y.classList.add("e-disabled");var S={item:m,element:y};i.trigger("beforeItemRender",S),S.item.disabled!==m.disabled&&y.classList[S.item.disabled?"add":"remove"]("e-disabled"),c.appendChild(y)}),this.isReact&&this.renderReactTemplates()}else for(var d=0;d<r.length;d++){a=r[d],this.enableHtmlSanitizer&&(a.text=Pt.sanitize(a.text));var p=a.text;l=this.createElement("li",{innerHTML:a.url?"":p,className:a.separator?ms.ITEM+" "+ms.SEPARATOR:ms.ITEM,attrs:a.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":p},id:a.id?a.id:Lt("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?l.textContent=a.url?"":p:l.innerHTML=a.url?"":p,a.url&&(l.appendChild(this.createAnchor(a)),l.classList.add("e-url")),a.iconCss?(s=this.createElement("span",{className:ms.ICON+" "+a.iconCss}),a.url?l.childNodes[0].appendChild(s):l.insertBefore(s,l.childNodes[0])):n&&!a.separator&&l.classList.add("e-blank-icon");var f=a.disabled;a.disabled&&l.classList.add("e-disabled"),h={item:a,element:l},this.trigger("beforeItemRender",h);var v=h.item.disabled;f!==v&&(h.item.disabled?l.classList.add("e-disabled"):l.classList.remove("e-disabled")),c.appendChild(l)}e&&this.getPopUpElement().appendChild(c),n&&F_(this.getPopUpElement())},t.prototype.compiletemplate=function(e){if(this.itemTemplate)try{if(typeof this.itemTemplate!="function"){var i=document.querySelector(this.itemTemplate);if(i)return Et(i.innerHTML.trim())}return Et(e)}catch{return Et(e)}},t.prototype.hasIcon=function(e,i){for(var r=0,n=e.length;r<n;r++)if(e[r][""+i])return!0;return!1},t.prototype.createAnchor=function(e){var i=e.text,r=this.createElement("a",{className:"e-menu-text e-menu-url",attrs:{href:e.url}});return this.enableHtmlSanitizer?r.textContent=i:r.innerHTML=i,r},t.prototype.initialize=function(){this.button=new Jn({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=Lt("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.cssClass=g(this.cssClass)?"":this.cssClass,this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(ms.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var e=this;if(o.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&se(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&Z([this.element],i),Z(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(n){e.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&(Z([e],["e-popup-open","e-popup-close"]),se(e))}T.remove(this.getPopUpElement(),"click",this.clickHandler),T.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1;var i=ot(this.activeElem[0],"split-btn");if(this.createPopupOnClick&&i){var r=ot(this.activeElem[1],"dropdown-btn");r&&(r.isPopupCreated=!1)}},t.prototype.getPopUpElement=function(){var e=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=ot(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||T.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),T.add(this.element,"click",this.clickHandler,this),T.add(this.element,"keydown",this.keyBoardHandler,this),T.add(window,"resize",this.windowResize,this)},t.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},t.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var e=this.getPopUpElement();this.createPopupOnClick&&T.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(T.add(e,"click",this.clickHandler,this),T.add(e,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&T.add(e,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=Wi(e,{selector:"."+ms.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&T.remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(T.remove(e,"click",this.clickHandler),T.remove(e,"keydown",this.keyBoardHandler),this.closeActionEvents&&T.remove(e,this.closeActionEvents,this.focusoutHandler)),Xa&&this.rippleFn&&this.rippleFn()},t.prototype.keyBoardHandler=function(e){if(!(e.target===this.element&&(e.keyCode===9||!e.altKey&&e.keyCode===40||e.keyCode===38)))switch(e.target&&(e.target.classList.contains("e-item")||e.target.parentElement&&e.target.parentElement.classList.contains("e-split-btn-wrapper"))&&e.keyCode===13&&e.preventDefault(),e.keyCode){case 38:case 40:e.altKey&&(e.keyCode===38||e.keyCode===40)?this.keyEventHandler(e):this.upDownKeyHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.prototype.upDownKeyHandler=function(e){this.target&&(e.keyCode===38||e.keyCode===40)||(e.preventDefault(),k_(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){if(!(this.target&&(e.keyCode===13||e.keyCode===9))){if(e.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.triggerSelect(e),this.activeElem[0].focus();return}e.target&&e.target.className.indexOf("e-edit-template")>-1&&e.keyCode===32||(e.keyCode!==9&&e.preventDefault(),e.keyCode===27||e.keyCode===38||e.keyCode===9?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))}},t.prototype.getLI=function(e){return e.tagName==="LI"?e:H(e,"li")},t.prototype.mousedownHandler=function(e){var i=e.target;this.dropDown&&!this.canOpen()&&this.getPopUpElement()&&!(H(i,'[id="'+this.getPopUpElement().id+'"]')||H(i,'[id="'+this.element.id+'"]'))&&this.closePopup(e)},t.prototype.focusoutHandler=function(e){if(this.isPopupCreated&&!this.canOpen()){var i=e.relatedTarget||e.target;if(i&&i.className.indexOf("e-item")>-1){var r=this.getLI(i);if(r){var n=Array.prototype.indexOf.call(this.getULElement().children,r),s=this.items[n];if(s){var a={element:r,item:s,event:e};this.trigger("select",a)}}}this.closePopup(e)}},t.prototype.clickHandler=function(e){var i=e.target;if(H(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if(H(i,'[id="'+this.getPopUpElement().id+'"]')){var r=this.getLI(e.target);r&&(this.triggerSelect(e),this.closePopup(e,this.activeElem[0]))}},t.prototype.triggerSelect=function(e){var i,r,n,s=this.getLI(e.target);s&&(r=Array.prototype.indexOf.call(this.getULElement().children,s),n=this.items[r],n&&(i={element:s,item:n,event:e},this.trigger("select",i)))},t.prototype.openPopUp=function(e){var i=this;e===void 0&&(e=null);var r=this.getPopUpElement();if(this.activeElem[0]&&this.activeElem[0].classList.contains("e-dropdown-btn")&&r.style.width&&r.style.width!=="auto"&&this.setWidth(r),!this.target)this.createItems(!0);else if(this.activeElem.length>1){var n=ot(this.activeElem[0],"split-btn");n.isReact&&r.childNodes.length<1&&(n.appendReactElement&&n.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&r.childNodes.length<1&&(this.appendReactElement&&this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var s=this.getULElement();this.popupWireEvents();var a={element:s,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",a,function(l){if(!l.cancel){var h=i.getULElement(),c=i.animationSettings.effect!=="None"?{name:i.animationSettings.effect,duration:i.animationSettings.duration,timingFunction:i.animationSettings.easing}:null;if(c&&i.animatePopup(c,h),i.dropDown.show(null,i.element),X([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),h&&!i.isSafari()&&h.focus(),i.enableRtl&&h.parentElement.style.left!=="0px"){var u=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?u=i.element.parentElement.offsetWidth:u=i.element.offsetWidth;var d=h.parentElement.offsetWidth-u,p=parseFloat(h.parentElement.style.left)-d;p<0&&(p=0),h.parentElement.style.left=p+"px"}var f={element:h,items:i.items};i.trigger("open",f),h&&i.isSafari()&&h.focus()}})},t.prototype.animatePopup=function(e,i){new Mt(e).animate(i,{begin:function(r){r.element.parentElement.style.height=r.element.parentElement.offsetHeight+"px"}})},t.prototype.setWidth=function(e){var i=Ae(e.style.width);if(i.indexOf("%")>-1){var r=this.element.offsetWidth*parseFloat(i)/100;e.style.width=r+"px"}},t.prototype.closePopup=function(e,i){var r=this;e===void 0&&(e=null);var n=this.getULElement(),s={element:n,items:this.items,event:e,cancel:!1};this.trigger("beforeClose",s,function(a){if(a.cancel)a.element&&n.focus();else{var l=r.getPopUpElement();l&&T.remove(l,"keydown",r.keyBoardHandler),r.popupUnWireEvents();var h=r.getULElement(),c=void 0;h&&(c=h.querySelector(".e-selected")),c&&c.classList.remove("e-selected"),r.dropDown&&r.dropDown.hide(),Z(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&(r.isSafari()?i.focus({preventScroll:!0}):r.isColorPicker()&&e.keyCode===27||i.focus());var u={element:h,items:r.items};r.trigger("close",u),!r.target&&h&&se(h),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup()}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||T.remove(document,"mousedown touchstart",this.delegateMousedownHandler),T.remove(this.element,"click",this.clickHandler),T.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(T.remove(this.getPopUpElement(),"click",this.clickHandler),T.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),T.remove(window,"resize",this.windowResize)},t.prototype.onPropertyChanged=function(e,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(Vu(e,r));var n;this.isPopupCreated&&(n=this.getPopUpElement(),this.dropDown.setProperties(Vu(e,["enableRtl"])));for(var s=0,a=Object.keys(e);s<a.length;s++){var l=a[s];switch(l){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(i.cssClass=g(i.cssClass)?"":i.cssClass,e.cssClass.indexOf(ms.VERTICAL)>-1||i.cssClass.indexOf(ms.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var h=this.element.querySelector("span.e-caret");e.cssClass.indexOf(ms.VERTICAL)>-1?Ai(h,["e-icon-bottom"],["e-icon-right"]):Ai(h,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&Z([n],i.cssClass.split(" ")),e.cssClass&&X([n],e.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},Lr([w("")],t.prototype,"content",void 0),Lr([w("")],t.prototype,"cssClass",void 0),Lr([w(!1)],t.prototype,"disabled",void 0),Lr([w("")],t.prototype,"iconCss",void 0),Lr([w("Left")],t.prototype,"iconPosition",void 0),Lr([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Lr([Gt([],Rx)],t.prototype,"items",void 0),Lr([w(!1)],t.prototype,"createPopupOnClick",void 0),Lr([w("")],t.prototype,"target",void 0),Lr([w("")],t.prototype,"closeActionEvents",void 0),Lr([w(null)],t.prototype,"itemTemplate",void 0),Lr([w("auto")],t.prototype,"popupWidth",void 0),Lr([Ce({effect:"None"},R_)],t.prototype,"animationSettings",void 0),Lr([G()],t.prototype,"beforeItemRender",void 0),Lr([G()],t.prototype,"beforeOpen",void 0),Lr([G()],t.prototype,"beforeClose",void 0),Lr([G()],t.prototype,"close",void 0),Lr([G()],t.prototype,"open",void 0),Lr([G()],t.prototype,"select",void 0),Lr([G()],t.prototype,"created",void 0),t=Lr([It],t),t})(ti),O_=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Pn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},zm="e-rtl",Fx="EJS-SPLITBUTTON",uf=(function(o){O_(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;if(e.tagName===Fx){for(var i=V("ej2_instances",e),r=this.createElement("button",{attrs:{type:"button"}}),n=this.createElement(Fx,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,a=e.attributes.length;s<a;s++)r.setAttribute(e.attributes[s].nodeName,e.attributes[s].nodeValue);e.parentNode.insertBefore(n,e),se(e),e=r,n.appendChild(e),it("ej2_instances",i,e),this.wrapper=n,this.element=e}this.element.id||(this.element.id=Lt("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){o.prototype.addItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(e,i){o.prototype.removeItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(zm),this.cssClass&&X([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},t.prototype.createPrimaryButton=function(){var e={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new Jn(e),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var e=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var r={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};r.beforeItemRender=function(n){e.createPopupOnClick&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown),e.trigger("beforeItemRender",n)},r.open=function(n){e.trigger("open",n)},r.close=function(n){e.trigger("close",n)},r.select=function(n){e.trigger("select",n)},r.beforeOpen=function(n){e.createPopupOnClick&&e.items.length===0&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown);var s=new cf;return e.trigger("beforeOpen",n,function(a){s.resolve(a)}),s},r.beforeClose=function(n){var s=new cf;return e.trigger("beforeClose",n,function(a){s.resolve(a)}),s},this.secondaryBtnObj=new Hr(r),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.isPopupCreated=this.secondaryBtnObj.isPopupCreated,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right"),this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},t.prototype.setAria=function(){Ee(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var e=this,i=[zm];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var r=document.getElementById(this.element.id);r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===Fx?(this.wrapper.innerHTML="",Z([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),Z([this.wrapper],this.cssClass.split(" "))):(Z([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){e.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),Qe(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),o.prototype.destroy.call(this),this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class"),this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(n){e.element.classList.add(n)}),it("ej2_instances",[this],this.element)),this.wrapper=null},t.prototype.wireEvents=function(){T.add(this.element,"click",this.primaryBtnClickHandler,this),new rr(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},t.prototype.unWireEvents=function(){T.remove(this.element,"click",this.primaryBtnClickHandler),Cr(this.element,rr).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(e){switch(e.action){case"altdownarrow":this.clickHandler(e);break;case"enter":this.clickHandler(e),this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active");break}},t.prototype.onPropertyChanged=function(e,i){var r=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(Vu(e,r)),r=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(e).indexOf("items")>-1&&(this.secondaryBtnObj.items=e.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(Vu(e,r));for(var n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"cssClass":i.cssClass&&Z([this.wrapper],i.cssClass.split(" ")),X([this.wrapper],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?X([this.wrapper],zm):Z([this.wrapper],zm);break;case"disabled":e.disabled?X([this.wrapper],"e-splitbtn-disabled"):Z([this.wrapper],"e-splitbtn-disabled")}}},t.prototype.focusIn=function(){this.element.focus()},Pn([w("")],t.prototype,"content",void 0),Pn([w("")],t.prototype,"cssClass",void 0),Pn([w(!1)],t.prototype,"disabled",void 0),Pn([w("")],t.prototype,"iconCss",void 0),Pn([w("Left")],t.prototype,"iconPosition",void 0),Pn([w(!1)],t.prototype,"createPopupOnClick",void 0),Pn([Gt([],Rx)],t.prototype,"items",void 0),Pn([w("")],t.prototype,"target",void 0),Pn([G()],t.prototype,"beforeItemRender",void 0),Pn([G()],t.prototype,"beforeOpen",void 0),Pn([G()],t.prototype,"beforeClose",void 0),Pn([G()],t.prototype,"click",void 0),Pn([G()],t.prototype,"close",void 0),Pn([G()],t.prototype,"open",void 0),Pn([G()],t.prototype,"select",void 0),Pn([G()],t.prototype,"created",void 0),t=Pn([It],t),t})(Hr),cf=(function(){function o(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return o})();var rt={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",FLOATTEXTCONTENT:"e-float-text-content",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},Ux=["title","style","class"],mk="e-input-focus",Ie;(function(o){var t,e=!0;function i(_,re){_.element.__eventHandlers={};var Se=g(re)?et:re,Be={container:null,buttons:[],clearButton:null};if(t=_.floatLabelType,e=_.bindClearAction,g(_.floatLabelType)||_.floatLabelType==="Never"?(Be.container=B(_,rt.INPUTGROUP,rt.INPUTCUSTOMTAG,"span",Se),_.element.parentNode.insertBefore(Be.container,_.element),X([_.element],rt.INPUT),Be.container.appendChild(_.element)):m(_,Be,Se),a(_),!g(_.properties)&&!g(_.properties.showClearButton)&&_.properties.showClearButton&&(ue(_.properties.showClearButton,_.element,Be,!0,Se),Be.clearButton.setAttribute("role","button"),Be.container.classList.contains(rt.FLOATINPUT)&&X([Be.container],rt.INPUTGROUP)),!g(_.buttons))for(var _e=0;_e<_.buttons.length;_e++)Be.buttons.push(vt(_.buttons[_e],Be.container,Se));return!g(_.element)&&_.element.tagName==="TEXTAREA"&&X([Be.container],rt.TEXTAREA),bi(Be.container,_.element),Be=S(_,Be),He(Be.container,Se),Be}o.createInput=i;function r(_){var re=I(_.element);(re.classList.contains("e-input-group")||re.classList.contains("e-outline")||re.classList.contains("e-filled"))&&re.classList.add("e-input-focus"),_.floatLabelType!=="Never"&&setTimeout(function(){o.calculateWidth(_.element,re)},80)}function n(_){var re=I(_.element);(re.classList.contains("e-input-group")||re.classList.contains("e-outline")||re.classList.contains("e-filled"))&&re.classList.remove("e-input-focus"),_.floatLabelType!=="Never"&&setTimeout(function(){o.calculateWidth(_.element,re)},80)}function s(_){h(_.floatLabelType,_.element)}function a(_){h(_.floatLabelType,_.element);var re=function(){return r(_)},Se=function(){return n(_)},Be=function(){return s(_)};_.element.addEventListener("focus",re),_.element.addEventListener("blur",Se),_.element.addEventListener("input",Be),_.element.__eventHandlers.inputFocusHandler={focusHandler:re},_.element.__eventHandlers.inputBlurHandler={blurHandler:Se},_.element.__eventHandlers.inputHandler={inputHandler:Be}}o.bindInitialEvent=a;function l(_){if(!g(_.element)&&!g(_.element.__eventHandlers)&&!g(_.element.__eventHandlers.inputFocusHandler)&&!g(_.element.__eventHandlers.inputBlurHandler)&&!g(_.element.__eventHandlers.inputHandler)){var re=_.element.__eventHandlers.inputFocusHandler.focusHandler,Se=_.element.__eventHandlers.inputBlurHandler.blurHandler,Be=_.element.__eventHandlers.inputHandler.inputHandler;_.element.removeEventListener("focus",re),_.element.removeEventListener("blur",Se),_.element.removeEventListener("input",Be),delete _.element.__eventHandlers.inputFocusHandler,delete _.element.__eventHandlers.inputBlurHandler,delete _.element.__eventHandlers.inputHandler}}function h(_,re){var Se=re.value,Be=re.parentElement,_e=Be&&Be.parentElement;Se!==""&&!g(Se)?Be&&Be.classList.contains("e-input-group")?Be.classList.add("e-valid-input"):_e&&_e.classList.contains("e-input-group")&&_e.classList.add("e-valid-input"):_!=="Always"&&(Be&&Be.classList.contains("e-input-group")?Be.classList.remove("e-valid-input"):_e&&_e.classList.contains("e-input-group")&&_e.classList.remove("e-valid-input"))}function c(){var _=I(this).getElementsByClassName("e-float-text")[0];g(_)||(X([_],rt.LABELTOP),_.classList.contains(rt.LABELBOTTOM)&&Z([_],rt.LABELBOTTOM))}function u(){var _=I(this);if(_.getElementsByTagName("textarea")[0]?_.getElementsByTagName("textarea")[0].value==="":_.getElementsByTagName("input")[0].value===""){var re=_.getElementsByClassName("e-float-text")[0];g(re)||(re.classList.contains(rt.LABELTOP)&&Z([re],rt.LABELTOP),X([re],rt.LABELBOTTOM))}}function d(_){_.addEventListener("focus",c),_.addEventListener("blur",u)}o.wireFloatingEvents=d;function p(_){g(_)||(_.removeEventListener("focus",c),_.removeEventListener("blur",u))}function f(_){k(_.element,_.floatLabelType)}function v(_){k(_.element,_.floatLabelType)}function m(_,re,Se){var Be=g(Se)?et:Se;_.floatLabelType==="Auto"&&d(_.element),g(re.container)?(re.container=B(_,rt.FLOATINPUT,rt.FLOATCUSTOMTAG,"div",Be),re.container.classList.add(rt.INPUTGROUP),_.element.parentNode&&_.element.parentNode.insertBefore(re.container,_.element)):(g(_.customTag)||re.container.classList.add(rt.FLOATCUSTOMTAG),re.container.classList.add(rt.FLOATINPUT));var _e=Be("span",{className:rt.FLOATLINE}),We=Be("label",{className:rt.FLOATTEXT});if(!g(_.element.id)&&_.element.id!==""&&(We.id="label_"+_.element.id.replace(/ /g,"_"),Ee(_.element,{"aria-labelledby":We.id})),!g(_.element.placeholder)&&_.element.placeholder!==""&&(We.innerText=F(_.element.placeholder),_.element.removeAttribute("placeholder")),!g(_.properties)&&!g(_.properties.placeholder)&&_.properties.placeholder!==""&&(We.innerText=F(_.properties.placeholder)),We.innerText||re.container.classList.add(rt.NOFLOATLABEL),re.container.classList.contains("e-float-icon-left")){var Dt=re.container.querySelector(".e-input-in-wrap");Dt.appendChild(_.element),Dt.appendChild(_e),Dt.appendChild(We)}else re.container.appendChild(_.element),re.container.appendChild(_e),re.container.appendChild(We);if(x(_.element.value,We),_.floatLabelType==="Always"&&(We.classList.contains(rt.LABELBOTTOM)&&Z([We],rt.LABELBOTTOM),X([We],rt.LABELTOP)),_.floatLabelType==="Auto"){var _i=function(){return f(_)},qt=function(){return v(_)};_.element.addEventListener("input",_i),_.element.addEventListener("blur",qt),_.element.__eventHandlers.floatInputHandler={inputFloatHandler:_i},_.element.__eventHandlers.floatBlurHandler={blurFloatHandler:qt}}else y(_);g(_.element.getAttribute("id"))||We.setAttribute("for",_.element.getAttribute("id"))}function y(_){if(!g(_.element)&&!g(_.element.__eventHandlers)&&!g(_.element.__eventHandlers.floatInputHandler)&&!g(_.element.__eventHandlers.floatBlurHandler)){var re=_.element.__eventHandlers.floatInputHandler.inputFloatHandler,Se=_.element.__eventHandlers.floatBlurHandler.blurFloatHandler;_.element.removeEventListener("input",re),_.element.removeEventListener("blur",Se),delete _.element.__eventHandlers.floatInputHandler,delete _.element.__eventHandlers.floatBlurHandler}}function b(_,re){_==="Always"&&re.classList.contains("e-outline")&&re.classList.add("e-valid-input")}function S(_,re){if(!g(_.properties))for(var Se=0,Be=Object.keys(_.properties);Se<Be.length;Se++){var _e=Be[Se];switch(_e){case"cssClass":Y(_.properties.cssClass,[re.container]),b(_.floatLabelType,re.container);break;case"enabled":he(_.properties.enabled,_.element,_.floatLabelType,re.container);break;case"enableRtl":te(_.properties.enableRtl,[re.container]);break;case"placeholder":q(_.properties.placeholder,_.element);break;case"readonly":ae(_.properties.readonly,_.element);break}}return re}function C(_,re,Se){g(re)||(_&&!Se?Z([re],rt.CLEARICONHIDE):X([re],rt.CLEARICONHIDE))}function x(_,re,Se){if(Se===void 0&&(Se=null),_)X([re],rt.LABELTOP),re.classList.contains(rt.LABELBOTTOM)&&Z([re],rt.LABELBOTTOM);else{var Be=Se!=null?Se!==document.activeElement:!0;Be&&(re.classList.contains(rt.LABELTOP)&&Z([re],rt.LABELTOP),X([re],rt.LABELBOTTOM))}}function I(_){var re=g(_.parentNode)?_:_.parentNode;return re&&re.classList.contains("e-input-in-wrap")&&(re=re.parentNode),re}function D(_,re,Se,Be){var _e=g(Be)?et:Be,We=_e("span",{className:rt.CLEARICON}),Dt=re.container;if(!g(Se))Dt.appendChild(We);else{var _i=re.container.classList.contains(rt.FLOATINPUT)?re.container.querySelector("."+rt.FLOATTEXT):_;_i.insertAdjacentElement("afterend",We)}return X([We],rt.CLEARICONHIDE),N(_,We),We.setAttribute("aria-label","close"),We}function M(_,re,Se){re.classList.contains(rt.DISABLE)||re.readOnly||(_.preventDefault(),re!==document.activeElement&&re.focus(),re.value="",X([Se],rt.CLEARICONHIDE))}function E(_,re){C(_.value,re)}function A(_,re){C(_.value,re,_.readOnly)}function L(_,re){setTimeout(function(){g(re)||(X([re],rt.CLEARICONHIDE),re=!g(_)&&_.classList.contains("e-combobox")?null:re)},200)}function N(_,re,Se){if(e===void 0||e){var Be=function(_i){return M(_i,_,re)};re.addEventListener("click",Be),_.__eventHandlers.clearClickHandler={clickHandlerEvent:Be}}var _e=function(){return E(_,re)},We=function(){return A(_,re)},Dt=function(){return L(_,re)};_.addEventListener("input",_e),_.addEventListener("focus",We),_.addEventListener("blur",Dt),_.__eventHandlers.clearInputHandler={inputHandlerEvent:_e},_.__eventHandlers.clearFocusHandler={focusHandlerEvent:We},_.__eventHandlers.clearBlurHandler={blurHandlerEvent:Dt}}o.wireClearBtnEvents=N;function R(_,re){if(!g(_)&&!g(_.__eventHandlers)){if(!g(_.__eventHandlers.clearClickHandler)){var Se=_.__eventHandlers.clearClickHandler.clickHandlerEvent;(e===void 0||e)&&(g(re)||re.removeEventListener("click",Se)),delete _.__eventHandlers.clearClickHandler}if(!g(_.__eventHandlers.clearInputHandler)&&!g(_.__eventHandlers.clearFocusHandler)&&!g(_.__eventHandlers.clearBlurHandler)){var Be=_.__eventHandlers.clearInputHandler.inputHandlerEvent,_e=_.__eventHandlers.clearFocusHandler.focusHandlerEvent,We=_.__eventHandlers.clearBlurHandler.blurHandlerEvent;_.removeEventListener("input",Be),_.removeEventListener("focus",_e),_.removeEventListener("blur",We),delete _.__eventHandlers.clearInputHandler,delete _.__eventHandlers.clearFocusHandler,delete _.__eventHandlers.clearBlurHandler}}}function P(_,re){re===void 0&&(re=null),l(_),_.floatLabelType==="Auto"&&y(_),_.properties.showClearButton&&R(_.element,re),g(_.buttons)||we(!1,null,_.buttons),p(_.element),g(_.element)||(delete _.element.__eventHandlers,_.element.classList.contains(rt.INPUT)&&_.element.classList.remove(rt.INPUT))}o.destroy=P;function k(_,re){var Se=I(_);if(Se.classList.contains(rt.FLOATINPUT)&&re==="Auto"){var Be=I(_).getElementsByClassName("e-float-text")[0];x(_.value,Be,_)}}function B(_,re,Se,Be,_e){var We=g(_e)?et:_e,Dt;return g(_.customTag)?Dt=We(Be,{className:re}):(Dt=We(_.customTag,{className:re}),Dt.classList.add(Se)),Dt.classList.add("e-control-wrapper"),Dt}function F(_){if(_==null||_==="")return"";var re=O(_);return re}function O(_){var re={"&amp;":"&","&quot;":'"',"&#39;":"'","&lt;":"<","&gt;":">","&eacute;":"\xE9"};return _.replace(/&[a-zA-Z#0-9]+;/g,function(Se){return re[Se]||Se})}function z(_,re,Se,Be){if(re.value=_,Se!=="Never"&&K(re,re.parentElement),!g(Se)&&Se==="Auto"&&k(re,Se),!g(Be)&&Be){var _e=I(re);if(!g(_e)){var We=_e.getElementsByClassName(rt.CLEARICON)[0];g(We)||(re.value&&!g(_e)&&_e.classList.contains("e-input-focus")?Z([We],rt.CLEARICONHIDE):X([We],rt.CLEARICONHIDE))}}h(Se,re)}o.setValue=z;function Y(_,re,Se){!g(Se)&&Se!==""&&Z(re,Se.split(" ")),!g(_)&&_!==""&&X(re,_.split(" "))}o.setCssClass=Y;function K(_,re,Se){if(!(Se!=="multiselect"&&!Ne(_))){var Be=Se==="multiselect"?_:_.clientWidth-parseInt(getComputedStyle(_,null).getPropertyValue("padding-left"),10);!g(re)&&!g(re.getElementsByClassName("e-float-text-content")[0])&&(re.getElementsByClassName("e-float-text-content")[0].classList.contains("e-float-text-overflow")&&re.getElementsByClassName("e-float-text-content")[0].classList.remove("e-float-text-overflow"),(Be<re.getElementsByClassName("e-float-text-content")[0].clientWidth||Be===re.getElementsByClassName("e-float-text-content")[0].clientWidth)&&re.getElementsByClassName("e-float-text-content")[0].classList.add("e-float-text-overflow"))}}o.calculateWidth=K;function U(_,re){typeof _=="number"?re.style.width=Ae(_):typeof _=="string"&&(re.style.width=_.match(/px|%|em/)?_:Ae(_)),K(re.firstChild,re)}o.setWidth=U;function q(_,re){_=F(_);var Se=I(re);if(Se.classList.contains(rt.FLOATINPUT))if(!g(_)&&_!==""){var Be=Se.getElementsByClassName("e-float-text-content")[0];if(Be&&Be.children[0])Be.children[0].textContent=_;else{var _e=Se.getElementsByClassName(rt.FLOATTEXT)[0];g(_e)||(_e.textContent=_)}Se.classList.remove(rt.NOFLOATLABEL),re.removeAttribute("placeholder")}else{Se.classList.add(rt.NOFLOATLABEL);var Be=Se.getElementsByClassName("e-float-text-content")[0];if(Be&&Be.children[0])Be.children[0].textContent="";else{var _e=Se.getElementsByClassName(rt.FLOATTEXT)[0];g(_e)||(_e.textContent="")}}else!g(_)&&_!==""?Ee(re,{placeholder:_}):re.removeAttribute("placeholder")}o.setPlaceholder=q;function ae(_,re,Se){_?Ee(re,{readonly:""}):re.removeAttribute("readonly"),g(Se)||k(re,Se)}o.setReadonly=ae;function te(_,re){_?X(re,rt.RTL):Z(re,rt.RTL)}o.setEnableRtl=te;function he(_,re,Se,Be){var _e={disabled:"","aria-disabled":"true"},We=!g(Be);_?(re.classList.remove(rt.DISABLE),ne(_e,re),We&&Z([Be],rt.DISABLE)):(re.classList.add(rt.DISABLE),le(_e,re),We&&X([Be],rt.DISABLE)),g(Se)||k(re,Se)}o.setEnabled=he;function ue(_,re,Se,Be,_e){var We=g(_e)?et:_e;_?Se.clearButton=D(re,Se,Be,We):(Qe(Se.clearButton),Se.clearButton=null)}o.setClearButton=ue;function ne(_,re){for(var Se=0,Be=Object.keys(_);Se<Be.length;Se++){var _e=Be[Se],We=I(re);_e==="disabled"&&re.classList.remove(rt.DISABLE),_e==="disabled"&&We.classList.contains(rt.INPUTGROUP)&&We.classList.remove(rt.DISABLE),_e==="placeholder"&&We.classList.contains(rt.FLOATINPUT)?We.getElementsByClassName(rt.FLOATTEXT)[0].textContent="":re.removeAttribute(_e)}}o.removeAttributes=ne;function le(_,re){for(var Se=0,Be=Object.keys(_);Se<Be.length;Se++){var _e=Be[Se],We=I(re);_e==="disabled"&&re.classList.add(rt.DISABLE),_e==="disabled"&&We.classList.contains(rt.INPUTGROUP)&&We.classList.add(rt.DISABLE),_e==="placeholder"&&We.classList.contains(rt.FLOATINPUT)?We.getElementsByClassName(rt.FLOATTEXT)[0].textContent=_[""+_e]:re.setAttribute(_e,_[""+_e])}}o.addAttributes=le;function $(_){var re=_.container;if(!g(re)&&re.classList.contains(rt.FLOATINPUT)){var Se=re.querySelector("textarea")?re.querySelector("textarea"):re.querySelector("input"),Be=re.querySelector("."+rt.FLOATTEXT).textContent,_e=re.querySelector(".e-clear-icon")!==null;se(re.querySelector("."+rt.FLOATLINE)),se(re.querySelector("."+rt.FLOATTEXT)),Ai(re,[rt.INPUTGROUP],[rt.FLOATINPUT]),p(Se),Ee(Se,{placeholder:Be}),Se.classList.add(rt.INPUT),!_e&&Se.tagName==="INPUT"&&Se.removeAttribute("required")}}o.removeFloating=$;function ee(_,re,Se,Be){var _e=g(Be)?et:Be,We=H(_,"."+rt.INPUTGROUP);t=re;var Dt=We.tagName;Dt=Dt!=="DIV"&&Dt!=="SPAN"?Dt:null;var _i={element:_,floatLabelType:re,customTag:Dt,properties:{placeholder:Se}};if(re!=="Never"){var qt=We.querySelector(".e-clear-icon"),Kn={container:We};_.classList.remove(rt.INPUT),m(_i,Kn,_e),He(Kn.container,_e),K(_i.element,Kn.container);var br=We.classList.contains("e-float-icon-left");if(g(qt))if(br){var ql=We.querySelector(".e-input-in-wrap");qt=ql.querySelector(".e-input-group-icon")}else qt=We.querySelector(".e-input-group-icon");if(g(qt))br&&(qt=We.querySelector(".e-input-group-icon"));else{var Zo=We.querySelector("."+rt.FLOATLINE),Ba=We.querySelector("."+rt.FLOATTEXT),ja=br?We.querySelector(".e-input-in-wrap"):We;ja.insertBefore(_,qt),ja.insertBefore(Zo,qt),ja.insertBefore(Ba,qt)}}else y(_i);b(re,_.parentElement)}o.addFloating=ee;function He(_,re){if(_.classList.contains("e-outline")&&_.getElementsByClassName("e-float-text")[0]){var Se=re("span",{className:rt.FLOATTEXTCONTENT});Se.innerHTML=_.getElementsByClassName("e-float-text")[0].innerHTML,_.getElementsByClassName("e-float-text")[0].innerHTML="",_.getElementsByClassName("e-float-text")[0].appendChild(Se)}}o.createSpanElement=He;function qe(_,re){for(var Se=0;Se<re.length;Se++)we(_,re[parseInt(Se.toString(),10)].container)}o.setRipple=qe;function we(_,re,Se){var Be=[];Be.push(Se);var _e=g(Se)?re.querySelectorAll(".e-input-group-icon"):Be;if(_&&_e.length>0)for(var We=0;We<_e.length;We++)_e[parseInt(We.toString(),10)].addEventListener("mousedown",Ye,!1),_e[parseInt(We.toString(),10)].addEventListener("mouseup",dt,!1);else if(_e.length>0)for(var We=0;We<_e.length;We++)_e[parseInt(We.toString(),10)].removeEventListener("mousedown",Ye,this),_e[parseInt(We.toString(),10)].removeEventListener("mouseup",dt,this)}function je(_,re){!_.classList.contains("e-disabled")&&!_.querySelector("input").readOnly&&re.classList.add("e-input-btn-ripple")}function Ne(_){if(!_)return!1;for(var re=_;re&&re!==document.body;){var Se=window.getComputedStyle(re);if(Se.display==="none")return!1;re=re.parentElement}return!0}function Ye(){for(var _=this,re=this.parentElement;!re.classList.contains("e-input-group");)re=re.parentElement;je(re,_)}function dt(){var _=this;setTimeout(function(){_.classList.remove("e-input-btn-ripple")},500)}function Ke(_,re){var Se=re("span",{className:_});return Se.classList.add("e-input-group-icon"),Se}function ci(_,re,Se,Be,_e){var We=typeof re=="string"?re.split(","):re;if(_.toLowerCase()==="append")for(var Dt=0,_i=We;Dt<_i.length;Dt++){var qt=_i[Dt];vt(qt,Se,_e)}else for(var Kn=0,br=We;Kn<br.length;Kn++){var qt=br[Kn];Jt(qt,Se,Be,_e)}Se.getElementsByClassName("e-input-group-icon")[0]&&Se.getElementsByClassName("e-float-text-overflow")[0]&&Se.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon")}o.addIcon=ci;function Jt(_,re,Se,Be){var _e=g(Be)?et:Be,We=Ke(_,_e);re.classList.add("e-float-icon-left");var Dt=re.querySelector(".e-input-in-wrap");if(g(Dt)){Dt=_e("span",{className:"e-input-in-wrap"}),Se.parentNode.insertBefore(Dt,Se);var _i=re.querySelectorAll(Se.tagName+" ~ *");Dt.appendChild(Se);for(var qt=0;qt<_i.length;qt++){var Kn=_i[parseInt(qt.toString(),10)],br=Dt.parentElement;(!Kn.classList.contains("e-float-line")||!(br&&br.classList.contains("e-filled"))&&br)&&Dt.appendChild(Kn)}}return Dt.parentNode.insertBefore(We,Dt),we(!0,re,We),We}o.prependSpan=Jt;function vt(_,re,Se){var Be=g(Se)?et:Se,_e=Ke(_,Be),We=re.classList.contains("e-float-icon-left")?re.querySelector(".e-input-in-wrap"):re;return We.appendChild(_e),we(!0,re,_e),_e}o.appendSpan=vt;function bi(_,re){re.type==="hidden"?_.classList.add("e-hidden"):_.classList.contains("e-hidden")&&_.classList.remove("e-hidden")}o.validateInputType=bi;function Bi(_,re){if(!g(_))for(var Se=0,Be=Object.keys(_);Se<Be.length;Se++){var _e=Be[Se];Ux.indexOf(_e)<0&&re.setAttribute(_e,_[""+_e])}}o.updateHTMLAttributesToElement=Bi;function Dr(_,re,Se){Y(vr(_),[Se],vr(re))}o.updateCssClass=Dr;function vr(_){var re=_;return!g(_)&&_!==""&&(re=_.replace(/\s+/g," ").trim()),re}o.getInputValidClassList=vr;function Fi(_,re){if(!g(_))for(var Se=0,Be=Object.keys(_);Se<Be.length;Se++){var _e=Be[Se];if(Ux.indexOf(_e)>-1)if(_e==="class"){var We=this.getInputValidClassList(_[""+_e]);We!==""&&X([re],We.split(" "))}else if(_e==="style"){var Dt=re.getAttribute(_e);Dt=g(Dt)?_[""+_e]:Dt+_[""+_e],re.setAttribute(_e,Dt)}else re.setAttribute(_e,_[""+_e])}}o.updateHTMLAttributesToWrapper=Fi;function tr(_){return!_||/^\s*$/.test(_)}o.isBlank=tr})(Ie||(Ie={}));var z_=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),mr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},P_="e-control-wrapper e-numeric",Ox="e-input-group-icon",zx="e-spin-up",B_="e-spin-down",yk="e-error",_u="increment",df="decrement",j_=new RegExp("^(-)?(\\d*)$"),H_=".",V_="e-numerictextbox",__="e-control",bk="e-input-focus",U_="e-numeric-hidden",Sk=["title","style","class"],Ck=0,ba=(function(o){z_(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.preventChange=!1,r.isDynamicChange=!1,r.numericOptions=e,r}return t.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var e=V("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),Z([this.cloneElement],[__,V_,"e-lib"]),this.angularTagName=null,this.formEle=H(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(a){return a.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,it("ej2_instances",e,this.element)}Ee(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off"});var s={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new Ri("numerictextbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",Lt("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},t.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","numerictextbox"),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),this.updateFloatLabelOverflowWidth(),this.renderComplete())},t.prototype.checkAttributes=function(e){for(var i=e?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,n=i;r<n.length;r++){var s=n[r];if(!g(this.element.getAttribute(s)))switch(s){case"disabled":if(g(this.numericOptions)||this.numericOptions.enabled===void 0||e){var a=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:a},!e)}break;case"readonly":if(g(this.numericOptions)||this.numericOptions.readonly===void 0||e){var l=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(g(this.numericOptions)||this.numericOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"value":if(g(this.numericOptions)||this.numericOptions.value===void 0||e){var h=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));this.setProperties(it(s,h,{}),!e)}break;case"min":if(g(this.numericOptions)||this.numericOptions.min===void 0||e){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));c!==null&&!isNaN(c)&&this.setProperties(it(s,c,{}),!e)}break;case"max":if(g(this.numericOptions)||this.numericOptions.max===void 0||e){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));u!==null&&!isNaN(u)&&this.setProperties(it(s,u,{}),!e)}break;case"step":if(g(this.numericOptions)||this.numericOptions.step===void 0||e){var d=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));d!==null&&!isNaN(d)&&this.setProperties(it(s,d,{}),!e)}break;case"style":this.inputStyle=this.element.getAttribute(s);break;case"name":this.inputName=this.element.getAttribute(s);break;default:{var p=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));(p!==null&&!isNaN(p)||s==="value")&&this.setProperties(it(s,p,{}),!0)}break}}},t.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},t.prototype.initCultureFunc=function(){this.instance=new Nt(this.locale)},t.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,V("currency",this)!==null&&(it("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},t.prototype.createWrapper=function(){var e=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(e=this.getNumericValidClassList(this.cssClass));var i=Ie.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",P_+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&Ee(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text","data-validateHidden":"true","aria-label":"hidden",class:U_}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),this.isAngular&&this.angularTagName==="EJS-NUMERICTEXTBOX"&&this.cloneElement.id.length>0?Ee(this.hiddenInput,{name:this.cloneElement.id}):Ee(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&Ee(this.container,{style:this.inputStyle})},t.prototype.updateDataAttribute=function(e){var i={};if(e)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];a.indexOf("data")===0&&this.hiddenInput.setAttribute(a,i[""+a])}},t.prototype.updateHTMLAttrToElement=function(){if(!g(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];Sk.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateCssClass=function(e,i){Ie.setCssClass(this.getNumericValidClassList(e),[this.container],this.getNumericValidClassList(i))},t.prototype.getNumericValidClassList=function(e){var i=e;return!g(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.updateHTMLAttrToWrapper=function(){if(!g(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(Sk.indexOf(r)>-1)if(r==="class"){var n=this.getNumericValidClassList(this.htmlAttributes[""+r]);n!==""&&X([this.container],n.split(" "))}else if(r==="style"){var s=this.container.getAttribute(r);s=g(s)?this.htmlAttributes[""+r]:s+this.htmlAttributes[""+r],this.container.setAttribute(r,s)}else this.container.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.setElementWidth=function(e){g(e)||(typeof e=="number"?this.container.style.width=Ae(e):typeof e=="string"&&(this.container.style.width=e.match(/px|%|em/)?e:Ae(e)))},t.prototype.spinBtnCreation=function(){this.spinDown=Ie.appendSpan(Ox+" "+B_,this.container,this.createElement),Ee(this.spinDown,{title:this.l10n.getConstant("decrementTitle")}),this.spinUp=Ie.appendSpan(Ox+" "+zx,this.container,this.createElement),Ee(this.spinUp,{title:this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},t.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),this.min!==-Number.MAX_VALUE&&Ee(this.element,{"aria-valuemin":this.min.toString()}),this.max!==Number.MAX_VALUE&&Ee(this.element,{"aria-valuemax":this.max.toString()})},t.prototype.formattedValue=function(e,i){return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(i)},t.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},t.prototype.action=function(e,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,e)),this.raiseChangeEvent(i)},t.prototype.checkErrorClass=function(){this.isValidState?Z([this.container],yk):X([this.container],yk),Ee(this.element,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.bindClearEvent=function(){this.showClearButton&&T.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){e.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(e),this.isInteract=!0,this.raiseChangeEvent(e)},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=H(this.element,"form");if(i){var r=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},t.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},t.prototype.setSpinButton=function(){g(this.spinDown)||Ee(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),g(this.spinUp)||Ee(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},t.prototype.wireEvents=function(){T.add(this.element,"focus",this.focusHandler,this),T.add(this.element,"blur",this.focusOutHandler,this),T.add(this.element,"keydown",this.keyDownHandler,this),T.add(this.element,"keyup",this.keyUpHandler,this),T.add(this.element,"input",this.inputHandler,this),T.add(this.element,"keypress",this.keyPressHandler,this),T.add(this.element,"change",this.changeHandler,this),T.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&T.add(this.formEle,"reset",this.resetFormHandler,this))},t.prototype.wireSpinBtnEvents=function(){T.add(this.spinUp,j.touchStartEvent,this.mouseDownOnSpinner,this),T.add(this.spinDown,j.touchStartEvent,this.mouseDownOnSpinner,this),T.add(this.spinUp,j.touchEndEvent,this.mouseUpOnSpinner,this),T.add(this.spinDown,j.touchEndEvent,this.mouseUpOnSpinner,this),T.add(this.spinUp,j.touchMoveEvent,this.touchMoveOnSpinner,this),T.add(this.spinDown,j.touchMoveEvent,this.touchMoveOnSpinner,this)},t.prototype.unwireEvents=function(){T.remove(this.element,"focus",this.focusHandler),T.remove(this.element,"blur",this.focusOutHandler),T.remove(this.element,"keyup",this.keyUpHandler),T.remove(this.element,"input",this.inputHandler),T.remove(this.element,"keydown",this.keyDownHandler),T.remove(this.element,"keypress",this.keyPressHandler),T.remove(this.element,"change",this.changeHandler),T.remove(this.element,"paste",this.pasteHandler),this.formEle&&T.remove(this.formEle,"reset",this.resetFormHandler)},t.prototype.unwireSpinBtnEvents=function(){T.remove(this.spinUp,j.touchStartEvent,this.mouseDownOnSpinner),T.remove(this.spinDown,j.touchStartEvent,this.mouseDownOnSpinner),T.remove(this.spinUp,j.touchEndEvent,this.mouseUpOnSpinner),T.remove(this.spinDown,j.touchEndEvent,this.mouseUpOnSpinner),T.remove(this.spinUp,j.touchMoveEvent,this.touchMoveOnSpinner),T.remove(this.spinDown,j.touchMoveEvent,this.touchMoveOnSpinner)},t.prototype.changeHandler=function(e){e.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,e)},t.prototype.raiseChangeEvent=function(e){if(this.inputValue=g(this.inputValue)||isNaN(this.inputValue)?null:this.inputValue,this.prevValue!==this.value||this.prevValue!==this.inputValue){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:e},e&&(this.changeEventArgs.event=e),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),mt(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},t.prototype.pasteHandler=function(){var e=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){e.numericRegex().test(e.element.value)||e.setElementValue(i)})}},t.prototype.preventHandler=function(){var e=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(e.element.selectionStart>0){var r=e.element.selectionStart,n=e.element.selectionStart-1,s=0,a=e.element.value.split(""),l=Ki(e.locale),h=V("decimal",l),c=h.charCodeAt(0);e.element.value[n]===" "&&e.element.selectionStart>0&&!i?(g(e.prevVal)?e.element.value=e.element.value.trim():n!==0?e.element.value=e.prevVal:n===0&&(e.element.value=e.element.value.trim()),e.element.setSelectionRange(n,n)):isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.value[e.element.selectionStart-1].charCodeAt(0)!==45?(a.indexOf(e.element.value[e.element.selectionStart-1])!==a.lastIndexOf(e.element.value[e.element.selectionStart-1])&&e.element.value[e.element.selectionStart-1].charCodeAt(0)===c||e.element.value[e.element.selectionStart-1].charCodeAt(0)!==c)&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length),e.element.setSelectionRange(n,n),isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.selectionStart>0&&e.element.value.length&&e.preventHandler()):isNaN(parseFloat(e.element.value[e.element.selectionStart-2]))&&e.element.selectionStart>1&&e.element.value[e.element.selectionStart-2].charCodeAt(0)!==45&&(a.indexOf(e.element.value[e.element.selectionStart-2])!==a.lastIndexOf(e.element.value[e.element.selectionStart-2])&&e.element.value[e.element.selectionStart-2].charCodeAt(0)===c||e.element.value[e.element.selectionStart-2].charCodeAt(0)!==c)&&(e.element.setSelectionRange(n,n),e.nextEle=e.element.value[e.element.selectionStart],e.cursorPosChanged=!0,e.preventHandler()),e.cursorPosChanged===!0&&e.element.value[e.element.selectionStart]===e.nextEle&&isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&(e.element.setSelectionRange(e.element.selectionStart+1,e.element.selectionStart+1),e.cursorPosChanged=!1,e.nextEle=null),e.element.value.trim()===""&&e.element.setSelectionRange(s,s),e.element.selectionStart>0&&(e.element.value[e.element.selectionStart-1].charCodeAt(0)===45&&e.element.selectionStart>1&&(g(e.prevVal)||(e.element.value=e.prevVal),e.element.setSelectionRange(e.element.selectionStart,e.element.selectionStart)),e.element.value[e.element.selectionStart-1]===h&&e.decimals===0&&e.validateDecimalOnType&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length))),e.prevVal=e.element.value}})},t.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!e&&j.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=H(this.element,"form");if(r){var n=this.element.nextElementSibling,s=document.createEvent("KeyboardEvent");s.initEvent("keyup",!1,!0),n.dispatchEvent(s)}}},t.prototype.inputHandler=function(e){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((n||r)&&j.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==V("decimal",Ki(this.locale))&&this.element.value!==V("minusSign",Ki(this.locale))&&this.numericRegex().test(this.element.value)){var s=this.instance.getNumberParser({format:"n"})(this.element.value);s=isNaN(s)?null:s,i.localChange({value:s}),this.preventChange=!0}if(this.isVue){var a=this.instance.getNumberParser({format:"n"})(this.element.value),l=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),h=new RegExp("[^0-9]+$");(h.test(this.element.value)||(this.elementPrevValue.indexOf(".")!==-1||this.elementPrevValue.indexOf("-")!==-1)&&this.element.value[this.element.value.length-1]==="0")&&(a=this.value);var c={event:e,value:a===null||isNaN(a)?null:a,previousValue:l===null||isNaN(l)?null:l};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",c)}}},t.prototype.keyDownHandler=function(e){if(!this.readonly)switch(e.keyCode){case 38:e.preventDefault(),this.action(_u,e);break;case 40:e.preventDefault(),this.action(df,e);break}},t.prototype.performAction=function(e,i,r){(e===null||isNaN(e))&&(e=0);var n=r===_u?e+i:e-i;return n=this.correctRounding(e,i,n),this.strictMode?this.trimValue(n):n},t.prototype.correctRounding=function(e,i,r){var n=new RegExp("[,.](.*)"),s=n.test(e.toString()),a=n.test(i.toString());if(s||a){var l=s?n.exec(e.toString())[0].length:0,h=a?n.exec(i.toString())[0].length:0,c=Math.max(l,h);return e=this.roundValue(r,c)}return r},t.prototype.roundValue=function(e,i){i=i||0;var r=Math.pow(10,i);return e*=r,e=Math.round(e)/r},t.prototype.updateValue=function(e,i){i&&(this.isInteract=!0),e!==null&&!isNaN(e)&&this.decimals&&(e=this.roundNumber(e,this.decimals)),this.inputValue=e,this.isVue&&this.element&&this.element.hasAttribute("modelvalue")&&this.isDynamicChange||this.changeValue(e===null||isNaN(e)?null:this.strictMode?this.trimValue(e):e),this.isDynamicChange||this.raiseChangeEvent(i)},t.prototype.updateCurrency=function(e,i){it(e,i,this.cultureInfo),this.updateValue(this.value)},t.prototype.changeValue=function(e){if(!(e||e===0))e=null,this.setProperties({value:e},!0);else{var i=this.getNumberOfDecimals(e);this.setProperties({value:this.roundNumber(e,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},t.prototype.modifyText=function(){if(this.value||this.value===0){var e=this.formatNumber(),i=this.isFocused?e:this.instance.getNumberFormat(this.cultureInfo)(this.value);/[eE]/.test(e)&&(i=this.formatScientificNotation(i)),this.setElementValue(i),Ee(this.element,{"aria-valuenow":e}),g(this.hiddenInput)||(this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator)))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},t.prototype.setElementValue=function(e,i){Ie.setValue(e,i||this.element,this.floatLabelType,this.showClearButton)},t.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},t.prototype.getNumberOfDecimals=function(e){var i,r=new RegExp("[eE][-+]?([0-9]+)"),n=e.toString();if(r.test(n))if(/[eE]/.test(n))n=e.toFixed(20).replace(/0+$/,""),n.charAt(n.length-1)==="."&&(n=n.slice(0,n.length-1));else{var s=r.exec(n);g(s)||(n=e.toFixed(Math.min(parseInt(s[1],10),20)))}var a=n.split(".")[1];return i=!a||!a.length?0:a.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},t.prototype.formatNumber=function(){var e=this.getNumberOfDecimals(this.value);return this.storedValueString=this.value.toString(),this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(this.value)},t.prototype.trimValue=function(e){return e>this.max?this.max:e<this.min?this.min:e},t.prototype.roundNumber=function(e,i){var r=e,n=i||0,s=r.toString().split("e");r=Math.round(+(s[0]+"e"+(s[1]?Number(s[1])+n:n)));var a=r.toString().split("e");return r=+(a[0]+"e"+(a[1]?Number(a[1])-n:-n)),Number(r.toFixed(n))},t.prototype.cancelEvent=function(e){return e.preventDefault(),!1},t.prototype.keyPressHandler=function(e){if(!this.enabled||this.readonly)return!0;if(!j.isDevice&&j.info.version==="11.0"&&e.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,e),!0}if(e.which===0||e.metaKey||e.ctrlKey||e.keyCode===8||e.keyCode===13)return!0;var r=String.fromCharCode(e.which),n=V("decimal",Ki(this.locale)),s=e.code==="NumpadDecimal"&&r!==n;s&&(r=n);var a=this.element.value;if(a=a.substring(0,this.element.selectionStart)+r+a.substring(this.element.selectionEnd),this.numericRegex().test(a)){if(s){var l=this.element.selectionStart+1;this.element.value=a,this.element.setSelectionRange(l,l),e.preventDefault(),e.stopPropagation()}return!0}else return e.preventDefault(),e.stopPropagation(),!1},t.prototype.numericRegex=function(){var e=Ki(this.locale),i=V("decimal",e),r="*";return i===H_&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?j_:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^\\s*(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},t.prototype.mouseWheel=function(e){e.preventDefault();var i,r=e;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(_u,e):i<0&&this.action(df,e),this.cancelEvent(e)},t.prototype.focusHandler=function(e){var i=this;if(clearTimeout(Ck),this.focusEventArgs={event:e,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,this.floatLabelType!=="Never"&&this.inputWrapper&&this.inputWrapper.container){var r=this.inputWrapper.container.querySelector(".e-float-text");r&&r.removeAttribute("style")}if(this.prevValue=this.value,this.value||this.value===0){var n=this.formatNumber();if(/[eE]/.test(this.value.toString())&&(n=this.formatScientificNotation(n)),this.setElementValue(n),!this.isPrevFocused)if(!j.isDevice&&j.info.version==="11.0")this.element.setSelectionRange(0,n.length);else{var s=j.isDevice&&j.isIos?600:0;Ck=setTimeout(function(){i.element.setSelectionRange(0,n.length)},s)}}j.isDevice||T.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},t.prototype.focusOutHandler=function(e){var i=this;if(this.blurEventArgs={event:e,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(e.preventDefault(),j.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){i.setElementValue(r,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var s=this.instance.getNumberParser({format:"n"})(this.element.value);/[eE]/.test(this.element.value)&&(s=parseFloat(this.formatScientificNotation(this.element.value))),this.updateValue(s),j.isDevice||T.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}this.updateFloatLabelOverflowWidth();var a=H(this.element,"form");if(a){var l=this.element.nextElementSibling,h=document.createEvent("FocusEvent");h.initEvent("focusout",!1,!0),l.dispatchEvent(h)}}},t.prototype.mouseDownOnSpinner=function(e){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,e.preventDefault()),!!this.getElementData(e)){this.getElementData(e);var r=e.currentTarget,n=r.classList.contains(zx)?_u:df;T.add(r,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(n,e)},150),T.add(document,"mouseup",this.mouseUpClick,this)}},t.prototype.touchMoveOnSpinner=function(e){var i;if(e.type==="touchmove"){var r=e.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(e.clientX,e.clientY);i.classList.contains(Ox)||clearInterval(this.timeOut)},t.prototype.mouseUpOnSpinner=function(e){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),j.isDevice||(this.isPrevFocused=!1)),j.isDevice||e.preventDefault(),!!this.getElementData(e)){var i=e.currentTarget,r=i.classList.contains(zx)?_u:df;T.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,e),this.isCalled=!1,T.remove(document,"mouseup",this.mouseUpClick);var n=H(this.element,"form");if(n){var s=this.element.nextElementSibling,a=document.createEvent("KeyboardEvent");a.initEvent("keyup",!1,!0),s.dispatchEvent(a)}}},t.prototype.getElementData=function(e){return e.which&&e.which===3||e.button&&e.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},t.prototype.floatLabelTypeUpdate=function(){Ie.removeFloating(this.inputWrapper);var e=this.hiddenInput;this.hiddenInput.remove(),Ie.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(e,this.container.childNodes[1])},t.prototype.mouseUpClick=function(e){e.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,this.spinUp&&T.remove(this.spinUp,"mouseleave",this.mouseUpClick),this.spinDown&&T.remove(this.spinDown,"mouseleave",this.mouseUpClick)},t.prototype.formatScientificNotation=function(e){e=this.storedValueString?this.storedValueString:e;var i=e.toLowerCase().split("e"),r=i[0],n=i[1],s=parseInt(n,10),a=this.format.match(/n(\d+)/i),l=a?parseInt(a[1],10):10,h=r.replace(".",""),c;if(s<0){var u=Math.abs(Number(s))-1,d="0".repeat(Math.min(u,l));c="0."+d+h}else{var p=r.split("."),f=p[0],v=p[1],m=v===void 0?"":v,y=s-m.length;if(y>=0)c=f+m+"0".repeat(y);else{var b=m.slice(0,s)+"."+m.slice(s);c=f+b}}var S=c.split("."),C=S[0],x=S[1],I=x===void 0?"":x;if(this.isFocused){var D=I.slice(0,l);return C+"."+I}else{var M=I.padEnd(l,"0").slice(0,l);return C+"."+M}},t.prototype.increment=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,_u)),this.raiseChangeEvent()},t.prototype.decrement=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,df)),this.raiseChangeEvent()},t.prototype.destroy=function(){this.unwireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),se(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),se(this.spinUp),se(this.spinDown));for(var e=["aria-labelledby","role","autocomplete","aria-readonly","aria-disabled","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-valuenow","aria-invalid"],i=0;i<e.length;i++)this.element.removeAttribute(e[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),se(this.container),this.spinUp=null,this.spinDown=null,this.container=null,this.hiddenInput=null,this.changeEventArgs=null,this.blurEventArgs=null,this.focusEventArgs=null,this.inputWrapper=null,Ie.destroy({element:this.element,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},t.prototype.getText=function(){return this.element.value},t.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),X([this.container],[bk]))},t.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),Z([this.container],[bk]))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"width":this.setElementWidth(e.width),Ie.calculateWidth(this.element,this.container);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"enabled":Ie.setEnabled(e.enabled,this.element),this.bindClearEvent();break;case"enableRtl":Ie.setEnableRtl(e.enableRtl,[this.container]);break;case"readonly":Ie.setReadonly(e.readonly,this.element),this.readonly?Ee(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),Ie.validateInputType(this.container,this.element);break;case"placeholder":Ie.setPlaceholder(e.placeholder,this.element),Ie.calculateWidth(this.element,this.container);break;case"step":this.step=e.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(e);break;case"showClearButton":this.updateClearButton(e);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(e.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":it(s,V(s,e),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=e.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),Ie.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var a=V(s,e);this.setProperties({currencyCode:a},!0),this.updateCurrency(s,a)}break;case"currencyCode":{var l=V(s,e);this.setProperties({currency:l},!0),this.updateCurrency("currency",l)}break;case"format":it(s,V(s,e),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=e.decimals,this.updateValue(this.value)}}},t.prototype.updateClearButton=function(e){Ie.setClearButton(e.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},t.prototype.updateSpinButton=function(e){e.showSpinButton?this.spinBtnCreation():(se(this.spinUp),se(this.spinDown))},t.prototype.getRightIconsWidth=function(){for(var e=this.inputWrapper.container,i=0,r=".e-input-group-icon, .e-clear-icon",n=e.querySelectorAll(r),s=0;s<n.length;s++)i+=n[s].offsetWidth;return i},t.prototype.updateFloatLabelOverflowWidth=function(){var e=this.inputWrapper.container,i=e.querySelector(".e-float-text-overflow")||e.querySelector(".e-float-text"),r=e.clientWidth-this.getRightIconsWidth();i&&r&&(i.style.width=r+"px")},t.prototype.getModuleName=function(){return"numerictextbox"},mr([w("")],t.prototype,"cssClass",void 0),mr([w(null)],t.prototype,"value",void 0),mr([w(-Number.MAX_VALUE)],t.prototype,"min",void 0),mr([w(Number.MAX_VALUE)],t.prototype,"max",void 0),mr([w(1)],t.prototype,"step",void 0),mr([w(null)],t.prototype,"width",void 0),mr([w(null)],t.prototype,"placeholder",void 0),mr([w({})],t.prototype,"htmlAttributes",void 0),mr([w(!0)],t.prototype,"showSpinButton",void 0),mr([w(!1)],t.prototype,"readonly",void 0),mr([w(!0)],t.prototype,"enabled",void 0),mr([w(!1)],t.prototype,"showClearButton",void 0),mr([w(!1)],t.prototype,"enablePersistence",void 0),mr([w("n2")],t.prototype,"format",void 0),mr([w(null)],t.prototype,"decimals",void 0),mr([w(null)],t.prototype,"currency",void 0),mr([w(null)],t.prototype,"currencyCode",void 0),mr([w(!0)],t.prototype,"strictMode",void 0),mr([w(!1)],t.prototype,"validateDecimalOnType",void 0),mr([w("Never")],t.prototype,"floatLabelType",void 0),mr([G()],t.prototype,"created",void 0),mr([G()],t.prototype,"destroyed",void 0),mr([G()],t.prototype,"change",void 0),mr([G()],t.prototype,"focus",void 0),mr([G()],t.prototype,"blur",void 0),t=mr([It],t),t})(ti);var yf=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Bt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},W_=(function(o){yf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Bt([w("None")],t.prototype,"placement",void 0),Bt([w(10)],t.prototype,"largeStep",void 0),Bt([w(1)],t.prototype,"smallStep",void 0),Bt([w(!1)],t.prototype,"showSmallTicks",void 0),Bt([w(null)],t.prototype,"format",void 0),t})(Oe),q_=(function(o){yf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Bt([w(null)],t.prototype,"color",void 0),Bt([w(null)],t.prototype,"start",void 0),Bt([w(null)],t.prototype,"end",void 0),t})(Oe),Y_=(function(o){yf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Bt([w(!1)],t.prototype,"enabled",void 0),Bt([w(null)],t.prototype,"minStart",void 0),Bt([w(null)],t.prototype,"minEnd",void 0),Bt([w(null)],t.prototype,"maxStart",void 0),Bt([w(null)],t.prototype,"maxEnd",void 0),Bt([w(!1)],t.prototype,"startHandleFixed",void 0),Bt([w(!1)],t.prototype,"endHandleFixed",void 0),t})(Oe),G_=(function(o){yf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Bt([w("")],t.prototype,"cssClass",void 0),Bt([w("Before")],t.prototype,"placement",void 0),Bt([w("Focus")],t.prototype,"showOn",void 0),Bt([w(!1)],t.prototype,"isVisible",void 0),Bt([w(null)],t.prototype,"format",void 0),t})(Oe),Q_=6,X_=3,dh=1e-10,be={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},wk=(function(o){yf(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.horDir="left",r.verDir="bottom",r.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},r.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},r.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",r.customAriaText=null,r.drag=!0,r.isDragComplete=!1,r.initialTooltip=!0,r}return t.prototype.preRender=function(){var e={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new Ri("slider",e,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},t.prototype.formChecker=function(){var e=H(this.element,"form");e?(this.isForm=!0,g(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&(g(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat(Ae(this.min)),parseFloat(Ae(this.max))]:g(this.formResetValue)&&(this.formResetValue=parseFloat(Ae(this.min))),this.formElement=e):this.isForm=!1},t.prototype.initCultureFunc=function(){this.internationalization=new Nt(this.locale)},t.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=g(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=g(this.ticks.format)?null:this.ticks.format},t.prototype.formatString=function(e,i){var r=null,n=null;if(e||e===0){r=this.formatNumber(e);var s=this.numberOfDecimals(e);n=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(e,s))}return{elementVal:r,formatString:n}},t.prototype.formatNumber=function(e){var i=this.numberOfDecimals(e);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(e)},t.prototype.numberOfDecimals=function(e){var i=e.toString().split(".")[1],r=!i||!i.length?0:i.length;return r},t.prototype.makeRoundNumber=function(e,i){var r=i||0;return Number(e.toFixed(r))},t.prototype.render=function(){var e=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)==="none"&&setTimeout(function(){e.refresh()},0)},t.prototype.initialize=function(){X([this.element],be.root),this.setCSSClass()},t.prototype.setElementWidth=function(e){!g(e)&&!g(this.sliderContainer)&&(typeof e=="number"?this.sliderContainer.style.width=Ae(e):typeof e=="string"&&(this.sliderContainer.style.width=e.match(/px|%|em/)?e:Ae(e)))},t.prototype.setCSSClass=function(e){e&&Z([this.element],e.split(" ")),this.cssClass&&X([this.element],this.cssClass.split(" "))},t.prototype.setEnabled=function(){this.enabled?(Z([this.sliderContainer],[be.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(be.sliderDisabled),this.wireEvents()):(X([this.sliderContainer],[be.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(be.sliderDisabled),this.unwireEvents())},t.prototype.getTheme=function(e){var i=window.getComputedStyle(e,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},t.prototype.secureRandom=function(){var e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]/4294967296},t.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:be.sliderContainer+" "+be.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:be.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:g(this.value)?g(this.min)?"0":this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(this.secureRandom()*1e3).toFixed(0)+"slider",class:be.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=g(this.value)?g(this.min)?0:parseFloat(Ae(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat(Ae(this.value.toString()))):[this.checkHandleValue(parseFloat(Ae(this.value[0].toString()))),this.checkHandleValue(parseFloat(Ae(this.value[1].toString())))],this.previousChanged=this.previousVal,g(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?Z([this.sliderContainer],[be.sliderDisabled]):X([this.sliderContainer],[be.sliderDisabled]),this.readonly?X([this.sliderContainer],[be.readonly]):Z([this.sliderContainer],[be.readonly])},t.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isMaterial3=this.getTheme(this.sliderContainer)==="Material3"||this.getTheme(this.sliderContainer)==="Material3-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isTailwind3=this.getTheme(this.sliderContainer)==="tailwind3"||this.getTheme(this.sliderContainer)==="tailwind3-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isFluent2=this.getTheme(this.sliderContainer)==="fluent2",this.isBootstrap5Dot3=this.getTheme(this.sliderContainer)==="bootstrap5.3",this.isMaterialTooltip=(this.isMaterial||this.isMaterial3)&&this.type!=="Range"&&this.tooltip.isVisible},t.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:be.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(be.dragHorizontal):this.rangeBar.classList.add(be.dragVertical)))},t.prototype.createLimitBar=function(){var e=this.type!=="Range"?be.limitBarDefault:be.limitBarFirst;e+=" "+be.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:e}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:be.limitBarSecond+" "+be.limits}}),this.element.appendChild(this.limitBarSecond))},t.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(be.verticalSlider),this.sliderContainer.classList.add(be.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(be.horizontalSlider),this.sliderContainer.classList.add(be.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},t.prototype.setAriaAttributes=function(e){var i=this,r=this.min,n=this.max;if(!g(this.customValues)&&this.customValues.length>0&&(r=this.customValues[0],n=this.customValues[this.customValues.length-1]),this.type!=="Range")Ee(e,{"aria-valuemin":g(r)?"0":r.toString(),"aria-valuemax":g(n)?"100":n.toString()});else{var s=!g(this.customValues)&&this.customValues.length>0?[[g(r)?"":r.toString(),this.value.length>1&&!g(this.customValues[this.value[1]])?this.customValues[this.value[1]].toString():""],[this.value.length>0&&!g(this.customValues[this.value[0]])?this.customValues[this.value[0]].toString():"",g(n)?"":n.toString()]]:[[g(r)?"":r.toString(),this.value.length>1&&!g(this.value[1])?this.value[1].toString():""],[this.value.length>0&&!g(this.value[0])?this.value[0].toString():"",g(n)?"":n.toString()]];s.forEach(function(a,l){var h=l===0?i.firstHandle:i.secondHandle;h&&Ee(h,{"aria-valuemin":a[0],"aria-valuemax":a[1]})})}},t.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:be.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.secondHandle.classList.add(be.sliderSecondHandle),this.element.appendChild(this.secondHandle)},t.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:be.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.firstHandle.classList.add(be.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:be.sliderHandle+" "+be.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},t.prototype.wireFirstHandleEvt=function(e){e?(T.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),T.remove(this.firstHandle,"transitionend",this.transitionEnd),T.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),T.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(T.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),T.add(this.firstHandle,"transitionend",this.transitionEnd,this),T.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),T.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.wireSecondHandleEvt=function(e){e?(T.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),T.remove(this.secondHandle,"transitionend",this.transitionEnd),T.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),T.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(T.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),T.add(this.secondHandle,"transitionend",this.transitionEnd,this),T.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),T.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](be.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](be.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](be.sliderTooltipStart)))},t.prototype.transitionEnd=function(e){e.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},t.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(be.sliderHandleFocused)&&this.firstHandle.classList.remove(be.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(be.sliderHandleFocused)&&this.secondHandle.classList.remove(be.sliderHandleFocused)},t.prototype.handleFocus=function(e){this.focusSliderElement(),this.sliderBarClick(e),e.currentTarget===this.firstHandle?(this.firstHandle.classList.add(be.sliderHandleFocused),this.firstHandle.classList.add(be.sliderTabHandle)):(this.secondHandle.classList.add(be.sliderHandleFocused),this.secondHandle.classList.add(be.sliderTabHandle)),T.add(document,"mousemove touchmove",this.sliderBarMove,this),T.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.handleOver=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(e.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},t.prototype.handleLeave=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!e.currentTarget.classList.contains(be.sliderHandleFocused)&&!e.currentTarget.classList.contains(be.sliderTabHandle)&&this.closeTooltip()},t.prototype.setHandler=function(){this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},t.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?X([this.sliderContainer],be.rtl):Z([this.sliderContainer],be.rtl);var e=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;e!==i&&this.orientation==="Horizontal"&&(Ze(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&Ze(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},t.prototype.tooltipValue=function(){var e=this,i,r={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),r.text=i=typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,this.trigger("tooltipChange",r,function(n){if(e.addTooltipClass(n.text),i!==n.text){e.customAriaText=n.text,e.enableHtmlSanitizer?n.text=Pt.sanitize(n.text.toString()):n.text=n.text.toString();var s=function(){return n.text};e.tooltipObj.content=fa(s),e.setAriaAttrValue(e.firstHandle),e.type==="Range"&&e.setAriaAttrValue(e.secondHandle)}}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},t.prototype.setTooltipContent=function(){var e=this.formatContent(this.tooltipFormatInfo,!1),i=function(){return e};this.tooltipObj.content=fa(i)},t.prototype.formatContent=function(e,i){var r="",n=this.handleVal1,s=this.handleVal2;return!g(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],s=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(s,e).elementVal+" - "+this.formatString(n,e).elementVal:s.toString()+" - "+n.toString():r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(n,e).elementVal+" - "+this.formatString(s,e).elementVal:n.toString()+" - "+s.toString():g(n)||(r=!g(this.tooltip)&&!g(this.tooltip.format)?this.formatString(n,e).elementVal:n.toString()),r):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=g(e.format)?s.toString()+" - "+n.toString():this.formatString(s,e).formatString+" - "+this.formatString(n,e).formatString:r=g(e.format)?n.toString()+" - "+s.toString():this.formatString(n,e).formatString+" - "+this.formatString(s,e).formatString:g(n)||(r=g(e.format)?n.toString():this.formatString(n,e).formatString),r)},t.prototype.addTooltipClass=function(e){if(this.isMaterialTooltip){var i=e.toString().length;if(this.tooltipElement){var r=i>4?{oldCss:be.sliderMaterialDefault,newCss:be.sliderMaterialRange}:{oldCss:be.sliderMaterialRange,newCss:be.sliderMaterialDefault};this.tooltipElement.classList.remove(r.oldCss),this.tooltipElement.classList.contains(r.newCss)||(this.tooltipElement.classList.add(r.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var r=i>4?be.sliderMaterialRange:be.sliderMaterialDefault;this.tooltipObj.cssClass=be.sliderTooltip+" "+r}}},t.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},t.prototype.tooltipBeforeOpen=function(e){this.tooltipElement=e.element,this.tooltip.cssClass&&X([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),e.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(be.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},t.prototype.tooltipCollision=function(e){if(this.isBootstrap||this.isBootstrap4||(this.isMaterial||this.isMaterial3)&&!this.isMaterialTooltip){var i=this.isBootstrap4?X_:Q_;switch(e){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},t.prototype.materialTooltipEventCallBack=function(e){this.sliderBarClick(e),T.add(document,"mousemove touchmove",this.sliderBarMove,this),T.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.wireMaterialTooltipEvent=function(e){this.isMaterialTooltip&&(e?T.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):T.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},t.prototype.tooltipPositionCalculation=function(e){var i;switch(e){case"TopCenter":i=be.horizontalTooltipBefore;break;case"BottomCenter":i=be.horizontalTooltipAfter;break;case"LeftCenter":i=be.verticalTooltipBefore;break;case"RightCenter":i=be.verticalTooltipAfter;break}return i},t.prototype.getTooltipTransformProperties=function(e){var i;if(this.tooltipElement){var r=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?e===be.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+r+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-r+"px)"}:e===be.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+r+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-r+"px)"}}return i},t.prototype.openMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(be.materialTooltipHide),i.classList.add(be.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(be.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition=e.transition.handle)},2500):setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.closeMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(be.materialTooltipShow),i.classList.add(be.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(be.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.checkTooltipPosition=function(e){var i=this.tooltipPositionCalculation(e.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==e.collidedPosition||!e.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(e.element.classList.remove(this.previousTooltipClass),e.element.classList.add(i),this.previousTooltipClass=i),e.element.style.transform&&e.element.classList.contains(be.materialTooltipOpen)&&e.element.firstElementChild.innerText.length<=4&&(e.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=e.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},t.prototype.setTooltipTransform=function(){var e=this.getTooltipTransformProperties(this.previousTooltipClass);g(this.tooltipElement)||(this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=e.translate+" scale(0.01)":this.tooltipElement.style.transform=e.translate+" "+e.rotate+" scale(0.01)")},t.prototype.renderTooltip=function(){this.tooltipObj=new uh({showTipPointer:this.isBootstrap||this.isMaterial||this.isMaterial3||this.isBootstrap4||this.isTailwind||this.isTailwind3||this.isBootstrap5||this.isFluent||this.isFluent2||this.isBootstrap5Dot3,cssClass:be.sliderTooltip,height:this.isMaterial||this.isMaterial3?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},t.prototype.initializeTooltipProps=function(){var e=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:e}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){g(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(be.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},t.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},t.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:be.sliderButton+" "+be.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:be.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:be.sliderButton+" "+be.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:be.sliderButtonIcon})),(this.isTailwind||this.isTailwind3)&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(be.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},t.prototype.buttonTitle=function(){var e=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),r=this.l10n.getConstant("incrementTitle");Ee(e?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),Ee(e?this.firstBtn:this.secondBtn,{"aria-label":r,title:r})},t.prototype.buttonFocusOut=function(){(this.isMaterial||this.isMaterial3)&&this.getHandle().classList.remove("e-large-thumb-size")},t.prototype.repeatButton=function(e){var i=this.handleValueUpdate(),r=this.enableRtl&&this.orientation!=="Vertical",n;e.target.parentElement.classList.contains(be.firstButton)||e.target.classList.contains(be.firstButton)?r?n=this.add(i,parseFloat(this.step.toString()),!0):n=this.add(i,parseFloat(this.step.toString()),!1):(e.target.parentElement.classList.contains(be.secondButton)||e.target.classList.contains(be.secondButton))&&(r?n=this.add(i,parseFloat(this.step.toString()),!1):n=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(n=this.getLimitCorrectedValues(n)),n>=this.min&&n<=this.max&&(this.changeHandleValue(n,e),this.tooltipToggle(this.getHandle()))},t.prototype.repeatHandlerMouse=function(e){e.preventDefault(),(e.type==="mousedown"||e.type==="touchstart")&&(this.buttonClick(e),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,e))},t.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},t.prototype.focusHandle=function(){this.getHandle().classList.contains(be.sliderTabHandle)||this.getHandle().classList.add(be.sliderTabHandle)},t.prototype.repeatHandlerUp=function(e){this.changeEvent("changed",e),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},t.prototype.customTickCounter=function(e){var i=4;return!g(this.customValues)&&this.customValues.length>0&&(e>4&&(i=3),e>7&&(i=2),e>14&&(i=1),e>28&&(i=0)),i},t.prototype.renderScale=function(){var e=this.orientation==="Vertical"?"v":"h";this.ul=this.createElement("ul",{className:be.scale+" e-"+e+"-scale "+be.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}}),this.ul.style.zIndex="-1",j.isAndroid&&e==="h"&&this.ul.classList.add(be.sliderTickPosition);var i=this.ticks.smallStep;this.ticks.showSmallTicks?i<=0&&(i=parseFloat(Ae(this.step))):this.ticks.largeStep>0?i=this.ticks.largeStep:i=parseFloat(Ae(this.max))-parseFloat(Ae(this.min));var r=parseFloat(Ae(this.min)),n=parseFloat(Ae(this.max)),s=parseFloat(Ae(i)),a=!g(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,l=this.customTickCounter(a),h=!g(this.customValues)&&this.customValues.length>0?a*l+a:Math.abs((n-r)/s);this.element.appendChild(this.ul);var c,u=parseFloat(this.min.toString());e==="v"&&(u=parseFloat(this.max.toString()));var d=0,p,f=100/h;f===1/0&&(f=5);for(var v=0,m=!g(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,y=0;v<=h;v++){if(c=this.createElement("li",{attrs:{class:be.tick,role:"presentation","aria-hidden":"true"}}),!g(this.customValues)&&this.customValues.length>0)p=v%(l+1)===0,p&&(e==="h"?(u=this.customValues[y],y++):(u=this.customValues[m],m--),c.setAttribute("title",u.toString()));else if(c.setAttribute("title",u.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)if(e==="h"){var b=(u-parseFloat(this.min.toString()))%this.ticks.largeStep;p=Math.abs(b)<dh||Math.abs(this.ticks.largeStep-b)<dh}else{var b=Math.abs(u-parseFloat(this.max.toString()))%this.ticks.largeStep;p=Math.abs(b)<dh||Math.abs(this.ticks.largeStep-b)<dh}else{var S=this.ticks.largeStep,C=u;if(e==="h"){var b=(C-r)%S;p=Math.abs(b)<dh||Math.abs(S-b)<dh}else{var b=Math.abs(C-parseFloat(n.toString()))%S;p=Math.abs(b)<dh||Math.abs(S-b)<dh}}p&&c.classList.add(be.large),e==="h"?c.style.width=f+"%":c.style.height=f+"%";var x=p?this.ticks.placement==="Both"?2:1:0;if(p)for(var I=0;I<x;I++)this.createTick(c,u);else g(this.customValues)&&this.formatTicksValue(c,u);this.ul.appendChild(c),this.tickElementCollection.push(c);var D=void 0;g(this.customValues)&&(this.numberOfDecimals(i)>this.numberOfDecimals(u)?D=this.numberOfDecimals(i):D=this.numberOfDecimals(u),e==="h"?u=this.makeRoundNumber(u+i,D):this.min>this.max?u=this.makeRoundNumber(u+i,D):u=this.makeRoundNumber(u-i,D),d=this.makeRoundNumber(d+i,D))}this.ticksAlignment(e,f)},t.prototype.ticksAlignment=function(e,i,r){r===void 0&&(r=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(be.sliderFirstTick),this.lastChild.classList.add(be.sliderLastTick),this.sliderContainer.classList.add(be.scale+"-"+this.ticks.placement.toLowerCase()),e==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var n={ticksWrapper:this.ul,tickElements:this.tickElementCollection};r&&this.trigger("renderedTicks",n),this.scaleAlignment()},t.prototype.createTick=function(e,i){var r=this.createElement("span",{className:be.tickValue+" "+be.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation","aria-hidden":"true"}});e.appendChild(r),g(this.customValues)?this.formatTicksValue(e,i,r):this.enableHtmlSanitizer?r.innerHTML=Pt.sanitize(i.toString()):r.innerHTML=i.toString()},t.prototype.formatTicksValue=function(e,i,r){var n=this,s=this.formatNumber(i),a=!g(this.ticks)&&!g(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:s,l={value:i,text:a,tickElement:e};this.trigger("renderingTicks",l,function(h){e.setAttribute("title",h.text.toString()),r&&(n.enableHtmlSanitizer?r.innerHTML=Pt.sanitize(h.text.toString()):r.innerHTML=h.text.toString())})},t.prototype.scaleAlignment=function(){this.tickValuePosition(),this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(be.sliderSmallSize):this.sliderContainer.classList.remove(be.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(be.sliderSmallSize):this.sliderContainer.classList.remove(be.sliderSmallSize)},t.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var e=this.firstChild.getBoundingClientRect(),i,r,n=this.ticks.smallStep,s=Math.abs(parseFloat(Ae(this.max))-parseFloat(Ae(this.min)))/n;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var a=[this.sliderContainer.querySelectorAll("."+be.tick+"."+be.large+" ."+be.tickValue)],l;this.ticks.placement==="Both"?l=[].slice.call(a[0],2):l=[].slice.call(a[0],1);for(var h=this.orientation==="Vertical"?e.height*2:e.width*2,c=0;c<this.firstChild.children.length;c++)this.orientation==="Vertical"?this.firstChild.children[c].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[c].style.left=(h-this.firstChild.children[c].getBoundingClientRect().width)/2+"px":this.firstChild.children[c].style.left=-(i.width/2)+"px";for(var c=0;c<l.length;c++)r=l[c].getBoundingClientRect(),this.orientation==="Vertical"?Ze(l[c],{top:(h-r.height)/2+"px"}):Ze(l[c],{left:(h-r.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&s!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),s===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(be.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(be.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(be.sliderLastTick))},t.prototype.setAriaAttrValue=function(e){var i,r=!g(this.ticks)&&!g(this.ticks.format),n=r?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),s=r?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);n=this.customAriaText?this.customAriaText:n,n.split(" - ").length===2?i=n.split(" - "):i=[n,n],this.setAriaAttributes(e),this.type!=="Range"?Ee(e,{"aria-valuenow":s,"aria-valuetext":n}):this.enableRtl?e===this.firstHandle?Ee(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]}):Ee(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):e===this.firstHandle?Ee(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):Ee(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]})},t.prototype.handleValueUpdate=function(){var e;return this.type==="Range"?this.activeHandle===1?e=this.handleVal1:e=this.handleVal2:e=this.handleVal1,e},t.prototype.getLimitCorrectedValues=function(e){return this.type==="MinRange"||this.type==="Default"?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:e=this.getLimitValueAndPosition(e,this.limits.maxStart,this.limits.maxEnd)[0],e},t.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},t.prototype.buttonClick=function(e){this.focusSliderElement();var i,r=this.enableRtl&&this.orientation!=="Vertical",n=this.handleValueUpdate();e.keyCode===40||e.keyCode===37||e.currentTarget.classList.contains(be.firstButton)?r?i=this.add(n,parseFloat(this.step.toString()),!0):i=this.add(n,parseFloat(this.step.toString()),!1):e.keyCode===38||e.keyCode===39||e.currentTarget.classList.contains(be.secondButton)?r?i=this.add(n,parseFloat(this.step.toString()),!1):i=this.add(n,parseFloat(this.step.toString()),!0):e.keyCode===33||e.currentTarget.classList.contains(be.firstButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):e.keyCode===34||e.currentTarget.classList.contains(be.secondButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):e.keyCode===36?i=parseFloat(this.min<this.max?this.min.toString():this.max.toString()):e.keyCode===35&&(i=parseFloat(this.min<this.max?this.max.toString():this.min.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i,e),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(be.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),e.currentTarget.classList.contains(be.firstButton)&&T.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),e.currentTarget.classList.contains(be.secondButton)&&T.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},t.prototype.tooltipToggle=function(e){this.isMaterialTooltip?this.tooltipElement.classList.contains(be.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(e):this.openTooltip(e)},t.prototype.buttonUp=function(e){e.currentTarget.classList.contains(be.firstButton)&&T.remove(this.firstBtn,"mouseup touchend",this.buttonUp),e.currentTarget.classList.contains(be.secondButton)&&T.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},t.prototype.setRangeBar=function(){this.orientation==="Horizontal"&&!g(this.rangeBar)?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Ze(this.rangeBar,{width:g(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Ze(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):g(this.rangeBar)||(this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Ze(this.rangeBar,{height:g(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Ze(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"})))},t.prototype.checkValidValueAndPos=function(e){return e=this.checkHandleValue(e),e=this.checkHandlePosition(e),e},t.prototype.setLimitBarPositions=function(e,i,r,n){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.left=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.bottom=(this.min<this.max?e:i)+"px",this.limitBarFirst.style.height=(this.min<this.max?i-e:e-i)+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.left=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.bottom=(this.min<this.max?r:n)+"px",this.limitBarSecond.style.height=(this.min<this.max?n-r:r-n)+"px"))},t.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var e=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(e,i)}else if(this.type==="Range"){var r=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var s=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];s=this.checkValidValueAndPos(s);var a=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];a=this.checkValidValueAndPos(a),this.setLimitBarPositions(r,n,s,a)}},t.prototype.getLimitValueAndPosition=function(e,i,r,n){return g(i)&&(i=this.min<this.max?this.min:this.max,g(e)&&n&&(e=i)),g(r)&&(r=this.min<this.max?this.max:this.min,g(e)&&n&&(e=r)),e<i&&(e=i),e>r&&(e=r),[e,this.checkHandlePosition(e)]},t.prototype.setValue=function(){if(!g(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=g(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,g(this.activeHandle)&&(this.activeHandle=this.type==="Range"?2:1),this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},t.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat(Ae(this.min)),parseFloat(Ae(this.max))])},t.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},t.prototype.modifyZindex=function(){this.type==="Range"&&!g(this.firstHandle)&&!g(this.secondHandle)?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=Gs(this.element)+"")},t.prototype.setHandlePosition=function(e){var i=this,r,n=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?r=[this.firstHandle,this.materialHandle]:r=[this.getHandle()],this.handleStart(),r.forEach(function(s){g(s)||(i.orientation==="Horizontal"?i.enableRtl?s.style.right=n+"px":s.style.left=n+"px":s.style.bottom=n+"px")}),this.changeEvent("change",e)},t.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},t.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},t.prototype.changeEvent=function(e,i){var r=e==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),r!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.firstHandle);else{var n=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:n},!0),(r.length===this.value.length&&this.value[0]!==r[0]||this.value[1]!==r[1])&&(this.initialTooltip=!1,this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},t.prototype.changeEventArgs=function(e,i){var r;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,isInteracted:!g(i)}):r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:g(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!g(i)},r},t.prototype.setPreviousVal=function(e,i){e==="change"?this.previousVal=i:this.previousChanged=i},t.prototype.updateRangeValue=function(){var e=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[e[1],e[0]]:this.value=[e[0],e[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.min<this.max&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.min>this.max&&this.handlePos1<this.handlePos2&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},t.prototype.checkHandlePosition=function(e){var i;return e=100*(e-parseFloat(Ae(this.min)))/(parseFloat(Ae(this.max))-parseFloat(Ae(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(e/100):i=this.element.getBoundingClientRect().height*(e/100),parseFloat(Ae(this.max))===parseFloat(Ae(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},t.prototype.checkHandleValue=function(e){if(this.min===this.max)return parseFloat(Ae(this.max));var i=this.tempStartEnd();return e<i.start?e=i.start:e>i.end&&(e=i.end),e},t.prototype.reposition=function(){var e=this;g(this.firstHandle)||(this.firstHandle.style.transition="none"),this.type!=="Default"&&!g(this.rangeBar)&&(this.rangeBar.style.transition="none"),this.type==="Range"&&!g(this.secondHandle)&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&!g(this.materialHandle)&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"&&!g(this.rangeBar)?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Ze(this.rangeBar,{width:g(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&!g(this.secondHandle)&&!g(this.rangeBar)&&(this.enableRtl?(this.secondHandle.style.right=this.handlePos2+"px",this.rangeBar.style.right=this.handlePos1+"px"):(this.secondHandle.style.left=this.handlePos2+"px",this.rangeBar.style.left=this.handlePos1+"px"),Ze(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Ze(this.rangeBar,{height:g(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Ze(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){g(e.firstHandle)||(e.firstHandle.style.transition=e.scaleTransform),e.type==="Range"&&!g(e.secondHandle)&&(e.secondHandle.style.transition=e.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},t.prototype.changeHandleValue=function(e,i){var r=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(e),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&(this.handlePos1>this.handlePos2&&this.min<this.max||this.handlePos1<this.handlePos2&&this.min>this.max)&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(r=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(e),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&(this.handlePos2<this.handlePos1&&this.min<this.max||this.handlePos2>this.handlePos1&&this.min>this.max)&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(r=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),r!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(i))},t.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},t.prototype.xyToPosition=function(e){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var r=e.x-this.element.getBoundingClientRect().left,n=this.element.offsetWidth/100;this.val=r/n}else{var s=e.y-this.element.getBoundingClientRect().top,n=this.element.offsetHeight/100;this.val=100-s/n}var a=this.stepValueCalculation(this.val);return a<0?a=0:a>100&&(a=100),this.enableRtl&&this.orientation!=="Vertical"&&(a=100-a),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(a/100):i=this.element.getBoundingClientRect().height*(a/100),i},t.prototype.stepValueCalculation=function(e){this.step===0&&(this.step=1);var i=parseFloat(Ae(this.step))/((parseFloat(Ae(this.max))-parseFloat(Ae(this.min)))/100),r=e%Math.abs(i);return r!==0&&(i/2>r?e-=r:e+=Math.abs(i)-r),e},t.prototype.add=function(e,i,r){var n=Math.pow(10,3),s;return r?s=(Math.round(e*n)+Math.round(i*n))/n:s=(Math.round(e*n)-Math.round(i*n))/n,s},t.prototype.positionToValue=function(e){var i,r=parseFloat(Ae(this.max))-parseFloat(Ae(this.min));this.orientation==="Horizontal"?i=e/this.element.getBoundingClientRect().width*r:i=e/this.element.getBoundingClientRect().height*r;var n=this.add(i,parseFloat(this.min.toString()),!0);return n},t.prototype.sliderBarClick=function(e){e.preventDefault();var i;e.type==="mousedown"||e.type==="mouseup"||e.type==="click"?i={x:e.clientX,y:e.clientY}:(e.type==="touchend"||e.type==="touchstart")&&(i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY});var r=this.xyToPosition(i),n=this.positionToValue(r);if(this.type==="Range"&&(this.min<this.max&&this.handlePos2-r<r-this.handlePos1||this.min>this.max&&this.handlePos1-r>r-this.handlePos2)){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=s[0],r=s[1]}this.secondHandle.classList.add(be.sliderActiveHandle),this.handlePos2=this.preHandlePos2=r,this.handleVal2=n}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=s[0],r=s[1]}this.firstHandle.classList.add(be.sliderActiveHandle),this.handlePos1=this.preHandlePos1=r,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(be.materialTooltipActive);var a=this.element.querySelector("."+be.sliderTabHandle);a&&this.getHandle()!==a&&a.classList.remove(be.sliderTabHandle);var l=this.activeHandle===1?this.firstHandle:this.secondHandle,h;if((e.type==="click"||e.type==="mousedown")&&e.target===l){var c=e.clientX,u=e.clientY;h=document.elementFromPoint(c,u)}if(this.checkRepeatedValue(n)){var d=(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=d.handle,this.type!=="Default"&&(this.rangeBar.style.transition=d.rangeBar),this.setHandlePosition(e),this.isMaterialTooltip&&(this.initialTooltip=!1),e.target!==l&&this.changeEvent("changed",e),this.type!=="Default"&&this.setRangeBar()}},t.prototype.handleValueAdjust=function(e,i,r){r===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):r===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},t.prototype.dragRangeBarMove=function(e){var i,r;e.type!=="touchmove"&&e.preventDefault(),this.rangeBarDragged=!0;var n;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var s,a;if(e.type==="mousemove"?(i=[e.clientX,e.clientY],s=i[0],a=i[1]):(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],s=r[0],a=r[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?n={x:s+this.secondPartRemain,y:a+this.secondPartRemain}:n={x:s-this.firstPartRemain,y:a+this.secondPartRemain},this.min>this.max?(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)):(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)),this.enableRtl?n={x:s-this.firstPartRemain,y:a-this.firstPartRemain}:n={x:s+this.secondPartRemain,y:a-this.firstPartRemain},this.min>this.max?(this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1)):(this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2)),this.limits.enabled){var l=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=l[0],this.handlePos1=l[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),l=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=l[0],this.handlePos2=l[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===(this.min>this.max?this.min:this.max)&&this.handleValueAdjust(this.handleVal2,this.min>this.max?this.min:this.max,2),this.handleVal1===(this.min>this.max?this.max:this.min)&&this.handleValueAdjust(this.handleVal1,this.min>this.max?this.max:this.min,1)}this.activeHandle=1,this.setHandlePosition(e),this.activeHandle=2,this.setHandlePosition(e),this.tooltipToggle(this.rangeBar),this.setRangeBar()},t.prototype.sliderBarUp=function(e){this.changeEvent("changed",e),this.handleFocusOut(),this.firstHandle.classList.remove(be.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(be.sliderActiveHandle)),this.closeTooltip(),(this.isMaterial||this.isMaterial3)&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(be.materialTooltipActive)),T.remove(document,"mousemove touchmove",this.sliderBarMove),T.remove(document,"mouseup touchend",this.sliderBarUp)},t.prototype.sliderBarMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i;e.type==="mousemove"?i={x:e.clientX,y:e.clientY}:i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};var r=this.xyToPosition(i),n=this.positionToValue(r);if(r=Math.round(r),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);r=s[1],n=s[0]}this.handlePos1=r,this.handleVal1=n}this.firstHandle.classList.add(be.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(be.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&((this.min<this.max&&r>this.handlePos2||this.min>this.max&&r<this.handlePos2)&&(r=this.handlePos2,n=this.handleVal2),r!==this.preHandlePos1)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=a[0],r=a[1]}this.handlePos1=this.preHandlePos1=r,this.handleVal1=n,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(be.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&((this.min<this.max&&r<this.handlePos1||this.min>this.max&&r>this.handlePos1)&&(r=this.handlePos1,n=this.handleVal1),r!==this.preHandlePos2))){if(this.limits.enabled){var a=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=a[0],r=a[1]}this.handlePos2=this.preHandlePos2=r,this.handleVal2=n,this.activeHandle=2}}this.checkRepeatedValue(n)&&(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(e),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(be.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},t.prototype.dragRangeBarUp=function(e){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(e)),this.changeEvent("changed",e),this.closeTooltip(),T.remove(document,"mousemove touchmove",this.dragRangeBarMove),T.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},t.prototype.checkRepeatedValue=function(e){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(e===i)return 0}else if(e===this.previousVal)return 0;return 1},t.prototype.refreshTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),e&&(this.tooltipObj.refresh(e),this.tooltipTarget=e))},t.prototype.openTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(e),this.tooltipTarget=e)},t.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},t.prototype.keyDown=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:e.preventDefault(),this.buttonClick(e);break}},t.prototype.wireButtonEvt=function(e){e?(T.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),T.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),T.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),T.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),T.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),T.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),T.remove(this.firstBtn,"focusout",this.sliderFocusOut),T.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(T.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),T.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),T.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),T.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),T.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),T.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),T.add(this.firstBtn,"focusout",this.sliderFocusOut,this),T.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},t.prototype.rangeBarMousedown=function(e){var i,r;if(e.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&e.target===this.rangeBar){var n=void 0,s=void 0;e.type==="mousedown"?(i=[e.clientX,e.clientY],n=i[0],s=i[1]):e.type==="touchstart"&&(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],n=r[0],s=r[1]),this.orientation==="Horizontal"?(this.firstPartRemain=n-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-n):(this.firstPartRemain=s-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-s),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var a=this.element.querySelector("."+be.sliderTabHandle);a&&a.classList.remove(be.sliderTabHandle),T.add(document,"mousemove touchmove",this.dragRangeBarMove,this),T.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},t.prototype.elementClick=function(e){if(this.isDragComplete){this.isDragComplete=!1;return}e.preventDefault(),this.focusSliderElement(),this.sliderBarClick(e),this.focusHandle()},t.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(T.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&T.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),T.add(this.sliderContainer,"keydown",this.keyDown,this),T.add(this.sliderContainer,"keyup",this.keyUp,this),T.add(this.element,"focusout",this.sliderFocusOut,this),T.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&T.add(this.formElement,"reset",this.formResetHandler,this))},t.prototype.unwireEvents=function(){T.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&T.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),T.remove(this.sliderContainer,"keydown",this.keyDown),T.remove(this.sliderContainer,"keyup",this.keyUp),T.remove(this.element,"focusout",this.sliderFocusOut),T.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),T.remove(this.element,"reset",this.formResetHandler)},t.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},t.prototype.keyUp=function(e){if(e.keyCode===9&&e.target.classList.contains(be.sliderHandle)&&(this.focusSliderElement(),!e.target.classList.contains(be.sliderTabHandle))){this.element.querySelector("."+be.sliderTabHandle)&&this.element.querySelector("."+be.sliderTabHandle).classList.remove(be.sliderTabHandle),e.target.classList.add(be.sliderTabHandle);var i=e.target.parentElement;if(i===this.element&&(i.querySelector("."+be.sliderTrack).classList.add(be.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+be.rangeBar).classList.add(be.sliderTabRange)),this.type==="Range"){var r=e.target.previousSibling;r&&r.classList.contains(be.sliderHandle)?this.activeHandle=2:this.activeHandle=1}this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",e)},t.prototype.hover=function(e){if(!g(e))if(e.type==="mouseover"||e.type==="touchmove"||e.type==="mousemove"||e.type==="pointermove"||e.type==="touchstart")this.sliderContainer.classList.add(be.sliderHover);else{this.sliderContainer.classList.remove(be.sliderHover);var i=e.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(be.sliderHandleFocused)&&!i.classList.contains(be.sliderTabHandle)&&this.closeMaterialTooltip()}},t.prototype.sliderFocusOut=function(e){e.relatedTarget!==this.secondHandle&&e.relatedTarget!==this.firstHandle&&e.relatedTarget!==this.element&&e.relatedTarget!==this.firstBtn&&e.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+be.sliderTabHandle)&&this.element.querySelector("."+be.sliderTabHandle).classList.remove(be.sliderTabHandle),this.element.querySelector("."+be.sliderTabTrack)&&(this.element.querySelector("."+be.sliderTabTrack).classList.remove(be.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+be.sliderTabRange)&&this.element.querySelector("."+be.sliderTabRange).classList.remove(be.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},t.prototype.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prototype.changeSliderType=function(e,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(be.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,e!=="Default"&&(e==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!g(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(e==="MinRange"||e==="Default"?g(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):g(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!this.enabled),this.type==="Range"&&this.wireSecondHandleEvt(!this.enabled),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig(),this.readonly&&(this.sliderContainer.classList.remove(be.readonly),this.setReadOnly())},t.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var e=this.enableRtl&&this.orientation!=="Vertical";Ee(e?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),Ee(e?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},t.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},t.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},t.prototype.limitsPropertyChange=function(){this.limits.enabled?(g(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),g(this.limitBarFirst)&&g(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(g(this.limitBarFirst)||se(this.limitBarFirst),g(this.limitBarSecond)||se(this.limitBarSecond))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),Z([this.sliderContainer],[be.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode&&this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),se(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML="",this.hiddenInput=null,this.sliderContainer=null,this.sliderTrack=null,this.rangeBar=null,this.firstHandle=null,this.secondHandle=null,this.tickElementCollection=null,this.ul=null,this.firstBtn=null,this.secondBtn=null,this.materialHandle=null,this.tooltipObj=null,this.tooltipTarget=null,this.limitBarFirst=null,this.limitBarSecond=null,this.firstChild=null,this.lastChild=null,this.tooltipElement=null},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(e&&i){var l=g(e.value)?this.type==="Range"?[this.min,this.max]:this.min:e.value;this.setProperties({value:l},!0),!g(i.value)&&i.value.toString()!==l.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&(g(e.value)||i.value[1]===l[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!g(e.tooltip)&&!g(i.tooltip)&&(this.initialTooltip=!0,this.setTooltip(a),this.showButtons||this.wireEvents());break;case"type":!g(i)&&Object.keys(i).length&&!g(i.type)&&(this.changeSliderType(i.type,a),this.setZindex());break;case"enableRtl":i.enableRtl!==e.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":g(this.sliderContainer.querySelector("."+be.scale))||(se(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(h){h.match(/e-scale-/)&&r.sliderContainer.classList.remove(h)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":e.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(be.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(e.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},t.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(be.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(be.readonly))},t.prototype.setMinMaxValue=function(){var e=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),g(this.sliderContainer.querySelector("."+be.scale))||this.ul&&(se(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&e.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},t.prototype.setZindex=function(){this.zIndex=6,!g(this.ticks)&&this.ticks.placement!=="None"&&!g(this.ul)&&!g(this.element)&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!this.isMaterial3&&!g(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),g(this.firstHandle)||(this.firstHandle.style.zIndex=this.zIndex+3+""),this.type==="Range"&&!g(this.secondHandle)&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},t.prototype.setTooltip=function(e){this.changeSliderType(this.type,e)},t.prototype.setBarColor=function(){for(var e,i,r=this.sliderTrack.lastElementChild;r;)this.sliderTrack.removeChild(r),r=this.sliderTrack.lastElementChild;for(var n=0;n<this.colorRange.length;n++)if(!g(this.colorRange[n].start)&&!g(this.colorRange[n].end)&&this.colorRange[n].end>this.colorRange[n].start){this.colorRange[n].start<this.min&&(this.colorRange[n].start=this.min),this.colorRange[n].end>this.max&&(this.colorRange[n].end=this.max);var s=this.checkHandlePosition(this.colorRange[n].start),a=this.checkHandlePosition(this.colorRange[n].end),l=this.createElement("div");l.style.backgroundColor=this.colorRange[n].color,l.style.border="1px solid "+this.colorRange[n].color,this.orientation==="Horizontal"?(i=be.sliderHorizantalColor,this.enableRtl?g(this.customValues)?e=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[n].end):e=this.checkHandlePosition(this.customValues.length-this.colorRange[n].end-1):e=this.checkHandlePosition(this.colorRange[n].start),l.style.width=a-s+"px",l.style.left=e+"px"):(i=be.sliderVerticalColor,e=this.checkHandlePosition(this.colorRange[n].start),l.style.height=a-s+"px",l.style.bottom=e+"px"),l.classList.add(i),this.sliderTrack.appendChild(l)}},t.prototype.getModuleName=function(){return"slider"},Bt([w(null)],t.prototype,"value",void 0),Bt([w(null)],t.prototype,"customValues",void 0),Bt([w(1)],t.prototype,"step",void 0),Bt([w(null)],t.prototype,"width",void 0),Bt([w(0)],t.prototype,"min",void 0),Bt([w(100)],t.prototype,"max",void 0),Bt([w(!1)],t.prototype,"readonly",void 0),Bt([w("Default")],t.prototype,"type",void 0),Bt([Gt([{}],q_)],t.prototype,"colorRange",void 0),Bt([Ce({},W_)],t.prototype,"ticks",void 0),Bt([Ce({},Y_)],t.prototype,"limits",void 0),Bt([w(!0)],t.prototype,"enabled",void 0),Bt([Ce({},G_)],t.prototype,"tooltip",void 0),Bt([w(!1)],t.prototype,"showButtons",void 0),Bt([w(!0)],t.prototype,"enableAnimation",void 0),Bt([w("Horizontal")],t.prototype,"orientation",void 0),Bt([w("")],t.prototype,"cssClass",void 0),Bt([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Bt([G()],t.prototype,"created",void 0),Bt([G()],t.prototype,"change",void 0),Bt([G()],t.prototype,"changed",void 0),Bt([G()],t.prototype,"renderingTicks",void 0),Bt([G()],t.prototype,"renderedTicks",void 0),Bt([G()],t.prototype,"tooltipChange",void 0),t=Bt([It],t),t})(ti),K_=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Bn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Uu={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")},Wx=(function(o){return o[o.Message=0]="Message",o[o.Label=1]="Label",o})(Wx||{}),qx=(function(o){K_(t,o);function t(i,r){var n=o.call(this,r,i)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.localyMessage={},n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},typeof n.rules>"u"&&(n.rules={}),n.l10n=new Ri("formValidator",n.defaultMessages,n.locale),n.locale&&n.localeFunc(),ku.on("notifyExternalChange",n.afterLocalization,n),i=typeof i=="string"?J(i,document):i,n.element!=null)n.element.setAttribute("novalidate",""),n.inputElements=ze(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents();else return;return n}e=t,t.prototype.addRules=function(i,r){i&&(this.rules.hasOwnProperty(i)?pe(this.rules[""+i],r,{}):this.rules[""+i]=r)},t.prototype.removeRules=function(i,r){if(!i&&!r)this.rules={};else if(this.rules[""+i]&&!r)delete this.rules[""+i];else{if(g(this.rules[""+i]&&r))return;for(var n=0;n<r.length;n++)delete this.rules[""+i][r[parseInt(n.toString(),10)]]}},t.prototype.validate=function(i){var r=Object.keys(this.rules);if(i&&r.length)return this.validateRules(i),r.indexOf(i)!==-1&&this.errorRules.filter(function(l){return l.name===i}).length===0;this.errorRules=[];for(var n=0,s=r;n<s.length;n++){var a=s[n];this.validateRules(a)}return this.errorRules.length===0},t.prototype.reset=function(){this.element.reset(),this.clearForm()},t.prototype.getInputElement=function(i){return this.inputElement=J('[name="'+i+'"]',this.element),this.inputElement},t.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var i=ze("."+this.errorClass+", ."+this.validClass,this.element),r=0,n=i;r<n.length;r++){var s=n[r];se(s)}o.prototype.destroy.call(this),this.infoElement=null,ku.off("notifyExternalChange",this.afterLocalization)},t.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"locale":this.localeFunc();break}}},t.prototype.localeFunc=function(){for(var i=0,r=Object.keys(this.defaultMessages);i<r.length;i++){var n=r[i];this.l10n.setLocale(this.locale);var s=this.l10n.getConstant(n);this.localyMessage[""+n]=s}},t.prototype.getModuleName=function(){return"formvalidator"},t.prototype.afterLocalization=function(i){this.locale=i.locale,this.localeFunc()},t.prototype.refresh=function(){this.unwireEvents(),this.inputElements=ze(this.selectQuery,this.element),this.wireEvents()},t.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var i=ze(this.selectQuery,this.element),r=0,n=i;r<n.length;r++){var s=n[r],a=s;a.removeAttribute("aria-invalid");var l=a.parentElement,h=l.parentElement;l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||a.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.errorClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.errorClass):a.classList.remove(this.errorClass),a.name.length>0&&(this.getInputElement(a.name),this.getErrorElement(a.name),this.hideMessage(a.name)),l.classList.contains("e-control-wrapper")||l.classList.contains("e-wrapper")||a.classList.contains("e-input")&&l.classList.contains("e-input-group")?l.classList.remove(this.validClass):h!=null&&(h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper"))?h.classList.remove(this.validClass):a.classList.remove(this.validClass)}},t.prototype.createHTML5Rules=function(){for(var i=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],r=["hidden","email","url","date","number","tel"],n=0,s=this.inputElements;n<s.length;n++){for(var a=s[n],l={},h=0,c=i;h<c.length;h++){var u=c[h];if(a.getAttribute(u)!==null)switch(u){case"required":this.defRule(a,l,u,a.required);break;case"data-validation":u=a.getAttribute(u),this.defRule(a,l,u,!0);break;case"type":r.indexOf(a.type)!==-1&&this.defRule(a,l,a.type,!0);break;case"rangeLength":case"range":this.defRule(a,l,u,JSON.parse(a.getAttribute(u)));break;case"equalTo":{var d=a.getAttribute(u);this.defRule(a,l,u,d)}break;default:a.getAttribute("data-val")==="true"?this.annotationRule(a,l,u,a.getAttribute(u)):this.defRule(a,l,u,a.getAttribute(u))}}Object.keys(l).length!==0&&this.addRules(a.name,l)}},t.prototype.annotationRule=function(i,r,n,s){var a=n.split("-"),l=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],h=a[a.length-1],c=a[a.length-2];if(l.indexOf(h)!==-1)switch(h){case"required":this.defRule(i,r,"required",s);break;case"creditcard":this.defRule(i,r,"creditcard",s);break;case"phone":this.defRule(i,r,"tel",s);break}else if(l.indexOf(c)!==-1)switch(c){case"maxlength":this.defRule(i,r,"maxLength",s);break;case"minlength":this.defRule(i,r,"minLength",s);break;case"range":{var u=i.getAttribute("data-val-range-min"),d=i.getAttribute("data-val-range-max");this.defRule(i,r,"range",[u,d])}break;case"equalto":{var p=i.getAttribute(n).split(".");this.defRule(i,r,"equalTo",p[p.length-1])}break;case"regex":this.defRule(i,r,"regex",s);break}},t.prototype.defRule=function(i,r,n,s){var a=i.getAttribute("data-"+n+"-message"),l=i.getAttribute("data-val-"+n),h;this.rules[i.name]&&n!=="validateHidden"&&n!=="hidden"&&(this.getInputElement(i.name),h=this.getErrorMessage(this.rules[i.name][""+n],n)),a?s=[s,a]:l?s=[s,l]:h&&(s=[s,h]),r[""+n]=s},t.prototype.wireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];e.isCheckable(n)?T.add(n,"click",this.clickHandler,this):n.tagName==="SELECT"?T.add(n,"change",this.changeHandler,this):(T.add(n,"focusout",this.focusOutHandler,this),T.add(n,"keyup",this.keyUpHandler,this))}T.add(this.element,"submit",this.submitHandler,this),T.add(this.element,"reset",this.resetHandler,this)},t.prototype.unwireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];T.clearEvents(n)}T.remove(this.element,"submit",this.submitHandler),T.remove(this.element,"reset",this.resetHandler)},t.prototype.focusOutHandler=function(i){this.trigger("focusout",i);var r=i.target;this.rules[r.name]&&(this.rules[r.name][this.required]||r.value.length>0?this.validate(r.name):this.validated.indexOf(r.name)===-1&&this.validated.push(r.name))},t.prototype.keyUpHandler=function(i){this.trigger("keyup",i);var r=i.target,n=[16,17,18,20,35,36,37,38,39,40,45,144,225];i.which===9&&(!this.rules[r.name]||this.rules[r.name]&&!this.rules[r.name][this.required])||this.validated.indexOf(r.name)!==-1&&this.rules[r.name]&&n.indexOf(i.which)===-1&&this.validate(r.name)},t.prototype.clickHandler=function(i){this.trigger("click",i);var r=i.target;r.type!=="submit"?this.validate(r.name):r.getAttribute("formnovalidate")!==null&&(this.allowSubmit=!0)},t.prototype.changeHandler=function(i){this.trigger("change",i);var r=i.target;this.validate(r.name)},t.prototype.submitHandler=function(i){this.trigger("submit",i),!this.allowSubmit&&!this.validate()?i.preventDefault():this.allowSubmit=!1},t.prototype.resetHandler=function(){this.clearForm()},t.prototype.validateRules=function(i){if(this.rules[""+i]){var r=Object.keys(this.rules[""+i]),n=!1,s=!1,a=r.indexOf("validateHidden"),l=r.indexOf("hidden");if(this.getInputElement(i),l!==-1&&(n=!0),a!==-1&&(s=!0),!n||n&&s){a!==-1&&r.splice(a,1),l!==-1&&r.splice(l-1,1),this.getErrorElement(i);for(var h=0,c=r;h<c.length;h++){var u=c[h],d=this.getErrorMessage(this.rules[""+i][""+u],u),p={name:i,message:d},f={inputName:i,element:this.inputElement,message:d};if(!this.isValid(i,u)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(i),this.errorRules.push(p),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info");var v=this.inputElement.parentElement,m=v.parentElement;v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):m!=null&&(m.classList.contains("e-control-wrapper")||m.classList.contains("e-wrapper"))?(m.classList.add(this.errorClass),m.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.infoElement?this.showMessage(p):this.createErrorElement(i,p.message,this.inputElement),f.errorElement=this.infoElement,f.status="failure",v.classList.contains("e-control-wrapper")||v.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&v.classList.contains("e-input-group")?(v.classList.add(this.errorClass),v.classList.remove(this.validClass)):m!=null&&(m.classList.contains("e-control-wrapper")||m.classList.contains("e-wrapper"))?(m.classList.add(this.errorClass),m.classList.remove(this.validClass)):(this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass)),this.optionalValidationStatus(i,f),this.trigger("validationComplete",f),u==="required"&&this.inputElement.setAttribute("aria-required","true");break}else this.hideMessage(i),f.status="success",this.trigger("validationComplete",f)}}else return}},t.prototype.optionalValidationStatus=function(i,r){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!g(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),r.status="",this.hideMessage(i))},t.prototype.isValid=function(i,r){var n=this.rules[""+i][""+r],s=n instanceof Array&&typeof n[1]=="string"?n[0]:n,a=this.rules[""+i][""+r],l=(r==="min"||r==="max")&&this.rules[""+i].date&&typeof this.rules[""+i].date=="string"?this.rules[""+i].date:null,h={value:this.inputElement.value,param:s,element:this.inputElement,formElement:this.element,format:l,culture:this.locale};if(this.trigger("validationBegin",h),!h.param&&r==="required")return!0;if(a&&typeof a[0]=="function"){var c=a[0];return c.call(this,{element:this.inputElement,value:this.inputElement.value})}else return e.isCheckable(this.inputElement)?r!=="required"?!0:ze('input[name="'+i+'"]:checked',this.element).length>0:e.checkValidator[""+r](h)},t.prototype.getErrorMessage=function(i,r){var n=this.inputElement.getAttribute("data-"+r+"-message")?this.inputElement.getAttribute("data-"+r+"-message"):i instanceof Array&&typeof i[1]=="string"?i[1]:Object.keys(this.localyMessage).length!==0?this.localyMessage[""+r]:this.defaultMessages[""+r],s=n.match(/{(\d)}/g);if(!g(s))for(var a=0;a<s.length;a++){var l=i instanceof Array?i[parseInt(a.toString(),10)]:i;n=n.replace(s[parseInt(a.toString(),10)],l)}return n},t.prototype.createErrorElement=function(i,r,n){var s=et(this.errorElement,{className:this.errorClass,innerHTML:r,attrs:{for:i}});if(this.errorOption===Wx.Message&&(s.classList.remove(this.errorClass),s.classList.add("e-message"),s=et(this.errorContainer,{className:this.errorClass,innerHTML:s.outerHTML})),s.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+n.id+'"]'))this.element.querySelector('[data-valmsg-for="'+n.id+'"]').appendChild(s);else if(n.hasAttribute("data-msg-containerid")===!0){var a=n.getAttribute("data-msg-containerid"),l=J("#"+a,this.element);l.appendChild(s)}else if(this.customPlacement!=null)this.customPlacement.call(this,this.inputElement,s);else{var h=this.inputElement.parentElement,c=h.parentElement;h.classList.contains("e-control-wrapper")||h.classList.contains("e-wrapper")?c.insertBefore(s,h.nextSibling):c.classList.contains("e-control-wrapper")||c.classList.contains("e-wrapper")?c.parentElement.insertBefore(s,c.nextSibling):h.insertBefore(s,this.inputElement.nextSibling)}s.style.display="block",this.getErrorElement(i),this.validated.push(i),this.checkRequired(i)},t.prototype.getErrorElement=function(i){return this.infoElement=J(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=J(this.errorElement+"."+this.errorClass+'[for="'+i+'"]',this.element)),this.infoElement},t.prototype.removeErrorRules=function(i){for(var r=0;r<this.errorRules.length;r++){var n=this.errorRules[parseInt(r.toString(),10)];n.name===i&&this.errorRules.splice(r,1)}},t.prototype.showMessage=function(i){this.infoElement.style.display="block",this.infoElement.innerHTML=i.message,this.checkRequired(i.name)},t.prototype.hideMessage=function(i){if(this.infoElement){this.infoElement.style.display="none",this.removeErrorRules(i);var r=this.inputElement.parentElement,n=r.parentElement;r.classList.contains("e-control-wrapper")||r.classList.contains("e-wrapper")||this.inputElement.classList.contains("e-input")&&r.classList.contains("e-input-group")?(r.classList.add(this.validClass),r.classList.remove(this.errorClass)):n!=null&&(n.classList.contains("e-control-wrapper")||n.classList.contains("e-wrapper"))?(n.classList.add(this.validClass),n.classList.remove(this.errorClass)):(this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass)),this.inputElement.setAttribute("aria-invalid","false")}},t.prototype.checkRequired=function(i){!this.rules[""+i][this.required]&&!this.inputElement.value.length&&!g(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(i))},t.isCheckable=function(i){var r=i.getAttribute("type");return r&&(r==="checkbox"||r==="radio"||r==="submit")};var e;return t.checkValidator={required:function(i){return isNaN(Date.parse(i.value))?i.value.toString().length>0:!isNaN(new Date(i.value).getTime())},email:function(i){return Uu.EMAIL.test(i.value)},url:function(i){return Uu.URL.test(i.value)},dateIso:function(i){return Uu.DATE_ISO.test(i.value)},tel:function(i){return Uu.PHONE.test(i.value)},creditcard:function(i){return Uu.CREDITCARD.test(i.value)},number:function(i){return!isNaN(Number(i.value))&&String(i.value).indexOf(" ")===-1},digits:function(i){return Uu.DIGITS.test(i.value)},maxLength:function(i){return i.value.length<=Number(i.param)},minLength:function(i){return i.value.length>=Number(i.param)},rangeLength:function(i){var r=i.param;return i.value.length>=r[0]&&i.value.length<=r[1]},range:function(i){var r=i.param;return!isNaN(Number(i.value))&&Number(i.value)>=r[0]&&Number(i.value)<=r[1]},date:function(i){if(!g(i.param)&&typeof i.param=="string"&&i.param!==""){var r=i.culture&&i.culture!==""?new Nt(i.culture):new Nt,n={format:i.param.toString(),type:"dateTime",skeleton:"yMd"},s=r.parseDate(i.value,n);return!g(s)&&s instanceof Date&&!isNaN(+s)}else return!isNaN(new Date(i.value).getTime())},max:function(i){if(!isNaN(Number(i.value)))return+i.value<=+i.param;if(i.format&&i.format!==""){var r=i.culture&&i.culture!==""?new Nt(i.culture):new Nt,n={format:i.format.toString(),type:"dateTime",skeleton:"yMd"},s=r.parseDate(i.value,n),a=typeof i.param=="string"?r.parseDate(JSON.parse(JSON.stringify(i.param)),n):i.param;return new Date(s).getTime()<=new Date(a).getTime()}else return new Date(i.value).getTime()<=new Date(JSON.parse(JSON.stringify(i.param))).getTime()},min:function(i){if(isNaN(Number(i.value)))if(i.value.indexOf(",")!==-1){var r=i.value.replace(/,/g,"");return parseFloat(r)>=Number(i.param)}else if(i.format&&i.format!==""){var n=i.culture&&i.culture!==""?new Nt(i.culture):new Nt,s={format:i.format.toString(),type:"dateTime",skeleton:"yMd"},a=n.parseDate(i.value,s),l=typeof i.param=="string"?n.parseDate(JSON.parse(JSON.stringify(i.param)),s):i.param;return new Date(a).getTime()>=new Date(l).getTime()}else return new Date(i.value).getTime()>=new Date(JSON.parse(JSON.stringify(i.param))).getTime();else return+i.value>=+i.param},regex:function(i){return new RegExp(i.param).test(i.value)},equalTo:function(i){var r=i.formElement.querySelector("#"+i.param);return i.param=r.value,i.param===i.value}},Bn([w("")],t.prototype,"locale",void 0),Bn([w("e-hidden")],t.prototype,"ignore",void 0),Bn([w()],t.prototype,"rules",void 0),Bn([w("e-error")],t.prototype,"errorClass",void 0),Bn([w("e-valid")],t.prototype,"validClass",void 0),Bn([w("label")],t.prototype,"errorElement",void 0),Bn([w("div")],t.prototype,"errorContainer",void 0),Bn([w(Wx.Label)],t.prototype,"errorOption",void 0),Bn([G()],t.prototype,"focusout",void 0),Bn([G()],t.prototype,"keyup",void 0),Bn([G()],t.prototype,"click",void 0),Bn([G()],t.prototype,"change",void 0),Bn([G()],t.prototype,"submit",void 0),Bn([G()],t.prototype,"validationBegin",void 0),Bn([G()],t.prototype,"validationComplete",void 0),Bn([G()],t.prototype,"customPlacement",void 0),t=e=Bn([It],t),t})(pa);var $_=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Nr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},pf="e-apply",Pm="e-cancel",Px="e-current",Z_="e-container",ff="e-ctrl-btn",Wu="e-switch-ctrl-btn",xk="e-disabled",Ik="e-value-switch-btn",Mk="e-handler",Dk="e-hex",Bx="e-hide-hex-value",jx="e-hide-opacity",qu="e-hide-switchable-value",uc="e-hide-value",Ek="e-hide-valueswitcher",gf="e-hsv-color",Tk="e-hsv-container",Yu="e-selected-value",Bm="e-mode-switch-btn",Hx="e-nocolor-item",Vx="e-opacity-value",vf="e-palette",jm="e-color-palette",_x="e-color-picker",Hm="e-preview-container",Vm="e-previous",J_="e-rtl",Gu="e-show-value",mf="e-selected",_m="e-split-preview",Um="e-tile",eU={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},Wm=(function(o){$_(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.recentColors=[],r}return t.prototype.preRender=function(){var e=this.element;this.formElement=H(this.element,"form"),this.formElement&&T.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode",RecentColors:"Recent colors",CurrentColor:"Current",PreviousColor:"Previous"};this.l10n=new Ri("colorpicker",i,this.locale),e.getAttribute("ejs-for")&&!e.getAttribute("name")&&e.setAttribute("name",e.id)},t.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||X([this.container.parentElement],jx),this.renderComplete()},t.prototype.initWrapper=function(){var e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(e,this.element),e.appendChild(this.element),Ee(this.element,{tabindex:"-1",spellcheck:"false","aria-label":"colorpicker"}),this.container=this.createElement("div",{className:Z_}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var r=i.slice(0,7);g(this.initialInputValue)&&(this.initialInputValue=r),this.element.value=r,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:r},!0),this.enableRtl&&e.classList.add(J_),this.cssClass&&X([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.tileRipple=Wi(this.container,{selector:"."+Um}),this.ctrlBtnRipple=Wi(this.container,{selector:".e-btn"})},t.prototype.getWrapper=function(){return this.element.parentElement},t.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),j.isDevice&&this.refreshPopupPos()},t.prototype.createSplitBtn=function(){var e=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new uf({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){var l=new MouseEvent("click",{bubbles:!0,cancelable:!1});e.trigger("change",{currentValue:{hex:e.value.slice(0,7),rgba:e.convertToRgbString(e.hexToRgb(e.value))},previousValue:{hex:null,rgba:null},value:e.value,event:l})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i),this.splitBtn.element.setAttribute("aria-label","colorpicker");var r=this.createElement("span",{className:_m});J(".e-selected-color",i).appendChild(r),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(X([n],"e-colorpicker-popup"),this.cssClass){var s=this.cssClass.replace(/\s+/g," ").trim().split(" ");n&&X([n],s),this.splitBtn&&this.splitBtn.activeElem&&this.splitBtn.activeElem[0]&&X([this.splitBtn.activeElem[0]],s),this.splitBtn&&this.splitBtn.activeElem&&this.splitBtn.activeElem[1]&&X([this.splitBtn.activeElem[1]],s),this.splitBtn&&this.splitBtn.element&&this.splitBtn.element.parentElement&&X([this.splitBtn.element.parentElement],s)}if(j.isDevice&&!this.createPopupOnClick){var a=this.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,n.style.zIndex=Gs(this.splitBtn.element).toString()}this.bindCallBackEvent()},t.prototype.onOpen=function(){if(this.trigger("open",{element:this.container}),!j.isDevice){var e=this.getPopupInst(),i=gs(e.element);i.length>0&&(e.collision={X:"flip",Y:"fit"},e.position={X:"right",Y:"bottom"},e.targetType="container")}},t.prototype.getPopupInst=function(){return Cr(this.getPopupEle(),es)},t.prototype.bindCallBackEvent=function(){var e=this;this.splitBtn.beforeOpen=function(i){var r=new cf;return e.trigger("beforeOpen",i,function(n){if(!n.cancel){var s=e.getPopupEle();if(s.style.top=Ae(0+pageYOffset),s.style.left=Ae(0+pageXOffset),s.style.display="block",e.createWidget(),s.style.display="",j.isDevice){if(e.createPopupOnClick){var a=e.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,s.style.zIndex=Gs(e.splitBtn.element).toString()}e.modal=e.createElement("div"),e.modal.className="e-"+e.getModuleName()+" e-modal",e.modal.style.display="none",document.body.insertBefore(e.modal,s),document.body.className+=" e-colorpicker-overflow",e.modal.style.display="block",e.modal.style.zIndex=(Number(s.style.zIndex)-1).toString()}}i.cancel=n.cancel,r.resolve(n)}),r},this.splitBtn.beforeClose=function(i){var r=new cf;if(g(i.event))r.resolve(i);else{var n={element:e.container,event:i.event,cancel:!1};e.trigger("beforeClose",n,function(s){j.isDevice&&i.event.target===e.modal&&(s.cancel=!0),s.cancel||(e.onPopupClose(),i.event.type==="keydown"&&i.event.keyCode===27&&e.splitBtn.element.focus()),i.cancel=s.cancel,r.resolve(s)})}return r}},t.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",J("."+_m,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",Z([this.container],[_x,jm]),j.isDevice&&this.modal&&(Z([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},t.prototype.createPalette=function(){if(Ai(this.container,[jm],[_x]),this.presetColors){var e=this.createElement("div",{className:"e-custom-palette"});this.appendElement(e);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],e);else for(var r=0,n=i.length;r<n;r++)this.appendPalette(this.presetColors[i[r]],i[r],e);ze(".e-row",e).length>10&&X([e],"e-palette-group")}else this.appendPalette(eU.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor(),this.showRecentColors&&this.recentColors&&this.recentColors.length>0&&this.renderRecentColor();var s=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=Ae(this.container.children[0].offsetWidth+s+s),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},t.prototype.renderRecentColor=function(){var e=this,i=this.container.querySelector(".e-clr-pal-rec-wpr");i&&se(i);var r=this.createElement("div",{className:"e-clr-pal-rec-wpr"}),n=this.container.querySelector(".e-switch-ctrl-btn");n?this.container.insertBefore(r,n):this.container.appendChild(r);var s=this.createElement("label",{className:"e-recent-clr-span"});if(s.textContent=this.l10n.getConstant("RecentColors"),r.appendChild(s),this.recentColors.length>0){for(this.recentColors=this.recentColors.filter(function(a,l){return e.recentColors.indexOf(a)===l});this.recentColors.length>10;)this.recentColors.pop();this.appendPalette(this.recentColors,"recent-color",r)}},t.prototype.firstPaletteFocus=function(){J("."+mf,this.container.children[0])||ze("."+vf,this.container)[0].focus()},t.prototype.appendPalette=function(e,i,r){var n=this.createElement("div",{className:vf,attrs:{tabindex:"0",role:"grid"}});i==="recent-color"&&n.classList.add("e-recent-palette"),r?r.appendChild(n):this.appendElement(n);for(var s,a,l,h=0,c=e.length;h<c;h++)(h===0||h%this.columns===0)&&(s=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),n.appendChild(s)),l=this.roundValue(e[h]).toLowerCase(),a=this.createElement("span",{className:Um,attrs:{role:"gridcell","aria-label":l,"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:a,presetName:i,value:e[h]}),s.appendChild(a),this.value===l&&i!=="recent-color"&&(this.addTileSelection(a),n.focus()),a.style.backgroundColor=this.convertToRgbString(this.hexToRgb(l))},t.prototype.setNoColor=function(){var e=this.container.querySelector(".e-row").children[0];e.classList.add(Hx),this.value||(e.classList.add(mf),H(e,"."+vf).focus()),["aria-selected","aria-label"].forEach(function(i){e.removeAttribute(i)}),e.style.backgroundColor=""},t.prototype.appendElement=function(e,i){i===void 0&&(i=0);var r=this.container.children[i];r?this.container.insertBefore(e,r):this.container.appendChild(e)},t.prototype.addTileSelection=function(e){e&&(e.classList.add(mf),e.setAttribute("aria-selected","true"))},t.prototype.createPicker=function(){Ai(this.container,[_x],[jm]);var e=this.createElement("div",{className:Tk});this.appendElement(e),e.appendChild(this.createElement("div",{className:gf}));var i=this.createElement("span",{className:Mk,attrs:{tabindex:"0"}});e.appendChild(i),(this.value===null||this.value==="")&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},t.prototype.setHsvContainerBg=function(e){e===void 0&&(e=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(e,100,100,1))},t.prototype.getHsvContainer=function(){return J("."+Tk,this.container)},t.prototype.setHandlerPosition=function(){var e=this.getDragHandler(),i=J("."+gf,this.container);this.enableRtl?e.style.left=Ae((i.offsetWidth-e.offsetWidth/2.5)*Math.abs(100-this.hsv[1])/100):e.style.left=Ae((i.offsetWidth-e.offsetWidth/2.5)*this.hsv[1]/100),e.style.top=Ae((i.offsetHeight-e.offsetHeight/2.5)*(100-this.hsv[2])/100)},t.prototype.createSlider=function(){var e=this.createElement("div",{className:"e-slider-preview"});this.appendElement(e,1),this.createPreview(e);var i=this.createElement("div",{className:"e-colorpicker-slider"});e.insertBefore(i,e.children[0]);var r=this.createElement("div",{className:"e-hue-slider"});i.appendChild(r),this.hueSlider=new wk({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(r),this.enableOpacity&&(r=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(r),this.createOpacitySlider(r))},t.prototype.createOpacitySlider=function(e){this.opacitySlider=new wk({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(e);var i=this.createElement("div",{className:"e-opacity-empty-track"});e.appendChild(i),this.updateOpacitySliderBg()},t.prototype.updateOpacitySliderBg=function(){var e=this.enableRtl?"to left":"to right",i=J(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+e+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},t.prototype.hueChange=function(e){this.hsv[0]=e.value,this.setHsvContainerBg(),this.convertToOtherFormat()},t.prototype.opacityChange=function(e){var i=e.value,r=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var n=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(n,r,s)},t.prototype.updateOpacityInput=function(e){if(this.enableOpacity&&!this.getWrapper().classList.contains(uc)){var i=Cr(J("."+Vx,this.container),ba);i.value=e,i.dataBind()}},t.prototype.createPreview=function(e){var i=this.createElement("div",{className:Hm});e.appendChild(i);var r=this.createElement("span",{className:"e-preview "+Px,attrs:{title:this.l10n.getConstant("CurrentColor")}});i.appendChild(r);var n=this.convertToRgbString(this.rgb);r.style.backgroundColor=n,r=this.createElement("span",{className:"e-preview "+Vm,attrs:{title:this.l10n.getConstant("PreviousColor")}}),i.appendChild(r),r.style.backgroundColor=n},t.prototype.isPicker=function(){return!this.container.classList.contains(jm)},t.prototype.getPopupEle=function(){return this.container.parentElement},t.prototype.createNumericInput=function(e,i,r,n){var s=this,a=new ba({value:i,placeholder:r,min:0,max:n,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(l){l.event&&s.inputHandler(l.event)}});a.createElement=this.createElement,a.appendTo(e)},t.prototype.createInput=function(){var e=this.isPicker(),i=this.getWrapper();if(e&&!i.classList.contains(uc)||!e&&i.classList.contains(Gu)){var r=this.createElement("div",{className:Yu});e?this.appendElement(r,2):this.appendElement(r,1);var n=this.createElement("div",{className:"e-input-container"});if(r.appendChild(n),i.classList.contains(Ek)||this.appendValueSwitchBtn(r),!i.classList.contains(Bx)){var s=this.createElement("input",{className:Dk,attrs:{maxlength:"7",spellcheck:"false","aria-label":"HEX"}});n.appendChild(s),Ie.createInput({element:s,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),Ie.setValue(this.value.slice(0,7),s),s.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(qu)){var a=void 0,l=void 0;this.isRgb?(a="RGB",l=this.rgb):(a="HSV",l=this.hsv);for(var h=["rh","gs","bv"],c=0;c<3;c++)this.createNumericInput(n.appendChild(this.createElement("input",{className:"e-"+h[c]+"-value"})),l[c],a[c],255);this.enableOpacity&&this.appendOpacityValue(n)}}},t.prototype.appendOpacityValue=function(e){this.createNumericInput(e.appendChild(this.createElement("input",{className:Vx})),this.rgb[3]*100,"A",100)},t.prototype.appendValueSwitchBtn=function(e){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+Ik,attrs:{title:"Toggle format"}});e.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(qu)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},t.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var e=this.createElement("div",{className:Wu});if(this.container.appendChild(e),this.showButtons){var i=this.createElement("div",{className:ff});e.appendChild(i);var r=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-primary e-small "+pf,attrs:{title:r}}));var n=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-small "+Pm,attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},t.prototype.appendModeSwitchBtn=function(){var e=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Bm,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});J("."+Wu,this.container).insertBefore(e,J("."+ff,this.container))},t.prototype.createDragTooltip=function(){var e=this,i=new uh({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",htmlAttributes:{title:"tooltip"},beforeOpen:function(r){e.tooltipEle=r.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=Gs(this.tooltipEle).toString(),this.tooltipEle.setAttribute("aria-label","colorpicker-tooltip"),J(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},t.prototype.getTooltipInst=function(){return Cr(this.container,uh)},t.prototype.setTooltipOffset=function(e){this.getTooltipInst().offsetY=e},t.prototype.toggleDisabled=function(e){e?this.getWrapper().classList.add(xk):this.getWrapper().classList.remove(xk),this.showButtons&&[].slice.call(ze(".e-btn",this.container)).forEach(function(i){e?Ee(i,{disabled:""}):i.removeAttribute("disabled")})},t.prototype.convertToRgbString=function(e){return e.length?e.length===4?"rgba("+e.join()+")":"rgb("+e.join()+")":""},t.prototype.convertToHsvString=function(e){return e.length===4?"hsva("+e.join()+")":"hsv("+e.join()+")"},t.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},t.prototype.convertToOtherFormat=function(e,i){e===void 0&&(e=!1);var r=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var n=this.rgbToHex(this.rgb),s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.updateInput(n),this.triggerEvent(n,r,s,e,i)},t.prototype.updateInput=function(e){var i=this.getWrapper();i.classList.contains(uc)||(i.classList.contains(Bx)||Ie.setValue(e.substr(0,7),J("."+Dk,this.container)),i.classList.contains(qu)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},t.prototype.updatePreview=function(e){this.enableOpacity&&this.updateOpacitySliderBg(),J(".e-tip-transparent",this.tooltipEle).style.backgroundColor=e,J("."+Hm+" ."+Px,this.container).style.backgroundColor=e,J("."+Hm+" ."+Vm,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},t.prototype.getDragHandler=function(){return J("."+Mk,this.container)},t.prototype.removeTileSelection=function(){var e=[].slice.call(ze("."+mf,this.container));e.forEach(function(i){i.classList.remove(mf),i.setAttribute("aria-selected","false")})},t.prototype.convertRgbToNumberArray=function(e){return e.slice(e.indexOf("(")+1,e.indexOf(")")).split(",").map(function(i,r){return r!==3?parseInt(i,10):parseFloat(i)})},t.prototype.getValue=function(e,i){if(e||(e=this.value),i=i?i.toLowerCase():"hex",e[0]==="r"){var r=this.convertRgbToNumberArray(e);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,r.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"null"}else if(e[0]==="h"){var r=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(e));if(i==="rgba")return this.convertToRgbString(r);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="rgb"?this.convertToRgbString(r.slice(0,3)):"null"}else{e=this.roundValue(e);var s=this.hexToRgb(e);return(i==="rgb"||i==="hsv")&&(s=s.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(s):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,s)):i==="hex"?e.slice(0,7):i==="a"?s[3].toString():"null"}},t.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},t.prototype.getModuleName=function(){return"colorpicker"},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.wireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();T.add(e,"keydown",this.pickerKeyDown,this);var i=J("."+ff,this.container);i&&T.add(i,"keydown",this.ctrlBtnKeyDown,this),T.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),T.add(J("."+Vm,this.container),"click",this.previewHandler,this)}else T.add(this.container,"click",this.paletteClickHandler,this),T.add(this.container,"keydown",this.paletteKeyDown,this)},t.prototype.formResetHandler=function(){this.value=this.initialInputValue,Ee(this.element,{value:this.initialInputValue})},t.prototype.addCtrlSwitchEvent=function(){var e=J("."+Wu,this.container);e&&T.add(e,"click",this.btnClickHandler,this)},t.prototype.ctrlBtnKeyDown=function(e){if(e.keyCode===13){var i=J("."+pf,this.container);if(i){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}this.splitBtn.element.focus()}},t.prototype.pickerKeyDown=function(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:{e.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i)}}},t.prototype.enterKeyHandler=function(e){this.triggerChangeEvent(e),this.inline||this.splitBtn.element.focus()},t.prototype.closePopup=function(e){var i=this,r={element:this.container,event:e,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},t.prototype.triggerChangeEvent=function(e,i){var r=e.slice(0,7);this.trigger("change",{currentValue:{hex:r,rgba:this.convertToRgbString(this.rgb)},event:i,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?e:r}),this.showRecentColors&&(this.recentColors.unshift(r),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:r},!0),this.element.value=r||"#000000"},t.prototype.handlerDragPosition=function(e,i,r){r.preventDefault(),this.hsv[e]+=i*(r.ctrlKey?1:3),this.hsv[e]<0&&(this.hsv[e]=0),this.updateHsv(),this.convertToOtherFormat(!0,r)},t.prototype.handlerDown=function(e){e.preventDefault(),e.type==="mousedown"?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(!1,e),this.getDragHandler().focus(),T.add(document,"mousemove touchmove",this.handlerMove,this),T.add(document,"mouseup touchend",this.handlerEnd,this)},t.prototype.handlerMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i,r;e.type==="mousemove"?(i=Math.abs(e.pageX-pageXOffset),r=Math.abs(e.pageY-pageYOffset)):(i=Math.abs(e.changedTouches[0].pageX-pageXOffset),r=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,r);var n=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(!1,e),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-r)>8)&&(J("."+gf,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},t.prototype.setHsv=function(e,i){var r=J("."+gf,this.container),n=r.getBoundingClientRect();this.enableRtl?e=e>n.right?0:Math.abs(e-n.right):e=e>n.left?Math.abs(e-n.left):0,i=i>n.top?Math.abs(i-n.top):0,this.hsv[2]=Math.round(Number(100*(r.offsetHeight-Math.max(0,Math.min(r.offsetHeight,i-r.offsetTop)))/r.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(r.offsetWidth,e-r.offsetLeft))/r.offsetWidth)*10)/10},t.prototype.handlerEnd=function(e){e.type!=="touchend"&&e.preventDefault(),T.remove(document,"mousemove touchmove",this.handlerMove),T.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();J("."+gf,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(e)},t.prototype.btnClickHandler=function(e){var i=e.target;H(i,"."+Bm)?(e.stopPropagation(),this.switchToPalette()):(i.classList.contains(pf)||i.classList.contains(Pm))&&this.ctrlBtnClick(i,e)},t.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),se(J(".e-slider-preview",this.container)),this.getWrapper().classList.contains(uc)||Qe(J("."+Yu,this.container)),se(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},t.prototype.refreshImageEditorPopupPos=function(){if(j.isDevice){var e=this.getPopupEle();e.style.left=Ae(0+pageXOffset),e.style.top=Ae(0+pageYOffset);var i=document.querySelector("#"+this.element.parentElement.parentElement.id.split("-popup")[0]);i&&e.parentElement.ej2_instances[0].refreshPosition(i)}},t.prototype.refreshPopupPos=function(){if(!this.inline){var e=this.getPopupEle();e.style.left=Ae(0+pageXOffset),e.style.top=Ae(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},t.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},t.prototype.updateValue=function(e,i,r,n){for(var s=["e-rh-value","e-gs-value","e-bv-value"],a,l=0,h=s.length;l<h;l++)a=Cr(J("."+s[l],this.container),ba),a.value=Math.round(e[l]),i&&(a.placeholder=s[l].substr(r,1).toUpperCase(),a.max=n?n[l]:255),a.dataBind()},t.prototype.previewHandler=function(e){var i=e.target,r=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),s=this.rgbToHsv.apply(this,this.rgb);s[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:s[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(s[0]),this.enableOpacity&&s[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:s[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=s,this.setHandlerPosition(),this.updateInput(n),J("."+Hm+" ."+Px,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,r,this.convertToRgbString(this.rgb),!1,e)},t.prototype.paletteClickHandler=function(e){e.preventDefault();var i=e.target;if(i.classList.contains(Um)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(Hx))this.noColorTile();else{var r=i.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(r)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Gu)&&this.updateInput(r),this.triggerEvent(r,n,this.convertToRgbString(this.rgb),!1,e)}!this.inline&&!this.showButtons&&this.closePopup(e)}else H(i,"."+Bm)?this.switchToPicker():i.classList.contains(pf)||i.classList.contains(Pm)?this.ctrlBtnClick(i,e):this.getWrapper().classList.contains(Gu)&&H(i,"."+Ik)&&this.formatSwitchHandler()},t.prototype.noColorTile=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",e)},t.prototype.switchToPicker=function(){var e=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(ze("."+vf,this.container)).forEach(function(r){se(r)}),this.container.querySelector(".e-clr-pal-rec-wpr")&&se(this.container.querySelector(".e-clr-pal-rec-wpr")),e.classList.contains(Gu)&&se(J("."+Yu,this.container)),this.container.style.width="";var i=J(".e-custom-palette",this.container);this.presetColors&&Qe(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},t.prototype.ctrlBtnClick=function(e,i){if(e.classList.contains(pf)){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r,i)}if(!this.inline)this.closePopup(i),this.splitBtn.element.focus();else if(e.classList.contains(Pm)){var n={element:this.container,event:i,cancel:!1};this.trigger("beforeClose",n)}},t.prototype.paletteKeyDown=function(e){var i=e.target;if(i.classList.contains(vf)){var r,n,s=[].slice.call(ze("."+Um,i)),a=s.filter(function(h){return h.classList.contains("e-selected")}).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),a&&(!this.enableRtl&&s.indexOf(a)===s.length-1||this.enableRtl&&s.indexOf(a)===0)?n=this.enableRtl?s.length-1:0:n=a?this.tilePosition(s,a,this.enableRtl?-1:1):this.enableRtl?s.length-1:0,s[n]&&(r=s[n]),this.keySelectionChanges(r);break;case 37:e.preventDefault(),a&&(!this.enableRtl&&s.indexOf(a)===0||this.enableRtl&&s.indexOf(a)===s.length-1)?n=this.enableRtl?0:s.length-1:n=a?this.tilePosition(s,a,this.enableRtl?1:-1):this.enableRtl?0:s.length-1,s[n]&&(r=s[n]),this.keySelectionChanges(r);break;case 38:e.preventDefault(),n=a?this.tilePosition(s,a,-this.columns):0,r=s[n]?s[n]:s[n-this.columns],this.keySelectionChanges(r);break;case 40:e.preventDefault(),n=a?this.tilePosition(s,a,this.columns):s.length-1,s[n]||(n%=s.length,n+=s[s.length-1].parentElement.childElementCount),r=s[n],this.keySelectionChanges(r);break;case 13:if(e.preventDefault(),a){var l=a.getAttribute("aria-label");this.enterKeyHandler(l||"")}break}}},t.prototype.keySelectionChanges=function(e){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(Hx))this.noColorTile(!0);else{var i=e.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Gu)&&this.updateInput(i),this.triggerEvent(i,r,this.convertToRgbString(this.rgb),!0)}},t.prototype.tilePosition=function(e,i,r){e=Array.prototype.slice.call(e);var n=e.length,s=this.columns-e[n-1].parentElement.childElementCount,a=e.indexOf(i);return a+=r,a<0?a+=n+s:a%=n+s,a},t.prototype.inputHandler=function(e){var i=e.target;if(i.value.length){var r,n,s=J(".e-float-text",i.parentElement).textContent;switch(s){case"HEX":{var a="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(a=this.roundValue(i.value)),a.length===9)n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(a+a.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,i.value,e);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,e));break;case"G":this.rgb[1]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,e));break;case"B":this.rgb[2]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n,null,e));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,e));break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat(!1,e));break;case"A":this.opacitySlider.value=Number(i.value);break}}},t.prototype.inputValueChange=function(e,i,r,n){e[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:e[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(e[0])),this.hsv=e;var s=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(r||s);var a=this.convertToRgbString(this.rgb);this.updatePreview(a),this.triggerEvent(s,i,a,!1,n)},t.prototype.triggerEvent=function(e,i,r,n,s){n===void 0&&(n=!1);var a=e.slice(0,7);g(s)&&(s=new MouseEvent("click",{bubbles:!0,cancelable:!1})),!this.showButtons&&!n?(this.trigger("change",{currentValue:{hex:a,rgba:r},event:s,previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:e}),this.showRecentColors&&(this.recentColors.unshift(a),this.inline&&this.renderRecentColor()),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:a},!0),this.element.value=a||"#000000"):this.trigger("select",{currentValue:{hex:a,rgba:r},event:s,previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},t.prototype.destroy=function(){var e=this,i=this.getWrapper();o.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(r){e.element.removeAttribute(r)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&se(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),se(i)),this.container=null,this.formElement&&T.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.destroyOtherComp=function(){if(this.isPicker()){for(var e=H(this.hueSlider.element,".e-color-picker"),i=e.querySelectorAll(".e-numerictextbox"),r=0;r<i.length;r++)Cr(i[r],ba).destroy();this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var n=this.getTooltipInst();n.close(),n.destroy(),this.tooltipEle=null}},t.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},t.prototype.unWireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();T.remove(e,"keydown",this.pickerKeyDown);var i=J("."+ff,this.container);i&&T.remove(i,"keydown",this.ctrlBtnKeyDown),T.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&T.remove(J("."+Wu,this.container),"click",this.btnClickHandler),T.remove(J("."+Vm,this.container),"click",this.previewHandler)}else T.remove(this.container,"click",this.paletteClickHandler),T.remove(this.container,"keydown",this.paletteKeyDown)},t.prototype.roundValue=function(e){if(!e)return"";e[0]!=="#"&&(e="#"+e);var i=e.length;if(i===4&&(e+="f",i=5),i===5){for(var r="",n=1,s=e.length;n<s;n++)r+=e.charAt(n)+e.charAt(n);e="#"+r,i=9}return i===7&&(e+="ff"),e},t.prototype.hexToRgb=function(e){if(!e)return[];e=e.trim(),e.length!==9&&(e=this.roundValue(e));var i=Number((parseInt(e.slice(-2),16)/255).toFixed(2));e=e.slice(1,7);var r=parseInt(e,16),n=[];return n.push(r>>16&255),n.push(r>>8&255),n.push(r&255),n.push(i),n},t.prototype.rgbToHsv=function(e,i,r,n){if(this.rgb&&!this.rgb.length)return[];e/=255,i/=255,r/=255;var s=Math.max(e,i,r),a=Math.min(e,i,r),l,h=s,c=s-a,u=s===0?0:c/s;if(s===a)l=0;else{switch(s){case e:l=(i-r)/c+(i<r?6:0);break;case i:l=(r-e)/c+2;break;case r:l=(e-i)/c+4;break}l/=6}var d=[Math.round(l*360),Math.round(u*1e3)/10,Math.round(h*1e3)/10];return g(n)||d.push(n),d},t.prototype.hsvToRgb=function(e,i,r,n){var s,a,l;if(i/=100,r/=100,i===0)return s=a=l=r,[Math.round(s*255),Math.round(a*255),Math.round(l*255),n];e/=60;var h=Math.floor(e),c=e-h,u=r*(1-i),d=r*(1-i*c),p=r*(1-i*(1-c));switch(h){case 0:s=r,a=p,l=u;break;case 1:s=d,a=r,l=u;break;case 2:s=u,a=r,l=p;break;case 3:s=u,a=d,l=r;break;case 4:s=p,a=u,l=r;break;default:s=r,a=u,l=d}var f=[Math.round(s*255),Math.round(a*255),Math.round(l*255)];return g(n)||f.push(n),f},t.prototype.rgbToHex=function(e){return e.length?"#"+this.hex(e[0])+this.hex(e[1])+this.hex(e[2])+(g(e[3])?"":e[3]!==0?(Math.round(e[3]*255)+65536).toString(16).substr(-2):"00"):""},t.prototype.hex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype.changeModeSwitcherProp=function(e){var i=J("."+Wu,this.container);e?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?se(J("."+Bm,i)):Qe(i))},t.prototype.changeShowBtnProps=function(e){var i=J("."+Wu,this.container);e?(i&&Qe(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?se(J("."+ff,i)):Qe(i)},t.prototype.changeValueProp=function(e){if(this.isPicker())this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),se(H(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(e),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(e)+'"]');i&&this.addTileSelection(i)}},t.prototype.setInputEleProps=function(){Qe(J("."+Yu,this.container)),this.createInput()},t.prototype.changeDisabledProp=function(e){this.isPicker()&&(this.hueSlider.enabled=!e,this.opacitySlider.enabled=!e,this.setInputEleProps()),e?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},t.prototype.changeCssClassProps=function(e,i){var r=this.getWrapper(),n=this.getPopupEle();i&&(Z([r,n],i.split(" ")),this.splitBtn&&this.splitBtn.activeElem&&this.splitBtn.activeElem[0]&&this.splitBtn.activeElem[1]&&Z([this.splitBtn.activeElem[0],this.splitBtn.activeElem[1]],i.split(" ")),this.splitBtn&&this.splitBtn.element&&this.splitBtn.element.parentElement&&Z([this.splitBtn.element.parentElement],i.split(" "))),e&&(X([r,n],e.replace(/\s+/g," ").trim().split(" ")),this.splitBtn&&this.splitBtn.activeElem&&this.splitBtn.activeElem[0]&&this.splitBtn.activeElem[1]&&X([this.splitBtn.activeElem[0],this.splitBtn.activeElem[1]],e.replace(/\s+/g," ").trim().split(" ")),this.splitBtn&&this.splitBtn.element&&this.splitBtn.element.parentElement&&X([this.splitBtn.element.parentElement],e.replace(/\s+/g," ").trim().split(" ")))},t.prototype.changeRtlProps=function(e){e?X([this.getWrapper()],"e-rtl"):Z([this.getWrapper()],"e-rtl")},t.prototype.changePaletteProps=function(){se(this.container.children[0]),this.container.style.width="",this.createPalette()},t.prototype.changeOpacityProps=function(e){var i=this.getWrapper();e?(Z([this.container.parentElement],jx),this.createOpacitySlider(J(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(uc)&&!i.classList.contains(qu)&&this.appendOpacityValue(J(".e-input-container",this.container))):(X([this.container.parentElement],jx),this.opacitySlider.destroy(),Qe(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(uc)&&!i.classList.contains(qu)&&Qe(J("."+Vx,this.container).parentElement))},t.prototype.onPropertyChanged=function(e,i){var r=this;if(!g(e.value)){var n=this.roundValue(e.value);if(n.length===9){this.element.value=this.roundValue(n).slice(0,7);var s=this.splitBtn&&J("."+_m,this.splitBtn.element);s&&(s.style.backgroundColor=this.convertToRgbString(this.hexToRgb(e.value)))}else if(this.noColor&&this.mode==="Palette"&&this.value===""){var s=this.splitBtn&&J("."+_m,this.splitBtn.element);s.style.backgroundColor=""}else this.value=i.value}if(!this.inline&&g(e.inline)){var a=["disabled","enableRtl"];if(this.splitBtn.setProperties(Vu(e,a)),!this.isPopupOpen()){this.changeCssClassProps(e.cssClass,i.cssClass),this.changeRtlProps(e.enableRtl);return}}for(var l=function(p){switch(p){case"inline":e.inline?(h.getWrapper().appendChild(h.container),h.splitBtn.destroy(),se(h.element.nextElementSibling),h.container.children.length||h.createWidget()):(h.destroyOtherComp(),h.unWireEvents(),h.container.innerHTML="",h.createSplitBtn());break;case"cssClass":{h.changeCssClassProps(e.cssClass,i.cssClass);var f=e.cssClass.split(" ").concat(i.cssClass.split(" "));f=f.reduce(function(y,b){return y.indexOf(b)<0&&y.push(b),y},[]);var v=0;f.forEach(function(y){if(v===0&&(y===uc||y===Ek||y===Gu||y===Bx||y===qu)){var b=J("."+Yu,r.container);b&&Qe(J("."+Yu,r.container)),r.createInput(),v++}});break}case"enableRtl":h.isPicker()&&(h.hueSlider.enableRtl=e.enableRtl,h.enableOpacity&&(h.opacitySlider.enableRtl=e.enableRtl),h.setInputEleProps()),h.changeRtlProps(e.enableRtl);break;case"disabled":h.changeDisabledProp(e.disabled);break;case"value":h.value!==i.value&&h.changeValueProp(e.value);break;case"showButtons":h.changeShowBtnProps(e.showButtons);break;case"mode":e.mode==="Picker"?h.switchToPicker():h.switchToPalette();break;case"modeSwitcher":h.changeModeSwitcherProp(e.modeSwitcher);break;case"columns":case"presetColors":h.isPicker()||h.changePaletteProps();break;case"noColor":e.noColor?h.mode==="Palette"&&!h.modeSwitcher&&h.setNoColor():h.changePaletteProps();break;case"enableOpacity":h.changeOpacityProps(e.enableOpacity);break;case"showRecentColors":if(!e.showRecentColors){var m=h.container.querySelector(".e-clr-pal-rec-wpr");m&&se(m)}h.recentColors=[];break}},h=this,c=0,u=Object.keys(e);c<u.length;c++){var d=u[c];l(d)}},t.prototype.focusIn=function(){this.element.parentElement.focus()},Nr([w("#008000ff")],t.prototype,"value",void 0),Nr([w("")],t.prototype,"cssClass",void 0),Nr([w(!1)],t.prototype,"disabled",void 0),Nr([w("Picker")],t.prototype,"mode",void 0),Nr([w(!0)],t.prototype,"modeSwitcher",void 0),Nr([w(null)],t.prototype,"presetColors",void 0),Nr([w(!0)],t.prototype,"showButtons",void 0),Nr([w(10)],t.prototype,"columns",void 0),Nr([w(!1)],t.prototype,"inline",void 0),Nr([w(!1)],t.prototype,"noColor",void 0),Nr([w(!1)],t.prototype,"enablePersistence",void 0),Nr([w(!0)],t.prototype,"enableOpacity",void 0),Nr([w(!1)],t.prototype,"createPopupOnClick",void 0),Nr([w(!1)],t.prototype,"showRecentColors",void 0),Nr([G()],t.prototype,"select",void 0),Nr([G()],t.prototype,"change",void 0),Nr([G()],t.prototype,"beforeTileRender",void 0),Nr([G()],t.prototype,"beforeOpen",void 0),Nr([G()],t.prototype,"open",void 0),Nr([G()],t.prototype,"beforeClose",void 0),Nr([G()],t.prototype,"beforeModeSwitch",void 0),Nr([G()],t.prototype,"onModeSwitch",void 0),Nr([G()],t.prototype,"created",void 0),t=Nr([It],t),t})(ti),tU=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),dn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},iU="e-clear-icon-hide",dc=(function(o){tU(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.previousValue=null,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.textboxOptions=e,r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"floatLabelType":Ie.removeFloating(this.textboxWrapper),Ie.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":Ie.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":Ie.setWidth(e.width,this.textboxWrapper.container);break;case"value":{var a=this.isProtectedOnChange;this.isProtectedOnChange=!0,Ie.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=a,Ie.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(g(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&g(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttributesToElement(),this.updateHTMLAttributesToWrapper(),this.checkAttributes(!0),this.multiline&&!g(this.textarea)?Ie.validateInputType(this.textboxWrapper.container,this.textarea):Ie.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":Ie.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),Ie.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":Ie.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":Ie.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":Ie.setPlaceholder(this.placeholder,this.respectiveElement),Ie.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":Ie.updateCssClass(e.cssClass,i.cssClass,this.textboxWrapper.container);break;case"locale":this.globalize=new Nt(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ie.setPlaceholder(this.placeholder,this.respectiveElement);break}}},t.prototype.getModuleName=function(){return"textbox"},t.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=H(this.element,"form"),g(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var e=V("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(n,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,n==="name"&&this.element.removeAttribute("name")):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,it("ej2_instances",e,this.element)}this.updateHTMLAttributesToElement(),this.checkAttributes(!1),(g(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),(this.type==="text"||this.element.tagName==="INPUT"&&this.multiline&&this.isReact)&&this.element.setAttribute("role","textbox"),this.globalize=new Nt(this.locale);var s={placeholder:this.placeholder};if(this.l10n=new Ri("textbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",Lt("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",Lt("textarea"));for(var a=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;this.element.hasAttribute(n)&&Ux.indexOf(n)<0&&!(n==="id"||n==="type"||n==="e-mappinguid")&&(this.textarea.setAttribute(n,this.element.attributes[r].nodeValue),a.indexOf(n)<0&&(this.element.removeAttribute(n),r--))}}},t.prototype.checkAttributes=function(e){for(var i=e?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,n=i;r<n.length;r++){var s=n[r];if(!g(this.element.getAttribute(s)))switch(s){case"disabled":if(g(this.textboxOptions)||this.textboxOptions.enabled===void 0||e){var a=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:a},!e)}break;case"readonly":if(g(this.textboxOptions)||this.textboxOptions.readonly===void 0||e){var l=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(g(this.textboxOptions)||this.textboxOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"autocomplete":if(g(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||e){var h=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:h},!e)}break;case"value":(g(this.textboxOptions)||this.textboxOptions.value===void 0||e)&&this.element.value!==""&&this.setProperties({value:this.element.value},!e);break;case"type":(g(this.textboxOptions)||this.textboxOptions.type===void 0||e)&&this.setProperties({type:this.element.type},!e);break}}},t.prototype.render=function(){var e=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(e=Ie.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=Ie.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:e,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttributesToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),g(this.value)||(Ie.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),g(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!g(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,Ie.setWidth(this.width,this.textboxWrapper.container),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),!this.element.hasAttribute("aria-labelledby")&&!this.element.hasAttribute("placeholder")&&!this.element.hasAttribute("aria-label")&&this.element.setAttribute("aria-label","textbox"),this.renderComplete()},t.prototype.updateHTMLAttributesToWrapper=function(){Ie.updateHTMLAttributesToWrapper(this.htmlAttributes,this.textboxWrapper.container)},t.prototype.updateHTMLAttributesToElement=function(){Ie.updateHTMLAttributesToElement(this.htmlAttributes,this.respectiveElement?this.respectiveElement:this.multiline&&!g(this.textarea)?this.textarea:this.element)},t.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},t.prototype.wireEvents=function(){T.add(this.respectiveElement,"focus",this.focusHandler,this),T.add(this.respectiveElement,"blur",this.focusOutHandler,this),T.add(this.respectiveElement,"keydown",this.keydownHandler,this),T.add(this.respectiveElement,"input",this.inputHandler,this),T.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&T.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!g(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&T.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},t.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var e=this.textboxWrapper.container.querySelector(".e-float-text");g(e)||(e.classList.add("e-label-top"),e.classList.contains("e-label-bottom")&&e.classList.remove("e-label-bottom"))},t.prototype.resetValue=function(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=e,e==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&!(this.floatLabelType==="Always"&&this.textboxWrapper.container.classList.contains("e-outline"))&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},t.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!g(this.textboxWrapper)){var e=this.textboxWrapper.container.querySelector(".e-float-text");!g(e)&&this.floatLabelType!=="Always"&&(g(this.initialValue)||this.initialValue===""?(e.classList.add("e-label-bottom"),e.classList.remove("e-label-top")):this.initialValue!==""&&(e.classList.add("e-label-top"),e.classList.remove("e-label-bottom")))}},t.prototype.focusHandler=function(e){var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("focus",i)},t.prototype.focusOutHandler=function(e){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(e,!0);var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("blur",i)},t.prototype.keydownHandler=function(e){(e.keyCode===13||e.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},t.prototype.inputHandler=function(e){var i=this,r={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),e.stopPropagation()},t.prototype.changeHandler=function(e){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!==this.value&&this.raiseChangeEvent(e,!0),e.stopPropagation()},t.prototype.raiseChangeEvent=function(e,i){var r={event:e,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&j.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},t.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?T.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):T.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},t.prototype.resetInputHandler=function(e){if(e.preventDefault(),!this.textboxWrapper.clearButton.classList.contains(iU)||this.textboxWrapper.container.classList.contains("e-static-clear")){Ie.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(e,!0),H(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}}},t.prototype.unWireEvents=function(){T.remove(this.respectiveElement,"focus",this.focusHandler),T.remove(this.respectiveElement,"blur",this.focusOutHandler),T.remove(this.respectiveElement,"keydown",this.keydownHandler),T.remove(this.respectiveElement,"input",this.inputHandler),T.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&T.remove(this.formElement,"reset",this.resetForm),!g(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&T.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},t.prototype.destroy=function(){this.unWireEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.element.tagName==="INPUT"&&this.multiline&&(se(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),g(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),se(this.textboxWrapper.container)),this.textboxWrapper=null,Ie.destroy({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},t.prototype.addIcon=function(e,i){Ie.addIcon(e,i,this.textboxWrapper.container,this.respectiveElement,this.createElement);var r=this.textboxWrapper.container,n=r.querySelector("span.e-icons"),s=r.querySelector("label");if(n&&s){var a=this.element.parentElement.offsetWidth-n.offsetWidth;s.style.width=a+"px"}},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.addAttributes=function(e){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!1},!0),Ie.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!0},!0),Ie.setReadonly(this.readonly,this.respectiveElement)):n==="class"?this.respectiveElement.classList.add(e[""+n]):n==="placeholder"?(this.setProperties({placeholder:e[""+n]},!0),Ie.setPlaceholder(this.placeholder,this.respectiveElement)):n==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(n,e[""+n]):this.respectiveElement.setAttribute(n,e[""+n])}},t.prototype.removeAttributes=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!0},!0),Ie.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!1},!0),Ie.setReadonly(this.readonly,this.respectiveElement)):n==="placeholder"?(this.setProperties({placeholder:null},!0),Ie.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(n)}},t.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&X([this.textboxWrapper.container],[mk]))},t.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&Z([this.textboxWrapper.container],[mk]))},dn([w("text")],t.prototype,"type",void 0),dn([w(!1)],t.prototype,"readonly",void 0),dn([w(null)],t.prototype,"value",void 0),dn([w("Never")],t.prototype,"floatLabelType",void 0),dn([w("")],t.prototype,"cssClass",void 0),dn([w(null)],t.prototype,"placeholder",void 0),dn([w("on")],t.prototype,"autocomplete",void 0),dn([w({})],t.prototype,"htmlAttributes",void 0),dn([w(!1)],t.prototype,"multiline",void 0),dn([w(!0)],t.prototype,"enabled",void 0),dn([w(!1)],t.prototype,"showClearButton",void 0),dn([w(!1)],t.prototype,"enablePersistence",void 0),dn([w(null)],t.prototype,"width",void 0),dn([G()],t.prototype,"created",void 0),dn([G()],t.prototype,"destroyed",void 0),dn([G()],t.prototype,"change",void 0),dn([G()],t.prototype,"blur",void 0),dn([G()],t.prototype,"focus",void 0),dn([G()],t.prototype,"input",void 0),t=dn([It],t),t})(ti);var rU=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Ak=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},nU="e-hscroll",ph="e-rtl",fh="e-overlay",sU="e-hscroll-bar",aU="e-hscroll-content",bf="e-nav-arrow",Sf="e-nav-right-arrow",qm="e-nav-left-arrow",pc="e-scroll-nav",Yx="e-scroll-right-nav",Lk="e-scroll-left-nav",Nk="e-scroll-device",Ym="e-scroll-overlay",Gx="e-scroll-right-overlay",Qx="e-scroll-left-overlay",kk=40,yy=(function(o){rU(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=j.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=j.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=Lt("hscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add(ph)},t.prototype.render=function(){this.touchModule=new jr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),T.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add(Nk),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},t.prototype.setScrollState=function(){g(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=this.createElement("div",{className:aU}),i=this.createElement("div",{className:sU});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,a=n;s<a.length;s++){var l=a[s];e.appendChild(l)}i.appendChild(e),r.appendChild(i),i.style.overflowX="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"hScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",e.classList.remove(nU),e.classList.remove(Nk),e.classList.remove(ph);var i=ze(".e-"+e.id+"_nav."+pc,e),r=ze("."+Ym,e);[].slice.call(r).forEach(function(l){se(l)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var a=s[n];e.appendChild(a)}this.uniqueId&&this.element.removeAttribute("id"),se(this.scrollEle),i.length>0&&(se(i[0]),g(i[1])||se(i[1])),T.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=ze(".e-scroll-nav:not(."+fh+")",this.element);e?this.element.classList.add(fh):this.element.classList.remove(fh),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlay=function(e){var i=e.id.concat("_nav"),r=this.createElement("div",{className:Ym+" "+Gx}),n="e-"+e.id.concat("_nav "+pc+" "+Yx),s=this.createElement("div",{id:i.concat("_right"),className:n}),a=this.createElement("div",{className:Sf+" "+bf+" e-icons"});s.appendChild(a);var l=this.createElement("div",{className:Ym+" "+Qx});this.ieCheck&&s.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(s),e.insertBefore(l,e.firstChild),this.eventBinding([s])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+pc+" "+Yx),n={role:"button",id:i.concat("_right"),"aria-label":"Scroll right"},s=this.createElement("div",{className:r,attrs:n});s.setAttribute("aria-disabled","false");var a=this.createElement("div",{className:Sf+" "+bf+" e-icons"}),l="e-"+e.id.concat("_nav "+pc+" "+Lk),h={role:"button",id:i.concat("_left"),"aria-label":"Scroll left"},c=this.createElement("div",{className:l+" "+fh,attrs:h});c.setAttribute("aria-disabled","true");var u=this.createElement("div",{className:qm+" "+bf+" e-icons"});c.appendChild(u),s.appendChild(a),e.appendChild(s),e.insertBefore(c,e.firstChild),this.ieCheck&&(s.classList.add("e-ie-align"),c.classList.add("e-ie-align")),this.eventBinding([s,c])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new jr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),T.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,pc)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var n=this.element,s=i.classList;s.contains(pc)&&(s=i.querySelector("."+bf).classList),this.contains(n,ph)&&this.browserCheck&&(e=-e),!this.contains(n,ph)||this.browserCheck||this.ieCheck?s.contains(Sf)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r):s.contains(qm)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceX/(e.velocity*10):r=e.distanceX/e.velocity;var n=.5,s=function(){var a=Math.sin(n);a<=0?window.cancelAnimationFrame(a):(e.swipeDirection==="Left"?i.scrollLeft+=r*a:e.swipeDirection==="Right"&&(i.scrollLeft-=r*a),n-=.5,window.requestAnimationFrame(s))};s()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollLeft+=e:this.scrollEle.scrollLeft-=e,this.enableRtl&&this.scrollEle.scrollLeft>0&&(this.scrollEle.scrollLeft=0)},t.prototype.frameScrollRequest=function(e,i,r){var n=this,s=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call(ze("."+Ym,this.element)).forEach(function(l){e-=l.offsetWidth});var a=function(){var l,h;n.contains(n.element,ph)&&n.browserCheck?(l=-e,h=-s):(l=e,h=s),l<s?window.cancelAnimationFrame(h):(n.scrollUpdating(h,i),e-=h,window.requestAnimationFrame(a))};a()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceX;this.ieCheck&&this.contains(this.element,ph)&&(r=-r),e.scrollDirection==="Left"?i.scrollLeft=i.scrollLeft+r:e.scrollDirection==="Right"&&(i.scrollLeft=i.scrollLeft-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=g(e)?i:e,n=r.querySelector("."+bf);g(e)?Ai(n,[Sf],[qm]):Ai(n,[qm],[Sf])}else e&&i&&(e.classList.add(fh),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(fh),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0"));this.repeatScroll()},t.prototype.scrollHandler=function(e){var i=e.target,r=i.offsetWidth,n=this.element,s=this.element.querySelector("."+Lk),a=this.element.querySelector("."+Yx),l=this.element.querySelector("."+Qx),h=this.element.querySelector("."+Gx),c=i.scrollLeft;if(c<=0&&(c=-c),this.isDevice&&(this.enableRtl&&!(this.browserCheck||this.ieCheck)&&(l=this.element.querySelector("."+Gx),h=this.element.querySelector("."+Qx)),c<kk?l.style.width=c+"px":l.style.width="40px",i.scrollWidth-Math.ceil(r+c)<kk?h.style.width=i.scrollWidth-Math.ceil(r+c)+"px":h.style.width="40px"),c===0)this.arrowDisabling(s,a);else if(Math.ceil(r+c+.1)>=i.scrollWidth)this.arrowDisabling(a,s);else{var u=this.element.querySelector("."+pc+"."+fh);u&&(u.classList.remove(fh),u.setAttribute("aria-disabled","false"),u.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add(ph):this.element.classList.remove(ph);break}}},Ak([w(null)],t.prototype,"scrollStep",void 0),t=Ak([It],t),t})(ti),oU=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Fk=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},lU="e-vscroll",Gm="e-rtl",gh="e-overlay",hU="e-vscroll-bar",cU="e-vscroll-content",Cf="e-nav-arrow",Qm="e-nav-up-arrow",wf="e-nav-down-arrow",fc="e-scroll-nav",Rk="e-scroll-up-nav",Xx="e-scroll-down-nav",Ok="e-scroll-device",Xm="e-scroll-overlay",zk="e-scroll-up-overlay",Pk="e-scroll-down-overlay",Bk=40,wl=(function(o){oU(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=j.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=j.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=Lt("vscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add(Gm)},t.prototype.render=function(){this.touchModule=new jr(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),T.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add(Ok),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),T.add(this.element,"wheel",this.wheelEventHandler,this)},t.prototype.setScrollState=function(){g(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=et("div",{className:cU}),i=et("div",{className:hU});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,a=n;s<a.length;s++){var l=a[s];e.appendChild(l)}i.appendChild(e),r.appendChild(i),i.style.overflow="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"vScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",Z([this.element],[lU,Ok,Gm]);var i=ze(".e-"+e.id+"_nav."+fc,e),r=ze("."+Xm,e);[].slice.call(r).forEach(function(l){se(l)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var a=s[n];e.appendChild(a)}this.uniqueId&&this.element.removeAttribute("id"),se(this.scrollEle),i.length>0&&(se(i[0]),g(i[1])||se(i[1])),T.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=ze(".e-scroll-nav:not(."+gh+")",this.element);e?this.element.classList.add(gh):this.element.classList.remove(gh),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlayElement=function(e){var i=e.id.concat("_nav"),r=et("div",{className:Xm+" "+Pk}),n="e-"+e.id.concat("_nav "+fc+" "+Xx),s=et("div",{id:i.concat("down"),className:n}),a=et("div",{className:wf+" "+Cf+" e-icons"});s.appendChild(a);var l=et("div",{className:Xm+" "+zk});this.ieCheck&&s.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(s),e.insertBefore(l,e.firstChild),this.eventBinding([s])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+fc+" "+Xx),n=et("div",{id:i.concat("_down"),className:r});n.setAttribute("aria-disabled","false");var s=et("div",{className:wf+" "+Cf+" e-icons"}),a="e-"+e.id.concat("_nav "+fc+" "+Rk),l=et("div",{id:i.concat("_up"),className:a+" "+gh});l.setAttribute("aria-disabled","true");var h=et("div",{className:Qm+" "+Cf+" e-icons"});l.appendChild(h),n.appendChild(s),n.setAttribute("tabindex","0"),e.appendChild(n),e.insertBefore(l,e.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),l.classList.add("e-ie-align")),this.eventBinding([n,l])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new jr(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),T.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,fc)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var n=i.classList;n.contains(fc)&&(n=i.querySelector("."+Cf).classList),n.contains(wf)?this.frameScrollRequest(e,"add",r):n.contains(Qm)&&this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.wheelEventHandler=function(e){e.preventDefault(),this.frameScrollRequest(this.scrollStep,e.deltaY>0?"add":"",!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceY/(e.velocity*10):r=e.distanceY/e.velocity;var n=.5,s=function(){var a=Math.sin(n);a<=0?window.cancelAnimationFrame(a):(e.swipeDirection==="Up"?i.scrollTop+=r*a:e.swipeDirection==="Down"&&(i.scrollTop-=r*a),n-=.02,window.requestAnimationFrame(s))};s()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollTop+=e:this.scrollEle.scrollTop-=e},t.prototype.frameScrollRequest=function(e,i,r){var n=this,s=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call(ze("."+Xm,this.element)).forEach(function(l){e-=l.offsetHeight});var a=function(){e<s?window.cancelAnimationFrame(s):(n.scrollUpdating(s,i),e-=s,window.requestAnimationFrame(a))};a()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceY;e.scrollDirection==="Up"?i.scrollTop=i.scrollTop+r:e.scrollDirection==="Down"&&(i.scrollTop=i.scrollTop-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=g(e)?i:e,n=r.querySelector("."+Cf);g(e)?Ai(n,[wf],[Qm]):Ai(n,[Qm],[wf])}else e.classList.add(gh),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(gh),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollEventHandler=function(e){var i=e.target,r=i.offsetHeight,n=this.element.querySelector("."+Rk),s=this.element.querySelector("."+Xx),a=this.element.querySelector("."+zk),l=this.element.querySelector("."+Pk),h=i.scrollTop;if(h<=0&&(h=-h),this.isDevice&&(h<Bk?a.style.height=h+"px":a.style.height="40px",i.scrollHeight-Math.ceil(r+h)<Bk?l.style.height=i.scrollHeight-Math.ceil(r+h)+"px":l.style.height="40px"),h===0)this.arrowDisabling(n,s);else if(Math.ceil(r+h+.1)>=i.scrollHeight)this.arrowDisabling(s,n);else{var c=this.element.querySelector("."+fc+"."+gh);c&&(c.classList.remove(gh),c.setAttribute("aria-disabled","false"),c.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add(Gm):this.element.classList.remove(Gm);break}}},Fk([w(null)],t.prototype,"scrollStep",void 0),t=Fk([It],t),t})(ti);function No(o,t,e,i,r,n){var s,a,l=t.parentElement;if(i==="vscroll"?(s=n||t.getBoundingClientRect().height,a=e.getBoundingClientRect().height):(s=t.getBoundingClientRect().width,a=e.getBoundingClientRect().width),s<a)return jk(o,t,e,i,r,n);if(l){var h=l.getBoundingClientRect().width;return h<s&&i==="hscroll"?(a=h,t.style.maxWidth=h+"px",jk(o,t,e,i,r,n)):e}else return e}function jk(o,t,e,i,r,n){var s=o("div",{className:"e-menu-"+i});t.appendChild(s),s.appendChild(e),n?(s.style.overflow="hidden",s.style.height=n+"px"):(s.style.maxHeight=t.style.maxHeight,t.style.overflow="hidden");var a;return i==="vscroll"?(a=new wl({enableRtl:r},s),a.scrollStep=J(".e-"+i+"-bar",t).offsetHeight/2):(a=new yy({enableRtl:r},s),a.scrollStep=J(".e-"+i+"-bar",t).offsetWidth),s}function gl(o,t,e){if(o){var i=J(".e-menu-parent",t);i?(!e||e===i)&&(o.destroy(),t.parentElement.appendChild(i),se(t)):(o.destroy(),se(t))}}var by=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),fi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Km="enter",Kx="escape",kr="e-focused",$m="e-menu-header",nr="e-selected",xf="e-separator",Qu="uparrow",to="downarrow",gc="leftarrow",vl="rightarrow",Xu="home",Zm="end",Jm="tab",$x="e-caret",Ku="e-menu-item",Zx="e-disabled",ey="e-menu-hide",Jx="e-icons",eI="e-rtl",$u="e-menu-popup",uU="Template",fF=(function(o){by(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return fi([w("id")],t.prototype,"itemId",void 0),fi([w("parentId")],t.prototype,"parentId",void 0),fi([w("text")],t.prototype,"text",void 0),fi([w("iconCss")],t.prototype,"iconCss",void 0),fi([w("url")],t.prototype,"url",void 0),fi([w("separator")],t.prototype,"separator",void 0),fi([w("items")],t.prototype,"children",void 0),t})(Oe),td=(function(o){by(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return fi([w(null)],t.prototype,"iconCss",void 0),fi([w("")],t.prototype,"id",void 0),fi([w(!1)],t.prototype,"separator",void 0),fi([Gt([],t)],t.prototype,"items",void 0),fi([w("")],t.prototype,"text",void 0),fi([w("")],t.prototype,"url",void 0),fi([w()],t.prototype,"htmlAttributes",void 0),t})(Oe),dU=(function(o){by(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return fi([w("SlideDown")],t.prototype,"effect",void 0),fi([w(400)],t.prototype,"duration",void 0),fi([w("ease")],t.prototype,"easing",void 0),t})(Oe),gF=(function(o){by(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.navIdx=[],r.animation=new Mt({}),r.isTapHold=!1,r.tempItem=[],r.showSubMenuOn="Auto",r.isAnimationNone=!1,r.isKBDAction=!1,r}return t.prototype.preRender=function(){if(!this.isMenu){var e=void 0;if(this.element.tagName==="EJS-CONTEXTMENU"){e=this.createElement("ul",{id:Lt(this.getModuleName()),className:"e-control e-lib e-"+this.getModuleName()});var i=V("ej2_instances",this.element);Z([this.element],["e-control","e-lib","e-"+this.getModuleName()]),this.clonedElement=this.element,this.element=e,it("ej2_instances",i,this.element)}else{e=this.createElement("ul",{id:Lt(this.getModuleName())}),bt([].slice.call(this.element.cloneNode(!0).children),e);var r=this.element.nextElementSibling;r?this.element.parentElement.insertBefore(e,r):this.element.parentElement.appendChild(e),this.clonedElement=e}this.clonedElement.style.display="none"}if(this.element.tagName==="EJS-MENU"){for(var n=this.element,s=V("ej2_instances",n),e=this.createElement("ul"),a=this.createElement("EJS-MENU",{className:"e-"+this.getModuleName()+"-wrapper"}),l=0,h=n.attributes.length;l<h;l++)e.setAttribute(n.attributes[l].nodeName,n.attributes[l].nodeValue);n.parentNode.insertBefore(a,n),se(n),n=e,a.appendChild(n),it("ej2_instances",s,n),this.clonedElement=a,this.element=n,this.element.id||(this.element.id=Lt(this.getModuleName()))}},t.prototype.render=function(){var e=this;this.initialize(),this.renderItems(),this.wireEvents(),this.renderComplete();var i=this.getWrapper();this.template&&this.enableScrolling&&(this.isReact||this.isAngular)&&requestAnimationFrame(function(){No(e.createElement,i,e.element,"hscroll",e.enableRtl)})},t.prototype.enableTouchScroll=function(e){var i=0;this.touchStartFn=function(r){i=r.touches[0].clientY},this.touchMoveFn=function(r){var n=r.touches[0].clientY,s=i-n,a=e.scrollTop===0,l=e.scrollTop+e.clientHeight===e.scrollHeight;(a&&s<0||l&&s>0)&&r.preventDefault(),i=n},e.addEventListener("touchstart",this.touchStartFn,{passive:!1}),e.addEventListener("touchmove",this.touchMoveFn,{passive:!1})},t.prototype.touchOutsideHandler=function(e){var i=e.target;H(i,".e-"+this.getModuleName()+"-wrapper")||this.closeMenu()},t.prototype.initialize=function(){var e=this.getWrapper();e||(e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.isMenu?this.element.parentElement.insertBefore(e,this.element):document.body.appendChild(e)),this.cssClass&&X([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.enableRtl&&e.classList.add(eI),e.appendChild(this.element),this.isMenu&&this.hamburgerMode&&(this.target||this.createHeaderContainer(e)),this.defaultOption=this.showItemOnClick},t.prototype.renderItems=function(){if(!this.items.length){var e=kt.createJsonFromElement(this.element,{fields:{child:"items"}});this.setProperties({items:e},!0),$e()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML=""}var i=this.createItems(this.items);if(bt(Array.prototype.slice.call(i.children),this.element),this.element.classList.add("e-menu-parent"),this.isMenu){if(!this.hamburgerMode&&this.element.classList.contains("e-vertical")&&this.setBlankIconStyle(this.element),this.enableScrolling){var r=this.getWrapper();this.element.classList.contains("e-vertical")?No(this.createElement,r,this.element,"vscroll",this.enableRtl):No(this.createElement,r,this.element,"hscroll",this.enableRtl)}}else this.element.parentElement.setAttribute("role","dialog"),this.element.parentElement.setAttribute("aria-label","context menu")},t.prototype.wireEvents=function(){var e=this.getWrapper();if(this.target){for(var i=void 0,r=ze(this.target),n=0,s=r.length;n<s;n++)i=r[n],this.isMenu?T.add(i,"click",this.menuHeaderClickHandler,this):j.isIos?new jr(i,{tapHold:this.touchHandler.bind(this)}):T.add(i,"contextmenu",this.cmenuHandler,this);if(this.targetElement=i,!this.isMenu){T.add(this.targetElement,"scroll",this.scrollHandler,this);for(var a=0,l=Fm(this.targetElement);a<l.length;a++){var h=l[a];T.add(h,"scroll",this.scrollHandler,this)}}}j.isDevice||(this.delegateMoverHandler=this.moverHandler.bind(this),this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),T.add(this.isMenu?document:e,"mouseover",this.delegateMoverHandler,this),T.add(document,"mousedown",this.delegateMouseDownHandler,this),T.add(document,"keydown",this.domKeyHandler,this),!this.isMenu&&!this.target&&T.add(document,"scroll",this.scrollHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),T.add(document,"click",this.delegateClickHandler,this),this.wireKeyboardEvent(e),this.rippleFn=Wi(e,{selector:"."+Ku}),!this.isMenu&&this.enableScrolling&&(this.enableTouchScroll(e),document.addEventListener("touchstart",this.touchOutsideHandler.bind(this),{passive:!0}))},t.prototype.wireKeyboardEvent=function(e){var i={downarrow:to,uparrow:Qu,enter:Km,leftarrow:gc,rightarrow:vl,escape:Kx};this.isMenu&&(i.home=Xu,i.end=Zm,i.tab=Jm),new rr(e,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:i})},t.prototype.mouseDownHandler=function(e){H(e.target,".e-"+this.getModuleName()+"-wrapper")!==this.getWrapper()&&!H(e.target,".e-"+this.getModuleName()+"-popup")&&this.closeMenu(this.isMenu?null:this.navIdx.length,e)},t.prototype.keyHandler=function(e){(e.keyCode===38||e.keyCode===40)&&e.target&&(e.target.classList.contains("e-contextmenu")||e.target.classList.contains("e-menu-item"))&&e.preventDefault()},t.prototype.domKeyHandler=function(e){e.keyCode===27&&(this.isMenuVisible()&&e.stopImmediatePropagation(),e.action=Kx,this.leftEscKeyHandler(e))},t.prototype.keyBoardHandler=function(e){var i="",r=e.target,n=this.isMenu&&!this.hamburgerMode&&!this.element.classList.contains("e-vertical")&&this.navIdx.length<1;if(e.preventDefault(),this.enableScrolling&&e.keyCode===13&&r.classList.contains("e-scroll-nav")&&this.removeLIStateByClass([kr,nr],[H(r,".e-"+this.getModuleName()+"-wrapper")]),this.isKBDAction=!0,n)switch(e.action){case vl:i=vl,e.action=to;break;case gc:i=gc,e.action=Qu;break;case to:i=to,e.action=vl;break;case Qu:i=Qu,e.action="";break}else if(this.enableRtl)switch(e.action){case gc:n=!0,i=gc,e.action=vl;break;case vl:n=!0,i=vl,e.action=gc;break}switch(e.action){case to:case Qu:case Zm:case Xu:case Jm:this.upDownKeyHandler(e);break;case vl:this.rightEnterKeyHandler(e);break;case gc:this.leftEscKeyHandler(e);break;case Km:this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):this.rightEnterKeyHandler(e);break}this.isAnimationNone&&(this.isKBDAction=!1),n&&(e.action=i)},t.prototype.upDownKeyHandler=function(e){var i=this.getUlByNavIdx(),r=e.action===to||e.action===Xu||e.action===Jm?0:i.childElementCount-1,n=r,s=this.getLIByClass(i,kr);s&&(e.action!==Zm&&e.action!==Xu&&(n=this.getIdx(i,s)),s.classList.remove(kr),e.action!==Zm&&e.action!==Xu&&(e.action===to?n++:n--,n===(e.action===to?i.childElementCount:-1)&&(n=r)));var a=i.children[n];n=this.isValidLI(a,n,e.action),i.children[n].classList.add(kr),i.children[n].focus()},t.prototype.isValidLI=function(e,i,r){var n=this.getUlByNavIdx(),s=r===to||r===Xu||r===Jm?0:n.childElementCount-1;return(e.classList.contains(xf)||e.classList.contains(Zx)||e.classList.contains(ey))&&(r===to&&i===n.childElementCount-1||r===Qu&&i===0?i=s:r===to||r===vl||r==="tab"&&e.classList.contains(xf)?i++:i--),e=n.children[i],e&&(e.classList.contains(xf)||e.classList.contains(Zx)||e.classList.contains(ey))&&(i=this.isValidLI(e,i,r)),i},t.prototype.getUlByNavIdx=function(e){var i=this;if(e===void 0&&(e=this.navIdx.length),this.isMenu){var r=[this.getWrapper()].concat([].slice.call(ze("."+$u)))[e],n=[],s=ze("."+$u);return s.forEach(function(a){(i.element.id===a.id.split("-")[2]||a.id.split("-")[2]+"-"+a.id.split("-")[3])&&n.push(a)}),r=[this.getWrapper()].concat([].slice.call(n))[e],g(r)?null:J(".e-menu-parent",r)}else return!document.body.contains(this.element)&&e===0?null:this.getWrapper().children[e]},t.prototype.rightEnterKeyHandler=function(e){var i,r=this.getUlByNavIdx(),n=this.getLIByClass(r,kr);if(n){var s=this.getIdx(r,n),a=this.navIdx.concat(s),l=this.getItem(a);if(l.items.length)this.navIdx.push(s),this.keyType="right",this.action=e.action,this.openMenu(n,l,-1,-1,e);else if(e.action===Km){this.isMenu&&this.navIdx.length===0?this.removeLIStateByClass([nr],[this.getWrapper()]):n.classList.remove(kr),n.classList.add(nr),i={element:n,item:l,event:e},this.trigger("select",i);var h=n.querySelector(".e-menu-url");if(l.url&&h)switch(h.getAttribute("target")){case"_blank":window.open(l.url,"_blank");break;case"_parent":window.parent.location.href=l.url;break;default:window.location.href=l.url}this.closeMenu(null,e);var c=this.getLIByClass(this.getUlByNavIdx(),nr);c&&(c.classList.add(kr),c.focus())}}},t.prototype.leftEscKeyHandler=function(e){this.navIdx.length?(this.keyType="left",this.closeMenu(this.navIdx.length,e)):e.action===Kx&&this.closeMenu(null,e)},t.prototype.scrollHandler=function(e){this.closeMenu(null,e)},t.prototype.touchHandler=function(e){this.isTapHold=!0,this.cmenuHandler(e.originalEvent)},t.prototype.cmenuHandler=function(e){e.preventDefault(),this.currentTarget=e.target,this.isCMenu=!0,this.pageX=e.changedTouches?e.changedTouches[0].pageX+1:e.pageX+1,this.pageY=e.changedTouches?e.changedTouches[0].pageY+1:e.pageY+1,this.closeMenu(null,e),this.isCMenu&&(this.canOpen(e.target)&&this.openMenu(null,null,this.pageY,this.pageX,e),this.isCMenu=!1)},t.prototype.closeMenu=function(e,i,r){var n=this;if(e===void 0&&(e=0),i===void 0&&(i=null),this.isMenuVisible()){var s=void 0,a,l=this.getWrapper(),h=void 0,c,u=this.getPopups(),d=!1,p=this.isMenu?u.length+1:l.childElementCount,f=this.isMenu&&p!==1?J(".e-ul",u[p-2]):ze(".e-menu-parent",l)[p-1];if(this.isMenu&&f.classList.contains("e-menu")&&(s=this.getLIByClass(f,nr),s&&s.classList.remove(nr),d=!0),!d){var v=i&&i.target&&this.getLI(i.target);v?this.cli=v:this.cli=f.children[0],a=this.navIdx.length?this.getItem(this.navIdx):null,c=a?a.items:this.items,h={element:f,parentItem:a,items:c,event:i,cancel:!1,isFocused:!0},this.trigger("beforeClose",h,function(m){var y,b,S="",C,x=!m.cancel;(x||n.isCMenu)&&(n.isMenu?(y=H(f,"."+$u),n.hamburgerMode&&(y.parentElement.style.minHeight="",H(f,".e-menu-item").setAttribute("aria-expanded","false")),n.unWireKeyboardEvent(y),gl(Cr(y.children[0],wl),y.children[0]),C=Cr(y,es),C.hide(),S=y.id,C.destroy(),se(y)):(n.isContextMenuClosed=!1,n.toggleAnimation(f,!1)),b={element:f,parentItem:a,items:c},n.trigger("onClose",b),n.navIdx.pop(),n.navIdx.length===0&&i&&i.type==="keyup"&&(n.showSubMenu=!1),n.isMenu||(T.remove(f,"keydown",n.keyHandler),n.keyType==="right"&&(n.keyType=""))),n.updateReactTemplate();var I,D,M,E=n.getWrapper()&&n.getUlByNavIdx();if(n.isCMenu&&(n.canOpen(i.target)&&n.openMenu(null,null,n.pageY,n.pageX,i),n.isCMenu=!1),n.isMenu&&E&&S.length){var A=RegExp;I=new A("(.*)-ej2menu-"+n.element.id+"-popup").exec(S)[1],D=E.querySelector('[id="'+I+'"]'),M=v&&E.querySelector('[id="'+v.id+'"]')}else E&&(D=E.querySelector(".e-menu-item.e-selected"),M=v&&E.querySelector('[id="'+v.id+'"]'));var L=v&&v.querySelectorAll(".e-menu-item");if(x&&n.hamburgerMode&&e&&!L.length)n.afterCloseMenu(i);else if(x&&!n.hamburgerMode&&D&&!M&&n.keyType!=="left"&&(n.navIdx.length||!n.isMenu&&n.navIdx.length===0)){var N=i&&i.target.classList&&(i.target.classList.contains("e-vscroll")||i.target.classList.contains("e-scroll-nav"))?H(i.target,".e-menu-wrapper"):null;N?(N=N.querySelector(".e-menu-item"),(n.showItemOnClick||N&&n.getIndex(N.id,!0).length<=n.navIdx.length)&&n.closeMenu(n.navIdx[n.navIdx.length-1],i,!0)):i&&i.target.classList&&i.target.classList.contains("e-nav-arrow")||n.closeMenu(n.navIdx[n.navIdx.length-1],i)}else if(x&&!r&&!e&&(n.hamburgerMode&&n.navIdx.length||n.navIdx.length===1&&v&&E!==v.parentElement))n.closeMenu(null,i);else if(x&&g(e)&&n.navIdx.length)n.closeMenu(null,i);else if(x&&!n.isMenu&&!e&&n.navIdx.length===0&&!n.isMenusClosed&&!n.isCmenuHover)n.isMenusClosed=!0,n.closeMenu(0,i);else if(x&&n.isMenu&&i&&i.target&&n.navIdx.length!==0&&H(i.target,".e-menu-parent.e-control"))n.closeMenu(0,i);else if(x&&!n.isMenu&&ze(".e-menu-parent",l)[e-1]&&i.which===3)n.closeMenu(null,i);else{if(x&&(n.keyType==="right"||n.keyType==="click"))n.afterCloseMenu(i);else{var R=n.getUlByNavIdx(),P=n.getLIByClass(R,nr);if(P&&(P.setAttribute("aria-expanded","false"),P.classList.remove(nr),(m.isFocused&&v||n.keyType==="left")&&(P.classList.add(kr),(!i.target||!i.target.classList.contains("e-edit-template"))&&P.focus())),!x&&n.hamburgerMode&&v&&v.getAttribute("aria-expanded")==="false"&&v.getAttribute("aria-haspopup")==="true"){H(v,".e-menu-parent.e-control")?n.navIdx=[]:n.navIdx.pop(),n.navIdx.push(n.cliIdx);var k=n.getItem(n.navIdx);v.setAttribute("aria-expanded","true"),n.openMenu(v,k,-1,-1,i)}}n.navIdx.length<1&&(n.showSubMenuOn==="Hover"||n.showSubMenuOn==="Click")&&(n.showItemOnClick=n.defaultOption,n.showSubMenuOn="Auto")}n.removeStateWrapper()})}}},t.prototype.updateReactTemplate=function(){if(this.isReact&&this.template&&this.navIdx.length===0){var e=void 0;this.portals&&(e=this.portals.splice(0,this.items.length)),this.clearTemplate(["template"]),this.portals=e,this.renderReactTemplates()}},t.prototype.getMenuItemModel=function(e,i){if(g(e))return null;g(i)&&(i=0);var r=this.getFields(i);return{text:e[r.text],id:e[r.id],items:e[r.child],separator:e[r.separator],iconCss:e[r.iconCss],url:e[r.url]}},t.prototype.getPopups=function(){var e=this,i=[];return[].slice.call(document.querySelectorAll("."+$u)).forEach(function(r){!g(r.querySelector("."+Ku))&&e.getIndex(r.querySelector("."+Ku).id,!0).length&&i.push(r)}),i},t.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&wr(this.element).valueOf()},t.prototype.canOpen=function(e){var i=!0;if(this.filter){i=!1;for(var r=this.filter.split(" "),n=0,s=r.length;n<s;n++)if(H(e,"."+r[n])){i=!0;break}}return i},t.prototype.openMenu=function(e,i,r,n,s,a){var l=this;r===void 0&&(r=0),n===void 0&&(n=0),s===void 0&&(s=null),a===void 0&&(a=this.targetElement);var h=this.getWrapper();this.lItem=e;var c=this.element.id!==""?this.element.id:"menu";if(this.isMenusClosed=!1,g(r)&&(r=-1),g(n)&&(n=-1),e){if(this.uList=this.createItems(i[this.getField("children",this.navIdx.length-1)]),!this.isMenu&&j.isDevice){h.lastChild.style.display="none";var u={text:i[this.getField("text")].toString(),iconCss:Jx+" e-previous"};this.template&&(i.iconCss=(i.iconCss||"")+Jx+" e-previous");var d=new td(this.items[0],"items",this.template?i:u,!0),p=this.createItems([d]).children[0];p.classList.add($m),this.uList.insertBefore(p,this.uList.children[0])}this.isMenu?(this.popupWrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper "+$u,id:e.id+"-ej2menu-"+c+"-popup"}),this.popupWrapper.setAttribute("role","navigation"),this.popupWrapper.setAttribute("aria-label",i.text+"-menu-popup"),this.hamburgerMode?(r=e.offsetHeight,e.appendChild(this.popupWrapper)):document.body.appendChild(this.popupWrapper),this.isNestedOrVertical=this.element.classList.contains("e-vertical")||this.navIdx.length!==1,this.popupObj=this.generatePopup(this.popupWrapper,this.uList,e,this.isNestedOrVertical),this.template&&this.renderReactTemplates(),this.hamburgerMode?this.calculateIndentSize(this.uList,e):(this.cssClass&&X([this.popupWrapper],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.popupObj.hide()),!this.hamburgerMode&&!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(e,l.uList,i,s,0,0,"menu")},this.hoverDelay)):this.triggerBeforeOpen(e,this.uList,i,s,0,0,"menu")):(this.uList.style.zIndex=this.element.style.zIndex,h.appendChild(this.uList),!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){l.triggerBeforeOpen(e,l.uList,i,s,r,n,"none")},this.hoverDelay)):this.triggerBeforeOpen(e,this.uList,i,s,r,n,"none"))}else if(this.uList=this.element,this.uList.style.zIndex=Gs(a||this.element).toString(),g(s)){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!1);var v=this.copyObject(f,{});v.target=v.srcElement=a,v.currentTarget=a,this.triggerBeforeOpen(e,this.uList,i,v,r,n,"none")}else this.triggerBeforeOpen(e,this.uList,i,s,r,n,"none")},t.prototype.copyObject=function(e,i){for(var r in e)i[""+r]=e[""+r];return i},t.prototype.calculateIndentSize=function(e,i){var r=getComputedStyle(i),n=parseInt(r.textIndent,10);this.navIdx.length<2&&!i.classList.contains("e-blankicon")?n*=2:n+=n/4,e.style.textIndent=n+"px";var s=e.querySelectorAll(".e-blankicon");if(s&&s.length)for(var a=e.querySelector(".e-menu-icon"),l=getComputedStyle(a),h=parseInt(l.marginRight,10)+a.offsetWidth+n,c=0;c<s.length;c++)s[c].style.textIndent=h+"px"},t.prototype.generatePopup=function(e,i,r,n){var s=this,a=new es(e,{actionOnScroll:this.hamburgerMode?"none":"reposition",relateTo:r,collision:this.hamburgerMode?{X:"none",Y:"none"}:{X:n||this.enableRtl?"none":"flip",Y:"fit"},position:n&&!this.hamburgerMode?{X:"right",Y:"top"}:{X:"left",Y:"bottom"},targetType:"relative",enableRtl:this.enableRtl,content:i,open:function(){var l=J(".e-menu-vscroll",a.element);l&&(l.style.height="inherit",l.style.maxHeight="");var h=J(".e-ul",a.element);a.element.style.maxHeight="",h.focus(),s.triggerOpen(h)}});return a},t.prototype.createHeaderContainer=function(e){e=e||this.getWrapper();var i=this.createElement("span",{className:"e-"+this.getModuleName()+"-header"}),r=this.enableHtmlSanitizer?Pt.sanitize(this.title):this.title,n=this.createElement("span",{className:"e-"+this.getModuleName()+"-title",innerHTML:r}),s=this.createElement("span",{className:"e-icons e-"+this.getModuleName()+"-icon",attrs:{tabindex:"0"}});i.appendChild(n),i.appendChild(s),e.insertBefore(i,this.element)},t.prototype.openHamburgerMenu=function(e){this.hamburgerMode&&this.triggerBeforeOpen(null,this.element,null,e,0,0,"hamburger")},t.prototype.closeHamburgerMenu=function(e){var i=this,r={element:this.element,parentItem:null,event:e,items:this.items,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.closeMenu(null,e),i.element.classList.add("e-hide-menu"),i.trigger("onClose",{element:i.element,parentItem:null,items:i.items}))})},t.prototype.callFit=function(e,i,r,n,s){return km(e,null,{X:i,Y:r},{top:n,left:s})},t.prototype.triggerBeforeOpen=function(e,i,r,n,s,a,l){var h=this,c=e?r[this.getField("children",this.navIdx.length-1)]:this.items,u={element:i,items:c,parentItem:r,event:n,cancel:!1,top:s,left:a,showSubMenuOn:"Auto"},d=l,p;this.trigger("beforeOpen",u,function(f){switch(d){case"menu":h.hamburgerMode||(f.showSubMenuOn!=="Auto"&&(h.showItemOnClick=!h.defaultOption,h.showSubMenuOn=f.showSubMenuOn),h.top=f.top,h.left=f.left),h.popupWrapper.style.display="block",h.hamburgerMode||(h.popupWrapper.style.maxHeight=h.popupWrapper.getBoundingClientRect().height+"px",h.enableScrolling&&No(h.createElement,h.popupWrapper,h.uList,"vscroll",h.enableRtl),h.checkScrollOffset(n)),!h.hamburgerMode&&!h.left&&!h.top?(h.popupObj.refreshPosition(h.lItem,!0),h.left=parseInt(h.popupWrapper.style.left,10),h.top=parseInt(h.popupWrapper.style.top,10),h.enableRtl&&(h.left=h.isNestedOrVertical?h.left-h.popupWrapper.offsetWidth-h.lItem.parentElement.offsetWidth+2:h.left-h.popupWrapper.offsetWidth+h.lItem.offsetWidth),h.template&&(h.isReact||h.isAngular)?requestAnimationFrame(function(){h.collision(),h.popupWrapper.style.display=""}):(h.collision(),h.popupWrapper.style.display="")):(h.popupObj.collision={X:"none",Y:"none"},h.popupWrapper.style.display="");break;case"none":h.top=f.top,h.left=f.left,h.isContextMenuClosed=!0,p=f.element,h.enableScrolling&&h.isCMenu&&p&&p.parentElement&&(p.style.height=p.parentElement.style.height);break;case"hamburger":f.cancel||(h.element.classList.remove("e-hide-menu"),h.triggerOpen(h.element));break}if(d!=="hamburger")if(f.cancel)h.isMenu?(h.popupObj.destroy(),se(h.popupWrapper)):i.className.indexOf("e-ul")>-1&&se(i),h.navIdx.pop();else if(h.isMenu)if(h.hamburgerMode)h.popupWrapper.style.top=h.top+"px",h.popupWrapper.style.left="0px",h.toggleAnimation(h.popupWrapper);else{h.setBlankIconStyle(h.popupWrapper),h.wireKeyboardEvent(h.popupWrapper),Wi(h.popupWrapper,{selector:"."+Ku}),h.popupWrapper.style.left=h.left+"px",h.popupWrapper.style.top=h.top+"px";var v=h.animationSettings.effect!=="None"?{name:h.animationSettings.effect,duration:h.animationSettings.duration,timingFunction:h.animationSettings.easing}:null;h.popupObj.show(v,h.lItem),j.isDevice&&(h.popupWrapper.style.left=h.left+"px")}else h.setBlankIconStyle(h.uList),h.setPosition(h.lItem,h.uList,h.top,h.left),h.toggleAnimation(h.uList);if(h.keyType==="right"){var m=h.getUlByNavIdx();if(e.classList.remove(kr),h.isMenu&&h.navIdx.length===1&&h.removeLIStateByClass([nr],[h.getWrapper()]),e.classList.add(nr),h.action===Km){var y={element:e,item:r,event:n};h.trigger("select",y)}e.focus(),m=h.getUlByNavIdx();var b=h.isValidLI(m.children[0],0,h.action);m.children[b].classList.add(kr),m.children[b].focus()}})},t.prototype.collision=function(){var e;if(e=gs(this.popupWrapper,null,this.left,this.top),(this.isNestedOrVertical||this.enableRtl)&&(e.indexOf("right")>-1||e.indexOf("left")>-1)){this.popupObj.collision.X="none";var i=H(this.lItem,".e-"+this.getModuleName()+"-wrapper").offsetWidth;this.left=this.enableRtl?Ar(this.lItem,this.isNestedOrVertical?"right":"left","top").left:this.left-this.popupWrapper.offsetWidth-i+2}e=gs(this.popupWrapper,null,this.left,this.top),(e.indexOf("left")>-1||e.indexOf("right")>-1)&&(this.left=this.callFit(this.popupWrapper,!0,!1,this.top,this.left).left),this.popupWrapper.style.left=this.left+"px"},t.prototype.setBlankIconStyle=function(e){var i=[].slice.call(e.getElementsByClassName("e-blankicon"));if(i.length){var r=e.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)");if(r){var n=r.querySelector(".e-menu-icon");if(n){var s=this.enableRtl?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},a=getComputedStyle(n),l=parseInt(a.fontSize,10);parseInt(a.width,10)&&parseInt(a.width,10)>l&&(l=parseInt(a.width,10));var h=l+parseInt(a[s.margin],10)+parseInt(getComputedStyle(r)[s.padding],10)+"px";i.forEach(function(c){c.style[s.padding]=h})}}}},t.prototype.checkScrollOffset=function(e){var i=this.getWrapper();if(i.children[0].classList.contains("e-menu-hscroll")&&this.navIdx.length===1){var r=g(e)?this.element:H(e.target,"."+Ku),n=J(".e-hscroll-bar",i);n.scrollLeft>r.offsetLeft&&(n.scrollLeft-=n.scrollLeft-r.offsetLeft);var s=n.scrollLeft+n.offsetWidth,a=r.offsetLeft+r.offsetWidth;s<a&&(n.scrollLeft+=a-s)}},t.prototype.setPosition=function(e,i,r,n,s){s===void 0&&(s=!1);var a="px";if(this.toggleVisiblity(i),i===this.element||n>-1&&r>-1){var l=gs(i,null,n,r);if(l.indexOf("right")>-1&&(n=n-i.offsetWidth),l.indexOf("bottom")>-1){var h=this.callFit(i,!1,!0,r,n);if(r=h.top-20,r<0){var c=pageYOffset+document.documentElement.clientHeight-i.getBoundingClientRect().height;c>-1&&(r=c)}}if(l=gs(i,null,n,r),l.indexOf("left")>-1){var h=this.callFit(i,!0,!1,r,n);n=h.left}}else if(j.isDevice)if(!this.isMenu&&this.enableScrolling){var u=document.querySelector(".e-menu-vscroll");r=Number(u.style.top.replace("px","")),n=Number(u.style.left.replace("px",""))}else r=Number(this.element.style.top.replace(a,"")),n=Number(this.element.style.left.replace(a,""));else{var d=this.enableRtl?"left":"right",h=Ar(e,d,"top");r=h.top,n=h.left;var l=gs(i,null,this.enableRtl?n-i.offsetWidth:n,r),p=l.indexOf("left")>-1||l.indexOf("right")>-1;p&&(h=Ar(e,this.enableRtl?"right":"left","top"),n=h.left),(this.enableRtl||p)&&(n=this.enableRtl&&p?n:n-i.offsetWidth),l.indexOf("bottom")>-1&&(this.isMenu||!this.enableScrolling)&&(h=this.callFit(i,!1,!0,r,n),r=h.top)}this.toggleVisiblity(i,!1),this.isCMenu&&this.enableScrolling&&i&&(i.style.height="",i.style.top="",i.style.left="",i.style.width="",i.style.position="");var f=H(this.element,".e-"+this.getModuleName()+"-wrapper");if(!this.isMenu&&this.enableScrolling&&i&&f&&f.offsetHeight>0){var v=H(i,".e-menu-vscroll");i.style.display="block",v&&gl(Cr(v,wl),v);var m=Math.ceil(this.getMenuWidth(i,i.offsetWidth,this.enableRtl)),y=No(this.createElement,f,i,"vscroll",this.enableRtl,f.offsetHeight),b=this.callFit(y,!1,!0,r,n);r=b.top,Object.assign(y.style,{top:r+"px",left:n+"px",width:m+"px",position:"absolute",display:s?"block":"none"})}else i.style.top=r+a,i.style.left=n+a},t.prototype.getMenuWidth=function(e,i,r){var n=e.getElementsByClassName($x)[0];return n&&(i+=parseInt(getComputedStyle(n)[r?"marginRight":"marginLeft"],10)),i<120?120:i},t.prototype.toggleVisiblity=function(e,i){i===void 0&&(i=!0),e.style.visibility=i?"hidden":"",e.style.display=i?"block":"none"},t.prototype.createItems=function(e){var i=this,r=this.navIdx?this.navIdx.length:0,n=this.getFields(r),s=this.hasField(e,this.getField("iconCss",r)),a={showIcon:s,moduleName:"menu",fields:n,template:this.template,itemNavigable:!0,itemCreating:function(h){h.curData[h.fields[n.id]]||(h.curData[h.fields[n.id]]=Lt("menuitem")),g(h.curData.htmlAttributes)&&Object.defineProperty(h.curData,"htmlAttributes",{value:{},writable:!0,enumerable:!0,configurable:!0}),j.isIE?(h.curData.htmlAttributes.role||(h.curData.htmlAttributes.role="menuitem"),h.curData.htmlAttributes.tabindex||(h.curData.htmlAttributes.tabindex="-1")):Object.assign(h.curData.htmlAttributes,{role:h.curData.htmlAttributes.role||"menuitem",tabindex:h.curData.htmlAttributes.tabindex||"-1"}),i.isMenu&&!h.curData[i.getField("separator",r)]&&(h.curData.htmlAttributes["aria-label"]||(h.curData.htmlAttributes["aria-label"]=h.curData[h.fields.text]?h.curData[h.fields.text]:h.curData[h.fields.id])),h.curData[h.fields[n.iconCss]]===""&&(h.curData[h.fields[n.iconCss]]=null)},itemCreated:function(h){if(h.curData[i.getField("separator",r)]&&(h.item.classList.add(xf),h.curData.htmlAttributes.role||h.item.setAttribute("role","separator"),h.curData.htmlAttributes.ariaLabel||h.item.setAttribute("aria-label","separator")),s&&!h.curData[h.fields.iconCss]&&!h.curData[i.getField("separator",r)]&&h.item.classList.add("e-blankicon"),h.curData[h.fields.child]&&h.curData[h.fields.child].length){var c=i.createElement("span",{className:Jx+" "+$x});h.item.appendChild(c),h.item.setAttribute("aria-haspopup","true"),h.item.setAttribute("aria-expanded","false"),h.item.classList.add("e-menu-caret-icon")}i.template&&(h.item.setAttribute("id",h.curData[h.fields.id].toString()),h.item.removeAttribute("data-uid"),h.item.classList.contains("e-level-1")&&h.item.classList.remove("e-level-1"),h.item.classList.contains("e-has-child")&&h.item.classList.remove("e-has-child"),h.item.removeAttribute("aria-level"));var u={item:h.curData,element:h.item};i.trigger("beforeItemRender",u)}};this.setProperties({items:this.items},!0),this.isMenu&&(a.templateID=this.element.id+uU);var l=kt.createList(this.createElement,e,a,!this.template,this);return l.setAttribute("tabindex","0"),this.isMenu?l.setAttribute("role","menu"):l.setAttribute("role","menubar"),l},t.prototype.moverHandler=function(e){var i=e.target;this.liTrgt=i,this.isMenu||(this.isCmenuHover=!0);var r=this.getLI(i),n=r?H(r,".e-"+this.getModuleName()+"-wrapper"):this.getWrapper(),s=this.getWrapper(),a=new RegExp("-ej2menu-(.*)-popup"),l,h=!1;if(n){if(n.id!==""?l=a.exec(n.id)[1]:l=n.querySelector("ul").id,l!==this.element.id)if(this.removeLIStateByClass([kr,nr],[this.getWrapper()]),this.navIdx.length)h=!0;else return;r&&H(r,".e-"+this.getModuleName()+"-wrapper")&&!h?(this.removeLIStateByClass([kr],this.isMenu?[n].concat(this.getPopups()):[n]),this.removeLIStateByClass([kr],this.isMenu?[s].concat(this.getPopups()):[s]),r.classList.add(kr),this.showItemOnClick||this.clickHandler(e)):this.isMenu&&this.showItemOnClick&&!h&&this.removeLIStateByClass([kr],[n].concat(this.getPopups())),this.isMenu&&(!this.showItemOnClick&&i.parentElement!==n&&!H(i,".e-"+this.getModuleName()+"-popup")&&(!r||r&&!this.getIndex(r.id,!0).length)&&this.showSubMenuOn!=="Hover"?(this.removeLIStateByClass([kr],[n]),this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e))):h&&!this.showItemOnClick&&this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e)),this.isClosed||this.removeStateWrapper(),this.isClosed=!1),this.isMenu||(this.isCmenuHover=!1)}},t.prototype.removeStateWrapper=function(){if(this.liTrgt){var e=H(this.liTrgt,".e-menu-vscroll");this.liTrgt.tagName==="DIV"&&e&&this.removeLIStateByClass([kr,nr],[e])}},t.prototype.removeLIStateByClass=function(e,i){for(var r,n=function(a){e.forEach(function(l){r=J("."+l,i[a]),r&&r.classList.remove(l)})},s=0;s<i.length;s++)n(s)},t.prototype.getField=function(e,i){i===void 0&&(i=0);var r=this.fields[""+e];return typeof r=="string"?r:r[i]?r[i].toString():r[r.length-1].toString()},t.prototype.getFields=function(e){return e===void 0&&(e=0),{id:this.getField("itemId",e),iconCss:this.getField("iconCss",e),text:this.getField("text",e),url:this.getField("url",e),child:this.getField("children",e),separator:this.getField("separator",e)}},t.prototype.hasField=function(e,i){for(var r=0,n=e.length;r<n;r++)if(e[r][""+i])return!0;return!1},t.prototype.menuHeaderClickHandler=function(e){var i=H(e.target,".e-menu-wrapper");i&&i.querySelector("ul.e-menu-parent").id!==this.element.id||(this.element.className.indexOf("e-hide-menu")>-1?this.openHamburgerMenu(e):this.closeHamburgerMenu(e))},t.prototype.clickHandler=function(e){this.isTapHold=this.isTapHold?!1:this.isTapHold;var i=this.getWrapper(),r=e.target,n=this.cli=this.getLI(r),s=new RegExp("-ej2menu-(.*)-popup"),a=n?H(n,".e-"+this.getModuleName()+"-wrapper"):null,l=n&&a&&(this.isMenu?this.getIndex(n.id,!0).length>0:i.firstElementChild.id===a.firstElementChild.id);if(j.isDevice&&this.isMenu&&(this.removeLIStateByClass([kr],[i].concat(this.getPopups())),this.mouseDownHandler(e)),n&&a&&this.isMenu){var h=a.id?s.exec(a.id)[1]:a.querySelector(".e-menu-parent").id;if(this.element.id!==h)return}if(l&&e.type==="click"&&!n.classList.contains($m)){this.setLISelected(n);var c=this.getIndex(n.id,!0),u=this.getItem(c),d={element:n,item:u,event:e};this.trigger("select",d)}if(l&&(e.type==="mouseover"||j.isDevice||this.showItemOnClick)){var p=void 0;if(n.classList.contains($m)){p=i.children[this.navIdx.length-1],this.toggleAnimation(p);var f=this.getLIByClass(p,nr);f&&f.classList.remove(nr);var v=this.enableScrolling&&!this.isMenu?H(n.parentElement,".e-menu-vscroll"):null;v&&gl(Cr(v,wl),v),se(n.parentNode),this.navIdx.pop()}else if(!n.classList.contains(xf)){this.showSubMenu=!0;var m=n.parentNode;if(g(m))return;if(this.cliIdx=this.getIdx(m,n),this.isMenu||!j.isDevice){var y=this.isMenu?Array.prototype.indexOf.call([i].concat(this.getPopups()),H(m,".e-"+this.getModuleName()+"-wrapper")):this.getIdx(i,m);if(this.navIdx[y]===this.cliIdx&&(this.showSubMenu=!1),y!==this.navIdx.length&&(e.type!=="mouseover"||this.showSubMenu)){var f=this.getLIByClass(m,nr);f&&f.classList.remove(nr),this.isClosed=!0,this.keyType="click",this.showItemOnClick&&(this.setLISelected(n),this.isMenu||(this.isCmenuHover=!0)),this.closeMenu(y+1,e),this.showItemOnClick&&(this.setLISelected(n),this.isMenu||(this.isCmenuHover=!1))}}this.isClosed||this.afterCloseMenu(e),this.isClosed=!1}}else if(r.tagName==="DIV"&&H(r,".e-menu-vscroll")&&(this.navIdx.length||!this.isMenu&&this.enableScrolling&&this.navIdx.length===0)){var b=this.isMenu?H(r,"."+$u):H(r,".e-menu-vscroll"),S=this.isMenu?Array.prototype.indexOf.call(this.getPopups(),b)+1:this.getIdx(i,J("ul.e-menu-parent",b));S<this.navIdx.length&&(this.closeMenu(S+1,e),b&&this.removeLIStateByClass([kr,nr],[b]))}else this.isMenu&&this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):(r.tagName!=="UL"||(this.isMenu?r.parentElement.classList.contains("e-menu-wrapper")&&!this.getIndex(r.querySelector("."+Ku).id,!0).length:r.parentElement!==i))&&(n||this.removeLIStateByClass([nr],[i]),(!this.isAnimationNone&&!n||n&&!n.querySelector("."+$x))&&(navigator.platform.toUpperCase().indexOf("MAC")<0||navigator.platform.toUpperCase().indexOf("MAC")>=0&&!e.ctrlKey)&&this.closeMenu(null,e))},t.prototype.afterCloseMenu=function(e){if(!g(e)){var i;if(this.showSubMenu){this.showItemOnClick&&this.navIdx.length===0?i=H(e.target,".e-menu-parent.e-control"):i=H(this.element,".e-menu-parent.e-control");var r=this.navIdx.concat(this.cliIdx),n=this.getItem(r);if(n&&n[this.getField("children",r.length-1)]&&n[this.getField("children",r.length-1)].length?((e.type==="mouseover"||j.isDevice&&this.isMenu)&&this.setLISelected(this.cli),(!this.hamburgerMode&&i||this.hamburgerMode&&this.cli.getAttribute("aria-expanded")==="false")&&(this.cli.setAttribute("aria-expanded","true"),this.navIdx.push(this.cliIdx),this.openMenu(this.cli,n,null,null,e))):e.type!=="mouseover"&&this.closeMenu(null,e),!i){var s=this.getUlByNavIdx(),a=this.getLIByClass(s,nr);a&&(a.setAttribute("aria-expanded","false"),a.classList.remove(nr))}}this.keyType=""}},t.prototype.setLISelected=function(e){var i=this.getLIByClass(e.parentElement,nr);i&&i.classList.remove(nr),this.isMenu||e.classList.remove(kr),e.classList.add(nr)},t.prototype.getLIByClass=function(e,i){if(e&&e.children){for(var r=0,n=e.children.length;r<n;r++)if(e.children[r].classList.contains(i))return e.children[r]}return null},t.prototype.getItemIndex=function(e,i){var r;typeof e=="string"?r=e:r=e.id;var n=i!==!1,s=this.getIndex(r,n);return s},t.prototype.setItem=function(e,i,r){var n;r?n=i||e.id:n=i||e.text;var s=this.getIndex(n,r),a=this.getItem(s);Object.assign(a,e)},t.prototype.getItem=function(e){e=e.slice();var i=e.pop(),r=this.getItems(e);return r[i]},t.prototype.getItems=function(e){for(var i=this.items,r=0;r<e.length;r++)i=i[e[r]][this.getField("children",r)];return i},t.prototype.setItems=function(e,i){var r=this.getItems(i);r.splice(0,r.length);for(var n=0;n<e.length;n++)r.splice(n,0,e[n])},t.prototype.getIdx=function(e,i,r){r===void 0&&(r=!0);var n=!this.isMenu&&this.enableScrolling&&J(".e-menu-vscroll",e)?ze(".e-menu-parent",e):Array.from(e.children),s=Array.prototype.indexOf.call(n,i);return r&&e.children[0].classList.contains($m)&&s--,s},t.prototype.getLI=function(e){return e.tagName==="LI"&&e.classList.contains("e-menu-item")?e:H(e,"li.e-menu-item")},t.prototype.updateItemsByNavIdx=function(){for(var e=this.items,i=0,r=0;r<this.navIdx.length&&(e=e[r].items,!!e);r++){i++;var n=this.getUlByNavIdx(i);if(!n)break;this.updateItem(n,e)}},t.prototype.removeChildElement=function(e){for(;e.firstElementChild;)e.removeChild(e.firstElementChild);return e},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=this.getWrapper(),s=function(u){switch(u){case"cssClass":i.cssClass&&Z([n],i.cssClass.split(" ")),e.cssClass&&X([n],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":a.enableRtl?n.classList.add(eI):n.classList.remove(eI);break;case"showItemOnClick":a.unWireEvents(),a.showItemOnClick=e.showItemOnClick,a.wireEvents();break;case"enableScrolling":if(e.enableScrolling){var d;a.element.classList.contains("e-vertical")?No(a.createElement,n,a.element,"vscroll",a.enableRtl):No(a.createElement,n,a.element,"hscroll",a.enableRtl),a.getPopups().forEach(function(C){d=J(".e-ul",C),No(r.createElement,C,d,"vscroll",r.enableRtl)})}else{var p=n.children[0];a.element.classList.contains("e-vertical")||!a.isMenu?gl(Cr(p,wl),p):gl(Cr(p,yy),p),n.style.overflow="",n.appendChild(a.element),a.getPopups().forEach(function(C){p=C.children[0],gl(Cr(p,wl),p),C.style.overflow=""})}break;case"items":{var f=void 0,v=void 0,m=void 0;if(a.isReact&&a.template&&a.clearTemplate(["template"]),Object.keys(i.items).length)for(var S=Object.keys(e.items),y=0;y<S.length;y++)v=a.getChangedItemIndex(e,[],Number(S[y])),v.length<=a.getWrapper().children.length&&(f=v.pop(),m=a.getItems(v),a.insertAfter([m[f]],m[f].text),a.removeItem(m,v,f),a.setItems(m,v)),v.length=0;else{if(a.updateItem(a.element,a.items),a.enableScrolling&&a.element.parentElement.classList.contains("e-custom-scroll")&&(a.element.classList.contains("e-vertical")?No(a.createElement,n,a.element,"vscroll",a.enableRtl):No(a.createElement,n,a.element,"hscroll",a.enableRtl)),a.enableScrolling&&a.element.classList.contains("e-contextmenu")&&(a.isCMenu=!0,a.setPosition(a.lItem,a.uList,a.top,a.left,!0),a.isCMenu=!1),!a.hamburgerMode)for(var y=1,b=n.childElementCount;y<b;y++)se(n.lastElementChild);a.navIdx=[]}break}}},a=this,l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];s(c)}},t.prototype.updateItem=function(e,i){if($e()&&!this.isMenu)e=this.removeChildElement(e);else{if(this.enableScrolling){var r=this.getWrapper(),n=r.children[0];this.element.classList.contains("e-vertical")?gl(Cr(n,wl),n):gl(Cr(n,yy),n)}e.innerHTML=""}var s=[].slice.call(this.createItems(i).children);s.forEach(function(a){e.appendChild(a)})},t.prototype.getChangedItemIndex=function(e,i,r){i.push(r);var n=Object.keys(e.items[r]).pop();if(n==="items"){var s=e.items[r],a=Object.keys(s.items).pop();a&&this.getChangedItemIndex(s,i,Number(a))}else n==="isParentArray"&&i.length>1&&i.pop();return i},t.prototype.removeItem=function(e,i,r){e.splice(r,1);var n=this.getWrapper().children;if(i.length<n.length)if(this.enableScrolling&&!n[i.length].classList.contains("e-menu-parent")){var s=n[i.length].querySelector(".e-menu-parent");se(s.children[r])}else se(n[i.length].children[r])},t.prototype.unWireEvents=function(e){e===void 0&&(e=this.target);var i=this.getWrapper();if(e){for(var r=void 0,n=void 0,s=ze(e),a=0,l=s.length;a<l;a++)r=s[a],this.isMenu?T.remove(r,"click",this.menuHeaderClickHandler):j.isIos?(n=Cr(r,jr),n&&n.destroy()):T.remove(r,"contextmenu",this.cmenuHandler);if(!this.isMenu){T.remove(this.targetElement,"scroll",this.scrollHandler);for(var h=0,c=Fm(this.targetElement);h<c.length;h++){var u=c[h];T.remove(u,"scroll",this.scrollHandler)}}}j.isDevice||(T.remove(this.isMenu?document:i,"mouseover",this.delegateMoverHandler),T.remove(document,"mousedown",this.delegateMouseDownHandler),T.remove(document,"keydown",this.domKeyHandler),!this.isMenu&&!this.target&&T.remove(document,"scroll",this.scrollHandler)),T.remove(document,"click",this.delegateClickHandler),this.unWireKeyboardEvent(i),this.rippleFn(),!this.isMenu&&this.enableScrolling&&(i.removeEventListener("touchstart",this.touchStartFn),i.removeEventListener("touchmove",this.touchMoveFn),document.removeEventListener("touchstart",this.touchOutsideHandler))},t.prototype.unWireKeyboardEvent=function(e){var i=Cr(e,rr);i&&i.destroy()},t.prototype.toggleAnimation=function(e,i){var r=this;i===void 0&&(i=!0);var n=this.getWrapper();if(n){var s=n.querySelectorAll(".e-menu-parent");s.forEach(function(c){Mt.stop(c)})}var a,l,h=this.enableScrolling&&!this.isMenu&&H(e,".e-menu-vscroll")?H(e,".e-menu-vscroll"):e;Mt.stop(h),this.animationSettings.effect==="None"||!i?(this.hamburgerMode&&e&&(e.style.top="0px"),this.isAnimationNone=this.animationSettings.effect==="None",this.end(e,i)):(h.style.maxHeight="",this.animation.animate(h,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(c){r.hamburgerMode?(l=c.element.parentElement,c.element.style.position="absolute",l&&(a=l.offsetHeight),c.element.style.maxHeight=c.element.offsetHeight+"px",l&&(l.style.maxHeight="")):(c.element.style.display="block",c.element.style.maxHeight=c.element.getBoundingClientRect().height+"px")},progress:function(c){r.hamburgerMode&&l&&(l.style.minHeight=a+c.element.offsetHeight+"px")},end:function(c){r.hamburgerMode?(c.element.style.position="",c.element.style.maxHeight="",l&&(l.style.minHeight=""),c.element.style.top="0px",c.element.children[0].focus(),r.triggerOpen(c.element.children[0])):r.end(c.element,i),r.isKBDAction=!1}}))},t.prototype.triggerOpen=function(e){var i=this.navIdx.length?this.getItem(this.navIdx):null,r={element:e,parentItem:i,items:i?i.items:this.items};this.trigger("onOpen",r),this.isMenu||T.add(e,"keydown",this.keyHandler,this)},t.prototype.end=function(e,i){if(i&&this.isContextMenuClosed){(this.isMenu||!j.isDevice||!this.isMenu&&this.isAnimationNone&&j.isDevice)&&(e.style.display="block"),e.style.maxHeight="";var r=this.enableScrolling&&!this.isMenu?H(e,".e-menu-vscroll"):null;if(r&&(r.style.display="block"),this.triggerOpen(e),e.querySelector("."+kr)&&this.isKBDAction)e.querySelector("."+kr).focus();else{var n=this.getWrapper().children[this.getIdx(this.getWrapper(),e)-1];this.currentTarget?this.currentTarget.classList.contains("e-numerictextbox")||this.currentTarget.classList.contains("e-textbox")||this.currentTarget.tagName==="INPUT"||(n&&this.isKBDAction?n.querySelector("."+nr).focus():this.element.focus()):n&&this.isKBDAction?n.querySelector("."+nr).focus():this.element.focus()}}else{var r=this.enableScrolling&&!this.isMenu?H(e,".e-menu-vscroll"):null;if(r&&gl(Cr(r,wl),r),e===this.element){var s=this.getLIByClass(this.element,kr);s&&s.classList.remove(kr);var a=this.getLIByClass(this.element,nr);a&&a.classList.remove(nr),e.style.display="none",this.isAnimationNone=!1}else se(e)}},t.prototype.getPersistData=function(){return""},t.prototype.getWrapper=function(){return H(this.element,".e-"+this.getModuleName()+"-wrapper")},t.prototype.getIndex=function(e,i,r,n,s,a){r===void 0&&(r=this.items),n===void 0&&(n=[]),s===void 0&&(s=!1),a===void 0&&(a=0);var l;a=s?a+1:0;for(var h=0,c=r.length;h<c;h++){l=r[h];var u=i?l[this.getField("itemId",a)]:l[this.getField("text",a)],d=l.htmlAttributes&&"id"in l.htmlAttributes?l.htmlAttributes.id:u;if(d===e){n.push(h);break}else if(l[this.getField("children",a)]&&l[this.getField("children",a)].length)if(n=this.getIndex(e,i,l[this.getField("children",a)],n,!0,a),n[n.length-1]===-1)h!==c-1&&n.pop();else{n.unshift(h);break}else h===c-1&&n.push(-1)}return!s&&n[0]===-1?[]:n},t.prototype.enableItems=function(e,i,r){i===void 0&&(i=!0);for(var n,s,a,l=Zx,h,c=0;c<e.length;c++){if(a=this.getIndex(e[c],r),this.navIdx.length){if(a.length!==1){h=!1;for(var u=0,d=a.length-1;u<d;u++)if(a[u]!==this.navIdx[u]){h=!0;break}if(h)continue}}else if(a.length!==1)continue;if(s=a.pop(),n=this.getUlByNavIdx(a.length),n&&!g(s))if(i)if(this.isMenu)n.children[s].classList.remove(l),n.children[s].removeAttribute("aria-disabled");else if(j.isDevice&&!n.classList.contains("e-contextmenu"))n.children[s+1].classList.remove(l);else if(this.enableScrolling&&!n.classList.contains("e-menu-parent")){var p=n.querySelector(".e-menu-parent");p.children[s].classList.remove(l)}else n.children[s].classList.remove(l);else if(this.isMenu)n.children[s].classList.add(l),n.children[s].setAttribute("aria-disabled","true");else if(j.isDevice&&!n.classList.contains("e-contextmenu"))n.children[s+1].classList.add(l);else if(this.enableScrolling&&!n.classList.contains("e-menu-parent")){var p=n.querySelector(".e-menu-parent");p.children[s].classList.add(l)}else n.children[s].classList.add(l)}},t.prototype.showItems=function(e,i){this.showHideItems(e,!1,i)},t.prototype.hideItems=function(e,i){this.showHideItems(e,!0,i)},t.prototype.showHideItems=function(e,i,r){for(var n,s,a,l,h=0;h<e.length;h++)if(a=this.getIndex(e[h],r),s=a.pop(),n=this.getUlByNavIdx(a.length),l=this.getItems(a),n){this.enableScrolling&&!n.classList.contains("e-menu-parent")&&(n=n.querySelector(".e-menu-parent"));var c=r?n.children[s].id:l[s].text.toString();i&&c===e[h]?n.children[s].classList.add(ey):!i&&c===e[h]&&n.children[s].classList.remove(ey)}},t.prototype.removeItems=function(e,i){for(var r,n,s,a=0;a<e.length;a++)n=this.getIndex(e[a],i),r=n.pop(),s=this.getItems(n),g(r)||this.removeItem(s,n,r)},t.prototype.insertAfter=function(e,i,r){this.insertItems(e,i,r)},t.prototype.insertBefore=function(e,i,r){this.insertItems(e,i,r,!1)},t.prototype.insertItems=function(e,i,r,n){n===void 0&&(n=!0);for(var s,a,l,h,c,u,d=0;d<e.length;d++){l=this.getIndex(i,r),a=l.pop(),h=this.getItems(l),c=new td(h[0],"items",e[d],!0),c.parentObj=h[0].parentObj,h.splice(n?a+1:a,0,c);var p=this.isMenu?[this.getWrapper()].concat(this.getPopups()):[].slice.call(this.getWrapper().children);if(!g(a)&&l.length<p.length){a=n?a+1:a,s=this.createItems(h).children[a];var f=u=this.isMenu?J(".e-menu-parent",p[l.length]):p[l.length];if(this.enableScrolling&&!f.classList.contains("e-menu-parent")&&(f=f.querySelector(".e-menu-parent")),f.insertBefore(s,f.children[a]),d===e.length-1&&!this.isMenu&&f.style.display==="block")if(this.enableScrolling){this.setPosition(null,f,parseFloat(u.style.top),parseFloat(u.style.left));var v=H(f,".e-vscroll");v&&(v.style.display="block")}else this.setPosition(null,f,parseFloat(f.style.top),parseFloat(f.style.left)),f.style.display="block"}}},t.prototype.removeAttributes=function(){var e=this;["top","left","display","z-index"].forEach(function(i){e.element.style.removeProperty(i)}),["role","tabindex","class","style"].forEach(function(i){i==="class"&&e.element.classList.contains("e-menu-parent")&&e.element.classList.remove("e-menu-parent"),(["class","style"].indexOf(i)===-1||!e.element.getAttribute(i))&&e.element.removeAttribute(i),e.isMenu&&i==="class"&&e.element.classList.contains("e-vertical")&&e.element.classList.remove("e-vertical")})},t.prototype.destroy=function(){var e=this.getWrapper();if(e){if(this.unWireEvents(),this.isMenu)this.closeMenu(),$e()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",this.removeAttributes(),e.parentNode.insertBefore(this.element,e),this.clonedElement=null;else{if(this.clonedElement.style.display="",this.clonedElement.tagName==="EJS-CONTEXTMENU")X([this.clonedElement],["e-control","e-lib","e-"+this.getModuleName()]),this.element=this.clonedElement;else if(this.refreshing&&this.clonedElement.childElementCount&&this.clonedElement.children[0].tagName==="LI"&&this.setProperties({items:[]},!0),document.getElementById(this.clonedElement.id)){var i=this.clonedElement.nextElementSibling;i&&i!==e?this.clonedElement.parentElement.insertBefore(this.element,i):this.clonedElement.parentElement.appendChild(this.element),$e()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",bt([].slice.call(this.clonedElement.children),this.element),se(this.clonedElement),this.removeAttributes()}this.clonedElement=null}se(e),o.prototype.destroy.call(this),this.template&&this.clearTemplate(["template"])}this.rippleFn=null},fi([G()],t.prototype,"beforeItemRender",void 0),fi([G()],t.prototype,"beforeOpen",void 0),fi([G()],t.prototype,"onOpen",void 0),fi([G()],t.prototype,"beforeClose",void 0),fi([G()],t.prototype,"onClose",void 0),fi([G()],t.prototype,"select",void 0),fi([G()],t.prototype,"created",void 0),fi([w("")],t.prototype,"cssClass",void 0),fi([w(0)],t.prototype,"hoverDelay",void 0),fi([w(!1)],t.prototype,"showItemOnClick",void 0),fi([w("")],t.prototype,"target",void 0),fi([w("")],t.prototype,"filter",void 0),fi([w(null)],t.prototype,"template",void 0),fi([w(!1)],t.prototype,"enableScrolling",void 0),fi([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),fi([Ce({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},fF)],t.prototype,"fields",void 0),fi([Gt([],td)],t.prototype,"items",void 0),fi([Ce({duration:400,easing:"ease",effect:"SlideDown"},dU)],t.prototype,"animationSettings",void 0),t=fi([It],t),t})(ti),vF=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Ei=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},tI="e-vertical",sr="e-toolbar-items",$i="e-toolbar-item",ko="e-rtl",Zi="e-separator",ty="e-popup-up-icon",If="e-popup-down-icon",Hk="e-popup-open",Vk="e-template",jn="e-overlay",_k="e-toolbar-text",iI="e-popup-text",io="e-overflow-show",iy="e-overflow-hide",pU="e-tbar-btn",ks="e-hor-nav",Uk="e-scroll-nav",fU="e-toolbar-right",gU="e-toolbar-left",Wk="e-toolbar-center",ro="e-tbar-pos",vU="e-hscroll-content",mU="e-vscroll-content",rI="e-hscroll-bar",yU="e-hor-nav",Mf="e-toolbar-pop",vh="e-toolbar-popup",bU="e-tbar-btn-text",Df="e-nav-active",Ef="e-ignore",ry="e-popup-alone",no="e-hidden",qk="e-toolbar-multirow",Yk="e-multirow-pos",nI="e-multirow-separator",sI="e-extended-separator",Gk="e-extended-toolbar",ny="e-toolbar-extended",SU="e-expended-nav",aI="e-tbar-extended",Sy=(function(o){vF(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ei([w("")],t.prototype,"id",void 0),Ei([w("")],t.prototype,"text",void 0),Ei([w("auto")],t.prototype,"width",void 0),Ei([w("")],t.prototype,"cssClass",void 0),Ei([w(!1)],t.prototype,"showAlwaysInPopup",void 0),Ei([w(!1)],t.prototype,"disabled",void 0),Ei([w("")],t.prototype,"prefixIcon",void 0),Ei([w("")],t.prototype,"suffixIcon",void 0),Ei([w(!0)],t.prototype,"visible",void 0),Ei([w("None")],t.prototype,"overflow",void 0),Ei([w("")],t.prototype,"template",void 0),Ei([w("Button")],t.prototype,"type",void 0),Ei([w("Both")],t.prototype,"showTextOn",void 0),Ei([w(null)],t.prototype,"htmlAttributes",void 0),Ei([w("")],t.prototype,"tooltipText",void 0),Ei([w("Left")],t.prototype,"align",void 0),Ei([G()],t.prototype,"click",void 0),Ei([w(-1)],t.prototype,"tabIndex",void 0),t})(Oe),yc=(function(o){vF(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.resizeContext=r.resize.bind(r),r.orientationChangeContext=r.orientationChange.bind(r),r.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},r}return t.prototype.destroy=function(){var e=this;(this.isReact||this.isAngular)&&this.clearTemplate();var i=this.element.querySelectorAll(".e-control.e-btn");for([].slice.call(i).forEach(function(r){!g(r)&&!g(r.ej2_instances)&&!g(r.ej2_instances[0])&&!r.ej2_instances[0].isDestroyed&&r.ej2_instances[0].destroy()}),this.unwireEvents(),this.tempId.forEach(function(r){g(e.element.querySelector(r))||(document.body.appendChild(e.element.querySelector(r)).style.display="none")}),this.destroyItems();this.element.lastElementChild;)this.element.removeChild(this.element.lastElementChild);this.trgtEle&&(this.element.appendChild(this.ctrlTem),this.trgtEle=null,this.ctrlTem=null),this.popObj&&(this.popObj.destroy(),se(this.popObj.element)),this.activeEle&&(this.activeEle=null),this.popObj=null,this.tbarAlign=null,this.tbarItemsCol=[],this.remove(this.element,"e-toolpop"),this.cssClass&&Z([this.element],this.cssClass.split(" ")),this.element.removeAttribute("style"),["aria-disabled","aria-orientation","role"].forEach(function(r){return e.element.removeAttribute(r)}),o.prototype.destroy.call(this)},t.prototype.preRender=function(){var e={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",e),this.enableCollision=e.enableCollision,this.scrollStep=e.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains(tI),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,ko)},t.prototype.wireEvents=function(){T.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),window.addEventListener("orientationchange",this.orientationChangeContext),this.allowKeyboard&&this.wireKeyboardEvent()},t.prototype.wireKeyboardEvent=function(){this.keyModule=new rr(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),T.add(this.element,"keydown",this.docKeyDown,this),this.updateTabIndex("0")},t.prototype.updateTabIndex=function(e){var i=this.element.querySelector("."+$i+":not(."+jn+" ):not(."+Zi+" ):not(."+no+" )");if(!g(i)&&!g(i.firstElementChild)){var r=i.firstElementChild.getAttribute("data-tabindex");r&&r==="-1"&&i.firstElementChild.tagName!=="INPUT"&&i.firstElementChild.setAttribute("tabindex",e)}},t.prototype.unwireKeyboardEvent=function(){this.keyModule&&(T.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},t.prototype.docKeyDown=function(e){if(e.target.tagName!=="INPUT"){var i=!g(this.popObj)&&wr(this.popObj.element)&&this.overflowMode!=="Extended";e.keyCode===9&&e.target.classList.contains("e-hor-nav")===!0&&i&&this.popObj.hide({name:"FadeOut",duration:100});var r=e.keyCode===40||e.keyCode===38||e.keyCode===35||e.keyCode===36;r&&e.preventDefault()}},t.prototype.unwireEvents=function(){T.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),window.removeEventListener("orientationchange",this.orientationChangeContext),document.removeEventListener("scroll",this.clickEvent),document.removeEventListener("click",this.scrollEvent),this.scrollEvent=null,this.clickEvent=null},t.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},t.prototype.docEvent=function(e){var i=H(e.target,".e-popup");this.popObj&&wr(this.popObj.element)&&!i&&this.overflowMode==="Popup"&&this.popObj.hide({name:"FadeOut",duration:100})},t.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,ro),this.scrollModule.destroy(),this.scrollModule=null)},t.prototype.destroyItems=function(){if(this.element&&[].slice.call(this.element.querySelectorAll("."+$i)).forEach(function(i){se(i)}),this.tbarAlign){var e=this.element.querySelector("."+sr);e&&(e.children&&[].slice.call(e.children).forEach(function(i){se(i)}),this.remove(e,ro)),this.tbarAlign=!1}this.clearProperty()},t.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,ko),this.destroyScroll()),this.remove(this.element,aI),this.remove(this.element,Gk);var e=this.element.querySelector(".e-toolbar-multirow");e&&this.remove(e,qk),this.popObj&&this.popupRefresh(this.popObj.element,!0)},t.prototype.add=function(e,i){e.classList.add(i)},t.prototype.remove=function(e,i){e.classList.remove(i)},t.prototype.elementFocus=function(e){var i=e.firstElementChild;i?(i.focus(),this.activeEleSwitch(e)):e.focus()},t.prototype.clstElement=function(e,i){var r;return e&&this.popObj&&wr(this.popObj.element)?r=this.popObj.element.querySelector("."+$i):this.element===i||e?r=this.element.querySelector("."+$i+":not(."+jn+" ):not(."+Zi+" ):not(."+no+" )"):r=H(i,"."+$i),r},t.prototype.getNextFocusableItem=function(e,i){var r="."+$i+":not(."+jn+"):not(."+Zi+"):not(."+no+")",n=Array.from(this.element.querySelectorAll(r)),s=n.indexOf(e);if(s<0)return null;var a;switch(i){case"moveRight":case"moveDown":case"tab":a=(s+1)%n.length;break;case"moveLeft":case"moveUp":a=(s-1+n.length)%n.length;break;case"home":a=0;break;case"end":a=n.length-1;break;default:a=s}return a>=0&&a<n.length?n[parseInt(a.toString(),10)]:null},t.prototype.keyHandling=function(e,i,r,n,s){var a=this.popObj,l=this.element,h={name:"FadeOut",duration:100},c=i.action==="moveUp"?"previous":"next",u,d;switch(i.action){case"moveRight":if(this.isVertical)return;l===r?this.elementFocus(e):n||this.eleFocus(e,"next");break;case"moveLeft":if(this.isVertical)return;n||this.eleFocus(e,"previous");break;case"home":case"end":if(e){var p=H(e,".e-popup"),f=this.element.querySelector("."+ny);this.overflowMode==="Extended"&&f&&f.classList.contains("e-popup-open")&&(p=i.action==="end"?f:null),p?wr(this.popObj.element)&&(d=[].slice.call(p.children),i.action==="home"?u=this.focusFirstVisibleEle(d):u=this.focusLastVisibleEle(d)):(d=this.element.querySelectorAll("."+sr+" ."+$i+":not(."+Zi+")"),i.action==="home"?u=this.focusFirstVisibleEle(d):u=this.focusLastVisibleEle(d)),u&&this.elementFocus(u)}break;case"moveUp":case"moveDown":if(this.isVertical)i.action==="moveUp"?this.eleFocus(e,"previous"):this.eleFocus(e,"next");else if(a&&H(r,".e-popup")){var v=a.element;if(c==="previous"&&v.firstElementChild===e){var m=this.focusLastVisibleEle([].slice.call(v.children));m&&this.elementFocus(m)}else if(c==="next"&&v.lastElementChild===e){var y=this.focusFirstVisibleEle([].slice.call(v.children));y&&this.elementFocus(y)}else this.eleFocus(e,c)}else if(i.action==="moveDown"&&a&&wr(a.element)){var b=this.eleContains(e);b?this.eleFocus(e,c):this.elementFocus(e)}break;case"tab":if(!s&&!n){var S=e.firstElementChild;l===r&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(S),S.focus()))}break;case"popupClose":a&&this.overflowMode!=="Extended"&&a.hide(h);break;case"popupOpen":if(!n)return;a&&!wr(a.element)?(a.element.style.top=l.offsetHeight+"px",a.show({name:"FadeIn",duration:100})):a.hide(h);break}},t.prototype.keyActionHandler=function(e){var i=this,r=e.target;if(!((e.action==="home"||e.action==="end"||e.action==="moveRight"||e.action==="moveLeft"||e.action==="moveUp"||e.action==="moveDown")&&(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||this.element.classList.contains(jn)))){e.preventDefault();var n=r.classList.contains(ks),s=r.classList.contains(Uk),a=this.clstElement(n,r);if(a||s){var l=a,h=this.getNextFocusableItem(l,e.action),c={originalEvent:e,currentItem:l,nextItem:h,cancel:!1};this.trigger("keyDown",c,function(u){u.cancel||i.keyHandling(a,e,r,n,s)})}}},t.prototype.disable=function(e){var i=this.element;e?i.classList.add(jn):i.classList.remove(jn),this.activeEle&&this.activeEle.setAttribute("tabindex",this.activeEle.getAttribute("data-tabindex")),this.scrollModule&&this.scrollModule.disable(e),this.popObj&&(wr(this.popObj.element)&&this.overflowMode!=="Extended"&&this.popObj.hide(),i.querySelector("#"+i.id+"_nav").setAttribute("tabindex",e?"-1":"0"))},t.prototype.eleContains=function(e){return e.classList.contains(Zi)||e.classList.contains(jn)||e.getAttribute("disabled")||e.classList.contains(no)||!wr(e)||!e.classList.contains($i)},t.prototype.focusFirstVisibleEle=function(e){for(var i,r=0;r<e.length;){var n=e[parseInt(r.toString(),10)];if(!n.classList.contains(Zi)&&!n.classList.contains(no)&&!n.classList.contains(jn))return n;r++}return i},t.prototype.focusLastVisibleEle=function(e){for(var i,r=e.length-1;r>=0;){var n=e[parseInt(r.toString(),10)];if(!n.classList.contains(Zi)&&!n.classList.contains(no)&&!n.classList.contains(jn))return n;r--}return i},t.prototype.eleFocus=function(e,i){var r=Object(e)[i+"ElementSibling"];if(r){var n=this.eleContains(r);if(n){this.eleFocus(r,i);return}this.elementFocus(r)}else if(this.tbarAlign){var s=Object(e.parentElement)[i+"ElementSibling"];if(!g(s)&&s.children.length===0&&(s=Object(s)[i+"ElementSibling"]),!g(s)&&s.children.length>0)if(i==="next"){var a=s.querySelector("."+$i);this.eleContains(a)?this.eleFocus(a,i):(a.firstElementChild.focus(),this.activeEleSwitch(a))}else{var a=s.lastElementChild;this.eleContains(a)?this.eleFocus(a,i):this.elementFocus(a)}}else if(!g(e)){var l=this.element.querySelectorAll("."+sr+" ."+$i+":not(."+Zi+"):not(."+jn+"):not(."+no+")");i==="next"&&l?this.elementFocus(l[0]):i==="previous"&&l&&this.elementFocus(l[l.length-1])}},t.prototype.clickHandler=function(e){var i=this,r=e.target,n=this.element,s=!g(H(r,"."+Mf)),a=r.classList,l=H(r,"."+ks);l||(l=r),!n.children[0].classList.contains("e-hscroll")&&!n.children[0].classList.contains("e-vscroll")&&a.contains(ks)&&(a=r.querySelector(".e-icons").classList),(a.contains(ty)||a.contains(If))&&this.popupClickHandler(n,l,ko);var h,c=H(e.target,"."+$i);if(!((g(c)||c.classList.contains(jn))&&!l.classList.contains(ks))){if(c){var u=this.items[this.tbarEle.indexOf(c)];h=u}var d={originalEvent:e,item:h},p=h&&!g(h.click)&&typeof h.click=="object"?!g(h.click.observers)&&h.click.observers.length>0:!g(h)&&!g(h.click);p&&this.trigger("items["+this.tbarEle.indexOf(c)+"].click",d),d.cancel||this.trigger("clicked",d,function(f){!g(i.popObj)&&s&&!f.cancel&&i.overflowMode==="Popup"&&f.item&&f.item.type!=="Input"&&i.popObj.hide({name:"FadeOut",duration:100})})}},t.prototype.popupClickHandler=function(e,i,r){var n=this.popObj;wr(n.element)?(i.classList.remove(Df),n.hide({name:"FadeOut",duration:100})):(e.classList.contains(r)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),n.offsetX===0&&!e.classList.contains(r)&&(n.enableRtl=!1,n.position={X:"right",Y:"top"}),this.overflowMode==="Extended"&&(n.element.style.minHeight="0px",n.width=this.getToolbarPopupWidth(this.element)),n.dataBind(),n.refreshPosition(),n.element.style.top=this.getElementOffsetY()+"px",i.classList.add(Df),n.show({name:"FadeIn",duration:100}))},t.prototype.getToolbarPopupWidth=function(e){var i=window.getComputedStyle(e);return parseFloat(i.width)+parseFloat(i.borderRightWidth)*2},t.prototype.render=function(){var e=this;this.initialize(),this.clickEvent=this.docEvent.bind(this),this.scrollEvent=this.docEvent.bind(this),this.renderControl(),this.wireEvents(),this.renderComplete(),this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){e.refreshOverflow()})},t.prototype.initialize=function(){var e=Ae(this.width),i=Ae(this.height);(j.info.name!=="msie"||this.height!=="auto"||this.overflowMode==="MultiRow")&&Ze(this.element,{height:i}),Ze(this.element,{width:e});var r={role:"toolbar","aria-disabled":"false","aria-orientation":this.isVertical?"vertical":"horizontal"};Ee(this.element,r),this.cssClass&&X([this.element],this.cssClass.split(" "))},t.prototype.renderControl=function(){var e=this.element;this.trgtEle=e.children.length>0?e.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},t.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},t.prototype.itemsAlign=function(e,i){var r,n;this.tbarEle||(this.tbarEle=[]);for(var s=0;s<e.length;s++)r=this.renderSubComponent(e[parseInt(s.toString(),10)],s),this.tbarEle.indexOf(r)===-1&&this.tbarEle.push(r),this.tbarAlign||this.tbarItemAlign(e[parseInt(s.toString(),10)],i,s),n=i.querySelector(".e-toolbar-"+e[parseInt(s.toString(),10)].align.toLowerCase()),n?(e[parseInt(s.toString(),10)].showAlwaysInPopup&&e[parseInt(s.toString(),10)].overflow!=="Show"||this.tbarAlgEle[(e[parseInt(s.toString(),10)].align+"s").toLowerCase()].push(r),n.appendChild(r)):i.appendChild(r);if(this.isReact){var a="portals";this.notify("render-react-toolbar-template",this[""+a]),this.renderReactTemplates()}},t.prototype.changeOrientation=function(){var e=this.element;this.isVertical?(e.classList.remove(tI),this.isVertical=!1,(this.height==="auto"||this.height==="100%")&&(e.style.height=this.height),e.setAttribute("aria-orientation","horizontal")):(e.classList.add(tI),this.isVertical=!0,e.setAttribute("aria-orientation","vertical"),Ze(this.element,{height:Ae(this.height),width:Ae(this.width)})),this.destroyMode(),this.refreshOverflow()},t.prototype.initScroll=function(e,i){if(!this.scrollModule&&this.checkOverflow(e,i[0])){this.tbarAlign&&this.element.querySelector("."+sr+" ."+Wk).removeAttribute("style"),this.isVertical?this.scrollModule=new wl({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]):this.scrollModule=new yy({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]),this.cssClass&&X([i[0]],this.cssClass.split(" "));var r=this.scrollModule.element.querySelector("."+rI+", .e-vscroll-bar");r&&r.removeAttribute("tabindex"),this.remove(this.scrollModule.element,ro),Ze(this.element,{overflow:"hidden"})}},t.prototype.itemWidthCal=function(e){var i=this,r=0,n;return[].slice.call(ze("."+$i,e)).forEach(function(s){wr(s)&&(n=window.getComputedStyle(s),r+=i.isVertical?s.offsetHeight:s.offsetWidth,r+=parseFloat(i.isVertical?n.marginTop:n.marginRight),r+=parseFloat(i.isVertical?n.marginBottom:n.marginLeft))}),r},t.prototype.getScrollCntEle=function(e){var i=this.isVertical?".e-vscroll-content":".e-hscroll-content";return e.querySelector(i)},t.prototype.checkOverflow=function(e,i){if(g(e)||g(i)||!wr(e))return!1;var r=this.isVertical?e.offsetHeight:e.offsetWidth,n=this.isVertical?i.offsetHeight:i.offsetWidth;(this.tbarAlign||this.scrollModule||r===n)&&(n=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(i):i));var s=e.querySelector("."+ks),a=e.querySelector("."+Uk),l=0;return s?l=this.isVertical?s.offsetHeight:s.offsetWidth:a&&(l=this.isVertical?a.offsetHeight*2:a.offsetWidth*2),r>=n&&a?!1:n>r-l},t.prototype.refreshOverflow=function(){this.resize()},t.prototype.toolbarAlign=function(e){this.tbarAlign&&(this.add(e,ro),this.itemPositioning())},t.prototype.renderOverflowMode=function(){var e=this.element,i=e.querySelector("."+sr),r=this.popupPriCount>0;if(e&&e.children.length>0)switch(this.offsetWid=e.offsetWidth,this.remove(this.element,"e-toolpop"),j.info.name==="msie"&&this.height==="auto"&&(e.style.height=""),this.overflowMode){case"Scrollable":g(this.scrollModule)&&this.initScroll(e,[].slice.call(e.getElementsByClassName(sr)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(e,i)||r)&&this.setOverflowAttributes(e),this.toolbarAlign(i);break;case"MultiRow":this.add(i,qk),this.checkOverflow(e,i)&&this.tbarAlign&&(this.removePositioning(),this.add(i,Yk)),e.style.overflow==="hidden"&&(e.style.overflow=""),(j.info.name==="msie"||e.style.height!=="auto")&&(e.style.height="auto");break;case"Extended":this.add(this.element,Gk),(this.checkOverflow(e,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(e)),this.toolbarAlign(i)}},t.prototype.setOverflowAttributes=function(e){this.createPopupEle(e,[].slice.call(ze("."+sr+" ."+$i,e)));var i={tabindex:"0",role:"button","aria-haspopup":"true","aria-label":"overflow"};Ee(this.element.querySelector("."+ks),i)},t.prototype.separator=function(){var e=this.element,i=[].slice.call(e.querySelectorAll("."+Zi)),r=e.querySelector("."+nI),n=e.querySelector("."+sI),s=this.overflowMode==="MultiRow"?r:n;s!==null&&(this.overflowMode==="MultiRow"?s.classList.remove(nI):this.overflowMode==="Extended"&&s.classList.remove(sI));for(var a=0;a<=i.length-1;a++)i[parseInt(a.toString(),10)].offsetLeft<30&&i[parseInt(a.toString(),10)].offsetLeft!==0&&(this.overflowMode==="MultiRow"?i[parseInt(a.toString(),10)].classList.add(nI):this.overflowMode==="Extended"&&i[parseInt(a.toString(),10)].classList.add(sI))},t.prototype.createPopupEle=function(e,i){var r=e.querySelector("."+ks),n=this.isVertical;r||this.createPopupIcon(e),r=e.querySelector("."+ks);var s=n?r.offsetHeight:r.offsetWidth,a=(n?e.offsetHeight:e.offsetWidth)-s;this.element.classList.remove("e-rtl"),Ze(this.element,{direction:"initial"}),this.checkPriority(e,i,a,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},t.prototype.pushingPoppedEle=function(e,i,r,n,s){var a=e.element,l=[].slice.call(ze("."+vh,a.querySelector("."+sr))),h=ze("."+io,r),c=0,u=0;l.forEach(function(v,m){if(h=ze("."+io,r),v.classList.contains(io)&&h.length>0)e.tbResize&&h.length>m?(r.insertBefore(v,h[parseInt(m.toString(),10)]),++u):(r.insertBefore(v,r.children[h.length]),++u);else if(v.classList.contains(io))r.insertBefore(v,r.firstChild),++u;else if(e.tbResize&&v.classList.contains(iy)&&r.children.length>0&&h.length===0)r.insertBefore(v,r.firstChild),++u;else if(v.classList.contains(iy))i.push(v);else if(e.tbResize)r.insertBefore(v,r.childNodes[c+u]),++c;else{var y=Array.prototype.slice.call(r.children),b=y.slice(m).find(function(S){return!S.classList.contains(ry)});r.insertBefore(v,b||null)}v.classList.contains(Zi)?Ze(v,{display:"",height:s+"px"}):Ze(v,{display:"",height:n+"px"})}),i.forEach(function(v){r.appendChild(v)});for(var d=ze("."+$i,a.querySelector("."+sr)),p=d.length-1;p>=0;p--){var f=d[parseInt(p.toString(),10)];if(f.classList.contains(Zi)&&this.overflowMode!=="Extended")Ze(f,{display:"none"});else break}},t.prototype.createPopup=function(){var e=this.element,i,r;this.overflowMode==="Extended"&&(r=e.querySelector("."+Zi),i=e.style.height==="auto"||e.style.height===""?null:r&&r.offsetHeight);var n=e.querySelector("."+$i+":not(."+Zi+"):not(."+vh+")"),s=e.style.height==="auto"||e.style.height===""?null:n&&n.offsetHeight,a,l=[];if(J("#"+e.id+"_popup."+Mf,e))a=J("#"+e.id+"_popup."+Mf,e);else{var h=this.createElement("div",{id:e.id+"_popup",className:Mf+" "+ny}),c=this.createElement("div",{id:e.id+"_popup",className:Mf});a=this.overflowMode==="Extended"?h:c}this.pushingPoppedEle(this,l,a,s,i),this.popupInit(e,a)},t.prototype.getElementOffsetY=function(){return this.overflowMode==="Extended"&&window.getComputedStyle(this.element).getPropertyValue("box-sizing")==="border-box"?this.element.clientHeight:this.element.offsetHeight},t.prototype.popupInit=function(e,i){if(this.popObj){if(this.overflowMode!=="Extended"){var s=this.popObj.element;Ze(s,{maxHeight:"",display:"block"}),Ze(s,{maxHeight:s.offsetHeight+"px",display:""})}}else{e.appendChild(i),this.cssClass&&X([i],this.cssClass.split(" ")),Ze(this.element,{overflow:""});var r=new es(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(this.overflowMode==="Extended"&&(r.width=this.getToolbarPopupWidth(this.element),r.offsetX=0),r.appendTo(i),document.addEventListener("scroll",this.clickEvent),document.addEventListener("click",this.scrollEvent),this.overflowMode!=="Extended"&&(r.element.style.maxHeight=r.element.offsetHeight+"px"),this.isVertical&&(r.element.style.visibility="hidden"),this.isExtendedOpen){var n=this.element.querySelector("."+ks);n.classList.add(Df),Ai(n.firstElementChild,[ty],[If]),this.element.querySelector("."+ny).classList.add(Hk)}else r.hide();this.popObj=r}},t.prototype.tbarPopupHandler=function(e){this.overflowMode==="Extended"&&(e?this.add(this.element,aI):this.remove(this.element,aI))},t.prototype.popupOpen=function(e){var i=this.popObj;this.isVertical||(i.offsetY=this.getElementOffsetY(),i.dataBind());var r=this.popObj.element,n=this.popObj.element.parentElement,s=n.querySelector("."+ks);s.setAttribute("aria-expanded","true"),this.overflowMode==="Extended"?i.element.style.minHeight="":(Ze(i.element,{height:"auto",maxHeight:""}),i.element.style.maxHeight=i.element.offsetHeight+"px");var a=r.offsetTop+r.offsetHeight+Ar(n).top,l=s.firstElementChild;s.classList.add(Df),Ai(l,[ty],[If]),this.tbarPopupHandler(!0);var h=g(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+h<a&&this.element.offsetTop<r.offsetHeight){var c=r.offsetHeight-(a-window.innerHeight-h+5);i.height=c+"px";for(var u=0;u<=r.childElementCount;u++){var d=r.children[parseInt(u.toString(),10)];if(d.offsetTop+d.offsetHeight>c){c=d.offsetTop;break}}this.overflowMode!=="Extended"&&Ze(i.element,{maxHeight:c+"px"})}else if(this.isVertical&&this.overflowMode!=="Extended"){var p=this.element.getBoundingClientRect();Ze(i.element,{maxHeight:p.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(i){var f=r.getBoundingClientRect();f.right>document.documentElement.clientWidth&&f.width>n.getBoundingClientRect().width&&(i.collision={Y:"none"},i.dataBind()),i.refreshPosition()}},t.prototype.popupClose=function(e){var i=this.element,r=i.querySelector("."+ks);r.setAttribute("aria-expanded","false");var n=r.firstElementChild;r.classList.remove(Df),Ai(n,[If],[ty]),this.tbarPopupHandler(!1)},t.prototype.checkPriority=function(e,i,r,n){for(var s=this.popupPriCount>0,a=i.length,l=r,h,c,u=0,d=0,p=0,f=function(I,D){var M=!1;return D.forEach(function(E){I.classList.contains(E)&&(M=!0)}),M},v=a-1;v>=0;v--){var m=void 0,y=window.getComputedStyle(i[parseInt(v.toString(),10)]);this.isVertical?(m=parseFloat(y.marginTop),m+=parseFloat(y.marginBottom)):(m=parseFloat(y.marginRight),m+=parseFloat(y.marginLeft));var b=i[parseInt(v.toString(),10)]===this.tbarEle[0];b&&(this.tbarEleMrgn=m),h=this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth;var S=b?h+m:h;if(f(i[parseInt(v.toString(),10)],[ry])&&s&&(i[parseInt(v.toString(),10)].classList.add(vh),this.isVertical?Ze(i[parseInt(v.toString(),10)],{display:"none",minHeight:S+"px"}):Ze(i[parseInt(v.toString(),10)],{display:"none",minWidth:S+"px"}),p++),this.isVertical?c=i[parseInt(v.toString(),10)].offsetTop+i[parseInt(v.toString(),10)].offsetHeight+m>r:c=i[parseInt(v.toString(),10)].offsetLeft+i[parseInt(v.toString(),10)].offsetWidth+m>r,c){if(i[parseInt(v.toString(),10)].classList.contains(Zi)){if(this.overflowMode==="Extended"){var C=i[parseInt(v.toString(),10)];f(C,[Zi,Ef])&&(i[parseInt(v.toString(),10)].classList.add(vh),p++),d++}else if(this.overflowMode==="Popup"){if(u>0&&d===p){var C=i[v+d+(u-1)];f(C,[Zi,Ef])&&Ze(C,{display:"none"})}u++,d=0,p=0}}else d++;i[parseInt(v.toString(),10)].classList.contains(io)&&n?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:f(i[parseInt(v.toString(),10)],[Zi,Ef])?r-=(this.isVertical?i[parseInt(v.toString(),10)].offsetHeight:i[parseInt(v.toString(),10)].offsetWidth)+m:(i[parseInt(v.toString(),10)].classList.add(vh),this.isVertical?Ze(i[parseInt(v.toString(),10)],{display:"none",minHeight:S+"px"}):Ze(i[parseInt(v.toString(),10)],{display:"none",minWidth:S+"px"}),p++)}}if(n){var x=ze("."+$i+":not(."+vh+")",this.element);this.checkPriority(e,x,l,!1)}},t.prototype.createPopupIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+yU);r=this.overflowMode==="Extended"?r+" "+SU:r;var n=this.createElement("div",{id:i,className:r});(j.info.name==="msie"||j.info.name==="edge")&&n.classList.add("e-ie-align");var s=this.createElement("div",{className:If+" e-icons"});n.appendChild(s),n.setAttribute("tabindex","0"),n.setAttribute("role","button"),e.appendChild(n)},t.prototype.tbarPriRef=function(e,i,r,n,s,a,l,h,c){var u=h,d=this.popObj.element,p="."+$i+":not(."+Zi+"):not(."+io+")",f=ze("."+vh+":not(."+io+")",d).length,v=function(C,x){return C.classList.contains(x)};if(ze(p,e).length===0){var m=e.children[i-(i-r)-1],y=!g(m)&&v(m,Ef);if(!g(m)&&v(m,Zi)&&!wr(m)||y){m.style.display="unset";var b=m.offsetWidth+parseFloat(window.getComputedStyle(m).marginRight)*2,S=m.previousElementSibling;a+b<l||s?(e.insertBefore(n,e.children[i+u-(i-r)]),g(S)||(S.style.display="")):(Ze(n,c),S.classList.contains(Zi)&&(S.style.display="none")),m.style.display=""}else e.insertBefore(n,e.children[i+u-(i-r)])}else e.insertBefore(n,e.children[i+u-f])},t.prototype.popupRefresh=function(e,i){var r=this,n=this.element,s=this.isVertical,a=n.querySelector("."+sr),l=n.querySelector("."+ks);if(!g(l)){a.removeAttribute("style"),e.style.display="block";var h;s?h=n.offsetHeight-(l.offsetHeight+a.offsetHeight):h=n.offsetWidth-(l.offsetWidth+a.offsetWidth);var c=0;[].slice.call(e.children).forEach(function(u){c+=r.popupEleWidth(u),Ze(u,{position:""})}),h+(s?l.offsetHeight:l.offsetWidth)>c&&this.popupPriCount===0&&(i=!0),this.popupEleRefresh(h,e,i),e.style.display="",e.children.length===0&&l&&this.popObj&&(se(l),l=null,this.popObj.destroy(),se(this.popObj.element),this.popObj=null)}},t.prototype.ignoreEleFetch=function(e,i){var r=[].slice.call(i.querySelectorAll("."+Ef)),n=[],s=0;if(r.length>0)r.forEach(function(a){n.push([].slice.call(i.children).indexOf(a))});else return 0;return n.forEach(function(a){a<=e&&s++}),s},t.prototype.checkPopupRefresh=function(e,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var n=e.offsetWidth-e.querySelector("."+ks).offsetWidth,s=e.querySelector("."+sr).offsetWidth;return i.style.removeProperty("display"),n>r+s},t.prototype.popupEleWidth=function(e){e.style.position="absolute";var i=window.getComputedStyle(e),r=this.isVertical?e.offsetHeight:e.offsetWidth+parseFloat(i.marginLeft)+parseFloat(i.marginRight),n=e.querySelector("."+bU);if(e.classList.contains("e-tbtn-align")||e.classList.contains(iI)){var s=e.children[0];!g(n)&&e.classList.contains(iI)?n.style.display="none":!g(n)&&e.classList.contains(_k)&&(n.style.display="block"),s.style.minWidth="0%",r=parseFloat(this.isVertical?e.style.minHeight:e.style.minWidth),s.style.minWidth="",s.style.minHeight="",g(n)||(n.style.display="")}return r},t.prototype.popupEleRefresh=function(e,i,r){for(var n=this.popupPriCount>0,s=this.tbarEle,a,l,h=this.element.querySelector("."+sr),c=0,u=function(b){if(b.classList.contains(ry)&&n&&!r)return"continue";var S=d.popupEleWidth(b);if(b===d.tbarEle[0]&&(S+=d.tbarEleMrgn),b.style.position="",S<e||r){var C={minWidth:b.style.minWidth,height:b.style.height,minHeight:b.style.minHeight};if(Ze(b,{minWidth:"",height:"",minHeight:""}),b.classList.contains(iy)||b.classList.remove(vh),l=d.tbarEle.indexOf(b),d.tbarAlign){var x=d.items[parseInt(l.toString(),10)].align;l=d.tbarAlgEle[(x+"s").toLowerCase()].indexOf(b),s=d.tbarAlgEle[(x+"s").toLowerCase()],h=d.element.querySelector("."+sr+" .e-toolbar-"+x.toLowerCase())}var I=0;d.overflowMode!=="Extended"&&s.slice(0,l).forEach(function(D){(D.classList.contains(io)||D.classList.contains(Zi))&&(D.classList.contains(Zi)&&(D.style.display="",e-=D.offsetWidth),I++)}),c=d.ignoreEleFetch(l,h),b.classList.contains(io)?(d.tbarPriRef(h,l,I,b,r,S,e,c,C),e-=b.offsetWidth):l===0?(h.insertBefore(b,h.firstChild),e-=b.offsetWidth):(a=ze("."+io,d.popObj.element).length,h.insertBefore(b,h.children[l+c-a]),e-=b.offsetWidth),b.style.height=""}else return"break"},d=this,p=0,f=[].slice.call(i.children);p<f.length;p++){var v=f[p],m=u(v);if(m==="break")break}var y=this.checkOverflow(this.element,this.element.getElementsByClassName(sr)[0]);y&&!r&&this.renderOverflowMode()},t.prototype.removePositioning=function(){var e=this.element.querySelector("."+sr);if(!(g(e)||!e.classList.contains(ro))){this.remove(e,ro);var i=[].slice.call(e.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},t.prototype.refreshPositioning=function(){var e=this.element.querySelector("."+sr);this.add(e,ro),this.itemPositioning()},t.prototype.itemPositioning=function(){var e=this.element.querySelector("."+sr),i;if(!(g(e)||!e.classList.contains(ro))){var r=this.element.querySelector("."+ks),n;if(this.scrollModule){var s=this.isVertical?mU:vU;n=[].slice.call(e.querySelector("."+s).children)}else n=[].slice.call(e.childNodes);this.isVertical?i=n[0].offsetHeight+n[2].offsetHeight:i=n[0].offsetWidth+n[2].offsetWidth;var a=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(r){a-=this.isVertical?r.offsetHeight:r.offsetWidth;var l=(this.isVertical?r.offsetHeight:r.offsetWidth)+"px";n[2].removeAttribute("style"),this.isVertical?this.enableRtl?n[2].style.top=l:n[2].style.bottom=l:this.enableRtl?n[2].style.left=l:n[2].style.right=l}if(!(a<=i)){var h=(a-i-(this.isVertical?n[1].offsetHeight:n[1].offsetWidth))/2;n[1].removeAttribute("style");var c=(this.isVertical?n[0].offsetHeight:n[0].offsetWidth)+h+"px";this.isVertical?this.enableRtl?n[1].style.marginBottom=c:n[1].style.marginTop=c:this.enableRtl?n[1].style.marginRight=c:n[1].style.marginLeft=c}}},t.prototype.tbarItemAlign=function(e,i,r){var n=this;if(!(e.showAlwaysInPopup&&e.overflow!=="Show")){var s=[];if(s.push(this.createElement("div",{className:gU,attrs:{role:"group"}})),s.push(this.createElement("div",{className:Wk,attrs:{role:"group"}})),s.push(this.createElement("div",{className:fU,attrs:{role:"group"}})),r===0&&e.align!=="Left")s.forEach(function(h){i.appendChild(h)}),this.tbarAlign=!0,this.add(i,ro);else if(e.align!=="Left"){var a=i.childNodes,l=s[0];[].slice.call(a).forEach(function(h){n.tbarAlgEle.lefts.push(h),l.appendChild(h)}),i.appendChild(l),i.appendChild(s[1]),i.appendChild(s[2]),this.tbarAlign=!0,this.add(i,ro)}}},t.prototype.ctrlTemplate=function(){var e=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,sr),this.tbarEle=[];var i=[].slice.call(this.trgtEle.children);i.forEach(function(r){r.tagName==="DIV"&&(e.tbarEle.push(r),g(r.firstElementChild)||r.firstElementChild.setAttribute("aria-disabled","false"),e.add(r,$i))})},t.prototype.renderItems=function(){var e=this.element,i=this.items;if(this.trgtEle!=null)this.ctrlTemplate();else if(e&&i.length>0){var r=void 0;e&&e.children.length>0&&(r=e.querySelector("."+sr)),r||(r=this.createElement("div",{className:sr})),this.itemsAlign(i,r),e.appendChild(r)}},t.prototype.setAttr=function(e,i){for(var r=Object.keys(e),n,s=0;s<r.length;s++)n=r[parseInt(s.toString(),10)],n==="class"?this.add(i,e[""+n]):i.setAttribute(n,e[""+n])},t.prototype.enableItems=function(e,i){var r=this,n=e,s=n.length,a;g(i)&&(i=!0);var l=function(d,p){d?(p.classList.remove(jn),g(p.firstElementChild)||(p.firstElementChild.setAttribute("aria-disabled","false"),r.updateTabIndex("0"))):(p.classList.add(jn),g(p.firstElementChild)||(p.firstElementChild.setAttribute("aria-disabled","true"),p.firstElementChild.setAttribute("tabindex","-1"),r.updateTabIndex("0")))};if(!g(s)&&s>=1){for(var h=0,c=[].slice.call(n);h<s;h++){var u=c[parseInt(h.toString(),10)];if(typeof u=="number"){if(a=this.getElementByIndex(u),g(a))return;n[parseInt(h.toString(),10)]=a}else a=u;l(i,a)}i?Z(n,jn):X(n,jn)}else{if(typeof n=="number"){if(a=this.getElementByIndex(n),g(a))return}else a=e;l(i,a)}},t.prototype.getElementByIndex=function(e){return this.tbarEle[parseInt(e.toString(),10)]?this.tbarEle[parseInt(e.toString(),10)]:null},t.prototype.addItems=function(e,i){var r;this.extendedOpen();var n=this.element.querySelector("."+sr);if(g(n)){this.itemsRerender(e);return}var s,a="Left";g(i)&&(i=0),e.forEach(function(p){!g(p.align)&&p.align!=="Left"&&a==="Left"&&(a=p.align)});for(var l=0,h=e;l<h.length;l++){var c=h[l];if(g(c.type)&&(c.type="Button"),r=ze("."+$i,this.element),c.align=a,s=this.renderSubComponent(c,i),this.tbarEle.length>=i&&r.length>=0){g(this.scrollModule)&&this.destroyMode();var u=c.align[0]==="L"?0:c.align[0]==="C"?1:2,d=void 0;!this.tbarAlign&&a!=="Left"?(this.tbarItemAlign(c,n,1),this.tbarAlign=!0,d=H(r[0],"."+sr).children[parseInt(u.toString(),10)],d.appendChild(s),this.tbarAlgEle[(c.align+"s").toLowerCase()].push(s),this.refreshPositioning()):this.tbarAlign?(d=H(r[0],"."+sr).children[parseInt(u.toString(),10)],d.insertBefore(s,d.children[parseInt(i.toString(),10)]),this.tbarAlgEle[(c.align+"s").toLowerCase()].splice(i,0,s),this.refreshPositioning()):r.length===0?(r=ze("."+sr,this.element),r[0].appendChild(s)):r[0].parentNode.insertBefore(s,r[parseInt(i.toString(),10)]),this.items.splice(i,0,c),c.template&&this.tbarEle.splice(this.tbarEle.length-1,1),this.tbarEle.splice(i,0,s),i++,this.offsetWid=n.offsetWidth}}n.style.width="",this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.removeItems=function(e){var i=e,r,n=[].slice.call(ze("."+$i,this.element));if(typeof i=="number")r=parseInt(e.toString(),10),this.removeItemByIndex(r,n);else if(i&&i.length>1)for(var s=0,a=[].slice.call(i);s<a.length;s++){var l=a[s];r=this.tbarEle.indexOf(l),this.removeItemByIndex(r,n),n=ze("."+$i,this.element)}else{var l=i&&i.length&&i.length===1?i[0]:e;r=n.indexOf(l),this.removeItemByIndex(r,n)}this.resize()},t.prototype.removeItemByIndex=function(e,i){if(this.tbarEle[parseInt(e.toString(),10)]&&i[parseInt(e.toString(),10)]){var r=this.tbarEle.indexOf(i[parseInt(e.toString(),10)]);if(this.tbarAlign){var n=this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].indexOf(this.tbarEle[parseInt(r.toString(),10)]);this.tbarAlgEle[(this.items[parseInt(r.toString(),10)].align+"s").toLowerCase()].splice(parseInt(n.toString(),10),1)}this.isReact&&this.clearToolbarTemplate(i[parseInt(e.toString(),10)]);var s=i[parseInt(e.toString(),10)].querySelector(".e-control.e-btn");!g(s)&&!g(s.ej2_instances[0])&&!s.ej2_instances[0].isDestroyed&&s.ej2_instances[0].destroy(),se(i[parseInt(e.toString(),10)]),this.items.splice(r,1),this.tbarEle.splice(r,1)}},t.prototype.templateRender=function(e,i,r,n){var s=r.type,a=e,l;if(typeof e=="object"&&(l=typeof a.appendTo=="function"),typeof e=="string"||!l){var h=void 0,c=e,u=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);c=typeof e=="string"?e.trim():e;try{if(typeof e=="object"&&!g(e.tagName))i.appendChild(e);else if(typeof e=="string"&&u.test(c))i.innerHTML=c;else if(document.querySelectorAll(c).length){var d=document.querySelector(c),p=d.outerHTML.trim();i.appendChild(d),d.style.display="",g(p)||this.tempId.push(c)}else h=Et(c)}catch{h=Et(c)}var f=void 0;if(!g(h)){var v=this.element.id+n+"_template";f=h({},this,"template",v,this.isStringTemplate,void 0,void 0,this.root)}!g(f)&&f.length>0&&[].slice.call(f).forEach(function(y){g(y.tagName)||(y.style.display=""),i.appendChild(y)})}else if(s==="Input"){var d=this.createElement("input");r.id?d.id=r.id:d.id=Lt("tbr-ipt"),i.appendChild(d),a.appendTo(d)}this.add(i,Vk);var m=i.firstElementChild;g(m)||(m.setAttribute("tabindex",g(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m)),m.setAttribute("data-tabindex",g(m.getAttribute("tabIndex"))?"-1":this.getDataTabindex(m))),this.tbarEle.push(i)},t.prototype.buttonRendering=function(e,i){var r=this.createElement("button",{className:pU});r.setAttribute("type","button");var n=e.text,s,a;e.id?r.id=e.id:r.id=Lt("e-tbr-btn");var l=this.createElement("span",{className:"e-tbar-btn-text"});n?(l.innerHTML=this.enableHtmlSanitizer?Pt.sanitize(n):n,r.appendChild(l),r.classList.add("e-tbtn-txt")):this.add(i,"e-tbtn-align"),(e.prefixIcon||e.suffixIcon)&&(e.prefixIcon&&e.suffixIcon||e.prefixIcon?(s=e.prefixIcon+" e-icons",a="Left"):(s=e.suffixIcon+" e-icons",a="Right"));var h=new Jn({iconCss:s,iconPosition:a});return h.createElement=this.createElement,h.appendTo(r),e.width&&Ze(r,{width:Ae(e.width)}),r},t.prototype.renderSubComponent=function(e,i){var r,n=this.createElement("div",{className:$i}),s=this.createElement("div",{innerHTML:this.enableHtmlSanitizer&&!g(e.tooltipText)?Pt.sanitize(e.tooltipText):e.tooltipText});if(this.tbarEle||(this.tbarEle=[]),e.htmlAttributes&&this.setAttr(e.htmlAttributes,n),e.tooltipText&&n.setAttribute("title",s.textContent),e.cssClass&&(n.className=n.className+" "+e.cssClass),e.template)this.templateRender(e.template,n,e,i);else switch(e.type){case"Button":r=this.buttonRendering(e,n),r.setAttribute("tabindex",g(e.tabIndex)?"-1":e.tabIndex.toString()),r.setAttribute("data-tabindex",g(e.tabIndex)?"-1":e.tabIndex.toString()),r.setAttribute("aria-label",e.text||e.tooltipText),r.setAttribute("aria-disabled","false"),n.appendChild(r),n.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(n,Zi);break}if(e.showTextOn){var a=e.showTextOn;a==="Toolbar"?(this.add(n,_k),this.add(n,"e-tbtn-align")):a==="Overflow"&&this.add(n,iI)}if(e.overflow){var l=e.overflow;l==="Show"?this.add(n,io):l==="Hide"&&(n.classList.contains(Zi)||this.add(n,iy))}return e.overflow!=="Show"&&e.showAlwaysInPopup&&!n.classList.contains(Zi)&&(this.add(n,ry),this.popupPriCount++),e.disabled&&this.add(n,jn),e.visible===!1&&this.add(n,no),n},t.prototype.getDataTabindex=function(e){return g(e.getAttribute("data-tabindex"))?"-1":e.getAttribute("data-tabindex")},t.prototype.itemClick=function(e){this.activeEleSwitch(e.currentTarget)},t.prototype.activeEleSwitch=function(e){this.activeEleRemove(e.firstElementChild),this.activeEle.focus()},t.prototype.activeEleRemove=function(e){var i=this.element.querySelector("."+$i+":not(."+jn+" ):not(."+Zi+" ):not(."+no+" )");if(g(this.activeEle)||(this.activeEle.setAttribute("tabindex",this.getDataTabindex(this.activeEle)),i&&i.removeAttribute("tabindex"),i=this.activeEle),this.activeEle=e,this.getDataTabindex(this.activeEle)==="-1")if(g(this.trgtEle)&&!e.parentElement.classList.contains(Vk)){if(!g(this.element.querySelector(".e-hor-nav"))&&this.element.querySelector(".e-hor-nav").classList.contains("e-nav-active")){this.updateTabIndex("0");var r=this.getDataTabindex(i)==="-1"?"0":this.getDataTabindex(i);i.setAttribute("tabindex",r)}else this.updateTabIndex("-1");e.removeAttribute("tabindex")}else{var n=parseInt(this.getDataTabindex(this.activeEle),10)+1;this.activeEle.setAttribute("tabindex",n.toString())}},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.getModuleName=function(){return"toolbar"},t.prototype.itemsRerender=function(e){this.items=this.tbarItemsCol,(this.isReact||this.isAngular)&&this.clearTemplate(),this.destroyMode(),this.destroyItems(),this.items=e,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.resize=function(){var e=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&this.overflowMode==="Popup"&&this.popObj.hide();var i=this.checkOverflow(e,e.getElementsByClassName(sr)[0]);if(!i){this.destroyScroll();var r=e.querySelector("."+sr);g(r)||(this.remove(r,Yk),this.tbarAlign&&this.add(r,ro))}i&&this.scrollModule&&this.offsetWid===e.offsetWidth||((this.offsetWid>e.offsetWidth||i)&&this.renderOverflowMode(),this.popObj&&(this.overflowMode==="Extended"&&(this.popObj.width=this.getToolbarPopupWidth(this.element)),this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()),this.element.querySelector("."+rI)&&(this.scrollStep=this.element.querySelector("."+rI).offsetWidth),this.offsetWid=e.offsetWidth,this.tbResize=!1,this.separator())},t.prototype.orientationChange=function(){var e=this;setTimeout(function(){e.resize()},500)},t.prototype.extendedOpen=function(){var e=this.element.querySelector("."+ny);this.overflowMode==="Extended"&&e&&(this.isExtendedOpen=e.classList.contains(Hk))},t.prototype.updateHideEleTabIndex=function(e,i,r,n,s){r&&(n=s.indexOf(e));for(var a=s[++n];a;){var l=this.eleContains(a);if(!l){var h=a.firstElementChild.getAttribute("data-tabindex");i&&h==="-1"?a.firstElementChild.setAttribute("tabindex","0"):h!==a.firstElementChild.getAttribute("tabindex")&&a.firstElementChild.setAttribute("tabindex",h);break}a=s[++n]}},t.prototype.clearToolbarTemplate=function(e){if(this.registeredTemplate&&this.registeredTemplate.template)for(var i=this.registeredTemplate,r=0;r<i.template.length;r++){var n=i.template[parseInt(r.toString(),10)].rootNodes[0],s=H(n,"."+$i);if(!g(s)&&s===e){this.clearTemplate(["template"],[i.template[parseInt(r.toString(),10)]]);break}}else if(this.portals&&this.portals.length>0)for(var a=this.portals,r=0;r<a.length;r++){var l=a[parseInt(r.toString(),10)],s=H(l.containerInfo,"."+$i);if(!g(s)&&s===e){this.clearTemplate(["template"],r);break}}},t.prototype.onPropertyChanged=function(e,i){var r=this.element;this.extendedOpen();for(var n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"items":if(e.items instanceof Array&&i.items instanceof Array)this.itemsRerender(e.items);else for(var l=Object.keys(e.items),h=0;h<l.length;h++){var c=parseInt(Object.keys(e.items)[parseInt(h.toString(),10)],10),u=Object.keys(e.items[parseInt(c.toString(),10)])[0],d=Object(e.items[parseInt(c.toString(),10)])[""+u];if(this.tbarAlign||u==="align"){this.refresh(),this.trigger("created");break}var p=u==="showAlwaysInPopup"&&!d,f=u==="overflow"&&this.popupPriCount!==0;(p||this.items[parseInt(c.toString(),10)].showAlwaysInPopup&&f)&&--this.popupPriCount,g(this.scrollModule)&&this.destroyMode();var v=[].slice.call(ze("."+sr+" ."+$i,r));this.isReact&&this.items[parseInt(c.toString(),10)].template&&this.clearToolbarTemplate(v[parseInt(c.toString(),10)]),se(v[parseInt(c.toString(),10)]),this.tbarEle.splice(c,1),this.addItems([this.items[parseInt(c.toString(),10)]],c),this.items.splice(c,1),this.items[parseInt(c.toString(),10)].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":Ze(r,{width:Ae(e.width)}),this.refreshOverflow();break;case"height":Ze(this.element,{height:Ae(e.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(r,ko),this.refreshOverflow();break;case"enableRtl":e.enableRtl?this.add(r,ko):this.remove(r,ko),g(this.scrollModule)||(e.enableRtl?this.add(this.scrollModule.element,ko):this.remove(this.scrollModule.element,ko)),g(this.popObj)||(e.enableRtl?this.add(this.popObj.element,ko):this.remove(this.popObj.element,ko)),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"});break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(" ")),e.cssClass&&X([this.element],e.cssClass.split(" "));break;case"allowKeyboard":this.unwireKeyboardEvent(),e.allowKeyboard&&this.wireKeyboardEvent();break}}},t.prototype.hideItem=function(e,i){var r=typeof e=="object",n=e,s;if(!(!r&&g(n))){var a=[].slice.call(ze("."+$i,this.element));if(r)s=e;else if(this.tbarEle[parseInt(n.toString(),10)]){var l=[].slice.call(ze("."+$i,this.element));s=l[parseInt(n.toString(),10)]}s&&(i?(s.classList.add(no),s.classList.contains(Zi)||(g(s.firstElementChild.getAttribute("tabindex"))||s.firstElementChild.getAttribute("tabindex")!=="-1")&&this.updateHideEleTabIndex(s,i,r,n,a)):(s.classList.remove(no),s.classList.contains(Zi)||this.updateHideEleTabIndex(s,i,r,n,a)),this.refreshOverflow())}},Ei([Gt([],Sy)],t.prototype,"items",void 0),Ei([w("auto")],t.prototype,"width",void 0),Ei([w("auto")],t.prototype,"height",void 0),Ei([w("")],t.prototype,"cssClass",void 0),Ei([w("Scrollable")],t.prototype,"overflowMode",void 0),Ei([w()],t.prototype,"scrollStep",void 0),Ei([w(!0)],t.prototype,"enableCollision",void 0),Ei([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Ei([w(!0)],t.prototype,"allowKeyboard",void 0),Ei([G()],t.prototype,"clicked",void 0),Ei([G()],t.prototype,"created",void 0),Ei([G()],t.prototype,"destroyed",void 0),Ei([G()],t.prototype,"beforeCreate",void 0),Ei([G()],t.prototype,"keyDown",void 0),t=Ei([It],t),t})(ti);var CU=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Zu=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Qk="e-contextmenu-template",Cy=(function(o){CU(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.isMenu=!1,this.element.id=this.element.id||Lt("ej2-contextmenu"),o.prototype.preRender.call(this)},t.prototype.initialize=function(){this.template=this.itemTemplate?this.itemTemplate:null,this.addTemplateClass(),o.prototype.initialize.call(this),Ee(this.element,{role:"menubar",tabindex:"0"}),this.element.style.zIndex=Gs(this.element).toString()},t.prototype.open=function(e,i,r){o.prototype.openMenu.call(this,null,null,e,i,null,r)},t.prototype.close=function(){o.prototype.closeMenu.call(this)},t.prototype.addTemplateClass=function(){(!g(this.itemTemplate)&&typeof this.itemTemplate=="function"||typeof this.itemTemplate=="string"&&this.itemTemplate!=="")&&X([this.element],Qk)},t.prototype.onPropertyChanged=function(e,i){o.prototype.onPropertyChanged.call(this,e,i);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"filter":this.close(),this.filter=e.filter;break;case"target":this.unWireEvents(i.target),this.wireEvents();break;case"itemTemplate":this.itemTemplate=e.itemTemplate,Z([this.element],Qk),this.addTemplateClass(),this.refresh()}}},t.prototype.getModuleName=function(){return"contextmenu"},Zu([w("")],t.prototype,"target",void 0),Zu([w("")],t.prototype,"filter",void 0),Zu([Gt([],td)],t.prototype,"items",void 0),Zu([w(null)],t.prototype,"itemTemplate",void 0),Zu([w(!1)],t.prototype,"enableScrolling",void 0),t=Zu([It],t),t})(gF),wU=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ml=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},so="e-vertical",xU="e-scrollable",oI="e-hamburger",bc=(function(o){wU(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.tempItems=[],r}return t.prototype.getModuleName=function(){return"menu"},t.prototype.preRender=function(){if(this.isMenu=!0,this.element.id=this.element.id||Lt("ej2-menu"),this.template){try{typeof this.template!="function"&&document.querySelectorAll(this.template).length&&(this.template=document.querySelector(this.template).innerHTML.trim(),this.clearChanges())}catch{}this.updateMenuItems(this.items)}else this.updateMenuItems(this.items);o.prototype.preRender.call(this)},t.prototype.initialize=function(){o.prototype.initialize.call(this),Ee(this.element,{role:"menubar",tabindex:"0"}),this.orientation==="Vertical"?(this.element.classList.add(so),this.hamburgerMode&&!this.target&&this.element.previousElementSibling.classList.add(so),this.element.setAttribute("aria-orientation","vertical")):j.isDevice&&!this.enableScrolling&&this.element.parentElement.classList.add(xU),this.hamburgerMode&&(this.element.parentElement.classList.add(oI),this.orientation==="Horizontal"&&this.element.classList.add("e-hide-menu"))},t.prototype.updateMenuItems=function(e){this.tempItems=e,this.items=[],this.tempItems.map(this.createMenuItems,this),this.setProperties({items:this.items},!0),this.tempItems=[]},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"orientation":e.orientation==="Vertical"?(this.element.classList.add(so),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.add(so),this.element.classList.remove("e-hide-menu")),this.element.setAttribute("aria-orientation","vertical")):(this.element.classList.remove(so),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.remove(so),this.element.classList.add("e-hide-menu")),this.element.removeAttribute("aria-orientation"));break;case"items":Object.keys(i.items).length||this.updateMenuItems(e.items);break;case"hamburgerMode":this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),e.hamburgerMode?(this.element.parentElement.classList.add(oI),[].slice.call(this.element.getElementsByClassName("e-blankicon")).forEach(function(l){l.style[r.enableRtl?"paddingRight":"paddingLeft"]=""})):(this.element.parentElement.classList.remove(oI),this.orientation==="Vertical"&&this.setBlankIconStyle(this.element)),this.orientation==="Vertical"?(this.target||this.element.previousElementSibling.classList.add(so),this.element.classList.remove("e-hide-menu")):(this.target?this.element.previousElementSibling.classList.add(so):this.element.previousElementSibling.classList.remove(so),this.element.classList[e.hamburgerMode?"add":"remove"]("e-hide-menu"));break;case"title":this.hamburgerMode&&this.element.previousElementSibling&&(e.title=this.enableHtmlSanitizer?Pt.sanitize(e.title):e.title,this.element.previousElementSibling.querySelector(".e-menu-title").innerHTML=e.title);break;case"target":this.hamburgerMode&&(this.unWireEvents(i.target),this.wireEvents(),this.orientation==="Horizontal"&&(e.target?this.element.previousElementSibling.classList.add(so):(this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),this.element.previousElementSibling.classList.remove(so)),this.element.classList.add("e-hide-menu")));break;case"template":this.template=e.template,this.refresh();break}}o.prototype.onPropertyChanged.call(this,e,i)},t.prototype.createMenuItems=function(e){var i,r,n=this.items,s=this.getField("parentId");if(e[""+s]){for(i=this.getIndex(e[""+s].toString(),!0),r=0;r<i.length;r++)n[i[r]].items||(n[i[r]].items=[]),n=n[i[r]].items;n.push(e)}else this.items.push(e)},t.prototype.open=function(){o.prototype.openHamburgerMenu.call(this)},t.prototype.close=function(){o.prototype.closeHamburgerMenu.call(this)},ml([w("Horizontal")],t.prototype,"orientation",void 0),ml([w("")],t.prototype,"target",void 0),ml([w(null)],t.prototype,"template",void 0),ml([w(!1)],t.prototype,"enableScrolling",void 0),ml([w(!1)],t.prototype,"hamburgerMode",void 0),ml([w("Menu")],t.prototype,"title",void 0),ml([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),ml([Ce({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},fF)],t.prototype,"fields",void 0),t=ml([It],t),t})(gF),Ff=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Rt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},mh="e-tab",Hn="e-tab-header",IU="blazor-template",ii="e-content",sy="e-nested",MU="e-items",Vr="e-item",lI="e-template",ay="e-rtl",Di="e-active",yl="e-disable",Ni="e-hidden",hI="e-focused",cI="e-icons",uI="e-icon",Xk="e-icon-tab",dI="e-close-icon",oy="e-close-show",Tf="e-tab-text",Af="e-indicator",Ks="e-tab-wrap",ly="e-text-wrap",Kk="e-tab-icon",Fs="e-toolbar-items",Ut="e-toolbar-item",$k="e-toolbar-pop",bl="e-toolbar-popup",DU="e-hor-nav",EU="e-popup-open",TU="e-popup-close",hy="e-progress",AU="e-ignore",pI="e-overlay",LU="e-hscroll-content",NU="e-vscroll-content",fI="e-vertical-tab",gI="e-vertical",Zk="e-vertical-left",Jk="e-vertical-right",eF="e-horizontal-bottom",vI="e-fill-mode",tF="tabitem_",mI="e-reorder-active-item",iF=(function(o){Ff(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Rt([w("SlideLeftIn")],t.prototype,"effect",void 0),Rt([w(600)],t.prototype,"duration",void 0),Rt([w("ease")],t.prototype,"easing",void 0),t})(Oe),kU=(function(o){Ff(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Rt([Ce({effect:"SlideLeftIn",duration:600,easing:"ease"},iF)],t.prototype,"previous",void 0),Rt([Ce({effect:"SlideRightIn",duration:600,easing:"ease"},iF)],t.prototype,"next",void 0),t})(Oe),FU=(function(o){Ff(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Rt([w("")],t.prototype,"text",void 0),Rt([w("")],t.prototype,"iconCss",void 0),Rt([w("left")],t.prototype,"iconPosition",void 0),t})(Oe),RU=(function(o){Ff(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Rt([Ce({},FU)],t.prototype,"header",void 0),Rt([w(null)],t.prototype,"headerTemplate",void 0),Rt([w("")],t.prototype,"content",void 0),Rt([w("")],t.prototype,"cssClass",void 0),Rt([w(!1)],t.prototype,"disabled",void 0),Rt([w(!0)],t.prototype,"visible",void 0),Rt([w()],t.prototype,"id",void 0),Rt([w(-1)],t.prototype,"tabIndex",void 0),t})(Oe),wy=(function(o){Ff(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.show={},r.hide={},r.maxHeight=0,r.title="Close",r.isInteracted=!1,r.lastIndex=0,r.isAdd=!1,r.isIconAlone=!1,r.draggableItems=[],r.resizeContext=r.refreshActiveTabBorder.bind(r),r.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},r}return t.prototype.destroy=function(){if((this.isReact||this.isAngular)&&this.clearTemplate(),g(this.tbObj)||(this.tbObj.destroy(),this.tbObj=null),this.unWireEvents(),this.element.removeAttribute("aria-disabled"),this.expTemplateContent(),this.isTemplate){var e=J("."+mh+" > ."+ii,this.element);this.element.classList.remove(lI),g(e)||(e.innerHTML=this.cnt)}else for(;this.element.firstElementChild;)Qe(this.element.firstElementChild);if(this.btnCls&&(this.btnCls=null),this.hdrEle=null,this.cntEle=null,this.tbItems=null,this.tbItem=null,this.tbPop=null,this.prevItem=null,this.popEle=null,this.bdrLine=null,this.content=null,this.dragItem=null,this.cloneElement=null,this.draggingItems=[],this.draggableItems&&this.draggableItems.length>0){for(var i=0;i<this.draggableItems.length;i++)this.draggableItems[i].destroy(),this.draggableItems[i]=null;this.draggableItems=[]}o.prototype.destroy.call(this),this.trigger("destroyed")},t.prototype.refresh=function(){this.isReact&&this.clearTemplate(),o.prototype.refresh.call(this),this.isReact&&this.renderReactTemplates()},t.prototype.refreshOverflow=function(){g(this.tbObj)||this.tbObj.refreshOverflow()},t.prototype.preRender=function(){var e=H(this.element,"."+ii);this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwiped=!1,this.itemIndexArray=[],this.templateEle=[],this.allowDragAndDrop&&(this.dragArea=g(this.dragArea)?"#"+this.element.id+" "+("."+Hn):this.dragArea),g(e)||(e.parentElement.classList.add(sy),this.isNested=!0);var i=j.info.name,r=i==="msie"?"e-ie":i==="edge"?"e-edge":i==="safari"?"e-safari":"";Ze(this.element,{width:Ae(this.width),height:Ae(this.height)}),this.setCssClass(this.element,this.cssClass,!0),Ee(this.element,{"aria-disabled":"false"}),this.setCssClass(this.element,r,!0),this.updatePopAnimationConfig()},t.prototype.render=function(){var e=this;this.btnCls=this.createElement("span",{className:cI+" "+dI,attrs:{title:this.title}}),this.tabId=this.element.id.length>0?"-"+this.element.id:Fw(),this.renderContainer(),this.wireEvents(),this.initRender=!1,this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){e.refreshOverflow(),e.selectingContent(e.selectedItem,e.isInteracted),e.refreshActiveBorder()})},t.prototype.renderContainer=function(){var e=this.element;if(this.items.forEach(function(n,s){g(n.id)&&!g(n.setProperties)&&n.setProperties({id:tF+s.toString()},!0)}),this.items.length>0&&e.children.length===0)e.appendChild(this.createElement("div",{className:ii})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:Hn})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,e.classList.add(lI);var i=e.querySelector("."+Hn);i&&this.headerPlacement==="Bottom"&&this.setOrientation(this.headerPlacement,i)}if(!g(J("."+Hn,this.element))&&!g(J("."+ii,this.element))){if(this.renderHeader(),this.tbItems=J("."+Hn+" ."+Fs,this.element),g(this.tbItems)||Wi(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),ze("."+Ut,this.element).length>0){this.tbItems=J("."+Hn+" ."+Fs,this.element),this.bdrLine=this.createElement("div",{className:Af+" "+Ni+" "+AU});var r=J("."+this.scrCntClass,this.tbItems);g(r)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):r.insertBefore(this.bdrLine,r.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}},t.prototype.renderHeader=function(){var e=this,i=this.headerPlacement,r=[];if(this.hdrEle=this.getTabHeader(),this.addVerticalClass(),!this.isTemplate)r=this.parseObject(this.items,0);else{this.element.children.length>1&&this.element.children[1].classList.contains(Hn)&&this.setProperties({headerPlacement:"Bottom"},!0);for(var n=this.hdrEle.children.length,s=[],a=0;a<n;a++)s.push(this.hdrEle.children.item(a));if(n>0){var l=this.createElement("div",{className:MU});this.hdrEle.appendChild(l),s.forEach(function(c,u){e.lastIndex=u;var d={className:Vr,id:Vr+e.tabId+"_"+u},p=e.createElement("span",{className:Tf,attrs:{role:"presentation"}}).outerHTML,f=e.createElement("div",{className:ly,innerHTML:p+e.btnCls.outerHTML}).outerHTML,v=e.createElement("div",{className:Ks,innerHTML:f,attrs:{role:"tab",tabIndex:"-1","aria-selected":"false","aria-controls":ii+e.tabId+"_"+u,"aria-disabled":"false"}});v.querySelector("."+Tf).appendChild(c),l.appendChild(e.createElement("div",d)),ze("."+Vr,l)[u].appendChild(v)})}}this.tbObj=new yc({width:i==="Left"||i==="Right"?"auto":"100%",height:i==="Left"||i==="Right"?"100%":"auto",overflowMode:this.overflowMode,items:r.length!==0?r:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep,enableHtmlSanitizer:this.enableHtmlSanitizer,cssClass:this.cssClass}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle),Ee(this.hdrEle,{role:"tablist"}),g(this.element.getAttribute("aria-label"))?g(this.element.getAttribute("aria-labelledby"))||(this.hdrEle.setAttribute("aria-labelledby",this.element.getAttribute("aria-labelledby")),this.element.removeAttribute("aria-labelledby")):(this.hdrEle.setAttribute("aria-label",this.element.getAttribute("aria-label")),this.element.removeAttribute("aria-label")),this.setCloseButton(this.showCloseButton);var h=this.tbObj.element.querySelector("."+Fs);g(h)||(g(h.id)||h.id==="")&&(h.id=this.element.id+"_tab_header_items")},t.prototype.createContentElement=function(e){var i=this.createElement("div",{id:ii+this.tabId+"_"+e,className:Vr,attrs:{role:"tabpanel","aria-labelledby":Vr+this.tabId+"_"+e}});return(["Dynamic","Demand"].indexOf(this.loadOn)!==-1||this.loadOn==="Init"&&e===this.selectedItem)&&X([i],Di),i},t.prototype.renderContent=function(){this.cntEle=J("."+ii,this.element);var e=ze("."+Ut,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var i=this.cntEle.children,r=0;r<e.length;r++)i.length-1>=r&&(X([i.item(r)],Vr),Ee(i.item(r),{role:"tabpanel","aria-labelledby":Vr+this.tabId+"_"+r}),i.item(r).id=ii+this.tabId+"_"+r)}else if(ze("."+Ut,this.element).length>0)if(this.loadOn==="Init")for(var r=0;r<this.itemIndexArray.length;r++)this.itemIndexArray[r]&&this.cntEle.appendChild(this.createContentElement(Number(this.extIndex(this.itemIndexArray[r]))));else this.loadOn==="Dynamic"&&this.cntEle.appendChild(this.createContentElement(this.selectedItem>0?this.selectedItem:Number(this.extIndex(this.itemIndexArray[0]))))},t.prototype.reRenderItems=function(){this.renderContainer(),g(this.cntEle)||this.bindSwipeEvents()},t.prototype.parseObject=function(e,i){var r=this,n=Array.prototype.slice.call(ze(".e-tab-header ."+Ut,this.element)),s=this.lastIndex;!this.isReplace&&n.length>0&&(s=this.getMaxIndicesFromItems(n));var a=[],l,h=[];return e.forEach(function(c,u){var d=g(c.header)||g(c.header.iconPosition)?"":c.header.iconPosition,p=g(c.header)||g(c.header.iconCss)?"":c.header.iconCss;if(g(c.headerTemplate)&&(g(c.header)||g(c.header.text)||c.header.text.length===0&&p==="")){h.push(u);return}var f=c.headerTemplate||c.header.text;typeof f=="string"&&r.enableHtmlSanitizer&&(f=Pt.sanitize(f));var v;r.isReplace&&!g(r.tbId)&&r.tbId!==""?(v=parseInt(r.tbId.substring(r.tbId.lastIndexOf("_")+1),10),r.tbId=""):v=i+u,r.lastIndex=n.length===0?u:r.isReplace?v:s+1+u;var m=c.disabled?" "+yl+" "+pI:"",y=c.visible===!1?" "+Ni:"";l=r.createElement("div",{className:Tf,attrs:{role:"presentation"}});var b=f instanceof Object?f.outerHTML:f,S=!g(b)&&b!=="";g(f.tagName)?r.headerTextCompile(l,f,u):l.appendChild(f);var C,x=r.createElement("span",{className:cI+" "+Kk+" "+uI+"-"+d+" "+p}),I=r.createElement("div",{className:ly});I.appendChild(l),f!==""&&f!==void 0&&p!==""?(d==="left"||d==="top"?I.insertBefore(x,I.firstElementChild):I.appendChild(x),C=l,r.isIconAlone=!1):(C=p===""?l:x,C===x&&(se(l),I.appendChild(x),r.isIconAlone=!0));var D=g(c.tabIndex)?"-1":c.tabIndex.toString(),M=c.disabled?{role:"tab","aria-disabled":"true"}:{tabIndex:D,"data-tabindex":D,role:"tab","aria-selected":"false","aria-disabled":"false"};I.appendChild(r.btnCls.cloneNode(!0));var E=r.createElement("div",{className:Ks,attrs:M});E.appendChild(I),r.itemIndexArray instanceof Array&&r.itemIndexArray.splice(i+u,0,Vr+r.tabId+"_"+r.lastIndex);var A={id:Vr+r.tabId+"_"+r.lastIndex,"data-id":c.id},L={htmlAttributes:A,template:E};L.cssClass=(c.cssClass!==void 0?c.cssClass:" ")+" "+m+" "+y+" "+(p!==""?"e-i"+d:"")+" "+(S?"":uI),(d==="top"||d==="bottom")&&r.element.classList.add("e-vertical-icon"),a.push(L),u++}),this.isAdd||h.forEach(function(c){r.items.splice(c,1)}),this.isIconAlone?this.element.classList.add(Xk):this.element.classList.remove(Xk),a},t.prototype.removeActiveClass=function(){var e=this.getTabHeader();if(e){var i=ze("."+Ut+"."+Di,e);[].slice.call(i).forEach(function(r){return r.classList.remove(Di)}),[].slice.call(i).forEach(function(r){return r.firstElementChild.setAttribute("aria-selected","false")})}},t.prototype.checkPopupOverflow=function(e){this.tbPop=J("."+$k,this.element);var i=J(".e-hor-nav",this.element),r=J("."+Fs,this.element),n=r.lastChild,s=!1;return(!this.isVertical()&&(this.enableRtl&&i.offsetLeft+i.offsetWidth>r.offsetLeft||!this.enableRtl&&i.offsetLeft<r.offsetWidth)||this.isVertical()&&i.offsetTop<n.offsetTop+n.offsetHeight)&&(s=!0),s&&!g(e)&&(e.classList.add(bl),this.tbPop.insertBefore(e,ze("."+bl,this.tbPop)[0])),s},t.prototype.popupHandler=function(e){var i=e.querySelector(".e-ripple-element");g(i)||(i.outerHTML="",e.querySelector("."+Ks).classList.remove("e-ripple")),this.tbItem=ze("."+Fs+" ."+Ut,this.hdrEle);var r=this.tbItem[this.tbItem.length-1];if(this.tbItem.length>=0){if(e.classList.remove(bl),e.removeAttribute("style"),this.tbItems.appendChild(e),this.actEleId=e.id,this.checkPopupOverflow(r))for(var n=0;n<this.tbItems.children.length;n++){var s=this.tbItems.lastChild.previousElementSibling;if(s=s&&s.classList.contains(Af)?s.previousElementSibling:s,!this.checkPopupOverflow(s||e))break}this.isPopup=!0}var a=ze("."+Ut,this.tbItems).length;return a>0?a-1:this.getEleIndex(e)},t.prototype.setCloseButton=function(e){var i=J("."+Hn,this.element);e===!0?i.classList.add(oy):i.classList.remove(oy),this.refreshOverflow(),this.refreshActiveTabBorder()},t.prototype.prevCtnAnimation=function(e,i){var r,n=this.enableRtl||this.element.classList.contains(ay);return this.isPopup||e<=i?this.animation.previous.effect==="SlideLeftIn"?r={name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:r=null:this.animation.next.effect==="SlideRightIn"?r={name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:r=null,r},t.prototype.triggerPrevAnimation=function(e,i){var r=this,n=this.prevCtnAnimation(i,this.selectedItem);g(n)?e.classList.remove(Di):(n.begin=function(){Ze(e,{position:"absolute"}),e.classList.add(hy),e.classList.add("e-view")},n.end=function(){e.style.display="none",e.classList.remove(Di),e.classList.remove(hy),e.classList.remove("e-view"),Ze(e,{display:"",position:""}),e.childNodes.length===0&&!r.isTemplate&&se(e)},new Mt(n).animate(e))},t.prototype.triggerAnimation=function(e,i){var r=this,n=this.prevIndex,s,a=[].slice.call(this.element.querySelector("."+ii).children);a.forEach(function(m){m.id===r.prevActiveEle&&(s=m)});var l=this.tbItem[n],h=this.getTrgContent(this.cntEle,this.extIndex(e));if(g(s)&&!g(l)){var c=this.extIndex(l.id);s=this.getTrgContent(this.cntEle,c)}g(h)||(this.prevActiveEle=h.id);var u=g(this.animation)||g(this.animation.next.effect)||g(this.animation.previous.effect)||this.animation.previous.effect==="None"||this.animation.next.effect==="None";if(this.initRender||i===!1||u){s&&s!==h&&s.classList.remove(Di);return}var d=J("."+ii,this.element),p;if(this.prevIndex>this.selectedItem&&!this.isPopup){var f=this.animation.previous.effect;p={name:f==="None"?"":f!=="SlideLeftIn"?f:"SlideLeftIn",duration:this.animation.previous.duration===0&&Yt==="Enable"?600:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var v=this.animation.next.effect;p={name:v==="None"?"":v!=="SlideRightIn"?v:"SlideRightIn",duration:this.animation.next.duration===0&&Yt==="Enable"?600:this.animation.next.duration,timingFunction:this.animation.next.easing}}p.progress=function(){d.classList.add(hy),r.setActiveBorder()},p.end=function(){d.classList.remove(hy),h.classList.add(Di)},!this.initRender&&!g(s)&&this.triggerPrevAnimation(s,n),this.isPopup=!1,p.name===""?h.classList.add(Di):new Mt(p).animate(h)},t.prototype.keyPressed=function(e){var i=H(e,"."+Hn+" ."+Ut),r=this.getEleIndex(i);!g(this.popEle)&&e.classList.contains("e-hor-nav")?this.popEle.classList.contains(EU)?this.popObj.hide(this.hide):this.popObj.show(this.show):e.classList.contains("e-scroll-nav")?e.click():!g(i)&&i.classList.contains(Di)===!1&&(this.selectTab(r,null,!0),g(this.popEle)||this.popObj.hide(this.hide))},t.prototype.getTabHeader=function(){if(!g(this.element)){var e=[].slice.call(this.element.children).filter(function(r){return r.classList.contains(Hn)});if(e.length>0)return e[0];var i=[].slice.call(this.element.children).filter(function(r){return!r.classList.contains(IU)})[0];return i?[].slice.call(i.children).filter(function(r){return r.classList.contains(Hn)})[0]:void 0}},t.prototype.getEleIndex=function(e){return Array.prototype.indexOf.call(ze("."+Ut,this.getTabHeader()),e)},t.prototype.extIndex=function(e){return e.replace(Vr+this.tabId+"_","")},t.prototype.getMaxIndicesFromItems=function(e){var i=this,r=[];return e.forEach(function(n){r.push(i.getIndexFromEle(n.id))}),Math.max.apply(Math,r)},t.prototype.expTemplateContent=function(){var e=this;this.templateEle.forEach(function(i){g(e.element.querySelector(i))||(document.body.appendChild(e.element.querySelector(i)).style.display="none")})},t.prototype.templateCompile=function(e,i,r){var n=this.createElement("div");this.compileElement(n,i,"content",r),n.childNodes.length!==0&&e.appendChild(n),this.isReact&&this.renderReactTemplates()},t.prototype.compileElement=function(e,i,r,n){var s;typeof i=="string"?(i=i.trim(),this.isVue?s=Et(this.enableHtmlSanitizer?Pt.sanitize(i):i):e.innerHTML=this.enableHtmlSanitizer?Pt.sanitize(i):i):s=Et(i);var a;g(s)||(a=s({},this,r)),!g(s)&&a.length>0&&[].slice.call(a).forEach(function(l){e.appendChild(l)})},t.prototype.headerTextCompile=function(e,i,r){this.compileElement(e,i,"headerTemplate",r)},t.prototype.getContent=function(e,i,r,n){var s;if(i=g(i)?"":i,typeof i=="string"||g(i.innerHTML))if(typeof i=="string"&&this.enableHtmlSanitizer&&(i=Pt.sanitize(i)),i[0]==="."||i[0]==="#")if(document.querySelectorAll(i).length){var a=document.querySelector(i);s=a.outerHTML.trim(),r==="clone"?e.appendChild(a.cloneNode(!0)):(e.appendChild(a),a.style.display="")}else this.templateCompile(e,i,n);else this.templateCompile(e,i,n);else e.appendChild(i);g(s)||this.templateEle.indexOf(i.toString())===-1&&this.templateEle.push(i.toString())},t.prototype.getTrgContent=function(e,i){var r;return this.element.classList.contains(sy)?r=J("."+sy+"> ."+ii+" > #"+ii+this.tabId+"_"+i,this.element):r=this.findEle(e.children,ii+this.tabId+"_"+i),r},t.prototype.findEle=function(e,i){for(var r,n=0;n<e.length;n++)if(e[n].id===i){r=e[n];break}return r},t.prototype.isVertical=function(){var e=this.headerPlacement==="Left"||this.headerPlacement==="Right";return this.scrCntClass=e?NU:LU,e},t.prototype.addVerticalClass=function(){if(this.isVertical()){var e=this.headerPlacement==="Left"?Zk:Jk;X([this.hdrEle],[gI,e]),this.element.classList.contains(sy)?X([this.hdrEle],[fI,e]):X([this.element],[fI,e])}this.headerPlacement==="Bottom"&&X([this.hdrEle],[eF])},t.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},t.prototype.changeOrientation=function(e){this.setOrientation(e,this.hdrEle);var i=this.hdrEle.querySelector("."+Di),r=!!this.hdrEle.classList.contains(gI);Z([this.element],[fI]),Z([this.hdrEle],[gI,Zk,Jk]),r!==this.isVertical()&&(this.changeToolbarOrientation(),!g(i)&&i.classList.contains(bl)&&this.popupHandler(i)),this.addVerticalClass(),this.setActiveBorder(),this.focusItem()},t.prototype.focusItem=function(){var e=J(" #"+Vr+this.tabId+"_"+this.selectedItem,this.hdrEle);g(e)||e.firstElementChild.focus()},t.prototype.changeToolbarOrientation=function(){this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()},t.prototype.setOrientation=function(e,i){var r=Array.prototype.indexOf.call(this.element.children,i),n=Array.prototype.indexOf.call(this.element.children,this.element.querySelector("."+ii));e==="Bottom"&&n>r?this.element.appendChild(i):(Z([i],[eF]),this.element.insertBefore(i,J("."+ii,this.element)))},t.prototype.setCssClass=function(e,i,r){if(!(i===""||g(i)))for(var n=i.split(" "),s=0;s<n.length;s++)r?e.classList.add(n[s]):e.classList.remove(n[s])},t.prototype.loadContentInitMode=function(e){if(e&&this.loadOn==="Init")for(var i=0;i<this.items.length;i++)this.cntEle.children.item(i)&&this.getContent(this.cntEle.children.item(i),this.items[i].content,"render",i)},t.prototype.loadContentElement=function(){if(!this.isTemplate){var e=this.cntEle.children.item(0);this.loadContentInitMode(e)}},t.prototype.setContentHeight=function(e){if(this.element.classList.contains(vI)&&Z([this.element],[vI]),!g(this.cntEle)){var i=this.getTabHeader();if(this.heightAdjustMode==="None"){if(this.loadContentElement(),this.height==="auto")return;this.isVertical()||Ze(this.cntEle,{height:this.element.clientHeight-i.offsetHeight+"px"})}else if(this.heightAdjustMode==="Fill")X([this.element],[vI]),Ze(this.element,{height:"100%"}),this.loadContentElement(),this.cntEle.style.height="calc(100% - "+this.hdrEle.offsetHeight+"px)";else if(this.heightAdjustMode==="Auto"){if(this.isTemplate===!0)for(var r=ze("."+ii+" > ."+Vr,this.element),n=0;n<r.length;n++)r[n].style.display="block",r[n].style.visibility="visible",this.maxHeight=Math.max(this.maxHeight,this.getHeight(r[n])),r[n].style.removeProperty("display"),r[n].style.removeProperty("visibility");else{this.cntEle=J("."+ii,this.element),e===!0&&this.loadOn==="Demand"&&this.cntEle.appendChild(this.createContentElement(Number(this.extIndex(this.itemIndexArray[0]))));for(var s=this.cntEle.children.item(0),n=0;n<this.items.length;n++)for(this.getContent(s,this.items[n].content,"clone",n),this.maxHeight=Math.max(this.maxHeight,this.getHeight(s));s.firstChild;)s.removeChild(s.firstChild);(this.isReact||this.isAngular||this.isVue)&&this.clearTemplate(["content"]),this.templateEle=[],this.loadOn==="Demand"&&this.getContent(s,this.items[0].content,"render",0),this.loadContentInitMode(s),this.prevIndex!==this.selectedItem&&s.classList.remove(Di)}Ze(this.cntEle,{height:this.maxHeight+"px"})}else this.loadContentElement(),Ze(this.cntEle,{height:"auto"})}},t.prototype.getHeight=function(e){var i=window.getComputedStyle(e);return e.offsetHeight+parseFloat(i.getPropertyValue("padding-top"))+parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("margin-top"))+parseFloat(i.getPropertyValue("margin-bottom"))},t.prototype.setActiveBorder=function(){var e=this.getTabHeader(),i=J("."+Ut+"."+Di,e);if(!g(i)){this.reorderActiveTab?e&&e.classList.remove(mI):(i.classList.contains(bl)&&!this.bdrLine.classList.contains(Ni)&&this.bdrLine.classList.add(Ni),e&&!e.classList.contains(mI)&&e.classList.add(mI));var r=H(i,"."+mh);if(this.element===r){this.tbItems=J("."+Fs,e);var n=J("."+Af,e),s=J("."+Fs+" ."+this.scrCntClass,e);if(this.isVertical()){Ze(n,{left:"",right:""});var a=g(s)?this.tbItems.offsetHeight:s.offsetHeight;a!==0?Ze(n,{top:i.offsetTop+"px",height:i.offsetHeight+"px"}):Ze(n,{top:0,height:0})}else{if(this.overflowMode==="MultiRow"){var l=this.headerPlacement==="Bottom"?i.offsetTop:i.offsetHeight+i.offsetTop;Ze(n,{top:l+"px",height:""})}else Ze(n,{top:"",height:""});var h=g(s)?this.tbItems.offsetWidth:s.offsetWidth;h!==0?Ze(n,{left:i.offsetLeft+"px",right:h-(i.offsetLeft+i.offsetWidth)+"px"}):Ze(n,{left:"auto",right:"auto"})}!g(this.bdrLine)&&!i.classList.contains(bl)&&this.bdrLine.classList.remove(Ni)}}},t.prototype.setActive=function(e,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),this.tbItem=ze("."+Ut,this.getTabHeader());var n=this.tbItem[e];if(!(e<0||isNaN(e)||this.tbItem.length===0||!g(n)&&n.classList.contains(yl))){if(e>=0&&!i&&(this.allowServerDataBinding=!1,this.setProperties({selectedItem:e},!0),this.allowServerDataBinding=!0,this.initRender||this.serverDataBind()),n.classList.contains(Di)){this.setActiveBorder();return}this.isTemplate||Ee(n.firstElementChild,{"aria-controls":ii+this.tabId+"_"+this.extIndex(n.id)});var s=n.id;this.removeActiveClass(),n.classList.add(Di),n.firstElementChild.setAttribute("aria-selected","true");var a=Number(this.extIndex(s));if(g(this.prevActiveEle)&&(this.prevActiveEle=ii+this.tabId+"_"+a),this.isTemplate){if(J("."+ii,this.element).children.length>0){var l=this.findEle(J("."+ii,this.element).children,ii+this.tabId+"_"+a);g(l)||l.classList.add(Di),this.triggerAnimation(s,this.enableAnimation)}}else{for(this.cntEle=J("."+mh+" > ."+ii,this.element);this.loadOn==="Dynamic"&&this.cntEle.firstElementChild;)this.cntEle.removeChild(this.cntEle.firstElementChild);var h=this.getTrgContent(this.cntEle,this.extIndex(s));if(g(h)){this.cntEle.appendChild(this.createElement("div",{id:ii+this.tabId+"_"+this.extIndex(s),className:Vr+" "+Di,attrs:{role:"tabpanel","aria-labelledby":Vr+this.tabId+"_"+this.extIndex(s)}}));var c=this.getTrgContent(this.cntEle,this.extIndex(s)),u=Array.prototype.indexOf.call(this.itemIndexArray,s);this.getContent(c,this.items[u].content,"render",u)}else h.classList.add(Di);this.triggerAnimation(s,this.enableAnimation)}if(this.setActiveBorder(),this.refreshItemVisibility(n),!this.initRender&&!i){var d={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:n,selectedIndex:e,selectedContent:J("#"+ii+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:r,preventFocus:!1};this.trigger("selected",d,function(p){p.preventFocus||n.firstElementChild.focus()})}}},t.prototype.setItems=function(e){this.isReplace=!0,this.tbItems=J("."+Fs,this.getTabHeader()),this.tbObj.items=this.parseObject(e,0),this.tbObj.dataBind(),this.isReplace=!1},t.prototype.setRTL=function(e){this.tbObj.enableRtl=e,this.tbObj.dataBind(),this.setCssClass(this.element,ay,e),this.refreshActiveBorder()},t.prototype.refreshActiveBorder=function(){g(this.bdrLine)||this.bdrLine.classList.add(Ni),this.setActiveBorder()},t.prototype.showPopup=function(e){var i=J(".e-popup.e-toolbar-pop",this.hdrEle);if(i&&i.classList.contains("e-popup-close")){var r=i&&i.ej2_instances[0];r.position.X=this.headerPlacement==="Left"||this.element.classList.contains(ay)?"left":"right",r.dataBind(),r.show(e)}},t.prototype.bindDraggable=function(){var e=this;if(this.allowDragAndDrop){var i=this.element.querySelector("."+Hn);if(i){var r=Array.prototype.slice.call(i.querySelectorAll("."+Ut));r.forEach(function(n){e.initializeDrag(n)})}}},t.prototype.bindSwipeEvents=function(){this.swipeMode!=="None"&&(this.touchModule=new jr(this.cntEle,{swipe:this.swipeHandler.bind(this)}))},t.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),T.add(this.element,"mouseover",this.hoverHandler,this),T.add(this.element,"keydown",this.spaceKeyDown,this),g(this.cntEle)||this.bindSwipeEvents(),this.keyModule=new rr(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new rr(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},t.prototype.unWireEvents=function(){g(this.keyModule)||this.keyModule.destroy(),g(this.tabKeyModule)||this.tabKeyModule.destroy(),!g(this.cntEle)&&!g(this.touchModule)&&(this.touchModule.destroy(),this.touchModule=null),window.removeEventListener("resize",this.resizeContext),T.remove(this.element,"mouseover",this.hoverHandler),T.remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove(ay),this.element.classList.remove(hI)},t.prototype.clickHandler=function(e){this.element.classList.remove(hI);var i=e.originalEvent.target,r=H(i,"."+Ut),n=this.getEleIndex(r);i.classList.contains(dI)?this.removeTab(n):this.isVertical()&&H(i,"."+DU)?this.showPopup(this.show):(this.isPopup=!1,!g(r)&&n!==this.selectedItem&&this.selectTab(n,e.originalEvent,!0))},t.prototype.swipeHandler=function(e){if(!(e.velocity<3&&g(e.originalEvent.changedTouches)||this.swipeMode==="Touch"&&(e.originalEvent.type==="mouseup"||e.originalEvent.type==="mouseleave")||this.swipeMode==="Mouse"&&e.originalEvent.type==="touchend"||this.swipeMode==="None")){this.isNested&&this.element.setAttribute("data-swipe","true");var i=this.element.querySelector('[data-swipe="true"]');if(i){i.removeAttribute("data-swipe");return}if(this.isSwiped=!0,e.swipeDirection==="Right"&&this.selectedItem!==0){for(var r=this.selectedItem-1;r>=0;r--)if(!this.tbItem[r].classList.contains(Ni)){this.selectTab(r,null,!0);break}}else if(e.swipeDirection==="Left"&&this.selectedItem!==ze("."+Ut,this.element).length-1){for(var n=this.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains(Ni)){this.selectTab(n,null,!0);break}}this.isSwiped=!1}},t.prototype.spaceKeyDown=function(e){if(e.keyCode===32&&e.which===32||e.keyCode===35&&e.which===35){var i=H(e.target,"."+Hn);g(i)||e.preventDefault()}},t.prototype.keyHandler=function(e){if(!this.element.classList.contains(yl)){this.element.classList.add(hI);var i=e.target,r=this.getTabHeader(),n=J("."+Di,r);this.popEle=J("."+$k,r),g(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]);var s=H(document.activeElement,"."+Ut),a=H(i,"."+Ut);switch(e.action){case"space":case"enter":if(i.parentElement.classList.contains(yl))return;if(e.action==="enter"&&i.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(i);break;case"tab":case"shiftTab":i.classList.contains(Ks)&&H(i,"."+Ut).classList.contains(Di)===!1&&i.setAttribute("tabindex",i.getAttribute("data-tabindex")),this.popObj&&wr(this.popObj.element)&&this.popObj.hide(this.hide),!g(n)&&n.children.item(0).getAttribute("tabindex")==="-1"&&n.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":g(s)||this.refreshItemVisibility(s);break;case"openPopup":!g(e.target)&&e.target.classList.contains(Ks)&&e.preventDefault(),!g(this.popEle)&&this.popEle.classList.contains(TU)&&this.popObj.show(this.show);break;case"delete":if(this.showCloseButton===!0&&!g(a)){var l=a.nextSibling;!g(l)&&l.classList.contains(Ut)&&l.firstElementChild.focus(),this.removeTab(this.getEleIndex(a))}this.setActiveBorder();break}}},t.prototype.refreshItemVisibility=function(e){var i=J("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!g(i)){var r=J(".e-hscroll-bar",this.tbItems),n=r.scrollLeft,s=n+r.offsetWidth,a=e.offsetLeft,l=e.offsetWidth,h=e.offsetLeft+e.offsetWidth;if(n<a&&s<h){var c=s-a;r.scrollLeft=n+(l-c)}else if(n>a&&s>h){var c=h-n;r.scrollLeft=n-(l-c)}}else return},t.prototype.getIndexFromEle=function(e){return parseInt(e.substring(e.lastIndexOf("_")+1),10)},t.prototype.hoverHandler=function(e){var i=e.target;!g(i.classList)&&i.classList.contains(dI)&&i.setAttribute("title",new Ri("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},t.prototype.evalOnPropertyChangeItems=function(e,i){var r=this;if(e.items instanceof Array&&i.items instanceof Array)if(this.lastIndex=0,g(this.tbObj))this.reRenderItems();else{(this.isReact||this.isAngular)&&this.clearTemplate(),this.setItems(e.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];for(var I=J("."+mh+" > ."+ii,this.element);I.firstElementChild;)se(I.firstElementChild);this.select(this.selectedItem),this.draggableItems=[],this.bindDraggable()}else{for(var n=Object.keys(e.items),s=0;s<n.length;s++)for(var a=parseInt(Object.keys(e.items)[s],10),l=Object.keys(e.items[a]),h=0;h<l.length;h++){var c=Object(i.items[a])[l[h]],u=Object(e.items[a])[l[h]],d=this.element.querySelectorAll("."+Ut)[a],p=void 0;d&&!g(d.id)&&d.id!==""?p=this.getIndexFromEle(d.id):p=a;var f=J("."+Fs+" #"+Vr+this.tabId+"_"+p,this.element),v=J("."+ii+" #"+ii+this.tabId+"_"+p,this.element);if(l[h]==="header"||l[h]==="headerTemplate"){var m=g(this.items[a].header)||g(this.items[a].header.iconCss)?"":this.items[a].header.iconCss,y=this.items[a].headerTemplate||this.items[a].header.text;if(l[h]==="headerTemplate"&&this.clearTabTemplate(f,l[h],Ut),y===""&&m==="")this.removeTab(a);else{this.tbId=d.id;var b=[];b.push(this.items[a]),this.items.splice(a,1),this.itemIndexArray.splice(a,1),this.tbObj.items.splice(a,1);var S=f.classList.contains(Ni);se(f),this.isReplace=!0,this.addTab(b,a),S&&this.hideTab(a),this.isReplace=!1}}if(l[h]==="content"&&!g(v)){var C=typeof u=="string"||g(u.innerHTML);if(C&&(u[0]==="."||u[0]==="#")&&u.length){var x=document.querySelector(u);v.appendChild(x),x.style.display=""}else u===""&&c[0]==="#"?(document.body.appendChild(this.element.querySelector(c)).style.display="none",v.innerHTML=u):this.isAngular||this.isReact?(this.clearTabTemplate(v,l[h],Vr),v.innerHTML="",this.templateCompile(v,u,a)):typeof u!="function"&&(v.innerHTML=u)}l[h]==="cssClass"&&(g(f)||(f.classList.remove(c),f.classList.add(u)),g(v)||(v.classList.remove(c),v.classList.add(u))),l[h]==="disabled"&&this.enableTab(a,u!==!0),l[h]==="visible"&&this.hideTab(a,u!==!0)}this.isReact&&this.portals&&this.portals.length>0&&this.renderReactTemplates(function(){r.refreshActiveTabBorder()})}},t.prototype.clearTabTemplate=function(e,i,r){if(this.clearTemplates){if(this.registeredTemplate&&this.registeredTemplate[i])for(var n=this.registeredTemplate,s=0;s<n[i].length;s++){var a=n[i][s].rootNodes[0],l=H(a,"."+r);if(!g(l)&&l===e){this.clearTemplate([i],[n[i][s]]);break}}else if(this.portals&&this.portals.length>0)for(var h=this.portals,s=0;s<h.length;s++){var c=h[s],l=H(c.containerInfo,"."+r);if(!g(l)&&l===e){this.clearTemplate([i],s);break}}}},t.prototype.initializeDrag=function(e){var i=this,r=new sh(e,{dragArea:this.dragArea,dragTarget:"."+Ut,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(n){var s=i.getEleIndex(i.dragItem),a,l,h={draggedItem:i.dragItem,event:n.event,target:n.target,droppedItem:n.target.closest("."+Ut),clonedElement:i.cloneElement,index:s};if(!g(n.target.closest("."+mh))&&!n.target.closest("."+mh).isEqualNode(i.element)&&i.dragArea!=="."+Hn)i.trigger("dragging",h);else{if(!n.target.closest(i.dragArea)&&i.overflowMode!=="Popup"?(document.body.style.cursor="not-allowed",X([i.cloneElement],Ni),i.dragItem.classList.contains(Ni)&&Z([i.dragItem],Ni),i.dragItem.querySelector("."+Ks).style.visibility="visible"):(document.body.style.cursor="",i.dragItem.querySelector("."+Ks).style.visibility="hidden",i.cloneElement.classList.contains(Ni)&&Z([i.cloneElement],Ni)),i.overflowMode==="Scrollable"&&!g(i.element.querySelector(".e-hscroll"))){var c=i.element.querySelector(".e-scroll-right-nav"),u=i.element.querySelector(".e-scroll-left-nav"),d=i.element.querySelector(".e-hscroll-bar");!g(c)&&Math.abs(c.offsetWidth/2+c.offsetLeft)>i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&(d.scrollLeft-=10),!g(u)&&Math.abs(u.offsetLeft+u.offsetWidth-i.cloneElement.offsetLeft)>u.offsetWidth/2&&(d.scrollLeft+=10)}i.cloneElement.style.pointerEvents="none",l=H(n.target,"."+Ut+".e-draggable");var p=0;i.overflowMode==="Scrollable"&&!g(i.element.querySelector(".e-hscroll"))&&(p=i.element.querySelector(".e-hscroll-content").offsetWidth),l!=null&&!l.isSameNode(i.dragItem)&&l.closest("."+mh).isSameNode(i.dragItem.closest("."+mh))&&(a=i.getEleIndex(l),a<s&&Math.abs(l.offsetLeft+l.offsetWidth-i.cloneElement.offsetLeft)>l.offsetWidth/2&&i.dragAction(l,s,a),a>s&&Math.abs(l.offsetWidth/2)+l.offsetLeft-p<i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&i.dragAction(l,s,a)),i.droppedIndex=i.getEleIndex(i.dragItem),i.trigger("dragging",h)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(r)},t.prototype.helper=function(e){return this.cloneElement=this.createElement("div"),e.element&&(this.cloneElement=e.element.cloneNode(!0),X([this.cloneElement],"e-tab-clone-element"),this.element.querySelector("."+Hn).classList.contains(oy)&&X([this.cloneElement],oy),Z([this.cloneElement.querySelector("."+Ks)],"e-ripple"),g(this.cloneElement.querySelector(".e-ripple-element"))||Qe(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},t.prototype.itemDragStart=function(e){var i=this;this.draggingItems=this.items.map(function(n){return n}),this.dragItem=e.element;var r={draggedItem:e.element,event:e.event,target:e.target,droppedItem:null,index:this.getEleIndex(this.dragItem),clonedElement:this.cloneElement,cancel:!1};this.trigger("onDragStart",r,function(n){if(n.cancel){var s=e.element.ej2_instances[0];g(s)||s.intDestroy(e.event),se(i.cloneElement)}else i.removeActiveClass(),X([i.tbItems.querySelector("."+Af)],Ni),i.dragItem.querySelector("."+Ks).style.visibility="hidden"})},t.prototype.dragAction=function(e,i,r){if(this.items.length>0){var n=this.draggingItems[i];this.draggingItems.splice(i,1),this.draggingItems.splice(r,0,n)}if(this.overflowMode==="MultiRow"&&e.parentNode.insertBefore(this.dragItem,e.nextElementSibling),i>r)if(this.dragItem.parentElement.isSameNode(e.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,e);else if(this.overflowMode==="Extended")if(e.isSameNode(e.parentElement.lastChild)){var s=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),s.insertBefore(e.parentElement.lastChild,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e);else{var a=e.parentElement.lastChild;if(e.isSameNode(a)){var s=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),s.insertBefore(a,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)}i<r&&(this.dragItem.parentElement.isSameNode(e.parentElement)?this.dragItem.parentNode.insertBefore(this.dragItem,e.nextElementSibling):this.overflowMode==="Extended"?(this.dragItem.parentElement.appendChild(e.parentElement.firstElementChild),e.parentNode.insertBefore(this.dragItem,e.nextSibling)):(this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)))},t.prototype.itemDragStop=function(e){var i=this;se(this.cloneElement),this.cloneElement=null,this.dragItem.querySelector("."+Ks).style.visibility="visible",document.body.style.cursor="";var r={draggedItem:this.dragItem,event:e.event,target:e.target,droppedItem:this.tbItem[this.droppedIndex],clonedElement:null,index:this.droppedIndex,cancel:!1};this.trigger("dragged",r,function(n){n.cancel?i.refresh():i.items.length>0&&i.draggingItems.length>0?(i.items=i.draggingItems,i.selectedItem=g(i.droppedIndex)?i.getEleIndex(i.dragItem):i.droppedIndex,i.refresh()):(i.dragItem.querySelector("."+Ks).style.visibility="",Z([i.tbItems.querySelector("."+Af)],Ni),i.droppedIndex=g(i.droppedIndex)?i.getEleIndex(i.dragItem):i.droppedIndex,i.selectTab(i.droppedIndex,null,!0))}),this.dragItem=null,this.droppedIndex=null},t.prototype.enableTab=function(e,i){var r=ze("."+Ut,this.element)[e];g(r)||(i===!0?(r.classList.remove(yl,pI),r.firstElementChild.setAttribute("tabindex",r.firstElementChild.getAttribute("data-tabindex"))):(r.classList.add(yl,pI),r.firstElementChild.removeAttribute("tabindex"),r.classList.contains(Di)&&this.select(e+1)),g(this.items[e])||(this.items[e].disabled=!i,this.dataBind()),r.firstElementChild.setAttribute("aria-disabled",i===!0?"false":"true"))},t.prototype.addTab=function(e,i){var r=this,n={addedItems:e,cancel:!1};if(this.isReplace)this.addingTabContent(e,i);else{for(var s=0,a=e;s<a.length;s++){var l=a[s];l.disabled=l.disabled||!1,l.visible=l.visible||!0}e&&e.length!==0&&this.element&&this.element.classList.contains(Ni)&&this.element.classList.remove(Ni),this.trigger("adding",n,function(h){h.cancel||r.addingTabContent(e,i)})}this.isReact&&this.renderReactTemplates()},t.prototype.addingTabContent=function(e,i){var r=this,n=0;if(this.hdrEle=J("."+Hn,this.element),g(this.hdrEle))this.items=e,this.reRenderItems(),this.bindDraggable();else{var s=Array.from(ze(".e-tab-header ."+Ut,this.element)),a=s.length;if(a!==0&&(n=this.getMaxIndicesFromItems(s)+1),g(i)&&(i=a-1),a<i||i<0||isNaN(i))return;a===0&&!g(this.hdrEle)&&(this.hdrEle.style.display=""),g(this.bdrLine)||this.bdrLine.classList.add(Ni),this.tbItems=J("."+Fs,this.getTabHeader()),this.isAdd=!0;var l=this.parseObject(e,i);this.isAdd=!1;var h=0,c;e.forEach(function(u,d){if(c=u.headerTemplate||u.header.text,g(u.headerTemplate||u.header)||g(c)||c.length===0&&!g(u.header)&&g(u.header.iconCss)||(l[d]&&(g(u.id)&&(u.id=Vr+r.tabId+"_"+tF+(n+d).toString()),l[d].htmlAttributes["data-id"]=u.id),r.items.splice(i+h,0,u),h++),!g(u.header)&&!g(u.header.text)&&(r.isTemplate||r.loadOn==="Init")){var p=n+d,f=r.createElement("div",{id:ii+r.tabId+"_"+p,className:Vr,attrs:{role:"tabpanel","aria-labelledby":Vr+"_"+p}});r.cntEle.insertBefore(f,r.cntEle.children[i+d]);var v=r.getTrgContent(r.cntEle,p.toString());r.getContent(v,u.content,"render",i)}}),this.tbObj.addItems(l,i),this.isReplace||this.trigger("added",{addedItems:e}),this.selectedItem===i?this.select(i):(this.setActiveBorder(),this.tbItem=ze("."+Ut,this.getTabHeader())),this.bindDraggable()}},t.prototype.removeTab=function(e){var i=this,r=ze("."+Ut,this.hdrEle)[e];if(!g(r)){var n={removedItem:r,removedIndex:e,cancel:!1};this.trigger("removing",n,function(s){if(!s.cancel){var a=J("#"+Vr+i.tabId+"_"+i.extIndex(r.id),J("."+Fs,i.hdrEle));g(a)||i.clearTabTemplate(a,"headerTemplate",Ut),i.tbObj.removeItems(e),i.allowDragAndDrop&&e!==Array.prototype.indexOf.call(i.itemIndexArray,r.id)&&(e=Array.prototype.indexOf.call(i.itemIndexArray,r.id));var l=i.itemIndexArray.indexOf(r.id);i.items.splice(l,1),i.itemIndexArray.splice(l,1),i.refreshActiveBorder();var h=J("#"+ii+i.tabId+"_"+i.extIndex(r.id),J("."+ii,i.element));if(g(h)||(i.clearTabTemplate(h,"content",Vr),se(h)),i.trigger("removed",s),i.draggableItems&&i.draggableItems.length>0&&(i.draggableItems[e].destroy(),i.draggableItems[e]=null,i.draggableItems.splice(e,1)),r.classList.contains(Di)){e=e>ze("."+Ut+":not(."+bl+")",i.element).length-1?e-1:e,i.enableAnimation=!1,i.tbItem=ze("."+Ut,i.getTabHeader()),e=i.getSelectingTabIndex(e),e=!isNaN(e)&&e>=0&&i.tbItem.length>e?e:0;var c=i.tbItem[e];if(c){c.classList.contains(Ni)&&c.classList.remove(Ni);var u=c.firstElementChild;u&&u.hasAttribute("aria-hidden")&&u.removeAttribute("aria-hidden")}i.selectedItem=e,i.select(e)}else e!==i.selectedItem&&(e<i.selectedItem&&(e=i.itemIndexArray.indexOf(i.tbItem[i.selectedItem].id),i.setProperties({selectedItem:e>-1?e:i.selectedItem},!0),i.prevIndex=i.selectedItem),i.tbItem=ze("."+Ut,i.getTabHeader()));if(ze("."+Ut,i.element).length===0){var d=J("."+ii,i.element);se(i.hdrEle),se(d)}i.enableAnimation=!0}})}},t.prototype.hideTab=function(e,i){var r,n;e>=0&&e<this.tbItem.length&&(n=this.tbItem[e].getAttribute("id"));var s=this.element.querySelector('[id="'+n+'"]');if(!g(s)){if(g(i)&&(i=!0),this.bdrLine.classList.add(Ni),i===!0)if(s.classList.add(Ni),r=ze("."+Ut+":not(."+Ni+")",this.tbItems),r.length!==0&&s.classList.contains(Di)){if(e!==0)for(var a=e-1;a>=0;a--)if(this.tbItem[a].classList.contains(Ni)){if(a===0){for(var l=e+1;l<this.tbItem.length;l++)if(!this.tbItem[l].classList.contains(Ni)){this.select(l);break}}}else{this.select(a);break}else for(var l=e+1;l<this.tbItem.length;l++)if(!this.tbItem[l].classList.contains(Ni)){this.select(l);break}}else r.length===0&&this.element.classList.add(Ni);else this.element.classList.remove(Ni),r=ze("."+Ut+":not(."+Ni+")",this.tbItems),s.classList.remove(Ni),r.length===0&&this.select(e);this.setActiveBorder(),g(this.items[e])||(this.items[e].visible=!i,this.dataBind()),g(s.firstElementChild)||s.firstElementChild.setAttribute("aria-hidden",""+i),this.overflowMode==="Popup"&&this.refreshOverflow()}},t.prototype.selectTab=function(e,i,r){i===void 0&&(i=null),r===void 0&&(r=!1),this.isInteracted=r,this.select(e,i)},t.prototype.select=function(e,i){var r=this,n=this.getTabHeader();this.tbItems=J("."+Fs,n),this.tbItem=ze("."+Ut,n),this.content=J("."+ii,this.element),this.prevItem=this.tbItem[this.prevIndex],g(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);var s=this.tbItem[e];g(s)?this.selectedID="0":this.selectingID=this.extIndex(s.id),!g(this.prevItem)&&!this.prevItem.classList.contains(yl)&&this.prevItem.children.item(0).setAttribute("tabindex",this.prevItem.firstElementChild.getAttribute("tabindex"));var a={event:i,previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:g(this.content)?null:J("#"+ii+this.tabId+"_"+this.selectedID,this.content),selectingItem:s,selectingIndex:e,selectingContent:g(this.content)?null:J("#"+ii+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwiped,isInteracted:this.isInteracted,cancel:!1};this.initRender?this.selectingContent(e,this.isInteracted):this.trigger("selecting",a,function(l){l.cancel||r.selectingContent(e,r.isInteracted)}),this.isInteracted=!1},t.prototype.getSelectingTabIndex=function(e){if(!g(this.tbItem[e])&&(this.tbItem[e].classList.contains(yl)||this.tbItem[e].classList.contains(Ni)))for(var i=e+1;i<this.items.length;i++)if(this.items[i].disabled===!1&&this.items[i].visible===!0){e=i;break}else e=0;return e},t.prototype.selectingContent=function(e,i){if(typeof e=="number")if(e=this.getSelectingTabIndex(e),this.tbItem.length>e&&e>=0&&!isNaN(e))if(this.prevIndex=this.selectedItem,this.prevItem=this.tbItem[this.prevIndex],this.tbItem[e].classList.contains(bl)&&this.reorderActiveTab){if(this.setActive(this.popupHandler(this.tbItem[e]),null,i),!g(this.items)&&this.items.length>0&&this.allowDragAndDrop){this.tbItem=ze("."+Fs+" ."+Ut,this.hdrEle);var r=this.items[e];this.items.splice(e,1),this.items.splice(this.tbItem.length-1,0,r);var n=this.itemIndexArray[e];this.itemIndexArray.splice(e,1),this.itemIndexArray.splice(this.tbItem.length-1,0,n)}}else this.setActive(e,null,i);else this.setActive(0,null,i);else e instanceof HTMLElement&&this.setActive(this.getEleIndex(e),null,i)},t.prototype.getItemIndex=function(e){var i;this.tbItem=ze("."+Ut,this.getTabHeader());for(var r=0;r<this.tbItem.length;r++){var n=this.tbItem[r].getAttribute("data-id");if(e===n){i=r;break}}return i},t.prototype.disable=function(e){this.setCssClass(this.element,yl,e),this.element.setAttribute("aria-disabled",""+e)},t.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},t.prototype.getModuleName=function(){return"tab"},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=Object.keys(e).sort(function(c,u){return c==="items"?-1:u==="items"?1:0}),s=0,a=n;s<a.length;s++){var l=a[s];switch(l){case"width":Ze(this.element,{width:Ae(e.width)});break;case"height":Ze(this.element,{height:Ae(e.height)}),this.setContentHeight(!1);break;case"cssClass":var h=this.element.querySelector("."+Hn);i.cssClass!==""&&!g(i.cssClass)?(this.setCssClass(this.element,i.cssClass,!1),this.setCssClass(this.element,e.cssClass,!0),g(h)||(this.setCssClass(h,i.cssClass,!1),this.setCssClass(h,e.cssClass,!0))):(this.setCssClass(this.element,e.cssClass,!0),g(h)||this.setCssClass(h,e.cssClass,!0));break;case"items":this.evalOnPropertyChangeItems(e,i);break;case"showCloseButton":this.setCloseButton(e.showCloseButton);break;case"reorderActiveTab":this.refreshActiveTabBorder();break;case"selectedItem":this.selectedItem=i.selectedItem,this.select(e.selectedItem);break;case"headerPlacement":this.changeOrientation(e.headerPlacement);break;case"enableRtl":this.setRTL(e.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=e.overflowMode,this.tbObj.dataBind(),this.refreshActiveTabBorder();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep);break;case"allowDragAndDrop":this.bindDraggable();break;case"swipeMode":this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.bindSwipeEvents();break;case"dragArea":this.allowDragAndDrop&&(this.draggableItems.forEach(function(c){c.dragArea=r.dragArea}),this.refresh());break}}},t.prototype.refreshActiveTab=function(){if(this.isReact&&this.isTemplate&&this.clearTemplate(),this.isTemplate){var y=this.element.querySelector("."+Fs),b=this.element.querySelector("."+Ut+"."+Di),S=this.getIndexFromEle(b.id),C=b.innerText,x=this.element.querySelector("."+ii).querySelector("."+Di).children[0],I=x.innerHTML;se(b),se(x);var D={className:Ut+" "+lI+" "+Di,id:Vr+this.tabId+"_"+S},M=this.createElement("span",{className:Tf,innerHTML:C,attrs:{role:"presentation"}}).outerHTML,E=this.createElement("div",{className:ly,innerHTML:M+this.btnCls.outerHTML}).outerHTML,c=b.firstElementChild.getAttribute("data-tabindex"),A=this.createElement("div",{className:Ks,innerHTML:E,attrs:{tabIndex:c,"data-tabindex":c,role:"tab","aria-controls":ii+this.tabId+"_"+S,"aria-selected":"true","aria-disabled":"false"}});y.insertBefore(this.createElement("div",D),y.children[S+1]),this.element.querySelector("."+Ut+"."+Di).appendChild(A);var p=this.createElement("div",{innerHTML:I});this.element.querySelector("."+ii).querySelector("."+Di).appendChild(p)}else if(this.element.querySelector("."+Ut+"."+Di)){se(this.element.querySelector("."+Ut+"."+Di).children[0]),se(this.element.querySelector("."+ii).querySelector("."+Di).children[0]);var e=this.items[this.selectedItem],i=g(e.header)||g(e.header.iconPosition)?"":e.header.iconPosition,r=g(e.header)||g(e.header.iconCss)?"":e.header.iconCss,n=e.headerTemplate||e.header.text,s=this.createElement("div",{className:Tf,attrs:{role:"presentation"}});g(n.tagName)?this.headerTextCompile(s,n,this.selectedItem):s.appendChild(n);var a=void 0,l=this.createElement("span",{className:cI+" "+Kk+" "+uI+"-"+i+" "+r}),h=this.createElement("div",{className:ly});h.appendChild(s),n!==""&&n!==void 0&&r!==""?(i==="left"||i==="top"?h.insertBefore(l,h.firstElementChild):h.appendChild(l),a=s,this.isIconAlone=!1):(a=r===""?s:l,a===l&&(se(s),h.appendChild(l),this.isIconAlone=!0));var c=g(e.tabIndex)?"-1":e.tabIndex.toString(),u=e.disabled?{}:{tabIndex:c,"data-tabindex":c,role:"tab","aria-selected":"true","aria-disabled":"false"};h.appendChild(this.btnCls.cloneNode(!0));var d=this.createElement("div",{className:Ks,attrs:u});d.appendChild(h),(i==="top"||i==="bottom")&&this.element.classList.add("e-vertical-icon"),this.element.querySelector("."+Ut+"."+Di).appendChild(d);var p=this.createElement("div"),f=e.content,v=void 0;if(typeof f=="string"||g(f.innerHTML))if(typeof f=="string"&&this.enableHtmlSanitizer&&(f=Pt.sanitize(f)),f[0]==="."||f[0]==="#")if(document.querySelectorAll(f).length){var m=document.querySelector(f);v=m.outerHTML.trim(),p.appendChild(m),m.style.display=""}else this.compileElement(p,f,"content",this.selectedItem);else this.compileElement(p,f,"content",this.selectedItem);else p.appendChild(f);g(v)||this.templateEle.indexOf(f.toString())===-1&&this.templateEle.push(f.toString()),this.element.querySelector("."+Vr+"."+Di).appendChild(p)}this.isReact&&this.renderReactTemplates()},t.prototype.refreshActiveTabBorder=function(){if(this.heightAdjustMode==="None"&&this.height!=="auto"&&this.cntEle&&!this.isVertical()){var e=this.getTabHeader();Ze(this.cntEle,{height:this.element.clientHeight-e.offsetHeight+"px"})}var i=J("."+Ut+"."+bl+"."+Di,this.element);!g(i)&&this.reorderActiveTab&&this.select(this.getEleIndex(i)),this.refreshActiveBorder()},Rt([Gt([],RU)],t.prototype,"items",void 0),Rt([w("100%")],t.prototype,"width",void 0),Rt([w("Both")],t.prototype,"swipeMode",void 0),Rt([w("auto")],t.prototype,"height",void 0),Rt([w("")],t.prototype,"cssClass",void 0),Rt([w(0)],t.prototype,"selectedItem",void 0),Rt([w("Top")],t.prototype,"headerPlacement",void 0),Rt([w("Content")],t.prototype,"heightAdjustMode",void 0),Rt([w("Scrollable")],t.prototype,"overflowMode",void 0),Rt([w("Demand")],t.prototype,"loadOn",void 0),Rt([w(!1)],t.prototype,"enablePersistence",void 0),Rt([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),Rt([w(!1)],t.prototype,"showCloseButton",void 0),Rt([w(!0)],t.prototype,"reorderActiveTab",void 0),Rt([w()],t.prototype,"scrollStep",void 0),Rt([w()],t.prototype,"dragArea",void 0),Rt([w(!1)],t.prototype,"allowDragAndDrop",void 0),Rt([w(!0)],t.prototype,"clearTemplates",void 0),Rt([Ce({},kU)],t.prototype,"animation",void 0),Rt([G()],t.prototype,"created",void 0),Rt([G()],t.prototype,"adding",void 0),Rt([G()],t.prototype,"added",void 0),Rt([G()],t.prototype,"selecting",void 0),Rt([G()],t.prototype,"selected",void 0),Rt([G()],t.prototype,"removing",void 0),Rt([G()],t.prototype,"removed",void 0),Rt([G()],t.prototype,"onDragStart",void 0),Rt([G()],t.prototype,"dragging",void 0),Rt([G()],t.prototype,"dragged",void 0),Rt([G()],t.prototype,"destroyed",void 0),t=Rt([It],t),t})(ti),xy=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ht=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Sa="e-treeview",rF="e-control",ar="e-icon-collapsible",ri="e-icon-expandable",Tt="e-list-item",vc="e-list-text",OU="e-text-wrap",zU="e-ie-wrap",ni="e-list-parent",cy="e-hover",Mn="e-active",uy="e-icons-spinner",Sl="e-process",nn="e-icons",pn="e-text-content",dy="e-input",nF="e-input-group",py="e-tree-input",yI="e-editing",sF="e-rtl",aF="e-interaction",PU="e-drag-item",oF="e-droppable",fy="e-dragging",Lf="e-sibling",gy="e-drop-in",Nf="e-drop-next",bI="e-drop-out",SI="e-no-drop",BU="e-fullrow-wrap",Cl="e-fullrow",Ju="e-selected",vy="e-expanded",lF="e-node-collapsed",ed="e-disable",jU="e-drop-count",Dn="e-check",Ca="e-stop",ts="e-treeview-checkbox",Fo="e-frame",HU="e-ripple-container",hF="e-ripple",VU="e-ripple-element",mc="e-node-focus",cF="e-list-img",_U="e-bigger",UU="e-small",WU="e-has-child",my="e-animation-active",uF="e-disabled",kf="e-prevent",dF={treeRole:"group",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},qU=(function(o){xy(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ht([w("child")],t.prototype,"child",void 0),ht([w([])],t.prototype,"dataSource",void 0),ht([w("expanded")],t.prototype,"expanded",void 0),ht([w("hasChildren")],t.prototype,"hasChildren",void 0),ht([w("htmlAttributes")],t.prototype,"htmlAttributes",void 0),ht([w("iconCss")],t.prototype,"iconCss",void 0),ht([w("id")],t.prototype,"id",void 0),ht([w("imageUrl")],t.prototype,"imageUrl",void 0),ht([w("isChecked")],t.prototype,"isChecked",void 0),ht([w("parentID")],t.prototype,"parentID",void 0),ht([w(null)],t.prototype,"query",void 0),ht([w("selectable")],t.prototype,"selectable",void 0),ht([w("selected")],t.prototype,"selected",void 0),ht([w(null)],t.prototype,"tableName",void 0),ht([w("text")],t.prototype,"text",void 0),ht([w("tooltip")],t.prototype,"tooltip",void 0),ht([w("navigateUrl")],t.prototype,"navigateUrl",void 0),t})(Oe),pF=(function(o){xy(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ht([w("SlideDown")],t.prototype,"effect",void 0),ht([w(400)],t.prototype,"duration",void 0),ht([w("linear")],t.prototype,"easing",void 0),t})(Oe),YU=(function(o){xy(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ht([Ce({effect:"SlideUp",duration:400,easing:"linear"},pF)],t.prototype,"collapse",void 0),ht([Ce({effect:"SlideDown",duration:400,easing:"linear"},pF)],t.prototype,"expand",void 0),t})(Oe),CI=(function(o){xy(t,o);function t(i,r){var n=o.call(this,i,r)||this;return n.isRefreshed=!1,n.preventExpand=!1,n.checkedElement=[],n.disableNode=[],n.validArr=[],n.validNodes=[],n.expandChildren=[],n.isFieldChange=!1,n.changeDataSource=!1,n.hasTemplate=!1,n.isFirstRender=!1,n.batchParentNode=new Set,n.isNodeDropped=!1,n.isInteracted=!1,n.isRightClick=!1,n.mouseDownStatus=!1,n.isDropIn=!1,n.OldCheckedData=[],n.isHiddenItem=!1,n}e=t,t.prototype.getModuleName=function(){return"treeview"},t.prototype.preRender=function(){var i=this;this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space",shiftSpace:"shift+space",ctrlSpace:"ctrl+space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:ri,ariaAttributes:dF,expandIconPosition:"Left",itemCreated:function(r){i.beforeNodeCreate(r)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new Mt({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource)),g(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),g(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),g(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},t.prototype.getPersistData=function(){var i=["selectedNodes","checkedNodes","expandedNodes"];return this.addOnPersist(i)},t.prototype.render=function(){this.initialRender=!0,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.initialRender=!1,this.renderComplete()},t.prototype.initialize=function(){this.element.setAttribute("role","tree"),!g(this.fields.dataSource)&&Array.isArray(this.fields.dataSource)&&this.fields.dataSource.length!==0&&this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.setTextWrap(),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},t.prototype.setDisabledMode=function(){this.disabled?(this.element.classList.add(uF),this.element.setAttribute("aria-disabled","true")):(this.element.classList.remove(uF),this.element.setAttribute("aria-disabled","false"))},t.prototype.setEnableRtl=function(){(this.enableRtl?X:Z)([this.element],sF)},t.prototype.setRipple=function(){var i="."+Cl+",."+pn,r={selector:i,ignore:"."+pn+" > ."+nn+",."+nF+",."+dy+", ."+ts};this.rippleFn=Wi(this.element,r);var n={selector:"."+pn+" > ."+nn,isCenterRipple:!0};this.rippleIconFn=Wi(this.element,n)},t.prototype.setFullRow=function(i){(i?X:Z)([this.element],BU)},t.prototype.setMultiSelect=function(i){i?this.element.setAttribute("aria-multiselectable","true"):this.element.setAttribute("aria-multiselectable","false")},t.prototype.templateComplier=function(i){if(i){this.hasTemplate=!0,this.element.classList.add(aF);try{return typeof i!="function"&&document.querySelectorAll(i).length?Et(document.querySelector(i).innerHTML.trim()):Et(i)}catch{return Et(i)}}this.element.classList.remove(aF)},t.prototype.setDataBinding=function(i){var r=this;this.treeList.push("false"),this.fields.dataSource instanceof oe?(this.isOffline=this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then(function(n){r.isOffline=r.fields.dataSource.dataSource.offline,r.fields.dataSource instanceof oe&&r.isOffline&&(r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),r.renderItems(!0),r.treeList.length===0&&!r.isLoaded&&r.finalize())}).catch(function(n){r.trigger("actionFailure",{error:n})}):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(n){r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),i&&(r.changeDataSource=!0),r.renderItems(!0),r.changeDataSource=!1,r.treeList.length===0&&!r.isLoaded&&r.finalize()}).catch(function(n){r.trigger("actionFailure",{error:n})})):(this.treeList.pop(),g(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.getQuery=function(i,r){r===void 0&&(r=null);var n=[],s;if(i.query)s=i.query.clone();else{s=new Pe;for(var a=this.getActualProperties(i),l=0,h=Object.keys(a);l<h.length;l++){var c=h[l];c!=="dataSource"&&c!=="tableName"&&c!=="child"&&i[""+c]&&c!=="url"&&n.indexOf(i[""+c])===-1&&n.push(i[""+c])}s.select(n),Object.prototype.hasOwnProperty.call(a,"tableName")&&s.from(i.tableName)}return kt.addSorting(this.sortOrder,i.text,s),!g(r)&&!g(i.parentID)&&s.where(i.parentID,"equal",this.isNumberTypeId?parseFloat(r):r),s},t.prototype.getType=function(){return this.treeData[0]?typeof V(this.fields.id,this.treeData[0])=="number":!1},t.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),this.dataType===1){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var i=this.getChildNodes(this.treeData,void 0,!0);g(i)?this.rootData=[]:this.rootData=i}else this.rootData=this.treeData},t.prototype.isChildObject=function(){return typeof this.fields.child=="object"},t.prototype.renderItems=function(i){this.listBaseOption.ariaAttributes.level=1;var r=this.getSortedData(this.rootData);this.ulElement=kt.createList(this.createElement,i?this.rootData:r,this.listBaseOption),this.element.appendChild(this.ulElement);var n=this.ulElement.querySelectorAll(".e-list-item");if(this.loadOnDemand===!1)for(var s=0;s<n.length;)this.renderChildNodes(n[parseInt(s.toString(),10)],!0,null,!0),s++;var a=ze("."+ni,this.element);(a.length===1&&n&&n.length!==0||this.loadOnDemand)&&this.finalizeNode(this.element),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},t.prototype.updateCheckedStateFromDS=function(){if(this.validNodes=[],this.treeData&&this.showCheckBox){if(this.dataType===1){for(var i=this.fields,r=new oe(this.treeData).executeLocal(new Pe().where(i.isChecked,"equal",!0,!1)),n=0;n<r.length;n++){var s=r[parseInt(n.toString(),10)][this.fields.id]?r[parseInt(n.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(s)===-1&&!this.isLoaded&&this.checkDisabledState(s,r[n]),r[parseInt(n.toString(),10)][this.fields.hasChildren])for(var a=r[parseInt(n.toString(),10)][this.fields.id],l=new oe(this.treeData).executeLocal(new Pe().where(i.parentID,"equal",a,!1)),h=0;h<l.length;h++){var c=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(c)===-1&&this.autoCheck&&this.checkDisabledState(c,l[h])}}for(var n=0;n<this.checkedNodes.length;n++){var u=this.fields,d=new oe(this.treeData).executeLocal(new Pe().where(u.id,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0));if(d[0]&&this.autoCheck&&(this.getCheckedNodeDetails(u,d),this.checkIndeterminateState(d[0])),d.length>0){var p=d[0][this.fields.id]?d[0][this.fields.id].toString():null;this.checkedNodes.indexOf(p)>-1&&this.validNodes.indexOf(p)===-1&&this.validNodes.push(p)}for(var f=new oe(this.treeData).executeLocal(new Pe().where(u.parentID,"equal",this.checkedNodes[parseInt(n.toString(),10)],!0)),v=0;v<f.length;v++){var p=f[parseInt(v.toString(),10)][this.fields.id]?f[parseInt(v.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(p)===-1&&this.autoCheck&&this.checkDisabledState(p,f[v]),this.checkedNodes.indexOf(p)>-1&&this.validNodes.indexOf(p)===-1&&this.validNodes.push(p)}}}else if(this.dataType===2||this.fields.dataSource instanceof oe&&this.isOffline){for(var v=0;v<this.treeData.length;v++){var m=this.treeData[parseInt(v.toString(),10)][this.fields.id]?this.treeData[parseInt(v.toString(),10)][this.fields.id].toString():"";this.treeData[parseInt(v.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(m)===-1&&this.checkDisabledState(m,this.treeData[v]),this.checkedNodes.indexOf(m)>-1&&this.validNodes.indexOf(m)===-1&&this.validNodes.push(m);var y=V(this.fields.child.toString(),this.treeData[parseInt(v.toString(),10)]);y&&this.updateChildCheckState(y,this.treeData[parseInt(v.toString(),10)])}this.validNodes=this.enablePersistence?this.checkedNodes:this.validNodes}this.setProperties({checkedNodes:this.validNodes},!0)}},t.prototype.getCheckedNodeDetails=function(i,r){var n=r[0][this.fields.parentID]?r[0][this.fields.parentID].toString():null,s=0,a=this.element.querySelector('[data-uid="'+r[0][this.fields.id]+'"]'),l=this.element.querySelector('[data-uid="'+r[0][this.fields.parentID]+'"]');if(!a&&!l){this.parentNodeCheck.indexOf(n)===-1&&this.parentNodeCheck.push(n);for(var h=this.getChildNodes(this.treeData,n),c=0;c<h.length;c++){var u=h[parseInt(c.toString(),10)][this.fields.id]?h[parseInt(c.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(u)!==-1&&s++,s===h.length&&this.checkedNodes.indexOf(n)===-1&&this.checkDisabledState(n)}var d=new oe(this.treeData).executeLocal(new Pe().where(i.id,"equal",n,!0));this.getCheckedNodeDetails(i,d)}else if(l){var p=J("."+Dn,l);p||this.changeState(l,"indeterminate",null,!0,!0)}},t.prototype.updateParentCheckState=function(){var i=ze("."+Ca,this.element),r,n=this.treeData;this.element.classList.contains("e-filtering")&&(n=this.DDTTreeData);for(var s=0;s<i.length;s++){var a=H(i[parseInt(s.toString(),10)],"."+Tt),l=a.getAttribute("data-uid").toString(),h=void 0;this.element.classList.contains("e-filtering")&&(h=new oe(this.OldCheckedData).executeLocal(new Pe().where("parentID","equal",l,!0))),this.dataType===1?r=new oe(n).executeLocal(new Pe().where(this.fields.parentID,"equal",l,!0)):r=this.getChildNodes(n,l);var c=0;if(r){for(var u=function(v){var m=r[parseInt(v.toString(),10)][d.fields.id].toString();(d.checkedNodes.indexOf(m)!==-1||d.element.classList.contains("e-filtering")&&h.findIndex(function(y){return y.id===m})!==-1)&&c++},d=this,p=0;p<r.length;p++)u(p);if(c===r.length){var f=a.getAttribute("data-uid");this.checkedNodes.indexOf(f)===-1&&this.checkDisabledState(f),this.changeState(a,"check",null,!0,!0)}else c===0&&this.checkedNodes.length===0&&i.length===0&&this.changeState(a,"uncheck",null,!0,!0)}}},t.prototype.checkIndeterminateState=function(i){var r;if(this.dataType===1?r=this.element.querySelector('[data-uid="'+i[this.fields.parentID]+'"]'):r=this.element.querySelector('[data-uid="'+i[this.fields.id]+'"]'),r){var n=r.getAttribute("aria-checked");n!=="true"&&this.changeState(r,"indeterminate",null,!0,!0)}else this.dataType===2&&this.parentNodeCheck.indexOf(i[this.fields.id].toString())===-1&&this.parentNodeCheck.push(i[this.fields.id].toString())},t.prototype.updateChildCheckState=function(i,r){for(var n=0,s=r[this.fields.id]?r[this.fields.id].toString():"",a=0;a<i.length;a++){var l=i[parseInt(a.toString(),10)][this.fields.id]?i[parseInt(a.toString(),10)][this.fields.id].toString():"";i[parseInt(a.toString(),10)][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[a]),this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(l)===-1&&this.autoCheck&&this.checkDisabledState(l,i[a]),this.checkedNodes.indexOf(l)!==-1&&this.autoCheck&&n++,this.checkedNodes.indexOf(l)>-1&&this.validNodes.indexOf(l)===-1&&this.validNodes.push(l);var h=V(this.fields.child.toString(),i[parseInt(a.toString(),10)]);h&&h.length&&(this.parentCheckData.indexOf(r)===-1&&this.parentCheckData.push(r),this.updateChildCheckState(h,i[parseInt(a.toString(),10)])),n===i.length&&this.autoCheck&&this.checkedNodes.indexOf(s)===-1&&this.checkDisabledState(s,r)}if(n!==0&&this.autoCheck){this.checkIndeterminateState(r);for(var c=0;c<this.parentCheckData.length;c++)r!==this.parentCheckData[parseInt(c.toString(),10)]&&this.parentCheckData[parseInt(c.toString(),10)]&&this.checkIndeterminateState(this.parentCheckData[parseInt(c.toString(),10)])}this.parentCheckData=[]},t.prototype.beforeNodeCreate=function(i){if(this.showCheckBox){var r=hl(this.createElement,!0,{cssClass:this.touchClass});r.classList.add(ts);var n=J("div."+ri+", div."+ar,i.item),s=i.item.getAttribute("data-uid");i.item.childNodes[0].insertBefore(r,i.item.childNodes[0].childNodes[g(n)?0:1]);var a=V(i.fields.isChecked,i.curData);this.checkedNodes.indexOf(s)>-1?(J("."+Fo,r).classList.add(Dn),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):!g(a)&&a.toString()==="true"?(J("."+Fo,r).classList.add(Dn),i.item.setAttribute("aria-checked","true"),this.addCheck(i.item)):i.item.setAttribute("aria-checked","false");var l=J("."+Fo,r);T.add(l,"mousedown",this.frameMouseHandler,this),T.add(l,"mouseup",this.frameMouseHandler,this),T.add(l,"mouseleave",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(i.item),this.allowMultiSelection&&!i.item.classList.contains(Ju)&&i.item.setAttribute("aria-selected","false");var h=i.fields;if(this.addActionClass(i,h.selected,Ju),this.addActionClass(i,h.expanded,vy),i.item.setAttribute("tabindex","-1"),T.add(i.item,"focus",this.focusIn,this),!g(this.nodeTemplateFn)){var c=i.item.querySelector("."+vc),u=i.item.getAttribute("data-uid");c.innerHTML="",this.renderNodeTemplate(i.curData,c,u)}var d={node:i.item,nodeData:i.curData,text:i.text};if(!this.isRefreshed&&(this.trigger("drawNode",d),i.curData[this.fields.selectable]===!1&&!this.showCheckBox)){i.item.classList.add(kf);var p=i.item.firstElementChild;p.style.cursor="not-allowed"}},t.prototype.frameMouseHandler=function(i){var r=J("."+HU,i.target.parentElement);ah(i,r)},t.prototype.addActionClass=function(i,r,n){var s=i.curData,a=V(r,s);!g(a)&&a.toString()!=="false"&&i.item.classList.add(n)},t.prototype.getDataType=function(i,r){if(this.fields.dataSource instanceof oe){for(var n=0;n<i.length;n++)if(this.isOffline){if(typeof r.child=="string"&&g(V(r.child,i[parseInt(n.toString(),10)]))&&!g(V(r.parentID,i[parseInt(n.toString(),10)])))return 1}else if(typeof r.child=="string"&&g(V(r.child,i[parseInt(n.toString(),10)])))return 1;return 2}for(var n=0,s=i.length;n<s;n++){if(typeof r.child=="string"&&(!g(V(r.child,i[parseInt(n.toString(),10)]))||Object.prototype.hasOwnProperty.call(i[parseInt(n.toString(),10)],r.child))||this.isChildObject())return 2;if(!g(V(r.parentID,i[parseInt(n.toString(),10)]))||!g(V(r.hasChildren,i[parseInt(n.toString(),10)])))return 1}return 1},t.prototype.getGroupedData=function(i,r){for(var n=new Pe().group(r),s=kt.getDataSource(i,n),a=[],l=0;l<s.length;l++){var h=s[parseInt(l.toString(),10)].items;a.push(h)}return a},t.prototype.getSortedData=function(i){return i&&this.sortOrder!=="None"&&(i=kt.getDataSource(i,kt.addSorting(this.sortOrder,this.fields.text))),i},t.prototype.finalizeNode=function(i,r,n){var s=this;if(r||this.updateAttributes(i),!n){var a=ze("."+vy,i);if(!this.loadOnDemand&&this.fields.dataSource instanceof oe&&(this.isInitalExpand=this.treeData.filter(function(h){return h[s.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),!this.isInitalExpand)for(var l=0;l<a.length;l++)this.renderChildNodes(a[parseInt(l.toString(),10)]);Z(a,vy)}r||this.updateList(),this.isLoaded&&this.updateCheckedProp()},t.prototype.updateAttributes=function(i){for(var r=ze("."+cF,i),n=0;n<r.length;n++)r[parseInt(n.toString(),10)].setAttribute("alt",cF);if(this.isLoaded){for(var s=ze("."+Ju,i),a=0;a<s.length;a++){this.selectNode(s[parseInt(a.toString(),10)],null);break}Z(s,Ju)}for(var l=ze("."+Tt+":not(."+vy+")",i),h=0;h<l.length;h++){var c=J("div."+nn,l[parseInt(h.toString(),10)]);c&&c.classList.contains(ri)&&this.disableExpandAttr(l[parseInt(h.toString(),10)])}},t.prototype.updateCheckedProp=function(){if(this.showCheckBox){var i=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:i},!0)}},t.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var i=ze("li",this.element),r=void 0,n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.contains(Tt)&&(r=J("."+ni,i[parseInt(n.toString(),10)]),r?this.ensureParentCheckState(i[parseInt(n.toString(),10)]):this.ensureChildCheckState(i[parseInt(n.toString(),10)]));else for(var s=ze("."+Ca,this.element),n=0;n<s.length;n++)s[parseInt(n.toString(),10)].classList.remove(Ca)},t.prototype.ensureParentCheckState=function(i){var r=this;if(!g(i)){if(i.classList.contains(Sa))return;var n=i;i.classList.contains(Tt)&&(n=J("."+ni,i));var s=ze("."+ts+" ."+Dn,n),a=ze("."+Ca,n),l=ze(this.checkDisabledChildren?"."+Tt:"."+Tt+":not(."+ed+")",n),h=i.getElementsByClassName(ts)[0],c=l.length,u=s.length,d=[],p=[],f=i.getAttribute("data-uid"),v=!0,m=!1,y=this.getAllChildNodes(this.DDTTreeData,f),b=0;l.forEach(function(A){if(A instanceof HTMLElement){var L=A.getAttribute("aria-checked");L==="true"?m=!0:v=!1}});var S=!1;if(this.element.classList.contains("e-filtering")){var C=new oe(this.OldCheckedData).executeLocal(new Pe().where("parentID","equal",f,!0));u=C.length;var x=new oe(this.OldCheckedData).executeLocal(new Pe().where("hasChildren","equal",!0,!0));x.length>0&&m&&(this.OldCheckedData.some(function(A){return A.id===f})||this.parentNodeCheck.indexOf(f)!==-1)&&(u=x.length,S=!0);var I=[];this.dataType===1?I=new oe(this.DDTTreeData).executeLocal(new Pe().where(this.fields.parentID,"equal",f,!0)):I=this.getChildNodes(this.DDTTreeData,f),c=I.length,y.forEach(function(A){var L=String(A[r.fields.id]);(r.checkedNodes.indexOf(L)!==-1||r.OldCheckedData.some(function(N){return N.parentID===L}))&&b++})}if(this.autoCheck&&this.showCheckBox&&!(this.fields.dataSource instanceof oe)){var D=this.getSelectedChildNodeDetails(f);d=D,p=new oe(this.checkActionNodes).executeLocal(new Pe().where("parentID","equal",f,!0))}if(c===0&&u===0)return;c===u||S&&c>0&&(p.length===d.length||p.length!==d.length)&&p.length!==0&&d.length!==0&&v&&this.autoCheck&&this.showCheckBox?this.changeState(h,"check",null,!0,!0):u>0&&!S&&this.autoCheck&&this.showCheckBox?this.changeState(h,"indeterminate",null,!0,!0):u>0||a.length>0||b>0?this.changeState(h,"indeterminate",null,!0,!0):u===0&&this.changeState(h,"uncheck",null,!0,!0);var M=H(i,"."+ni);if(!g(M)){var E=H(M,"."+Tt);this.ensureParentCheckState(E)}}},t.prototype.getSelectedChildNodeDetails=function(i){var r=this,n=typeof this.fields.child=="string"?this.fields.child:null,s=this.fields.id,a=this.fields.parentID,l=function(h){if(!g(n)&&n in h&&Array.isArray(h[n])){var c=h[s];if(!g(c))return c.toString()===i}else{var u=h[a];if(!g(u))return u.toString()===i}return!1};return this.checkedNodes.map(function(h){return r.getNodeObject(h)}).filter(function(h){return h&&typeof h=="object"&&n in h||r.dataType!==2&&typeof h=="object"&&(a in h||n in h)?l(h):!1})},t.prototype.getAllChildNodes=function(i,r){if(g(i)||g(r))return[];if(this.dataType===1){var n=this.fields.parentID,s=r.toString();return i.filter(function(d){var p=V(n,d);return!g(p)&&p.toString()===s})}if(this.dataType===2){var a=this.fields.id,l=this.fields.child.toString(),h=r.toString(),c=i.find(function(d){var p=V(a,d);return!g(p)&&p.toString()===h});if(!c)return[];var u=V(l,c);return Array.isArray(u)?u:[]}return[]},t.prototype.ensureChildCheckState=function(i,r,n){var s=this;if(!g(i)){var a=J("."+ni,i),l=void 0;if(!g(a)){var h=Array.from(a.querySelectorAll("li"));l=ze("."+ts,a),this.isFilter&&(l=Array.from(l).filter(function(m){var y=m.closest("li").getAttribute("data-uid");return y!==null&&s.checkedNodes.indexOf(y)!==-1}),h=Array.from(h).filter(function(m){var y=m.getAttribute("data-uid");return y!==null&&s.checkedNodes.indexOf(y)!==-1}),l.length===0&&(l=ze("."+ts,a),h=Array.from(a.querySelectorAll("li"))));for(var c=i.getElementsByClassName(Fo)[0].classList.contains(Dn),u=i.getElementsByClassName(Fo)[0].classList.contains(Ca),d=void 0,p=0;p<l.length;p++){var f=h[parseInt(p.toString(),10)].getAttribute("data-uid");if(!g(this.currentLoadData)&&!g(V(this.fields.isChecked,this.currentLoadData[parseInt(p.toString(),10)])))d=V(this.fields.isChecked,this.currentLoadData[parseInt(p.toString(),10)])?"check":"uncheck",this.ele!==-1&&(d=c?"check":"uncheck"),d==="uncheck"&&!Te(this.parentNodeCheck)&&this.autoCheck&&this.parentNodeCheck.indexOf(f)!==-1&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1),d="indeterminate");else{var v=l[parseInt(p.toString(),10)].getElementsByClassName(Fo)[0].classList.contains(Dn);c||v&&!this.isLoaded||this.checkedNodes.indexOf(f)!==-1&&this.isLoaded&&(u||c)?d="check":h[parseInt(p.toString(),10)].classList.contains(WU)&&!Te(this.parentNodeCheck)&&this.autoCheck&&(c||u)&&this.parentNodeCheck.indexOf(f)!==-1?(d="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)):this.dataType===1&&!Te(this.parentNodeCheck)&&this.autoCheck&&(c||u)&&this.parentNodeCheck.indexOf(f)!==-1?(d="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(f),1)):d="uncheck"}this.changeState(l[parseInt(p.toString(),10)],d,r,!0,!0)}}this.autoCheck&&this.isLoaded&&!n&&this.updateParentCheckState()}},t.prototype.doCheckBoxAction=function(i,r){var n=this;if(g(i)){var f=ze("."+ts,this.element);if(this.loadOnDemand)for(var v=0;v<f.length;v++){var a=H(f[parseInt(v.toString(),10)],"."+Tt);this.updateFieldChecked(f[parseInt(v.toString(),10)],r),this.changeState(f[parseInt(v.toString(),10)],r?"check":"uncheck",null,null,null,r),this.updateOldCheckedData([this.getNodeData(a)])}else for(var v=0;v<f.length;v++){var a=H(f[parseInt(v.toString(),10)],"."+Tt);this.updateFieldChecked(f[parseInt(v.toString(),10)],r),this.changeState(f[parseInt(v.toString(),10)],r?"check":"uncheck"),this.updateOldCheckedData([this.getNodeData(a)])}}else{i.length>1&&this.autoCheck&&(this.isBatchMode=!0,this.batchParentNode=new Set),i.reverse();for(var s=i.length-1;s>=0;s--){var a=this.getElement(i[parseInt(s.toString(),10)]);if(g(a)){var l=i[s-i.length]?i[s-i.length].toString():i[parseInt(s.toString(),10)]?i[parseInt(s.toString(),10)].toString():null;if(l!==""&&r&&l)this.setValidCheckedNode(l,i),this.dynamicCheckState(l,r);else if(this.checkedNodes.indexOf(l)!==-1&&l!==""&&!r){this.checkedNodes.splice(this.checkedNodes.indexOf(l),1);var h=this.getChildNodes(this.treeData,l);if(h){for(var c=0;c<h.length;c++){var u=h[parseInt(c.toString(),10)][this.fields.id]?h[parseInt(c.toString(),10)][this.fields.id].toString():null;if(this.checkedNodes.indexOf(u)!==-1){this.checkedNodes.splice(this.checkedNodes.indexOf(u),1);var d=this.element.querySelector('[data-uid="'+u+'"]');d&&this.changeState(d,"uncheck",null)}}this.parentNodeCheck.indexOf(l)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1)}l&&this.dynamicCheckState(l,r),this.updateField(this.treeData,this.fields,l,"isChecked",null)}continue}var p=J("."+ni+" ."+ts,a);this.validateCheckNode(p,!r,a,null)}this.isBatchMode&&this.autoCheck&&(this.isBatchMode=!1,Array.from(this.batchParentNode).forEach(function(y){var b=n.getElement(y);b&&n.ensureParentCheckState(b)}),this.batchParentNode.clear())}if(i)for(var m=0;m<i.length-1;m++){var l=i[parseInt(m.toString(),10)]?i[parseInt(m.toString(),10)].toString():"";r||this.updateField(this.treeData,this.fields,l,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},t.prototype.updateFieldChecked=function(i,r){var n=H(i,"."+Tt),s=n.getAttribute("data-uid"),a=this.getNodeData(n);a.isChecked==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null)},t.prototype.dynamicCheckState=function(i,r){if(this.dataType===1){var n=0,s=new oe(this.treeData).executeLocal(new Pe().where(this.fields.id,"equal",i,!0));if(s[0]){var a=s[0][this.fields.id]?s[0][this.fields.id].toString():null,l=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,h=this.element.querySelector('[data-uid="'+l+'"]'),c=this.element.querySelector('[data-uid="'+a+'"]'),u=this.getChildNodes(this.treeData,l);if(u)for(var d=0;d<u.length;d++){var p=u[parseInt(d.toString(),10)][this.fields.id]?u[parseInt(d.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(p)!==-1&&n++}this.checkedNodes.indexOf(i)!==-1&&h&&a===i&&this.autoCheck?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&c&&a===i&&!r?this.changeState(c,"uncheck",null):this.checkedNodes.indexOf(i)!==-1&&c&&a===i&&r?this.changeState(c,"check",null):this.checkedNodes.indexOf(i)===-1&&!c&&h&&a===i&&this.autoCheck&&n!==0?this.changeState(h,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&!c&&h&&a===i&&this.autoCheck&&n===0?this.changeState(h,"uncheck",null):!c&&!h&&a===i&&this.autoCheck&&this.updateIndeterminate(i,r)}}else if(this.dataType===2||this.fields.dataSource instanceof oe&&this.isOffline)for(var a=void 0,h=void 0,f=void 0,d=0;d<this.treeData.length;d++){a=this.treeData[parseInt(d.toString(),10)][this.fields.id]?this.treeData[parseInt(d.toString(),10)][this.fields.id].toString():"",h=this.element.querySelector('[data-uid="'+a+'"]'),f=h?J("."+Dn,h):null,this.checkedNodes.indexOf(a)===-1&&h&&f&&!r&&this.changeState(h,"uncheck",null);var v=V(this.fields.child.toString(),this.treeData[parseInt(d.toString(),10)]);v&&this.updateChildIndeterminate(v,a,i,r,a)}},t.prototype.updateIndeterminate=function(i,r){var n=this.getTreeData(i),s=0,a;this.dataType===1&&(a=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null);var l=this.getChildNodes(this.treeData,a);if(l)for(var h=0;h<l.length;h++){var c=l[parseInt(h.toString(),10)][this.fields.id]?l[parseInt(h.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(c)!==-1&&s++}var u=this.element.querySelector('[data-uid="'+a+'"]');u&&r?this.changeState(u,"indeterminate",null):!r&&u&&this.parentNodeCheck.indexOf(a)===-1&&s!==0?this.changeState(u,"indeterminate",null):!r&&u&&this.parentNodeCheck.indexOf(a)===-1&&s===0?this.changeState(u,"uncheck",null):u||(!r&&this.checkedNodes.indexOf(a)===-1&&this.parentNodeCheck.indexOf(a)!==-1?this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(a),1):r&&this.checkedNodes.indexOf(a)===-1&&this.parentNodeCheck.indexOf(a)===-1?this.parentNodeCheck.push(a):!r&&this.checkedNodes.indexOf(a)!==-1&&this.parentNodeCheck.indexOf(a)===-1&&s!==0&&this.parentNodeCheck.push(a),this.updateIndeterminate(a,r),this.checkedNodes.indexOf(a)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(a),1))},t.prototype.updateChildIndeterminate=function(i,r,n,s,a){for(var l=0,h=0;h<i.length;h++){var c=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"";this.checkedNodes.indexOf(c)!==-1&&l++;var u=this.element.querySelector('[data-uid="'+r+'"]'),d=u?J("."+Ca,u):null,p=u?J("."+Dn,u):null,f=this.element.querySelector('[data-uid="'+c+'"]'),v=f?J("."+Dn,f):null;if(this.checkedNodes.indexOf(n)!==-1&&u&&c===n&&this.autoCheck)this.changeState(u,"indeterminate",null);else if(this.checkedNodes.indexOf(n)===-1&&u&&!f&&c===n&&!s)this.autoCheck?this.changeState(u,"uncheck",null):l!==0?this.changeState(u,"indeterminate",null):this.changeState(u,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&f&&c===n&&!s)this.changeState(f,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&d&&c===n&&this.autoCheck&&l===0&&!s)d.classList.remove(Ca);else if(this.checkedNodes.indexOf(n)===-1&&!f&&p&&c===n&&l===0)this.changeState(u,"uncheck",null);else if(this.checkedNodes.indexOf(c)===-1&&f&&v&&l===0)this.changeState(f,"uncheck",null);else if(!f&&!u&&c===n||this.parentNodeCheck.indexOf(r)!==-1&&this.autoCheck){var m=this.element.querySelector('[data-uid="'+a+'"]');s&&l!==0?this.changeState(m,"indeterminate",null):s&&l===i.length&&this.checkedNodes.indexOf(r)===-1?this.checkDisabledState(r):!s&&l===0&&this.parentNodeCheck.indexOf(r)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r)),this.parentNodeCheck.indexOf(r)===-1&&this.parentNodeCheck.push(r)}var y=V(this.fields.child.toString(),i[parseInt(h.toString(),10)]);y&&this.updateChildIndeterminate(y,c,n,s,a)}},t.prototype.changeState=function(i,r,n,s,a,l){var h=this,c,u=H(i,"."+Tt);!this.checkDisabledChildren&&u&&(u.classList.contains(ed)||this.disableNode&&this.disableNode.indexOf(u.getAttribute("data-uid"))!==-1)||(i===u&&(i=J("."+ts,u)),s?this.nodeCheckAction(i,r,u,c,n,s,a,l):(this.checkActionNodes=[],c=this.getCheckEvent(u,r,n),this.trigger("nodeChecking",c,function(d){d.cancel||h.nodeCheckAction(i,r,u,d,n,s,a,l)})))},t.prototype.nodeCheckAction=function(i,r,n,s,a,l,h,c){var u,d=i.getElementsByClassName(Fo)[0];if(r==="check"&&!d.classList.contains(Dn)?(d.classList.remove(Ca),d.classList.add(Dn),this.addCheck(n),u="true"):r==="uncheck"&&(d.classList.contains(Dn)||d.classList.contains(Ca))?(Z([d],[Dn,Ca]),this.removeCheck(n),u="false"):r==="indeterminate"&&this.autoCheck&&(d.classList.remove(Dn),d.classList.add(Ca),this.removeCheck(n),u="mixed"),u=r==="check"?"true":r==="uncheck"?"false":u,g(u)||n.setAttribute("aria-checked",u),h){var p=[].concat([],this.checkActionNodes);s=this.getCheckEvent(n,r,a),Te(l)&&(s.data=p)}c!==void 0&&this.ensureStateChange(n,c),l||g(u)||(n.setAttribute("aria-checked",u),s.data[0].checked=u,this.trigger("nodeChecked",s),this.checkActionNodes=[])},t.prototype.addCheck=function(i){var r=i.getAttribute("data-uid");!g(r)&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r)},t.prototype.removeCheck=function(i){var r=this.checkedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.checkedNodes.splice(r,1)},t.prototype.getCheckEvent=function(i,r,n){this.checkActionNodes.push(this.getNodeData(i));var s=this.checkActionNodes;return{action:r,cancel:!1,isInteracted:!g(n),node:i,data:s}},t.prototype.finalize=function(){var i=J("."+ni,this.element);g(i)||(i.setAttribute("role",dF.treeRole),this.setMultiSelect(this.allowMultiSelection),this.setNodeFocusable(),this.allowTextWrap&&this.updateWrap(),this.renderReactTemplates(),this.hasPid=this.rootData[0]?Object.prototype.hasOwnProperty.call(this.rootData[0],this.fields.parentID):!1,this.doExpandAction())},t.prototype.setTextWrap=function(){(this.allowTextWrap?X:Z)([this.element],OU),j.isIE&&(this.allowTextWrap?X:Z)([this.element],zU)},t.prototype.updateWrap=function(i){if(this.fullRowSelect)for(var r=i?ze("."+Tt,i):this.liList,n=r.length,s=0;s<n;s++)this.calculateWrap(r[parseInt(s.toString(),10)])},t.prototype.calculateWrap=function(i){var r=J("."+Cl,i);r&&r.nextElementSibling&&(r.style.height=this.allowTextWrap?r.nextElementSibling.offsetHeight+"px":"")},t.prototype.doExpandAction=function(){var i=this,r=this.expandedNodes;if(!this.loadOnDemand&&this.fields.dataSource instanceof oe&&(this.isInitalExpand=this.treeData.filter(function(l){return l[i.fields.expanded]===!0}).length>0?!0:this.isInitalExpand),this.isInitalExpand&&r.length>0)if(this.setProperties({expandedNodes:[]},!0),this.fields.dataSource instanceof oe)this.expandGivenNodes(r);else{for(var n=0;n<r.length;n++){var s=J('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(g(s)){r[parseInt(n.toString(),10)]&&this.expandChildren.indexOf(r[parseInt(n.toString(),10)])===-1&&this.expandChildren.push(r[parseInt(n.toString(),10)].toString());continue}else{var a=J("."+ri,J("."+pn,s));g(a)||this.expandAction(s,a,null)}}this.afterFinalized()}else this.afterFinalized()},t.prototype.expandGivenNodes=function(i){var r=this;this.expandCallback(i[this.index],function(){r.index++,r.index<i.length?r.expandGivenNodes(i):r.afterFinalized()}),this.index>0&&(this.index=0)},t.prototype.expandCallback=function(i,r){var n=J('[data-uid="'+i+'"]',this.element);if(g(n))r();else{var s=J("."+ri,J("."+pn,n));g(s)||this.expandAction(n,s,null,!1,r),r()}},t.prototype.afterFinalized=function(){if(this.doSelectionAction(),this.updateCheckedProp(),this.isAnimate=!0,this.isInitalExpand=!1,(!this.isLoaded||this.isFieldChange)&&!this.isNodeDropped){var i={data:this.treeData};this.trigger("dataBound",i)}this.isLoaded=!0,this.isNodeDropped=!1},t.prototype.doSelectionAction=function(){var i=ze("."+Ju,this.element),r=this.selectedNodes;if(r.length>0){this.setProperties({selectedNodes:[]},!0);for(var n=0;n<r.length;n++){var s=J('[data-uid="'+r[parseInt(n.toString(),10)]+'"]',this.element);if(s&&!s.classList.contains("e-active")?this.selectNode(s,null,!0):this.selectedNodes.push(r[parseInt(n.toString(),10)]),!this.allowMultiSelection)break}}else this.selectGivenNodes(i);Z(i,Ju)},t.prototype.selectGivenNodes=function(i){for(var r=0;r<i.length&&(i[parseInt(r.toString(),10)].classList.contains("e-disable")||this.selectNode(i[parseInt(r.toString(),10)],null,!0),!!this.allowMultiSelection);r++);},t.prototype.clickHandler=function(i){var r=j.isDevice&&i.originalEvent.changedTouches&&!j.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;if(T.remove(this.element,"contextmenu",this.preventContextMenu),!(!r||this.dragStartAction)){var n=r.classList,s=H(r,"."+Tt);if(!s||s.classList.contains(kf)&&!(n.contains(ri)||n.contains(ar)))return;if(i.originalEvent.which!==3){var a=J("."+VU,s),l=J("."+nn,s);this.removeHover(),this.setFocusElement(s);var h=n.contains(ri)||n.contains(ar);if(this.showCheckBox&&!s.classList.contains("e-disable")&&!h){var c=this.checkOnClick?J("."+ts,s):H(r,"."+ts);if(!g(c)){var u=J("."+Fo,c);this.validateCheckNode(c,u.classList.contains(Dn),s,i.originalEvent),this.triggerClickEvent(i.originalEvent,s);return}}n.contains(ri)?this.expandAction(s,r,i):n.contains(ar)?this.collapseNode(s,r,i):a&&l?l.classList.contains(hF)&&l.classList.contains(ri)?this.expandAction(s,l,i):l.classList.contains(hF)&&l.classList.contains(ar)?this.collapseNode(s,l,i):!n.contains(ni)&&!n.contains(Tt)&&this.toggleSelect(s,i.originalEvent,!1):!n.contains(ni)&&!n.contains(Tt)&&this.toggleSelect(s,i.originalEvent,!1)}i.originalEvent.which===3&&(this.isRightClick=!0),this.triggerClickEvent(i.originalEvent,s)}},t.prototype.nodeCheckedEvent=function(i,r,n){var s=this.getCheckEvent(i,r?"uncheck":"check",n);s.data=s.data.splice(0,s.data.length-1),this.trigger("nodeChecked",s)},t.prototype.updateOldCheckedData=function(i){var r=this,n=new oe(i),s=n.executeLocal(new Pe().where("isChecked","equal","true",!0)),a=n.executeLocal(new Pe().where("isChecked","equal","false",!0));if(a.length>0){var l=this.OldCheckedData.findIndex(function(c){return c.id===a[0].id});if(l!==-1){this.OldCheckedData.splice(l,1);var h=this.OldCheckedData.filter(function(c){return c.parentID===a[0].id});h.length>0&&h.forEach(function(c){var u=r.OldCheckedData.findIndex(function(d){return d.id===c.id});u!==-1&&r.OldCheckedData.splice(u,1)});return}}if(s.length>0){var l=this.OldCheckedData.findIndex(function(u){return u.id===s[0].id});if(l===-1){this.OldCheckedData.push(s[0]);return}}},t.prototype.triggerClickEvent=function(i,r){var n={event:i,node:r};this.trigger("nodeClicked",n)},t.prototype.expandNode=function(i,r,n){var s=this;if(this.renderReactTemplates(),r.classList.contains(uy)&&this.hideSpinner(r),this.initialRender||r.classList.add("interaction"),n!==!0||n===!0&&i.classList.contains("e-expanded")){if(this.preventExpand!==!0){Z([r],ri),X([r],ar);var a=0,l=0,h=J("."+ni,i),c=i;if(this.isAnimate&&!this.isRefreshed){this.setHeight(c,h);var u=J("."+Tt+"."+Mn,i);this.aniObj.animate(h,{name:this.animation.expand.effect,duration:this.animation.expand.duration===0&&Yt==="Enable"?400:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(){c.style.overflow="hidden",!g(u)&&u instanceof HTMLElement&&u.classList.add(my),a=c.offsetHeight;var p=window.getComputedStyle(c),f=parseFloat(p.paddingTop),v=parseFloat(p.paddingBottom);l=J("."+pn,i).offsetHeight+v+f},progress:function(p){p.element.style.display="block",s.animateHeight(p,a,l)},end:function(p){p.element.style.display="block",!g(u)&&u instanceof HTMLElement&&u.classList.remove(my),s.expandedNode(c,h,r)}})}else this.expandedNode(c,h,r)}}else{var d=J("."+ni,i);d.style.display="none",this.fields.dataSource instanceof oe&&(this.preventExpand=!1)}this.initialRender&&r.classList.add("interaction")},t.prototype.expandedNode=function(i,r,n){r.style.display="block",i.style.display="block",i.style.overflow="",i.style.height="",Z([n],Sl),this.addExpand(i),this.allowTextWrap&&this.isLoaded&&this.isFirstRender&&(this.updateWrap(i),this.isFirstRender=!1),this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(i,null),this.expandArgs.isInteracted=this.isInteracted,this.trigger("nodeExpanded",this.expandArgs)),this.isHiddenItem&&this.collapseAll([this.getNodeData(i).id])},t.prototype.addExpand=function(i){i.setAttribute("aria-expanded","true"),Z([i],lF);var r=i.getAttribute("data-uid");!g(r)&&this.expandedNodes.indexOf(r)===-1&&this.expandedNodes.push(r)},t.prototype.collapseNode=function(i,r,n){var s=this;if(!r.classList.contains(Sl)){X([r],Sl);var a;this.isLoaded?(a=this.getExpandEvent(i,n),this.isInteracted=a.isInteracted,this.trigger("nodeCollapsing",a,function(l){l.cancel?Z([r],Sl):s.nodeCollapseAction(i,r,l)})):this.nodeCollapseAction(i,r,a)}},t.prototype.nodeCollapseAction=function(i,r,n){var s=this;Z([r],ar),X([r],ri);var a=0,l=0,h=J("."+ni,i),c=i,u=J("."+Tt+"."+Mn,i);this.isAnimate?this.aniObj.animate(h,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration===0&&Yt==="Enable"?400:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(){c.style.overflow="hidden",!g(u)&&u instanceof HTMLElement&&u.classList.add(my),a=J("."+pn,i).offsetHeight,l=c.offsetHeight},progress:function(d){s.animateHeight(d,a,l)},end:function(d){d.element.style.display="none",!g(u)&&u instanceof HTMLElement&&u.classList.remove(my),s.collapsedNode(c,h,r,n)}}):this.collapsedNode(c,h,r,n)},t.prototype.collapsedNode=function(i,r,n,s){r.style.display="none",i.style.overflow="",i.style.height="",Z([n],Sl),this.removeExpand(i),this.isLoaded&&(s=this.getExpandEvent(i,null),s.isInteracted=this.isInteracted,this.trigger("nodeCollapsed",s))},t.prototype.removeExpand=function(i,r){r?i.removeAttribute("aria-expanded"):this.disableExpandAttr(i);var n=this.expandedNodes.indexOf(i.getAttribute("data-uid"));n>-1&&this.expandedNodes.splice(n,1)},t.prototype.disableExpandAttr=function(i){i.setAttribute("aria-expanded","false"),X([i],lF)},t.prototype.setHeight=function(i,r){r.style.display="block",r.style.visibility="hidden",i.style.height=i.offsetHeight+"px",r.style.display="none",r.style.visibility=""},t.prototype.animateHeight=function(i,r,n){if(!g(i.element.parentElement)){var s=(i.duration-i.timeStamp)/i.duration,a=(n-r)*s+r;i.element.parentElement.style.height=a+"px"}},t.prototype.renderChildNodes=function(i,r,n,s,a){var l=this,h=J("div."+nn,i);if(!g(h)){this.showSpinner(h);var c;if(this.fields.dataSource instanceof oe){var u=this.parents(i,"."+ni).length,d=this.getChildFields(this.fields,u,1);if(g(d)||g(d.dataSource)){se(h),this.removeExpand(i,!0);return}this.treeList.push("false"),this.fields.dataSource instanceof oe&&this.isOffline?(this.treeList.pop(),c=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.loadChild(c,d,h,i,r,n,s)):d.dataSource.executeQuery(this.getQuery(d,i.getAttribute("data-uid"))).then(function(p){l.treeList.pop(),c=p.result,l.dataType===1&&(l.dataType=2),l.loadChild(c,d,h,i,r,n,s)}).catch(function(p){l.trigger("actionFailure",{error:p})})}else if(c=this.getChildNodes(this.treeData,i.getAttribute("data-uid"),!1,parseFloat(i.getAttribute("aria-level"))+1),this.currentLoadData=this.getSortedData(c),g(c)||c.length===0){se(h),h.classList.contains(uy)&&this.hideSpinner(h),this.removeExpand(i,!0);return}else this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(kt.createList(this.createElement,this.currentLoadData,this.listBaseOption)),this.expandNode(i,h,s),this.setSelectionForChildNodes(c),this.ensureCheckNode(i,a),this.finalizeNode(i,a,r),this.disableTreeNodes(c),this.renderSubChild(i,r,s,a)}},t.prototype.loadChild=function(i,r,n,s,a,l,h){if(this.currentLoadData=i,g(i)||i.length===0)se(n),this.removeExpand(s,!0);else{if(this.updateListProp(r),this.fields.dataSource instanceof oe&&!this.isOffline){var c=s.getAttribute("data-uid"),u=this.getNodeObject(c);it("child",i,u)}this.listBaseOption.ariaAttributes.level=parseFloat(s.getAttribute("aria-level"))+1,s.appendChild(kt.createList(this.createElement,i,this.listBaseOption)),this.expandNode(s,n,h),this.setSelectionForChildNodes(i),this.ensureCheckNode(s),this.finalizeNode(s),this.disableTreeNodes(i),this.renderSubChild(s,a,h)}l&&l(),a&&this.expandedNodes.push(s.getAttribute("data-uid")),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.disableTreeNodes=function(i){if(!(g(this.disableNode)||this.disableNode.length===0))for(var r=0;r<i.length;){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.disableNode!==void 0&&this.disableNode.indexOf(n)!==-1&&this.doDisableAction([n]),r++}},t.prototype.setSelectionForChildNodes=function(i){if(!(g(this.selectedNodes)||this.selectedNodes.length===0)){var r;for(r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)][this.fields.id]?i[parseInt(r.toString(),10)][this.fields.id].toString():null;this.selectedNodes!==void 0&&this.selectedNodes.indexOf(n)!==-1&&this.doSelectionAction()}}},t.prototype.ensureCheckNode=function(i,r){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(i.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(i,null,r),(!r||J("."+Dn,this.element)||J("."+Ca,this.element))&&this.ensureParentCheckState(i))),this.currentLoadData=null},t.prototype.getFields=function(i,r,n){return r===n?i:this.getFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildFields=function(i,r,n){return r===n?this.getChildMapper(i):this.getChildFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildMapper=function(i){return typeof i.child=="string"||g(i.child)?i:i.child},t.prototype.getChildNodes=function(i,r,n,s){var a=this;n===void 0&&(n=!1);var l;if(g(i))return l;if(this.dataType===1)return this.getChildGroup(this.groupedData,r,n);if(typeof this.fields.child=="string")return this.findChildNodes(i,this.fields.id,r)||this.findNestedChildNodes(i,r,s)||[];if(this.isChildObject()){for(var h=g(s)?this.fields.child:this.fields,c=1;c<s&&!g(h.child);){h=h.child;c++}this.updateListProp(h);var u=i.findIndex(function(m){return V(a.fields.id,m)&&V(a.fields.id,m).toString()===r});if(u!==-1)return V("child",i[parseInt(u.toString(),10)]);if(u===-1)for(var d=0,p=i.length;d<p;d++){var f=V("child",i[parseInt(d.toString(),10)]),v=g(f)?-1:f.findIndex(function(m){return V(a.fields.child.id,m)&&V(a.fields.child.id,m).toString()===r});if(v!==-1)return V("child",f[parseInt(v.toString(),10)]);if(!g(f)&&(l=this.getChildNodes(f,r,!1,s),l!==void 0))break}}return l},t.prototype.findChildNodes=function(i,r,n){var s=i.findIndex(function(a){var l=V(r,a);return l&&l.toString()===n});return s!==-1?V(this.fields.child,i[s]):null},t.prototype.findNestedChildNodes=function(i,r,n){for(var s=0,a=i;s<a.length;s++){var l=a[s],h=V(this.fields.child,l);if(!g(h)){var c=this.findChildNodes(h,this.fields.id,r);if(c)return c;var u=this.getChildNodes(h,r,!1,n);if(u&&u.length>0)return u}}},t.prototype.getChildGroup=function(i,r,n){var s=[];if(g(i))return s;for(var a=0,l=i.length;a<l;a++)if(!g(i[parseInt(a.toString(),10)][0])&&!g(V(this.fields.parentID,i[parseInt(a.toString(),10)][0]))){if(V(this.fields.parentID,i[parseInt(a.toString(),10)][0]).toString()===r)return i[parseInt(a.toString(),10)]}else if(n)return i[parseInt(a.toString(),10)];return s},t.prototype.renderSubChild=function(i,r,n,s){if(r)for(var a=ze("."+ri,i),l=0,h=a.length;l<h;l++){var c=a[parseInt(l.toString(),10)];if(i.querySelector(".e-icons")!==a[parseInt(l.toString(),10)]){var u=H(c,"."+Tt);this.expandArgs=this.getExpandEvent(u,null),n!==!0&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(u,r,null,n,s)}}},t.prototype.toggleSelect=function(i,r,n){i.classList.contains("e-disable")||(this.allowMultiSelection&&(r&&r.ctrlKey||n)&&this.isActive(i)?this.unselectNode(i,r):this.selectNode(i,r,n))},t.prototype.isActive=function(i){return!!i.classList.contains(Mn)},t.prototype.selectNode=function(i,r,n){var s=this;if(g(i)||!this.allowMultiSelection&&this.isActive(i)&&!g(r)){if(this.checkOnClick){var a=J(" ."+Fo,i);!g(a)&&a.classList.contains(Dn)?X([i],Mn):Z([i],Mn)}this.setFocusElement(i);return}var l;this.isLoaded?(l=this.getSelectEvent(i,"select",r),this.trigger("nodeSelecting",l,function(h){!h.cancel&&!h.node.classList.contains(kf)&&s.nodeSelectAction(i,r,h,n)})):this.nodeSelectAction(i,r,l,n)},t.prototype.nodeSelectAction=function(i,r,n,s){if((!this.allowMultiSelection||!s&&(!r||r&&!(r.ctrlKey||r.metaKey)))&&this.removeSelectAll(),this.allowMultiSelection&&r&&r.shiftKey){this.startNode||(this.startNode=i);var a=this.liList.indexOf(this.startNode),l=this.liList.indexOf(i);if(a>l){var h=a;a=l,l=h}for(var c=a;c<=l;c++){var u=this.liList[parseInt(c.toString(),10)];wr(u)&&!u.classList.contains("e-disable")&&this.addSelect(u)}}else this.startNode=i,this.addSelect(i);this.isLoaded&&(n.nodeData=this.getNodeData(i),this.trigger("nodeSelected",n),this.isRightClick=!1),this.isRightClick=!1},t.prototype.unselectNode=function(i,r){var n=this,s;this.isLoaded?(s=this.getSelectEvent(i,"un-select",r),this.trigger("nodeSelecting",s,function(a){a.cancel||n.nodeUnselectAction(i,a)})):this.nodeUnselectAction(i,s)},t.prototype.nodeUnselectAction=function(i,r){this.removeSelect(i),this.setFocusElement(i),this.isLoaded&&(r.nodeData=this.getNodeData(i),this.trigger("nodeSelected",r))},t.prototype.setFocusElement=function(i){if(!g(i)){var r=this.getFocusedNode();r&&(Z([r],mc),r.setAttribute("tabindex","-1")),X([i],mc),i.setAttribute("tabindex","0"),T.add(i,"blur",this.focusOut,this),this.updateIdAttr(r,i)}},t.prototype.addSelect=function(i){i.setAttribute("aria-selected","true"),X([i],Mn);var r=i.getAttribute("data-uid");!g(r)&&this.selectedNodes.indexOf(r)===-1&&this.selectedNodes.push(r)},t.prototype.removeSelect=function(i){this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected"),Z([i],Mn);var r=this.selectedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.selectedNodes.splice(r,1)},t.prototype.removeSelectAll=function(){for(var i=this.element.querySelectorAll("."+Mn),r=0,n=i;r<n.length;r++){var s=n[r];this.allowMultiSelection?s.setAttribute("aria-selected","false"):s.removeAttribute("aria-selected")}Z(i,Mn),this.setProperties({selectedNodes:[]},!0)},t.prototype.getSelectEvent=function(i,r,n){var s=this.getNodeData(i);return{action:r,cancel:!1,isInteracted:!g(n),node:i,nodeData:s}},t.prototype.setExpandOnType=function(){this.expandOnType=this.expandOn==="Auto"?j.isDevice?"Click":"DblClick":this.expandOn},t.prototype.expandHandler=function(i){var r=j.isDevice&&i.originalEvent.changedTouches&&!j.isIos?document.elementFromPoint(i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY):i.originalEvent.target;!r||r.classList.contains(dy)||r.classList.contains(Sa)||r.classList.contains(ni)||r.classList.contains(Tt)||r.classList.contains(nn)||this.showCheckBox&&H(r,"."+ts)||this.expandCollapseAction(H(r,"."+Tt),i)},t.prototype.expandCollapseAction=function(i,r){var n=J("div."+nn,i);if(!(!n||n.classList.contains(Sl))){var s=n.classList;s.contains(ri)?this.expandAction(i,n,r):s.contains(ar)&&this.collapseNode(i,n,r)}},t.prototype.expandAction=function(i,r,n,s,a,l){var h=this;r.classList.contains(Sl)||(X([r],Sl),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(i,n),this.isInteracted=this.expandArgs.isInteracted,this.trigger("nodeExpanding",this.expandArgs,function(c){c.cancel?Z([r],Sl):h.nodeExpandAction(i,r,s,a,l)})):this.nodeExpandAction(i,r,s,a,l))},t.prototype.nodeExpandAction=function(i,r,n,s,a){var l=J("."+ni,i);if(l&&l.nodeName==="UL")this.expandNode(i,r);else{if(this.isFirstRender=!0,this.renderChildNodes(i,n,s,null,a),g(this.expandChildren)||this.expandChildren.length===0)return;for(var h=ze("."+Tt,i),c=0;c<h.length;c++){var u=this.getId(h[parseInt(c.toString(),10)]);if(this.expandChildren.indexOf(u)!==-1&&this.expandChildren!==void 0){var d=J("."+ri,J("."+pn,h[parseInt(c.toString(),10)]));g(d)||this.expandAction(h[parseInt(c.toString(),10)],d,null),this.expandChildren.splice(this.expandChildren.indexOf(u),1)}}}},t.prototype.keyActionHandler=function(i){var r=this,n=i.target,s=this.getFocusedNode();if(n&&n.classList.contains(dy)){var a=n;i.action==="enter"?a.blur():i.action==="escape"&&(a.value=this.oldText,a.blur());return}i.preventDefault();var l={cancel:!1,event:i,node:s};this.trigger("keyPress",l,function(h){if(!h.cancel)switch(i.action){case"space":r.showCheckBox?r.checkNode(i):r.toggleSelect(s,i);break;case"moveRight":r.openNode(!r.enableRtl,i);break;case"moveLeft":r.openNode(!!r.enableRtl,i);break;case"shiftDown":r.shiftKeySelect(!0,i);break;case"moveDown":case"ctrlDown":case"csDown":r.navigateNode(!0);break;case"shiftUp":r.shiftKeySelect(!1,i);break;case"moveUp":case"ctrlUp":case"csUp":r.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":r.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":r.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":case"shiftSpace":case"ctrlSpace":r.toggleSelect(s,i);break;case"f2":r.allowEditing&&!s.classList.contains("e-disable")&&r.createTextbox(s);break;case"ctrlA":if(r.allowMultiSelection){var c=ze("."+Tt+":not(."+Mn+")",r.element);r.selectGivenNodes(c)}break}})},t.prototype.navigateToFocus=function(i){var r=this.getFocusedNode().querySelector("."+pn),n=r.getBoundingClientRect(),s=this.getScrollParent(this.element);if(!g(s)){var a=s.getBoundingClientRect();n.bottom>a.bottom?s.scrollTop+=n.bottom-a.bottom:n.top<a.top&&(s.scrollTop-=a.top-n.top)}var l=this.isVisibleInViewport(r);l||r.scrollIntoView(i)},t.prototype.isVisibleInViewport=function(i){var r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.getScrollParent=function(i){return g(i)?null:i.scrollHeight>i.clientHeight?i:this.getScrollParent(i.parentElement)},t.prototype.shiftKeySelect=function(i,r){if(this.allowMultiSelection){var n=this.getFocusedNode(),s=i?this.getNextNode(n):this.getPrevNode(n);this.removeHover(),this.setFocusElement(s),this.toggleSelect(s,r,!1),this.navigateToFocus(!i)}else this.navigateNode(i)},t.prototype.checkNode=function(i){var r=this.getFocusedNode(),n=J("."+ts,r),s=J(" ."+Fo,n).classList.contains(Dn);r.classList.contains("e-disable")||r.getElementsByClassName("e-checkbox-disabled").length===0&&this.validateCheckNode(n,s,r,i)},t.prototype.validateCheckNode=function(i,r,n,s){var a=this,l=H(i,"."+Tt);this.checkActionNodes=[];var h=r?"false":"true";g(h)||l.setAttribute("aria-checked",h);var c=this.getCheckEvent(l,r?"uncheck":"check",s);this.trigger("nodeChecking",c,function(u){u.cancel||a.nodeCheckingAction(i,r,n,u,s)})},t.prototype.nodeCheckingAction=function(i,r,n,s,a){if(this.checkedElement.indexOf(n.getAttribute("data-uid"))===-1&&(this.checkedElement.push(n.getAttribute("data-uid")),this.autoCheck)){var l=this.getChildNodes(this.treeData,n.getAttribute("data-uid"));l!==null?this.allCheckNode(l,this.checkedElement,null,null,!1):l=null}if(this.changeState(i,r?"uncheck":"check",a,!0),this.updateActiveClass(n,r),this.autoCheck){this.ensureChildCheckState(n),this.updateOldCheckedData([this.getNodeData(n)]);var h=H(H(n,"."+ni),"."+Tt);if(this.isBatchMode){var c=g(h)?null:h.getAttribute("data-uid");c&&this.batchParentNode.add(c)}else this.ensureParentCheckState(h);var u=void 0;s.action==="check"?u=!0:s.action==="uncheck"&&(u=!1),this.ensureStateChange(n,u)}this.nodeCheckedEvent(i,r,a)},t.prototype.updateActiveClass=function(i,r){this.showCheckBox&&this.checkOnClick&&(r==="check"||r===!1?(this.removeSelectAll(),X([i],Mn)):(r==="uncheck"||r==="indeterminate"||r===!0)&&Z([i],Mn))},t.prototype.ensureStateChange=function(i,r){var n=this,s=J("."+ni,i),a=i.getAttribute("data-uid"),l=this.fields;if(this.dataType===1&&this.autoCheck){var h=new oe(this.treeData).executeLocal(new Pe().where(l.parentID,"equal",a,!0)),c=h.filter(function(C){return n.checkedNodes.indexOf(C[l.id].toString())!==-1},this);this.checkedNodes.indexOf(a)!==-1&&c.length!==h.length&&this.isFilter&&c.length>0&&(h=c);for(var u=0;u<h.length;u++){var d=h[parseInt(u.toString(),10)][this.fields.id]?h[parseInt(u.toString(),10)][this.fields.id].toString():null,p=h[parseInt(u.toString(),10)][this.fields.isChecked]?h[parseInt(u.toString(),10)][this.fields.isChecked].toString():null;if(this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(d)===-1){this.checkDisabledState(d,h[u]);var f=this.getChildNodes(this.treeData,d);this.getChildItems(f,r),this.parentNodeCheck.indexOf(d)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)}else if(this.checkedNodes.indexOf(a)===-1&&s===null&&this.checkedNodes.indexOf(d)!==-1){if(this.checkedNodes.splice(this.checkedNodes.indexOf(d),1),p==="true"&&this.updateField(this.treeData,this.fields,d,"isChecked",null),this.checkedNodes.indexOf(a)===-1&&s===null||this.parentNodeCheck.indexOf(d)!==-1){var v=this.getChildNodes(this.treeData,d);this.getChildItems(v,r),this.parentNodeCheck.indexOf(d)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(d),1)}}else{var f=this.getChildNodes(this.treeData,d);this.getChildItems(f,r)}}}else if(this.dataType===1&&!this.autoCheck)if(r)for(var u=0;u<this.treeData.length;u++){var b=this.treeData[parseInt(u.toString(),10)][this.fields.id]?this.treeData[parseInt(u.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(b)===-1&&this.checkDisabledState(b,this.treeData[u])}else{for(var m=new oe(this.treeData).executeLocal(new Pe().where(l.isChecked,"equal",!0,!1)),u=0;u<m.length;u++){var y=m[parseInt(u.toString(),10)][this.fields.id]?m[parseInt(u.toString(),10)][this.fields.id].toString():null;this.checkedNodes.indexOf(y)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(y),1),this.updateField(this.treeData,this.fields,y,"isChecked",null)}this.checkedNodes=[]}else{var f=this.getChildNodes(this.treeData,a);if(f){var S=f.filter(function(x){var I=String(x[Object.keys(x)[0]]);return n.checkedNodes.indexOf(I)!==-1});S.length>0&&f.length&&this.isFilter&&(f=S),this.childStateChange(f,a,s,r)}}},t.prototype.checkDisabledState=function(i,r){var n=this.checkDisabledChildren;if(!n){var s=!0;if(this.loadOnDemand&&this.fields.htmlAttributes&&(r=g(r)?r:this.getNodeObject(i),!g(r))){var a=r[this.fields.htmlAttributes];a&&!g(a.class)&&a.class.indexOf(ed)!==-1&&(s=!1)}var l=J('[data-uid="'+i+'"]',this.element);n=l?!l.classList.contains(ed):this.disableNode.indexOf(i)===-1&&s}n&&this.checkedNodes.push(i)},t.prototype.getChildItems=function(i,r){for(var n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null,a=i[parseInt(n.toString(),10)][this.fields.isChecked]?i[parseInt(n.toString(),10)][this.fields.isChecked].toString():null;this.checkedNodes.indexOf(s)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(s),1),this.checkedNodes.indexOf(s)===-1&&r&&this.checkDisabledState(s,i[n]),a==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null);var l=this.getChildNodes(this.treeData,s);l.length>0&&this.getChildItems(l,r)}},t.prototype.childStateChange=function(i,r,n,s){for(var a=0;a<i.length;a++){var l=i[parseInt(a.toString(),10)][this.fields.id]?i[parseInt(a.toString(),10)][this.fields.id].toString():"",h=i[parseInt(a.toString(),10)][this.fields.isChecked]?i[parseInt(a.toString(),10)][this.fields.isChecked].toString():null;this.autoCheck?this.checkedNodes.indexOf(r)!==-1&&this.checkedNodes.indexOf(l)===-1?(this.checkDisabledState(l,i[a]),this.parentNodeCheck.indexOf(l)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1)):this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.indexOf(l)!==-1&&!s&&(this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),h==="true"&&this.updateField(this.treeData,this.fields,l,"isChecked",null)):this.autoCheck||(s?this.checkedNodes.indexOf(l)===-1&&this.checkDisabledState(l,i[a]):(this.checkedNodes.indexOf(l)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(l),1),this.updateField(this.treeData,this.fields,l,"isChecked",null),this.checkedNodes=[]));var c=this.getChildNodes([i[parseInt(a.toString(),10)]],l);c&&this.childStateChange(c,r,n,s)}},t.prototype.allCheckNode=function(i,r,n,s,a){if(i)for(var l=0;l<i.length;l++){var h=V(this.fields.id,i[parseInt(l.toString(),10)]),c=this.element.querySelector('[data-uid="'+h+'"]');a!==!1&&this.checkedElement.indexOf(h.toString())===-1&&(c===null&&!g(i[parseInt(l.toString(),10)][this.fields.isChecked])&&r.indexOf(h.toString())===-1||s===0||n===2)&&(i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?r.push(h.toString()):s=null,s=i[parseInt(l.toString(),10)][this.fields.isChecked]!==!1||n===2?0:null),r.indexOf(h.toString())===-1&&g(n)&&r.push(h.toString());var u=V(this.fields.child.toString(),i[parseInt(l.toString(),10)]);if(V(this.fields.hasChildren,i[parseInt(l.toString(),10)])===!0||u){var d=V(this.fields.id,i[parseInt(l.toString(),10)]),p=void 0;this.dataType===1?p=this.getChildNodes(this.treeData,d.toString()):p=u,p&&(g(a)?this.allCheckNode(p,r,n,s):this.allCheckNode(p,r,n,s,a),s=null)}s=null}},t.prototype.openNode=function(i,r){var n=this.getFocusedNode(),s=J("div."+nn,n);if(i)if(s)s.classList.contains(ri)?this.expandAction(n,s,r):this.focusNextNode(n,!0);else return;else if(s&&s.classList.contains(ar))this.collapseNode(n,s,r);else{var a=H(H(n,"."+ni),"."+Tt);if(a)a.classList.contains("e-disable")||(this.setFocus(n,a),this.navigateToFocus(!0));else return}},t.prototype.navigateNode=function(i){var r=this.getFocusedNode();this.focusNextNode(r,i)},t.prototype.navigateRootNode=function(i){var r=this.getFocusedNode(),n=i?this.getRootNode():this.getEndNode();n.classList.contains("e-disable")||(this.setFocus(r,n),this.navigateToFocus(i))},t.prototype.getFocusedNode=function(){var i,r=J("."+Tt+'[tabindex="0"]',this.element);if(!g(r)){var n=r.getAttribute("aria-checked");(n==="mixed"||n==="false")&&(this.isFilter=!1)}return g(r)&&(i=J("."+Tt,this.element)),g(r)?g(i)?this.element.firstElementChild:i:r},t.prototype.focusNextNode=function(i,r){var n=r?this.getNextNode(i):this.getPrevNode(i);if(this.setFocus(i,n),this.navigateToFocus(!r),n.classList.contains("e-disable")){var s=n.lastChild;n.previousSibling==null&&n.classList.contains("e-level-1")?this.focusNextNode(n,!0):n.nextSibling==null&&n.classList.contains("e-node-collapsed")?this.focusNextNode(n,!1):n.nextSibling==null&&s.classList.contains(pn)?this.focusNextNode(n,!1):this.focusNextNode(n,r)}},t.prototype.getNextNode=function(i){var r=this.liList.indexOf(i),n;do if(r++,n=this.liList[parseInt(r.toString(),10)],g(n))return i;while(!wr(n));return n},t.prototype.getPrevNode=function(i){var r=this.liList.indexOf(i),n;do if(r--,n=this.liList[parseInt(r.toString(),10)],g(n))return i;while(!wr(n));return n},t.prototype.getRootNode=function(){var i=0,r;do r=this.liList[parseInt(i.toString(),10)],i++;while(!wr(r));return r},t.prototype.getEndNode=function(){var i=this.liList.length-1,r;do r=this.liList[parseInt(i.toString(),10)],i--;while(!wr(r));return r},t.prototype.setFocus=function(i,r){Z([i],mc),i.setAttribute("tabindex","-1"),r.classList.contains("e-disable")||(X([r],mc),r.setAttribute("tabindex","0"),r.focus(),T.add(r,"blur",this.focusOut,this),this.updateIdAttr(i,r))},t.prototype.updateIdAttr=function(i,r){this.element.removeAttribute("aria-activedescendant"),i&&i.removeAttribute("id"),r.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},t.prototype.focusIn=function(){if(!this.mouseDownStatus){var i=this.getFocusedNode();i.classList.contains("e-disable")?(i.setAttribute("tabindex","-1"),this.navigateNode(!0)):(i.setAttribute("tabindex","0"),X([i],mc),T.add(i,"blur",this.focusOut,this)),this.mouseDownStatus=!1}},t.prototype.focusOut=function(i){var r=this.getFocusedNode();i.target===r&&(Z([r],mc),T.remove(r,"blur",this.focusOut))},t.prototype.onMouseOver=function(i){if(!j.isDevice){var r=i.target,n=r.classList,s=H(r,"."+Tt);if(!s||n.contains(ni)||n.contains(Tt)){this.removeHover();return}else s&&!s.classList.contains("e-disable")&&this.setHover(s)}},t.prototype.setHover=function(i){!i.classList.contains(cy)&&!i.classList.contains(kf)&&(this.removeHover(),X([i],cy))},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.removeHover=function(){var i=ze("."+cy,this.element);i&&i.length&&Z(i,cy)},t.prototype.getNodeData=function(i,r,n){if(!g(i)&&i.classList.contains(Tt)&&!g(H(i,"."+rF))&&H(i,"."+rF).classList.contains(Sa)){var s=i.getAttribute("data-uid"),a=this.getText(i,r,n),l=H(i.parentNode,"."+Tt),h=l?l.getAttribute("data-uid"):null,c=i.classList.contains(Mn),u=!i.classList.contains(kf),d=i.getAttribute("aria-expanded")==="true",p=i.getAttribute("aria-expanded")!==null?!0:(J("."+ri,i)||J("."+ar,i))!=null,f=null,v=J("."+ts,i);return this.showCheckBox&&v&&(f=i.getAttribute("aria-checked")),{id:s,text:a,parentID:h,selected:c,selectable:u,expanded:d,isChecked:f,hasChildren:p}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},t.prototype.getText=function(i,r,n){if(r){var s=g(n)?this.getNodeObject(i.getAttribute("data-uid")):n,a=parseFloat(i.getAttribute("aria-level")),l=this.getFields(this.fields,a,1);return g(n)?V(l.text,s):n.text}return J("."+vc,i).textContent},t.prototype.getExpandEvent=function(i,r){var n=this.getNodeData(i);return{cancel:!1,isInteracted:!g(r),node:i,nodeData:n,event:r}},t.prototype.renderNodeTemplate=function(i,r,n){var s=this.nodeTemplateFn(i,this,"nodeTemplate"+n,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,r,this.root);s&&(s=Array.prototype.slice.call(s),bt(s,r))},t.prototype.destroyTemplate=function(i){this.clearTemplate(["nodeTemplate"+i.getAttribute("data-uid")])},t.prototype.reRenderNodes=function(){this.updateListProp(this.fields),j.isIE?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",g(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},t.prototype.setCssClass=function(i,r){!g(i)&&i!==""&&Z([this.element],i.split(" ")),!g(r)&&r!==""&&X([this.element],r.split(" "))},t.prototype.editingHandler=function(i){var r=i.target;if(!(!r||r.classList.contains(Sa)||r.classList.contains(ni)||r.classList.contains(Tt)||r.classList.contains(nn)||r.classList.contains(dy)||r.classList.contains(nF))){var n=H(r,"."+Tt);this.createTextbox(n)}},t.prototype.createTextbox=function(i){var r=this,n=J("."+py,this.element);n&&n.blur();var s=J("."+vc,i);this.updateOldText(i);var a=this.createElement("input",{className:py,attrs:{value:this.oldText}}),l=this.getEditEvent(i,null,a.outerHTML);this.trigger("nodeEditing",l,function(h){if(!h.cancel){var c=s.offsetWidth+5,u=c+"px";X([i],yI),g(r.nodeTemplateFn)||r.destroyTemplate(i),r.isReact?setTimeout(function(){r.renderTextBox(l,s,u)},5):r.renderTextBox(l,s,u)}})},t.prototype.renderTextBox=function(i,r,n){r.innerHTML=i.innerHtml;var s=J("."+py,r);this.inputObj=Ie.createInput({element:s,properties:{enableRtl:this.enableRtl}},this.createElement),this.inputObj.container.style.width=n,s.focus();var a=s;a.setSelectionRange(0,a.value.length),this.wireInputEvents(s)},t.prototype.updateOldText=function(i){var r=i.getAttribute("data-uid");this.editData=this.getNodeObject(r);var n=parseFloat(i.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,n,1),this.oldText=V(this.editFields.text,this.editData)},t.prototype.inputFocusOut=function(i){if(J("."+py,this.element)){var r=i.target,n=r.value,s=H(r,"."+vc),a=H(r,"."+Tt);se(this.inputObj.container),Ie.destroy({element:r,properties:this.properties}),this.fields.dataSource instanceof oe&&!this.isOffline?this.crudOperation("update",null,a,n,null,null,!0):this.appendNewText(a,s,n,!0),T.remove(r,"blur",this.inputFocusOut),this.inputObj=null,se(r),r=null}},t.prototype.appendNewText=function(i,r,n,s){var a=this,l=this.getEditEvent(i,n,null);this.trigger("nodeEdited",l,function(h){n=h.cancel?h.oldText:h.newText,a.updateText(i,r,n,s),h.oldText!==n&&a.triggerEvent("nodeEdited",[a.getNode(i)])})},t.prototype.updateText=function(i,r,n,s){var a=it(this.editFields.text,n,this.editData);if(g(this.nodeTemplateFn))this.enableHtmlSanitizer?r.innerText=Pt.sanitize(n):r.innerHTML=n;else{r.innerText="";var l=i.getAttribute("data-uid");this.renderNodeTemplate(a,r,l),this.renderReactTemplates()}s&&(Z([i],yI),i.focus(),T.add(i,"blur",this.focusOut,this),X([i],mc)),this.allowTextWrap&&this.calculateWrap(i)},t.prototype.getElement=function(i){return g(i)?null:typeof i=="string"?this.element.querySelector('[data-uid="'+i+'"]'):typeof i=="object"?Lw(i):null},t.prototype.getId=function(i){return g(i)?null:typeof i=="string"?i:typeof i=="object"?Lw(i).getAttribute("data-uid"):null},t.prototype.getEditEvent=function(i,r,n){var s=this.getNodeData(i);return{cancel:!1,newText:r,node:i,nodeData:s,oldText:this.oldText,innerHtml:n}},t.prototype.getNodeObject=function(i){var r;if(g(i))return r;if(this.dataType===1)for(var n=0,s=this.treeData.length;n<s;n++){var a=V(this.fields.id,this.treeData[parseInt(n.toString(),10)]);if(!g(this.treeData[parseInt(n.toString(),10)])&&!g(a)&&a.toString()===i)return this.treeData[parseInt(n.toString(),10)]}else return this.getChildNodeObject(this.treeData,this.fields,i);return r},t.prototype.getChildNodeObject=function(i,r,n){var s;if(g(i))return s;for(var a=0,l=i.length;a<l;a++){var h=V(r.id,i[parseInt(a.toString(),10)]);if(i[parseInt(a.toString(),10)]&&h&&h.toString()===n)return i[parseInt(a.toString(),10)];if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(a.toString(),10)]))){var c=V(r.child,i[parseInt(a.toString(),10)]);if(s=this.getChildNodeObject(c,this.getChildMapper(r),n),s!==void 0)break}else if(this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(a.toString(),10)]))){var u="child";if(s=this.getChildNodeObject(V(u,i[parseInt(a.toString(),10)]),this.getChildMapper(r),n),s!==void 0)break}else if(this.isChildObject()){var d="child",c=V(d,i[parseInt(a.toString(),10)]);if(s=this.getChildNodeObject(c,this.getChildMapper(r),n),s!==void 0)break}}return s},t.prototype.setDragAndDrop=function(i){i&&!this.disabled?this.initializeDrag():this.destroyDrag()},t.prototype.initializeDrag=function(){var i=this,r;this.dragObj=new sh(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+pn,enableTapHold:!0,tapHoldThreshold:100,helper:function(n){i.dragTarget=n.sender.target;var s=H(i.dragTarget,"."+Sa),a=H(i.dragTarget,"."+pn);if(i.dragLi=H(i.dragTarget,"."+Tt),i.fullRowSelect&&!a&&i.dragTarget.classList.contains(Cl)&&(a=i.dragTarget.nextElementSibling),!i.dragTarget||!n.element.isSameNode(s)||!a||i.dragTarget.classList.contains(Sa)||i.dragTarget.classList.contains(ni)||i.dragTarget.classList.contains(Tt)||i.dragLi.classList.contains("e-disable"))return!1;var l=a.cloneNode(!0);if(g(J("div."+nn,l))){var h=i.createElement("div",{className:nn+" "+ri});l.insertBefore(h,l.children[0])}var c=PU+" "+Sa+" "+i.cssClass+" "+(i.enableRtl?sF:"");r=i.createElement("div",{className:c}),r.appendChild(l);var u=i.selectedNodes.length;if(u>1&&i.allowMultiSelection&&i.dragLi.classList.contains(Mn)){var d=i.createElement("span",{className:jU,innerHTML:""+u});r.appendChild(d)}return document.body.appendChild(r),document.body.style.cursor="",i.dragData=i.getNodeData(i.dragLi),r},dragStart:function(n){X([i.element],fy);var s=H(n.target,".e-list-item"),a;s&&(a=parseInt(s.getAttribute("aria-level"),10));var l=i.getDragEvent(n.event,i,null,n.target,null,r,a);l.draggedNode.classList.contains(yI)?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.trigger("nodeDragStart",l,function(h){h.cancel?(i.dragObj.intDestroy(n.event),i.dragCancelAction(r)):i.dragStartAction=!0})},drag:function(n){i.dragObj.setProperties({cursorAt:{top:!g(n.event.targetTouches)||j.isDevice?60:-20}}),i.dragAction(n,r)},dragStop:function(n){if(!n.target){n.helper&&n.helper.parentNode&&se(n.helper),document.body.style.cursor="",Z([i.element],fy),i.dragStartAction=!1;return}Z([i.element],fy),n.target.classList.contains("e-sibling")||i.removeVirtualEle();var s=n.target,a=!1,l=H(s,"."+oF);(!s||!l)&&(se(n.helper),document.body.style.cursor="");var h=H(s,".e-list-item"),c;h&&(c=parseInt(h.getAttribute("aria-level"),10));var u=i.getDragEvent(n.event,i,s,s,null,n.helper,c);u.preventTargetExpand=a,i.trigger("nodeDragStop",u,function(d){i.dragParent=d.draggedParentNode,i.preventExpand=d.preventTargetExpand,d.cancel&&(n.helper.parentNode&&se(n.helper),document.body.style.cursor="",s.classList.contains("e-sibling")&&i.removeVirtualEle()),i.dragStartAction=!1})}}),this.dropObj=new Nw(this.element,{out:function(n){n.target&&!g(n)&&!n.target.classList.contains(Lf)&&i.dropObj.dragData.default&&i.dropObj.dragData.default.helper.classList.contains(Sa)&&(document.body.style.cursor="not-allowed")},over:function(){document.body.style.cursor=""},drop:function(n){i.dropAction(n),i.removeVirtualEle()}})},t.prototype.dragCancelAction=function(i){se(i),Z([this.element],fy),this.dragStartAction=!1},t.prototype.getOffsetX=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientX-r.getBoundingClientRect().left:i.offsetX},t.prototype.getOffsetY=function(i,r){var n=i.changedTouches;return n&&n.length>0?n[0].clientY-r.getBoundingClientRect().top:i.offsetY},t.prototype.dragAction=function(i,r){if(i.target){var n=H(i.target,"."+oF),s=H(i.target,"."+pn),a=J("div."+nn,r);Z([a],[gy,Nf,bI,SI]),this.isDropIn=!1,this.removeVirtualEle(),document.body.style.cursor="";var l=i.target.classList,h=i.event,c=this.getOffsetY(h,i.target),u=this.getOffsetX(h,i.target);if(this.fullRowSelect&&!s&&!g(l)&&l.contains(Cl)&&(s=i.target.nextElementSibling),n){var d=H(i.target,"."+Tt),p=H(i.target,"."+ts),f=H(i.target,"."+ar),v=H(i.target,"."+ri);if(!n.classList.contains(Sa)||s&&!d.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,d))if(this.hasTemplate&&d){var m=J(this.fullRowSelect?"."+Cl:"."+pn,d);if(i&&!v&&!f&&c<7&&!p||v&&c<5||f&&u<3){var y=this.fullRowSelect?1:0;this.appendIndicator(d,a,y)}else if(i&&!v&&!f&&!p&&m&&c>m.offsetHeight-10||v&&c>19||f&&u>19){var y=this.fullRowSelect?2:1;this.appendIndicator(d,a,y)}else X([a],gy),this.isDropIn=!0}else if(d&&i&&!v&&!f&&c<7&&!p||v&&c<5||f&&u<3){var y=this.fullRowSelect?1:0;this.appendIndicator(d,a,y)}else if(d&&i&&!v&&!f&&i.target.offsetHeight>0&&c>i.target.offsetHeight-10&&!p||v&&c>19||f&&u>19){var y=this.fullRowSelect?2:1;this.appendIndicator(d,a,y)}else X([a],gy),this.isDropIn=!0;else i.target.nodeName==="LI"&&!d.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,d)?(X([a],Nf),this.renderVirtualEle(i)):i.target.classList.contains(Lf)?X([a],Nf):X([a],bI)}else X([a],SI),document.body.style.cursor="not-allowed";var b=H(i.target,".e-list-item"),S;b&&(S=parseInt(b.getAttribute("aria-level"),10));var C=this.getDragEvent(i.event,this,i.target,i.target,null,r,S);C.dropIndicator&&Z([a],C.dropIndicator),this.trigger("nodeDragging",C),C.dropIndicator&&X([a],C.dropIndicator)}},t.prototype.appendIndicator=function(i,r,n){X([r],Nf);var s=this.createElement("div",{className:Lf});i.insertBefore(s,i.children[parseInt(n.toString(),10)])},t.prototype.dropAction=function(i){for(var r=i.event,n=this.getOffsetY(r,i.target),s=i.target,a,l,h=!1,c=[],u=[],d=i.dragData.draggable,p=0;p<d.ej2_instances.length;p++)if(d.ej2_instances[parseInt(p.toString(),10)]instanceof e){a=d.ej2_instances[parseInt(p.toString(),10)];break}if(a&&a.dragTarget){var f=a.dragTarget,v=H(f,"."+Tt),m=H(s,"."+Tt);if(u.push(v),m==null&&s.classList.contains(Sa)&&(m=s.firstElementChild),se(i.droppedElement),document.body.style.cursor="",!m||m.isSameNode(v)||this.isDescendant(v,m)){this.fields.dataSource instanceof oe||(this.preventExpand=!1);return}if(a.allowMultiSelection&&v.classList.contains(Mn)){var y=ze("."+Mn,a.element);if(u=y,i.target.offsetHeight<=33&&n>i.target.offsetHeight-10&&n>6)for(var p=y.length-1;p>=0;p--)m.isSameNode(y[parseInt(p.toString(),10)])||this.isDescendant(y[parseInt(p.toString(),10)],m)||this.appendNode(s,y[parseInt(p.toString(),10)],m,i,a,n);else for(var p=0;p<y.length;p++)m.isSameNode(y[parseInt(p.toString(),10)])||this.isDescendant(y[parseInt(p.toString(),10)],m)||this.appendNode(s,y[parseInt(p.toString(),10)],m,i,a,n)}else this.appendNode(s,v,m,i,a,n);l=parseInt(v.getAttribute("aria-level"),10),h=!0}this.fields.dataSource instanceof oe||(this.preventExpand=!1);for(var b=g(a)?null:a.dragData,p=0;p<u.length;p++)c.push(this.getNodeData(this.getElement(u[parseInt(p.toString(),10)]),!0,b));this.trigger("nodeDropped",this.getDragEvent(i.event,a,s,i.target,i.dragData.draggedElement,null,l,h)),a.element.id!==this.element.id&&(a.triggerEvent("nodeDropped",c),this.isNodeDropped=!0,this.fields.dataSource=this.treeData),this.triggerEvent("nodeDropped",c)},t.prototype.appendNode=function(i,r,n,s,a,l){var h=H(i,"."+ts),c=H(s.target,"."+ar),u=H(s.target,"."+ri);!r.classList.contains("e-disable")&&!h&&(u&&s.event.offsetY<5||c&&s.event.offsetX<3||u&&s.event.offsetY>19||c&&s.event.offsetX>19||!u&&!c)?i.nodeName==="LI"?this.dropAsSiblingNode(r,n,s,a):i.firstElementChild&&i.classList.contains(Sa)?i.firstElementChild.nodeName==="UL"&&this.dropAsSiblingNode(r,n,s,a):i.classList.contains("e-icon-collapsible")||i.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(r,n,s,a):this.dropAsChildNode(r,n,a,null,s,l,null,i):this.dropAsChildNode(r,n,a,null,s,l,!0,i),this.showCheckBox&&this.ensureIndeterminate()},t.prototype.dropAsSiblingNode=function(i,r,n,s){var a=H(r,"."+ni),l=H(i,"."+ni),h=H(l,"."+Tt),c;if(n.target.offsetHeight>0&&n.event.offsetY>n.target.offsetHeight-2?c=!1:n.event.offsetY<2?c=!0:(n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible"))&&(n.event.offsetY<5||n.event.offsetX<3?c=!0:(n.event.offsetY>15||n.event.offsetX>17)&&(c=!1)),n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible")){var u=n.target.closest("li");a.insertBefore(i,c?u:u.nextElementSibling)}else a.insertBefore(i,c?n.target:n.target.nextElementSibling);this.moveData(i,r,a,c,s),this.updateElement(l,h),this.updateAriaLevel(i),s.element.id===this.element.id?this.updateList():(s.updateInstance(),this.updateInstance())},t.prototype.dropAsChildNode=function(i,r,n,s,a,l,h,c){var u=H(i,"."+ni),d=H(u,"."+Tt),p=H(r,"."+ni),f;if(a&&a.target&&(f=J(this.fullRowSelect?"."+Cl:"."+pn,r)),a&&(l<7&&!c.classList.contains("e-sibling")||c.classList.contains("e-sibling")&&!r.lastChild.classList.contains("e-sibling"))&&!h)p.insertBefore(i,r),this.moveData(i,r,p,!0,n);else if(a&&a.target.offsetHeight>0&&l>a.target.offsetHeight-10&&!h&&!this.hasTemplate)p.insertBefore(i,r.nextElementSibling),this.moveData(i,r,p,!1,n);else if(this.hasTemplate&&f&&l>f.offsetHeight-10&&!h)p.insertBefore(i,r.nextElementSibling),this.moveData(i,r,p,!1,n);else{var v=this.expandParent(r),m=g(s)?null:v.childNodes[parseInt(s.toString(),10)];v.insertBefore(i,m),this.moveData(i,m,v,!0,n)}this.updateElement(u,d),this.updateAriaLevel(i),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},t.prototype.moveData=function(i,r,n,s,a){var l=H(n,"."+Tt),h=this.getId(i),c=a.updateChildField(a.treeData,a.fields,h,null,null,!0),u=this.getId(r),d=u?this.getDataPos(this.treeData,this.fields,u):null,p=this.getId(l);if(this.dataType===1){this.updateField(this.treeData,this.fields,p,"hasChildren",!0);var f=g(d)?this.treeData.length:s?d:d+1;if(g(p)&&!this.hasPid)delete c[0][this.fields.parentID];else{var v=this.isNumberTypeId?parseFloat(p):p;it(this.fields.parentID,v,c[0])}if(this.treeData.splice(f,0,c[0]),a.element.id!==this.element.id){var m=a.removeChildNodes(h);f++;for(var y=0,b=m.length;y<b;y++)this.treeData.splice(f,0,m[parseInt(y.toString(),10)]),f++;a.groupedData=a.getGroupedData(a.treeData,a.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,p,c,s?d:d+1)},t.prototype.expandParent=function(i){var r=J("div."+ri+", div."+ar,i);r&&r.classList.contains(ri)&&this.preventExpand!==!0&&this.expandAction(i,r,null);var n=J("."+ni,i);if(this.preventExpand===!0&&!n&&r&&this.renderChildNodes(i),n=J("."+ni,i),!g(n)&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(n.style.display="none"),!g(n)&&this.preventExpand===!1&&(n.style.display="block"),g(n)&&this.preventExpand===!0){g(r)&&kt.generateIcon(this.createElement,i,ri,this.listBaseOption);var s=J("div."+ri+", div."+ar,i);s&&s.classList.add("e-icon-expandable"),n=kt.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),s?Z([s],ar):kt.generateIcon(this.createElement,i,ri,this.listBaseOption),i.setAttribute("aria-expanded","false"),n.style.display="none"}if(g(n)){var a=this.expandArgs;(g(a)||a&&a.name!=="nodeExpanding")&&this.trigger("nodeExpanding",this.getExpandEvent(i,null)),g(r)&&kt.generateIcon(this.createElement,i,ar,this.listBaseOption);var s=J("div."+ri+", div."+ar,i);s?Z([s],ri):(kt.generateIcon(this.createElement,i,ar,this.listBaseOption),s=J("div."+nn,i),Z([s],ri)),n=kt.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),this.addExpand(i),this.trigger("nodeExpanded",this.getExpandEvent(i,null))}var l=J("div."+ar,i);return!g(n)&&l&&this.preventExpand&&i.getAttribute("aria-expanded")!=="true"&&(Z([l],ar),i.setAttribute("aria-expanded","false"),X([l],ri)),n},t.prototype.updateElement=function(i,r){if(r&&i.childElementCount===0){var n=J("div."+nn,r);se(i),se(n);var s=this.getId(r);this.updateField(this.treeData,this.fields,s,"hasChildren",!1),this.removeExpand(r,!0)}},t.prototype.updateAriaLevel=function(i){var r=this.parents(i,"."+ni).length;i.setAttribute("aria-level",""+r),this.updateChildAriaLevel(J("."+ni,i),r+1)},t.prototype.updateChildAriaLevel=function(i,r){if(!g(i))for(var n=i.childNodes,s=0,a=n.length;s<a;s++){var l=n[parseInt(s.toString(),10)];l.setAttribute("aria-level",""+r),this.updateChildAriaLevel(J("."+ni,l),r+1)}},t.prototype.renderVirtualEle=function(i){var r,n=i.event,s=this.getOffsetY(n,i.target);s>i.target.offsetHeight-2?r=!1:s<2&&(r=!0);var a=this.createElement("div",{className:Lf}),l=this.fullRowSelect?r?1:2:r?0:1;i.target.insertBefore(a,i.target.children[parseInt(l.toString(),10)])},t.prototype.removeVirtualEle=function(){var i=J("."+Lf);i&&se(i)},t.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},t.prototype.getDragEvent=function(i,r,n,s,a,l,h,c){var u=n?H(n,"."+Tt):null,d=u?this.getNodeData(u):null,p=r?r.dragLi:a,f=r?r.dragData:null,v=n?this.parents(n,"."+Tt):null,m=r.dragLi.parentElement,y=r.dragLi?H(m,"."+Tt):null,b=null,S=null,C=[Nf,gy,bI,SI],x=null,I=c===!0?p:u,D=I?H(I,".e-list-parent"):null,M=0,E=null;if(y=r.dragLi&&y===null?H(m,"."+Sa):y,y=c===!0?this.dragParent:y,l)for(;M<4;){if(J("."+nn,l).classList.contains(C[parseInt(M.toString(),10)])){x=C[parseInt(M.toString(),10)];break}M++}if(D){var A=0;for(M=0;M<D.childElementCount;M++)if(A=c!==!0&&D.children[parseInt(M.toString(),10)]===p&&u!==p?++A:A,c!==!0&&D.children[parseInt(M.toString(),10)].classList.contains("e-hover")){S=i.offsetY>=23?M+1:M;break}else if(D.children[parseInt(M.toString(),10)]===I){S=(i.offsetY>=23,M);break}S=A!==0?--S:S,E=this.isDropIn?"Inside":i.offsetY<7?"Before":"After"}if(n&&(v.length===0?b=null:n.classList.contains(Tt)?b=v[0]:b=v[1]),u===p&&(b=u),n&&s.offsetHeight<=33&&i.offsetY<s.offsetHeight-10&&i.offsetY>6&&(b=u,c!==!0)){h=++h;var L=b?J(".e-list-parent",b):null;if(S=L?L.children.length:0,!(this.fields.dataSource instanceof oe)&&L===null&&b){var N=b.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,b.getAttribute("data-uid").toString()):null;S=N?N.length:0}}return{cancel:!1,clonedNode:l,event:i,draggedNode:p,draggedNodeData:f,droppedNode:u,droppedNodeData:d,dropIndex:S,dropLevel:h,draggedParentNode:y,dropTarget:b,dropIndicator:x,target:s,position:E}},t.prototype.addFullRow=function(i){var r=this.liList.length;if(i)for(var n=0;n<r;n++)this.createFullRow(this.liList[parseInt(n.toString(),10)]);else for(var n=0;n<r;n++){var s=J("."+Cl,this.liList[parseInt(n.toString(),10)]);se(s)}},t.prototype.createFullRow=function(i){var r=this.createElement("div",{className:Cl});i.insertBefore(r,i.childNodes[0])},t.prototype.addMultiSelect=function(i){if(i)for(var r=ze("."+Tt+':not([aria-selected="true"])',this.element),n=0,s=r;n<s.length;n++){var a=s[n];a.setAttribute("aria-selected","false")}else for(var r=ze("."+Tt+'[aria-selected="false"]',this.element),l=0,h=r;l<h.length;l++){var a=h[l];a.removeAttribute("aria-selected")}},t.prototype.collapseByLevel=function(i,r,n,s){if(s=g(s)?1:s,r>0&&!g(i))for(var a=this.getVisibleNodes(n,i.childNodes),l=0,h=a.length;l<h;l++){var c=a[parseInt(l.toString(),10)],u=J("."+ar,J("."+pn,c));s>=r&&!g(u)&&this.collapseNode(c,u,null),this.collapseByLevel(J("."+ni,c),r,n,s+1)}},t.prototype.collapseAllNodes=function(i){for(var r=this.getVisibleNodes(i,ze("."+ar,this.element)),n=0,s=r.length;n<s;n++){var a=r[parseInt(n.toString(),10)],l=H(a,"."+Tt);this.collapseNode(l,a,null)}},t.prototype.expandByLevel=function(i,r,n){if(r>0&&!g(i))for(var s=this.getVisibleNodes(n,i.childNodes),a=0,l=s.length;a<l;a++){var h=s[parseInt(a.toString(),10)],c=J("."+ri,J("."+pn,h));g(c)||this.expandAction(h,c,null),this.expandByLevel(J("."+ni,h),r-1,n)}},t.prototype.expandAllNodes=function(i){for(var r=this.getVisibleNodes(i,ze("."+ri,this.element)),n=0,s=r;n<s.length;n++){var a=s[n],l=H(a,"."+Tt);this.expandAction(l,a,null,!0,null,!0)}},t.prototype.getVisibleNodes=function(i,r){var n=Array.prototype.slice.call(r);if(i)for(var s=0;s<n.length;s++)wr(n[parseInt(s.toString(),10)])||(n.splice(s,1),s--);return n},t.prototype.removeNode=function(i){var r=H(i,"."+ni),n=H(r,"."+Tt);g(this.nodeTemplateFn)||this.destroyTemplate(i),se(i),this.updateElement(r,n),this.removeData(i)},t.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes()},t.prototype.updateList=function(){this.liList=Array.prototype.slice.call(ze("."+Tt,this.element))},t.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var i=ze("."+Mn,this.element);this.selectGivenNodes(i)},t.prototype.updateExpandedNodes=function(){this.setProperties({expandedNodes:[]},!0);for(var i=ze('[aria-expanded="true"]',this.element),r=0,n=i.length;r<n;r++)this.addExpand(i[parseInt(r.toString(),10)])},t.prototype.removeData=function(i){if(this.dataType===1){var r=new oe(this.treeData),n=this.getId(i),s={},a=this.isNumberTypeId?parseFloat(n):n;s[this.fields.id]=a,r.remove(this.fields.id,s),this.removeChildNodes(n)}else{var n=this.getId(i);this.updateChildField(this.treeData,this.fields,n,null,null,!0)}},t.prototype.removeChildNodes=function(i){for(var r=this.getChildGroup(this.groupedData,i,!1),n=[],s=0,a=r.length;s<a;s++){var l=new oe(this.treeData),h=V(this.fields.id,r[parseInt(s.toString(),10)]).toString(),c={},u=this.isNumberTypeId?parseFloat(h):h;c[this.fields.id]=u;var d=l.remove(this.fields.id,c);n.push(d[0]),this.removeChildNodes(h)}return n},t.prototype.doGivenAction=function(i,r,n){for(var s=0,a=i.length;s<a;s++){var l=this.getElement(i[parseInt(s.toString(),10)]);if(!g(l)){var h=J("."+r,J("."+pn,l));g(h)||(n?this.expandAction(l,h,null):this.collapseNode(l,h,null))}}},t.prototype.addGivenNodes=function(i,r,n,s,a){if(i.length!==0){var l=this.getSortedData(i),h=r?parseFloat(r.getAttribute("aria-level"))+1:1;s&&this.updateMapper(h);var c=kt.createListItemFromJson(this.createElement,l,this.listBaseOption,h),u=this.getId(r),d;g(r)||(d=J("div."+nn,r)),this.dataType===1&&d&&d.classList.contains(ri)&&this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")&&(this.preventExpand=!0),this.dataType!==1&&(this.addChildData(this.treeData,this.fields,u,i,n),this.isFirstRender=!1);var p;a?p=a:p=r?this.expandParent(r):J("."+ni,this.element);var f=g(n)?null:p.childNodes[parseInt(n.toString(),10)];if(!this.isFirstRender||this.dataType===1){var v=this.expandArgs;if(f||this.sortOrder==="None"){for(var m=0;m<c.length;m++)p.insertBefore(c[parseInt(m.toString(),10)],f);if(this.dataType===1&&!g(r)&&!this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var y=J("div."+nn,r);y&&y.classList.contains(ri)&&(g(v)||v.name!=="nodeExpanding")&&this.expandAction(r,y,null)}}if(!f&&(this.sortOrder==="Ascending"||this.sortOrder==="Descending"))if(p.childNodes.length===0){for(var m=0;m<c.length;m++)p.insertBefore(c[parseInt(m.toString(),10)],f);if(this.dataType===1&&!g(r)&&!this.preventExpand&&!g(this.element.offsetParent)&&!this.element.offsetParent.parentElement.classList.contains("e-filemanager")){this.preventExpand=!1;var y=J("div."+nn,r);y&&y.classList.contains(ri)&&(g(v)||v.name!=="nodeExpanding")&&this.expandAction(r,y,null)}}else for(var b=p.childNodes,m=0;m<c.length;m++)for(var S=0;S<b.length;S++){var C=this.sortOrder==="Ascending"?b[parseInt(S.toString(),10)].textContent.toUpperCase()>c[parseInt(m.toString(),10)].innerText.toUpperCase():b[parseInt(S.toString(),10)].textContent.toUpperCase()<c[parseInt(m.toString(),10)].innerText.toUpperCase();if(C){p.insertBefore(c[parseInt(m.toString(),10)],b[parseInt(S.toString(),10)]);break}p.insertBefore(c[parseInt(m.toString(),10)],b[b.length])}}if(this.dataType===1){this.updateField(this.treeData,this.fields,u,"hasChildren",!0);for(var x=this.getId(f),I=g(x)?this.treeData.length:this.getDataPos(this.treeData,this.fields,x),S=0;S<i.length;S++){if(!g(u)){var D=this.isNumberTypeId?parseFloat(u):u;it(this.fields.parentID,D,i[parseInt(S.toString(),10)])}this.treeData.splice(I,0,i[parseInt(S.toString(),10)]),I++}}this.finalizeNode(p)}},t.prototype.updateMapper=function(i){var r=i===1?this.fields:this.getChildFields(this.fields,i-1,1);this.updateListProp(r)},t.prototype.updateListProp=function(i){var r=this.getActualProperties(i);this.listBaseOption.fields=r,this.listBaseOption.fields.url=Object.prototype.hasOwnProperty.call(r,"navigateUrl")?r.navigateUrl:"navigateUrl"},t.prototype.getDataPos=function(i,r,n){for(var s=null,a=0,l=i.length;a<l;a++){var h=V(r.id,i[parseInt(a.toString(),10)]);if(i[parseInt(a.toString(),10)]&&h&&h.toString()===n)return a;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(a.toString(),10)]))){var c=V(r.child,i[parseInt(a.toString(),10)]);if(s=this.getDataPos(c,this.getChildMapper(r),n),s!==null)break}else if(this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(a.toString(),10)]))){var u=V("child",i[parseInt(a.toString(),10)]);if(s=this.getDataPos(u,this.getChildMapper(r),n),s!==null)break}}return s},t.prototype.addChildData=function(i,r,n,s,a){var l;if(g(n)){a=g(a)?i.length:a;for(var h=0,c=s.length;h<c;h++)i.splice(a,0,s[parseInt(h.toString(),10)]),a++;return l}for(var u=0,d=i.length;u<d;u++){var p=V(r.id,i[parseInt(u.toString(),10)]);if(i[parseInt(u.toString(),10)]&&p&&p.toString()===n){if(typeof r.child=="string"&&Object.prototype.hasOwnProperty.call(i[parseInt(u.toString(),10)],r.child)&&i[parseInt(u.toString(),10)][r.child]!==null||this.fields.dataSource instanceof oe&&Object.prototype.hasOwnProperty.call(i[parseInt(u.toString(),10)],"child")){var f=typeof r.child=="string"?r.child:"child",v=V(f,i[parseInt(u.toString(),10)]);g(v)&&(v=[]),a=g(a)?v.length:a;for(var h=0,c=s.length;h<c;h++)v.splice(a,0,s[parseInt(h.toString(),10)]),a++}else{var f=typeof r.child=="string"?r.child:"child";i[parseInt(u.toString(),10)][""+f]=s}return!0}else if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(u.toString(),10)]))){var m=V(r.child,i[parseInt(u.toString(),10)]);if(l=this.addChildData(m,this.getChildMapper(r),n,s,a),l!==void 0)break}else if(this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(u.toString(),10)]))){var v=V("child",i[parseInt(u.toString(),10)]);if(l=this.addChildData(v,this.getChildMapper(r),n,s,a),l!==void 0)break}}return l},t.prototype.doDisableAction=function(i){var r=this.nodeType(i),n=this.checkValidId(r);this.validArr=[];for(var s=0,a=n.length;s<a;s++){var l=n[parseInt(s.toString(),10)][this.fields.id].toString();l&&this.disableNode.indexOf(l)===-1&&this.disableNode.push(l);var h=this.getElement(l);h&&(h.setAttribute("aria-disabled","true"),X([h],ed))}},t.prototype.doEnableAction=function(i){for(var r=this.nodeType(i),n=0,s=r.length;n<s;n++){var a=this.getElement(r[parseInt(n.toString(),10)]),l=r[parseInt(n.toString(),10)];l&&this.disableNode.indexOf(l)!==-1&&this.disableNode.splice(this.disableNode.indexOf(l),1),a&&(a.removeAttribute("aria-disabled"),Z([a],ed))}},t.prototype.nodeType=function(i){for(var r=[],n=0,s=i.length;n<s;n++){var a=void 0;typeof i[parseInt(n.toString(),10)]=="string"?a=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].toString():null:typeof i[parseInt(n.toString(),10)]=="object"&&(a=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)].getAttribute("data-uid").toString():null),r.indexOf(a)===-1&&r.push(a)}return r},t.prototype.checkValidId=function(i){var r=this;if(this.dataType===1)this.validArr=this.treeData.filter(function(l){return i.indexOf(l[r.fields.id]?l[r.fields.id].toString():null)!==-1});else if(this.dataType===2)for(var n=0;n<this.treeData.length;n++){var s=this.treeData[parseInt(n.toString(),10)][this.fields.id]?this.treeData[parseInt(n.toString(),10)][this.fields.id].toString():null;i.indexOf(s)!==-1&&this.validArr.push(this.treeData[parseInt(n.toString(),10)]);var a=V(this.fields.child.toString(),this.treeData[parseInt(n.toString(),10)]);a&&this.filterNestedChild(a,i)}return this.validArr},t.prototype.filterNestedChild=function(i,r){for(var n=0;n<i.length;n++){var s=i[parseInt(n.toString(),10)][this.fields.id]?i[parseInt(n.toString(),10)][this.fields.id].toString():null;r.indexOf(s)!==-1&&this.validArr.push(i[parseInt(n.toString(),10)]);var a=V(this.fields.child.toString(),i[parseInt(n.toString(),10)]);a&&this.filterNestedChild(a,r)}},t.prototype.setTouchClass=function(){var i=H(this.element,"."+_U);this.touchClass=g(i)?"":UU},t.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var i=this.selectedNodes,r=0,n=i.length;r<n;r++)this.updateField(this.treeData,this.fields,i[parseInt(r.toString(),10)],"selected",!0);for(var s=this.expandedNodes,a=0,l=s.length;a<l;a++)this.updateField(this.treeData,this.fields,s[parseInt(a.toString(),10)],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);for(var h=this.checkedNodes,c=0,l=h.length;c<l;c++)this.updateField(this.treeData,this.fields,h[parseInt(c.toString(),10)],"isChecked",!0)}},t.prototype.removeField=function(i,r,n){if(!(g(i)||g(r)))for(var s=0,a=i.length;s<a;s++){for(var l=0;l<n.length;l++){var h=this.getMapperProp(r,n[parseInt(l.toString(),10)]);g(i[parseInt(s.toString(),10)][""+h])||delete i[parseInt(s.toString(),10)][""+h]}typeof r.child=="string"&&!g(V(r.child,i[parseInt(s.toString(),10)]))?this.removeField(V(r.child,i[parseInt(s.toString(),10)]),this.getChildMapper(r),n):this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(s.toString(),10)]))&&this.removeField(V("child",i[parseInt(s.toString(),10)]),this.getChildMapper(r),n)}},t.prototype.getMapperProp=function(i,r){switch(r){case"selected":return g(i.selected)?"selected":i.selected;case"expanded":return g(i.expanded)?"expanded":i.expanded;case"isChecked":return g(i.isChecked)?"isChecked":i.isChecked;case"hasChildren":return g(i.hasChildren)?"hasChildren":i.hasChildren;default:return r}},t.prototype.updateField=function(i,r,n,s,a){if(!g(n))if(this.dataType===1){var l=this.isNumberTypeId?parseFloat(n):n,h=new oe(this.treeData).executeLocal(new Pe().where(r.id,"equal",l,!1));it(this.getMapperProp(r,s),a,h[0])}else this.updateChildField(i,r,n,s,a)},t.prototype.updateChildField=function(i,r,n,s,a,l){var h;if(g(i))return h;for(var c=0,u=i.length;c<u;c++){var d=V(r.id,i[parseInt(c.toString(),10)]);if(i[parseInt(c.toString(),10)]&&!g(d)&&d.toString()===n)return l?h=i.splice(c,1):(it(this.getMapperProp(r,s),a,i[parseInt(c.toString(),10)]),h=[]),h;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(c.toString(),10)]))){var p=V(r.child,i[parseInt(c.toString(),10)]);if(h=this.updateChildField(p,this.getChildMapper(r),n,s,a,l),h!==void 0)break}else if(this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(c.toString(),10)]))){var f=V("child",i[parseInt(c.toString(),10)]);if(h=this.updateChildField(f,this.getChildMapper(r),n,s,a,l),h!==void 0)break}}return h},t.prototype.triggerEvent=function(i,r){if(this.renderReactTemplates(),i==="addNodes"){for(var n=[],s=0;s<r.length;s++)n.push(this.getNode(this.getElement(g(r[parseInt(s.toString(),10)][this.fields.id])?V(this.fields.id,r[parseInt(s.toString(),10)]).toString():null)));r=n}var a={data:this.treeData,action:i,nodeData:r};this.trigger("dataSourceChanged",a)},t.prototype.wireInputEvents=function(i){T.add(i,"blur",this.inputFocusOut,this)},t.prototype.wireEditingEvents=function(i){var r=this;i&&!this.disabled?this.touchEditObj=new jr(this.element,{tap:function(n){r.isDoubleTapped(n)&&n.tapCount===2&&(n.originalEvent.preventDefault(),r.editingHandler(n.originalEvent))}}):this.touchEditObj&&this.touchEditObj.destroy()},t.prototype.wireClickEvent=function(i){var r=this;i?this.touchClickObj=new jr(this.element,{tap:function(n){r.clickHandler(n)}}):this.touchClickObj&&this.touchClickObj.destroy()},t.prototype.wireExpandOnEvent=function(i){var r=this;i?this.touchExpandObj=new jr(this.element,{tap:function(n){(r.expandOnType==="Click"||r.expandOnType==="DblClick"&&r.isDoubleTapped(n)&&n.tapCount===2)&&n.originalEvent.which!==3&&r.expandHandler(n)}}):this.touchExpandObj&&this.touchExpandObj.destroy()},t.prototype.mouseDownHandler=function(i){this.mouseDownStatus=!0,(i.shiftKey||i.ctrlKey)&&i.preventDefault(),i.ctrlKey&&this.allowMultiSelection&&T.add(this.element,"contextmenu",this.preventContextMenu,this)},t.prototype.preventContextMenu=function(i){i.preventDefault()},t.prototype.wireEvents=function(){T.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.expandOnType!=="None"&&this.wireExpandOnEvent(!0),T.add(this.element,"mouseover",this.onMouseOver,this),T.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new rr(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.unWireEvents=function(){T.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),T.remove(this.element,"mouseover",this.onMouseOver),T.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},t.prototype.parents=function(i,r){for(var n=[],s=i.parentNode;!g(s);)Fu(s,r)&&n.push(s),s=s.parentNode;return n},t.prototype.isDoubleTapped=function(i){var r=i.originalEvent.target,n;return r&&i.tapCount&&(i.tapCount===1?this.firstTap=H(r,"."+Tt):i.tapCount===2&&(n=H(r,"."+Tt))),this.firstTap===n},t.prototype.isDescendant=function(i,r){for(var n=r.parentNode;!g(n);){if(n===i)return!0;n=n.parentNode}return!1},t.prototype.showSpinner=function(i){X([i],uy),Qs({target:i,width:j.isDevice?16:14},this.createElement),vs(i)},t.prototype.hideSpinner=function(i){Xs(i),i.innerHTML="",Z([i],uy)},t.prototype.setCheckedNodes=function(i){i=JSON.parse(JSON.stringify(i)),i.length>1&&typeof this.nodeChecked=="function"&&this.nodeChecked.length>0&&(this.isFilter=!0),this.uncheckAll(this.checkedNodes),this.setIndeterminate(i),i.length>0&&this.checkAll(i)},t.prototype.setValidCheckedNode=function(i,r){if(r===void 0&&(r=[]),this.dataType===1){var n=this.fields,s=new oe(this.treeData).executeLocal(new Pe().where(n.id,"equal",i,!0));if(s[0]&&(this.setChildCheckState(s,i,s[0],r),this.autoCheck)){for(var a=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,l=this.getChildNodes(this.treeData,a),h=0,c=0;c<l.length;c++){var u=l[parseInt(c.toString(),10)][this.fields.id].toString();this.checkedNodes.indexOf(u)!==-1&&h++}h===l.length&&this.checkedNodes.indexOf(a)===-1&&a&&this.checkDisabledState(a)}}else if(this.dataType===2)for(var d=0;d<this.treeData.length;d++){var p=this.treeData[parseInt(d.toString(),10)][this.fields.id]?this.treeData[parseInt(d.toString(),10)][this.fields.id].toString():"";if(p===i&&this.checkedNodes.indexOf(i)===-1){this.checkDisabledState(i);break}var f=V(this.fields.child.toString(),this.treeData[parseInt(d.toString(),10)]);f&&this.setChildCheckState(f,i,this.treeData[parseInt(d.toString(),10)],r)}},t.prototype.setChildCheckState=function(i,r,n,s){s===void 0&&(s=[]);var a,l=0;if(this.dataType===1){n&&(a=n[this.fields.id]?n[this.fields.id].toString():null);for(var h=0;h<i.length;h++){var c=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():null;n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(c)===-1&&this.checkDisabledState(c,i[h]),c===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var u=this.getChildNodes(this.treeData,c),d=s.length===1&&s[0]===c;(u.length===r.length||d)&&this.setChildCheckState(u,r,n)}}else{n&&(a=n[this.fields.id]?n[this.fields.id].toString():"");for(var h=0;h<i.length;h++){var p=i[parseInt(h.toString(),10)][this.fields.id]?i[parseInt(h.toString(),10)][this.fields.id].toString():"",d=[r].length===1&&s.length===0;n&&a&&this.autoCheck&&this.checkedNodes.indexOf(a)!==-1&&this.checkedNodes.indexOf(p)===-1&&(p===r||d)&&this.checkDisabledState(p,i[h]),p===r&&this.checkedNodes.indexOf(r)===-1&&this.checkDisabledState(r);var u=V(this.fields.child.toString(),i[parseInt(h.toString(),10)]);u&&this.setChildCheckState(u,r,i[parseInt(h.toString(),10)]),this.checkedNodes.indexOf(p)!==-1&&this.autoCheck&&l++,l===i.length&&this.checkedNodes.indexOf(a)===-1&&this.autoCheck&&this.checkDisabledState(a,n)}}},t.prototype.setIndeterminate=function(i){for(var r=0;r<i.length;r++)this.setValidCheckedNode(i[parseInt(r.toString(),10)],i)},t.prototype.updatePosition=function(i,r,n,s){if(this.dataType===1){var a=this.getDataPos(this.treeData,this.fields,i);if(this.treeData.splice(a,1,r),n){this.removeChildNodes(i);for(var l=0;l<s.length;l++)this.treeData.splice(a,0,s[parseInt(l.toString(),10)]),a++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,i,[r],void 0)},t.prototype.updateChildPosition=function(i,r,n,s,a){for(var l,h=0,c=i.length;h<c;h++){var u=V(r.id,i[parseInt(h.toString(),10)]);if(i[parseInt(h.toString(),10)]&&u&&u.toString()===n)return i[parseInt(h.toString(),10)]=s[0],!0;if(typeof r.child=="string"&&!g(V(r.child,i[parseInt(h.toString(),10)]))){var d=V(r.child,i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(d,this.getChildMapper(r),n,s,a),l!==void 0)break}else if(this.fields.dataSource instanceof oe&&!g(V("child",i[parseInt(h.toString(),10)]))){var p=V("child",i[parseInt(h.toString(),10)]);if(l=this.updateChildPosition(p,this.getChildMapper(r),n,s,a),l!==void 0)break}}return l},t.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},t.prototype.crudOperation=function(i,r,n,s,a,l,h){var c=this,u=this.fields.dataSource,d=[],p=this.getQuery(this.fields),f=this.fields.id,v,m={addedRecords:[],deletedRecords:[],changedRecords:[]},y=[];r?y=this.nodeType(r):n&&(typeof n=="string"?y[0]=n.toString():typeof n=="object"&&(y[0]=n.getAttribute("data-uid").toString()));for(var b=0,S=y.length;b<S;b++){var C=this.getElement(y[parseInt(b.toString(),10)]);if(!g(C)){var x=this.getNodeObject(y[parseInt(b.toString(),10)]);d.push(x)}}switch(i){case"delete":r.length===1?v=u.remove(f,d[0],p.fromTable,p):(m.deletedRecords=d,v=u.saveChanges(m,f,p.fromTable,p)),v.then(function(){return c.deleteSuccess(y)}).catch(function(D){return c.dmFailure(D)});break;case"update":d[0][this.fields.text]=s,v=u.update(f,d[0],p.fromTable,p),v.then(function(){return c.editSucess(n,s,h)}).catch(function(D){return c.dmFailure(D,n,h)});break;case"insert":if(a.length===1)v=u.insert(a[0],p.fromTable,p);else{for(var I=[],b=0,S=a.length;b<S;b++)I.push(a[parseInt(b.toString(),10)]);m.addedRecords=I,v=u.saveChanges(m,f,p.fromTable,p)}v.then(function(){var D=c.getElement(n);c.addSuccess(a,D,l),c.preventExpand=!1}).catch(function(D){return c.dmFailure(D)});break}},t.prototype.deleteSuccess=function(i){for(var r=[],n=0,s=i.length;n<s;n++){var a=this.getElement(i[parseInt(n.toString(),10)]);r.push(this.getNode(a)),!g(a)&&this.removeNode(a)}this.updateInstance(),this.dataType===1&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent("removeNode",r)},t.prototype.editSucess=function(i,r,n){var s=this.getElement(i),a=J("."+vc,s);this.appendNewText(s,a,r,n)},t.prototype.addSuccess=function(i,r,n){var s=this,a,l=r?r.querySelector("."+nn):null;r&&l&&l.classList.contains(ri)&&r.querySelector("."+ni)===null?this.renderChildNodes(r,null,function(){a=r.querySelector("."+ni),s.addGivenNodes(i,r,n,!0,a),s.triggerEvent("addNodes",i)}):(this.addGivenNodes(i,r,n,!0),this.triggerEvent("addNodes",i))},t.prototype.dmFailure=function(i,r,n){r&&this.updatePreviousText(r,n),this.trigger("actionFailure",{error:i})},t.prototype.updatePreviousText=function(i,r){var n=this.getElement(i),s=J("."+vc,n);this.updateText(n,s,this.oldText,r)},t.prototype.getHierarchicalParentId=function(i,r,n){var s=this,a=r.findIndex(function(c){return c[s.fields.id]&&c[s.fields.id].toString()===i});if(a===-1)for(var l=0;l<r.length;l++){var h=V(this.fields.child.toString(),r[parseInt(l.toString(),10)]);if(!g(h))if(a=h.findIndex(function(c){return c[s.fields.id]&&c[s.fields.id].toString()===i}),a===-1)this.getHierarchicalParentId(i,h,n);else{n.push(r[parseInt(l.toString(),10)][this.fields.id].toString()),this.getHierarchicalParentId(r[parseInt(l.toString(),10)][this.fields.id].toString(),this.treeData,n);break}}return n},t.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var l=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(l,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"allowTextWrap":this.setTextWrap(),this.updateWrap();break;case"checkedNodes":JSON.stringify(r.checkedNodes)!==JSON.stringify(i.checkedNodes)&&this.showCheckBox&&(this.checkedNodes=r.checkedNodes,this.setCheckedNodes(i.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=i.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(r.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.setProperties({expandedNodes:g(i.expandedNodes)?[]:i.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.expandOnType!=="None"&&!this.disabled&&this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,(!this.isReact||this.isReact&&!(this.fields.dataSource instanceof oe))&&(this.element.classList.contains("e-filtering")||(this.DDTTreeData=JSON.parse(JSON.stringify(this.fields.dataSource))),this.reRenderNodes()),this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect),this.allowTextWrap&&(this.setTextWrap(),this.updateWrap());break;case"loadOnDemand":if(this.loadOnDemand===!1&&!this.onLoaded){for(var h=this.element.querySelectorAll("li"),c=0;c<h.length;)h[parseInt(c.toString(),10)].getAttribute("aria-expanded")!=="true"&&this.renderChildNodes(h[parseInt(c.toString(),10)],!0,null,!0),c++;this.onLoaded=!0}break;case"nodeTemplate":this.hasTemplate=!1,this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:i.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"checkDisabledChildren":this.reRenderNodes();break;case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:i.fullRowNavigable},!0),this.listBaseOption.itemNavigable=i.fullRowNavigable,this.reRenderNodes();break}}},t.prototype.destroy=function(){this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),this.ulElement=null,this.liList=null,this.startNode=null,this.firstTap=null,this.expandArgs=null,this.dragLi=null,this.dragTarget=null,this.dragParent=null,this.dragObj=null,this.dropObj=null,this.inputObj=null,this.touchEditObj=null,this.touchExpandObj=null,this.touchClickObj=null,o.prototype.destroy.call(this)},t.prototype.addNodes=function(i,r,n,s){if(!g(i)){i=JSON.parse(JSON.stringify(i));var a=this.getElement(r);if(this.preventExpand=s,this.fields.dataSource instanceof oe)this.isOffline?this.addSuccess(i,a,n):this.crudOperation("insert",null,r,null,i,n,this.preventExpand);else if(this.dataType===2)this.addGivenNodes(i,a,n);else{if(a)this.addGivenNodes(i,a,n);else{i=this.getSortedData(i);for(var l=0;l<i.length;l++){var h=V(this.fields.parentID,i[parseInt(l.toString(),10)]);a=h&&this.getElement(h.toString()),!g(h)&&g(a)&&(this.isHiddenItem=!0,this.preventExpand=!1,this.ensureVisible(h),this.preventExpand=s,this.isHiddenItem=!1,a=this.getElement(h.toString())),this.addGivenNodes([i[parseInt(l.toString(),10)]],a,n)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}var c=J("."+Tt+'[tabindex="0"]',this.element);g(c)&&this.setNodeFocusable(),this.updateCheckedStateFromDS(),this.showCheckBox&&a&&this.autoCheck&&this.ensureParentCheckState(a),this.fields.dataSource instanceof oe||(this.preventExpand=!1,this.triggerEvent("addNodes",i))}},t.prototype.beginEdit=function(i){var r=this.getElement(i);g(r)||this.disabled||this.createTextbox(r)},t.prototype.checkAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!0)},t.prototype.collapseAll=function(i,r,n){g(i)?r>0?this.collapseByLevel(J("."+ni,this.element),r,n):this.collapseAllNodes(n):this.doGivenAction(i,ar,!1)},t.prototype.disableNodes=function(i){g(i)||this.doDisableAction(i)},t.prototype.enableNodes=function(i){g(i)||this.doEnableAction(i)},t.prototype.ensureVisible=function(i){var r=[];if(this.dataType===1)for(var n=this.getTreeData(i);n.length!==0&&!g(n[0][this.fields.parentID]);)r.push(n[0][this.fields.parentID].toString()),n=this.getTreeData(n[0][this.fields.parentID].toString());else this.dataType===2&&(r=this.getHierarchicalParentId(i,this.treeData,r));this.expandAll(r.reverse(),null,null,this.isHiddenItem);var s=this.getElement(i);if(!g(s)){if(typeof i=="object"){var a=this.parents(s,"."+Tt);this.expandAll(a)}setTimeout(function(){s.scrollIntoView({behavior:"smooth"})},450)}},t.prototype.expandAll=function(i,r,n,s){this.isAnimate=!s,g(i)?r>0?this.expandByLevel(J("."+ni,this.element),r,n):(this.expandAllNodes(n),(!this.loadOnDemand||this.element.classList.contains("e-filtering"))&&(this.updateAttributes(this.element),this.updateList())):this.doGivenAction(i,ri,!0),this.isAnimate=!0},t.prototype.getAllCheckedNodes=function(){var i=this.checkedNodes;return i},t.prototype.getDisabledNodes=function(){var i=this.disableNode;return i},t.prototype.getNode=function(i){var r=this.getElement(i);return this.getNodeData(r,!0)},t.prototype.getTreeData=function(i){var r=this.getId(i);if(this.updatePersistProp(),g(r))return this.treeData;var n=this.getNodeObject(r);return g(n)?[]:[n]},t.prototype.moveNodes=function(i,r,n,s){if(!(g(i)||i.length===0)){var a=this.getElement(r),l=[];g(a)&&(this.isHiddenItem=!0,this.ensureVisible(r),this.isHiddenItem=!1,a=this.getElement(r));for(var h=0;h<i.length;h++){var c=this.getElement(i[parseInt(h.toString(),10)]);l.push(this.getNode(c)),!(g(c)||a.isSameNode(c)||this.isDescendant(c,a))&&(this.preventExpand=s,this.dropAsChildNode(c,a,this,n,null,null,null,a))}this.fields.dataSource instanceof oe||(this.preventExpand=!1),this.triggerEvent("moveNodes",l)}},t.prototype.refreshNode=function(i,r){if(!(g(i)||g(r))){var n=!1;if(this.dataType===1&&r.length>1)n=!0;else if(this.dataType===2&&r.length===1){var s=V(this.fields.child.toString(),r[0]);g(s)||(n=!0)}var a=this.getElement(i),l=a?a.getAttribute("data-uid"):i?i.toString():null;this.refreshData=this.getNodeObject(l),r=JSON.parse(JSON.stringify(r));var h,c;if(this.dataType===1&&n){for(var u=0;u<r.length;u++)if(g(r[parseInt(u.toString(),10)][this.fields.parentID])){c=r[parseInt(u.toString(),10)],r.splice(u,1);break}h=pe({},this.refreshData,c)}else h=pe({},this.refreshData,r[0]);if(g(a)){this.updatePosition(l,h,n,r);return}this.isRefreshed=!0;var d=parseFloat(a.getAttribute("aria-level")),p=kt.createListItemFromJson(this.createElement,[h],this.listBaseOption,d),f=J("."+ni,a),v=V(this.fields.child.toString(),h);if(n&&f||n&&!g(v)){var m=a.parentElement,y=Array.prototype.indexOf.call(m.childNodes,a);Qe(a),m.insertBefore(p[0],m.childNodes[parseInt(y.toString(),10)]),this.updatePosition(l,h,n,r),n&&f&&this.expandAll([l])}else{var b=J("."+pn,a),S=J("."+pn,p[0]),C=J("div."+nn,b),x=J("div."+nn,S);C&&x&&(x.classList.contains(ri)&&C.classList.contains(ar)?(Z([x],ri),X([x],ar)):x.classList.contains(ar)&&C.classList.contains(ri)?(Z([x],ar),X([x],ri)):C.classList.contains("interaction")&&X([x],"interaction")),Qe(b);var I=J("."+Cl,a);I.parentNode.insertBefore(S,I.nextSibling),this.updatePosition(l,h,n,r)}if(a=this.getElement(i),h[this.fields.tooltip]&&a.setAttribute("title",h[this.fields.tooltip]),Object.prototype.hasOwnProperty.call(h,this.fields.htmlAttributes)&&h[this.fields.htmlAttributes]){var D={};mt(D,h[this.fields.htmlAttributes]),D.class?(X([a],D.class.split(" ")),delete D.class):Ee(a,D)}this.selectedNodes.indexOf(l)!==-1&&(a.setAttribute("aria-selected","true"),X([a],Mn)),this.isRefreshed=!1,this.triggerEvent("refreshNode",[this.getNode(a)])}},t.prototype.removeNodes=function(i){g(i)||(this.fields.dataSource instanceof oe&&!this.isOffline?this.crudOperation("delete",i):this.deleteSuccess(i))},t.prototype.updateNode=function(i,r){var n=this;if(!(g(i)||g(r)||!this.allowEditing)){var s=this.getElement(i);if(!g(s)){var a=J("."+vc,s);this.updateOldText(s);var l=this.getEditEvent(s,null,null);this.trigger("nodeEditing",l,function(h){h.cancel||(n.fields.dataSource instanceof oe&&!n.isOffline?n.crudOperation("update",null,i,r,null,null,!1):n.appendNewText(s,a,r,!1))})}}},t.prototype.uncheckAll=function(i){this.showCheckBox&&this.checkedNodes.length>0&&this.doCheckBoxAction(i,!1)},t.prototype.setNodeFocusable=function(){var i=J("."+Tt,this.element);i&&(i.setAttribute("tabindex","0"),this.updateIdAttr(null,i))};var e;return ht([w(!1)],t.prototype,"allowDragAndDrop",void 0),ht([w(!1)],t.prototype,"allowEditing",void 0),ht([w(!1)],t.prototype,"allowMultiSelection",void 0),ht([w(!1)],t.prototype,"allowTextWrap",void 0),ht([Ce({},YU)],t.prototype,"animation",void 0),ht([w()],t.prototype,"checkedNodes",void 0),ht([w(!0)],t.prototype,"checkDisabledChildren",void 0),ht([w("")],t.prototype,"cssClass",void 0),ht([w(!1)],t.prototype,"disabled",void 0),ht([w(null)],t.prototype,"dragArea",void 0),ht([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),ht([w(!1)],t.prototype,"enablePersistence",void 0),ht([w()],t.prototype,"expandedNodes",void 0),ht([w("Auto")],t.prototype,"expandOn",void 0),ht([Ce({},qU)],t.prototype,"fields",void 0),ht([w(!0)],t.prototype,"fullRowSelect",void 0),ht([w(!0)],t.prototype,"loadOnDemand",void 0),ht([w()],t.prototype,"locale",void 0),ht([w()],t.prototype,"nodeTemplate",void 0),ht([w()],t.prototype,"selectedNodes",void 0),ht([w("None")],t.prototype,"sortOrder",void 0),ht([w(!1)],t.prototype,"showCheckBox",void 0),ht([w(!1)],t.prototype,"checkOnClick",void 0),ht([w(!0)],t.prototype,"autoCheck",void 0),ht([w(!1)],t.prototype,"fullRowNavigable",void 0),ht([G()],t.prototype,"actionFailure",void 0),ht([G()],t.prototype,"created",void 0),ht([G()],t.prototype,"dataBound",void 0),ht([G()],t.prototype,"dataSourceChanged",void 0),ht([G()],t.prototype,"drawNode",void 0),ht([G()],t.prototype,"destroyed",void 0),ht([G()],t.prototype,"keyPress",void 0),ht([G()],t.prototype,"nodeChecked",void 0),ht([G()],t.prototype,"nodeChecking",void 0),ht([G()],t.prototype,"nodeClicked",void 0),ht([G()],t.prototype,"nodeCollapsed",void 0),ht([G()],t.prototype,"nodeCollapsing",void 0),ht([G()],t.prototype,"nodeDragging",void 0),ht([G()],t.prototype,"nodeDragStart",void 0),ht([G()],t.prototype,"nodeDragStop",void 0),ht([G()],t.prototype,"nodeDropped",void 0),ht([G()],t.prototype,"nodeEdited",void 0),ht([G()],t.prototype,"nodeEditing",void 0),ht([G()],t.prototype,"nodeExpanded",void 0),ht([G()],t.prototype,"nodeExpanding",void 0),ht([G()],t.prototype,"nodeSelected",void 0),ht([G()],t.prototype,"nodeSelecting",void 0),t=e=ht([It],t),t})(ti);var Rf=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),gi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Rs="e-toast",id="e-toast-container",mF="e-toast-title",yF="e-toast-full-width",bF="e-toast-content",Iy="e-toast-message",GU="e-toast-icon",My="e-toast-progress",QU="e-toast-actions",wI="e-toast-close-icon",xI="e-rtl",XU="e-blazor-toast-hidden",KU=(function(o){Rf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return gi([w("Left")],t.prototype,"X",void 0),gi([w("Top")],t.prototype,"Y",void 0),t})(Oe),$U=(function(o){Rf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return gi([w(null)],t.prototype,"model",void 0),gi([w(null)],t.prototype,"click",void 0),t})(Oe),SF=(function(o){Rf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return gi([w("FadeIn")],t.prototype,"effect",void 0),gi([w(600)],t.prototype,"duration",void 0),gi([w("ease")],t.prototype,"easing",void 0),t})(Oe),ZU=(function(o){Rf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return gi([Ce({effect:"FadeIn",duration:600,easing:"ease"},SF)],t.prototype,"show",void 0),gi([Ce({effect:"FadeOut",duration:600,easing:"ease"},SF)],t.prototype,"hide",void 0),t})(Oe),JU=(function(o){Rf(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.toastCollection=[],r.needsID=!0,r}return t.prototype.getModuleName=function(){return"toast"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.hide("All"),this.element.classList.remove(id),Ze(this.element,{position:"","z-index":""}),!g(this.refElement)&&!g(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.element,this.refElement),se(this.refElement),this.refElement=void 0),this.isBlazorServer()||o.prototype.destroy.call(this),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element)},t.prototype.preRender=function(){this.isDevice=j.isDevice,this.width==="300px"&&(this.width=this.isDevice&&screen.width<768?"100%":"300px"),g(this.target)&&(this.target=document.body),this.enableRtl&&!this.isBlazorServer()&&this.element.classList.add(xI)},t.prototype.render=function(){this.progressObj=[],this.intervalId=[],this.contentTemplate=null,this.toastTemplate=null,this.renderComplete(),this.initRenderClass=this.element.className},t.prototype.show=function(e){var i;if(g(e)||(this.templateChanges(e),i=JSON.parse(JSON.stringify(e)),pe(this,this,e)),g(this.toastContainer)){this.toastContainer=this.getContainer();var r=typeof this.target=="string"?document.querySelector(this.target):typeof this.target=="object"?this.target:document.body;if(g(r))return;r.tagName==="BODY"?this.toastContainer.style.position="fixed":(this.toastContainer.style.position="absolute",r.style.position="relative"),this.setPositioning(this.position),r.appendChild(this.toastContainer)}if(this.isBlazorServer()&&this.element.classList.contains("e-control")){this.isToastModel(e);return}this.toastEle=this.createElement("div",{className:Rs,id:Lt("toast")}),this.setWidthHeight(),this.setCSSClass(this.cssClass),g(this.template)||this.template===""?this.personalizeToast():this.templateRendering(),this.setProgress(),this.setCloseButton(),this.setAria(),this.appendToTarget(e),this.isDevice&&screen.width<768&&new jr(this.toastEle,{swipe:this.swipeHandler.bind(this)}),g(i)||(pe(i,{element:[this.toastEle]},!0),this.toastCollection.push(i)),this.isReact&&this.renderReactTemplates()},t.prototype.showToast=function(e,i){this.toastEle=this.element.querySelector("#"+e),this.show(i)},t.prototype.isToastModel=function(e){this.toastContainer=this.element,this.setPositioning(this.position);var i=this;g(i.element.lastElementChild)||this.setProgress(),this.setAria(),this.appendToTarget(e)},t.prototype.swipeHandler=function(e){var i=H(e.originalEvent.target,"."+Rs+":not(."+id+")"),r=this.animation.hide.effect;g(i)||(e.swipeDirection==="Right"?(this.animation.hide.effect="SlideRightOut",this.hideToast("swipe",i)):e.swipeDirection==="Left"&&(this.animation.hide.effect="SlideLeftOut",this.hideToast("swipe",i)),this.animation.hide.effect=r)},t.prototype.templateChanges=function(e){!Te(e.content)&&!g(this.contentTemplate)&&this.content!==e.content&&this.clearContentTemplate(),!Te(e.template)&&!g(this.toastTemplate)&&this.template!==e.template&&this.clearToastTemplate()},t.prototype.setCSSClass=function(e){if(e){var i=e.indexOf(",")!==-1?",":" ";Ai(this.toastEle,e.split(i),[]),this.toastContainer&&Ai(this.toastContainer,e.split(i),[])}},t.prototype.setWidthHeight=function(){this.width==="300px"?this.toastEle.style.width=Ae(this.width):this.width==="100%"?this.toastContainer.classList.add(yF):(this.toastEle.style.width=Ae(this.width),this.toastContainer.classList.remove(yF)),this.toastEle.style.height=Ae(this.height)},t.prototype.templateRendering=function(){this.fetchEle(this.toastEle,this.template,"template")},t.prototype.sanitizeHelper=function(e){if(this.enableHtmlSanitizer){var i=Pt.beforeSanitize(),r={cancel:!1,helper:null};pe(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!g(i.helper)?e=i.helper(e):i.cancel||(e=Pt.serializeValue(i,e))}return e},t.prototype.hide=function(e){this.hideToast("",e)},t.prototype.hideToast=function(e,i){if(!(g(this.toastContainer)||this.toastContainer.childElementCount===0)){if(typeof i=="string"&&i==="All"){for(var r=0;r<this.toastContainer.childElementCount;r++)this.destroyToast(this.toastContainer.children[r],e);return}g(i)&&(i=this.newestOnTop?this.toastContainer.lastElementChild:this.toastContainer.firstElementChild),this.destroyToast(i,e)}},t.prototype.fetchEle=function(e,i,r){i=typeof i=="string"?this.sanitizeHelper(i):i;var n,s,a,l;if(e.classList.contains(mF)?l=this.element.id+"title":e.classList.contains(bF)?l=this.element.id+"content":l=this.element.id+"template",r==="content"?s=this.contentTemplate:s=this.toastTemplate,!g(s))return e.appendChild(s.cloneNode(!0)),e;try{if(typeof i!="function"&&document.querySelectorAll(i).length>0){var h=null;r!=="title"&&(h=document.querySelector(i),e.appendChild(h),h.style.display="");var c=g(h)?s:h.cloneNode(!0);r==="content"?this.contentTemplate=c:this.toastTemplate=c}else n=Et(i)}catch{n=typeof i=="object"?Et(i):Et(fa(function(){return i}))}if(!g(n))if(!this.isBlazorServer())a=n({},this,r,null,!0);else{var u=!0;a=n({},this,r,l,u)}return!g(a)&&a.length>0&&!(g(a[0].tagName)&&a.length===1)?[].slice.call(a).forEach(function(d){g(d.tagName)||(d.style.display=""),e.appendChild(d)}):typeof i!="function"&&e.childElementCount===0&&(e.innerHTML=i),e},t.prototype.clearProgress=function(e){g(this.intervalId[e])||(clearInterval(this.intervalId[e]),delete this.intervalId[e]),g(this.progressObj[e])||(clearInterval(this.progressObj[e].intervalId),delete this.progressObj[e])},t.prototype.removeToastContainer=function(e){e&&this.toastContainer.classList.contains("e-toast-util")&&se(this.toastContainer)},t.prototype.clearContainerPos=function(e){var i=this;if(this.isBlazorServer()){this.toastContainer=null;return}this.customPosition?(Ze(this.toastContainer,{left:"",top:""}),this.removeToastContainer(e),this.toastContainer=null,this.customPosition=!1):([Rs+"-top-left",Rs+"-top-right",Rs+"-bottom-left",Rs+"-bottom-right",Rs+"-bottom-center",Rs+"-top-center",Rs+"-full-width"].forEach(function(r){!g(i.toastContainer)&&i.toastContainer.classList.contains(r)&&i.toastContainer.classList.remove(r)}),this.removeToastContainer(e),this.toastContainer=null),g(this.contentTemplate)||this.clearContentTemplate(),g(this.toastTemplate)||this.clearToastTemplate()},t.prototype.clearContentTemplate=function(){this.contentTemplate.style.display="none",document.body.appendChild(this.contentTemplate),this.contentTemplate=null},t.prototype.clearToastTemplate=function(){this.toastTemplate.style.display="none",document.body.appendChild(this.toastTemplate),this.toastTemplate=null},t.prototype.isBlazorServer=function(){return $e()&&this.isServerRendered},t.prototype.destroyToast=function(e,i){for(var r=this,n,s=0;s<this.toastCollection.length;s++)this.toastCollection[s].element[0]===e&&(n=this.toastCollection[s],this.toastCollection.splice(s,1));var a={options:this,cancel:!1,type:i,element:e,toastContainer:this.toastContainer},l=this.animation.hide,h={duration:l.duration,name:l.effect==="None"&&Yt==="Enable"?"FadeOut":l.effect,timingFunction:l.easing},c=parseInt(e.id.split("toast_")[1],10),u=this.isBlazorServer()?{options:n,toastContainer:this.toastContainer}:{options:n,toastContainer:this.toastContainer,toastObj:this};this.trigger("beforeClose",a,function(d){d.cancel||(!g(r.progressObj[c])&&!g(e.querySelector("."+My))&&(r.progressObj[c].progressEle.style.width="0%"),h.end=function(){r.clearProgress(c),(!r.isBlazorServer()||g(n))&&se(e),r.trigger("close",u),r.toastContainer.childElementCount===0&&r.clearContainerPos(!0),l=null,h=null},new Mt(h).animate(e))})},t.prototype.personalizeToast=function(){this.setIcon(),this.setTitle(),this.setContent(),this.actionButtons()},t.prototype.setAria=function(){Ee(this.toastEle,{role:"alert"})},t.prototype.setPositioning=function(e){this.isBlazorServer()||(!isNaN(parseFloat(e.X))||!isNaN(parseFloat(e.Y))?(this.customPosition=!0,Ze(this.toastContainer,{left:Ae(e.X),top:Ae(e.Y)})):this.toastContainer.classList.add(Rs+"-"+e.Y.toString().toLowerCase()+"-"+e.X.toString().toLowerCase()))},t.prototype.setCloseButton=function(){if(this.showCloseButton){var e={close:"Close"};this.l10n=new Ri("toast",e,this.locale),this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("close"),r=this.createElement("div",{className:wI+" e-icons ",attrs:{tabindex:"0","aria-label":i,role:"button"}});this.toastEle.classList.add("e-toast-header-close-icon"),this.toastEle.appendChild(r)}},t.prototype.setProgress=function(){if(this.timeOut>0){var e=parseInt(this.toastEle.id.split("toast_")[1],10);this.intervalId[e]=window.setTimeout(this.destroyToast.bind(this,this.toastEle),this.timeOut),this.progressObj[e]={hideEta:null,intervalId:null,maxHideTime:null,element:null,timeOutId:null,progressEle:null},this.progressObj[e].maxHideTime=parseFloat(this.timeOut+""),this.progressObj[e].hideEta=new Date().getTime()+this.progressObj[e].maxHideTime,this.progressObj[e].element=this.toastEle,this.extendedTimeout>0&&(T.add(this.toastEle,"mouseover",this.toastHoverAction.bind(this,e)),T.add(this.toastEle,"mouseleave",this.delayedToastProgress.bind(this,e)),this.progressObj[e].timeOutId=this.intervalId[e]),this.showProgressBar&&(this.progressBarEle=this.createElement("div",{className:My}),this.toastEle.insertBefore(this.progressBarEle,this.toastEle.children[0]),this.progressObj[e].intervalId=setInterval(this.updateProgressBar.bind(this,this.progressObj[e]),10),this.progressObj[e].progressEle=this.progressBarEle)}},t.prototype.toastHoverAction=function(e){clearTimeout(this.progressObj[e].timeOutId),clearInterval(this.progressObj[e].intervalId),this.progressObj[e].hideEta=0;var i=this.progressObj[e].element;g(i.querySelector("."+My))||(this.progressObj[e].progressEle.style.width="0%")},t.prototype.delayedToastProgress=function(e){var i=this.progressObj[e];if(!g(i)){var r=i.element;i.timeOutId=window.setTimeout(this.destroyToast.bind(this,r),this.extendedTimeout),i.maxHideTime=parseFloat(this.extendedTimeout+""),i.hideEta=new Date().getTime()+i.maxHideTime,g(r.querySelector("."+My))||(i.intervalId=setInterval(this.updateProgressBar.bind(this,i),10))}},t.prototype.updateProgressBar=function(e){var i=(e.hideEta-new Date().getTime())/e.maxHideTime*100;i=this.progressDirection==="Ltr"?100-i:i,e.progressEle.style.width=i+"%"},t.prototype.setIcon=function(){if(!(g(this.icon)||this.icon.length===0)){var e=this.createElement("div",{className:GU+" e-icons "+this.icon});this.toastEle.classList.add("e-toast-header-icon"),this.toastEle.appendChild(e)}},t.prototype.setTitle=function(){if(!g(this.title)){var e=this.createElement("div",{className:mF});e=this.fetchEle(e,this.title,"title");var i=this.createElement("div",{className:Iy});i.appendChild(e),this.toastEle.appendChild(i)}},t.prototype.setContent=function(){var e=this.createElement("div",{className:bF}),i=this.element;if(g(this.content)||this.content===""){var r=this.element.innerHTML.replace(/\s/g,"")!=="";if((i.children.length>0||r)&&!(i.firstElementChild&&i.firstElementChild.classList.contains(Rs))){this.innerEle=document.createDocumentFragment();for(var n=this.createElement("div");i.childNodes.length!==0;)this.innerEle.appendChild(this.element.childNodes[0]);e.appendChild(this.innerEle),[].slice.call(e.children).forEach(function(s){n.appendChild(s.cloneNode(!0))}),this.content=n,this.appendMessageContainer(e)}}else typeof this.content=="object"&&!g(this.content.tagName)?(e.appendChild(this.content),this.content=this.content.cloneNode(!0),this.appendMessageContainer(e)):(e=this.fetchEle(e,this.content,"content"),this.appendMessageContainer(e))},t.prototype.appendMessageContainer=function(e){if(this.toastEle.querySelectorAll("."+Iy).length>0)this.toastEle.querySelector("."+Iy).appendChild(e);else{var i=this.createElement("div",{className:Iy});i.appendChild(e),this.toastEle.appendChild(i)}},t.prototype.actionButtons=function(){var e=this,i=this.createElement("div",{className:QU});[].slice.call(this.buttons).forEach(function(r){if(!g(r.model)){var n=e.createElement("button");n.setAttribute("type","button"),(g(r.model.cssClass)||r.model.cssClass.length===0)&&(r.model.cssClass="e-primary "+e.cssClass),n.classList.add("e-small"),new Jn(r.model,n),!g(r.click)&&typeof r.click=="function"&&T.add(n,"click",r.click),i.appendChild(n)}}),i.childElementCount>0&&this.appendMessageContainer(i)},t.prototype.appendToTarget=function(e){var i=this,r=this.isBlazorServer()?{options:e,element:this.toastEle,cancel:!1}:{options:e,toastObj:this,element:this.toastEle,cancel:!1};this.trigger("beforeOpen",r,function(n){if(!n.cancel)i.isBlazorServer()||(i.toastEle.style.display="none"),i.newestOnTop&&i.toastContainer.childElementCount!==0?i.toastContainer.insertBefore(i.toastEle,i.toastContainer.children[0]):i.isBlazorServer()||i.toastContainer.appendChild(i.toastEle),Z([i.toastEle],XU),T.add(i.toastEle,"click",i.clickHandler,i),T.add(i.toastEle,"keydown",i.keyDownHandler,i),i.toastContainer.style.zIndex=Gs(i.toastContainer)+"",i.displayToast(i.toastEle,e);else if(i.isBlazorServer()){var s=parseInt(i.toastEle.id.split("toast_")[1],10);i.clearProgress(s),se(i.toastEle),i.toastContainer.childElementCount===0&&i.clearContainerPos()}})},t.prototype.clickHandler=function(e){var i=this;this.isBlazorServer()||e.stopPropagation();var r=e.target,n=H(r,"."+Rs),s=this.isBlazorServer()?{element:n,cancel:!1,clickToClose:!1,originalEvent:e}:{element:n,cancel:!1,clickToClose:!1,originalEvent:e,toastObj:this},a=r.classList.contains(wI);this.trigger("click",s,function(l){(a&&!l.cancel||l.clickToClose)&&i.destroyToast(n,"click")})},t.prototype.keyDownHandler=function(e){if(e.target.classList.contains(wI)&&(e.keyCode===13||e.keyCode===32)){var i=e.target,r=H(i,"."+Rs);this.destroyToast(r,"key")}},t.prototype.displayToast=function(e,i){var r=this,n=this.animation.show,s={duration:n.duration,name:n.effect==="None"&&Yt==="Enable"?"FadeIn":n.effect,timingFunction:n.easing},a=this.isBlazorServer()?{options:i,element:this.toastEle}:{options:i,toastObj:this,element:this.toastEle};s.begin=function(){e.style.display=""},s.end=function(){r.trigger("open",a)},new Mt(s).animate(e)},t.prototype.getContainer=function(){return this.element.classList.add(id),this.element},t.prototype.onPropertyChanged=function(e,i){for(var r=this.element,n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"enableRtl":e.enableRtl?r.classList.add(xI):r.classList.remove(xI);break}}},gi([w("300px")],t.prototype,"width",void 0),gi([w("auto")],t.prototype,"height",void 0),gi([w(null)],t.prototype,"title",void 0),gi([w(null)],t.prototype,"content",void 0),gi([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),gi([w(null)],t.prototype,"icon",void 0),gi([w(null)],t.prototype,"cssClass",void 0),gi([w(null)],t.prototype,"template",void 0),gi([w(!0)],t.prototype,"newestOnTop",void 0),gi([w(!1)],t.prototype,"showCloseButton",void 0),gi([w(!1)],t.prototype,"showProgressBar",void 0),gi([w(5e3)],t.prototype,"timeOut",void 0),gi([w("Rtl")],t.prototype,"progressDirection",void 0),gi([w(1e3)],t.prototype,"extendedTimeout",void 0),gi([Ce({},ZU)],t.prototype,"animation",void 0),gi([Ce({},KU)],t.prototype,"position",void 0),gi([Gt([{}],$U)],t.prototype,"buttons",void 0),gi([w(null)],t.prototype,"target",void 0),gi([G()],t.prototype,"created",void 0),gi([G()],t.prototype,"beforeSanitizeHtml",void 0),gi([G()],t.prototype,"destroyed",void 0),gi([G()],t.prototype,"open",void 0),gi([G()],t.prototype,"beforeOpen",void 0),gi([G()],t.prototype,"beforeClose",void 0),gi([G()],t.prototype,"close",void 0),gi([G()],t.prototype,"click",void 0),t=gi([It],t),t})(ti),CF;(function(o){function t(e,i,r){var n;document.querySelector("."+id)?n=document.querySelector("."+id):(n=et("div",{className:Rs+" "+id+" e-toast-util"}),document.body.appendChild(n));var s;if(typeof e=="string"){var a=void 0,l=void 0;if(g(i))a="",l="";else switch(i){case"Warning":a="e-toast-warning",l="e-toast-warning-icon";break;case"Success":a="e-toast-success",l="e-toast-success-icon";break;case"Error":a="e-toast-danger",l="e-toast-error-icon";break;case"Information":a="e-toast-info",l="e-toast-info-icon";break}s={content:e,cssClass:a,icon:l,timeOut:g(r)?5e3:r}}else s=e;var h=new JU(s);return h.appendTo(n),h.show(),h}o.show=t})(CF||(CF={}));var e5=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),yh=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},II={TEXTSHAPE:"e-skeleton-text",CIRCLESHAPE:"e-skeleton-circle",SQUARESHAPE:"e-skeleton-square",RECTANGLESHAPE:"e-skeleton-rectangle",WAVEEFFECT:"e-shimmer-wave",PULSEEFFECT:"e-shimmer-pulse",FADEEFFECT:"e-shimmer-fade",VISIBLENONE:"e-visible-none"};var MI=(function(o){e5(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.getModuleName=function(){return"skeleton"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.preRender=function(){this.element.id||(this.element.id=Lt("e-"+this.getModuleName())),this.updateCssClass(),Ee(this.element,{role:"alert","aria-busy":"true","aria-live":"polite","aria-label":this.label})},t.prototype.render=function(){this.initialize()},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"width":case"height":this.updateDimension();break;case"shape":this.updateShape();break;case"shimmerEffect":this.updateEffect();break;case"visible":this.updateVisibility();break;case"label":this.element.setAttribute("aria-label",this.label);break;case"cssClass":i.cssClass&&Z([this.element],i.cssClass.split(" ")),this.updateCssClass();break}}},t.prototype.destroy=function(){o.prototype.destroy.call(this);var e=["role","aria-live","aria-busy","aria-label"],i=[];this.cssClass&&(i=i.concat(this.cssClass.split(" ")));for(var r=0;r<e.length;r++)this.element.removeAttribute(e[parseInt(r.toString(),10)]);i=i.concat(this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[]),i=i.concat(this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[]),Z([this.element],i)},t.prototype.initialize=function(){this.updateShape(),this.updateEffect(),this.updateVisibility()},t.prototype.updateShape=function(){if(!g(this.shape)){var e=II[this.shape.toUpperCase()+"SHAPE"],i=this.element.classList.value.match(/(e-skeleton-[^\s]+)/g)||[];this.updateDimension(),i&&Z([this.element],i),X([this.element],[e])}},t.prototype.updateDimension=function(){var e=!this.width&&["Text","Rectangle"].indexOf(this.shape)>-1?"100%":Ae(this.width),i=["Circle","Square"].indexOf(this.shape)>-1?e:Ae(this.height);this.element.style.width=e,this.element.style.height=i},t.prototype.updateEffect=function(){var e=this.element.classList.value.match(/(e-shimmer-[^\s]+)/g)||[];e&&Z([this.element],e),g(this.shimmerEffect)||X([this.element],[II[this.shimmerEffect.toUpperCase()+"EFFECT"]])},t.prototype.updateVisibility=function(){this.element.classList[this.visible?"remove":"add"](II.VISIBLENONE)},t.prototype.updateCssClass=function(){this.cssClass&&X([this.element],this.cssClass.split(" "))},yh([w("")],t.prototype,"width",void 0),yh([w("")],t.prototype,"height",void 0),yh([w(!0)],t.prototype,"visible",void 0),yh([w("Text")],t.prototype,"shape",void 0),yh([w("Wave")],t.prototype,"shimmerEffect",void 0),yh([w("Loading...")],t.prototype,"label",void 0),yh([w("")],t.prototype,"cssClass",void 0),t=yh([It],t),t})(ti);var Os="",Ny="",Of="",fn=[],t5="e-active",ky="";function zf(o,t,e,i,r,n,s,a,l){!n||Os===""?Of!==""?(Os=Of+String.fromCharCode(o),Of=""):Os+=String.fromCharCode(o):Os===Ny&&(Of=String.fromCharCode(o)),a?(setTimeout(function(){Of=""},700),setTimeout(function(){Os=""},3e3)):setTimeout(function(){Os=""},1e3);var h;if(Os=i?Os.toLowerCase():Os,ky===r&&Ny===Os&&!l){for(var c=0;c<fn.length;c++){if(fn[c].classList.contains(t5)){h=c;break}if(s&&fn[c].textContent.toLowerCase()===s.toLowerCase()){h=c;break}}return h=h+1,a?fn[h]&&fn.length-1!==h?fn[h]:fn[fn.length]:fn[h]?fn[h]:fn[0]}else{var u=t,d=Os.length,p=void 0,f=void 0;e=e?e+1:0;var c=e;fn=[];do c===u.length&&(c=-1),c===-1?h=0:h=c,f=u[h],p=i?f.innerText.toLowerCase():f.innerText,p.substr(0,d)===Os&&fn.push(u[h]),c++;while(c!==e);if(Ny=Os,ky=r,a){for(var v=!1,m=0;m<fn.length;m++)if(s&&fn[m].textContent.toLowerCase()===s.toLowerCase()){h=m,v=!0;break}return s&&v&&(h=h+1),fn[h]?fn[h]:fn[0]}return fn[0]}}function wa(o,t,e,i,r,n,s,a){var l=t;i=i??!0;var h={item:null,index:null};if(o&&o.length&&t){var c=o.length,u=i?o.toLocaleLowerCase():o;u=i5(u);for(var d=function(m,y){var b=y[m],S;if(t&&r){var C=b,x=n.text.split(".");r.filter(function(D){Array.prototype.slice.call(x).forEach(function(M){(s==="object"&&!D.isHeader&&C.textContent.toString().indexOf(D[M])!==-1&&D[n.value]!=null&&C.getAttribute("data-value")===D[n.value].toString()||s==="string"&&C.textContent.toString().indexOf(D)!==-1)&&(S=s==="object"?D[M]:D)})})}var I=r&&S?(i?S.toString().toLocaleLowerCase():S).replace(/^\s+|\s+$/g,""):(i?b.textContent.toLocaleLowerCase():b.textContent).replace(/^\s+|\s+$/g,"");if(a&&I&&u&&(I=I.normalize("NFD").replace(/[\u0300-\u036f]/g,""),u=u.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),e==="Equal"&&I===u||e==="StartsWith"&&I.substr(0,c)===u||e==="EndsWith"&&I.substr(I.length-u.length)===u||e==="Contains"&&new RegExp(u,"g").test(I))return h.item=b,h.index=m,{value:{item:b,index:m}}},p=0,f=l;p<f.length;p++){var v=d(p,f);if(typeof v=="object")return v.value}return h}return h}function i5(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r5(o){ky===o&&(ky="",Ny="",Os="",fn=[])}function Dy(o,t,e,i){var r=/<[^>]*>/g.test(o.innerText);if(r&&(o.innerText=o.innerText.replace(/[\u00A0-\u9999<>&]/g,function(a){return"&#"+a.charCodeAt(0)+";"})),t!==""){var n=e?"gim":"gm";t=/^[a-zA-Z0-9- ]*$/.test(t)?t:t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var s=i==="StartsWith"?"^("+t+")":i==="EndsWith"?"("+t+")$":"("+t+")";BF(o,new RegExp(s,n))}}function BF(o,t){for(var e=0;o.childNodes&&e<o.childNodes.length;e++)if(o.childNodes[e].nodeType===3&&o.childNodes[e].textContent.trim()!==""){var i=o.childNodes[e].nodeValue.trim().replace(t,'<span class="e-highlight">$1</span>');o.childNodes[e].nodeValue="",o.innerHTML=o.innerHTML.trim()+i;break}else BF(o.childNodes[e],t)}function n5(o){for(var t=o.querySelectorAll(".e-highlight"),e=t.length-1;e>=0;e--){var i=t[e].parentNode,r=document.createTextNode(t[e].textContent);i.replaceChild(r,t[e])}}var jF=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),or=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},NI=(function(o){jF(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return or([w()],t.prototype,"text",void 0),or([w()],t.prototype,"value",void 0),or([w()],t.prototype,"iconCss",void 0),or([w()],t.prototype,"groupBy",void 0),or([w()],t.prototype,"htmlAttributes",void 0),or([w()],t.prototype,"disabled",void 0),t})(Oe),de={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:"e-list-item",group:"e-list-group-item",disabled:"e-disabled",grouping:"e-dd-group",virtualList:"e-list-item e-virtual-list"},s5="ItemTemplate",a5="DisplayTemplate",o5="SpinnerTemplate",l5="ValueTemplate",h5="GroupTemplate",c5="HeaderTemplate",u5="FooterTemplate",d5="NoRecordsTemplate",p5="ActionFailureTemplate",f5="e-hide-group-header",HF=(function(o){jF(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.preventChange=!1,r.isPreventChange=!1,r.isDynamicDataChange=!1,r.addedNewItem=!1,r.isAddNewItemTemplate=!1,r.isRequesting=!1,r.isVirtualizationEnabled=!1,r.isCustomDataUpdated=!1,r.isAllowFiltering=!1,r.virtualizedItemsCount=0,r.isCheckBoxSelection=!1,r.totalItemCount=0,r.dataCount=0,r.remoteDataCount=-1,r.isRemoteDataUpdated=!1,r.isIncrementalRequest=!1,r.itemCount=30,r.virtualListHeight=0,r.isVirtualScrolling=!1,r.isPreventScrollAction=!1,r.scrollPreStartIndex=0,r.isScrollActionTriggered=!1,r.previousStartIndex=0,r.isMouseScrollAction=!1,r.isKeyBoardAction=!1,r.isScrollChanged=!1,r.isUpwardScrolling=!1,r.startIndex=0,r.currentPageNumber=0,r.pageCount=0,r.isPreventKeyAction=!1,r.generatedDataObject={},r.skeletonCount=32,r.isVirtualTrackHeight=!1,r.virtualSelectAll=!1,r.isVirtualReorder=!1,r.incrementalQueryString="",r.incrementalEndIndex=0,r.incrementalStartIndex=0,r.incrementalPreQueryString="",r.isObjectCustomValue=!1,r.appendUncheckList=!1,r.getInitialData=!1,r.preventPopupOpen=!0,r.virtualSelectAllState=!1,r.CurrentEvent=null,r.isDynamicData=!1,r.isPrimitiveData=!1,r.isCustomFiltering=!1,r.debounceTimer=null,r.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r.selectedValueInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:0},r}return t.prototype.getPropObject=function(e,i,r){var n=new Object,s=new Object,a=function(h){return h};n[a(e)]=i[a(e)],s[a(e)]=r[a(e)];var l=new Object;return l.newProperty=n,l.oldProperty=s,l},t.prototype.getValueByText=function(e,i,r){var n=null;return g(this.listData)||(i?n=this.checkValueCase(e,!0,r):n=this.checkValueCase(e,!1,r)),n},t.prototype.checkValueCase=function(e,i,r,n){var s=this,a=null;if(n&&(a=e),!g(this.listData)){var l=this.listData,h=this.fields,c=this.typeOfData(l).typeof;if(c==="string"||c==="number"||c==="boolean")for(var u=0,d=l;u<d.length;u++){var p=d[u];g(p)||(r?i?this.checkIgnoreCase(String(p),e)&&(a=this.checkingAccent(String(p),e,i)):a=this.checkingAccent(String(p),e,i):i?this.checkIgnoreCase(String(p),e)&&(a=this.getItemValue(String(p),e,i)):this.checkNonIgnoreCase(String(p),e)&&(a=this.getItemValue(String(p),e,i,n)))}else if(i)l.filter(function(v){var m=V(h.value,v);!g(m)&&s.checkIgnoreCase(V(h.text,v).toString(),e)&&(a=V(h.value,v))});else if(n){var f=null;f=a,l.filter(function(v){var m=V(h.value,v);!g(m)&&!g(a)&&m.toString()===f.toString()&&(a=V(h.text,v))})}else l.filter(function(v){s.checkNonIgnoreCase(V(h.text,v),e)&&(a=V(h.value,v))})}return a},t.prototype.checkingAccent=function(e,i,r){var n=ge.ignoreDiacritics(String(e)),s=ge.ignoreDiacritics(i.toString()),a=null;return r?this.checkIgnoreCase(n,s)&&(a=this.getItemValue(String(e),i,r)):this.checkNonIgnoreCase(String(e),i)&&(a=this.getItemValue(String(e),i,r)),a},t.prototype.checkIgnoreCase=function(e,i){return String(e).toLowerCase()===i.toString().toLowerCase()},t.prototype.checkNonIgnoreCase=function(e,i){return String(e)===i.toString()},t.prototype.getItemValue=function(e,i,r,n){var s=null,a=this.listData,l=this.typeOfData(a).typeof;return n?s=e.toString():r?s=l==="string"?String(e):this.getFormattedValue(String(e)):s=l==="string"?i:this.getFormattedValue(i),s},t.prototype.templateCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!ze(e,document).length}catch{i=!1}return i},t.prototype.l10nUpdate=function(e){var i=this.getModuleName()==="listbox"?this.ulElement:this.list;if(!g(this.noRecordsTemplate)&&this.noRecordsTemplate!=="No records found"||this.actionFailureTemplate!=="Request failed"){var r=e?this.actionFailureTemplate:this.noRecordsTemplate,n=void 0,s=e?this.actionFailureTemplateId:this.noRecordsTemplateId;i.innerHTML="";var a=this.templateCompiler(r);typeof r!="function"&&a?n=Et(J(r,document).innerHTML.trim()):n=Et(r);var l=e?"actionFailureTemplate":"noRecordsTemplate",h=void 0;if(this.isReact&&typeof r=="function"?h=n({},this,l,s,this.isStringTemplate,null):h=n({},this,l,s,this.isStringTemplate,null,i),h&&h.length>0)for(var c=0;c<h.length;c++)if(this.getModuleName()==="listbox"&&l==="noRecordsTemplate")if(h[c].nodeName==="#text"){var u=this.createElement("li");u.textContent=h[c].textContent,u.classList.add("e-list-nrt"),u.setAttribute("role","option"),i.appendChild(u)}else h[c].classList.add("e-list-nr-template"),i.appendChild(h[c]);else(h[c]instanceof HTMLElement||h[c]instanceof Text&&h[c].textContent!=="")&&i.appendChild(h[c]);this.renderReactTemplates()}else{var d={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed"},p=new Ri(this.getLocaleName(),{},this.locale);p.getConstant("actionFailureTemplate")!==""||p.getConstant("noRecordsTemplate")!==""?this.l10n=p:this.l10n=new Ri(this.getModuleName()==="listbox"?"listbox":this.getModuleName()==="mention"?"mention":"dropdowns",d,this.locale);var f=e?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate");if(this.getModuleName()==="listbox"){var u=this.createElement("li");u.textContent=f,i.appendChild(u),u.classList.add("e-list-nrt"),u.setAttribute("role","option")}else g(i)||(i.innerHTML=f)}},t.prototype.checkAndResetCache=function(){this.isVirtualizationEnabled&&(this.generatedDataObject={},this.virtualItemStartIndex=this.virtualItemEndIndex=0,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.selectedValueInfo=null)},t.prototype.updateIncrementalInfo=function(e,i){this.viewPortInfo.startIndex=e,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.isIncrementalRequest=!0,this.resetList(this.dataSource,this.fields,this.query),this.isIncrementalRequest=!1},t.prototype.updateIncrementalView=function(e,i){this.viewPortInfo.startIndex=e,this.viewPortInfo.endIndex=i,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul")},t.prototype.updateVirtualItemIndex=function(){this.virtualItemStartIndex=this.viewPortInfo.startIndex,this.virtualItemEndIndex=this.viewPortInfo.endIndex,this.virtualListInfo=this.viewPortInfo},t.prototype.getFilteringSkeletonCount=function(){var e=this.skeletonCount;this.getSkeletonCount(!0),this.skeletonCount=this.dataCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount;var i=!0;if((this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)&&(this.skeletonCount=0,i=!1),!this.list.classList.contains(de.noData)){if(e!==this.skeletonCount&&i?this.UpdateSkeleton(!0,Math.abs(e-this.skeletonCount)):this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl").length>0)this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0&&this.list.querySelector(".e-dropdownbase")){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl",styles:this.GetVirtualTrackHeight()});this.list.querySelector(".e-dropdownbase").appendChild(r)}this.list.getElementsByClassName("e-virtual-ddl-content").length>0&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},t.prototype.getSkeletonCount=function(e){this.virtualListHeight=this.listContainerHeight!=null?parseInt(this.listContainerHeight,10):this.virtualListHeight;var i=this.virtualListHeight>0&&this.listItemHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;this.skeletonCount=i*4<this.itemCount?this.itemCount:i*4,this.itemCount=e?this.itemCount:this.skeletonCount,this.virtualItemCount=this.itemCount,this.skeletonCount=Math.floor(this.skeletonCount/2)},t.prototype.GetVirtualTrackHeight=function(){var e=this.totalItemCount===this.viewPortInfo.endIndex?this.totalItemCount*this.listItemHeight-this.itemCount*this.listItemHeight:this.totalItemCount*this.listItemHeight;e=this.isVirtualTrackHeight?0:e;var i="height: "+(e-this.itemCount*this.listItemHeight)+"px;";return(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")&&this.skeletonCount===0?"height: 0px;":i},t.prototype.getTransformValues=function(){var e=this.viewPortInfo.startIndex*this.listItemHeight;e=e-this.skeletonCount*this.listItemHeight,e=this.viewPortInfo.startIndex===0&&this.listData&&this.listData.length===0||this.skeletonCount===0?0:e;var i="transform: translate(0px, "+e+"px);";return i},t.prototype.UpdateSkeleton=function(e,i){var r=this.list.querySelector(".e-virtual-ddl-content"),n=this.list.querySelector(".e-virtual-list");if(r&&(!n||e)&&this.isVirtualizationEnabled){for(var s=e?i:this.skeletonCount,a=0;a<s;a++){var l=this.createElement("li",{className:de.virtualList,styles:"overflow: inherit"});this.isVirtualizationEnabled&&this.itemTemplate&&(l.style.height=this.listItemHeight-parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)+"px");var h=new MI({shape:"Text",height:"10px",width:"95%",cssClass:"e-skeleton-text"});h.appendTo(this.createElement("div")),l.appendChild(h.element),r.firstChild&&r.firstChild.insertBefore(l,r.firstChild.children[0])}if(this.getModuleName()==="multiselect"&&!this.isVirtualReorder&&!r.firstChild.classList.contains("e-reorder")){for(var a=0;a<s&&this.totalItemCount!==this.viewPortInfo.endIndex;a++){var l=this.createElement("li",{className:de.virtualList+" e-virtual-list-end",styles:"overflow: inherit"});this.isVirtualizationEnabled&&this.itemTemplate&&(l.style.height=this.listItemHeight-parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)+"px");var h=new MI({shape:"Text",height:"10px",width:"95%",cssClass:"e-skeleton-text-end"});h.appendTo(this.createElement("div")),l.appendChild(h.element),r.firstChild&&r.firstChild.appendChild(l)}this.totalItemCount===this.viewPortInfo.endIndex&&r.querySelectorAll(".e-virtual-list-end").forEach(function(c){return c.remove()})}}},t.prototype.getLocaleName=function(){return"drop-down-base"},t.prototype.getTextByValue=function(e){var i=this.checkValueCase(e,!1,!1,!0);return i},t.prototype.getFormattedValue=function(e){if(this.listData&&this.listData.length){var i=void 0;if(this.properties.allowCustomValue&&this.properties.value&&this.properties.value instanceof Array&&this.properties.value.length>0?i=this.typeOfData(this.properties.value):i=this.typeOfData(this.listData),!g(i.item)&&typeof V(this.fields.value?this.fields.value:"value",i.item)=="number"||i.typeof==="number")return parseFloat(e);if(!g(i.item)&&typeof V(this.fields.value?this.fields.value:"value",i.item)=="boolean"||i.typeof==="boolean")return e==="true"||""+e=="true"}return e},t.prototype.setEnableRtl=function(){g(this.enableRtlElements)||(this.list&&this.enableRtlElements.push(this.list),this.enableRtl?X(this.enableRtlElements,de.rtl):Z(this.enableRtlElements,de.rtl))},t.prototype.initialize=function(e){if(this.bindEvent=!0,this.preventPopupOpen=!0,this.actionFailureTemplateId=""+this.element.id+p5,this.element.tagName==="UL"){var i=kt.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(i,this.fields)}else if(this.element.tagName==="SELECT"){var r=this.dataSource instanceof Array?this.dataSource.length>0:!g(this.dataSource);r?this.isDynamicDataChange&&this.setListData(this.dataSource,this.fields,this.query):this.renderItemsBySelect()}else this.setListData(this.dataSource,this.fields,this.query,e)},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.updateDataAttribute=function(e){for(var i=["class","style","id","type","aria-expanded","aria-autocomplete","aria-readonly"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&!(this.getModuleName()==="dropdownlist"&&this.element.attributes[n].name==="readonly")&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));pe(r,e,r),this.setProperties({htmlAttributes:r},!0)},t.prototype.renderItemsBySelect=function(){var e=this.element,i=e.querySelectorAll("select>optgroup"),r,n=this.getModuleName()==="multiselect"&&this.isGroupChecking&&i.length>0;r=n?{value:"value",text:"text",groupBy:"categeory"}:r={value:"value",text:"text"};var s=[],a=e.querySelectorAll("select>option");if(this.getJSONfromOption(s,a,r),i.length){for(var l=0;l<i.length;l++){var h=i[l],c={};c[r.text]=h.label,c.isHeader=!0;var u=h.querySelectorAll("option");n?this.getJSONfromOption(s,u,r,h.label):(s.push(c),this.getJSONfromOption(s,u,r))}e.querySelectorAll("select>option")}this.updateFields(r.text,r.value,n?r.groupBy:this.fields.groupBy,this.fields.htmlAttributes,this.fields.iconCss,this.fields.disabled),this.resetList(s,r)},t.prototype.updateFields=function(e,i,r,n,s,a){var l={fields:{text:e,value:i,groupBy:g(r)?this.fields&&this.fields.groupBy:r,htmlAttributes:g(n)?this.fields&&this.fields.htmlAttributes:n,iconCss:g(s)?this.fields&&this.fields.iconCss:s,disabled:g(a)?this.fields&&this.fields.disabled:a}};this.setProperties(l,!0)},t.prototype.getJSONfromOption=function(e,i,r,n){n===void 0&&(n=null);for(var s=0,a=i;s<a.length;s++){var l=a[s],h={};h[r.text]=l.text,h[r.value]=g(l.getAttribute(r.value))?l.value:l.getAttribute(r.value),g(n)||(h[r.groupBy]=n),e.push(h)}},t.prototype.preRender=function(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=""+this.element.id+s5,this.displayTemplateId=""+this.element.id+a5,this.spinnerTemplateId=""+this.element.id+o5,this.valueTemplateId=""+this.element.id+l5,this.groupTemplateId=""+this.element.id+h5,this.headerTemplateId=""+this.element.id+c5,this.footerTemplateId=""+this.element.id+u5,this.noRecordsTemplateId=""+this.element.id+d5},t.prototype.setListData=function(e,i,r,n){var s=this;i=i||this.fields;var a;this.isActive=!0;var l={cancel:!1,data:e,query:r};this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.isRequesting||this.trigger("actionBegin",l,function(h){if(!h.cancel)if(s.isRequesting=!0,s.showSpinner(),e instanceof oe){s.isRequested=!0;var c=!1;if(s.isDataFetched){s.emptyDataRequest(i);return}var u=s.getQuery(h.query);h.data.executeQuery(u).then(function(S){s.isPreventChange=s.isAngular&&s.preventChange?!0:s.isPreventChange;var C=!0;if(!s.virtualSelectAll){for(var x=u.clone(),I=0;I<x.queries.length;I++)x.queries[I].fn==="onWhere"&&(c=!0);if(s.isVirtualizationEnabled&&S.count!==0&&S.count<s.itemCount*2){if(x)for(var I=0;I<x.queries.length;I++){if(s.getModuleName()==="multiselect"&&s.isCheckBoxSelection&&x.queries[I].e&&(x.queries[I].e.operator==="notequal"||x.queries[I].e.operator==="equal"||x.queries[I].e.condition==="or"||x.queries[I].e.condition==="and")&&!s.isCustomFiltering){C=!1;break}x.queries[I].fn==="onTake"&&(x.queries[I].e.nos=S.count),s.getModuleName()==="multiselect"&&(x.queries[I].e.condition==="or"||x.queries[I].e.operator==="equal")&&!s.isCustomFiltering&&(C=!1)}}else if(s.isVirtualTrackHeight=!1,x)for(var I=0;I<x.queries.length;I++)s.getModuleName()==="multiselect"&&(x.queries[I].e&&x.queries[I].e.condition==="or"||x.queries[I].e&&x.queries[I].e.operator==="equal")&&(C=!1)}C&&(s.dataCount=s.totalItemCount=S.count),s.trigger("actionComplete",S,function(D){if(!D.cancel){s.isRequesting=!1,s.isCustomFiltering=!1;var M=D.result;if(s.isIncrementalRequest){a=s.renderItems(M,i);return}if((!s.isVirtualizationEnabled&&M.length===0||s.isVirtualizationEnabled&&M.length===0&&!c)&&(s.isDataFetched=!0),c||(s.remoteDataCount=D.count),s.dataCount=s.virtualSelectAll?s.dataCount:D.count,s.totalItemCount=s.virtualSelectAll?s.totalItemCount:D.count,a=s.renderItems(M,i),s.appendUncheckList=!1,s.isUpdateGroupTemplate=!1,s.onActionComplete(a,M,D),s.groupTemplate&&(s.isAngular&&s.getModuleName()==="multiselect"&&s.updateGroupHeaderItems(a),s.renderGroupTemplate(a)),s.isUpdateGroupTemplate=!0,s.isRequested=!1,s.bindChildItems(M,a,i,D),s.getInitialData){s.getInitialData=!1,s.preventPopupOpen=!1;return}var E=!1;s.isVirtualizationEnabled&&s.setCurrentView&&(E=!0,s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"})),s.keyboardEvent!=null&&s.handleVirtualKeyboardActions(s.keyboardEvent,s.pageCount);var A=s.getModuleName()!=="multiselect"||s.getModuleName()==="multiselect"&&(!(s.dataSource instanceof oe)||s.dataSource instanceof oe&&!E);s.isVirtualizationEnabled&&A&&(s.getFilteringSkeletonCount(),s.updatePopupPosition()),s.virtualSelectAll&&s.virtualSelectAllData&&(s.virtualSelectionAll(s.virtualSelectAllState,s.liCollections,s.CurrentEvent),s.virtualSelectAllState=!1,s.CurrentEvent=null,s.virtualSelectAll=!1)}})}).catch(function(S){s.isRequested=!1,s.isRequesting=!1,s.onActionFailure(S),s.hideSpinner()})}else{s.isRequesting=!1;var d=!0,p=void 0;if(s.isVirtualizationEnabled&&!s.virtualGroupDataSource&&s.fields.groupBy){var f=new oe(s.dataSource).executeLocal(new Pe().group(s.fields.groupBy));s.virtualGroupDataSource=f.records}var v=s.isVirtualizationEnabled&&s.virtualGroupDataSource&&!s.isCustomDataUpdated?new oe(s.virtualGroupDataSource):new oe(h.data);if(p=s.getQuery(h.query).executeLocal(v),!s.virtualSelectAll){var m=s.getQuery(h.query);if(s.isVirtualizationEnabled&&p.count!==0&&p.count<s.itemCount*2&&!s.appendUncheckList){if(m){for(var y=0;y<m.queries.length;y++){if(s.getModuleName()==="multiselect"&&s.isCheckBoxSelection&&m.queries[y].e&&(m.queries[y].e.operator==="notequal"||m.queries[y].e.operator==="equal"||m.queries[y].e.condition==="or"||m.queries[y].e.condition==="and")&&!s.isCustomFiltering){d=!1;break}m.queries[y].fn==="onTake"&&(m.queries[y].e.nos=p.count,p=m.executeLocal(v)),s.getModuleName()==="multiselect"&&(m.queries[y].e.condition==="or"||m.queries[y].e.operator==="equal")&&!s.isCustomFiltering&&(d=!1)}d&&(p=m.executeLocal(v),s.isVirtualTrackHeight=!(s.dataSource instanceof oe)&&!s.isCustomDataUpdated)}}else if(s.isVirtualTrackHeight=!1,m)for(var y=0;y<m.queries.length;y++)s.getModuleName()==="multiselect"&&(m.queries[y].e&&m.queries[y].e.condition==="or"||m.queries[y].e&&m.queries[y].e.operator==="equal")&&(d=!1)}d&&!(s.dataSource instanceof oe)&&!s.isCustomDataUpdated&&!s.virtualSelectAll&&(s.dataCount=s.totalItemCount=s.virtualSelectAll?p.length:p.count),p=s.isVirtualizationEnabled?p.result:p;var b={cancel:!1,result:p};s.isPreventChange=s.isAngular&&s.preventChange?!0:s.isPreventChange,s.trigger("actionComplete",b,function(S){if(s.isCustomFiltering=!1,s.isIncrementalRequest){a=s.renderItems(S.result,i);return}if(!S.cancel){if(a=s.renderItems(S.result,i),s.isUpdateGroupTemplate=!1,s.onActionComplete(a,S.result,n),s.groupTemplate&&(s.isAngular&&s.getModuleName()==="multiselect"&&s.updateGroupHeaderItems(a),s.renderGroupTemplate(a)),s.isUpdateGroupTemplate=!0,s.bindChildItems(S.result,a,i),s.getInitialData){s.getInitialData=!1,s.preventPopupOpen=!1;return}setTimeout(function(){s.getModuleName()==="multiselect"&&s.itemTemplate!=null&&a.childElementCount>0&&(a.children[0].childElementCount>0||s.fields.groupBy&&a.children[1]&&a.children[1].childElementCount>0)&&s.updateDataList()})}})}})},t.prototype.updateGroupHeaderItems=function(e){for(var i=e.querySelectorAll("."+de.group),r=[],n=0;n<i.length;n++)r.push(i[n].cloneNode?i[n].cloneNode(!0):i[n]);this.isFilterAction?this.fiteredGroupHeaderItems=r:this.groupHeaderItems=r},t.prototype.setCustomListData=function(e,i,r,n){var s=this;i=i||this.fields;var a;if(this.isActive=!0,this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,!this.isRequesting){this.isRequesting=!0,this.showSpinner(),this.isRequesting=!1;var l=!0,h=void 0;if(this.isVirtualizationEnabled&&!this.virtualGroupDataSource&&this.fields.groupBy){var c=new oe(this.dataSource).executeLocal(new Pe().group(this.fields.groupBy));this.virtualGroupDataSource=c.records}var u=this.isVirtualizationEnabled&&this.virtualGroupDataSource&&!this.isCustomDataUpdated?new oe(this.virtualGroupDataSource):new oe(e);if(h=this.getQuery(r).executeLocal(u),!this.virtualSelectAll){var d=this.getQuery(r);if(this.isVirtualizationEnabled&&h.count!==0&&h.count<this.itemCount*2&&!this.appendUncheckList){if(d){for(var p=0;p<d.queries.length;p++)d.queries[p].fn==="onTake"&&(d.queries[p].e.nos=h.count,h=d.executeLocal(u)),this.getModuleName()==="multiselect"&&(d.queries[p].e.condition==="or"||d.queries[p].e.operator==="equal")&&!this.isCustomFiltering&&(l=!1);l&&(h=d.executeLocal(u),this.isVirtualTrackHeight=!(this.dataSource instanceof oe)&&!this.isCustomDataUpdated)}}else if(this.isVirtualTrackHeight=!1,d)for(var p=0;p<d.queries.length;p++)this.getModuleName()==="multiselect"&&(d.queries[p].e&&d.queries[p].e.condition==="or"||d.queries[p].e&&d.queries[p].e.operator==="equal")&&(l=!1)}if(l&&!(this.dataSource instanceof oe)&&!this.isCustomDataUpdated&&!this.virtualSelectAll&&(this.dataCount=this.totalItemCount=this.virtualSelectAll?h.length:h.count),h=this.isVirtualizationEnabled?h.result:h,this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.isCustomFiltering=!1,this.isIncrementalRequest){a=this.renderItems(h,i);return}a=this.renderItems(h,i),this.onActionComplete(a,h,n),this.groupTemplate&&this.renderGroupTemplate(a),this.bindChildItems(h,a,i),setTimeout(function(){s.getModuleName()==="multiselect"&&s.itemTemplate!=null&&a.childElementCount>0&&(a.children[0].childElementCount>0||s.fields.groupBy&&a.children[1]&&a.children[1].childElementCount>0)&&s.updateDataList()})}},t.prototype.handleVirtualKeyboardActions=function(e,i){},t.prototype.updatePopupState=function(){},t.prototype.updatePopupPosition=function(){},t.prototype.virtualSelectionAll=function(e,i,r){},t.prototype.updateRemoteData=function(){this.setListData(this.dataSource,this.fields,this.query)},t.prototype.bindChildItems=function(e,i,r,n){var s=this;e.length>=100&&this.getModuleName()==="autocomplete"?setTimeout(function(){var a=s.remainingItems(s.sortedData,r);bt(a,i),s.liCollections=s.list.querySelectorAll("."+de.li),s.updateListValues(),s.raiseDataBound(e,n)},0):this.raiseDataBound(e,n)},t.prototype.isObjectInArray=function(e,i){return i.some(function(r){return Object.keys(e).every(function(n){return Object.prototype.hasOwnProperty.call(r,n)&&r[n]===e[n]})})},t.prototype.updateListValues=function(){},t.prototype.findListElement=function(e,i,r,n){var s=null;if(e){for(var a=[].slice.call(e.querySelectorAll(i)),l=0;l<a.length;l++)if(a[l].getAttribute(r)===n+""){s=a[l];break}}return s},t.prototype.raiseDataBound=function(e,i){this.hideSpinner();var r={items:e,e:i};this.trigger("dataBound",r)},t.prototype.remainingItems=function(e,i){var r=new oe(e).executeLocal(new Pe().skip(100));if(this.itemTemplate){var n=this.templateListItem(r,i);return[].slice.call(n.childNodes)}var s=this.typeOfData(r).typeof;return s==="string"||s==="number"||s==="boolean"?kt.createListItemFromArray(this.createElement,r,!0,this.listOption(r,i),this):kt.createListItemFromJson(this.createElement,r,this.listOption(r,i),1,!0,this)},t.prototype.emptyDataRequest=function(e){var i=[];this.onActionComplete(this.renderItems(i,e),i),this.isRequested=!1,this.isRequesting=!1,this.hideSpinner()},t.prototype.showSpinner=function(){},t.prototype.hideSpinner=function(){},t.prototype.onActionFailure=function(e){this.liCollections=[],this.trigger("actionFailure",e),this.l10nUpdate(!0),g(this.list)||X([this.list],de.noData)},t.prototype.onActionComplete=function(e,i,r){var n=this;if(this.listData=i,this.isVirtualizationEnabled&&!this.isCustomDataUpdated&&!this.virtualSelectAll&&this.notify("setGeneratedData",{module:"VirtualScroll"}),this.getModuleName()!=="listbox"&&e.setAttribute("tabindex","0"),this.isReact&&this.clearTemplate(["itemTemplate","groupTemplate","actionFailureTemplate","noRecordsTemplate"]),this.isVirtualizationEnabled||(this.fixedHeaderElement=g(this.fixedHeaderElement)?this.fixedHeaderElement:null),this.getModuleName()==="multiselect"&&this.properties.allowCustomValue&&this.fields.groupBy)for(var s=0;s<e.childElementCount;s++)e.children[s].classList.contains("e-list-group-item")&&(g(e.children[s].innerHTML)||e.children[s].innerHTML==="")&&X([e.children[s]],f5),e.children[0].classList.contains("e-hide-group-header")&&Ze(e.children[1],{zIndex:11});if(this.getModuleName()==="multiselect"&&this.isAngular&&this.ngEle){var a=this.list;if(a){var l=a.offsetHeight+"px";a.style.height=l}}if(!g(this.list)&&!this.isVirtualizationEnabled){if(this.list.innerHTML="",this.isUpdateGroupTemplate&&this.isAngular&&this.groupTemplate&&this.getModuleName()==="multiselect"){var h=e.querySelectorAll("."+de.group);if(h.length>0&&this.groupHeaderItems.length>0){for(var c={},s=0;s<this.groupHeaderItems.length;s++)c[this.groupHeaderItems[s].id]=this.groupHeaderItems[s].innerHTML;for(var s=0;s<h.length;s++)Object.prototype.hasOwnProperty.call(c,h[s].id)&&(h[s].innerHTML=c[h[s].id])}this.renderGroupTemplate(e)}this.list.appendChild(e),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,i,this.bindEvent)}if(this.getModuleName()==="multiselect"&&this.isAngular&&this.ngEle){var u=this.list;u&&setTimeout(function(){u.style.height="",n.refreshPopup()},0)}},t.prototype.postRender=function(e,i,r){if(this.fields.disabled){for(var n=e.querySelectorAll("."+de.li),s=this.sortOrder!=="None"?g(this.fields.groupBy)?this.sortedData:this.sortedData.filter(function(f){return!("isHeader"in f)||f.isHeader!==!0}):this.listData,a=0;a<n.length;a++)if(s[a]&&JSON.parse(JSON.stringify(s[a]))[this.fields.disabled])if(g(this.fields.groupBy))this.disableListItem(n[a]);else{var l=s[a],h=V(this.fields.value?this.fields.value:"value",l),c=e.querySelector('li[data-value="'+h+'"]');g(c)||this.disableListItem(c)}}var u=this.fields.disabled?e.querySelector("."+de.li+":not(.e-disabled"):e.querySelector("."+de.li),d=e.querySelector("."+de.selected);if(u&&!d){if(this.isVirtualizationEnabled&&this.viewPortInfo.startIndex!==0){var p=this.ulElement.querySelectorAll("li."+de.li+":not(.e-virtual-list):not(.e-hide-listitem)");u=p&&p.length>0?p[2]:u}u&&u.classList.add(de.focus)}i.length<=0?(this.l10nUpdate(),X([e],de.noData)):e.classList.remove(de.noData)},t.prototype.getQuery=function(e){return e||(this.query?this.query:new Pe)},t.prototype.performFiltering=function(e){},t.prototype.debouncedFiltering=function(e,i){var r=this;this.debounceTimer!==null&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){r.performFiltering(e)},i)},t.prototype.updateVirtualizationProperties=function(e,i,r){this.isVirtualizationEnabled=!0,this.virtualizedItemsCount=e,this.isAllowFiltering=i,this.isCheckBoxSelection=r},t.prototype.renderGroupTemplate=function(e){if(this.fields.groupBy!==null&&this.dataSource||this.element.querySelector("."+de.group)){var i=this.dataSource,r={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},n=this.isAngular&&this.getModuleName()==="multiselect"&&!g(e)&&e.classList.contains(de.fixedHead)?[e]:e.querySelectorAll("."+de.group),s=this.templateCompiler(this.groupTemplate);if(typeof this.groupTemplate!="function"&&s){var a=J(this.groupTemplate,document).innerHTML.trim(),l=kt.renderGroupTemplate(a,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}else{var l=kt.renderGroupTemplate(this.groupTemplate,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var h=0;h<l.length;h++)this.notify("addItem",{module:"CheckBoxSelection",item:l[h]})}this.renderReactTemplates()}},t.prototype.createListItems=function(e,i){if(e){if(i.groupBy||this.element.querySelector("optgroup")){if(i.groupBy){this.sortOrder!=="None"&&(e=this.getSortedDataSource(e));var r=i.properties||i;e=kt.groupDataSource(e,r,this.sortOrder)}X([this.list],de.grouping)}else(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(e=this.getSortedDataSource(e));var n=this.listOption(e,i),s=e.length>100?new oe(e).executeLocal(new Pe().take(100)):e;return this.sortedData=e,kt.createList(this.createElement,this.getModuleName()==="autocomplete"?s:e,n,!0,this)}return null},t.prototype.listOption=function(e,i){var r=!g(i.iconCss),n=g(i.properties)?i:i.properties,s=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}};return pe({},s,i,!0)},t.prototype.setFloatingHeader=function(e){!g(this.list)&&!this.list.classList.contains(de.noData)&&(g(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:de.fixedHead}),!g(this.list)&&!this.list.querySelector("li").classList.contains(de.group)&&(this.fixedHeaderElement.style.display="none"),!g(this.fixedHeaderElement)&&!g(this.list)&&$r([this.fixedHeaderElement],this.list),this.setFixedHeader()),!g(this.fixedHeaderElement)&&this.fixedHeaderElement.style.zIndex==="0"&&this.setFixedHeader(),this.scrollStop(e))},t.prototype.scrollStop=function(e,i){for(var r=g(e)?this.list:e.target,n=getComputedStyle(this.getValidLi(),null).getPropertyValue("height"),s=getComputedStyle(this.getValidLi(),null).getPropertyValue("margin-bottom"),a=parseInt(s,10),l=this.getModuleName()==="multiselect"?parseFloat(n):parseInt(n,10),h=Math.round(r.scrollTop/(l+a)),c=this.list.querySelectorAll("li:not(.e-hide-listitem)"),u=this.list.querySelectorAll(".e-virtual-list").length,d=h;d>-1;d--){var p=this.isVirtualizationEnabled?d+u:d;if(this.isVirtualizationEnabled){if(this.fixedHeaderElement&&this.updateGroupHeader(p,c,r))break;i&&(!g(c[p])&&c[p].classList.contains(de.selected)&&this.getModuleName()!=="autocomplete"||!g(c[p])&&c[p].classList.contains(de.focus)&&this.getModuleName())}else if(this.updateGroupHeader(p,c,r))break}},t.prototype.getPageCount=function(e){if(this.list){var i=this.list.classList.contains(de.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height"),r=Math.round(this.list.getBoundingClientRect().height/parseInt(i,10));return e?r:Math.round(r)}else return 0},t.prototype.updateGroupHeader=function(e,i,r){return!g(i[e])&&i[e].classList.contains(de.group)?(this.updateGroupFixedHeader(i[e],r),!0):(this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none",!1)},t.prototype.updateFixedGroupTemplateHader=function(e){var i=e.cloneNode?e.cloneNode(!0):e,r=!1;if(this.groupHeaderItems&&this.groupHeaderItems.length>0){for(var n=0;n<this.groupHeaderItems.length;n++)if(i.id===this.groupHeaderItems[n].id){i.innerHTML=this.groupHeaderItems[n].innerHTML,r=!0;break}}if(!r&&this.fiteredGroupHeaderItems&&this.fiteredGroupHeaderItems.length>0){for(var n=0;n<this.fiteredGroupHeaderItems.length;n++)if(i.id===this.fiteredGroupHeaderItems[n].id){i.innerHTML=this.fiteredGroupHeaderItems[n].innerHTML;break}}this.fixedHeaderElement.innerHTML=i.innerHTML,this.renderGroupTemplate(this.fixedHeaderElement)},t.prototype.updateGroupFixedHeader=function(e,i){this.fixedHeaderElement&&this.list&&this.list.parentElement&&(g(e.innerHTML)||(this.groupTemplate&&this.isAngular&&this.getModuleName()==="multiselect"?this.updateFixedGroupTemplateHader(e):this.fixedHeaderElement.innerHTML=e.innerHTML),this.fixedHeaderElement.style.position="fixed",this.fixedHeaderElement.style.top=this.list.parentElement.offsetTop+this.list.offsetTop-window.scrollY+"px",this.fixedHeaderElement.style.display="block")},t.prototype.getValidLi=function(){return this.isVirtualizationEnabled?this.liCollections[0].classList.contains("e-virtual-list")?this.liCollections[this.skeletonCount]:this.liCollections[0]:this.liCollections[0]},t.prototype.renderItems=function(e,i,r,n){var s;if(this.itemTemplate&&e){this.getModuleName()==="multiselect"&&this.virtualSelectAll&&(this.virtualSelectAllData=e,e=e.slice(this.virtualItemStartIndex,this.virtualItemEndIndex));var a=e;a&&i.groupBy?(this.sortOrder!=="None"&&(a=this.getSortedDataSource(a)),a=kt.groupDataSource(a,i.properties,this.sortOrder)):(this.getModuleName()!=="listbox"||this.getModuleName()==="listbox"&&!this.preventDefActionFilter)&&(a=this.getSortedDataSource(a)),this.sortedData=a;var l=a.length>100?new oe(a).executeLocal(new Pe().take(100)):a;if(s=this.templateListItem(this.getModuleName()==="autocomplete"?l:a,i),this.isIncrementalRequest)return this.incrementalLiCollections=s.querySelectorAll("."+de.li),this.incrementalUlElement=s,this.incrementalListData=e,s;if(this.isVirtualizationEnabled){var h=this.list.querySelector(".e-list-parent"),c=this.list.querySelector(".e-virtual-ddl-content");if(e.length>=this.virtualizedItemsCount&&h&&c||h&&c&&this.isAllowFiltering||h&&c&&this.getModuleName()==="autocomplete"){this.getModuleName()==="multiselect"&&this.isCheckBoxSelection&&this.appendUncheckList&&this.list&&this.list.querySelector(".e-active")?(c.appendChild(s),r=!0):c.replaceChild(s,h);var u=this.list.querySelectorAll(".e-reorder");this.list.querySelector(".e-virtual-ddl-content")&&u&&u.length>0&&!r&&this.list.querySelector(".e-virtual-ddl-content").removeChild(u[0]),this.updateListElements(e)}else c||(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(s),this.updateListElements(e))}}else{if(this.getModuleName()==="multiselect"&&this.virtualSelectAll&&!n&&(this.virtualSelectAllData=e,e=e.slice(this.virtualItemStartIndex,this.virtualItemEndIndex)),s=this.createListItems(e,i),this.isIncrementalRequest)return this.incrementalLiCollections=s.querySelectorAll("."+de.li),this.incrementalUlElement=s,this.incrementalListData=e,s;if(this.isVirtualizationEnabled){var h=this.list.querySelector(".e-list-parent:not(.e-reorder)"),c=this.list.querySelector(".e-virtual-ddl-content"),d=!1;(!h&&this.list.querySelector(".e-list-parent.e-reorder")||h&&this.isVirtualReorder&&this.list.querySelector(".e-list-parent.e-reorder"))&&(h=this.list.querySelector(".e-list-parent.e-reorder")),e.length>=this.virtualizedItemsCount&&h&&c||h&&c&&this.isAllowFiltering||h&&c&&(this.getModuleName()==="autocomplete"||this.getModuleName()==="multiselect")||d?((this.getModuleName()!=="multiselect"||this.getModuleName()==="multiselect"&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&!this.setCurrentView))&&(this.appendUncheckList?c.appendChild(s):c.replaceChild(s,h)),this.updateListElements(e)):(!c||!c.firstChild)&&(this.list.innerHTML="",this.createVirtualContent(),this.list.querySelector(".e-virtual-ddl-content").appendChild(s),this.updateListElements(e))}}return s},t.prototype.createVirtualContent=function(){this.list.querySelector(".e-virtual-ddl-content")||this.list.appendChild(this.createElement("div",{className:"e-virtual-ddl-content"}))},t.prototype.updateListElements=function(e){this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul"),this.listData=e,this.postRender(this.list,e,this.bindEvent)},t.prototype.templateListItem=function(e,i){var r=this.listOption(e,i);r.templateID=this.itemTemplateId,r.isStringTemplate=this.isStringTemplate;var n=this.templateCompiler(this.itemTemplate),s;if(typeof this.itemTemplate!="function"&&n){var a=J(this.itemTemplate,document).innerHTML.trim();return s=kt.renderContentTemplate(this.createElement,a,e,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),s}else return s=kt.renderContentTemplate(this.createElement,this.itemTemplate,e,i.properties,r,this),this.isVirtualizationEnabled&&this.isReact&&this.renderReactTemplates(),s},t.prototype.typeOfData=function(e){for(var i={typeof:null,item:null},r=0;!g(e)&&r<e.length;r++)if(!g(e[r])){var n=typeof e[r]=="string"||typeof e[r]=="number"||typeof e[r]=="boolean",s=n?g(e[r]):g(V(this.fields.value?this.fields.value:"value",e[r]));if(!s)return i={typeof:typeof e[r],item:e[r]}}return i},t.prototype.setFixedHeader=function(){g(this.list)||(this.list.parentElement.style.display="block");var e=0;if(this.list&&this.list.parentElement&&(e=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10),isNaN(e))){var i=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-top-width"),10),r=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-bottom-width"),10),n=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-left-width"),10),s=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-right-width"),10);e=i+r+n+s}if(!g(this.liCollections)){var a=this.getValidLi().offsetWidth-e;this.fixedHeaderElement.style.width=a.toString()+"px"}Ze(this.fixedHeaderElement,{zIndex:10});var l=this.ulElement.querySelector("."+de.group+":not(.e-hide-listitem)");g(l)||(this.groupTemplate&&this.isAngular&&this.getModuleName()==="multiselect"?this.updateFixedGroupTemplateHader(l):this.fixedHeaderElement.innerHTML=l.innerHTML)},t.prototype.getSortedDataSource=function(e){if(e&&this.sortOrder!=="None"){var i=this.fields.text?this.fields.text:"text";(this.typeOfData(e).typeof==="string"||this.typeOfData(e).typeof==="number"||this.typeOfData(e).typeof==="boolean")&&(i=""),e=kt.getDataSource(e,kt.addSorting(this.sortOrder,i))}return e},t.prototype.getIndexByValue=function(e){var i,r=[];this.fields.disabled&&this.getModuleName()==="multiselect"&&this.liCollections?r=this.liCollections:r=this.getItems();for(var n=0;n<r.length;n++)if(!g(e)&&r[n].getAttribute("data-value")===e.toString()){i=n;break}return i},t.prototype.getIndexByValueFilter=function(e,i){var r;if(!i)return null;var n=i.querySelectorAll("li:not(.e-list-group-item)");if(n){for(var s=0;s<n.length;s++)if(!g(e)&&n[s].getAttribute("data-value")===e.toString()){r=s;break}}return r},t.prototype.dispatchEvent=function(e,i){var r=document.createEvent("HTMLEvents");r.initEvent(i,!1,!0),e&&e.dispatchEvent(r)},t.prototype.setFields=function(){this.fields.value&&!this.fields.text?this.updateFields(this.fields.value,this.fields.value):!this.fields.value&&this.fields.text?this.updateFields(this.fields.text,this.fields.text):!this.fields.value&&!this.fields.text&&(this.isPrimitiveData=!0,this.updateFields("text","text"))},t.prototype.resetList=function(e,i,r,n){if(this.list){if(this.element.tagName==="SELECT"&&this.element.options.length>0||this.element.tagName==="UL"&&this.element.childNodes.length>0){var s=e instanceof Array?e.length>0:!g(e);!s&&this.selectData&&this.selectData.length>0&&(e=this.selectData)}e=this.getModuleName()==="combobox"&&this.selectData&&e instanceof Array&&e.length<this.selectData.length&&this.addedNewItem?this.selectData:e,this.addedNewItem=!1,this.isCustomReset&&this.getModuleName()==="multiselect"?this.setCustomListData(e,i,r,n):this.setListData(e,i,r,n)}},t.prototype.updateSelectElementData=function(e){(e||this.isVirtualizationEnabled)&&g(this.selectData)&&this.listData&&this.listData.length>0&&(this.selectData=this.listData)},t.prototype.updateSelection=function(){},t.prototype.renderList=function(){this.render()},t.prototype.updateDataSource=function(e,i){this.resetList(this.dataSource),this.totalItemCount=this.dataSource instanceof oe?this.dataSource.dataSource.json.length:0},t.prototype.setUpdateInitial=function(e,i,r){this.isDataFetched=!1,this.isPrimitiveData=!1;for(var n={},s=0;e.length>s;s++)i[e[s]]&&e[s]==="fields"?(this.setFields(),n[e[s]]=i[e[s]]):i[e[s]]&&(n[e[s]]=i[e[s]]);Object.keys(n).length>0&&(Object.keys(n).indexOf("dataSource")===-1&&(n.dataSource=this.dataSource),this.getModuleName()==="listbox"?(!this.isReact||this.isReact&&(!g(i.dataSource)||!g(i.sortOrder)))&&this.updateDataSource(n,r):(this.isDynamicData=!0,this.updateDataSource(n,r)))},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="dropdownbase"&&this.setUpdateInitial(["fields","query","dataSource"],e),this.setUpdateInitial(["sortOrder","itemTemplate"],e);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){var a=this.ulElement.querySelector("."+de.group);this.fixedHeaderElement.innerHTML=a.innerHTML}break;case"locale":this.list&&!g(this.liCollections)&&this.liCollections.length===0&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break}}},t.prototype.render=function(e,i){this.getModuleName()==="listbox"?this.list=this.createElement("div",{className:de.content,attrs:{tabindex:"0"}}):this.list=this.createElement("div",{className:de.content}),this.list.classList.add(de.root),this.setFields();var r={duration:300,selector:"."+de.li};this.rippleFun=Wi(this.list,r);var n=this.element.querySelector("select>optgroup");if((this.fields.groupBy||!g(n))&&!this.isGroupChecking){T.add(this.list,"scroll",this.setFloatingHeader,this);for(var s=this.getScrollableParent(),a=0;a<s.length;a++){var l=s[a];T.add(l,"scroll",this.updateGroupFixedHeader,this)}}if(this.getModuleName()==="dropdownbase"){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),Z([this.element],de.root),this.element.style.display="none";var h=this.createElement("div");this.element.parentElement.insertBefore(h,this.element),h.appendChild(this.element),h.appendChild(this.list)}this.setEnableRtl(),i||this.initialize(e)},t.prototype.getScrollableParent=function(){for(var e=getComputedStyle(this.element),i=[],r=/(auto|scroll)/,n=this.element.parentElement;n&&n.tagName!=="HTML";){var s=getComputedStyle(n);!(e.position==="absolute"&&s.position==="static")&&r.test(s.overflow+s.overflowY+s.overflowX)&&i.push(n),n=n.parentElement}return i.push(document),i},t.prototype.removeScrollEvent=function(){this.list&&T.remove(this.list,"scroll",this.setFloatingHeader)},t.prototype.getModuleName=function(){return"dropdownbase"},t.prototype.getItems=function(){return this.ulElement.querySelectorAll("."+de.li)},t.prototype.addItem=function(e,i){if((!this.list||this.list.textContent===this.noRecordsTemplate&&this.getModuleName()!=="listbox")&&this.renderList(),this.sortOrder!=="None"&&g(i)){var r=[].slice.call(this.listData);r.push(e),r=this.getSortedDataSource(r),this.fields.groupBy&&(r=kt.groupDataSource(r,this.fields.properties,this.sortOrder)),i=r.indexOf(e)}var n=this.getItems().length,s=n===0,a=this.list.querySelector("."+de.selected);e=e instanceof Array?e:[e];var l;l=g(i)||i<0||i>n-1?n:i;var h=this.fields;e&&h.groupBy&&(e=kt.groupDataSource(e,h.properties));for(var c=[],u=0;u<e.length;u++){var d=e[u],p=d.isHeader,f=this.createElement("li",{className:p?de.group:de.li,id:"option-add-"+u}),v=d instanceof Object?V(h.text,d):d;if(p&&(f.innerText=v),this.itemTemplate&&!p){var m=this.templateCompiler(this.itemTemplate),y=typeof this.itemTemplate!="function"&&m?Et(J(this.itemTemplate,document).innerHTML.trim()):Et(this.itemTemplate),b=y(d,this,"itemTemplate",this.itemTemplateId,this.isStringTemplate,null,f);b&&bt(b,f)}else p||f.appendChild(document.createTextNode(v));f.setAttribute("data-value",d instanceof Object?V(h.value,d):d),f.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:f}),c.push(f),this.getModuleName()==="listbox"?(this.listData.splice(s?this.listData.length:l,0,d),this.listData.length!==this.sortedData.length&&(this.sortedData=this.listData)):this.listData.push(d),this.sortOrder==="None"&&g(i)&&l===0&&(l=null),this.getModuleName()==="listbox"?this.updateActionCompleteData(f,d,s?null:l+u):this.updateActionCompleteData(f,d,l),this.trigger("beforeItemRender",{element:f,item:d})}if(n===0&&g(this.list.querySelector("ul")))g(this.list)||(this.list.innerHTML="",this.list.classList.remove(de.noData),this.isAddNewItemTemplate=!0,g(this.ulElement)||this.list.appendChild(this.ulElement)),this.liCollections=c,!g(c)&&!g(this.ulElement)&&bt(c,this.ulElement),this.updateAddItemList(this.list,n);else{this.getModuleName()==="listbox"&&n===0&&(this.ulElement.innerHTML="");for(var S=[],u=0;u<e.length;u++){for(var C=this.ulElement.querySelectorAll(".e-list-group-item"),x=0;x<C.length;x++)S[x]=C[x].innerText;if(S.indexOf(c[u].innerText)>-1&&h.groupBy){for(var x=0;x<C.length;x++)if(S[x]===c[u].innerText){this.sortOrder==="None"?this.ulElement.insertBefore(c[u+1],C[x+1]):this.ulElement.insertBefore(c[u+1],this.ulElement.childNodes[i]),u=u+1;break}}else this.liCollections[l]&&this.liCollections[l].parentNode?this.liCollections[l].parentNode.insertBefore(c[u],this.liCollections[l]):i&&this.getModuleName()==="listbox"?this.ulElement.insertBefore(c[u],this.ulElement.childNodes[i+u]):this.ulElement.appendChild(c[u]);var I=[].slice.call(this.liCollections);I.splice(l,0,c[u]),this.liCollections=I,l+=1,this.getModuleName()==="multiselect"&&this.updateDataList()}}this.getModuleName()==="listbox"&&this.isReact&&this.renderReactTemplates(),(a||i===0)&&this.updateSelection(),this.addedNewItem=!0},t.prototype.isDisabledElement=function(e){return!!(e&&e.classList.contains("e-disabled"))},t.prototype.isDisabledItemByIndex=function(e){return this.fields.disabled&&this.liCollections?this.isDisabledElement(this.liCollections[e]):!1},t.prototype.disableListItem=function(e){e.classList.add("e-disabled"),e.setAttribute("aria-disabled","true"),e.setAttribute("aria-selected","false")},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(e.getAttribute(n[s])){var a=e.getAttribute(n[s]);i.setAttribute(n[s],a),e.removeAttribute(n[s])}},t.prototype.setZIndex=function(){},t.prototype.updateActionCompleteData=function(e,i,r){},t.prototype.updateAddItemList=function(e,i){},t.prototype.updateDataList=function(){},t.prototype.getDataByValue=function(e){if(!g(this.listData)){var i=this.typeOfData(this.listData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.listData;r<n.length;r++){var s=n[r];if(!g(s)&&s===e)return s}else for(var a=0,l=this.listData;a<l.length;a++){var s=l[a];if(!g(s)&&V(this.fields.value?this.fields.value:"value",s)===e)return s}}return null},t.prototype.destroy=function(){if(document){if(this.fields&&this.fields.groupBy)for(var e=this.getScrollableParent(),i=0;i<e.length;i++){var r=e[i];T.remove(r,"scroll",this.updateGroupFixedHeader)}document.body.contains(this.list)&&(T.remove(this.list,"scroll",this.setFloatingHeader),g(this.rippleFun)||this.rippleFun(),se(this.list))}this.liCollections=null,this.ulElement=null,this.list=null,this.enableRtlElements=null,this.groupHeaderItems=null,this.fiteredGroupHeaderItems=null,this.rippleFun=null,o.prototype.destroy.call(this)},or([Ce({text:null,value:null,iconCss:null,groupBy:null,disabled:null},NI)],t.prototype,"fields",void 0),or([w(null)],t.prototype,"itemTemplate",void 0),or([w(null)],t.prototype,"groupTemplate",void 0),or([w("No records found")],t.prototype,"noRecordsTemplate",void 0),or([w("Request failed")],t.prototype,"actionFailureTemplate",void 0),or([w("None")],t.prototype,"sortOrder",void 0),or([w([])],t.prototype,"dataSource",void 0),or([w(null)],t.prototype,"query",void 0),or([w("StartsWith")],t.prototype,"filterType",void 0),or([w(!0)],t.prototype,"ignoreCase",void 0),or([w(1e3)],t.prototype,"zIndex",void 0),or([w(!1)],t.prototype,"ignoreAccent",void 0),or([w()],t.prototype,"locale",void 0),or([G()],t.prototype,"actionBegin",void 0),or([G()],t.prototype,"actionComplete",void 0),or([G()],t.prototype,"actionFailure",void 0),or([G()],t.prototype,"select",void 0),or([G()],t.prototype,"dataBound",void 0),or([G()],t.prototype,"created",void 0),or([G()],t.prototype,"destroyed",void 0),t=or([It],t),t})(ti),g5=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),vi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Je={root:"e-dropdownlist",hover:de.hover,selected:de.selected,rtl:de.rtl,li:de.li,disable:de.disabled,base:de.root,focus:de.focus,content:de.content,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",resizeIcon:"e-resizer-right e-icons",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden",virtualList:"e-list-item e-virtual-list"},v5={container:null,buttons:[]},$s=(function(o){g5(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isListSearched=!1,r.preventChange=!1,r.isTouched=!1,r.isFocused=!1,r.autoFill=!1,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isReactTemplateUpdate=!1,r}return t.prototype.preRender=function(){this.valueTempElement=null,this.element.style.opacity="0",this.initializeData(),o.prototype.preRender.call(this),this.activeIndex=this.index,this.queryString=""},t.prototype.initializeData=function(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isPopupRender=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initialRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.actionData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.previousValue=null,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},t.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},t.prototype.requiredModules=function(){var e=[];return this.enableVirtualization&&e.push({args:[this],member:"VirtualScroll"}),e},t.prototype.renderList=function(e,i){o.prototype.render.call(this,e,i),this.dataSource instanceof oe||(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0),this.enableVirtualization&&this.isFiltering()&&this.getModuleName()==="combobox"&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul")),this.unWireListEvents(),this.wireListEvents()},t.prototype.floatLabelChange=function(){if(this.getModuleName()==="dropdownlist"&&this.floatLabelType==="Auto"){var e=this.inputWrapper.container.querySelector(".e-float-text");e&&this.inputElement.value!==""||this.isInteracted?Ai(e,["e-label-top"],["e-label-bottom"]):e&&Ai(e,["e-label-bottom"],["e-label-top"])}},t.prototype.resetHandler=function(e){e.preventDefault(),this.clearAll(e),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=0)},t.prototype.resetFocusElement=function(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,this.getModuleName()!=="autocomplete"&&!g(this.ulElement)){var e=this.fields.disabled?this.ulElement.querySelector("."+Je.li+":not(.e-disabled)"):this.ulElement.querySelector("."+Je.li);this.enableVirtualization&&(e=this.liCollections[this.skeletonCount]),e&&e.classList.add(Je.focus)}},t.prototype.clearAll=function(e,i){this.previousItemData=g(this.itemData)?null:this.itemData,(g(i)||!g(i)&&(g(i.dataSource)||!(i.dataSource instanceof oe)&&i.dataSource.length===0))&&(this.isActive=!0,this.resetSelection(i));var r=this.getItemData();if(!this.allowObjectBinding&&this.previousValue===r.value||this.allowObjectBinding&&this.previousValue&&this.isObjectInArray(this.previousValue,[this.allowCustom?this.value?this.value:r:r.value?this.getDataByValue(r.value):r])){this.checkAndResetCache(),this.enableVirtualization&&this.list&&this.updateInitialData();return}this.onChangeEvent(e),this.checkAndResetCache(),this.enableVirtualization&&this.updateInitialData()},t.prototype.resetSelection=function(e){this.list&&(!g(e)&&(g(e.dataSource)||!(e.dataSource instanceof oe)&&e.dataSource.length===0)?(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(e.dataSource)):(this.allowFiltering&&this.getModuleName()!=="autocomplete"&&!g(this.actionCompleteData.ulElement)&&!g(this.actionCompleteData.list)&&this.actionCompleteData.list.length>0&&this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement())),g(this.hiddenElement)||(this.hiddenElement.innerHTML=""),g(this.inputElement)||(this.inputElement.value=""),this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&(se(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()},t.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&X([this.inputWrapper.container],n.split(" "))}else if(r==="disabled"&&this.htmlAttributes[""+r]==="disabled")this.enabled=!1,this.setEnable();else if(r==="readonly"&&!g(this.htmlAttributes[""+r]))this.readonly=!0,this.dataBind();else if(r==="style")this.inputWrapper.container.setAttribute("style",this.htmlAttributes[""+r]);else if(r==="aria-label")(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.setAttribute("aria-label",this.htmlAttributes[""+r]):this.getModuleName()==="dropdownlist"&&this.inputWrapper.container.setAttribute("aria-label",this.htmlAttributes[""+r]);else{var s=["title","id","placeholder","role","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],a=["name","required"];(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&s.push("tabindex"),a.indexOf(r)>-1||r.indexOf("data")===0?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):s.indexOf(r)>-1?r==="placeholder"&&this.element.getAttribute("placeholder")!==this.htmlAttributes[""+r]?Ie.setPlaceholder(this.htmlAttributes[""+r],this.inputElement):r!=="placeholder"&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r]):this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}}(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&this.inputWrapper.container.removeAttribute("tabindex")},t.prototype.getAriaAttributes=function(){return{"aria-disabled":"false",role:"combobox","aria-expanded":"false","aria-live":"polite","aria-labelledby":this.hiddenElement.id}},t.prototype.setEnableRtl=function(){!g(this.inputElement)&&!g(this.inputElement.parentElement)&&Ie.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},t.prototype.setEnable=function(){Ie.setEnabled(this.enabled,this.inputElement),this.enabled?(Z([this.inputWrapper.container],Je.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex),this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","false"),this.inputWrapper.container.removeAttribute("disabled"))):(this.hidePopup(),X([this.inputWrapper.container],Je.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1,this.inputWrapper&&this.inputWrapper.container&&(this.inputWrapper.container.setAttribute("aria-disabled","true"),this.inputWrapper.container.setAttribute("disabled","")))},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.getLocaleName=function(){return"drop-down-list"},t.prototype.preventTabIndex=function(e){this.getModuleName()==="dropdownlist"&&(e.tabIndex=-1)},t.prototype.targetElement=function(){return g(this.inputWrapper)?null:this.inputWrapper.container},t.prototype.getNgDirective=function(){return"EJS-DROPDOWNLIST"},t.prototype.getElementByText=function(e){return this.getElementByValue(this.getValueByText(e))},t.prototype.getElementByValue=function(e){for(var i,r=this.getItems(),n=0,s=r;n<s.length;n++){var a=s[n];if(this.getFormattedValue(a.getAttribute("data-value"))===e){i=a;break}}return i},t.prototype.initValue=function(){this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.renderList(),this.dataSource instanceof oe?this.initialRemoteRender=!0:this.updateValues()},t.prototype.isDisableItemValue=function(e){if(typeof e=="object"){var i=JSON.parse(JSON.stringify(e))[this.fields.value];return this.isDisabledItemByIndex(this.getIndexByValue(i))}return this.isDisabledItemByIndex(this.getIndexByValue(e))},t.prototype.updateValues=function(){if(this.fields.disabled&&(this.value!=null&&(this.value=this.isDisableItemValue(this.value)?null:this.value),this.text!=null&&(this.text=this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?null:this.text),this.index!=null&&(this.index=this.isDisabledItemByIndex(this.index)?null:this.index,this.activeIndex=this.index)),this.selectedValueInfo=this.viewPortInfo,g(this.value))if(this.text&&g(this.value)){var i=this.getElementByText(this.text);if(g(i)){this.setProperties({text:null});return}else this.setSelection(i,null)}else this.setSelection(this.liCollections[this.activeIndex],null);else{var e=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.setSelection(this.getElementByValue(e),null)}this.setHiddenValue(),Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onBlurHandler=function(e){if(this.enabled){var i=e.relatedTarget,r=e.target,n=this.isPreventBlur;if(this.isPreventBlur=!1,n&&!this.isDocumentClick&&this.isPopupOpen&&(!g(r)||!this.isFilterLayout()&&g(i))){this.getModuleName()==="dropdownlist"&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus();return}if(this.isDocumentClick||!g(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(Je.mobileFilter)){this.beforePopupOpen||(this.isDocumentClick=!1);return}(this.getModuleName()==="dropdownlist"&&!this.isFilterFocus&&i!==this.inputElement&&(document.activeElement!==i||document.activeElement===i&&r.classList.contains(Je.inputFocus))||g(i)&&this.getModuleName()==="dropdownlist"&&this.allowFiltering&&r!==this.inputWrapper.container||this.getModuleName()!=="dropdownlist"&&!this.inputWrapper.container.contains(i)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(e),this.isTabKey=!1),this.isRequested&&!this.isPopupOpen&&!this.isPreventBlur&&(this.isActive=!1,this.beforePopupOpen=!1),this.isFocused=!1}},t.prototype.focusOutAction=function(e){this.isInteracted=!1,this.focusOut(e),this.onFocusOut(e)},t.prototype.onFocusOut=function(e){this.enabled&&(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.floatLabelChange(),this.updateFloatLabelOverflowWidth(),this.dispatchEvent(this.hiddenElement,"change"),this.getModuleName()==="dropdownlist"&&this.element.tagName!=="INPUT"&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&X([this.inputWrapper.clearButton],Je.clearIconHide),this.trigger("blur"))},t.prototype.onFocus=function(e){if(!this.isInteracted){this.isInteracted=!0;var i={isInteracted:!!e,event:e};this.trigger("focus",i)}if(this.updateIconState(),this.floatLabelType!=="Never"&&this.inputWrapper&&this.inputWrapper.container){var r=this.inputWrapper.container.querySelector(".e-float-text");r&&r.removeAttribute("style")}this.isFocused=!0},t.prototype.resizingWireEvent=function(){T.add(document,"mousemove",this.resizePopup,this),T.add(document,"mouseup",this.stopResizing,this),T.add(document,"touchmove",this.resizePopup,this),T.add(document,"touchend",this.stopResizing,this)},t.prototype.resizingUnWireEvent=function(){T.remove(document,"mousemove",this.resizePopup),T.remove(document,"mouseup",this.stopResizing),T.remove(document,"touchmove",this.resizePopup),T.remove(document,"touchend",this.stopResizing)},t.prototype.resetValueHandler=function(e){var i=H(this.inputElement,"form");if(i&&e.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=r}},t.prototype.wireEvent=function(){T.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),T.add(this.inputWrapper.container,"focus",this.focusIn,this),T.add(this.inputWrapper.container,"keypress",this.onSearch,this),T.add(window,"resize",this.windowResize,this),this.bindCommonEvent()},t.prototype.bindCommonEvent=function(){T.add(this.targetElement(),"blur",this.onBlurHandler,this);var e=H(this.inputElement,"form");e&&T.add(e,"reset",this.resetValueHandler,this),j.isDevice?this.keyboardModule=new rr(this.targetElement(),{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.keyboardModule=new rr(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.bindClearEvent()},t.prototype.windowResize=function(){this.isPopupOpen&&this.popupObj.refreshPosition(this.inputWrapper.container)},t.prototype.bindClearEvent=function(){this.showClearButton&&T.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)},t.prototype.unBindCommonEvent=function(){!g(this.inputWrapper)&&this.targetElement()&&T.remove(this.targetElement(),"blur",this.onBlurHandler);var e=this.inputElement&&H(this.inputElement,"form");e&&T.remove(e,"reset",this.resetValueHandler),j.isDevice||this.keyboardModule.destroy(),this.showClearButton&&T.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)},t.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement.value!==""&&!this.readonly?Z([this.inputWrapper.clearButton],Je.clearIconHide):X([this.inputWrapper.clearButton],Je.clearIconHide))},t.prototype.wireListEvents=function(){g(this.list)||(T.add(this.list,"click",this.onMouseClick,this),T.add(this.list,"mouseover",this.onMouseOver,this),T.add(this.list,"mouseout",this.onMouseLeave,this))},t.prototype.onSearch=function(e){e.charCode!==32&&e.charCode!==13&&(this.list===void 0&&this.renderList(),this.searchKeyEvent=e,this.onServerIncrementalSearch(e))},t.prototype.onServerIncrementalSearch=function(e){!this.isRequested&&!g(this.list)&&!g(this.list.querySelector("li"))&&this.enabled&&!this.readonly&&this.incrementalSearch(e)},t.prototype.startResizing=function(e){this.isResizing=!0,this.trigger("resizeStart",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),e&&e.preventDefault()},t.prototype.resizePopup=function(e){if(this.isResizing){this.trigger("resizing",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,n=i-this.originalMouseX,s=r-this.originalMouseY;if(this.list&&this.list.parentElement){var a=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),l=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);a=a||100,l=l||120,this.resizeWidth=Math.max(this.originalWidth+n,a),this.resizeHeight=Math.max(this.originalHeight+s,l),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}e&&e.preventDefault()}},t.prototype.stopResizing=function(e){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",e),this.resizingUnWireEvent()),e&&e.preventDefault()},t.prototype.onMouseClick=function(e){var i=e.target;this.keyboardEvent=null;var r=H(i,"."+de.li);if(!(!this.isValidLI(r)||this.isDisabledElement(r)))if(this.setSelection(r,e),j.isDevice&&this.isFilterLayout())history.back();else{var n=100;this.closePopup(n,e)}},t.prototype.onMouseOver=function(e){var i=H(e.target,"."+de.li);this.setHover(i)},t.prototype.setHover=function(e){this.enabled&&this.isValidLI(e)&&!e.classList.contains(de.hover)&&(this.removeHover(),X([e],de.hover))},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.removeHover=function(){if(this.list){var e=this.list.querySelectorAll("."+de.hover);e&&e.length&&Z(e,de.hover)}},t.prototype.isValidLI=function(e){return e&&e.hasAttribute("role")&&e.getAttribute("role")==="option"},t.prototype.updateIncrementalItemIndex=function(e,i){this.incrementalStartIndex=e,this.incrementalEndIndex=i},t.prototype.incrementalSearch=function(e){if(this.liCollections.length>0)if(this.enableVirtualization){var i=!1,r=!1,n=this.ulElement.getElementsByClassName("e-active")[0],s=n?n.textContent:null;this.incrementalQueryString===""?(this.incrementalQueryString=String.fromCharCode(e.charCode),this.incrementalPreQueryString=this.incrementalQueryString):String.fromCharCode(e.charCode).toLocaleLowerCase()===this.incrementalPreQueryString.toLocaleLowerCase()?r=!0:this.incrementalQueryString=String.fromCharCode(e.charCode),(this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(i=!0,this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex===0?this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100:this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0),(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount);for(var a=zf(e.charCode,this.incrementalLiCollections,this.activeIndex,!0,this.element.id,r,s,!0);g(a)&&this.incrementalEndIndex<this.totalItemCount&&(this.updateIncrementalItemIndex(this.incrementalEndIndex,this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),a=zf(e.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,s,!0,!0),!!g(a));)if(g(a)&&this.incrementalEndIndex>=this.totalItemCount){this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100);break}g(a)&&this.incrementalEndIndex>=this.totalItemCount&&(this.updateIncrementalItemIndex(0,100>this.totalItemCount?this.totalItemCount:100),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),i=!0,(this.viewPortInfo.startIndex!==0||i)&&this.updateIncrementalView(0,this.itemCount),a=zf(e.charCode,this.incrementalLiCollections,0,!0,this.element.id,r,s,!0,!0));var l=a&&this.getIndexByValue(a.getAttribute("data-value"));if(l)l=l-this.skeletonCount;else for(var h=0;h<this.incrementalLiCollections.length;h++)if(!g(a)&&!g(a.getAttribute("data-value"))&&this.incrementalLiCollections[h].getAttribute("data-value")===a.getAttribute("data-value").toString()){l=h,l=this.incrementalStartIndex+l;break}if(l&&(!(this.viewPortInfo.startIndex>=l)||!(l>=this.viewPortInfo.endIndex))){var c=l-(this.itemCount/2-2)>0?l-(this.itemCount/2-2):0,u=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(c,u)}if(g(a))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var d=this.getIndexByValue(a.getAttribute("data-value"))-this.skeletonCount;if(d>this.itemCount/2){var c=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,u=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(c,u)}if(a=this.getElementByValue(a.getAttribute("data-value")),this.setSelection(a,e),this.setScrollPosition(),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var p=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.list.scrollTop=p-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}this.incrementalPreQueryString=this.incrementalQueryString}}else{var a=void 0;if(this.fields.disabled){var f=this.list.querySelectorAll("."+de.li+":not(.e-disabled)");a=zf(e.charCode,f,this.activeIndex,!0,this.element.id)}else a=zf(e.charCode,this.liCollections,this.activeIndex,!0,this.element.id);g(a)||(this.setSelection(a,e),this.setScrollPosition())}},t.prototype.hideSpinner=function(){g(this.spinnerElement)||(Xs(this.spinnerElement),Z([this.spinnerElement],Je.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.showSpinner=function(){g(this.spinnerElement)&&(this.spinnerElement=j.isDevice&&!g(this.filterInputObj)&&this.filterInputObj.buttons[1]||!g(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],X([this.spinnerElement],Je.disableIcon),Qs({target:this.spinnerElement,width:j.isDevice?"16px":"14px"},this.createElement),vs(this.spinnerElement))},t.prototype.keyActionHandler=function(e){if(this.enabled){this.keyboardEvent=e,this.isPreventKeyAction&&this.enableVirtualization&&e.preventDefault();var i=e.action==="pageUp"||e.action==="pageDown",r=this.getModuleName()!=="dropdownlist"&&(e.action==="home"||e.action==="end");this.isEscapeKey=e.action==="escape",this.isTabKey=!this.isPopupOpen&&e.action==="tab";var n=e.action==="down"||e.action==="up"||e.action==="pageUp"||e.action==="pageDown"||e.action==="home"||e.action==="end";if(!((this.isEditTextBox()||i||r)&&!this.isPopupOpen)&&!this.readonly){var s=e.action==="tab"||e.action==="close";if(g(this.list)&&!this.isRequested&&!s&&e.action!=="escape"&&(this.searchKeyEvent=e,(!this.enableVirtualization||this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&e.type!=="mousedown"&&(e.keyCode===40||e.keyCode===38))&&(this.renderList(e),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul"))),g(this.list)||!g(this.liCollections)&&n&&this.liCollections.length===0||this.isRequested)return;switch((s&&this.getModuleName()!=="autocomplete"&&this.isPopupOpen||e.action==="escape")&&e.preventDefault(),this.isSelected=e.action==="escape"?!1:this.isSelected,this.isTyped=n||e.action==="escape"?!1:this.isTyped,e.action){case"down":case"up":this.updateUpDownAction(e);break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),e),e.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),e),e.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(e);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(e);break;case"space":this.getModuleName()==="dropdownlist"&&(this.beforePopupOpen||(this.showPopup(),e.preventDefault()));break;case"open":this.showPopup(e);break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(e),this.focusDropDown(e);break;case"enter":this.selectCurrentItem(e);break;case"tab":this.selectCurrentValueOnTab(e);break;case"escape":case"close":this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e));break}}}},t.prototype.updateUpDownAction=function(e,i){if(!(this.fields.disabled&&this.list&&this.list.querySelectorAll(".e-list-item:not(.e-disabled)").length===0)){if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value;g(r)&&(r="null");var n=this.getIndexByValue(r);g(n)||(this.activeIndex=n)}var s=this.list.querySelector("."+Je.focus);if(this.isSelectFocusItem(s)&&!i){if(this.setSelection(s,e),this.enableVirtualization){var a=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;this.fields.groupBy&&(a=this.virtualListInfo&&this.virtualListInfo.startIndex===0?this.selectedLI.offsetHeight-a:a-this.selectedLI.offsetHeight),this.list.scrollTop=a-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}else if(!g(this.liCollections)){var l=this.activeIndex,h=e.action==="down"?this.activeIndex+1:this.activeIndex-1;h=i?l:h;var c=0;this.getModuleName()==="autocomplete"&&(c=e.action==="down"&&g(this.activeIndex)?0:this.liCollections.length-1,h=h<0?this.liCollections.length-1:h===this.liCollections.length?0:h);var u=void 0;if(this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&this.isPopupOpen)if(!this.enableVirtualization)u=g(this.activeIndex)?this.liCollections[c]:this.liCollections[h];else if(!i)u=g(this.activeIndex)?this.liCollections[this.skeletonCount]:this.liCollections[h],u=!g(u)&&!u.classList.contains("e-virtual-list")?u:null;else if(this.getModuleName()==="autocomplete"){var r=this.getFormattedValue(this.selectedLI.getAttribute("data-value"));u=this.getElementByValue(r)}else u=this.getElementByValue(this.getItemData().value);if(g(u)){if(this.enableVirtualization&&!this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&(this.viewPortInfo.endIndex!==this.totalItemCount&&e.action==="down"||this.viewPortInfo.startIndex!==0&&e.action==="up")){if(e.action==="down"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex+this.itemCount<this.totalItemCount-this.itemCount?this.viewPortInfo.startIndex+this.itemCount:this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[0].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[0].getAttribute("data-value")):null,p=this.getDataByValue(r);p&&(this.itemData=p)}else if(e.action==="up"){this.viewPortInfo.startIndex=this.viewPortInfo.startIndex-this.itemCount>0?this.viewPortInfo.startIndex-this.itemCount:0,this.viewPortInfo.endIndex=this.viewPortInfo.startIndex+this.itemCount,this.updateVirtualItemIndex(),this.isCustomFilter=this.getModuleName()==="combobox"?!0:this.isCustomFilter,this.resetList(this.dataSource,this.fields,this.query),this.isCustomFilter=this.getModuleName()==="combobox"?!1:this.isCustomFilter;var r=this.liCollections[this.liCollections.length-1].getAttribute("data-value")!=="null"?this.getFormattedValue(this.liCollections[this.liCollections.length-1].getAttribute("data-value")):null,p=this.getDataByValue(r);p&&(this.itemData=p)}this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul"),this.handleVirtualKeyboardActions(e,this.pageCount)}}else{var d=this.liCollections[this.skeletonCount]&&this.liCollections[this.skeletonCount].classList.contains("e-item-focus");if(this.setSelection(u,e),d&&this.enableVirtualization&&this.getModuleName()==="autocomplete"&&!i){var a=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*this.selectedLI.offsetHeight:this.selectedLI.offsetTop;a=this.virtualListInfo&&this.virtualListInfo.startIndex===0&&this.fields.groupBy?this.selectedLI.offsetHeight-a:a-this.selectedLI.offsetHeight,this.list.scrollTop=a-this.list.querySelectorAll(".e-virtual-list").length*this.selectedLI.offsetHeight}}}if(this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var r=this.getItemData().value,n=this.getIndexByValueFilter(r,this.actionCompleteData.ulElement);g(n)||(this.activeIndex=n)}this.allowFiltering&&this.getModuleName()==="dropdownlist"&&this.filterInput&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}));for(var f,h=0;h<this.liCollections.length;h++)if(this.liCollections[h].classList.contains(Je.focus)||this.liCollections[h].classList.contains(Je.selected)){f=h;break}f!=null&&this.isDisabledElement(this.liCollections[f])&&(this.getModuleName()!=="autocomplete"&&(this.liCollections.length-1===f&&e.action==="down"&&(e.action="up"),f===0&&e.action==="up"&&(e.action="down")),this.updateUpDownAction(e)),e.preventDefault()}},t.prototype.updateHomeEndAction=function(e,i){if(this.getModuleName()==="dropdownlist"){var r=0;if(e.action==="home"?(r=0,this.enableVirtualization&&this.isPopupOpen?r=this.skeletonCount:this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query))):(this.enableVirtualization&&!this.isPopupOpen&&this.viewPortInfo.endIndex!==this.totalItemCount&&(this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query)),r=this.getItems().length-1),e.preventDefault(),this.activeIndex===r){i&&this.setSelection(this.liCollections[r],e);return}if(!this.enableVirtualization&&this.liCollections[r]&&this.liCollections[r].classList.contains("e-disabled"))return;this.setSelection(this.liCollections[r],e)}},t.prototype.selectCurrentValueOnTab=function(e){this.getModuleName()==="autocomplete"?this.selectCurrentItem(e):this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e))},t.prototype.mobileKeyActionHandler=function(e){if(this.enabled&&!(this.isEditTextBox()&&!this.isPopupOpen)&&!this.readonly){if(this.list===void 0&&!this.isRequested&&(this.searchKeyEvent=e,this.renderList()),g(this.list)||!g(this.liCollections)&&this.liCollections.length===0||this.isRequested)return;e.action==="enter"&&this.selectCurrentItem(e)}},t.prototype.handleVirtualKeyboardActions=function(e,i){switch(e.action){case"down":case"up":(this.itemData!=null||this.getModuleName()==="autocomplete")&&this.updateUpDownAction(e,!0);break;case"pageUp":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))+this.getPageCount()-1:this.getIndexByValue(this.previousValue),this.pageUpSelection(this.activeIndex-this.getPageCount(),e,!0),e.preventDefault();break;case"pageDown":this.activeIndex=this.getModuleName()==="autocomplete"?this.getIndexByValue(this.selectedLI.getAttribute("data-value"))-this.getPageCount():this.getIndexByValue(this.previousValue),this.pageDownSelection(g(this.activeIndex)?2*this.getPageCount():this.activeIndex+this.getPageCount(),e,!0),e.preventDefault();break;case"home":this.isMouseScrollAction=!0,this.updateHomeEndAction(e,!0);break;case"end":this.isMouseScrollAction=!0,this.updateHomeEndAction(e,!0);break}this.keyboardEvent=null},t.prototype.selectCurrentItem=function(e){if(this.isPopupOpen){var i=this.list.querySelector("."+Je.focus);if(this.isDisabledElement(i))return;i&&(this.setSelection(i,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.hidePopup(e),this.focusDropDown(e)}else this.showPopup()},t.prototype.isSelectFocusItem=function(e){return!g(e)},t.prototype.pageUpSelection=function(e,i,r){var n=e>=0?this.liCollections[e+1]:this.liCollections[0];if(!this.enableVirtualization&&n&&n.classList.contains("e-disabled")){for(var s=e>=0?e+1:0;s<this.liCollections.length&&(n=this.liCollections[s],!(n&&!n.classList.contains("e-disabled")));)if(s--,s<0)return}this.enableVirtualization&&this.activeIndex==null&&(n=this.liCollections.length>=e&&e>=0?this.liCollections[e+this.skeletonCount+1]:this.liCollections[0]),!g(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.PageUpDownSelection(n,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.PageUpDownSelection=function(e,i){this.enableVirtualization?!g(e)&&(this.getModuleName()!=="autocomplete"&&!e.classList.contains("e-active")||this.getModuleName()==="autocomplete"&&!e.classList.contains("e-item-focus"))&&this.setSelection(e,i):this.setSelection(e,i)},t.prototype.pageDownSelection=function(e,i,r){var n=this.getItems(),s=e<=n.length?this.liCollections[e-1]:this.liCollections[n.length-1];if(!this.enableVirtualization&&s&&s.classList.contains("e-disabled"))for(;e>=0&&e<this.liCollections.length&&(s=e<=n.length?this.liCollections[e-1]:this.liCollections[n.length-1],!(s&&!s.classList.contains("e-disabled")));)e++;this.enableVirtualization&&this.skeletonCount>0&&(e=this.getModuleName()==="dropdownlist"&&this.allowFiltering?e+1:e,s=e<n.length?this.liCollections[e]:this.liCollections[n.length-1]),this.enableVirtualization&&this.activeIndex==null&&(s=e<=n.length?this.liCollections[e+this.skeletonCount-1]:this.liCollections[n.length-1]),this.PageUpDownSelection(s,i),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ee(this.filterInput,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.unWireEvent=function(){g(this.inputWrapper)||(T.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),T.remove(this.inputWrapper.container,"keypress",this.onSearch),T.remove(this.inputWrapper.container,"focus",this.focusIn),T.remove(window,"resize",this.windowResize)),this.unBindCommonEvent()},t.prototype.unWireListEvents=function(){this.list&&(T.remove(this.list,"click",this.onMouseClick),T.remove(this.list,"mouseover",this.onMouseOver),T.remove(this.list,"mouseout",this.onMouseLeave))},t.prototype.checkSelector=function(e){return'[id="'+e.replace(/(:|\.|\[|\]|,|=|@|\\|\/|#)/g,"\\$1")+'"]'},t.prototype.onDocumentClick=function(e){var i=e.target;if(!(!g(this.popupObj)&&H(i,this.checkSelector(this.popupObj.element.id)))&&!g(this.inputWrapper)&&!this.inputWrapper.container.contains(e.target)){if(this.inputWrapper.container.classList.contains(Je.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;var r=this.isRequested;this.getModuleName()==="combobox"&&this.isTyped&&(this.isInteracted=!1),this.hidePopup(e),this.isInteracted=!1,r||(this.onFocusOut(e),this.inputWrapper.container.classList.remove(Je.inputFocus))}}else i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&!(this.getModuleName()==="combobox"&&!this.allowFiltering&&j.isDevice&&i===this.inputWrapper.buttons[0])&&(this.isPreventBlur=(j.isIE||j.info.name==="edge")&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),e.preventDefault())},t.prototype.activeStateChange=function(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(Je.inputFocus))},t.prototype.focusDropDown=function(e){!this.initial&&this.isFilterLayout()&&this.focusIn(e)},t.prototype.dropDownClick=function(e){if(!(e.which===3||e.button===2)&&(this.keyboardEvent=null,!(this.targetElement().classList.contains(Je.disable)||this.inputWrapper.clearButton===e.target))){var i=e.target;if(i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&this.getModuleName()!=="combobox"&&e.preventDefault(),this.readonly)this.focusIn(e);else{this.isPopupOpen||this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen&&this.isPopupRender?(this.hidePopup(e),this.isFilterLayout()&&this.focusDropDown(e)):(this.focusIn(e),this.floatLabelChange(),this.queryString=this.inputElement.value.trim()===""?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup(e));var r=this,n=this.dataSource instanceof oe&&this.groupTemplate?700:this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isSecondClick||setTimeout(function(){r.cloneElements(),r.isSecondClick=!0,r.isSecondClick=!(r.isReact&&r.isFiltering()&&r.dataSource instanceof oe&&!r.list.querySelector("ul"))},n)}}},t.prototype.cloneElements=function(){if(this.list){var e=this.list.querySelector("ul");e&&(e=e.cloneNode?e.cloneNode(!0):e,this.actionCompleteData.ulElement=e)}},t.prototype.updateSelectedItem=function(e,i,r,n){var s=this;this.removeSelection(),e.classList.add(de.selected),this.removeHover();var a=e.getAttribute("data-value")!==null?this.getFormattedValue(e.getAttribute("data-value")):null,l=this.getDataByValue(a);if(!this.initial&&!r&&!g(i)){var h=this.detachChanges(l);this.isSelected=!0;var c={e:i,item:e,itemData:h,isInteracted:!!i,cancel:!1};this.trigger("select",c,function(u){u.cancel?e.classList.remove(de.selected):(s.selectEventCallback(e,i,r,l,a),n&&s.setSelectOptions(e,i))})}else this.selectEventCallback(e,i,r,l,a),n&&this.setSelectOptions(e,i)},t.prototype.selectEventCallback=function(e,i,r,n,s){this.previousItemData=g(this.itemData)?null:this.itemData,this.itemData!==n&&(this.previousValue=g(this.itemData)?null:typeof this.itemData=="object"&&!this.allowObjectBinding?this.checkFieldValue(this.itemData,this.fields.value.split(".")):this.itemData),this.item=e,this.itemData=n;var a=this.list.querySelector("."+de.focus);if(a&&Z([a],de.focus),e.setAttribute("aria-selected","true"),g(s)&&(s="null"),this.allowFiltering&&!this.enableVirtualization&&this.getModuleName()!=="autocomplete"){var l=this.getIndexByValueFilter(s,this.actionCompleteData.ulElement);g(l)?this.activeIndex=this.getIndexByValue(s):this.activeIndex=l}else this.enableVirtualization&&this.activeIndex==null&&this.dataSource instanceof oe&&(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.ulElement=this.list.querySelector("ul")),this.activeIndex=this.getIndexByValue(s)},t.prototype.activeItem=function(e){this.isValidLI(e)&&!e.classList.contains(de.selected)&&(this.removeSelection(),e.classList.add(de.selected),this.removeHover(),e.setAttribute("aria-selected","true"))},t.prototype.setValue=function(e){var i=this.getItemData();this.isTouched=!g(e),i.value===null?Ie.setValue(null,this.inputElement,this.floatLabelType,this.showClearButton):Ie.setValue(i.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&this.itemData!==null?this.setValueTemplate():!g(this.valueTempElement)&&this.inputElement.previousSibling===this.valueTempElement&&(se(this.valueTempElement),this.inputElement.style.display="block"),!g(i.value)&&!this.enableVirtualization&&this.allowFiltering&&(this.activeIndex=this.getIndexByValueFilter(i.value,this.actionCompleteData.ulElement),g(this.activeIndex)&&(this.activeIndex=this.getIndexByValue(i.value)));var r=Je.clearIcon,n=this.isFiltering()&&this.filterInput&&this.getModuleName()==="combobox",s=n&&this.filterInput.parentElement.querySelector("."+r);return this.isFiltering()&&s&&s.style.removeProperty("visibility"),!this.allowObjectBinding&&this.previousValue===i.value||this.allowObjectBinding&&this.previousValue!=null&&this.isObjectInArray(this.previousValue,[this.allowCustom&&this.isObjectCustomValue?this.value?this.value:i:i.value?this.getDataByValue(i.value):i])?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,this.getModuleName()==="dropdownlist"&&this.updateIconState(),!1)},t.prototype.setSelection=function(e,i){if(this.isValidLI(e)&&(!e.classList.contains(de.selected)||this.isPopupOpen&&this.isSelected&&e.classList.contains(de.selected)))this.updateSelectedItem(e,i,!1,!0);else if(this.setSelectOptions(e,i),this.enableVirtualization&&this.value){var r=this.isPrimitiveData?"":this.fields.value,n=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.dataSource instanceof oe){var s=new oe(this.virtualGroupDataSource).executeLocal(new Pe().where(new xt(r,"equal",n)));if(s&&s.length>0){this.itemData=s[0];var a=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(a.value):a.value;(this.value===a.value&&this.text!==a.text||this.value!==a.value&&this.text===a.text)&&this.setProperties({text:a.text?a.text.toString():a.text,value:l})}}else{var s=new oe(this.dataSource).executeLocal(new Pe().where(new xt(r,"equal",n)));if(s&&s.length>0){this.itemData=s[0];var a=this.getItemData(),l=this.allowObjectBinding?this.getDataByValue(a.value):a.value;(this.value===a.value&&this.text!==a.text||this.value!==a.value&&this.text===a.text)&&(this.setProperties({text:a.text?a.text.toString():a.text,value:l}),g(e)&&(this.previousValue=this.value))}}}},t.prototype.setSelectOptions=function(e,i){this.list&&this.removeHover(),this.previousSelectedLI=g(this.selectedLI)?null:this.selectedLI,this.selectedLI=e,!this.setValue(i)&&((!this.isPopupOpen&&!g(e)||this.isPopupOpen&&!g(i)&&(i.type!=="keydown"||i.type==="keydown"&&i.action==="enter"))&&(this.isSelectCustom=!1,this.onChangeEvent(i)),this.isPopupOpen&&!g(this.selectedLI)&&this.itemData!==null&&(!i||i.type!=="click")&&this.setScrollPosition(i),j.info.name!=="mozilla"&&this.targetElement()&&(Ee(this.targetElement(),{"aria-describedby":this.inputElement.id!==""?this.inputElement.id:this.element.id}),this.targetElement().removeAttribute("aria-live")),this.isPopupOpen&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])?Ee(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}):this.isPopupOpen&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-active")[0])&&Ee(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-active")[0].id}))},t.prototype.dropdownCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!document.querySelectorAll(e).length}catch{i=!1}return i},t.prototype.setValueTemplate=function(){var e;this.isReact&&(this.clearTemplate(["valueTemplate"]),this.valueTempElement&&(se(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null)),this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:Je.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.isReact||(this.valueTempElement.innerHTML="");var i=this.dropdownCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&i?e=Et(document.querySelector(this.valueTemplate).innerHTML.trim()):e=Et(this.valueTemplate);var r=e(this.itemData,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,this.valueTempElement);r&&r.length>0&&bt(r,this.valueTempElement),this.renderReactTemplates()},t.prototype.removeSelection=function(){if(this.list){var e=this.list.querySelectorAll("."+de.selected);e.length&&(Z(e,de.selected),e[0].removeAttribute("aria-selected"))}},t.prototype.getItemData=function(){var e=this.fields,i=null;i=this.itemData;var r,n;g(i)||(r=V(e.value,i),n=V(e.text,i));var s=!g(i)&&!Te(r)?r:i,a=!g(i)&&!Te(r)?n:i;return{value:s,text:a}},t.prototype.onChangeEvent=function(e,i){var r=this,n=this.getItemData(),s=this.isSelectCustom?null:this.activeIndex;if(this.enableVirtualization){var a=this.dataSource instanceof oe?this.virtualGroupDataSource:this.dataSource;if(n.value&&a&&a.length>0){var l=a.findIndex(function(c){return!g(n.value)&&V(r.fields.value,c)===n.value});l!==-1&&(s=l)}}var h=this.allowObjectBinding?i?this.value:this.getDataByValue(n.value):n.value;this.setProperties({index:s,text:n.text?n.text.toString():n.text,value:h},!0),this.detachChangeEvent(e)},t.prototype.detachChanges=function(e){var i;return typeof e=="string"||typeof e=="boolean"||typeof e=="number"?i=Object.defineProperties({},{value:{value:e,enumerable:!0},text:{value:e,enumerable:!0}}):i=e,i},t.prototype.detachChangeEvent=function(e){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.enableVirtualization?this.getIndexByValue(this.value):this.index,this.typedString=g(this.text)?"":this.text,!this.initial){var i=this.detachChanges(this.itemData),r=void 0;typeof this.previousItemData=="string"||typeof this.previousItemData=="boolean"||typeof this.previousItemData=="number"?r=Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):r=this.previousItemData,this.setHiddenValue();var n={e,item:this.item,itemData:i,previousItem:this.previousSelectedLI,previousItemData:r,isInteracted:!!e,value:this.value,element:this.element,event:e};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}(g(this.value)||this.value==="")&&this.floatLabelType!=="Always"&&Z([this.inputWrapper.container],"e-valid-input")},t.prototype.setHiddenValue=function(){if(g(this.value))this.hiddenElement.innerHTML="";else{var e=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.hiddenElement.querySelector("option")){var i=this.hiddenElement.querySelector("option");i.textContent=this.text,i.setAttribute("value",e.toString())}else if(!g(this.hiddenElement)){var r=document.createElement("option");r.text=this.text,r.setAttribute("selected",""),this.hiddenElement.appendChild(r);var i=this.hiddenElement.querySelector("option");i.setAttribute("value",e.toString())}}},t.prototype.onFilterUp=function(e){if(!(e.ctrlKey&&e.keyCode===86)&&(this.isValidKey||e.keyCode===40||e.keyCode===38))switch(this.isValidKey=!1,this.filterArgs=e,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,e.keyCode){case 38:case 40:this.getModuleName()==="autocomplete"&&!this.isPopupOpen&&!this.preventAltUp&&!this.isRequested?(this.preventAutoFill=!0,this.searchLists(e)):this.preventAutoFill=!1,this.preventAltUp=!1,this.getModuleName()==="autocomplete"&&!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Ee(this.targetElement(),{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id}),e.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&this.typedString!==""||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&this.queryString===""&&this.getModuleName()!=="autocomplete"?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&(this.list&&this.resetFocusElement(),this.activeIndex=null,this.getModuleName()!=="dropdownlist"&&(this.preventAutoFill=!0,this.searchLists(e),this.getModuleName()==="autocomplete"&&this.hidePopup())),e.preventDefault();break;default:this.isFiltering()&&this.getModuleName()==="combobox"&&g(this.list)&&(this.getInitialData=!0,this.renderList(),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()),this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.getInitialData||this.searchLists(e),(this.enableVirtualization&&this.getModuleName()!=="autocomplete"||this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof oe)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof oe&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount();break}else this.isValidKey=!1},t.prototype.onFilterDown=function(e){switch(e.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,e.preventDefault();break;case 9:this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&e.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value;break}},t.prototype.removeFillSelection=function(){if(this.isInteracted){var e=this.getSelectionPoints();this.inputElement.setSelectionRange(e.end,e.end)}},t.prototype.getQuery=function(e){var i;if(!this.isCustomFilter&&this.allowFiltering&&this.filterInput){i=e?e.clone():this.query?this.query.clone():new Pe;var r=this.typedString===""?"contains":this.filterType,n=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof oe)&&n==="string"||n==="number")i.where("",r,this.typedString,this.ignoreCase,this.ignoreAccent);else if(this.getModuleName()!=="combobox"||this.isFiltering()&&this.getModuleName()==="combobox"&&this.typedString!==""){var s=this.fields.text?this.fields.text:"";i.where(s,r,this.typedString,this.ignoreCase,this.ignoreAccent)}}else i=this.enableVirtualization&&!g(this.customFilterQuery)?this.customFilterQuery.clone():e?e.clone():this.query?this.query.clone():new Pe;if(this.enableVirtualization&&this.viewPortInfo.endIndex!==0){var a=this.getTakeValue(),l=!1;if(i){for(var h=0;h<i.queries.length;h++)if(i.queries[h].fn==="onSkip"){l=!0;break}}var c=0,u=0;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onSkip"&&(u=i.queries[h].e.nos),i.queries[h].fn==="onTake"&&(c=a<=i.queries[h].e.nos?i.queries[h].e.nos:a);if(c<=0&&this.query&&this.query.queries.length>0)for(var h=0;h<this.query.queries.length;h++)this.query.queries[h].fn==="onTake"&&(c=a<=this.query.queries[h].e.nos?this.query.queries[h].e.nos:a);var d=!1;if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++){if(i.queries[h].fn==="onSkip"){u=i.queries[h].e.nos,i.queries.splice(h,1),l=!1,--h;continue}i.queries[h].fn==="onTake"&&(c=i.queries[h].e.nos<=c?c:i.queries[h].e.nos,i.queries.splice(h,1),--h)}!d&&(this.allowFiltering||!this.isPopupOpen||!l)&&(u>0?i.skip(u):i.skip(this.virtualItemStartIndex)),this.isIncrementalRequest?i.take(this.incrementalEndIndex):c>0?i.take(c):i.take(a),i.requiresCount()}return i},t.prototype.getSelectionPoints=function(){var e=this.inputElement;return{start:Math.abs(e.selectionStart),end:Math.abs(e.selectionEnd)}},t.prototype.performFiltering=function(e){var i=this;this.checkAndResetCache(),this.isRequesting=!1;var r={preventDefaultAction:!1,text:this.filterInput?this.filterInput.value:"",updateData:function(n,s,a){r.cancel||(i.isCustomFilter=!0,i.customFilterQuery=s&&s.clone(),i.filteringAction(n,s,a))},baseEventArgs:e,cancel:!1};this.trigger("filtering",r,function(n){!n.cancel&&!i.isCustomFilter&&!n.preventDefaultAction&&i.filteringAction(i.dataSource,null,i.fields)})},t.prototype.searchLists=function(e){if(this.isTyped=!0,this.activeIndex=null,this.isListSearched=!0,this.filterInput.parentElement.querySelector("."+Je.clearIcon)){var i=this.filterInput.parentElement.querySelector("."+Je.clearIcon);i.style.visibility=this.filterInput.value===""?"hidden":"visible"}this.isDataFetched=!1,this.isFiltering()&&(this.typedString!==""&&this.debounceDelay>0?this.debouncedFiltering(e,this.debounceDelay):this.performFiltering(e))},t.prototype.filter=function(e,i,r){this.isCustomFilter=!0,this.filteringAction(e,i,r)},t.prototype.filteringAction=function(e,i,r){if(!g(this.filterInput)){this.beforePopupOpen=!(!this.isPopupOpen&&this.getModuleName()==="combobox"&&this.filterInput.value===""||this.getInitialData);var n=this.list.classList.contains(de.noData);if(this.filterInput.value.trim()===""&&!this.itemTemplate){if(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,!g(this.actionCompleteData.ulElement)&&!g(this.actionCompleteData.list)){if(this.enableVirtualization&&(this.isFiltering()&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(e,r,i),n&&!this.list.classList.contains(de.noData))){if(!this.list.querySelector(".e-virtual-ddl-content")){var s=this.createElement("div",{className:"e-virtual-ddl-content"});s.style.cssText=this.getTransformValues(),this.list.appendChild(s).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list)}this.isTyped=!0,!g(this.itemData)&&this.getModuleName()==="dropdownlist"&&(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0}else if(this.isNotSearchList=!1,i=this.filterInput.value.trim()===""?null:i,this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(e,r,i),this.getModuleName()==="dropdownlist"&&this.list.classList.contains(de.noData)&&(this.popupContentElement.setAttribute("role","status"),this.popupContentElement.setAttribute("id","no-record"),Ee(this.filterInputObj.container,{"aria-activedescendant":"no-record"})),this.enableVirtualization&&n&&!this.list.classList.contains(de.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var s=this.createElement("div",{className:"e-virtual-ddl-content"});s.style.cssText=this.getTransformValues(),this.list.appendChild(s).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}this.enableVirtualization&&this.getFilteringSkeletonCount(),this.renderReactTemplates(),this.filterInput&&this.filterInput.value===""&&this.getModuleName()==="combobox"&&this.executeCloneElements()}},t.prototype.setSearchBox=function(e){if(this.isFiltering()){var i=e.querySelector("."+Je.filterParent)?e.querySelector("."+Je.filterParent):this.createElement("span",{className:Je.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:Je.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);var r=!1;return j.isDevice&&this.isDeviceFullScreen&&(r=!0),this.filterInputObj=Ie.createInput({element:this.filterInput,buttons:r?[Je.backIcon,Je.filterBarClearIcon]:[Je.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),g(this.cssClass)||(this.cssClass.split(" ").indexOf("e-outline")!==-1?X([this.filterInputObj.container],"e-outline"):this.cssClass.split(" ").indexOf("e-filled")!==-1&&X([this.filterInputObj.container],"e-filled")),bt([this.filterInputObj.container],i),$r([i],e),Ee(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+Je.clearIcon),!j.isDevice&&this.clearIconElement&&(T.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),j.isDevice?this.searchKeyModule=new rr(this.filterInput,{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.searchKeyModule=new rr(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),T.add(this.filterInput,"input",this.onInput,this),T.add(this.filterInput,"keyup",this.onFilterUp,this),T.add(this.filterInput,"keydown",this.onFilterDown,this),T.add(this.filterInput,"blur",this.onBlurHandler,this),T.add(this.filterInput,"paste",this.pasteHandler,this),this.filterInputObj}else return v5},t.prototype.onInput=function(e){!g(e)&&!g(e.data)&&e.data.length>1&&this.autoFill&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.inputElement.value=e.data),this.isValidKey=!0,this.getModuleName()==="combobox"&&this.updateIconState(),j.isDevice&&j.info.name==="mozilla"&&(this.typedString=this.filterInput.value,this.preventAutoFill=!0,this.searchLists(e))},t.prototype.pasteHandler=function(e){var i=this;setTimeout(function(){i.typedString=i.filterInput.value,i.getModuleName()==="combobox"&&i.isFiltering()&&g(i.list)&&i.renderList(),i.searchLists(e)})},t.prototype.onActionFailure=function(e){o.prototype.onActionFailure.call(this,e),this.beforePopupOpen&&this.renderPopup()},t.prototype.getTakeValue=function(){return this.allowFiltering&&this.getModuleName()==="dropdownlist"&&j.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},t.prototype.onActionComplete=function(e,i,r,n){var s=this;if(this.dataSource instanceof oe&&!g(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.isNotSearchList&&!this.enableVirtualization){this.isNotSearchList=!1;return}if(this.getInitialData){this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){s.updateActionCompleteDataValues(e,i)},0):this.updateActionCompleteDataValues(e,i),this.enableVirtualization&&this.updateSelectElementData(this.allowFiltering),this.getInitialData=!1,this.isReactTemplateUpdate=!0,this.typedString=this.filterInput.value,this.searchLists(this.filterArgs);return}var a=this.itemCount;if(this.isActive||!g(e)){var l=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(o.prototype.onActionComplete.call(this,e,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering),this.isRequested&&!g(this.searchKeyEvent)&&this.searchKeyEvent.type==="keydown"&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!g(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.enableVirtualization||(this.list.scrollTop=0),g(e)||Ee(e,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"listbox"}),this.initialRemoteRender){if(this.initial=!0,this.activeIndex=this.index,this.initialRemoteRender=!1,this.value&&this.dataSource instanceof oe){var h=g(this.fields.value)?this.fields.text:this.fields.value,c=this.allowObjectBinding&&!g(this.value)?V(h,this.value):this.value,u=this.fields.value.split("."),d=i.some(function(y){return g(y[h])&&u.length>1?s.checkFieldValue(y,u)===c:y[h]===c});this.enableVirtualization&&this.virtualGroupDataSource&&(d=this.virtualGroupDataSource.some(function(y){return g(y[h])&&u.length>1?s.checkFieldValue(y,u)===c:y[h]===c})),!d&&!this.enableVirtualization?this.dataSource.executeQuery(this.getQuery(this.query).where(new xt(h,"equal",c))).then(function(y){y.result.length>0&&(s.enableVirtualization||s.addItem(y.result,i.length)),s.updateValues()}):this.updateValues()}else this.updateValues();this.initial=!1}else this.getModuleName()==="autocomplete"&&this.value&&this.setInputValue();if(this.getModuleName()!=="autocomplete"&&this.isFiltering()&&!this.isTyped){if((!this.actionCompleteData.isUpdated||!this.isCustomFilter&&!this.isFilterFocus||g(this.itemData)&&this.allowFiltering&&(this.dataSource instanceof oe||!g(this.dataSource)&&!g(this.dataSource.length)&&this.dataSource.length!==0))&&(this.itemTemplate&&(this.element.tagName==="EJS-COMBOBOX"||this.isReact)&&this.allowFiltering?setTimeout(function(){s.updateActionCompleteDataValues(e,i)},0):this.updateActionCompleteDataValues(e,i)),this.isDynamicData){var p=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(p),this.selectedLI=this.getElementByValue(p),this.isDynamicData=!1}if((this.allowCustom||this.allowFiltering&&!this.isValueInList(i,this.value)&&this.dataSource instanceof oe)&&!this.enableVirtualization)this.addNewItem(i,l);else if((this.allowCustom||this.allowFiltering&&this.isValueInList(i,this.value))&&!this.enableVirtualization){var f=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,v=!g(this.value)&&l&&l.getAttribute("data-value")===f.toString();v&&this.addNewItem(i,l)}(!g(this.itemData)||g(this.itemData)&&this.enableVirtualization)&&(this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.focusIndexItem()),this.enableVirtualization&&this.updateActionCompleteDataValues(e,i)}else if(this.enableVirtualization&&this.getModuleName()!=="autocomplete"&&!this.isFiltering()){var f=this.getItemData().value;this.activeIndex=this.getIndexByValue(f);var m=this.findListElement(this.list,"li","data-value",f);this.selectedLI=m}else this.enableVirtualization&&this.getModuleName()==="autocomplete"&&(this.activeIndex=this.skeletonCount);this.beforePopupOpen&&(this.renderPopup(r),this.enableVirtualization&&(this.list.querySelector(".e-virtual-list")||(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"))),this.enableVirtualization&&a!==this.itemCount&&this.resetList(this.dataSource,this.fields))}},t.prototype.isValueInList=function(e,i){if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(e[r]===i)return!0}else if(typeof e=="object"&&e!==null){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]===i)return!0}return!1},t.prototype.checkFieldValue=function(e,i){var r=e;return i.forEach(function(n){r=r[n]}),r},t.prototype.updateActionCompleteDataValues=function(e,i){this.actionCompleteData={ulElement:e.cloneNode(!0),list:i,isUpdated:!0},this.actionData.list!==this.actionCompleteData.list&&this.actionCompleteData.ulElement&&this.actionCompleteData.list&&(this.actionData=this.actionCompleteData)},t.prototype.addNewItem=function(e,i){var r=this;if(!g(this.itemData)&&!g(i)){var n=this.getItemData().value,s=e.some(function(a){return(typeof a=="string"||typeof a=="number"||typeof a=="boolean")&&a===n||V(r.fields.value,a)===n});s||this.addItem(this.itemData)}},t.prototype.updateActionCompleteData=function(e,i,r){var n=this;this.getModuleName()!=="autocomplete"&&this.actionCompleteData.ulElement&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){n.actionCompleteDataUpdate(e,i,r)},0):this.actionCompleteDataUpdate(e,i,r))},t.prototype.actionCompleteDataUpdate=function(e,i,r){r!==null?this.actionCompleteData.ulElement.insertBefore(e.cloneNode(!0),this.actionCompleteData.ulElement.childNodes[r]):this.actionCompleteData.ulElement.appendChild(e.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list&&this.actionCompleteData.list.indexOf(i)<0&&this.actionCompleteData.list.push(i)},t.prototype.focusIndexItem=function(){var e=this.getItemData().value;this.activeIndex=this.enableVirtualization&&!g(e)||!this.enableVirtualization?this.getIndexByValue(e):this.activeIndex;var i=this.findListElement(this.list,"li","data-value",e);this.selectedLI=i,this.activeItem(i),this.enableVirtualization&&g(i)||this.removeFocus()},t.prototype.updateSelection=function(){var e=this.list.querySelector("."+de.selected);if(e)this.setProperties({index:this.getIndexByValue(e.getAttribute("data-value"))}),this.activeIndex=this.index;else{if(this.removeFocus(),this.allowFiltering&&this.actionCompleteData&&this.actionCompleteData.ulElement&&this.dataSource instanceof oe){var i=this.actionCompleteData.ulElement.querySelectorAll("."+Je.focus);i&&i.length&&Z(i,Je.focus)}this.list.querySelector("."+de.li).classList.add(Je.focus)}},t.prototype.updateSelectionList=function(){var e=this.list&&this.list.querySelector(".e-active");if(!e&&!g(this.value)&&this.getModuleName()!=="autocomplete"){var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.list,"li","data-value",i);r&&r.classList.add("e-active")}},t.prototype.removeFocus=function(){var e=this.list.querySelectorAll("."+Je.focus);e&&e.length&&Z(e,Je.focus)},t.prototype.renderPopup=function(e){var i=this;if(this.popupObj&&document.body.contains(this.popupObj.element)){this.refreshPopup();return}var r={cancel:!1};this.trigger("beforeOpen",r,function(n){var s;if(n.cancel)i.beforePopupOpen=!1;else{var a=i.createElement("div",{id:i.element.id+"_popup",className:"e-ddl e-popup "+(i.cssClass!==null?i.cssClass:"")});a.setAttribute("aria-label",i.element.id),a.setAttribute("role","dialog");var l=i.setSearchBox(a);if(i.listContainerHeight=i.allowFiltering&&i.getModuleName()==="dropdownlist"&&j.isDevice&&i.isDeviceFullScreen?Ae(Math.round(window.outerHeight).toString()+"px"):Ae(i.popupHeight),i.headerTemplate&&(i.setHeaderTemplate(a),i.isUpdateHeaderHeight=i.header.offsetHeight!==0),bt([i.list],a),i.footerTemplate&&(i.setFooterTemplate(a),i.isUpdateFooterHeight=i.footer.offsetHeight!==0),document.body.appendChild(a),a.style.top="0px",s=a.clientHeight,i.enableVirtualization&&(i.itemTemplate||i.isAngular)){var h=a.querySelectorAll("li.e-list-item:not(.e-virtual-list)"),c=a.querySelectorAll("li.e-virtual-list"),u=h&&h.length>0?Math.ceil(h[0].getBoundingClientRect().height)+parseInt(window.getComputedStyle(h[0]).marginBottom,10):0,d=c&&c.length>0?Math.ceil(c[0].getBoundingClientRect().height)+parseInt(window.getComputedStyle(c[0]).marginBottom,10):0;u!==d&&c&&c.length>0&&c.forEach(function(k){k.parentNode.removeChild(k)}),i.listItemHeight=u}if(i.enableVirtualization&&!i.list.classList.contains(de.noData)){if(i.getSkeletonCount(),i.skeletonCount=i.totalItemCount<i.itemCount*2&&(!(i.dataSource instanceof oe)||i.dataSource instanceof oe&&i.totalItemCount<=i.itemCount)?0:i.skeletonCount,i.list.querySelector(".e-virtual-ddl-content"))i.list.getElementsByClassName("e-virtual-ddl-content")[0].style=i.getTransformValues();else{var p=i.createElement("div",{className:"e-virtual-ddl-content"});p.style.cssText=i.getTransformValues(),i.list.appendChild(p).appendChild(i.list.querySelector(".e-list-parent"))}if(i.UpdateSkeleton(),i.liCollections=i.list.querySelectorAll("."+de.li),i.virtualItemCount=i.itemCount,i.list.querySelector(".e-virtual-ddl"))i.list.getElementsByClassName("e-virtual-ddl")[0].style=i.GetVirtualTrackHeight();else{var f=i.createElement("div",{id:i.element.id+"_popup",className:"e-virtual-ddl"});f.style.cssText=i.GetVirtualTrackHeight(),a.querySelector(".e-dropdownbase").appendChild(f)}}if(a.style.visibility="hidden",i.popupHeight!=="auto"){if(i.searchBoxHeight=0,!g(l.container)&&i.getModuleName()!=="combobox"&&i.getModuleName()!=="autocomplete"&&(i.searchBoxHeight=l.container.parentElement.getBoundingClientRect().height,i.listContainerHeight=(parseInt(i.listContainerHeight,10)-i.searchBoxHeight).toString()+"px"),i.headerTemplate){i.header=i.header?i.header:a.querySelector(".e-ddl-header");var v=Math.round(i.header.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(v+i.searchBoxHeight)).toString()+"px"}if(i.footerTemplate){i.footer=i.footer?i.footer:a.querySelector(".e-ddl-footer");var v=Math.round(i.footer.getBoundingClientRect().height);i.listContainerHeight=(parseInt(i.listContainerHeight,10)-(v+i.searchBoxHeight)).toString()+"px"}i.list.style.maxHeight=(parseInt(i.listContainerHeight,10)-2).toString()+"px",a.style.maxHeight=Ae(i.popupHeight)}else a.style.height="auto";var m=0,y=void 0;if(i.isPreventScrollAction=!0,!g(i.selectedLI)&&!g(i.activeIndex)&&i.activeIndex>=0||i.enableVirtualization?i.setScrollPosition():i.list.scrollTop=0,j.isDevice&&i.isDeviceFullScreen&&!i.allowFiltering&&(i.getModuleName()==="dropdownlist"||i.isDropDownClick&&i.getModuleName()==="combobox")){m=i.getOffsetValue(a);var b=i.isEmptyList()?i.list:i.liCollections[0];g(i.inputElement)||(y=-(parseInt(getComputedStyle(b).textIndent,10)-parseInt(getComputedStyle(i.inputElement).paddingLeft,10)+parseInt(getComputedStyle(i.inputElement.parentElement).borderLeftWidth,10)))}i.createPopup(a,m,y),i.popupContentElement=i.popupObj.element.querySelector(".e-content"),i.getFocusElement(),i.checkCollision(a),j.isDevice&&(parseInt(i.popupWidth.toString(),10)>window.outerWidth&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)&&i.popupObj.element.classList.add("e-wide-popup"),i.popupObj.element.classList.add(Je.device),(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox"&&!i.allowFiltering&&i.isDropDownClick)&&(i.popupObj.collision={X:"fit",Y:"fit"}),i.isFilterLayout()&&i.isDeviceFullScreen&&(i.popupObj.element.classList.add(Je.mobileFilter),i.popupObj.position={X:0,Y:0},i.popupObj.dataBind(),Ee(i.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),X([document.body,i.popupObj.element],Je.popupFullScreen),i.setSearchBoxPosition(),i.backIconElement=l.container.querySelector(".e-back-icon"),i.clearIconElement=l.container.querySelector("."+Je.clearIcon),T.add(i.backIconElement,"click",i.clickOnBackIcon,i),T.add(i.clearIconElement,"click",i.clearText,i))),a.style.visibility="visible",X([a],"e-popup-close");for(var S=i.popupObj.getScrollableParent(i.inputWrapper.container),C=0,x=S;C<x.length;C++){var I=x[C];T.add(I,"scroll",i.scrollHandler,i)}g(i.list)||(i.unWireListEvents(),i.wireListEvents()),i.selectedElementID=i.selectedLI?i.selectedLI.id:null,i.enableVirtualization&&(i.notify("bindScrollEvent",{module:"VirtualScroll",component:i.getModuleName(),enable:i.enableVirtualization}),setTimeout(function(){(i.value||i.list.querySelector(".e-active"))&&(i.updateSelectionList(),i.viewPortInfo&&i.viewPortInfo.offsets.top?i.list.scrollTop=i.viewPortInfo.offsets.top:i.scrollBottom(!0,!0))},5)),Ee(i.targetElement(),{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.getModuleName()!=="dropdownlist"&&i.list.classList.contains("e-nodata")&&(Ee(i.targetElement(),{"aria-activedescendant":"no-record"}),i.popupContentElement.setAttribute("role","status"),i.popupContentElement.setAttribute("id","no-record")),i.inputElement.setAttribute("aria-expanded","true"),i.inputElement.setAttribute("aria-controls",i.element.id+"_popup");var D=i.isFiltering()?i.filterInput.parentElement:i.inputWrapper.container;X([D],[Je.inputFocus]);var M={name:"FadeIn",duration:100};i.beforePopupOpen=!0;var E=i.popupObj,A={popup:E,event:e,cancel:!1,animation:M};if(i.trigger("open",A,function(k){k.cancel?(i.beforePopupOpen=!1,i.destroyPopup()):(g(i.inputWrapper)||X([i.inputWrapper.container],[Je.iconAnimation]),i.renderReactTemplates(),i.isReact&&i.isFiltering()&&i.dataSource instanceof oe&&i.list.querySelector("ul")&&!i.isSecondClick&&i.executeCloneElements(),g(i.popupObj)||(i.popupObj.show(new Mt(k.animation),i.zIndex===1e3?i.element:null),i.isPopupRender=!0),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"&&!(i.getModuleName()==="dropdownlist"&&i.allowFiltering)){var B=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var F=i.list.style.maxHeight===""?B:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(F-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var F=i.list.style.maxHeight===""?B:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(F-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15))}),i.allowResize&&(i.getModuleName()!=="dropdownlist"||!(j.isDevice&&i.isDeviceFullScreen&&i.allowFiltering))){var L=16;if(i.resizer=i.createElement("div",{id:i.element.id+"_resize-popup",className:Je.resizeIcon}),i.list&&i.list.parentElement){if(i.list.parentElement.classList.add("e-resize"),i.popupHeight.toString().toLowerCase()!=="auto"&&s>=parseInt(i.popupHeight.toString(),10)-2&&(i.list.parentElement.style.height="100%"),i.list.parentElement.style.paddingBottom=i.getModuleName()==="dropdownlist"&&i.allowFiltering&&i.searchBoxHeight?(i.searchBoxHeight+L).toString()+"px":L.toString()+"px",i.isReact&&i.footer){var N=i.list.style.maxHeight,R=i.list.parentElement.style.maxHeight,P=i.listContainerHeight;setTimeout(function(){i.footer=i.footer?i.footer:a.querySelector(".e-ddl-footer");var k=Math.round(i.footer.getBoundingClientRect().height);k>0&&(P=(parseInt(P,10)-k).toString()+"px",N=(parseInt(P,10)-2).toString()+"px",i.list.parentElement.style.paddingBottom=(parseInt(R,10)-parseInt(N,10)+L).toString()+"px")},1)}else(i.header||i.footer||i.itemTemplate)&&(i.list.parentElement.style.paddingBottom=(parseInt(i.list.parentElement.style.maxHeight,10)-parseInt(i.list.style.maxHeight,10)+L).toString()+"px");i.list.parentElement.appendChild(i.resizer),i.list.parentElement.style.width=i.resizeWidth+"px",i.list.parentElement.style.height=i.resizeHeight+"px",i.list.parentElement.style.maxHeight=i.resizeHeight+"px",i.list.style.maxHeight=i.resizeHeight+"px"}T.add(i.resizer,"mousedown",i.startResizing,i),T.add(i.resizer,"touchstart",i.startResizing,i)}}})},t.prototype.checkCollision=function(e){if(!j.isDevice||j.isDevice&&!(this.getModuleName()==="dropdownlist"||this.isDropDownClick)){var i=gs(e);i.length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"),this.popupObj.resolveCollision()}},t.prototype.getOffsetValue=function(e){var i=getComputedStyle(e),r=parseInt(i.borderTopWidth,10),n=parseInt(i.borderBottomWidth,10);return this.setPopupPosition(r+n)},t.prototype.createPopup=function(e,i,r){var n=this;this.popupObj=new es(e,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.enableRtl,offsetX:r,position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:function(){n.isDocumentClick||n.focusDropDown(),n.isReact&&n.clearTemplate(["headerTemplate","footerTemplate"]),n.isNotSearchList=!1,n.isDocumentClick=!1,n.destroyPopup(),n.isFiltering()&&n.actionCompleteData.list&&n.actionCompleteData.list.length>0?(n.isActive=!0,n.isReactTemplateUpdate&&n.isReact&&n.itemTemplate&&!n.enableVirtualization&&(n.actionCompleteData.ulElement=n.renderItems(n.actionCompleteData.list,n.fields),n.isReactTemplateUpdate=!1),n.enableVirtualization?n.onActionComplete(n.ulElement,n.listData,null,!0):n.onActionComplete(n.actionCompleteData.ulElement,n.actionCompleteData.list,null,!0)):n.enableVirtualization&&n.focusIndexItem()},open:function(){T.add(document,"mousedown",n.onDocumentClick,n),n.isPopupOpen=!0;var s=n.actionCompleteData&&n.actionCompleteData.ulElement&&n.actionCompleteData.ulElement.querySelector("li"),a=n.list.querySelector("ul li");!g(n.ulElement)&&!g(n.ulElement.getElementsByClassName("e-item-focus")[0])?Ee(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-item-focus")[0].id}):!g(n.ulElement)&&!g(n.ulElement.getElementsByClassName("e-active")[0])&&Ee(n.targetElement(),{"aria-activedescendant":n.ulElement.getElementsByClassName("e-active")[0].id}),n.isFiltering()&&n.itemTemplate&&n.element.tagName===n.getNgDirective()&&s&&a&&s.textContent!==a.textContent&&n.element.tagName!=="EJS-COMBOBOX"&&n.cloneElements(),n.isFilterLayout()&&(Z([n.inputWrapper.container],[Je.inputFocus]),n.isFilterFocus=!0,n.filterInput.focus(),n.inputWrapper.clearButton&&X([n.inputWrapper.clearButton],Je.clearIconHide)),n.activeStateChange()},targetExitViewport:function(){j.isDevice||n.hidePopup()}})},t.prototype.isEmptyList=function(){return!g(this.liCollections)&&this.liCollections.length===0},t.prototype.getFocusElement=function(){},t.prototype.isFilterLayout=function(){return this.getModuleName()==="dropdownlist"&&this.allowFiltering},t.prototype.scrollHandler=function(){j.isDevice&&(this.getModuleName()==="dropdownlist"&&!this.isFilterLayout()||this.getModuleName()==="combobox"&&!this.allowFiltering&&this.isDropDownClick)&&this.element&&!this.isElementInViewport(this.element)&&this.hidePopup()},t.prototype.isElementInViewport=function(e){var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=window.innerHeight&&i.right<=window.innerWidth},t.prototype.setSearchBoxPosition=function(){var e=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-e+"px",this.list.style.height=window.innerHeight-e+"px";var i=this.filterInput.parentElement.querySelector("."+Je.clearIcon);se(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},t.prototype.setPopupPosition=function(e){var i,r=e,n=this.list.querySelector("."+Je.focus)||this.selectedLI,s=this.isEmptyList()?this.list:this.liCollections[0],a=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],l=s.getBoundingClientRect().height;this.listItemHeight=l+parseInt(window.getComputedStyle(s).marginBottom,10);var h=this.list.offsetHeight/2,c=g(n)?s.offsetTop:n.offsetTop,u=a.offsetTop;if(u-h<c&&!g(this.liCollections)&&this.liCollections.length>0&&!g(n)){var d=this.list.offsetHeight/l,p=parseInt(getComputedStyle(this.list).paddingBottom,10);i=(d-(this.liCollections.length-this.activeIndex))*l-r+p,this.list.scrollTop=n.offsetTop}else c>h&&!this.enableVirtualization?(i=h-l/2,this.list.scrollTop=c-h+l/2):i=c;var f=this.inputWrapper.container.offsetHeight;return i=i+l+r-(l-f)/2,-i},t.prototype.setWidth=function(){var e=Ae(this.popupWidth);if(e.indexOf("%")>-1){var i=this.inputWrapper.container.offsetWidth*parseFloat(e)/100;e=i.toString()+"px"}if(j.isDevice&&e.indexOf("px")>-1&&!this.allowFiltering&&(this.getModuleName()==="dropdownlist"||this.isDropDownClick&&this.getModuleName()==="combobox")){var r=this.isEmptyList()?this.list:this.liCollections[0];e=parseInt(e,10)+(parseInt(getComputedStyle(r).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))*2+"px"}return e},t.prototype.scrollBottom=function(e,i,r){var n=this;if(i===void 0&&(i=!1),r===void 0&&(r=null),g(this.selectedLI)&&this.enableVirtualization&&(this.selectedLI=this.list.querySelector("."+de.li),!g(this.selectedLI)&&this.selectedLI.classList.contains("e-virtual-list")&&(this.selectedLI=this.liCollections[this.skeletonCount])),!g(this.selectedLI)){var s=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0;this.isUpwardScrolling=!1;var a=this.list.querySelectorAll(".e-virtual-list").length,l=this.list.querySelector("li:last-of-type")?this.list.querySelector("li:last-of-type").getAttribute("data-value"):null,h=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+s):this.selectedLI.offsetTop,c=this.list.offsetHeight,u=h-a*(this.selectedLI.offsetHeight+s)+(this.selectedLI.offsetHeight+s)-this.list.scrollTop,d=this.list.scrollTop+u-c,p=!1;d=e?d+parseInt(getComputedStyle(this.list).paddingTop,10)*2:d+parseInt(getComputedStyle(this.list).paddingTop,10);var f=h-a*(this.selectedLI.offsetHeight+s)+(this.selectedLI.offsetHeight+s)-this.list.scrollTop;if(f=this.fields.groupBy&&!g(this.fixedHeaderElement)?f-this.fixedHeaderElement.offsetHeight:f,this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0,p=this.isKeyBoardAction;else if(u>c||!(f>0&&this.list.offsetHeight>f)){var v=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,m=r==="pageDown"?this.getPageCount()-2:1;!this.enableVirtualization||this.isKeyBoardAction||i?this.isKeyBoardAction&&this.enableVirtualization&&l&&v===l&&r!=="end"&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.enableVirtualization&&this.itemTemplate?this.list.scrollTop+=d:(this.enableVirtualization&&(m=r==="pageDown"?this.getPageCount()+1:m),this.list.scrollTop+=(this.selectedLI.offsetHeight+s)*m),this.isPreventKeyAction=this.IsScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r==="end"?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(r==="pageDown"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=d):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?e&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,p=this.isKeyBoardAction}this.isKeyBoardAction=p,this.enableVirtualization&&this.fields.groupBy&&this.fixedHeaderElement&&r==="down"&&setTimeout(function(){n.scrollStop(null,!0)},100)}},t.prototype.scrollTop=function(e){if(e===void 0&&(e=null),!g(this.selectedLI)){var i=this.selectedLI&&!isNaN(parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10))?parseInt(window.getComputedStyle(this.selectedLI).marginBottom,10):0,r=this.list.querySelectorAll(".e-virtual-list").length,n=this.virtualListInfo&&this.virtualListInfo.startIndex?this.selectedLI.offsetTop+this.virtualListInfo.startIndex*(this.selectedLI.offsetHeight+i):this.selectedLI.offsetTop,s=n-r*(this.selectedLI.offsetHeight+i)-this.list.scrollTop,a=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;s=this.fields.groupBy&&!g(this.fixedHeaderElement)?s-this.fixedHeaderElement.offsetHeight:s;var l=n-r*(this.selectedLI.offsetHeight+i)+(this.selectedLI.offsetHeight+i)-this.list.scrollTop,h=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&s<=0;if(this.activeIndex===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(s<0||h){var c=this.selectedLI?this.selectedLI.getAttribute("data-value"):null,u=e==="pageUp"?this.getPageCount()-2:1;this.enableVirtualization&&(u=e==="pageUp"?this.getPageCount():u),this.enableVirtualization&&this.isKeyBoardAction&&a&&c===a&&e!=="home"&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.list.scrollTop-=(this.selectedLI.offsetHeight+i)*u,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&e==="home"?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(e==="pageUp"&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+s)}else l>0&&this.list.offsetHeight>l||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!g(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},t.prototype.IsScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},t.prototype.isEditTextBox=function(){return!1},t.prototype.isFiltering=function(){return this.allowFiltering},t.prototype.isPopupButton=function(){return!0},t.prototype.setScrollPosition=function(e){if(this.isPreventScrollAction=!0,g(e))this.scrollBottom(!0);else switch(e.action){case"pageDown":case"down":case"end":this.isKeyBoardAction=!0,this.scrollBottom(!1,!1,e.action);break;default:this.isKeyBoardAction=e.action==="up"||e.action==="pageUp"||e.action==="open",this.scrollTop(e.action);break}this.isKeyBoardAction=!1},t.prototype.clearText=function(){this.filterInput.value=this.typedString="",this.searchLists(null),this.enableVirtualization&&(this.list.scrollTop=0,this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0]&&(this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight()),this.getSkeletonCount(),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()))},t.prototype.setEleWidth=function(e){g(e)||(typeof e=="number"?this.inputWrapper.container.style.width=Ae(e):typeof e=="string"&&(this.inputWrapper.container.style.width=e.match(/px|%|em/)?e:Ae(e)))},t.prototype.closePopup=function(e,i){var r=this,n=!g(this.filterInput)&&!g(this.filterInput.value)&&this.filterInput.value!=="",s=this.getModuleName()==="combobox"?this.typedString:null;if(this.isTyped=!1,this.isVirtualTrackHeight=!1,!!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen)){this.keyboardEvent=null,T.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.isDropDownClick=!1,this.preventAutoFill=!1;for(var a=this.popupObj.getScrollableParent(this.inputWrapper.container),l=0,h=a;l<h.length;l++){var c=h[l];T.remove(c,"scroll",this.scrollHandler)}j.isDevice&&this.isFilterLayout()&&this.isDeviceFullScreen&&Z([document.body,this.popupObj.element],Je.popupFullScreen),this.isFilterLayout()&&(j.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&T.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(T.remove(this.backIconElement,"click",this.clickOnBackIcon),T.remove(this.clearIconElement,"click",this.clearText)),g(this.filterInput)||(T.remove(this.filterInput,"input",this.onInput),T.remove(this.filterInput,"keyup",this.onFilterUp),T.remove(this.filterInput,"keydown",this.onFilterDown),T.remove(this.filterInput,"blur",this.onBlurHandler),T.remove(this.filterInput,"paste",this.pasteHandler)),this.allowFiltering&&this.getModuleName()==="dropdownlist"&&(this.filterInput.removeAttribute("aria-activedescendant"),this.filterInput.removeAttribute("aria-disabled"),this.filterInput.removeAttribute("role"),this.filterInput.removeAttribute("autocomplete"),this.filterInput.removeAttribute("autocapitalize"),this.filterInput.removeAttribute("spellcheck")),this.filterInput=null),Ee(this.targetElement(),{"aria-expanded":"false"}),this.inputElement.setAttribute("aria-expanded","false"),this.targetElement().removeAttribute("aria-owns"),this.targetElement().removeAttribute("aria-activedescendant"),this.inputWrapper.container.classList.remove(Je.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.enableVirtualization&&(this.value==null||this.isTyped?(this.viewPortInfo.endIndex=this.viewPortInfo&&this.viewPortInfo.endIndex>0?this.viewPortInfo.endIndex:this.itemCount,(this.getModuleName()==="autocomplete"||this.getModuleName()==="dropdownlist"&&!g(this.typedString)&&this.typedString!==""||this.getModuleName()==="combobox"&&this.allowFiltering&&!g(this.typedString)&&this.typedString!=="")&&this.checkAndResetCache()):this.getModuleName()==="autocomplete"&&this.checkAndResetCache(),(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.skeletonCount!==0&&this.getSkeletonCount(!0)),this.beforePopupOpen=!1;var u={name:"FadeOut",duration:100,delay:e||0},d=this.popupObj,p={popup:d,cancel:!1,animation:u,event:i||null};this.trigger("close",p,function(v){if(r.getModuleName()==="dropdownlist"&&Ie.destroy({element:r.filterInput,floatLabelType:r.floatLabelType,properties:{placeholder:r.filterBarPlaceholder},buttons:r.clearIconElement},r.clearIconElement),r.filterInputObj=null,!g(r.popupObj)&&!g(r.popupObj.element.querySelector(".e-fixed-head"))){var m=r.popupObj.element.querySelector(".e-fixed-head");m.parentNode.removeChild(m),r.fixedHeaderElement=null}v.cancel||(r.getModuleName()==="autocomplete"&&r.rippleFun(),r.isPopupOpen?(r.isPopupRender=!1,r.popupObj.hide(new Mt(v.animation))):r.destroyPopup())}),j.isDevice&&!p.cancel&&this.popupObj.element.classList.contains("e-wide-popup")&&this.popupObj.element.classList.remove("e-wide-popup");var f;this.dataSource instanceof oe?f=this.remoteDataCount:f=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.customFilterQuery=null,this.enableVirtualization&&this.isFiltering()&&n&&this.totalItemCount!==f&&(this.updateInitialData(),this.checkAndResetCache())}},t.prototype.updateInitialData=function(){var e=this.selectData;if(!g(e)){var i=this.renderItems(e,this.fields);if(this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.getModuleName()==="combobox"&&(this.typedString=""),this.previousStartIndex=0,this.previousEndIndex=0,this.dataSource instanceof oe?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.list.parentElement){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(r)}this.getModuleName()!=="autocomplete"&&this.totalItemCount!==0&&this.totalItemCount>this.itemCount*2&&this.getSkeletonCount(),this.UpdateSkeleton(),this.listData=e,this.updateActionCompleteDataValues(i,e),this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}},t.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.inputElement.removeAttribute("aria-controls"),this.popupObj&&(this.resizer&&(T.remove(this.resizer,"mousedown",this.startResizing),T.remove(this.resizer,"touchstart",this.startResizing)),this.popupObj.destroy(),se(this.popupObj.element))},t.prototype.clickOnBackIcon=function(){this.hidePopup(),this.focusIn()},t.prototype.render=function(){this.preselectedIndex=g(this.index)?null:this.index,this.element.tagName==="INPUT"?(this.inputElement=this.element,g(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","combobox"),g(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text"),this.inputElement.setAttribute("aria-expanded","false")):(this.inputElement=this.createElement("input",{attrs:{role:"combobox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement));var e=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(e=this.cssClass.replace(/\s+/g," ").trim()),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),this.inputWrapper=Ie.createInput({element:this.inputElement,buttons:this.isPopupButton()?[Je.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:this.getModuleName()==="dropdownlist"?!0:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:Je.hiddenElement}}),$r([this.hiddenElement],this.inputWrapper.container),this.hiddenElement.hasAttribute("aria-label")||this.hiddenElement.setAttribute("aria-label",this.getModuleName()),this.validationAttribute(this.element,this.hiddenElement),this.setReadOnly(),this.setFields(),this.inputWrapper.container.style.width=Ae(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.floatLabelType!=="Never"&&Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.updateFloatLabelOverflowWidth(),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");var i=this.element.getAttribute("id")?this.element.getAttribute("id"):Lt("ej2_dropdownlist");if(this.element.id=i,this.hiddenElement.id=i+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&!this.readonly?this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()):this.getModuleName()==="dropdownlist"&&(this.targetElement().hasAttribute("aria-label")||Ee(this.targetElement(),{"aria-label":this.getModuleName()}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.inputElement.setAttribute("aria-expanded","false")),Ee(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),this.targetElement()===this.inputElement&&this.inputElement.removeAttribute("aria-labelledby"),this.value!==null||this.activeIndex!==null||this.text!==null)this.enableVirtualization&&(this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.index!==null&&(this.activeIndex=this.index+this.skeletonCount)),this.initValue(),this.selectedValueInfo=this.viewPortInfo,this.enableVirtualization&&(this.activeIndex=this.activeIndex+this.skeletonCount);else if(this.element.tagName==="SELECT"&&this.element.options[0]){var r=this.element;this.value=this.allowObjectBinding?this.getDataByValue(r.options[r.selectedIndex].value):r.options[r.selectedIndex].value,this.text=g(this.value)?null:r.options[r.selectedIndex].textContent,this.initValue()}this.setEnabled(),this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=function(s){s.stopImmediatePropagation()},this.inputElement.onchange=function(s){s.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),g(this.text)||this.inputElement.setAttribute("value",this.text),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false");var n=this.inputWrapper.container.getElementsByClassName("e-float-text")[0];!g(this.element.id)&&this.element.id!==""&&!g(n)&&(n.id="label_"+this.element.id.replace(/ /g,"_"),Ee(this.inputElement,{"aria-labelledby":n.id})),this.renderComplete(),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount},t.prototype.getListHeight=function(){var e=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=Ae(this.popupHeight);e.style.height=parseInt(r,10).toString()+"px",e.appendChild(i),document.body.appendChild(e),this.virtualListHeight=e.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return e.remove(),n},t.prototype.setFooterTemplate=function(e){var i;this.footer?this.isReact&&typeof this.footerTemplate=="function"?this.clearTemplate(["footerTemplate"]):this.footer.innerHTML="":(this.footer=this.createElement("div"),X([this.footer],Je.footer));var r=this.dropdownCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&r?i=Et(J(this.footerTemplate,document).innerHTML.trim()):i=Et(this.footerTemplate);var n=i({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);n&&n.length>0&&bt(n,this.footer),bt([this.footer],e)},t.prototype.setHeaderTemplate=function(e){var i;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),X([this.header],Je.header));var r=this.dropdownCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&r?i=Et(J(this.headerTemplate,document).innerHTML.trim()):i=Et(this.headerTemplate);var n=i({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);n&&n.length&&bt(n,this.header);var s=e.querySelector("div.e-content");e.insertBefore(this.header,s)},t.prototype.setEnabled=function(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")},t.prototype.setOldText=function(e){this.text=e},t.prototype.setOldValue=function(e){this.value=e},t.prototype.refreshPopup=function(){!g(this.popupObj)&&document.body.contains(this.popupObj.element)&&(this.allowFiltering&&!(j.isDevice&&this.isFilterLayout())||this.getModuleName()==="autocomplete")&&(Z([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container),this.popupObj.resolveCollision())},t.prototype.checkData=function(e){e.dataSource&&!g(Object.keys(e.dataSource))&&this.itemTemplate&&this.allowFiltering&&!(this.isListSearched&&e.dataSource instanceof oe)&&(this.list&&!this.isReact?this.list.innerHTML="":this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1}),this.isListSearched=!1;var i=Object.keys(e).indexOf("value")!==-1&&g(e.value),r=Object.keys(e).indexOf("text")!==-1&&g(e.text);this.getModuleName()!=="autocomplete"&&this.allowFiltering&&(i||r)&&(this.itemData=null),this.allowFiltering&&e.dataSource&&!g(Object.keys(e.dataSource))?(this.actionCompleteData={ulElement:null,list:null,isUpdated:!1},this.actionData=this.actionCompleteData):this.allowFiltering&&e.query&&!g(Object.keys(e.query))&&(this.actionCompleteData=this.getModuleName()==="combobox"?{ulElement:null,list:null,isUpdated:!1}:this.actionCompleteData,this.actionData=this.actionCompleteData)},t.prototype.updateDataSource=function(e,i){(this.inputElement.value!==""||!g(e)&&(g(e.dataSource)||!(e.dataSource instanceof oe)&&e.dataSource.length===0))&&this.clearAll(null,e),this.fields.groupBy&&e.fields&&!this.isGroupChecking&&this.list&&(T.remove(this.list,"scroll",this.setFloatingHeader),T.add(this.list,"scroll",this.setFloatingHeader,this)),(!(!g(e)&&(g(e.dataSource)||!(e.dataSource instanceof oe)&&e.dataSource.length===0))||e.dataSource instanceof oe||!g(e)&&Array.isArray(e.dataSource)&&!g(i)&&Array.isArray(i.dataSource)&&e.dataSource.length!==i.dataSource.length)&&(this.typedString="",this.resetList(this.dataSource)),!this.isCustomFilter&&!this.isFilterFocus&&document.activeElement!==this.filterInput&&this.checkCustomValue()},t.prototype.checkCustomValue=function(){var e=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(e);var i=this.getItemData(),r=this.allowObjectBinding?this.itemData:i.value,n=g(r)?null:this.index;g(n)&&e===r||this.isAngular?this.setProperties({text:i.text?i.text.toString():i.text,value:r}):this.setProperties({text:i.text?i.text.toString():i.text,index:n,value:r})},t.prototype.updateInputFields=function(){this.getModuleName()==="dropdownlist"&&Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onPropertyChanged=function(e,i){var r=this;!g(e.dataSource)&&!this.isTouched&&g(e.value)&&g(e.index)&&!g(this.preselectedIndex)&&!g(this.index)&&(e.index=this.index),(!g(e.value)||!g(e.index))&&(this.isTouched=!0),this.getModuleName()==="dropdownlist"&&(this.checkData(e),this.setUpdateInitial(["fields","query","dataSource"],e));for(var n=function(u){switch(u){case"query":case"dataSource":s.getSkeletonCount(),s.checkAndResetCache();break;case"htmlAttributes":s.setHTMLAttributes();break;case"width":s.setEleWidth(e.width),Ie.calculateWidth(s.inputElement,s.inputWrapper.container);break;case"placeholder":Ie.setPlaceholder(e.placeholder,s.inputElement);break;case"filterBarPlaceholder":s.filterInput&&Ie.setPlaceholder(e.filterBarPlaceholder,s.filterInput);break;case"readonly":s.getModuleName()!=="dropdownlist"&&Ie.setReadonly(e.readonly,s.inputElement),s.setReadOnly();break;case"cssClass":s.setCssClass(e.cssClass,i.cssClass),Ie.calculateWidth(s.inputElement,s.inputWrapper.container);break;case"enableRtl":s.setEnableRtl();break;case"enabled":s.setEnable();break;case"text":if(s.fields.disabled&&(e.text=e.text&&!s.isDisabledItemByIndex(s.getIndexByValue(s.getValueByText(e.text)))?e.text:null),e.text===null){s.clearAll();break}if(s.enableVirtualization){s.updateValues(),s.updateInputFields(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"});break}if(s.list||(s.dataSource instanceof oe&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender){var d=s.getElementByText(e.text);if(!s.checkValidLi(d))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(e.text,i.text,"text");else if(e.text&&s.dataSource instanceof oe){var p=s.getItems().length,f=g(s.fields.text)?s.fields.value:s.fields.text;s.typedString="",s.dataSource.executeQuery(s.getQuery(s.query).where(new xt(f,"equal",e.text))).then(function(x){x.result.length>0?(r.addItem(x.result,p),r.updateValues()):r.setOldText(i.text)})}else s.getModuleName()==="autocomplete"?s.setInputValue(e,i):s.setOldText(i.text);s.updateInputFields()}break;case"value":if(s.fields.disabled&&(e.value=e.value!=null&&!s.isDisableItemValue(e.value)?e.value:null),e.value===null){s.clearAll();break}if(s.allowObjectBinding&&!g(e.value)&&!g(i.value)&&s.isObjectInArray(e.value,[i.value]))return{value:void 0};if(s.enableVirtualization){s.updateValues(),s.updateInputFields(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}),s.preventChange=s.isAngular&&s.preventChange?!s.preventChange:s.preventChange;break}if(s.notify("beforeValueChange",{newProp:e}),s.list||(s.dataSource instanceof oe&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender){var v=s.allowObjectBinding&&!g(e.value)?V(s.fields.value?s.fields.value:"",e.value):e.value,m=s.getElementByValue(v);if(!s.checkValidLi(m))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(e.value,i.value,"value");else if(e.value&&s.dataSource instanceof oe){var y=s.getItems().length,f=g(s.fields.value)?s.fields.text:s.fields.value;s.typedString="";var b=s.allowObjectBinding&&!g(e.value)?V(f,e.value):e.value;s.dataSource.executeQuery(s.getQuery(s.query).where(new xt(f,"equal",b))).then(function(I){I.result.length>0?(r.addItem(I.result,y),r.updateValues()):r.setOldValue(i.value)})}else s.getModuleName()==="autocomplete"?s.setInputValue(e,i):s.setOldValue(i.value);s.updateInputFields(),s.preventChange=s.isAngular&&s.preventChange?!s.preventChange:s.preventChange}break;case"index":if(s.fields.disabled&&(e.index=e.index!=null&&!s.isDisabledItemByIndex(e.index)?e.index:null),e.index===null){s.clearAll();break}if(s.list||(s.dataSource instanceof oe&&(s.initialRemoteRender=!0),s.renderList()),!s.initialRemoteRender&&s.liCollections){var S=s.liCollections[e.index];s.checkValidLi(S)||(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100?s.setSelectionData(e.index,i.index,"index"):s.index=i.index),s.updateInputFields()}break;case"footerTemplate":s.popupObj&&s.setFooterTemplate(s.popupObj.element);break;case"headerTemplate":s.popupObj&&s.setHeaderTemplate(s.popupObj.element);break;case"valueTemplate":!g(s.itemData)&&s.valueTemplate!==null&&s.setValueTemplate();break;case"allowFiltering":s.allowFiltering&&(s.actionCompleteData={ulElement:s.ulElement,list:s.listData,isUpdated:!0},s.actionData=s.actionCompleteData,s.updateSelectElementData(s.allowFiltering));break;case"floatLabelType":Ie.removeFloating(s.inputWrapper),Ie.addFloating(s.inputElement,e.floatLabelType,s.placeholder,s.createElement),!g(s.inputWrapper.buttons[0])&&s.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0]&&s.floatLabelType!=="Never"&&s.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"showClearButton":s.inputWrapper.clearButton||(Ie.setClearButton(e.showClearButton,s.inputElement,s.inputWrapper,null,s.createElement),s.bindClearEvent());break;default:{var C=s.getPropObject(u,e,i);o.prototype.onPropertyChanged.call(s,C.newProperty,C.oldProperty)}break}},s=this,a=0,l=Object.keys(e);a<l.length;a++){var h=l[a],c=n(h);if(typeof c=="object")return c.value}},t.prototype.checkValidLi=function(e){return this.isValidLI(e)?(this.setSelection(e,null),!0):!1},t.prototype.setSelectionData=function(e,i,r){var n=this,s;this.updateListValues=function(){if(r==="text")s=n.getElementByText(e),n.checkValidLi(s)||n.setOldText(i);else if(r==="value"){var a=n.fields.value?n.fields.value:"",l=n.allowObjectBinding&&!g(e)?V(a,e):e;s=n.getElementByValue(e),n.checkValidLi(s)||n.setOldValue(i)}else r==="index"&&(s=n.liCollections[e],n.checkValidLi(s)||(n.index=i))}},t.prototype.updatePopupState=function(){this.beforePopupOpen&&(this.beforePopupOpen=!1,this.showPopup())},t.prototype.setReadOnly=function(){this.readonly?X([this.inputWrapper.container],["e-readonly"]):Z([this.inputWrapper.container],["e-readonly"])},t.prototype.setInputValue=function(e,i){},t.prototype.setCssClass=function(e,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(e)||(e=e.replace(/\s+/g," ").trim()),Ie.setCssClass(e,[this.inputWrapper.container],i),this.popupObj&&Ie.setCssClass(e,[this.popupObj.element],i)},t.prototype.getRightIconsWidth=function(){for(var e=this.inputWrapper.container,i=0,r=".e-input-group-icon, .e-clear-icon",n=e.querySelectorAll(r),s=0;s<n.length;s++)i+=n[s].offsetWidth;return i},t.prototype.updateFloatLabelOverflowWidth=function(){var e=this.inputWrapper.container,i=e.querySelector(".e-float-text"),r=e.clientWidth-this.getRightIconsWidth();i&&r&&(i.style.width=r+"px")},t.prototype.getModuleName=function(){return"dropdownlist"},t.prototype.showPopup=function(e){if(this.enabled){if(this.getModuleName()==="dropdownlist"&&this.beforePopupOpen&&!this.isPopupOpen&&(this.beforePopupOpen=!1),this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,this.isReact&&this.getModuleName()==="combobox"&&this.itemTemplate&&this.isCustomFilter&&this.isAddNewItemTemplate&&(this.renderList(),this.isAddNewItemTemplate=!1),this.isFiltering()&&this.dataSource instanceof oe&&this.actionData.list!==this.actionCompleteData.list&&this.actionData.list&&this.actionData.ulElement&&(this.actionCompleteData=this.actionData,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)),this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):(g(this.list)||!Te(this.list)&&(this.list.classList.contains(de.noData)||this.list.querySelectorAll("."+de.li).length<=0))&&(this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&(this.isSecondClick=!1),this.renderList(e)),this.enableVirtualization&&this.listData&&this.listData.length&&(!g(this.value)&&(this.getModuleName()==="dropdownlist"||this.getModuleName()==="combobox")&&this.removeHover(),this.beforePopupOpen||this.notify("setCurrentViewDataAsync",{module:"VirtualScroll"})),this.beforePopupOpen&&this.invokeRenderPopup(e),this.enableVirtualization&&!this.allowFiltering&&this.selectedValueInfo!=null&&this.selectedValueInfo.startIndex>0&&this.value!=null&&this.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),!this.isSecondClick&&!this.isDropDownClick&&this.executeCloneElements()}},t.prototype.executeCloneElements=function(){var e=this,i=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isReact&&this.isFiltering()&&this.itemTemplate!=null&&setTimeout(function(){e.cloneElements(),e.isSecondClick=!(e.isReact&&e.isFiltering()&&e.dataSource instanceof oe&&!e.list.querySelector("ul"))},i)},t.prototype.invokeRenderPopup=function(e){if(j.isDevice&&this.isFilterLayout()){var i=this;window.onpopstate=function(){i.hidePopup()},history.pushState({},"")}!g(this.list)&&(!g(this.list.children[0])||this.list.classList.contains(de.noData))&&this.renderPopup(e)},t.prototype.renderHightSearch=function(){},t.prototype.hidePopup=function(e){if(this.isEscapeKey&&this.getModuleName()==="dropdownlist")if(g(this.inputElement)||Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,g(this.index))this.resetSelection();else{var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value):this.value,r=this.findListElement(this.ulElement,"li","data-value",i);this.selectedLI=this.liCollections[this.index]||r,this.selectedLI&&(this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&this.itemData!==null&&this.setValueTemplate())}this.isVirtualTrackHeight=!1,this.customFilterQuery=null,this.closePopup(0,e);var n=this.getItemData(),s=!g(this.selectedLI);s&&this.enableVirtualization&&this.selectedLI.classList&&(s=this.selectedLI.classList.contains("e-active")),this.inputElement&&this.inputElement.value===""&&!this.isInteracted&&(this.isSelectCustom||s&&this.inputElement.value!==n.text)&&(this.isSelectCustom=!1,this.clearAll(e))},t.prototype.focusIn=function(e){if(this.enabled&&!this.targetElement().classList.contains(Je.disable)){var i=!1;this.preventFocus&&j.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,i=!0),i||this.targetElement().focus(),X([this.inputWrapper.container],[Je.inputFocus]),this.onFocus(e),this.floatLabelType!=="Never"&&Ie.calculateWidth(this.inputElement,this.inputWrapper.container)}},t.prototype.focusOut=function(e){this.enabled&&(!this.enableVirtualization&&(this.getModuleName()==="combobox"||this.getModuleName()==="autocomplete")&&(this.isTyped=!0),this.hidePopup(e),this.targetElement()&&this.targetElement().blur(),Z([this.inputWrapper.container],[Je.inputFocus]),this.floatLabelType!=="Never"&&Ie.calculateWidth(this.inputElement,this.inputWrapper.container))},t.prototype.disableItem=function(e){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof e=="string")i=this.getIndexByValue(e);else if(typeof e=="object"){if(e instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===e){i=this.getIndexByValue(e.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(e))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=e;var s=i<this.liCollections.length&&i>-1;if(s&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var a=this.liCollections[i];if(a){this.disableListItem(a);var l=JSON.parse(JSON.stringify(this.listData[i]));l[this.fields.disabled]=!0,this.listData[i]=l,this.dataSource=this.listData,a.classList.contains(Je.focus)&&this.removeFocus(),a.classList.contains(Je.selected)&&this.clear()}}}}},t.prototype.destroy=function(){if(this.isActive=!1,this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),r5(this.element.id),this.isReact&&this.clearTemplate(),this.hidePopup(),this.popupObj&&(this.isPopupRender=!1,this.popupObj.hide()),this.unWireEvent(),this.list&&this.unWireListEvents(),!(this.element&&!this.element.classList.contains("e-"+this.getModuleName()))){if(this.inputElement){for(var e=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-describedby","aria-label"],i=0;i<e.length;i++)this.inputElement.removeAttribute(e[i]);this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),Ie.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)}this.element.removeAttribute("tabindex"),this.element.style.display="block",this.inputWrapper.container&&this.inputWrapper.container.parentElement&&(this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?se(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),se(this.inputWrapper.container))),delete this.hiddenElement,this.filterInput=null,this.keyboardModule=null,this.ulElement=null,this.list=null,this.clearIconElement=null,this.popupObj=null,this.popupContentElement=null,this.rippleFun=null,this.selectedLI=null,this.liCollections=null,this.item=null,this.footer=null,this.header=null,this.previousSelectedLI=null,this.valueTempElement=null,this.actionData.ulElement=null,this.inputElement&&!g(this.inputElement.onchange)&&(this.inputElement.onchange=null),this.inputElement&&!g(this.inputElement.onselect)&&(this.inputElement.onselect=null),Ie.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties,buttons:this.inputWrapper.container.querySelectorAll(".e-input-group-icon")[0]},this.clearButton),this.clearButton=null,this.inputElement=null,this.inputWrapper=null,o.prototype.destroy.call(this)}},t.prototype.getItems=function(){return this.list||(this.dataSource instanceof oe&&(this.initialRemoteRender=!0),this.renderList()),this.ulElement?o.prototype.getItems.call(this):[]},t.prototype.getDataByValue=function(e){return o.prototype.getDataByValue.call(this,e)},t.prototype.clear=function(){this.value=null},vi([w(null)],t.prototype,"cssClass",void 0),vi([w("100%")],t.prototype,"width",void 0),vi([w(!0)],t.prototype,"enabled",void 0),vi([w(!1)],t.prototype,"enablePersistence",void 0),vi([w("300px")],t.prototype,"popupHeight",void 0),vi([w("100%")],t.prototype,"popupWidth",void 0),vi([w(null)],t.prototype,"placeholder",void 0),vi([w(null)],t.prototype,"filterBarPlaceholder",void 0),vi([w({})],t.prototype,"htmlAttributes",void 0),vi([w(null)],t.prototype,"query",void 0),vi([w(null)],t.prototype,"valueTemplate",void 0),vi([w(null)],t.prototype,"headerTemplate",void 0),vi([w(null)],t.prototype,"footerTemplate",void 0),vi([w(!1)],t.prototype,"allowFiltering",void 0),vi([w(300)],t.prototype,"debounceDelay",void 0),vi([w(!0)],t.prototype,"isDeviceFullScreen",void 0),vi([w(!1)],t.prototype,"readonly",void 0),vi([w(!1)],t.prototype,"enableVirtualization",void 0),vi([w(!1)],t.prototype,"allowResize",void 0),vi([w(null)],t.prototype,"text",void 0),vi([w(null)],t.prototype,"value",void 0),vi([w(!1)],t.prototype,"allowObjectBinding",void 0),vi([w(null)],t.prototype,"index",void 0),vi([w("Never")],t.prototype,"floatLabelType",void 0),vi([w(!1)],t.prototype,"showClearButton",void 0),vi([G()],t.prototype,"filtering",void 0),vi([G()],t.prototype,"change",void 0),vi([G()],t.prototype,"beforeOpen",void 0),vi([G()],t.prototype,"open",void 0),vi([G()],t.prototype,"close",void 0),vi([G()],t.prototype,"blur",void 0),vi([G()],t.prototype,"focus",void 0),vi([G()],t.prototype,"resizeStop",void 0),vi([G()],t.prototype,"resizing",void 0),vi([G()],t.prototype,"resizeStart",void 0),t=vi([It],t),t})(HF);var m5=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),xr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},wF="e-atc-spinner-icon";Je.root="e-combobox";var y5={container:null,buttons:[]},Fy=(function(o){m5(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){o.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"combo-box"},t.prototype.wireEvent=function(){this.getModuleName()==="combobox"&&(T.add(this.inputWrapper.buttons[0],"mousedown",this.preventBlur,this),T.add(this.inputWrapper.container,"blur",this.onBlurHandler,this)),g(this.inputWrapper.buttons[0])||T.add(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick,this),T.add(this.inputElement,"focus",this.targetFocus,this),this.readonly||(T.add(this.inputElement,"input",this.onInput,this),T.add(this.inputElement,"keyup",this.onFilterUp,this),T.add(this.inputElement,"keydown",this.onFilterDown,this),T.add(this.inputElement,"paste",this.pasteHandler,this),T.add(window,"resize",this.windowResize,this)),this.bindCommonEvent()},t.prototype.preventBlur=function(e){(!this.allowFiltering&&document.activeElement!==this.inputElement&&!document.activeElement.classList.contains(Je.input)&&j.isDevice||!j.isDevice)&&e.preventDefault()},t.prototype.onBlurHandler=function(e){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value,r=g(this.text)?this.text:this.text.replace(/\r\n|\n|\r/g,"");!g(this.listData)&&!g(i)&&i!==r&&this.customValue(e),o.prototype.onBlurHandler.call(this,e)},t.prototype.targetElement=function(){return this.inputElement},t.prototype.setOldText=function(e){Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue(),this.removeSelection()},t.prototype.setOldValue=function(e){this.allowCustom?(this.selectedLI=this.getElementByValue(this.value),this.valueMuteChange(this.value)):this.valueMuteChange(null),this.removeSelection(),this.setHiddenValue()},t.prototype.valueMuteChange=function(e){e=this.allowObjectBinding&&!g(e)?V(this.fields.value?this.fields.value:"",e):e;var i=g(e)?null:e.toString();Ie.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton);var r={};if(this.allowObjectBinding&&(e=this.getDataByValue(e),g(e))){var n=this.fields,s=!1,a=!1;if(this.allowObjectBinding){var l=Object.keys(this.value);l.forEach(function(u){if(u===n.value){a=!0;return}}),l.forEach(function(u){if(u===n.text){s=!0;return}})}r={text:a?s?V(n.text,this.value):V(n.value,this.value):null,value:a?this.value:null,index:null}}this.allowObjectBinding?this.setProperties(r,!0):this.setProperties({value:e,text:e&&e.toString(),index:null},!0),this.activeIndex=this.index;var h=this.fields,c={};c[h.text]=g(e)?null:e.toString(),c[h.value]=g(e)?null:e.toString(),this.itemData=c,this.item=null,(!this.allowObjectBinding&&this.previousValue!==this.value||this.allowObjectBinding&&this.previousValue&&this.value&&!this.isObjectInArray(this.previousValue,[this.value]))&&this.detachChangeEvent(null)},t.prototype.updateValues=function(){var e=this;if(this.fields.disabled&&(this.value!=null&&(this.value=this.isDisableItemValue(this.value)?null:this.value),this.text!=null&&(this.text=this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?null:this.text),this.index!=null&&(this.index=this.isDisabledItemByIndex(this.index)?null:this.index,this.activeIndex=this.index)),g(this.value))if(this.text&&g(this.value)){var r=this.getElementByText(this.text);r?this.setSelection(r,null):(Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue())}else!g(this.activeIndex)&&!g(this.liCollections[this.activeIndex])&&this.setSelection(this.liCollections[this.activeIndex],null);else{var i=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,r=this.getElementByValue(i),n=!g(r);if(this.enableVirtualization&&this.value){var s=this.fields.value?this.fields.value:"",a=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;if(this.dataSource instanceof oe)this.dataSource.executeQuery(new Pe().where(new xt(s,"equal",a))).then(function(u){if(u&&u.result&&u.result.length>0){e.itemData=u.result[0];var d=e.getItemData(),p=e.allowObjectBinding?e.itemData:d.value,f=e.allowObjectBinding&&!g(e.value)?V(e.fields.value?e.fields.value:"",e.value):e.value;(f===d.value&&e.text!==d.text.toString()||f!==d.value&&e.text===d.text.toString())&&(e.setProperties({text:d.text?d.text.toString():d.text,value:p},!0),e.setHiddenValue(),Ie.setValue(e.text,e.inputElement,e.floatLabelType,e.showClearButton))}else e.allowCustom?(e.valueMuteChange(e.value),e.setHiddenValue(),Ie.setValue(e.text,e.inputElement,e.floatLabelType,e.showClearButton)):e.valueMuteChange(null)});else{var l=new oe(this.dataSource).executeLocal(new Pe().where(new xt(s,"equal",a)));if(l&&l.length>0){this.itemData=l[0],n=!0;var h=this.getItemData(),c=this.allowObjectBinding?this.getDataByValue(h.value):h.value;(this.value===h.value&&this.text!==h.text||this.value!==h.value&&this.text===h.text)&&(this.setProperties({text:h.text?h.text.toString():h.text,value:c}),g(r)&&(this.previousValue=this.value))}}}r?this.setSelection(r,null):!this.enableVirtualization&&this.allowCustom||this.allowCustom&&this.enableVirtualization&&!n&&!(this.dataSource instanceof oe)?this.valueMuteChange(this.value):(!this.enableVirtualization||this.enableVirtualization&&!(this.dataSource instanceof oe)&&!n)&&this.valueMuteChange(null)}this.setHiddenValue(),Ie.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement&&this.inputElement.value!==""&&!this.readonly?Z([this.inputWrapper.clearButton],Je.clearIconHide):X([this.inputWrapper.clearButton],Je.clearIconHide))},t.prototype.getAriaAttributes=function(){var e={role:"combobox","aria-autocomplete":"both","aria-labelledby":this.hiddenElement.id,"aria-expanded":"false","aria-readonly":this.readonly?this.readonly.toString():"false",autocomplete:"off",autocapitalize:"off",spellcheck:"false"};return e},t.prototype.searchLists=function(e){this.isTyped=!0,this.isFiltering()?(o.prototype.searchLists.call(this,e),this.ulElement&&this.filterInput.value.trim()===""&&this.setHoverList(this.ulElement.querySelector("."+Je.li))):(this.ulElement&&this.inputElement.value===""&&this.preventAutoFill&&this.setHoverList(this.ulElement.querySelector("."+Je.li)),this.incrementalSearch(e))},t.prototype.getNgDirective=function(){return"EJS-COMBOBOX"},t.prototype.setSearchBox=function(){this.filterInput=this.inputElement;var e=this.isFiltering()||this.isReact&&this.getModuleName()==="combobox"?this.inputWrapper:y5;return e},t.prototype.onActionComplete=function(e,i,r,n){var s=this;o.prototype.onActionComplete.call(this,e,i,r),this.isSelectCustom&&this.removeSelection(),!this.preventAutoFill&&this.getModuleName()==="combobox"&&this.isTyped&&!this.enableVirtualization&&setTimeout(function(){s.inlineSearch()})},t.prototype.getFocusElement=function(){var e=this.isSelectCustom?{text:""}:this.getItemData(),i=g(this.list)?this.list:this.list.querySelector("."+Je.selected),r=e.text&&e.text.toString()===this.inputElement.value&&!g(i);if(r)return i;if((j.isDevice&&!this.isDropDownClick||!j.isDevice)&&!g(this.liCollections)&&this.liCollections.length>0){var n=this.inputElement.value,s=this.sortedData,a=this.typeOfData(s).typeof,l=wa(n,this.liCollections,this.filterType,!0,s,this.fields,a,this.ignoreAccent);if(this.enableVirtualization&&n!==""&&this.getModuleName()!=="autocomplete"&&this.isTyped&&!this.allowFiltering){var h=!1,c=this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount,u=this.incrementalEndIndex===0;for((c||u)&&(h=!0,this.incrementalStartIndex=this.incrementalEndIndex,u?this.incrementalEndIndex=Math.min(100,this.totalItemCount):this.incrementalEndIndex=Math.min(this.incrementalEndIndex+100,this.totalItemCount),this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0),(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=wa(n,this.incrementalLiCollections,this.filterType,!0,s,this.fields,a);g(l.item)&&this.incrementalEndIndex<this.totalItemCount;){if(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),h=!0,(this.viewPortInfo.startIndex!==0||h)&&this.updateIncrementalView(0,this.itemCount),l=wa(n,this.incrementalLiCollections,this.filterType,!0,s,this.fields,a),!g(l)){l.index=l.index+this.incrementalStartIndex;break}if(g(l)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}}var d=l.index-(this.itemCount/2-2)>0?l.index-(this.itemCount/2-2):0,p=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;if(d!==this.viewPortInfo.startIndex&&this.updateIncrementalView(d,p),g(l.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var f=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,v=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(f,v),l.item=this.getElementByValue(l.item.getAttribute("data-value"))}l&&l.item&&(l.item=this.getElementByValue(l.item.getAttribute("data-value")))}var m=l.item,y=this.getItemData();if(!g(m)&&!this.enableVirtualization||this.enableVirtualization&&this.isTyped&&g(y)&&g(y.value)&&y.value.toString()===m.getAttribute("data-value").toString()){var b=this.getIndexByValue(m.getAttribute("data-value"))-1,S=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10);if(!isNaN(S)&&this.getModuleName()!=="autocomplete"){this.removeFocus();var C=this.fields.groupBy?this.liCollections[0].offsetHeight:0;if(!this.enableVirtualization)this.list.scrollTop=b*S+C;else{var x=this.list.getElementsByClassName("e-virtual-ddl-content")[0];if(x.style=this.getTransformValues(),this.enableVirtualization&&!this.fields.groupBy){var I=m.offsetTop,D=this.virtualListInfo&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex:0,M=m.offsetHeight,E=I+D*M,A=this.list.querySelectorAll(".e-virtual-list").length,L=A*M;this.list.scrollTop=E-L}}X([m],Je.focus)}}else this.isSelectCustom&&this.inputElement.value.trim()!==""&&(this.removeFocus(),this.enableVirtualization||(this.list.scrollTop=0));return m}else return null},t.prototype.setValue=function(e){return(e&&e.type==="keydown"&&e.action==="enter"||e&&e.type==="click")&&this.removeFillSelection(),this.autofill&&this.getModuleName()==="combobox"&&e&&e.type==="keydown"&&e.action!=="enter"?(this.preventAutoFill=!1,this.inlineSearch(e),!1):o.prototype.setValue.call(this,e)},t.prototype.checkCustomValue=function(){var e=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;this.itemData=this.getDataByValue(e);var i=this.getItemData(),r=this.allowObjectBinding?this.itemData:i.value;this.allowCustom&&g(i.value)&&g(i.text)||this.setProperties({value:r},!this.allowCustom)},t.prototype.showSpinner=function(){g(this.spinnerElement)&&(this.spinnerElement=this.getModuleName()==="autocomplete"?this.inputWrapper.buttons[0]||this.inputWrapper.clearButton||Ie.appendSpan("e-input-group-icon "+wF,this.inputWrapper.container,this.createElement):this.inputWrapper.buttons[0]||this.inputWrapper.clearButton,X([this.spinnerElement],Je.disableIcon),Qs({target:this.spinnerElement,width:j.isDevice?"16px":"14px"},this.createElement),vs(this.spinnerElement))},t.prototype.hideSpinner=function(){g(this.spinnerElement)||(Xs(this.spinnerElement),Z([this.spinnerElement],Je.disableIcon),this.spinnerElement.classList.contains(wF)?se(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.setAutoFill=function(e,i){if(i||this.setHoverList(e),this.autofill&&!this.preventAutoFill){var r=this.getTextByValue(e.getAttribute("data-value")).toString(),n=this.getFormattedValue(e.getAttribute("data-value"));this.getModuleName()==="combobox"&&(!this.isSelected&&!this.allowObjectBinding&&this.previousValue!==n||this.allowObjectBinding&&this.previousValue&&n&&!this.isObjectInArray(this.previousValue,[this.getDataByValue(n)])?(this.updateSelectedItem(e,null),this.isSelected=!0,this.previousValue=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(e.getAttribute("data-value"))):this.getFormattedValue(e.getAttribute("data-value"))):this.updateSelectedItem(e,null,!0)),this.isAndroidAutoFill(r)||this.setAutoFillSelection(r,i)}},t.prototype.isAndroidAutoFill=function(e){if(j.isAndroid){var i=this.getSelectionPoints(),r=this.prevSelectPoints.end,n=i.end,s=this.prevSelectPoints.start,a=i.start;return r!==0&&(r===e.length&&s===e.length||s>a&&r>n||r===n&&s===a)}else return!1},t.prototype.clearAll=function(e,i){(g(i)||!g(i)&&g(i.dataSource))&&o.prototype.clearAll.call(this,e),this.isFiltering()&&!g(e)&&e.target===this.inputWrapper.clearButton&&(this.typedString=this.filterInput.value,this.searchLists(e))},t.prototype.isSelectFocusItem=function(e){return!g(e)},t.prototype.inlineSearch=function(e){var i=e&&(e.action==="down"||e.action==="up"||e.action==="home"||e.action==="end"||e.action==="pageUp"||e.action==="pageDown"),r=i?this.liCollections[this.activeIndex]:this.getFocusElement();if(g(r))if(!g(this.inputElement)&&this.inputElement.value===""){if(this.activeIndex=null,!g(this.list)){this.enableVirtualization||(this.list.scrollTop=0);var s=this.list.querySelector("."+Je.li);this.setHoverList(s)}}else this.activeIndex=null,this.removeSelection(),this.liCollections&&this.liCollections.length>0&&!this.isCustomFilter&&this.removeFocus();else{if(!i){var n=this.getFormattedValue(r.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(n),this.activeIndex=g(this.activeIndex)?null:this.activeIndex}this.preventAutoFill=this.inputElement.value===""?!1:this.preventAutoFill,this.setAutoFill(r,i)}},t.prototype.incrementalSearch=function(e){this.showPopup(e),g(this.listData)||(this.inlineSearch(e),e.preventDefault())},t.prototype.setAutoFillSelection=function(e,i){i===void 0&&(i=!1);var r=this.getSelectionPoints(),n=this.inputElement.value.substr(0,r.start);if(n&&n.toLowerCase()===e.substr(0,r.start).toLowerCase()){var s=n+e.substr(n.length,e.length);Ie.setValue(s,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(r.start,this.inputElement.value.length)}else i&&(Ie.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(0,this.inputElement.value.length))},t.prototype.getValueByText=function(e){return o.prototype.getValueByText.call(this,e,this.ignoreCase,this.ignoreAccent)},t.prototype.unWireEvent=function(){this.getModuleName()==="combobox"&&(T.remove(this.inputWrapper.buttons[0],"mousedown",this.preventBlur),T.remove(this.inputWrapper.container,"blur",this.onBlurHandler)),g(this.inputWrapper.buttons[0])||T.remove(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick),this.inputElement&&(T.remove(this.inputElement,"focus",this.targetFocus),this.readonly||(T.remove(this.inputElement,"input",this.onInput),T.remove(this.inputElement,"keyup",this.onFilterUp),T.remove(this.inputElement,"keydown",this.onFilterDown),T.remove(this.inputElement,"paste",this.pasteHandler),T.remove(window,"resize",this.windowResize))),this.unBindCommonEvent()},t.prototype.setSelection=function(e,i){o.prototype.setSelection.call(this,e,i),!g(e)&&!this.autofill&&!this.isDropDownClick&&this.removeFocus()},t.prototype.selectCurrentItem=function(e){var i;if(this.isPopupOpen){if(this.isSelected?i=this.list.querySelector("."+Je.selected):i=this.list.querySelector("."+Je.focus),this.isDisabledElement(i))return;i&&(this.setSelection(i,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e))}e.action==="enter"&&this.inputElement.value===""?this.clearAll(e):this.isTyped&&!this.isSelected&&g(i)&&this.customValue(e),this.hidePopup(e)},t.prototype.setHoverList=function(e){this.removeSelection(),this.isValidLI(e)&&!e.classList.contains(Je.selected)&&(this.removeFocus(),e.classList.add(Je.focus))},t.prototype.targetFocus=function(e){j.isDevice&&!this.allowFiltering&&(this.preventFocus=!1),this.onFocus(e),Ie.calculateWidth(this.inputElement,this.inputWrapper.container)},t.prototype.dropDownClick=function(e){e.preventDefault(),j.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.dropDownClick.call(this,e)},t.prototype.customValue=function(e){var i=this,r=this.getValueByText(this.inputElement.value);if(!this.allowCustom&&this.inputElement.value!==""){var n=this.previousValue,s=this.value;r=this.allowObjectBinding?this.getDataByValue(r):r,this.setProperties({value:r}),g(this.value)&&Ie.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.autofill&&(!this.allowObjectBinding&&n===this.value||this.allowObjectBinding&&n&&this.isObjectInArray(n,[this.value]))&&(!this.allowObjectBinding&&s!==this.value||this.allowObjectBinding&&s&&!this.isObjectInArray(s,[this.value]))&&this.onChangeEvent(null)}else if(this.inputElement.value!==""){var a=this.value;if(g(r)){var l=this.inputElement.value===""?null:this.inputElement.value,h={text:l,item:{}};this.isObjectCustomValue=!0,this.initial?this.updateCustomValueCallback(l,h,a):this.trigger("customValueSpecifier",h,function(c){i.updateCustomValueCallback(l,c,a,e)})}else this.isSelectCustom=!1,r=this.allowObjectBinding?this.getDataByValue(r):r,this.setProperties({value:r}),(!this.allowObjectBinding&&a!==this.value||this.allowObjectBinding&&a&&this.value&&!this.isObjectInArray(a,[this.value]))&&this.onChangeEvent(e)}else this.allowCustom&&this.isFocused&&(this.isSelectCustom=!0)},t.prototype.updateCustomValueCallback=function(e,i,r,n){var s=this,a=this.fields,l=i.item,h={};l&&V(a.text,l)&&V(a.value,l)?h=l:(it(a.text,e,h),it(a.value,e,h)),this.itemData=h;var c={};if(this.allowObjectBinding){var u=this.listData&&this.listData.length>0?Object.keys(this.listData[0]):Object.keys(this.itemData);!(this.listData&&this.listData.length>0)&&(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox"&&this.allowFiltering)&&(u=this.firstItem?Object.keys(this.firstItem):Object.keys(this.itemData)),u.forEach(function(p){c[p]=p===a.value||p===a.text?V(a.value,s.itemData):null})}var d={text:V(a.text,this.itemData),value:this.allowObjectBinding?c:V(a.value,this.itemData),index:null};this.setProperties(d,!0),this.setSelection(null,null),this.isSelectCustom=!0,this.isObjectCustomValue=!1,(!this.allowObjectBinding&&r!==this.value||this.allowObjectBinding&&(r==null&&this.value!==null||r&&!this.isObjectInArray(r,[this.value])))&&this.onChangeEvent(n,!0)},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="combobox"&&(this.checkData(e),this.setUpdateInitial(["fields","query","dataSource"],e,i));for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"readonly":Ie.setReadonly(this.readonly,this.inputElement),this.readonly?(T.remove(this.inputElement,"input",this.onInput),T.remove(this.inputElement,"keyup",this.onFilterUp),T.remove(this.inputElement,"keydown",this.onFilterDown)):(T.add(this.inputElement,"input",this.onInput,this),T.add(this.inputElement,"keyup",this.onFilterUp,this),T.add(this.inputElement,"keydown",this.onFilterDown,this)),this.setReadOnly();break;case"allowFiltering":this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&g(this.list)&&o.prototype.renderList.call(this);break;case"allowCustom":break;default:{var a=this.getPropObject(s,e,i);o.prototype.onPropertyChanged.call(this,a.newProperty,a.oldProperty),this.isFiltering()&&s==="dataSource"&&g(this.list)&&this.itemTemplate&&this.getModuleName()==="combobox"&&o.prototype.renderList.call(this);break}}}},t.prototype.render=function(){o.prototype.render.call(this),this.setSearchBox(),this.renderComplete(),this.autoFill=this.autofill},t.prototype.getModuleName=function(){return"combobox"},t.prototype.addItem=function(e,i){o.prototype.addItem.call(this,e,i)},t.prototype.filter=function(e,i,r){o.prototype.filter.call(this,e,i,r)},t.prototype.showPopup=function(e){o.prototype.showPopup.call(this,e)},t.prototype.hidePopup=function(e){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;if(!g(this.listData)){var r=this.isEscapeKey;this.isEscapeKey&&(Ie.setValue(this.typedString,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1),this.autofill&&this.removeFillSelection();var n=this.isSelectCustom?{text:""}:this.getItemData(),s=g(n.text)?n.text:n.text.toString().replace(/\r\n|\n|\r/g,""),a=g(this.list)?null:this.list.querySelector("."+Je.selected);if(this.inputElement&&s===this.inputElement.value&&!g(a)){this.isSelected&&(this.onChangeEvent(e),this.isSelectCustom=!1),o.prototype.hidePopup.call(this,e);return}if(this.getModuleName()==="combobox"&&this.inputElement.value.trim()!==""){var l=this.sortedData,h=this.typeOfData(l).typeof,c=wa(this.inputElement.value,this.liCollections,"Equal",!0,l,this.fields,h);this.selectedLI=c.item,g(c.index)&&(c.index=wa(this.inputElement.value,this.liCollections,"StartsWith",!0,l,this.fields,h).index),this.activeIndex=c.index,g(this.selectedLI)?r&&(this.isSelectCustom=!0,this.removeSelection()):this.updateSelectedItem(this.selectedLI,null,!0)}!this.isEscapeKey&&this.isTyped&&!this.isInteracted&&this.customValue(e)}var u=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value;g(this.listData)&&this.allowCustom&&!g(i)&&i!==u&&this.customValue(),o.prototype.hidePopup.call(this,e)},t.prototype.focusIn=function(){this.enabled&&(j.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.focusIn.call(this))},t.prototype.clear=function(){this.value=null},t.prototype.focusOut=function(e){o.prototype.focusOut.call(this,e)},t.prototype.getItems=function(){return o.prototype.getItems.call(this)},t.prototype.getDataByValue=function(e){return o.prototype.getDataByValue.call(this,e)},t.prototype.renderHightSearch=function(){},xr([w(!1)],t.prototype,"autofill",void 0),xr([w(!0)],t.prototype,"allowCustom",void 0),xr([w({})],t.prototype,"htmlAttributes",void 0),xr([w(!1)],t.prototype,"allowFiltering",void 0),xr([w(!0)],t.prototype,"isDeviceFullScreen",void 0),xr([w(null)],t.prototype,"query",void 0),xr([w(null)],t.prototype,"index",void 0),xr([w(!0)],t.prototype,"showClearButton",void 0),xr([G()],t.prototype,"customValueSpecifier",void 0),xr([G()],t.prototype,"filtering",void 0),xr([w(null)],t.prototype,"valueTemplate",void 0),xr([w("Never")],t.prototype,"floatLabelType",void 0),xr([w(null)],t.prototype,"filterBarPlaceholder",void 0),xr([w(null)],t.prototype,"cssClass",void 0),xr([w(null)],t.prototype,"headerTemplate",void 0),xr([w(null)],t.prototype,"footerTemplate",void 0),xr([w(null)],t.prototype,"placeholder",void 0),xr([w("100%")],t.prototype,"width",void 0),xr([w("300px")],t.prototype,"popupHeight",void 0),xr([w("100%")],t.prototype,"popupWidth",void 0),xr([w(!1)],t.prototype,"readonly",void 0),xr([w(null)],t.prototype,"text",void 0),xr([w(null)],t.prototype,"value",void 0),xr([w(!1)],t.prototype,"allowObjectBinding",void 0),t=xr([It],t),t})($s),b5=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Vn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};Je.root="e-autocomplete";Je.icon="e-input-group-icon e-ddl-icon e-search-icon";var Ry=(function(o){b5(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isFiltered=!1,r.searchList=!1,r}return t.prototype.preRender=function(){o.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"auto-complete"},t.prototype.getNgDirective=function(){return"EJS-AUTOCOMPLETE"},t.prototype.getQuery=function(e){var i=e?e.clone():this.query?this.query.clone():new Pe,r=this.allowObjectBinding&&!g(this.value)?V(this.fields.value?this.fields.value:"",this.value):this.value,n=this.queryString===""&&!g(r)?"equal":this.filterType,s=this.queryString===""&&!g(r)?r:this.queryString;if(this.isFiltered){if(this.enableVirtualization&&!g(this.customFilterQuery))i=this.customFilterQuery.clone();else if(!this.enableVirtualization)return i}if(this.queryString!==null&&this.queryString!==""){var a=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof oe)&&a==="string"||a==="number")i.where("",n,s,this.ignoreCase,this.ignoreAccent);else{var l=g(this.fields.value)?"":this.fields.value;i.where(l,n,s,this.ignoreCase,this.ignoreAccent)}}if(!g(this.suggestionCount)&&!this.enableVirtualization){if(this.suggestionCount!==20)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onTake"&&i.queries.splice(h,1);i.take(this.suggestionCount)}if(this.enableVirtualization){var c=0,u=0,d=this.getTakeValue();if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onSkip"&&(u=i.queries[h].e.nos),i.queries[h].fn==="onTake"&&(c=d<=i.queries[h].e.nos?i.queries[h].e.nos:d);if(c<=0&&this.query&&this.query.queries.length>0){for(var h=0;h<this.query.queries.length;h++)if(this.query.queries[h].fn==="onTake"){var p=this.query.queries[h].e.nos;c=d<=p?p:d}}if(i&&i.queries.length>0)for(var h=0;h<i.queries.length;h++){if(i.queries[h].fn==="onSkip"){u=i.queries[h].e.nos,i.queries.splice(h,1),--h;continue}if(i.queries[h].fn==="onTake"){var f=i.queries[h].e.nos;c=f<=c?c:f,i.queries.splice(h,1),--h}}u>0&&this.virtualItemStartIndex<=u?i.skip(u):i.skip(this.virtualItemStartIndex),c>0&&d<=c?i.take(c):i.take(d),i.requiresCount()}return i},t.prototype.performFiltering=function(e){var i=this,r={preventDefaultAction:!1,text:this.filterInput?this.filterInput.value:null,updateData:function(n,s,a){r.cancel||(i.isFiltered=!0,i.customFilterQuery=s,i.filterAction(n,s,a))},cancel:!1};this.trigger("filtering",r,function(n){!n.cancel&&!i.isFiltered&&!n.preventDefaultAction&&(i.searchList=!0,i.filterAction(i.dataSource,null,i.fields,e))})},t.prototype.searchLists=function(e){if(this.isTyped=!0,this.isDataFetched=this.isSelectCustom=!1,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,this.checkAndResetCache(),g(this.list)&&o.prototype.renderList.call(this,e,!0),this.queryString=this.filterInput.value,e.type!=="mousedown"&&(e.keyCode===40||e.keyCode===38)){this.queryString=this.queryString===""?null:this.queryString,this.beforePopupOpen=!0,this.resetList(this.dataSource,this.fields,null,e);return}this.isSelected=!1,this.activeIndex=null,this.isRequesting=!1,this.queryString!==""&&this.debounceDelay>0?this.debouncedFiltering(e,this.debounceDelay):this.performFiltering(e)},t.prototype.filter=function(e,i,r){this.isFiltered=!0,this.filterAction(e,i,r)},t.prototype.filterAction=function(e,i,r,n){this.beforePopupOpen=!0;var s=this.list.classList.contains("e-nodata");if(this.queryString!==""&&this.queryString.length>=this.minLength){if(this.enableVirtualization&&this.isFiltering()&&this.isTyped&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.resetList(e,r,i,n),s=this.list.classList.contains("e-nodata"),this.enableVirtualization&&!s){if(!this.list.querySelector(".e-virtual-ddl-content")&&this.list.querySelector(".e-list-parent")){var a=this.createElement("div",{className:"e-virtual-ddl-content"});a.style.cssText=this.getTransformValues(),this.list.appendChild(a).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")&&this.list.parentElement){var a=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});a.style.cssText=this.GetVirtualTrackHeight(),this.list.parentElement.querySelector(".e-dropdownbase").appendChild(a)}}(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof oe)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof oe&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount()}else this.hidePopup(n),this.beforePopupOpen=!1;this.renderReactTemplates()},t.prototype.clearAll=function(e,i){(g(i)||!g(i)&&g(i.dataSource))&&(o.prototype.clearAll.call(this,e),this.checkAndResetCache()),this.beforePopupOpen&&this.hidePopup()},t.prototype.onActionComplete=function(e,i,r,n){this.enableVirtualization||(this.fixedHeaderElement=null),(this.getModuleName()==="autocomplete"&&!(this.dataSource instanceof oe)||this.getModuleName()==="autocomplete"&&this.dataSource instanceof oe&&this.totalItemCount!==0)&&this.getFilteringSkeletonCount(),o.prototype.onActionComplete.call(this,e,i,r);var s=this.list.querySelector("."+Je.li);g(s)||Z([s],Je.focus),!g(this.itemData)&&!this.enableVirtualization&&this.focusIndexItem(),this.postBackAction()},t.prototype.postBackAction=function(){if(this.autofill&&!g(this.liCollections[0])&&this.searchList){var e=[this.liCollections[0]],i=this.listData,r=this.typeOfData(i).typeof,n=wa(this.inputElement.value,e,"StartsWith",this.ignoreCase,i,this.fields,r);this.searchList=!1,g(n.item)||o.prototype.setAutoFill.call(this,this.liCollections[0],!0)}},t.prototype.setSelection=function(e,i){if(!this.isValidLI(e)){this.selectedLI=e;return}if(!g(i)&&i.type==="keydown"&&i.action!=="enter"&&i.action!=="tab"&&this.isValidLI(e)){var r=this.getFormattedValue(e.getAttribute("data-value"));if(this.activeIndex=this.getIndexByValue(r),this.setHoverList(e),this.selectedLI=e,this.setScrollPosition(i),this.autofill&&this.isPopupOpen){this.preventAutoFill=!1;var n=i&&i.action==="down"||i.action==="up"||i.action==="home"||i.action==="end"||i.action==="pageUp"||i.action==="pageDown";o.prototype.setAutoFill.call(this,e,n)}}else o.prototype.setSelection.call(this,e,i),this.isFiltered=!1},t.prototype.listOption=function(e,i){var r=this,n=o.prototype.listOption.call(this,e,i);if(g(n.itemCreated))n.itemCreated=function(a){r.highlight&&(r.element.tagName===r.getNgDirective()&&r.itemTemplate?setTimeout(function(){Dy(a.item,r.queryString,r.ignoreCase,r.filterType)},0):Dy(a.item,r.queryString,r.ignoreCase,r.filterType))};else{var s=n.itemCreated;n.itemCreated=function(a){r.highlight&&Dy(a.item,r.queryString,r.ignoreCase,r.filterType),s.apply(r,[a])}}return n},t.prototype.isFiltering=function(){return!0},t.prototype.renderPopup=function(e){this.enableVirtualization||(this.list.scrollTop=0),o.prototype.renderPopup.call(this,e)},t.prototype.isEditTextBox=function(){return!1},t.prototype.isPopupButton=function(){return this.showPopupButton},t.prototype.isSelectFocusItem=function(e){return!1},t.prototype.setInputValue=function(e,i){var r=i&&i.text?i.text:i&&i.value,n=e&&e.text?e.text:e&&e.value?e.value:this.value;if(this.allowObjectBinding&&(r=g(r)?r:V(this.fields.value?this.fields.value:"",r),n=g(n)?n:V(this.fields.value?this.fields.value:"",n)),n&&this.typedString===""&&!this.allowCustom&&!(this.dataSource instanceof oe)){var s=this.typeOfData(this.dataSource).typeof==="string"?"":this.fields.value,a=this.getItems().length,l=new Pe,h=this;new oe(this.dataSource).executeQuery(l.where(new xt(s,"equal",n))).then(function(c){c.result.length>0?(h.value=s!==""?h.allowObjectBinding?c.result[0]:c.result[0][h.fields.value].toString():c.result[0].toString(),h.addItem(c.result,a),h.updateValues()):e&&e.text?h.setOldText(r):e&&e.value?h.setOldValue(r):h.updateValues()})}else e&&(e.text?this.setOldText(r):this.setOldValue(r))},t.prototype.showPopup=function(e){if(this.enabled){if(this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.preventAutoFill=!0,g(this.list)?this.renderList(e):this.resetList(this.dataSource,this.fields,null,e)}},t.prototype.hidePopup=function(e){o.prototype.hidePopup.call(this,e),this.activeIndex=null,this.virtualListInfo=this.viewPortInfo,this.previousStartIndex=this.viewPortInfo.startIndex,this.startIndex=this.viewPortInfo.startIndex,this.previousEndIndex=this.viewPortInfo.endIndex},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="autocomplete"&&this.setUpdateInitial(["fields","query","dataSource"],e);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"showPopupButton":if(this.showPopupButton){var a=Ie.appendSpan(Je.icon,this.inputWrapper.container,this.createElement);this.inputWrapper.buttons[0]=a,Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),this.inputWrapper&&this.inputWrapper.buttons&&this.inputWrapper.buttons[0]&&T.add(this.inputWrapper.buttons[0],"click",this.dropDownClick,this)}else se(this.inputWrapper.buttons[0]),this.inputWrapper.buttons[0]=null;break;default:{var l=this.getPropObject(s,e,i);o.prototype.onPropertyChanged.call(this,l.newProperty,l.oldProperty);break}}}},t.prototype.renderHightSearch=function(){if(this.highlight)for(var e=0;e<this.liCollections.length;e++){var i=this.ulElement.querySelector(".e-active");i||(n5(this.liCollections[e]),Dy(this.liCollections[e],this.queryString,this.ignoreCase,this.filterType)),i=null}},t.prototype.getModuleName=function(){return"autocomplete"},t.prototype.render=function(){o.prototype.render.call(this)},Vn([Ce({value:null,iconCss:null,groupBy:null,disabled:null},NI)],t.prototype,"fields",void 0),Vn([w(!0)],t.prototype,"ignoreCase",void 0),Vn([w(!1)],t.prototype,"showPopupButton",void 0),Vn([w(!1)],t.prototype,"highlight",void 0),Vn([w(20)],t.prototype,"suggestionCount",void 0),Vn([w({})],t.prototype,"htmlAttributes",void 0),Vn([w(null)],t.prototype,"query",void 0),Vn([w(1)],t.prototype,"minLength",void 0),Vn([w("Contains")],t.prototype,"filterType",void 0),Vn([G()],t.prototype,"filtering",void 0),Vn([w(null)],t.prototype,"index",void 0),Vn([w("Never")],t.prototype,"floatLabelType",void 0),Vn([w(null)],t.prototype,"valueTemplate",void 0),Vn([w(null)],t.prototype,"filterBarPlaceholder",void 0),Vn([w(!1)],t.prototype,"allowFiltering",void 0),Vn([w(null)],t.prototype,"text",void 0),t=Vn([It],t),t})(Fy),AI="e-float-line",jf="e-float-text",rd="e-label-top",xc="e-label-bottom";function xF(o,t,e,i,r,n,s){var a=et("span",{className:AI}),l=et("label",{className:jf}),h=e.getAttribute("id")?e.getAttribute("id"):Lt("ej2_multiselect");e.id=h,!g(e.id)&&e.id!==""&&(l.id="label_"+e.id.replace(/ /g,"_"),l.setAttribute("for",e.id),Ee(i,{"aria-labelledby":l.id})),!g(i.placeholder)&&i.placeholder!==""&&(l.innerText=LI(i.placeholder),i.removeAttribute("placeholder")),l.innerText=LI(s),t.appendChild(a),t.appendChild(l),o.classList.add("e-float-input"),S5(r,l),n==="Always"&&(l.classList.contains(xc)&&Z([l],xc),X([l],rd))}function S5(o,t){o&&o.length>0?(X([t],rd),Z([t],xc)):(Z([t],rd),X([t],xc))}function C5(o,t,e,i,r,n,s){var a=t.querySelector("."+jf),l=t.querySelector("."+AI),h;g(a)?(h=s!==null?s:"",IF(r,i,h)):(h=a.innerText,se(e.querySelector("."+jf)),IF(r,i,h),g(l)||se(e.querySelector("."+AI))),o.classList.remove("e-float-input")}function IF(o,t,e){o&&o.length?t.placeholder="":t.placeholder=e}function w5(o,t){o.classList.add("e-input-focus");var e=t.querySelector("."+jf);g(e)||(X([e],rd),e.classList.contains(xc)&&Z([e],xc))}function x5(o,t,e,i,r){o.classList.remove("e-input-focus");var n=t.querySelector("."+jf);e&&e.length<=0&&i==="Auto"&&!g(n)&&(n.classList.contains(rd)&&Z([n],rd),X([n],xc))}function LI(o){var t="";if(!g(o)&&o!==""){var e=document.createElement("span");e.innerHTML='<input  placeholder="'+o+'"/>';var i=e.children[0];t=i.placeholder}return t}var I5=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ct=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Sc="e-input-focus",Pf="e-disabled",M5="e-multiselect e-input-group e-control-wrapper",D5="e-multi-select-wrapper",E5="e-mob-wrapper",Ci="e-hide-listitem",T5="e-delim-view",A5="e-chips-collection",Cc="e-chips",L5="e-chipcontent",Ey="e-chips-close",xl="e-chip-selected",N5="e-searcher",MF="e-delimiter",Ty="e-zero-size",k5="e-remain",DF="e-chips-close e-close-hooker",EF="e-delim-values",F5="e-ddl e-popup e-multi-select-list-wrapper",R5="e-dropdownbase",TF="e-rtl",DI="e-close-icon-hide",O5="e-mob-chip",z5="e-ddl-footer",P5="e-ddl-header",AF="e-ddl-disable-icon",LF="e-ms-spinner-icon",B5="e-multi-hidden",j5="destroy",NF="e-input-group-icon e-ddl-icon",kF="e-icon-anim",Ay="e-delim-total",H5="e-multiselect-box",V5="e-filter-parent",FF="e-search-custom-width",EI="e-input-filter",_5="e-resizer-right e-icons",kI=(function(o){I5(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.clearIconWidth=0,r.previousFilterText="",r.storedSelectAllHeight=0,r.isUpdateHeaderHeight=!1,r.isUpdateFooterHeight=!1,r.isBlurDispatching=!1,r.isFilterPrevented=!1,r.isFilteringAction=!1,r.isValidKey=!1,r.selectAllEventData=[],r.selectAllEventEle=[],r.preventSetCurrentData=!1,r.isSelectAllLoop=!1,r.scrollFocusStatus=!1,r.keyDownStatus=!1,r}return t.prototype.enableRTL=function(e){e?this.overAllWrapper.classList.add(TF):this.overAllWrapper.classList.remove(TF),this.popupObj&&(this.popupObj.enableRtl=e,this.popupObj.dataBind())},t.prototype.requiredModules=function(){var e=[];if(this.enableVirtualization&&e.push({args:[this],member:"VirtualScroll"}),this.mode==="CheckBox"){if(this.isGroupChecking=this.enableGroupCheckBox,this.enableGroupCheckBox){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.enableSelectionOrder=!1,this.isProtectedOnChange=i}this.allowCustomValue=!1,this.hideSelectedItem=!1,this.closePopupOnSelect=!1,e.push({member:"CheckBoxSelection",args:[this]})}return e},t.prototype.updateHTMLAttribute=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];switch(r){case"class":{var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&(X([this.overAllWrapper],n.split(" ")),X([this.popupWrapper],n.split(" ")));break}case"disabled":this.enable(!1);break;case"placeholder":this.placeholder||(this.inputElement.setAttribute(r,this.htmlAttributes[""+r]),this.setProperties({placeholder:this.inputElement.placeholder},!0),this.refreshPlaceHolder());break;default:{var s=["id"],a=["name","required","aria-required","form"],l=["title","role","style","class"];s.indexOf(r)>-1?this.element.setAttribute(r,this.htmlAttributes[""+r]):r.indexOf("data")===0||a.indexOf(r)>-1?this.hiddenElement.setAttribute(r,this.htmlAttributes[""+r]):l.indexOf(r)>-1?this.overAllWrapper.setAttribute(r,this.htmlAttributes[""+r]):r!=="size"&&!g(this.inputElement)&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r]);break}}}},t.prototype.updateReadonly=function(e){g(this.inputElement)||(e||this.mode==="CheckBox"?this.inputElement.setAttribute("readonly","true"):this.inputElement.removeAttribute("readonly"))},t.prototype.updateClearButton=function(e){e?(this.overAllClear.parentNode?this.overAllClear.style.display="":this.componentWrapper.appendChild(this.overAllClear),this.componentWrapper.classList.remove(DI)):(this.overAllClear.style.display="none",this.componentWrapper.classList.add(DI))},t.prototype.updateCssClass=function(){if(!g(this.cssClass)&&this.cssClass!==""){var e=this.cssClass;e=this.cssClass.replace(/\s+/g," ").trim(),e!==""&&(X([this.overAllWrapper],e.split(" ")),X([this.popupWrapper],e.split(" ")))}},t.prototype.updateOldPropCssClass=function(e){!g(e)&&e!==""&&(e=e.replace(/\s+/g," ").trim(),e!==""&&(Z([this.overAllWrapper],e.split(" ")),Z([this.popupWrapper],e.split(" "))))},t.prototype.onPopupShown=function(e){var i=this;if(j.isDevice&&this.mode==="CheckBox"&&this.allowFiltering){var r=this;window.onpopstate=function(){r.hidePopup(),r.inputElement.focus()},history.pushState({},"")}var n={name:"FadeIn",duration:100},s={popup:this.popupObj,event:e,cancel:!1,animation:n};this.trigger("open",s,function(a){a.cancel||(i.focusAtFirstListItem(!0),i.popupObj&&document.body.appendChild(i.popupObj.element),i.mode==="CheckBox"&&i.enableGroupCheckBox&&!g(i.fields.groupBy)&&i.updateListItems(i.list.querySelectorAll("li.e-list-item"),i.mainList.querySelectorAll("li.e-list-item")),(i.mode==="CheckBox"||i.showDropDownIcon)&&X([i.overAllWrapper],[kF]),i.refreshPopup(),i.renderReactTemplates(),i.popupObj&&i.popupObj.show(a.animation,i.zIndex===1e3?i.element:null),i.isReact&&setTimeout(function(){if(i.popupHeight&&i.list&&i.popupHeight!=="auto"){var l=typeof i.popupHeight=="string"?parseInt(i.popupHeight,10):i.popupHeight;if(!i.isUpdateHeaderHeight&&i.headerTemplate&&i.header){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.header.offsetHeight).toString()+"px",i.isUpdateHeaderHeight=!0}if(!i.isUpdateFooterHeight&&i.footerTemplate&&i.footer){var h=i.list.style.maxHeight===""?l:parseInt(i.list.style.maxHeight,10);i.list.style.maxHeight=(h-i.footer.offsetHeight).toString()+"px",i.isUpdateFooterHeight=!0}}},15),Ee(i.inputElement,{"aria-expanded":"true","aria-owns":i.element.id+"_popup","aria-controls":i.element.id}),i.updateAriaActiveDescendant(),i.isFirstClick&&(i.enableVirtualization||i.loadTemplate()),i.mode==="CheckBox"&&i.showSelectAll&&T.add(i.popupObj.element,"click",i.clickHandler,i))})},t.prototype.updateVirtualReOrderList=function(e){var i=this.getForQuery(this.value,!0).clone();if(this.isVirtualReorder=!0,this.enableVirtualization&&this.dataSource instanceof oe?this.resetList(this.selectedListData,this.fields,i):this.resetList(this.dataSource,this.fields,i),this.UpdateSkeleton(),this.isVirtualReorder=!1,this.liCollections=this.list.querySelectorAll("."+de.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(r)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),e&&this.loadTemplate()},t.prototype.updateListItems=function(e,i){for(var r=0;r<e.length;r++)this.findGroupStart(e[r]),this.findGroupStart(i[r]);this.deselectHeader()},t.prototype.loadTemplate=function(){if(this.refreshListItems(null),this.enableVirtualization&&this.list&&this.mode==="CheckBox"){var e=this.list.querySelectorAll(".e-reorder")[0];this.list.querySelector(".e-virtual-ddl-content")&&e&&this.list.querySelector(".e-virtual-ddl-content").removeChild(e)}this.mode==="CheckBox"&&this.removeFocus(),this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this}),this.isPreventScrollAction=!0},t.prototype.setScrollPosition=function(){if((!this.hideSelectedItem&&this.mode!=="CheckBox"||this.mode==="CheckBox"&&!this.enableSelectionOrder)&&!g(this.value)&&this.value.length>0){var e=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1],i=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",e);g(i)||this.scrollBottom(i,void 0,!1,null,!0)}if(this.enableVirtualization){var r=this.list.querySelector("."+de.focus);this.isKeyBoardAction=!1,this.scrollBottom(r,void 0,!1,null,!0)}},t.prototype.updatePopupHeightOnFilter=function(){if(this.allowFiltering&&this.allowResize&&this.keyboardEvent&&this.allowResize&&this.popupObj&&this.list){var e=this.inputElement&&this.inputElement.value,i=this.list.querySelectorAll("li.e-list-item:not(.e-hide-listitem):not(.e-disabled)"),r=e&&e.length>0;if(r&&i.length>0){var n=i[0].offsetHeight,s=i.length*n;this.popupObj.element.style.maxHeight=s+16+"px",this.list.style.maxHeight=s+"px"}else if(!r){var a=this.resizeHeight||parseInt(this.popupHeight,10);this.popupObj.element.style.maxHeight=a+"px",this.list.style.maxHeight=a+"px",this.setResize()}}},t.prototype.focusAtFirstListItem=function(e){if(this.ulElement&&this.ulElement.querySelector("li."+de.li)){var i=void 0;if(this.mode==="CheckBox"){this.removeFocus();return}else if(this.enableVirtualization){if(this.fields.disabled){if(i=this.ulElement.querySelector("li."+de.li+":not(.e-virtual-list):not(.e-hide-listitem):not(."+Pf+")"),e&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+de.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else if(i=this.ulElement.querySelector("li."+de.li+":not(.e-virtual-list):not(.e-hide-listitem)"),e&&this.viewPortInfo&&this.viewPortInfo.startIndex!==0){var r=this.ulElement.querySelectorAll("li."+de.li+":not(.e-virtual-list):not(.e-hide-listitem)");i=r&&r.length>0?r[2]:i}}else this.fields.disabled?i=this.ulElement.querySelector("li."+de.li+":not(."+Ci+"):not(."+Pf+")"):i=this.ulElement.querySelector("li."+de.li+":not(."+Ci+")");i!==null&&(this.removeFocus(),this.addListFocus(i))}},t.prototype.focusAtLastListItem=function(e){var i;if(e)i=wa(e,this.liCollections,"StartsWith",this.ignoreCase);else if(this.value&&this.value.length){var r=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];wa(r,this.liCollections,"StartsWith",this.ignoreCase)}else i=null;i&&i.item!==null&&(this.addListFocus(i.item),((this.allowCustomValue||this.allowFiltering)&&this.isPopupOpen()&&this.closePopupOnSelect&&!this.enableVirtualization||this.closePopupOnSelect&&!this.enableVirtualization)&&this.scrollBottom(i.item,i.index))},t.prototype.getAriaAttributes=function(){var e={"aria-disabled":"false",role:"combobox","aria-expanded":"false"};return e},t.prototype.updateListARIA=function(){g(this.ulElement)||Ee(this.ulElement,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false","aria-label":"list"});var e=!!(!g(this.inputElement)&&this.inputElement.disabled);!this.isPopupOpen()&&!g(this.inputElement)&&Ee(this.inputElement,this.getAriaAttributes()),e&&Ee(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled(e?"true":"false")},t.prototype.ensureAriaDisabled=function(e){if(this.htmlAttributes&&this.htmlAttributes["aria-disabled"]){var i=this.htmlAttributes;pe(i,{"aria-disabled":e},i),this.setProperties({htmlAttributes:i},!0)}},t.prototype.removelastSelection=function(e){var i=this.chipCollectionWrapper.querySelector("span."+xl);if(i!==null){this.removeSelectedChip(e);return}var r=this.chipCollectionWrapper.querySelectorAll("span."+Cc),n=r[r.length-1].getAttribute("data-value");g(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice());var s=this.allowObjectBinding?this.enableVirtualization?this.getVirtualDataByValue(this.getFormattedValue(n)):this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&s===!1||!g(s)&&s.toString()==="NaN")&&(s=n),this.removeValue(s,e),this.removeChipSelection(),this.updateDelimeter(this.delimiterChar,e),this.makeTextBoxEmpty(),this.mainList&&this.listData&&this.refreshSelection(),this.checkPlaceholderSize()},t.prototype.onActionFailure=function(e){o.prototype.onActionFailure.call(this,e),this.renderPopup(),this.onPopupShown()},t.prototype.targetElement=function(){return this.targetInputElement=this.inputElement,this.mode==="CheckBox"&&this.allowFiltering&&this.notify("targetElement",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.targetInputElement?this.targetInputElement.value:null},t.prototype.getForQuery=function(e,i){var r,n=this.isPrimitiveData?"":this.fields.value;if(this.enableVirtualization&&e)if(i){for(var s=this.viewPortInfo.startIndex,a=s+this.viewPortInfo.endIndex<=e.length&&e[s+this.viewPortInfo.endIndex]?s+this.viewPortInfo.endIndex:e.length,l=s;l<a;l++){var h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e[l]):e[l];l===s?r=new xt(n,"equal",h):r=r.or(n,"equal",h)}return new Pe().where(r)}else{for(var l=0;l<e.length;l++){var h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e[l]):e[l];this.isaddNonPresentItems?r=l===0?new xt(n,"equal",e[l]):r.or(n,"equal",e[l]):r=l===0?r=new xt(n,"notequal",h):r.and(n,"notequal",h)}return new Pe().where(r)}else for(var l=0;l<e.length;l++)l===0?r=new xt(n,"equal",e[l]):r=r.or(n,"equal",e[l]);return this.dataSource instanceof oe&&this.dataSource.adaptor instanceof Qp?new Pe().where(r):this.getQuery(this.query).clone().where(r)},t.prototype.onActionComplete=function(e,i,r,n){var s=this;if(this.dataSource instanceof oe&&!g(r)&&!this.virtualGroupDataSource&&(this.totalItemCount=r.count),this.value&&i&&i.length>0&&this.allowFiltering&&this.mode!=="CheckBox"&&!this.enableVirtualization&&!this.isFilterPrevented&&!this.allowCustomValue&&this.isFilteringAction){var a=i.every(function(v){var m=V(s.fields.value?s.fields.value:"",v);return s.value.some(function(y){var b=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",y):y;return m===b})});a&&(e.innerHTML="",i=[])}o.prototype.onActionComplete.call(this,e,i,r),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.updateSelectElementData(this.allowFiltering);var l=this;if(!g(this.value)&&!this.allowCustomValue&&!this.enableVirtualization&&this.listData&&this.listData.length>0)for(var h=0;h<this.value.length;h++){var c=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",l.value[h]):l.value[h],u=this.findListElement(this.allowFiltering&&!g(this.mainList)?this.mainList:e,"li","data-value",c);!u&&!(this.dataSource instanceof oe)&&(this.value.splice(h,1),h-=1)}var d=[];g(this.value)||(d=this.presentItemValue(this.ulElement));var p=d.some(function(v){return v!==null});if(d.length>0&&this.dataSource instanceof oe&&!g(this.value)&&this.listData!=null&&(!this.enableVirtualization||this.enableVirtualization&&this.valueTemplate)&&p?(this.isaddNonPresentItems=!0,this.addNonPresentItems(d,this.ulElement,this.listData),this.isaddNonPresentItems=!1):this.updateActionList(e,i,r),this.dataSource instanceof oe&&this.allowCustomValue&&!this.isCustomRendered&&this.inputElement.value&&this.inputElement.value!==""){var f=new Pe;f=this.allowFiltering?f.where(this.fields.text,"startswith",this.inputElement.value,this.ignoreCase,this.ignoreAccent):f,this.checkForCustomValue(f,this.fields),this.isCustomRendered=!0,this.remoteCustomValue=this.enableVirtualization?!1:this.remoteCustomValue}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&!g(this.fields.disabled)&&this.disableGroupHeader(),this.dataSource instanceof oe&&this.mode==="CheckBox"&&this.allowFiltering&&this.removeFocus()},t.prototype.updateActionList=function(e,i,r,n){this.mode==="CheckBox"&&this.showSelectAll&&this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),!this.mainList&&!this.mainData?(this.mainList=e.cloneNode?e.cloneNode(!0):e,this.mainData=i,this.mainListCollection=this.liCollections):(g(this.mainData)||this.mainData.length===0)&&(this.mainData=i),!((this.remoteCustomValue||i.length<=0)&&this.allowCustomValue&&this.inputFocus&&this.allowFiltering&&this.inputElement.value&&this.inputElement.value!==""&&(this.checkForCustomValue(this.tempQuery,this.fields),this.isCustomRendered))&&(this.value&&this.value.length&&(this.mode!=="CheckBox"&&!g(this.inputElement)&&this.inputElement.value.trim()!==""||this.mode==="CheckBox"||(this.keyCode===8||this.keyCode===46)&&this.allowFiltering&&this.allowCustomValue&&this.dataSource instanceof oe&&this.inputElement.value==="")&&this.refreshSelection(),this.updateListARIA(),this.unwireListEvents(),this.wireListEvents(),g(this.setInitialValue)||this.setInitialValue(),g(this.selectAllAction)||this.selectAllAction(),this.setDynValue&&(!g(this.text)&&(g(this.value)||this.value.length===0)&&this.initialTextUpdate(),this.enableVirtualization?this.dataSource instanceof oe||this.initialValueUpdate():this.isRemoveSelection?this.initialValueUpdate():this.initialValueUpdate(this.listData,!0),this.initialUpdate(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,this.value,null)),this.renderPopup(),this.beforePopupOpen&&(this.beforePopupOpen=!1,this.onPopupShown(r)))},t.prototype.refreshSelection=function(){var e,i,r=this.hideSelectedItem?Ci:de.selected;if(!g(this.value)){for(var n=0;!g(this.value[n]);n++)if(e=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[n]):this.value[n],i=this.findListElement(this.list,"li","data-value",e),i){if(X([i],r),this.hideSelectedItem&&i.previousSibling&&i.previousElementSibling.classList.contains(de.group)&&(!i.nextElementSibling||i.nextElementSibling.classList.contains(de.group))&&X([i.previousElementSibling],r),this.hideSelectedItem&&this.fields.groupBy&&!i.previousElementSibling.classList.contains(Ci)&&this.hideGroupItem(e),this.hideSelectedItem&&i.classList.contains(de.focus)){Z([i],de.focus);var s=i.parentElement.querySelectorAll("."+de.li+":not(."+Ci+"):not(."+Pf+")");s.length>0?(X([s[0]],de.focus),this.updateAriaActiveDescendant()):this.list&&this.list.querySelectorAll("."+de.li).length>0||(this.l10nUpdate(),X([this.list],de.noData))}if(i.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&i.classList.contains("e-active")){var a=i.getElementsByClassName("e-check").length;if(a===0){var l={module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:i,e:null};this.notify("updatelist",l)}}}}this.checkSelectAll(),this.checkMaxSelection()},t.prototype.hideGroupItem=function(e){var i,r,n=this.hideSelectedItem?Ci:de.selected;r=i=this.findListElement(this.ulElement,"li","data-value",e);var s=0,a=0,l=!0,h=!0;do i&&i.previousElementSibling&&!i.previousElementSibling.classList.contains(Ci)&&i.previousElementSibling.classList.contains(de.li)&&(l=!1),!l||!i||i.previousElementSibling&&i.previousElementSibling.classList.contains(de.group)?s=10:i=i.previousElementSibling,r&&r.nextElementSibling&&!r.nextElementSibling.classList.contains(Ci)&&r.nextElementSibling.classList.contains(de.li)&&(h=!1),!h||!r||r.nextElementSibling&&r.nextElementSibling.classList.contains(de.group)?a=10:r=r.nextElementSibling;while(s<10||a<10);l&&h&&!i.previousElementSibling.classList.contains(Ci)?X([i.previousElementSibling],n):l&&h&&i.previousElementSibling.classList.contains(Ci)&&Z([i.previousElementSibling],n)},t.prototype.getValidLi=function(){var e=this.ulElement.querySelector("li."+de.li+":not(."+Ci+")");return g(e)?this.liCollections[0]:e},t.prototype.checkSelectAll=function(){var e=g(this.fields.disabled)?this.list.querySelectorAll("li.e-list-group-item.e-active").length:this.list.querySelectorAll("li.e-list-group-item.e-active:not(.e-disabled)").length,i=this.list.querySelectorAll("li.e-list-item"),r=this.enableVirtualization?this.list.querySelectorAll("li."+de.li+":not(.e-virtual-list)").length:g(this.fields.disabled)?this.list.querySelectorAll("li."+de.li).length:this.list.querySelectorAll("li."+de.li+":not(.e-disabled)").length,n=this.list.querySelectorAll("li."+de.selected).length;if(this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(n=n-e),!this.enableVirtualization&&(r===n||n===this.maximumSelectionLength)&&this.mode==="CheckBox"&&this.showSelectAll||this.enableVirtualization&&this.mode==="CheckBox"&&this.showSelectAll&&this.value&&this.value.length===this.totalItemCount?this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check"}):r!==n&&this.mode==="CheckBox"&&this.showSelectAll&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.enableGroupCheckBox&&this.fields.groupBy&&!this.enableSelectionOrder){for(var s=0;s<i.length;s++)this.findGroupStart(i[s]);this.deselectHeader()}},t.prototype.openClick=function(e){!this.openOnClick&&this.mode!=="CheckBox"&&!this.isPopupOpen()?this.targetElement()!==""?this.showPopup():this.hidePopup(e):!this.openOnClick&&this.mode==="CheckBox"&&!this.isPopupOpen()&&this.showPopup()},t.prototype.keyUp=function(e){if(this.mode==="CheckBox"&&!this.openOnClick){var i=String.fromCharCode(e.keyCode),r=i.match(/\w/);g(r)||(this.isValidKey=!0)}if(this.isValidKey=this.isPopupOpen()&&e.keyCode===8||this.isValidKey,this.isValidKey=e.ctrlKey&&e.keyCode===86?!1:this.isValidKey,this.isValidKey&&this.inputElement)switch(this.isValidKey=!1,this.expandTextbox(),this.showOverAllClear(),e.keyCode){default:this.search(e)}},t.prototype.filter=function(e,i,r){this.isFiltered=!0,this.remoteFilterAction=!0,this.dataUpdater(e,i,r)},t.prototype.getQuery=function(e){var i=e?e.clone():this.query?this.query.clone():new Pe;if(this.isFiltered){if(this.enableVirtualization&&!g(this.customFilterQuery))return i=this.customFilterQuery.clone(),this.virtualFilterQuery(i);if(!this.enableVirtualization)return i}if(this.isFilterAction){if(this.targetElement()!==null&&!this.enableVirtualization||this.enableVirtualization&&this.targetElement()!==null&&this.targetElement().trim()!==""){var r=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof oe)&&r==="string"||r==="number")i.where("",this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent);else if(this.enableVirtualization&&this.targetElement()!==""&&!this.isClearAllAction||!this.enableVirtualization){var n=this.fields;i.where(g(n.text)?"":n.text,this.filterType,this.targetElement(),this.ignoreCase,this.ignoreAccent)}}return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?e?e.skip(0).take(this.maximumSelectionLength).requiresCount():this.query?this.query.skip(0).take(this.maximumSelectionLength).requiresCount():new Pe().skip(0).take(this.maximumSelectionLength).requiresCount():i}else return this.enableVirtualization&&this.viewPortInfo.endIndex!==0&&!this.virtualSelectAll?this.virtualFilterQuery(i):this.virtualSelectAll?e?e.skip(0).take(this.maximumSelectionLength).requiresCount():this.query?this.query.skip(0).take(this.maximumSelectionLength).requiresCount():new Pe().skip(0).take(this.maximumSelectionLength).requiresCount():e||(this.query?this.query:new Pe)},t.prototype.virtualFilterQuery=function(e){for(var i=this.getTakeValue(),r=!0,n=!0,s=0;s<e.queries.length;s++)this.getModuleName()==="multiselect"&&(e.queries[s].e&&e.queries[s].e.condition==="or"||e.queries[s].e&&e.queries[s].e.operator==="equal")&&(r=!1),e.queries[s].fn==="onSkip"&&(n=!1),e.queries[s].fn;var a=0;if(e&&e.queries.length>0)for(var s=0;s<e.queries.length;s++)e.queries[s].fn==="onTake"&&(a=i<=e.queries[s].e.nos?e.queries[s].e.nos:i);if(a<=0&&this.query&&this.query.queries.length>0)for(var s=0;s<this.query.queries.length;s++)this.query.queries[s].fn==="onTake"&&(a=i<=this.query.queries[s].e.nos?this.query.queries[s].e.nos:i);if(e&&e.queries.length>0)for(var s=0;s<e.queries.length;s++)e.queries[s].fn==="onTake"&&(a=e.queries[s].e.nos<=a?a:e.queries[s].e.nos,e.queries.splice(s,1),--s);return(this.allowFiltering&&n||!r||!this.allowFiltering&&n)&&!this.isVirtualReorder&&(r?e.skip(this.virtualItemStartIndex):e.skip(this.viewPortInfo.startIndex)),this.isIncrementalRequest?e.take(this.incrementalEndIndex):a>0?e.take(a):e.take(i),e.requiresCount(),this.customFilterQuery=null,e},t.prototype.getTakeValue=function(){return this.allowFiltering&&j.isDevice?Math.round(window.outerHeight/this.listItemHeight):this.itemCount},t.prototype.dataUpdater=function(e,i,r){this.isDataFetched=!1;var n=this.list.classList.contains(de.noData);if(this.targetElement().trim()===""&&(!this.allowCustomValue||this.mode==="CheckBox"||this.targetElement()==="")){var s=this.enableVirtualization?this.list.cloneNode(!0):this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.backCommand||this.enableVirtualization&&this.mode==="CheckBox"&&this.value&&this.value.length>0){this.remoteCustomValue=!1;var a=!1;if(this.allowCustomValue&&s.querySelectorAll("li").length===0&&this.mainData.length>0&&(this.mainData=[]),this.enableVirtualization){if(this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null),this.value&&this.value.length>0&&this.mode==="CheckBox")this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"}),a=!0;else if(this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.resetList(e,r,i),this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.UpdateSkeleton(),(n||this.allowCustomValue)&&!this.list.classList.contains(de.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}}this.onActionComplete(s,this.mainData),this.value&&this.value.length&&this.refreshSelection(),this.keyCode!==8&&this.focusAtFirstListItem(),a||this.notify("reOrder",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",e:this})}}else{if(this.enableVirtualization&&this.allowFiltering&&(this.isPreventScrollAction=!0,this.list.scrollTop=0,this.previousStartIndex=0,this.virtualListInfo=null,this.list.querySelector(".e-list-parent.e-reorder")&&this.list.querySelector(".e-list-parent.e-reorder").remove()),this.resetList(e,r,i),this.enableVirtualization&&(n||this.allowCustomValue)&&!this.list.classList.contains(de.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")){var l=this.createElement("div",{className:"e-virtual-ddl-content"});l.style.cssText=this.getTransformValues(),this.list.appendChild(l).appendChild(this.list.querySelector(".e-list-parent"))}if(this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),!this.list.querySelector(".e-virtual-ddl")){var h=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});h.style.cssText=this.GetVirtualTrackHeight(),document.getElementsByClassName("e-multi-select-list-wrapper")[0].querySelector(".e-dropdownbase").appendChild(h)}}this.allowCustomValue&&(e instanceof oe?(this.remoteCustomValue=!0,this.tempQuery=i):this.checkForCustomValue(i,r))}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount(),this.refreshPopup(),this.allowResize&&!this.isFilteringAction&&this.setResize(),this.mode==="CheckBox"&&this.removeFocus()},t.prototype.secureRandom=function(){var e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]/4294967296},t.prototype.checkForCustomValue=function(e,i){var r=!this.getValueByText(this.inputElement.value,this.ignoreCase),n=i||this.fields;if(this.isCustomReset=!0,this.allowCustomValue&&r){var s=this.inputElement.value,a=!g(this.mainData)&&this.mainData.length>0?this.mainData[0]:this.mainData;if(a&&typeof a!="string"&&typeof a!="number"&&typeof a!="boolean"){var l={};it(n.text,s,l),typeof V(this.fields.value?this.fields.value:"value",a)=="number"&&this.fields.value!==this.fields.text?it(n.value,this.secureRandom(),l):it(n.value,s,l);var h={};if(this.allowObjectBinding){var c=this.listData&&this.listData.length>0?Object.keys(this.listData[0]):this.firstItem?Object.keys(this.firstItem):Object.keys(l),u=typeof V(this.fields.value?this.fields.value:"value",a)=="number"&&this.fields.value!==this.fields.text;c.forEach(function(y){h[y]=y===i.value||y===i.text?y===i.text&&u?V(i.text,l):V(i.value,l):null})}if(l=this.allowObjectBinding?h:l,this.enableVirtualization){this.virtualCustomData=l;var d=this.dataSource instanceof oe?JSON.parse(JSON.stringify(this.listData)):JSON.parse(JSON.stringify(this.dataSource)),p=[];this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&(p=d.concat(this.virtualCustomSelectData)),d.splice(0,0,l),this.isCustomDataUpdated=!0;var f=this.totalItemCount;this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.resetList(d,n,e),this.isCustomDataUpdated=!1,this.totalItemCount=this.enableVirtualization&&this.dataSource instanceof oe?f:this.totalItemCount}else{this.dataSource instanceof oe&&this.allowCustomValue&&this.allowFiltering&&(this.remoteCustomValue=!1);var d=JSON.parse(JSON.stringify(this.listData));d.splice(0,0,l),this.resetList(d,n,e),this.focusAtLastListItem(s)}}else if(this.listData){var d=JSON.parse(JSON.stringify(this.listData));d.splice(0,0,this.inputElement.value),d[0]=typeof a=="number"&&!isNaN(parseFloat(d[0]))?parseFloat(d[0]):d[0],d[0]=typeof a=="boolean"?d[0]==="true"?!0:d[0]==="false"?!1:d[0]:d[0],this.resetList(d,n),this.focusAtLastListItem(s)}}else if(this.listData&&this.mainData&&!r&&this.allowCustomValue){if(this.allowFiltering&&this.isRemoteSelection&&this.remoteCustomValue)this.isRemoteSelection=!1,this.enableVirtualization||this.resetList(this.listData,n,e);else if(!this.allowFiltering&&this.list){var v=this.list.querySelectorAll("li."+de.li+":not(.e-hide-listitem)"),m=wa(this.targetElement(),v,"StartsWith",this.ignoreCase);m&&m.item!==null&&this.addListFocus(m.item)}}this.isCustomReset=!1,this.value&&this.value.length&&this.refreshSelection()},t.prototype.getNgDirective=function(){return"EJS-MULTISELECT"},t.prototype.wrapperClick=function(e){if(this.setDynValue=!1,this.keyboardEvent=null,this.isKeyBoardAction=!1,!!this.enabled){if(e.target===this.overAllClear){e.preventDefault();return}if(this.inputFocus||this.inputElement.focus(),!this.readonly){if(e.target&&e.target.classList.toString().indexOf(Ey)!==-1){this.isPopupOpen()&&this.refreshPopup();return}!this.isPopupOpen()&&(this.openOnClick||this.showDropDownIcon&&e.target&&e.target.className===NF)?this.showPopup(e):(this.hidePopup(e),this.mode==="CheckBox"&&(this.showOverAllClear(),this.inputFocus=!0,this.overAllWrapper.classList.contains(Sc)||this.overAllWrapper.classList.add(Sc)))}this.targetElement()&&this.targetElement()!==""||e.preventDefault(),this.checkAndScrollParent(),this.maximumSelectionLength===0&&this.checkMaxSelection()}},t.prototype.checkAndScrollParent=function(){for(var e=this.overAllWrapper?this.overAllWrapper.parentElement:null;e;){var i=getComputedStyle(e),r=parseFloat(i.maxHeight)||parseFloat(i.height);if(!isNaN(r)&&this.isPopupOpen()){var n=i.overflowY,s=this.overAllWrapper.getBoundingClientRect().bottom,a=e.getBoundingClientRect().bottom;if((n==="auto"||n==="scroll")&&s>a){e.scrollTop+=s-a+10;return}}e=e.parentElement}},t.prototype.enable=function(e){e?(this.overAllWrapper.classList.remove(Pf),this.inputElement.removeAttribute("disabled"),Ee(this.inputElement,{"aria-disabled":"false"}),this.ensureAriaDisabled("false")):(this.overAllWrapper.classList.add(Pf),this.inputElement.setAttribute("disabled","true"),Ee(this.inputElement,{"aria-disabled":"true"}),this.ensureAriaDisabled("true")),this.enabled!==e&&(this.enabled=e),this.hidePopup()},t.prototype.onBlurHandler=function(e,i){var r;if(this.updatePopupHeightOnFilter(),this.isBlurDispatching&&this.isAngular){this.isBlurDispatching=!1;return}if(g(e)||(r=e.relatedTarget),this.popupObj&&document.body.contains(this.popupObj.element)&&this.popupObj.element.contains(r)){this.mode!=="CheckBox"?this.inputElement.focus():this.floatLabelType==="Auto"&&(this.overAllWrapper.classList.contains("e-outline")||this.overAllWrapper.classList.contains("e-filled"))&&X([this.overAllWrapper],"e-valid-input");return}if(this.floatLabelType==="Auto"&&this.overAllWrapper.classList.contains("e-outline")&&this.mode==="CheckBox"&&(g(this.value)||this.value.length===0)&&Z([this.overAllWrapper],"e-valid-input"),this.mode==="CheckBox"&&j.isIE&&!g(e)&&!i){this.inputFocus=!1,this.overAllWrapper.classList.remove(Sc);return}if(this.scrollFocusStatus){g(e)||e.preventDefault(),this.inputElement.focus(),this.scrollFocusStatus=!1;return}if(this.inputFocus=!1,this.overAllWrapper.classList.remove(Sc),this.addTagOnBlur){var n=this.getValueByText(this.inputElement.value,this.ignoreCase,this.ignoreAccent),s=this.findListElement(this.list,"li","data-value",n),a=this.hideSelectedItem?Ci:de.selected,l=!!(s&&!s.classList.contains(a));l&&(this.updateListSelection(s,e),this.mode==="Delimiter"&&this.updateDelimeter(this.delimiterChar))}this.updateDataList(),this.refreshListItems(null),this.mode!=="Box"&&this.mode!=="CheckBox"&&this.updateDelimView(),this.changeOnBlur&&(this.updateValueState(e,this.value,this.tempValues),this.dispatchEvent(this.hiddenElement,"change")),this.overAllClear.style.display="none",this.isPopupOpen()&&this.hidePopup(e),this.makeTextBoxEmpty(),this.trigger("blur"),this.focused=!0,j.isDevice&&this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.removeChipFocus(),this.removeChipSelection(),this.refreshInputHight(),x5(this.overAllWrapper,this.componentWrapper,this.value,this.floatLabelType,this.placeholder),this.refreshPlaceHolder(),(this.allowFiltering||this.enableSelectionOrder===!0&&this.mode==="CheckBox")&&!g(this.mainList)&&(this.ulElement=this.mainList),this.checkPlaceholderSize(),this.element.querySelector(".e-multiselect .e-float-text-content")===null&&Ie.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),this.updateFloatLabelOverflowWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.isBlurDispatching=!0,this.isAngular&&this.dispatchEvent(this.inputElement,"blur")},t.prototype.calculateWidth=function(){var e;if(this.overAllWrapper){if(!this.showDropDownIcon||this.overAllWrapper.querySelector(".e-label-top"))e=this.overAllWrapper.clientWidth-2*parseInt(getComputedStyle(this.inputElement).paddingRight,10);else{var i=this.dropIcon.offsetWidth+parseInt(getComputedStyle(this.dropIcon).marginRight,10);e=this.overAllWrapper.clientWidth-(i+2*parseInt(getComputedStyle(this.inputElement).paddingRight,10))}this.floatLabelType!=="Never"&&Ie.calculateWidth(e,this.overAllWrapper,this.getModuleName())}},t.prototype.checkPlaceholderSize=function(){if(this.showDropDownIcon){var e=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10);this.setPlaceholderSize(e)}else g(this.dropIcon)||this.setPlaceholderSize(this.showDropDownIcon?this.dropIcon.offsetWidth:0)},t.prototype.setPlaceholderSize=function(e){g(this.value)||this.value.length===0?this.dropIcon.offsetWidth!==0?this.searchWrapper.style.width="calc(100% - "+(e+10)+"px":X([this.searchWrapper],FF):g(this.value)||(this.searchWrapper.removeAttribute("style"),Z([this.searchWrapper],FF))},t.prototype.refreshInputHight=function(){g(this.searchWrapper)||((!this.value||!this.value.length)&&(g(this.text)||this.text==="")?this.searchWrapper.classList.remove(Ty):this.searchWrapper.classList.add(Ty))},t.prototype.validateValues=function(e,i){return JSON.stringify(e.slice().sort())!==JSON.stringify(i.slice().sort())},t.prototype.updateValueState=function(e,i,r){var n=i||[],s=r||[];if(this.initStatus&&this.validateValues(n,s)){var a={e,oldValue:(this.allowObjectBinding,r),value:(this.allowObjectBinding,i),isInteracted:!!e,element:this.element,event:e};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",a),this.enableVirtualization&&this.enableSelectionOrder&&this.mode==="CheckBox"&&(this.preventSetCurrentData=!1),this.updateTempValue(),this.changeOnBlur||this.dispatchEvent(this.hiddenElement,"change")}this.selectedValueInfo=this.viewPortInfo},t.prototype.updateTempValue=function(){this.value?this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice():this.tempValues=this.value},t.prototype.updateAriaActiveDescendant=function(){!g(this.ulElement)&&!g(this.ulElement.getElementsByClassName("e-item-focus")[0])&&Ee(this.inputElement,{"aria-activedescendant":this.ulElement.getElementsByClassName("e-item-focus")[0].id})},t.prototype.pageUpSelection=function(e,i){var r=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide)"),n=e>=0?r[e+1]:r[0];if(this.fields.disabled&&n&&!this.enableVirtualization){for(;n&&(n.classList.contains("e-disabled")||n.classList.contains(Ci)||n.classList.contains(".e-reorder-hide")||n.classList.contains("e-list-group-item"));)n=n.previousElementSibling;if(!n)return}this.enableVirtualization&&i&&(n=this.liCollections.length>=e&&e>=0?this.liCollections[e]:this.liCollections[this.skeletonCount]),!g(n)&&n.classList.contains("e-virtual-list")&&(n=this.liCollections[this.skeletonCount]),this.enableVirtualization?(!g(n)&&!n.classList.contains("e-item-focus")?(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)):this.viewPortInfo.startIndex===0&&(this.isKeyBoardAction=!0,this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode)),this.previousFocusItem=n):(this.isKeyBoardAction=!0,this.addListFocus(n),this.scrollTop(n,this.getIndexByValue(n.getAttribute("data-value")),this.keyboardEvent.keyCode))},t.prototype.pageDownSelection=function(e,i){var r=this.getItems(),n=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list-end)"),s=e<=n.length?n[e-1]:n[n.length-1];if(this.fields.disabled&&s&&!this.enableVirtualization){for(;s&&(s.classList.contains("e-disabled")||s.classList.contains(Ci)||s.classList.contains(".e-reorder-hide")||s.classList.contains("e-list-group-item"));)s=s.nextElementSibling;if(!s)return}this.enableVirtualization&&this.skeletonCount>0&&(s=e<r.length?this.liCollections[e]:this.liCollections[r.length-1]),this.enableVirtualization&&i&&(s=e<=r.length?this.liCollections[e]:this.liCollections[r.length-1]),this.enableVirtualization&&s&&s.classList.contains("e-virtual-list-end")&&(s=n[n.length-1]),this.isKeyBoardAction=!0,this.addListFocus(s),this.previousFocusItem=s,this.scrollBottom(s,this.getIndexByValue(s.getAttribute("data-value")),!1,this.keyboardEvent.keyCode)},t.prototype.getItems=function(){return this.list||o.prototype.render.call(this),this.ulElement&&this.ulElement.querySelectorAll("."+de.li).length>0?this.ulElement.querySelectorAll("."+de.li+":not(."+Ci+")"):[]},t.prototype.focusInHandler=function(e){var i=this;if(this.enabled){if(this.showOverAllClear(),this.inputFocus=!0,this.value&&this.value.length&&(this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.mode!=="CheckBox"&&(this.viewWrapper.style.display="none")),this.mode!=="CheckBox"&&this.searchWrapper.classList.remove(Ty),this.checkPlaceholderSize(),this.floatLabelType!=="Never"&&this.overAllWrapper){var r=this.overAllWrapper.querySelector(".e-float-text");r&&r.removeAttribute("style")}if(this.focused){var n={isInteracted:!!e,event:e};this.trigger("focus",n),this.focused=!1}return this.overAllWrapper.classList.contains(Sc)||this.overAllWrapper.classList.add(Sc),w5(this.overAllWrapper,this.componentWrapper),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),setTimeout(function(){i.calculateWidth()},150),!0}else return!1},t.prototype.showDelimWrapper=function(){this.mode==="CheckBox"?this.viewWrapper.style.display="":this.delimiterWrapper.style.display="",this.componentWrapper.classList.add(MF)},t.prototype.hideDelimWrapper=function(){this.delimiterWrapper.style.display="none",this.componentWrapper.classList.remove(MF)},t.prototype.expandTextbox=function(){var e=5;if(this.placeholder){var i=this.placeholder.charCodeAt(0),r=44032<=i&&i<=55215?1.5:19968<=i&&i<=40959?2:1;e=e>this.inputElement.placeholder.length?e:this.inputElement.placeholder.length*r}this.inputElement.value.length>e?this.inputElement.size=this.inputElement.value.length:this.inputElement.size=e},t.prototype.isPopupOpen=function(){return this.popupWrapper!==null&&this.popupWrapper.parentElement!==null},t.prototype.refreshPopup=function(){this.popupObj&&this.mobFilter&&(this.popupObj.setProperties({width:this.calcPopupWidth()}),this.popupObj.refreshPosition(this.overAllWrapper),this.popupObj.resolveCollision())},t.prototype.checkTextLength=function(){return this.targetElement().length<1},t.prototype.popupKeyActions=function(e){switch(e.keyCode){case 38:this.hidePopup(e),this.mode==="CheckBox"&&this.inputElement.focus(),e.preventDefault();break;case 40:this.isPopupOpen()||(this.showPopup(e),e.preventDefault());break}},t.prototype.updatePopupPosition=function(){this.refreshPopup()},t.prototype.updateAriaAttribute=function(){var e=this.list.querySelector("."+de.focus);if(!g(e))if(this.inputElement.setAttribute("aria-activedescendant",e.id),this.allowFiltering){var i=this.popupWrapper.querySelector("."+EI);i&&i.setAttribute("aria-activedescendant",e.id)}else this.mode==="CheckBox"&&this.overAllWrapper.setAttribute("aria-activedescendant",e.id)},t.prototype.homeNavigation=function(e,i){if(this.removeFocus(),this.enableVirtualization){if(e)this.enableVirtualization&&this.viewPortInfo.startIndex!==0&&(this.viewPortInfo.startIndex=0,this.viewPortInfo.endIndex=this.itemCount,this.updateVirtualItemIndex(),this.resetList(this.dataSource,this.fields,this.query));else if(this.enableVirtualization&&(!this.value&&this.viewPortInfo.endIndex!==this.totalItemCount||this.value&&this.value.length>0&&this.viewPortInfo.endIndex!==this.totalItemCount+this.value.length)){this.viewPortInfo.startIndex=this.totalItemCount-this.itemCount,this.viewPortInfo.endIndex=this.totalItemCount,this.updateVirtualItemIndex();var r=new Pe().clone();this.value&&this.value.length>0&&(r=this.getForQuery(this.value).clone(),r=r.skip(this.totalItemCount-this.itemCount)),this.resetList(this.dataSource,this.fields,r)}}this.UpdateSkeleton();var n=this.ulElement.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide)");if(n.length>0){var s=n[e?0:n.length-1];this.enableVirtualization&&e&&(s=n[this.skeletonCount]),this.removeFocus(),s.classList.add(de.focus),this.enableVirtualization&&e?this.scrollTop(s,void 0,this.keyboardEvent.keyCode):i||this.scrollBottom(s,void 0,!1,this.keyboardEvent.keyCode),this.updateAriaActiveDescendant()}},t.prototype.updateSelectionList=function(){if(!g(this.value)&&this.value.length)for(var e=0;e<this.value.length;e++){var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[e]):this.value[e],r=this.getElementByValue(i);r&&!r.classList.contains(de.selected)&&r.classList.add("e-active")}},t.prototype.handleVirtualKeyboardActions=function(e,i){var r=this.list.querySelector("."+de.focus),n;switch(this.isKeyBoardAction=!0,e.keyCode){case 40:this.arrowDown(e,!0);break;case 38:this.arrowUp(e,!0);break;case 33:e.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value"))-1,this.pageUpSelection(n,!0),this.updateAriaAttribute());break;case 34:e.preventDefault(),r&&(n=this.getIndexByValue(this.previousFocusItem.getAttribute("data-value")),this.pageDownSelection(n,!0),this.updateAriaAttribute());break;case 35:case 36:this.isMouseScrollAction=!0,this.homeNavigation(e.keyCode===36,!0),this.isPreventScrollAction=!0;break}this.keyboardEvent=null,this.isScrollChanged=!0,this.isKeyBoardAction=!1},t.prototype.onKeyDown=function(e){if(!(this.readonly||!this.enabled&&this.mode!=="CheckBox")&&(this.preventSetCurrentData=!1,this.keyboardEvent=e,this.isPreventKeyAction&&this.enableVirtualization&&e.preventDefault(),this.keyCode=e.keyCode,this.keyDownStatus=!0,!(e.keyCode>111&&e.keyCode<124))){if(e.altKey){this.popupKeyActions(e);return}else if(this.isPopupOpen()){var i=this.list.querySelector("."+de.focus),r=void 0;switch(e.keyCode){case 36:case 35:this.isMouseScrollAction=!0,this.isKeyBoardAction=!0,this.homeNavigation(e.keyCode===36);break;case 33:e.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageUpSelection(r-this.getPageCount()-1),this.updateAriaAttribute());return;case 34:e.preventDefault(),i&&(r=this.getIndexByValue(i.getAttribute("data-value")),this.pageDownSelection(r+this.getPageCount()),this.updateAriaAttribute());return;case 38:this.isKeyBoardAction=!0,this.arrowUp(e);break;case 40:this.isKeyBoardAction=!0,this.arrowDown(e);break;case 27:e.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(e),this.mode==="CheckBox"&&this.inputElement.focus(),this.isKeyBoardAction=!1;return;case 13:e.preventDefault(),this.isKeyBoardAction=!0,this.mode!=="CheckBox"&&this.selectByKey(e),this.checkPlaceholderSize(),this.isKeyBoardAction=!1;return;case 32:this.isKeyBoardAction=!0,this.spaceKeySelection(e),this.isKeyBoardAction=!1;return;case 9:e.preventDefault(),this.isKeyBoardAction=!0,this.hidePopup(e),this.inputElement.focus(),this.overAllWrapper.classList.add(Sc)}}else switch(e.keyCode){case 13:case 9:case 16:case 17:case 20:return;case 40:this.openOnClick&&this.showPopup();break;case 27:e.preventDefault(),this.escapeAction();return}this.checkTextLength()&&this.keyNavigation(e),this.mode==="CheckBox"&&this.enableSelectionOrder&&(this.allowFiltering&&(this.previousFilterText=this.targetElement()),this.checkBackCommand(e)),this.expandTextbox(),this.mode==="CheckBox"&&this.showSelectAll||this.refreshPopup(),this.allowResize&&!this.isFilterAction&&this.setResize(),this.isKeyBoardAction=!1}},t.prototype.arrowDown=function(e,i){e.preventDefault(),this.moveByList(1,i),this.keyAction=!0,(document.activeElement.classList.contains(EI)||this.mode==="CheckBox"&&!this.allowFiltering&&document.activeElement!==this.list)&&T.add(this.list,"keydown",this.onKeyDown,this),this.updateAriaAttribute()},t.prototype.arrowUp=function(e,i){e.preventDefault(),this.keyAction=!0;var r=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide)");this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+de.li+",li."+de.group+":not(."+Ci+"):not(.e-reorder-hide)"));var n=this.list.querySelector("li."+de.focus);if(this.focusFirstListItem=g(this.liCollections[0])?!1:this.liCollections[0].classList.contains("e-item-focus"),this.list&&this.list.querySelector(".e-list-parent.e-ul.e-reorder")){var s=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list-end)");s.length>0&&(this.focusFirstListItem=g(s[0])?!1:s[0].classList.contains("e-item-focus"))}var a=Array.prototype.slice.call(r).indexOf(n);a<=0&&this.mode==="CheckBox"&&this.allowFiltering&&(this.keyAction=!1,this.notify("inputFocus",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"focus"})),this.moveByList(-1,i),this.updateAriaAttribute()},t.prototype.spaceKeySelection=function(e){if(this.mode==="CheckBox"){var i=this.list.querySelector("li."+de.focus),r=document.getElementsByClassName("e-selectall-parent")[0];if((!g(i)||r&&r.classList.contains("e-item-focus"))&&(e.preventDefault(),this.keyAction=!0),this.selectByKey(e),this.keyAction){var n=this.list.querySelector("li."+de.focus);!g(n)&&r&&r.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")}}this.checkPlaceholderSize()},t.prototype.checkBackCommand=function(e){(e.keyCode===8&&this.allowFiltering?this.targetElement()!==this.previousFilterText:this.targetElement()==="")?this.backCommand=!1:this.backCommand=!0},t.prototype.keyNavigation=function(e){if(this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.value&&this.value.length)switch(e.keyCode){case 37:e.preventDefault(),this.moveBy(-1,e);break;case 39:e.preventDefault(),this.moveBy(1,e);break;case 8:this.removelastSelection(e);break;case 46:this.removeSelectedChip(e);break}else if(e.keyCode===8&&this.mode==="Delimiter"&&this.value&&this.value.length){e.preventDefault();var i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1];this.removeValue(this.value[this.value.length-1],e),this.updateDelimeter(this.delimiterChar,e),this.focusAtLastListItem(i)}},t.prototype.selectByKey=function(e){this.removeChipSelection(),this.selectListByKey(e),this.hideSelectedItem&&this.focusAtFirstListItem()},t.prototype.escapeAction=function(){var e=this.tempValues?this.tempValues.slice():[];this.allowObjectBinding&&(e=this.tempValues?this.tempValues.slice():[]),this.value&&this.validateValues(this.value,e)&&(this.mode!=="CheckBox"&&(this.value=e,(this.allowFiltering||this.allowCustomValue)&&this.refreshListItems(null),this.initialValueUpdate()),this.mode!=="Delimiter"&&this.mode!=="CheckBox"?this.chipCollectionWrapper.style.display="":this.showDelimWrapper(),this.refreshPlaceHolder(),this.value.length?this.showOverAllClear():this.hideOverAllClear()),this.makeTextBoxEmpty()},t.prototype.scrollBottom=function(e,i,r,n,s){r===void 0&&(r=!1),n===void 0&&(n=null),s===void 0&&(s=!1),(!g(e)&&e.classList.contains("e-virtual-list")||this.enableVirtualization&&g(e))&&(e=this.liCollections[this.skeletonCount]);var a=e&&!isNaN(parseInt(window.getComputedStyle(e).marginBottom,10))?parseInt(window.getComputedStyle(e).marginBottom,10):0;this.isUpwardScrolling=!1;var l=this.list.querySelectorAll(".e-virtual-list:not(.e-virtual-list-end)").length,h=this.list.querySelectorAll("li:not(.e-virtual-list-end)"),c=h&&h.length>0&&h[h.length-1]?h[h.length-1].getAttribute("data-value"):null,u=this.virtualListInfo&&this.virtualListInfo.startIndex?e.offsetTop+this.virtualListInfo.startIndex*(e.offsetHeight+a):e.offsetTop,d=this.list.offsetHeight,p=u-l*(e.offsetHeight+a)+(e.offsetHeight+a)-this.list.scrollTop,f=this.list.scrollTop+p-d,v=!1,m=u-l*(e.offsetHeight+a)+(e.offsetHeight+a)-this.list.scrollTop;if(m=this.fields.groupBy&&!g(this.fixedHeaderElement)?m-this.fixedHeaderElement.offsetHeight:m,i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(p>d||!(m>0&&this.list.offsetHeight>m)){var y=e?e.getAttribute("data-value"):null,b=n===34?this.getPageCount()-1:1;!this.enableVirtualization||this.isKeyBoardAction||r?this.isKeyBoardAction&&this.enableVirtualization&&c&&y===c&&n!==35&&!this.isVirtualScrolling?(this.isPreventKeyAction=!0,this.list.scrollTop+=(e.offsetHeight+a)*b,this.isPreventKeyAction=this.isScrollerAtEnd()?!1:this.isPreventKeyAction,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1):this.enableVirtualization&&n===35?(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1,this.list.scrollTop=this.list.scrollHeight):(n===34&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=f):this.list.scrollTop=this.virtualListInfo&&this.virtualListInfo.startIndex?s&&this.virtualListInfo.startIndex?this.virtualListInfo.startIndex*this.listItemHeight+this.listItemHeight*2:this.virtualListInfo.startIndex*this.listItemHeight:0,v=this.isKeyBoardAction}this.isKeyBoardAction=v},t.prototype.scrollTop=function(e,i,r){r===void 0&&(r=null);var n=this.list.querySelectorAll(".e-virtual-list:not(.e-virtual-list-end)").length,s=e&&!isNaN(parseInt(window.getComputedStyle(e).marginBottom,10))?parseInt(window.getComputedStyle(e).marginBottom,10):0,a=this.virtualListInfo&&this.virtualListInfo.startIndex?e.offsetTop+this.virtualListInfo.startIndex*(e.offsetHeight+s):e.offsetTop,l=a-n*(e.offsetHeight+s)-this.list.scrollTop,h=this.list.querySelector("li.e-list-item:not(.e-virtual-list)")?this.list.querySelector("li.e-list-item:not(.e-virtual-list)").getAttribute("data-value"):null;l=this.fields.groupBy&&!Te(this.fixedHeaderElement)?l-this.fixedHeaderElement.offsetHeight:l;var c=a-n*(e.offsetHeight+s)+(e.offsetHeight+s)-this.list.scrollTop,u=this.enableVirtualization&&this.getModuleName()==="autocomplete"&&l<=0;if(i===0&&!this.enableVirtualization)this.list.scrollTop=0;else if(l<0||u){var d=e?e.getAttribute("data-value"):null,p=r===33?this.getPageCount()-2:1;this.enableVirtualization&&this.isKeyBoardAction&&h&&d===h&&r!==36&&!this.isVirtualScrolling?(this.isUpwardScrolling=!0,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTop-=(e.offsetHeight+s)*p,this.isPreventKeyAction=this.list.scrollTop!==0?this.isPreventKeyAction:!1,this.isPreventScrollAction=!1):this.enableVirtualization&&r===36?(this.isPreventScrollAction=!1,this.isPreventKeyAction=!0,this.isKeyBoardAction=!1,this.list.scrollTo(0,0)):(r===33&&this.enableVirtualization&&!this.isVirtualScrolling&&(this.isPreventKeyAction=!1,this.isKeyBoardAction=!1,this.isPreventScrollAction=!1),this.list.scrollTop=this.list.scrollTop+l)}else c>0&&this.list.offsetHeight>c||(this.list.scrollTop=e.offsetTop-(this.fields.groupBy&&!g(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))},t.prototype.isScrollerAtEnd=function(){return this.list&&this.list.scrollTop+this.list.clientHeight>=this.list.scrollHeight},t.prototype.selectListByKey=function(e){var i=this.list.querySelector("li."+de.focus),r=this.value&&this.value.length?this.value.length:0,n;if(i!==null){if(e.preventDefault(),i.classList.contains("e-active")&&(r=r-1),this.isValidLI(i)&&r<this.maximumSelectionLength){this.updateListSelection(i,e),this.addListFocus(i),this.mode==="CheckBox"?(this.updateDelimView(),this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight(),this.checkPlaceholderSize(),this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(n=i.firstElementChild.lastElementChild,this.findGroupStart(n),this.deselectHeader())):this.updateDelimeter(this.delimiterChar,e);var s=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.mode!=="CheckBox"&&this.refreshListItems(i.textContent,s),this.changeOnBlur||this.updateValueState(e,this.value,this.tempValues),this.refreshPopup()}else!this.isValidLI(i)&&r<this.maximumSelectionLength&&(n=i.firstElementChild.lastElementChild,n.classList.contains("e-check")?this.selectAllItem(!1,e,i):this.selectAllItem(!0,e,i));this.refreshSelection(),this.closePopupOnSelect&&this.hidePopup(e)}var a=document.getElementsByClassName("e-selectall-parent")[0];if(a&&a.classList.contains("e-item-focus")){var l=a.childNodes[0];if(l.classList.contains("e-check")){l.classList.remove("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!1,e,i)}else{l.classList.add("e-check");var h={module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"check",name:"checkSelectAll"};this.notify("checkSelectAll",h),this.selectAllItem(!0,e,i)}}this.refreshPlaceHolder()},t.prototype.refreshListItems=function(e,i){if((this.allowFiltering||this.mode==="CheckBox"&&this.enableSelectionOrder===!0||this.allowCustomValue)&&this.mainList&&this.listData){var r=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;if(this.enableVirtualization)if(this.allowCustomValue&&this.virtualCustomData&&e==null&&this.virtualCustomData&&this.viewPortInfo&&this.viewPortInfo.startIndex===0&&this.viewPortInfo.endIndex===this.itemCount)this.virtualCustomData=null,this.renderItems(this.mainData,this.fields);else if(this.allowFiltering&&i){if(this.updateInitialData(),this.onActionComplete(r,this.mainData),this.isVirtualTrackHeight=!1,this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var n=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});n.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(n)}}else this.onActionComplete(this.list,this.listData);else this.onActionComplete(r,this.mainData);this.focusAtLastListItem(e),this.value&&this.value.length&&this.refreshSelection()}else!g(this.fields.groupBy)&&this.value&&this.value.length&&this.refreshSelection()},t.prototype.removeSelectedChip=function(e){var i=this.chipCollectionWrapper.querySelector("span."+xl),r;if(i!==null){g(this.value)||(this.tempValues=this.allowObjectBinding?this.value.slice():this.value.slice()),r=i.nextElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,e));var n=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(i.getAttribute("data-value"))):i.getAttribute("data-value");this.removeValue(n,e),this.updateDelimeter(this.delimiterChar,e),this.makeTextBoxEmpty()}this.closePopupOnSelect&&this.hidePopup(e),this.checkPlaceholderSize()},t.prototype.moveByTop=function(e){var i=this.list.querySelectorAll("li."+de.li),r;i.length>1&&(this.removeFocus(),r=e?0:i.length-1,this.addListFocus(i[r]),this.scrollBottom(i[r],r)),this.updateAriaAttribute()},t.prototype.clickHandler=function(e){var i=e.target,r=i.className,n=document.getElementsByClassName("e-selectall-parent")[0];(r==="e-input-filter e-input"||r==="e-input-group e-control-wrapper e-input-focus")&&n.classList.contains("e-item-focus")&&n.classList.remove("e-item-focus")},t.prototype.moveByList=function(e,i){if(this.list){var r=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list-end)");this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&(r=this.list.querySelectorAll("li."+de.li+",li."+de.group+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list-end)"));var n=this.list.querySelector("li."+de.focus);this.enableVirtualization&&i&&!g(this.currentFocuedListElement)&&(n=this.getElementByValue(this.getFormattedValue(this.currentFocuedListElement.getAttribute("data-value"))));var s=-1,a=document.getElementsByClassName("e-selectall-parent")[0];if(this.mode==="CheckBox"&&this.showSelectAll&&e===1&&!g(a)&&!a.classList.contains("e-item-focus")&&this.list.getElementsByClassName("e-item-focus").length===0&&this.liCollections.length>1)!this.focusFirstListItem&&a.classList.contains("e-item-focus")?a.classList.remove("e-item-focus"):a.classList.contains("e-item-focus")||a.classList.add("e-item-focus");else if(r.length){this.mode==="CheckBox"&&this.showSelectAll&&!g(a&&e===-1)&&((!this.focusFirstListItem||e===1)&&a.classList.contains("e-item-focus")?a.classList.remove("e-item-focus"):this.focusFirstListItem&&!a.classList.contains("e-item-focus")&&!(e===1&&this.list.querySelector(".e-item-focus"))&&a.classList.add("e-item-focus"));for(var l=0;l<r.length;l++)if(r[l]===n){s=l;break}if(e>0)s<r.length-1&&(this.removeFocus(),this.enableVirtualization&&i?this.addListFocus(r[s]):this.enableVirtualization&&r[s+1].classList.contains("e-virtual-list")?this.addListFocus(r[this.skeletonCount]):this.addListFocus(r[++s]),s>-1&&(this.updateCheck(r[s]),this.scrollBottom(r[s],s),this.currentFocuedListElement=r[s]));else if(s>0)if(this.enableVirtualization){var h=r[s-1].classList.contains("e-virtual-list"),c=i?s:s-1;(i||!h)&&this.removeFocus(),(i||!h)&&(this.addListFocus(r[c]),this.updateCheck(r[c]),this.scrollTop(r[c],s),this.currentFocuedListElement=r[c])}else this.removeFocus(),this.addListFocus(r[--s]),this.updateCheck(r[s]),this.scrollTop(r[s],s)}}var u=this.list?this.list.querySelector(".e-item-focus"):null;if(this.isDisabledElement(u)){if(this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem):not(.e-disabled)").length===0||this.keyCode===38&&this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&u===this.list.querySelector("li.e-list-group-item")){this.removeFocus();return}var l=this.getIndexByValue(u.getAttribute("data-value"));l===0&&(e=1),l===this.list.querySelectorAll(".e-list-item:not(.e-hide-listitem)").length-1&&(e=-1),this.moveByList(e)}},t.prototype.getElementByValue=function(e){for(var i,r=this.getItems(),n=0,s=r;n<s.length;n++){var a=s[n];if(this.getFormattedValue(a.getAttribute("data-value"))===e){i=a;break}}return i},t.prototype.updateCheck=function(e){if(this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)){var i=e.firstElementChild.lastElementChild;i.classList.contains("e-check")?e.classList.add("e-active"):e.classList.remove("e-active")}},t.prototype.moveBy=function(e,i){var r,n=this.chipCollectionWrapper.querySelectorAll("span."+Cc),s=this.chipCollectionWrapper.querySelector("span."+xl);s===null?e<0&&this.addChipSelection(n[n.length-1],i):e<0?(r=s.previousElementSibling,r!==null&&(this.removeChipSelection(),this.addChipSelection(r,i))):(r=s.nextElementSibling,this.removeChipSelection(),r!==null&&this.addChipSelection(r,i))},t.prototype.chipClick=function(e){if(this.enabled){var i=H(e.target,"."+Cc);this.removeChipSelection(),this.addChipSelection(i,e)}},t.prototype.removeChipSelection=function(){if(this.chipCollectionWrapper){var e=this.chipCollectionWrapper.querySelectorAll("span."+Cc+"."+xl);if(e&&e.length>0)for(var i=0;i<e.length;i++)e[i].removeAttribute("aria-live");this.removeChipFocus()}},t.prototype.addChipSelection=function(e,i){X([e],xl),e&&e.setAttribute("aria-live","polite"),this.trigger("chipSelection",i)},t.prototype.getVirtualDataByValue=function(e){if(!g(this.selectedListData)){var i=this.typeOfData(this.selectedListData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.selectedListData;r<n.length;r++){var s=n[r];if(!g(s)&&s===e)return s}else for(var a=0,l=this.selectedListData;a<l.length;a++){var s=l[a];if(!g(s)&&V(this.fields.value?this.fields.value:"value",s)===e)return s}}return null},t.prototype.onChipRemove=function(e){if(!(e.which===3||e.button===2)&&this.enabled&&!this.readonly){var i=e.target.parentElement,r=i.getAttribute("data-value"),n=this.allowObjectBinding?this.enableVirtualization?this.getVirtualDataByValue(this.getFormattedValue(r)):this.getDataByValue(this.getFormattedValue(r)):this.getFormattedValue(r);if(this.allowCustomValue&&(r!=="false"&&n===!1||!g(n)&&n.toString()==="NaN")&&(n=r),this.isPopupOpen()&&this.mode!=="CheckBox"&&this.hidePopup(e),this.inputFocus||this.inputElement.focus(),this.removeValue(n,e),n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",n):n,g(this.findListElement(this.list,"li","data-value",n))&&this.mainList&&this.listData){var s=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(s,this.mainData)}this.updateDelimeter(this.delimiterChar,e),this.placeholder&&this.floatLabelType==="Never"?(this.makeTextBoxEmpty(),this.checkPlaceholderSize()):this.inputElement.value="",e.preventDefault()}},t.prototype.makeTextBoxEmpty=function(){this.inputElement.value="",this.refreshPlaceHolder()},t.prototype.refreshPlaceHolder=function(){this.placeholder&&this.floatLabelType==="Never"?this.value&&this.value.length||!g(this.text)&&this.text!==""?this.inputElement.placeholder="":this.inputElement.placeholder=LI(this.placeholder):(this.setFloatLabelType(),this.element.querySelector(".e-multiselect .e-float-text-content")===null&&Ie.createSpanElement(this.overAllWrapper,this.createElement)),this.expandTextbox()},t.prototype.removeAllItems=function(e,i,r,n,s){var a=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(e),l=this.value.slice(0);l.splice(a,1),this.setProperties({value:[].concat([],l)},!0),n.setAttribute("aria-selected","false");var h=this.hideSelectedItem?Ci:de.selected;Z([n],h),this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:n,e:this,index:a}),this.invokeCheckboxSelection(n,i,r);var c=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e):e;this.updateMainList(!0,c,s),this.updateChipStatus()},t.prototype.invokeCheckboxSelection=function(e,i,r){this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:i}),this.updateAriaActiveDescendant(),this.value&&this.value.length!==this.mainData.length&&this.mode==="CheckBox"&&this.showSelectAll&&!(this.isSelectAll||r)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"})},t.prototype.removeValue=function(e,i,r,n){var s=this,a=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(this.getFormattedValue(e));a===-1&&this.allowCustomValue&&!g(e)&&(a=this.allowObjectBinding?this.indexOfObjectInArray(e,this.value):this.value.indexOf(e.toString()));var l=i&&i.target;n=n||l&&l.classList.contains("e-close-hooker")?!0:null;var h=this.hideSelectedItem?Ci:de.selected;if(a!==-1){var c=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e):e,u=this.virtualSelectAll?null:this.findListElement(this.list,"li","data-value",c),d=this.allowObjectBinding?e:this.getDataByValue(e),p={e:i,item:u,itemData:d,isInteracted:!!i,cancel:!1};this.trigger("removing",p,function(f){if(f.cancel)s.removeIndex++;else{s.isRemoveSelection=s.enableVirtualization?!0:s.isRemoveSelection,s.currentRemoveValue=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",e):e,s.virtualSelectAll=!1;var v=s.value.slice(0);if(v.splice(a,1),s.enableVirtualization&&s.selectedListData&&s.selectedListData.splice(a,1),s.setProperties({value:[].concat([],v)},!0),s.enableVirtualization){var m=a===0&&s.text.split(s.delimiterChar)&&s.text.split(s.delimiterChar).length===1?s.text.replace(s.text.split(s.delimiterChar)[a],""):a===0?s.text.replace(s.text.split(s.delimiterChar)[a]+s.delimiterChar,""):s.text.replace(s.delimiterChar+s.text.split(s.delimiterChar)[a],"");s.setProperties({text:m.toString()},!0)}if(u!==null){var y=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",e):e,b=s.findListElement(s.mainList,"li","data-value",y);u.setAttribute("aria-selected","false"),Z([u],h),b&&(b.setAttribute("aria-selected","false"),Z([u,b],h)),s.notify("activeList",{module:"CheckBoxSelection",enable:s.mode==="CheckBox",li:u,e:s,index:a}),s.invokeCheckboxSelection(u,i,n)}var S=s.allowObjectBinding?V(s.fields.value?s.fields.value:"",e):e;s.hideSelectedItem&&s.fields.groupBy&&u&&s.hideGroupItem(S),s.hideSelectedItem&&s.fixedHeaderElement&&s.fields.groupBy&&s.mode!=="CheckBox"&&s.isPopupOpen()&&o.prototype.scrollStop.call(s),s.updateMainList(!0,S),s.removeChip(S,n),s.updateChipStatus();var C=s.value&&s.value.length?s.value.length:0;if(C<s.maximumSelectionLength){var x=s.list.querySelectorAll("li."+de.li+":not(.e-active)");Z(x,"e-disable");var I=s.mainList.querySelectorAll("li."+de.li+":not(.e-active)");Z(I,"e-disable")}s.trigger("removed",f);var D=i&&i.currentTarget,M=D&&D.classList.contains("e-selectall-parent")?!0:null;if(!s.changeOnBlur&&!n&&i&&r&&!M&&s.isSelectAllTarget&&s.updateValueState(i,s.value,s.tempValues),r&&(s.selectAllEventData.push(d),s.selectAllEventEle.push(u)),r===1){s.changeOnBlur||s.updateValueState(i,s.value,s.tempValues);var E={event:i,items:s.selectAllEventEle,itemData:s.selectAllEventData,isInteracted:!!i,isChecked:!1};s.trigger("selectedAll",E),s.selectAllEventData=[],s.selectAllEventEle=[]}n&&(r===1||r===null)&&s.clearAllCallback(i,n),s.isPopupOpen()&&u&&u.parentElement.classList.contains("e-reorder")&&(s.hideSelectedItem&&s.value&&Array.isArray(s.value)&&s.value.length>0&&s.totalItemsCount(),s.notify("setCurrentViewDataAsync",{module:"VirtualScroll"}))}})}},t.prototype.updateMainList=function(e,i,r){if(this.allowFiltering||this.mode==="CheckBox"){var n=r||this.findListElement(this.mainList,"li","data-value",i);n&&(e?(n.setAttribute("aria-selected","false"),Z([n],this.hideSelectedItem?Ci:de.selected),this.mode==="CheckBox"&&Z([n.firstElementChild.lastElementChild],"e-check")):(n.setAttribute("aria-selected","true"),X([n],this.hideSelectedItem?Ci:de.selected),this.mode==="CheckBox"&&X([n.firstElementChild.lastElementChild],"e-check")))}},t.prototype.removeChip=function(e,i){if(this.chipCollectionWrapper&&!(this.enableVirtualization&&i)){var r=this.findListElement(this.chipCollectionWrapper,"span","data-value",e);r&&Qe(r)}},t.prototype.setWidth=function(e){g(e)||(typeof e=="number"?this.overAllWrapper.style.width=Ae(e):typeof e=="string"&&(this.overAllWrapper.style.width=e.match(/px|%|em/)?e:Ae(e)))},t.prototype.updateChipStatus=function(){this.value&&this.value.length?(g(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display=""),(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper(),this.showOverAllClear()):(g(this.chipCollectionWrapper)||(this.chipCollectionWrapper.style.display="none"),g(this.delimiterWrapper)||(this.delimiterWrapper.style.display="none"),this.hideOverAllClear())},t.prototype.indexOfObjectInArray=function(e,i){for(var r=function(a){var l=i[a];if(Object.keys(e).every(function(h){return l.hasOwnProperty(h)&&l[h]===e[h]}))return{value:a}},n=0;n<i.length;n++){var s=r(n);if(typeof s=="object")return s.value}return-1},t.prototype.addValue=function(e,i,r){this.value||(this.value=[]);var n=this.allowObjectBinding?this.getDataByValue(e):e;if(this.allowObjectBinding&&!this.isObjectInArray(this.getDataByValue(e),this.value)||!this.allowObjectBinding&&this.value.indexOf(n)<0){if(this.setProperties({value:[].concat([],this.value,[n])},!0),this.enableVirtualization&&!this.isSelectAllLoop){var s=this.viewWrapper.innerHTML,a=void 0;s+=this.value.length===1?"":this.delimiterChar+" ",a=this.getOverflowVal(this.value.length-1),s+=a,a=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,s)}if(this.enableVirtualization&&this.mode==="CheckBox"){var l=[],h=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[this.value.length-1]):this.value[this.value.length-1],a=i,c=this.text!=null&&this.text!==""?this.text+this.delimiterChar+a:a;l.push(c),this.setProperties({text:l.toString()},!0)}}var u=this.findListElement(this.list,"li","data-value",e);this.removeFocus(),u&&(this.addListFocus(u),this.addListSelection(u)),this.mode!=="Delimiter"&&this.mode!=="CheckBox"&&this.addChip(i,e,r),this.hideSelectedItem&&this.fields.groupBy&&this.hideGroupItem(e),this.updateChipStatus(),this.checkMaxSelection()},t.prototype.updateListItemsState=function(e){var i=e.querySelectorAll("li."+de.li+".e-active");Z(i,"e-disable");var r=e.querySelectorAll("li."+de.li+":not(.e-active)");X(r,"e-disable")},t.prototype.checkMaxSelection=function(){var e=this.value&&this.value.length?this.value.length:0;if(this.maximumSelectionLength===0){this.updateListItemsState(this.list),this.mainList&&this.updateListItemsState(this.mainList);return}if(e===this.maximumSelectionLength){var i=this.list.querySelectorAll("li."+de.li+".e-active");Z(i,"e-disable");var r=this.list.querySelectorAll("li."+de.li+":not(.e-active)");X(r,"e-disable")}if(e<this.maximumSelectionLength){var n=this.list.querySelectorAll("li."+de.li);Z(n,"e-disable")}},t.prototype.dispatchSelect=function(e,i,r,n,s,a,l){var h=this,c=this.listData;if(this.initStatus&&!n&&(!this.allowObjectBinding||this.allowObjectBinding&&e)){e=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e):e;var u=a||this.getDataByValue(e),d={e:i,item:r,itemData:u,isInteracted:!!i,cancel:!1};this.trigger("select",d,function(p){if(!p.cancel){if(s&&(h.selectAllEventData.push(u),h.selectAllEventEle.push(r)),s===1){var f={event:i,items:h.selectAllEventEle,itemData:h.selectAllEventData,isInteracted:!!i,isChecked:!0};h.trigger("selectedAll",f),h.selectAllEventData=[]}h.allowCustomValue&&h.isServerRendered&&h.listData!==c&&(h.listData=c),e=h.allowObjectBinding?h.getDataByValue(e):e,h.enableVirtualization&&(g(h.selectedListData)?h.selectedListData=h.allowObjectBinding?[e]:[h.getDataByValue(e)]:a?Array.isArray(h.selectedListData)?h.selectedListData.push(a):h.selectedListData=[h.selectedListData,a]:Array.isArray(h.selectedListData)?h.selectedListData.push(h.allowObjectBinding?e:h.getDataByValue(e)):h.selectedListData=[h.selectedListData,h.allowObjectBinding?e:h.getDataByValue(e)]),(h.enableVirtualization&&e||!h.enableVirtualization)&&h.updateListSelectEventCallback(e,r,i,l),h.hideSelectedItem&&h.fixedHeaderElement&&h.fields.groupBy&&h.mode!=="CheckBox"&&o.prototype.scrollStop.call(h)}})}},t.prototype.addChip=function(e,i,r){this.chipCollectionWrapper&&this.getChip(e,i,r)},t.prototype.removeChipFocus=function(){var e=this.chipCollectionWrapper.querySelectorAll("span."+Cc+"."+xl);if(Z(e,xl),j.isDevice)for(var i=this.chipCollectionWrapper.querySelectorAll("span."+Ey.split(" ")[0]),r=0;r<i.length;r++)i[r].style.display="none"},t.prototype.onMobileChipInteraction=function(e){var i=H(e.target,"."+Cc),r=i.querySelector("span."+Ey.split(" ")[0]);this.enabled&&!this.readonly&&(i.classList.contains(xl)||(this.removeChipFocus(),r.style.display="",i.classList.add(xl)),this.refreshPopup(),e.preventDefault())},t.prototype.multiCompiler=function(e){var i=!1;if(typeof e!="function"&&e)try{i=!!ze(e,document).length}catch{i=!1}return i},t.prototype.encodeHtmlEntities=function(e){return e.replace(/[\u00A0-\u9999<>&]/g,function(i){return"&#"+i.charCodeAt(0)+";"})},t.prototype.getChip=function(e,i,r){var n=this,s={text:i,value:i},a=this.createElement("span",{className:Cc,attrs:{"data-value":i,title:e,role:"option","aria-selected":"true"}}),l,h=this.createElement("span",{className:L5}),c=this.createElement("span",{className:Ey});if(this.mainData&&(s=this.getDataByValue(i)),this.valueTemplate&&!g(s)){var u=this.multiCompiler(this.valueTemplate);typeof this.valueTemplate!="function"&&u?l=Et(J(this.valueTemplate,document).innerHTML.trim()):l=Et(this.valueTemplate);var d=l(s,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,h);d&&d.length>0&&bt(d,h),this.renderReactTemplates()}else this.enableHtmlSanitizer?h.innerText=e:h.innerHTML=this.encodeHtmlEntities(e.toString());a.appendChild(h);var p={isInteracted:!!r,itemData:s,e:r,setClass:function(f){X([a],f)},cancel:!1};this.isPreventChange=this.isAngular&&this.preventChange,this.trigger("tagging",p,function(f){f.cancel||(j.isDevice?(a.classList.add(O5),bt([c],a),c.style.display="none",T.add(a,"click",n.onMobileChipInteraction,n)):(T.add(a,"mousedown",n.chipClick,n),n.showClearButton&&a.appendChild(c)),T.add(c,"mousedown",n.onChipRemove,n),n.chipCollectionWrapper.appendChild(a),!n.changeOnBlur&&r&&n.updateValueState(r,n.value,n.tempValues))})},t.prototype.calcPopupWidth=function(){var e=Ae(this.popupWidth);if(e.indexOf("%")>-1){var i=this.componentWrapper.offsetWidth*parseFloat(e)/100;e=i.toString()+"px"}return this.allowResize&&this.resizeWidth?this.resizeWidth+"px":e},t.prototype.mouseIn=function(){this.enabled&&!this.readonly&&this.showOverAllClear()},t.prototype.mouseOut=function(){this.inputFocus||(this.overAllClear.style.display="none")},t.prototype.listOption=function(e,i){var r=!g(i.iconCss),n=g(i.properties)?i:i.properties;return this.listCurrentOptions=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}},pe(this.listCurrentOptions,this.listCurrentOptions,i,!0),this.mode==="CheckBox"&&this.notify("listoption",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",dataSource:e,fieldProperty:n}),this.listCurrentOptions},t.prototype.renderPopup=function(){var e=this;if(this.list||o.prototype.render.call(this),this.popupObj&&document.body.contains(this.popupObj.element)&&this.allowFiltering){this.refreshPopup();return}if(!this.popupObj&&!g(this.popupWrapper)){document.body.appendChild(this.popupWrapper);var i=this.popupWrapper.querySelector("."+V5);this.mode==="CheckBox"&&!this.allowFiltering&&i&&this.filterParent&&(i.remove(),this.filterParent=null);var r=parseInt(this.popupHeight,10);if(this.popupWrapper.style.visibility="hidden",this.headerTemplate&&(this.setHeaderTemplate(),r-=this.header.offsetHeight,this.isUpdateHeaderHeight=this.header.offsetHeight!==0),bt([this.list],this.popupWrapper),!this.list.classList.contains(de.noData)&&this.getItems()[1]&&(this.listItemHeight=this.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(this.getItems()[1]).marginBottom,10)),this.enableVirtualization&&!this.list.classList.contains(de.noData)){if(!this.list.querySelector(".e-virtual-ddl-content")&&this.list.querySelector(".e-list-parent")){var n=this.createElement("div",{className:"e-virtual-ddl-content"});n.style.cssText=this.getTransformValues(),this.list.appendChild(n).appendChild(this.list.querySelector(".e-list-parent"))}else this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues());if(this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&this.totalItemsCount(),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var s=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});s.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(s)}}if(this.footerTemplate&&(this.setFooterTemplate(),r-=this.footer.offsetHeight,this.isUpdateFooterHeight=this.footer.offsetHeight!==0),this.mode==="CheckBox"&&this.showSelectAll?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r-=this.selectAllHeight):this.mode==="CheckBox"&&!this.showSelectAll&&!this.headerTemplate&&!this.footerTemplate?(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10)):this.mode==="CheckBox"&&!this.showSelectAll&&(this.notify("selectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),r=parseInt(this.popupHeight,10),this.headerTemplate&&this.header&&(r-=this.header.offsetHeight),this.footerTemplate&&this.footer&&(r-=this.footer.offsetHeight)),this.mode==="CheckBox"){var a={module:"CheckBoxSelection",enable:this.mode==="CheckBox",popupElement:this.popupWrapper};this.allowFiltering&&(this.notify("searchBox",a),r-=this.searchBoxHeight),X([this.popupWrapper],"e-checkbox")}this.popupHeight!=="auto"?(this.list.style.maxHeight=Ae(r),this.popupWrapper.style.maxHeight=Ae(this.popupHeight)):this.list.style.maxHeight=Ae(this.popupHeight),this.popupObj=new es(this.popupWrapper,{width:this.calcPopupWidth(),targetType:"relative",position:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},relateTo:this.overAllWrapper,collision:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},offsetY:1,enableRtl:this.enableRtl,zIndex:this.zIndex,close:function(){if(e.popupObj.element.parentElement){e.popupObj.unwireScrollEvents();var l=e.popupWrapper.querySelector("."+EI);e.mode==="CheckBox"&&l&&document.activeElement===l&&l.blur(),se(e.popupObj.element)}},open:function(){if(e.popupObj.resolveCollision(),!e.isFirstClick){var l=e.list.querySelector("ul");l&&(e.mode!=="CheckBox"&&(e.allowFiltering||e.allowCustomValue)&&(e.targetElement().trim()!==""||e.targetElement()!==""&&e.allowCustomValue)||(e.mainList=l.cloneNode?l.cloneNode(!0):l)),e.isFirstClick=!0}e.popupObj.wireScrollEvents(),!(e.mode!=="CheckBox"&&(e.allowFiltering||e.allowCustomValue)&&(e.targetElement().trim()!==""||e.targetElement()!==""&&e.allowCustomValue))&&!e.enableVirtualization&&(e.loadTemplate(),e.enableVirtualization&&e.mode==="CheckBox"&&e.UpdateSkeleton()),e.isPreventScrollAction=!0,e.setScrollPosition(),!e.list.classList.contains(de.noData)&&e.getItems()[1]&&e.getItems()[1].offsetHeight!==0&&(e.listItemHeight=e.getItems()[1].offsetHeight+parseInt(window.getComputedStyle(e.getItems()[1]).marginBottom,10),e.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(e.list.getElementsByClassName("e-virtual-ddl-content")[0].style=e.getTransformValues())),e.allowFiltering&&e.notify("inputFocus",{module:"CheckBoxSelection",enable:e.mode==="CheckBox",value:"focus"}),e.enableVirtualization&&(e.notify("bindScrollEvent",{module:"VirtualScroll",component:e.getModuleName(),enable:e.enableVirtualization}),setTimeout(function(){e.value?e.updateSelectionList():e.viewPortInfo&&e.viewPortInfo.offsets.top&&(e.list.scrollTop=e.viewPortInfo.offsets.top)},5))},targetExitViewport:function(){j.isDevice||e.hidePopup()}}),this.checkCollision(this.popupWrapper),this.popupContentElement=this.popupObj.element.querySelector(".e-content"),this.mode==="CheckBox"&&j.isDevice&&this.allowFiltering&&this.isDeviceFullScreen&&this.notify("deviceSearchBox",{module:"CheckBoxSelection",enable:this.mode==="CheckBox"}),this.allowResize&&this.setResize(),this.popupObj.close(),this.popupWrapper.style.visibility=""}},t.prototype.checkCollision=function(e){if(!(this.mode==="CheckBox"&&j.isDevice&&this.allowFiltering&&this.isDeviceFullScreen)){var i=gs(e);i.length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"),this.popupObj.resolveCollision()}},t.prototype.setHeaderTemplate=function(){var e;this.header&&this.header.remove(),this.header=this.createElement("div"),X([this.header],P5);var i=this.multiCompiler(this.headerTemplate);typeof this.headerTemplate!="function"&&i?e=Et(J(this.headerTemplate,document).innerHTML.trim()):e=Et(this.headerTemplate);var r=e({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);r&&r.length>0&&bt(r,this.header),this.mode==="CheckBox"&&this.showSelectAll?$r([this.header],this.popupWrapper):bt([this.header],this.popupWrapper),T.add(this.header,"mousedown",this.onListMouseDown,this)},t.prototype.setFooterTemplate=function(){var e;this.footer&&this.footer.remove(),this.footer=this.createElement("div"),X([this.footer],z5);var i=this.multiCompiler(this.footerTemplate);typeof this.footerTemplate!="function"&&i?e=Et(J(this.footerTemplate,document).innerHTML.trim()):e=Et(this.footerTemplate);var r=e({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);r&&r.length>0&&bt(r,this.footer),bt([this.footer],this.popupWrapper),T.add(this.footer,"mousedown",this.onListMouseDown,this)},t.prototype.updateInitialData=function(){var e=this.selectData,i=this.renderItems(e,this.fields,!1,this.isClearAllAction);if(this.list.scrollTop=0,this.virtualListInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount},this.previousStartIndex=0,this.previousEndIndex=this.itemCount,this.dataSource instanceof oe?this.remoteDataCount>=0?this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):this.totalItemCount=this.dataCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.getSkeletonCount(),this.skeletonCount=this.totalItemCount!==0&&this.totalItemCount<this.itemCount*2&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.totalItemCount<=this.itemCount)?0:this.skeletonCount,this.UpdateSkeleton(),this.list.getElementsByClassName("e-virtual-ddl")[0])this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else if(!this.list.querySelector(".e-virtual-ddl")&&this.skeletonCount>0){var r=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});r.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(r)}this.listData=e,this.liCollections=this.list.querySelectorAll(".e-list-item"),this.list.getElementsByClassName("e-virtual-ddl-content")[0]&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues()),this.enableVirtualization&&this.notify("setGeneratedData",{module:"VirtualScroll"})},t.prototype.clearAll=function(e){if(this.enabled&&!this.readonly){var i=void 0;if(this.setDynValue=!1,this.isClearAllAction=!0,this.value&&this.value.length>0){this.allowFiltering&&(this.refreshListItems(null),this.mode==="CheckBox"&&this.targetInputElement&&(this.targetInputElement.value=""));var r=this.list&&this.list.querySelectorAll("li.e-list-item");if(r&&r.length>0)this.selectAllItems(!1,e);else for(this.removeIndex=0,i=this.value[this.removeIndex];this.removeIndex<this.value.length;i=this.value[this.removeIndex])this.removeValue(i,e,null,!0);this.selectedElementID=null,this.inputElement.removeAttribute("aria-activedescendant")}else this.clearAllCallback(e);this.checkAndResetCache(),this.element.querySelector(".e-multiselect .e-float-text-content")===null&&Ie.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.enableVirtualization&&(this.updateInitialData(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.isCustomDataUpdated||this.notify("setGeneratedData",{module:"VirtualScroll"})),this.enableVirtualization&&(this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=this.itemCount),this.isClearAllAction=!1}this.isClearAllItem=!0,T.add(document,"mouseup",this.preventSelection,this)},t.prototype.preventSelection=function(e){this.isClearAllItem&&e.stopPropagation(),this.isClearAllItem=!1,T.remove(document,"mouseup",this.preventSelection)},t.prototype.clearAllCallback=function(e,i){var r=this.value?this.value.slice():[];if(this.mainList&&this.listData&&(this.allowFiltering&&this.mode!=="CheckBox"||this.allowCustomValue)){var n=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(n,this.mainData)}this.focusAtFirstListItem(),this.updateDelimeter(this.delimiterChar,e),this.mode!=="Box"&&(!this.inputFocus||this.mode==="CheckBox")&&this.updateDelimView(),this.inputElement.value!==""&&(this.makeTextBoxEmpty(),this.search(null)),this.checkPlaceholderSize(),this.isPopupOpen()&&this.refreshPopup(),this.allowResize&&this.setResize(),this.inputFocus||(this.changeOnBlur&&this.updateValueState(e,this.value,r),this.mode!=="CheckBox"&&this.inputElement.focus()),this.mode==="CheckBox"&&(this.refreshPlaceHolder(),this.refreshInputHight(),this.changeOnBlur&&i&&(g(this.value)||this.value.length===0)&&this.updateValueState(e,this.value,this.tempValues)),!this.changeOnBlur&&i&&(g(this.value)||this.value.length===0)&&this.updateValueState(e,this.value,this.tempValues),this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&this.updateListItems(this.list.querySelectorAll("li.e-list-item"),this.mainList.querySelectorAll("li.e-list-item")),e.preventDefault()},t.prototype.windowResize=function(){this.refreshPopup(),(!this.inputFocus||this.mode==="CheckBox")&&this.viewWrapper&&this.viewWrapper.parentElement&&this.updateDelimView()},t.prototype.resetValueHandler=function(e){if(!g(this.inputElement)){var i=H(this.inputElement,"form");if(i&&e.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.element.getAttribute("data-initial-value");this.text=r}}},t.prototype.wireEvent=function(){T.add(this.componentWrapper,"mousedown",this.wrapperClick,this),T.add(window,"resize",this.windowResize,this),T.add(this.inputElement,"focus",this.focusInHandler,this),T.add(this.inputElement,"keydown",this.onKeyDown,this),T.add(this.inputElement,"keyup",this.keyUp,this),this.mode!=="CheckBox"&&T.add(this.inputElement,"input",this.onInput,this),T.add(this.inputElement,"blur",this.onBlurHandler,this),T.add(this.componentWrapper,"mouseover",this.mouseIn,this);var e=H(this.inputElement,"form");e&&T.add(e,"reset",this.resetValueHandler,this),T.add(this.componentWrapper,"mouseout",this.mouseOut,this),T.add(this.overAllClear,"mousedown",this.clearAll,this),T.add(this.inputElement,"paste",this.pasteHandler,this)},t.prototype.onInput=function(e){this.keyDownStatus?this.isValidKey=!0:this.isValidKey=!1,this.keyDownStatus=!1,j.isDevice&&j.info.name==="mozilla"&&this.search(e)},t.prototype.pasteHandler=function(e){var i=this;setTimeout(function(){i.expandTextbox(),i.search(e)})},t.prototype.performFiltering=function(e){var i=this,r={preventDefaultAction:!1,text:this.targetElement(),updateData:function(n,s,a){r.cancel||(i.isFiltered=!0,i.customFilterQuery=s,i.remoteFilterAction=!0,i.isCustomFiltering=!0,i.dataUpdater(n,s,a))},event:e,cancel:!1};this.trigger("filtering",r,function(n){i.isFilterPrevented=n.cancel,n.cancel||!i.isFiltered&&!n.preventDefaultAction&&(i.isFilterAction=!0,i.isFilteringAction=!0,i.dataSource instanceof oe&&i.allowCustomValue&&(i.isCustomRendered=!1),i.dataUpdater(i.dataSource,null,i.fields),i.isFilteringAction=!1)}),this.updatePopupHeightOnFilter()},t.prototype.search=function(e){if(this.preventSetCurrentData=!1,this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null,g(e)||(this.keyCode=e.keyCode),!this.isPopupOpen()&&this.openOnClick&&this.showPopup(e),this.openClick(e),this.checkTextLength()&&!this.allowFiltering&&!g(e)&&e.keyCode!==8)this.focusAtFirstListItem();else{var i=this.targetElement();if(this.allowFiltering)this.allowCustomValue&&(this.isRemoteSelection=!0),this.checkAndResetCache(),this.isRequesting=!1,this.targetElement()!==""&&this.debounceDelay>0?this.debouncedFiltering(e,this.debounceDelay):this.performFiltering(e);else if(this.allowCustomValue){var r=new Pe;r=this.allowFiltering&&i!==""?r.where(this.fields.text,"startswith",i,this.ignoreCase,this.ignoreAccent):r,this.enableVirtualization?this.dataUpdater(this.dataSource,r,this.fields):this.dataUpdater(this.mainData,r,this.fields),this.UpdateSkeleton()}else{var n=this.list.querySelectorAll("li."+de.li+":not(.e-hide-listitem)"),s=this.typeOfData(this.listData).typeof,a=wa(this.targetElement(),n,"StartsWith",this.ignoreCase);if(this.enableVirtualization&&this.targetElement().trim()!==""&&!this.allowFiltering){var l=!1;for((this.viewPortInfo.endIndex>=this.incrementalEndIndex&&this.incrementalEndIndex<=this.totalItemCount||this.incrementalEndIndex===0)&&(l=!0,this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),l=!1),(this.viewPortInfo.startIndex!==0||l)&&this.updateIncrementalView(0,this.itemCount),a=wa(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,s);g(a)&&this.incrementalEndIndex<this.totalItemCount&&(this.incrementalStartIndex=this.incrementalEndIndex,this.incrementalEndIndex=this.incrementalEndIndex+100>this.totalItemCount?this.totalItemCount:this.incrementalEndIndex+100,this.updateIncrementalInfo(this.incrementalStartIndex,this.incrementalEndIndex),l=!0,(this.viewPortInfo.startIndex!==0||l)&&this.updateIncrementalView(0,this.itemCount),a=wa(this.targetElement(),this.incrementalLiCollections,this.filterType,!0,this.listData,this.fields,s),!!g(a));)if(g(a)&&this.incrementalEndIndex>=this.totalItemCount){this.incrementalStartIndex=0,this.incrementalEndIndex=100>this.totalItemCount?this.totalItemCount:100;break}if(a.index&&(!(this.viewPortInfo.startIndex>=a.index)||!(a.index>=this.viewPortInfo.endIndex))){var h=a.index-(this.itemCount/2-2)>0?a.index-(this.itemCount/2-2):0,c=h+this.itemCount>this.totalItemCount?this.totalItemCount:h+this.itemCount;h!==this.viewPortInfo.startIndex&&this.updateIncrementalView(h,c)}if(g(a.item))this.updateIncrementalView(0,this.itemCount),this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues(),this.list.scrollTop=0;else{var u=this.getIndexByValue(a.item.getAttribute("data-value"))-this.skeletonCount;if(u>this.itemCount/2){var h=this.viewPortInfo.startIndex+(this.itemCount/2-2)<this.totalItemCount?this.viewPortInfo.startIndex+(this.itemCount/2-2):this.totalItemCount,c=this.viewPortInfo.startIndex+this.itemCount>this.totalItemCount?this.totalItemCount:this.viewPortInfo.startIndex+this.itemCount;this.updateIncrementalView(h,c)}a.item=this.getElementByValue(a.item.getAttribute("data-value"))}a&&a.item&&(a.item=this.getElementByValue(a.item.getAttribute("data-value")))}a&&a.item?(this.addListFocus(a.item),this.list.scrollTop=a.item.offsetHeight*a.index):this.targetElement()!==""?this.removeFocus():this.focusAtFirstListItem()}}this.enableVirtualization&&this.allowFiltering&&this.getFilteringSkeletonCount()},t.prototype.preRender=function(){this.allowFiltering===null&&(this.allowFiltering=this.mode==="CheckBox"),this.preventSetCurrentData=!1,this.initializeData(),this.updateDataAttribute(this.htmlAttributes),o.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"multi-select"},t.prototype.initializeData=function(){this.mainListCollection=[],this.beforePopupOpen=!1,this.isFilterAction=!1,this.remoteFilterAction=!1,this.isFirstClick=!1,this.mobFilter=!0,this.isFiltered=!1,this.focused=!0,this.initial=!0,this.backCommand=!0,this.isCustomRendered=!1,this.isRemoteSelection=!1,this.isSelectAllTarget=!0,this.isaddNonPresentItems=!1,this.viewPortInfo={currentPageNumber:null,direction:null,sentinelInfo:{},offsets:{},startIndex:0,endIndex:this.itemCount}},t.prototype.updateData=function(e,i,r){var n="",s=this.mode==="Delimiter"||this.mode==="CheckBox",a=[],l,h=this.listData;if(this.enableVirtualization||(this.listData=this.mainData),!g(this.hiddenElement)&&!this.enableVirtualization&&(this.hiddenElement.innerHTML=""),!g(this.value)){for(var c=this.value.length,u="",d=function(C){var x=p.allowObjectBinding?V(p.fields.value?p.fields.value:"",p.value[C]):p.value[C],I=p.findListElement(g(p.mainList)?p.ulElement:p.mainList,"li","data-value",x);if(p.enableVirtualization&&(I=p.findListElement(g(p.list)?p.ulElement:p.list,"li","data-value",x)),g(I)&&!p.allowCustomValue&&!p.enableVirtualization&&p.listData&&p.listData.length>0)p.value.splice(C,1),C-=1,c-=1;else{if(p.listData)if(p.enableVirtualization){s&&!p.isDynamicRemoteVirtualData&&!r&&(n=p.delimiterWrapper&&p.delimiterWrapper.innerHTML===""?n:p.delimiterWrapper.innerHTML);var D=p.allowObjectBinding?V(p.fields.value?p.fields.value:"",p.value[p.value.length-1]):p.value[p.value.length-1];if(p.isRemoveSelection)n=p.text.replace(/,/g,e+" ")+e+" ",a=p.text.split(e);else{l=r&&s?p.text.replace(/,/g,e+" "):p.getTextByValue(D);var M=p.isDynamicRemoteVirtualData&&D!=null&&D!==""&&!r?p.getTextByValue(D):r?p.text:p.text&&p.text!==""?p.text+p.delimiterChar+l:l;n+=l+e+" ",a.push(M),u=p.hiddenElement.innerHTML}if(i&&i.currentTarget&&i.currentTarget.classList.contains("e-chips-close")||i&&i.key==="Backspace"){var E=i.target.parentElement.getAttribute("data-value");if(i.key==="Backspace"){var A=p.hiddenElement.lastChild;A&&p.hiddenElement.removeChild(A)}else p.hiddenElement.childNodes.forEach(function(L){L.value===E&&L.parentNode.removeChild(L)});u=p.hiddenElement.innerHTML}else u+="<option selected value='"+D+"'>"+C+"</option>";return f=C,"break"}else l=p.getTextByValue(x);else l=x;n+=l+e+" ",a.push(l)}u+='<option selected value="'+x+'">'+C+"</option>",f=C},p=this,f,v=0;v<c;v++){var m=d(v);if(v=f,m==="break")break}g(this.hiddenElement)||(this.isRemoveSelection?(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)&&this.hiddenElement.removeChild(this.findListElement(this.hiddenElement,"option","value",this.currentRemoveValue)),this.isRemoveSelection=!1):this.hiddenElement.innerHTML=u)}var y=i&&i.target&&i.target.classList.contains("e-chips-close");(!this.enableVirtualization||this.enableVirtualization&&this.mode!=="CheckBox"&&!y)&&this.setProperties({text:a.toString()},!0),s&&(this.updateWrapperText(this.delimiterWrapper,n),this.delimiterWrapper.setAttribute("id",Lt("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id));var b=i&&i.target,S=b&&b.classList.contains("e-close-hooker")?!0:null;(!this.changeOnBlur&&i&&!S||this.isSelectAll)&&(this.isSelectAll=!1,this.updateValueState(i,this.value,this.tempValues)),this.listData=h,this.addValidInputClass()},t.prototype.initialTextUpdate=function(){if(g(this.text))this.setProperties({value:null},!0);else{for(var e=this.text.split(this.delimiterChar),i=[],r=0;e.length>r;r++){var n=this.getValueByText(e[r]);g(n)?this.allowCustomValue&&i.push(e[r]):i.push(n)}if(i&&i.length){var s=this.allowObjectBinding?this.getDataByValue(i):i;this.setProperties({value:s},!0)}}},t.prototype.renderList=function(e){!e&&this.allowCustomValue&&this.list&&(this.list.textContent===this.noRecordsTemplate||this.list.querySelector(".e-ul")&&this.list.querySelector(".e-ul").childElementCount===0)&&(e=!0),o.prototype.render.call(this,null,e),this.totalItemCount=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.unwireListEvents(),this.wireListEvents()},t.prototype.initialValueUpdate=function(e,i){var r=this;if(this.list){var n=void 0,s=void 0,a;if(this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.removeListSelection(),!g(this.value))for(var l=0;!g(this.value[l]);l++){a=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[l]):this.value[l],s=this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",a);var h=!1;if(this.enableVirtualization){if(n=null,e!=null&&e.length>0){for(var c=0;c<e.length;c++)if(this.isPrimitiveData&&e[c]===a||!this.isPrimitiveData&&V(this.fields.value?this.fields.value:"value",e[c])===a){n=this.isPrimitiveData?e[c]:V(this.fields.text,e[c]),this.enableVirtualization&&(g(this.selectedListData)?this.selectedListData=[e[c]]:(this.allowObjectBinding&&!this.isObjectInArray(e[c],this.selectedListData)||!this.allowObjectBinding)&&(Array.isArray(this.selectedListData)?this.selectedListData.push(e[c]):this.selectedListData=[this.selectedListData,e[c]]));break}}g(n)&&this.allowCustomValue&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&i)?(n=this.getTextByValue(a),h=!0):g(n)&&!this.allowCustomValue&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&i)&&(this.value.splice(l,1),l-=1)}else n=this.getTextByValue(a);if(s&&s.getAttribute("aria-selected")!=="true"||s&&s.getAttribute("aria-selected")==="true"&&this.hideSelectedItem&&(this.mode==="Box"||this.mode==="Default")||this.enableVirtualization&&a!=null&&n!=null&&!h){var u=[],d=this.isDynamicRemoteVirtualData&&n!=null&&n!==""&&l===0?n:this.text!=null&&this.text!==""&&!this.text.includes(n)?this.text+this.delimiterChar+n:n;u.push(d),this.setProperties({text:u.toString()},!0),this.addChip(n,a),this.addListSelection(s)}else if(!this.enableVirtualization&&a&&this.allowCustomValue||this.enableVirtualization&&a&&this.allowCustomValue&&(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&i)){var p=this.listData.length,f={};it(this.fields.text,a,f),it(this.fields.value,a,f);var v=this.popupWrapper.querySelector("."+de.noData);if(f&&this.allowObjectBinding&&this.allowCustomValue&&this.value.length>0&&typeof this.value[0]=="object"){var m=this.value,y=m.filter(function(C){return C[r.fields.value]===a});y.length>0&&(f=y[0])}this.enableVirtualization||this.addItem(f,p),this.enableVirtualization&&(this.virtualCustomSelectData&&this.virtualCustomSelectData.length>=0?this.virtualCustomSelectData.push(f):this.virtualCustomSelectData=[f]),s=s||this.findListElement(this.hideSelectedItem?this.ulElement:this.list,"li","data-value",a),this.popupWrapper.contains(v)&&(this.list.setAttribute("style",v.getAttribute("style")),this.popupWrapper.replaceChild(this.list,v),this.wireListEvents());var u=[],d=this.text!=null&&this.text!==""?this.text+this.delimiterChar+n:n;u.push(d),this.setProperties({text:u.toString()},!0),this.addChip(n,a),this.addListSelection(s)}}this.mode==="CheckBox"?(this.updateDelimView(),this.changeOnBlur&&this.updateValueState(null,this.value,this.tempValues),this.updateDelimeter(this.delimiterChar),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,null,i),this.mode==="CheckBox"&&this.showSelectAll&&(g(this.value)||!this.value.length)&&this.notify("checkSelectAll",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",value:"uncheck"}),this.mode==="Box"||this.mode==="Default"&&this.inputFocus?this.chipCollectionWrapper.style.display="":(this.mode==="Delimiter"||this.mode==="CheckBox")&&this.showDelimWrapper()}},t.prototype.updateActionCompleteData=function(e,i){this.value&&(!this.allowObjectBinding&&this.value.indexOf(e.getAttribute("data-value"))>-1||this.allowObjectBinding&&this.isObjectInArray(this.getDataByValue(e.getAttribute("data-value")),this.value))&&(this.mainList=this.ulElement,this.hideSelectedItem&&X([e],Ci))},t.prototype.updateAddItemList=function(e,i){this.popupObj&&this.popupObj.element&&this.popupObj.element.querySelector("."+de.noData)&&e?(this.list=e,this.mainList=this.ulElement=e.querySelector("ul"),Qe(this.popupWrapper.querySelector(".e-content")),this.popupObj=null,this.renderPopup()):this.allowCustomValue&&(this.list=e,this.mainList=this.ulElement=e.querySelector("ul"))},t.prototype.updateDataList=function(){if(this.mainList&&this.ulElement&&!(this.isFiltered||this.isFilterAction||this.targetElement().trim())){var e=this.mainList.childElementCount<this.ulElement.childElementCount,i=this.ulElement.childElementCount>0&&this.ulElement.children[0].childElementCount>0&&this.mainList.children[0]&&this.mainList.children[0].childElementCount<this.ulElement.children[0].childElementCount,r=this.itemTemplate&&this.ulElement.childElementCount>0&&!(this.ulElement.childElementCount<this.mainList.childElementCount)&&(this.ulElement.children[0].childElementCount>0||this.fields.groupBy&&this.ulElement.children[1]&&this.ulElement.children[1].childElementCount>0);(e||i||r)&&(this.mainList=this.ulElement)}},t.prototype.isValidLI=function(e){return e&&!e.classList.contains(de.disabled)&&!e.classList.contains(de.group)&&e.classList.contains(de.li)},t.prototype.updateListSelection=function(e,i,r){var n=e.getAttribute("data-value"),s=this.allowObjectBinding?this.getDataByValue(this.getFormattedValue(n)):this.getFormattedValue(n);this.allowCustomValue&&(n!=="false"&&s===!1||!g(s)&&s.toString()==="NaN")&&(s=n),this.removeHover(),!this.value||!this.allowObjectBinding&&this.value.indexOf(s)===-1||this.allowObjectBinding&&this.indexOfObjectInArray(s,this.value)===-1?this.dispatchSelect(s,i,e,e.getAttribute("aria-selected")==="true",r):this.removeValue(s,i,r),this.checkAndScrollParent()},t.prototype.updateListSelectEventCallback=function(e,i,r,n){var s=this;e=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",e):e;var a=n||this.getTextByValue(e);if((this.allowCustomValue||this.allowFiltering)&&!this.findListElement(this.mainList,"li","data-value",e)&&(!this.enableVirtualization||this.enableVirtualization&&this.virtualCustomData)){var l=i&&i.cloneNode(!0),h=this.fields.value?this.fields.value:"value";this.allowCustomValue&&this.mainData.length&&typeof V(h,this.mainData[0])=="number"&&(e=isNaN(parseFloat(e.toString()))?e:parseFloat(e.toString()));var c=this.getDataByValue(e),u={newData:c,cancel:!1};this.trigger("customValueSelection",u,function(d){d.cancel||(s.enableVirtualization&&s.virtualCustomData?(s.virtualCustomSelectData&&s.virtualCustomSelectData.length>=0?s.virtualCustomSelectData.push(c):s.virtualCustomSelectData=[c],s.remoteCustomValue=!1,s.addValue(e,a,r)):(bt([l],s.mainList),s.mainData.push(c),s.remoteCustomValue=!1,s.addValue(e,a,r)))})}else this.remoteCustomValue=!1,this.addValue(e,a,r)},t.prototype.removeListSelection=function(){var e=this.hideSelectedItem?Ci:de.selected,i=this.list.querySelectorAll("."+e),r=i.length;if(i&&i.length)for(Z(i,e);r>0;)i[r-1].setAttribute("aria-selected","false"),this.mode==="CheckBox"&&i&&i.length>r-1&&Z([i[r-1].firstElementChild.lastElementChild],"e-check"),r--;if(!g(this.mainList)){var n=this.mainList.querySelectorAll("."+e),s=n.length;if(n&&n.length)for(Z(n,e);s>0;)n[s-1].setAttribute("aria-selected","false"),this.mode==="CheckBox"&&(i&&i.length>s-1&&Z([i[s-1].firstElementChild.lastElementChild],"e-check"),Z([n[s-1].firstElementChild.lastElementChild],"e-check")),s--}},t.prototype.removeHover=function(){var e=this.list.querySelectorAll("."+de.hover);e&&e.length&&Z(e,de.hover)},t.prototype.removeFocus=function(){if(this.list&&this.mainList){var e=this.list.querySelectorAll("."+de.focus),i=this.mainList.querySelectorAll("."+de.focus);e&&e.length&&(Z(e,de.focus),Z(i,de.focus))}},t.prototype.addListHover=function(e){this.enabled&&this.isValidLI(e)?(this.removeHover(),X([e],de.hover)):e!==null&&e.classList.contains("e-list-group-item")&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(this.removeHover(),X([e],de.hover))},t.prototype.addListFocus=function(e){this.enabled&&(this.isValidLI(e)||this.fields.disabled&&this.isDisabledElement(e))?(this.removeFocus(),X([e],de.focus),this.updateAriaActiveDescendant()):this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&(X([e],de.focus),this.updateAriaActiveDescendant())},t.prototype.addListSelection=function(e,i){var r=this.hideSelectedItem?Ci:de.selected;if(this.isValidLI(e)&&!e.classList.contains(de.hover)){if(X([e],r),this.updateMainList(!1,e.getAttribute("data-value"),i),e.setAttribute("aria-selected","true"),this.mode==="CheckBox"&&e.classList.contains("e-active")){var n=e.getElementsByClassName("e-check").length;n===0&&this.notify("updatelist",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:this})}this.notify("activeList",{module:"CheckBoxSelection",enable:this.mode==="CheckBox",li:e,e:this}),this.chipCollectionWrapper&&this.removeChipSelection(),this.selectedElementID=e.id}},t.prototype.updateDelimeter=function(e,i,r){this.updateData(e,i,r)},t.prototype.onMouseClick=function(e){var i=this;if(!this.isClearAllItem){this.keyCode=null,this.scrollFocusStatus=!1,this.keyboardEvent=null;var r=e.target,n=H(r,"."+de.li);if(this.enableVirtualization&&n&&n.classList.contains("e-virtual-list"))return;var s=H(r,"."+de.group);if(s&&this.enableGroupCheckBox&&this.mode==="CheckBox"&&this.fields.groupBy)r=r.classList.contains("e-list-group-item")?r.firstElementChild.lastElementChild:e.target,r.classList.contains("e-check")?(this.selectAllItem(!1,e),r.classList.remove("e-check"),r.classList.remove("e-stop"),H(r,".e-list-group-item").classList.remove("e-active"),r.setAttribute("aria-selected","false")):(this.selectAllItem(!0,e),r.classList.remove("e-stop"),r.classList.add("e-check"),H(r,".e-list-group-item").classList.add("e-active"),r.setAttribute("aria-selected","true")),this.refreshSelection(),this.checkSelectAll();else{if(this.isValidLI(n)){var a=this.value&&this.value.length?this.value.length:0;n.classList.contains("e-active")&&(a=a-1),a<this.maximumSelectionLength&&(this.updateListSelection(n,e),this.checkPlaceholderSize(),this.addListFocus(n),(this.allowCustomValue||this.allowFiltering)&&this.mainList&&this.listData?this.mode!=="CheckBox"&&(this.focusAtLastListItem(n.getAttribute("data-value")),this.refreshSelection()):this.makeTextBoxEmpty()),this.mode==="CheckBox"?(this.updateDelimView(),this.value&&this.value.length>50?setTimeout(function(){i.updateDelimeter(i.delimiterChar,e)},0):this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,e),this.checkSelectAll(),this.refreshPopup(),this.allowResize&&this.setResize(),this.hideSelectedItem&&this.focusAtFirstListItem(),this.closePopupOnSelect?this.hidePopup(e):e.preventDefault();var l=this.targetElement().trim()!=="";this.makeTextBoxEmpty(),this.findGroupStart(r),this.mode!=="CheckBox"&&this.refreshListItems(g(n)?null:n.textContent,l)}else e.preventDefault();if(this.enableVirtualization&&this.hideSelectedItem){var h=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list)");if(h.length){var c=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(h.length<c+2){var u=this.getForQuery(this.value).clone();if(u=u.skip(this.virtualItemStartIndex),this.resetList(this.dataSource,this.fields,u),this.UpdateSkeleton(),this.liCollections=this.list.querySelectorAll("."+de.li),this.virtualItemCount=this.itemCount,this.mode!=="CheckBox"&&(this.totalItemCount=this.value&&this.value.length?this.totalItemCount-this.value.length:this.totalItemCount),this.list.querySelector(".e-virtual-ddl"))this.list.getElementsByClassName("e-virtual-ddl")[0].style=this.GetVirtualTrackHeight();else{var d=this.createElement("div",{id:this.element.id+"_popup",className:"e-virtual-ddl"});d.style.cssText=this.GetVirtualTrackHeight(),this.popupWrapper.querySelector(".e-dropdownbase").appendChild(d)}this.list.querySelector(".e-virtual-ddl-content")&&(this.list.getElementsByClassName("e-virtual-ddl-content")[0].style=this.getTransformValues())}}}this.refreshPlaceHolder(),this.deselectHeader()}}},t.prototype.findGroupStart=function(e){if(this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)){var i=0,r=0,n=0,s=void 0;if(this.itemTemplate&&!e.getElementsByClassName("e-frame").length)for(;!e.getElementsByClassName("e-frame").length;)e=e.parentElement;for(e.classList.contains("e-frame")&&(e=e.parentElement.parentElement),s=this.findGroupAttrtibutes(e,r,n,i,0),s=this.findGroupAttrtibutes(e,s[0],s[1],s[2],1);!e.classList.contains("e-list-group-item")&&(e.classList.contains("e-list-icon")&&(e=e.parentElement),e=e.previousElementSibling,e!=null););this.updateCheckBox(e,s[0],s[1],s[2])}},t.prototype.findGroupAttrtibutes=function(e,i,r,n,s){for(;!e.classList.contains("e-list-group-item")&&(this.fields.disabled&&this.isDisabledElement(e)||(e.classList.contains("e-list-icon")&&(e=e.parentElement),e.getElementsByClassName("e-frame")[0].classList.contains("e-check")&&e.classList.contains("e-list-item")?i++:e.classList.contains("e-list-item")&&r++,n++),e=s?e.nextElementSibling:e.previousElementSibling,e!=null););return[i,r,n]},t.prototype.updateCheckBox=function(e,i,r,n){if(!(e===null||!g(this.fields.disabled)&&n===0)){var s=e.getElementsByClassName("e-frame")[0];n===i?(s.classList.remove("e-stop"),s.classList.add("e-check"),H(s,".e-list-group-item").classList.add("e-active"),e.setAttribute("aria-selected","true")):n===r?(s.classList.remove("e-check"),s.classList.remove("e-stop"),H(s,".e-list-group-item").classList.remove("e-active"),e.setAttribute("aria-selected","false")):this.maximumSelectionLength===i-1?(s.classList.remove("e-stop"),e.setAttribute("aria-selected","true"),H(s,".e-list-group-item").classList.add("e-active"),s.classList.add("e-check")):(s.classList.remove("e-check"),s.classList.add("e-stop"),H(s,".e-list-group-item").classList.add("e-active"),e.setAttribute("aria-selected","false"))}},t.prototype.disableGroupHeader=function(){var e=this.list.querySelectorAll("li.e-list-group-item");if(e)for(var i=0;i<e.length;i++){for(var r=!0,n=e[i].nextElementSibling;!n.classList.contains("e-list-group-item");){if(!this.isDisabledElement(n)){r=!1;break}if(n=n.nextElementSibling,n==null)break}r&&this.disableListItem(e[i])}},t.prototype.deselectHeader=function(){var e=this.value&&this.value.length?this.value.length:0,i=this.list.querySelectorAll("li.e-list-group-item:not(.e-active)");e<this.maximumSelectionLength&&Z(i,"e-disable"),e===this.maximumSelectionLength&&X(i,"e-disable")},t.prototype.onMouseOver=function(e){var i=H(e.target,"."+de.li);i===null&&this.mode==="CheckBox"&&!g(this.fields.groupBy)&&this.enableGroupCheckBox&&(i=H(e.target,"."+de.group)),this.addListHover(i)},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.onListMouseDown=function(e){e.preventDefault(),this.scrollFocusStatus=!0},t.prototype.onDocumentClick=function(e){if(this.mode!=="CheckBox"){var i=e.target;!(!g(this.popupObj)&&H(i,'[id="'+this.popupObj.element.id+'"]'))&&!this.overAllWrapper.contains(e.target)?this.scrollFocusStatus=!1:this.scrollFocusStatus=(j.isIE||j.info.name==="edge")&&document.activeElement===this.inputElement}},t.prototype.wireListEvents=function(){g(this.list)||(T.add(document,"mousedown",this.onDocumentClick,this),T.add(this.list,"mousedown",this.onListMouseDown,this),T.add(this.list,"mouseup",this.onMouseClick,this),T.add(this.list,"mouseover",this.onMouseOver,this),T.add(this.list,"mouseout",this.onMouseLeave,this))},t.prototype.unwireListEvents=function(){T.remove(document,"mousedown",this.onDocumentClick),this.list&&(T.remove(this.list,"mousedown",this.onListMouseDown),T.remove(this.list,"mouseup",this.onMouseClick),T.remove(this.list,"mouseover",this.onMouseOver),T.remove(this.list,"mouseout",this.onMouseLeave))},t.prototype.hideOverAllClear=function(){(!this.value||!this.value.length||this.inputElement.value==="")&&(this.overAllClear.style.display="none")},t.prototype.showOverAllClear=function(){(this.value&&this.value.length||this.inputElement.value!=="")&&this.showClearButton&&this.readonly!==!0?this.overAllClear.style.display="":this.overAllClear.style.display="none"},t.prototype.focusIn=function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&this.enabled&&this.inputElement.blur()},t.prototype.showSpinner=function(){if(g(this.spinnerElement)){var e=this.filterParent&&this.filterParent.querySelector(".e-clear-icon.e-icons");this.overAllClear.style.display!=="none"||e?this.spinnerElement=e||this.overAllClear:(this.spinnerElement=this.createElement("span",{className:DF+" "+LF}),this.componentWrapper.appendChild(this.spinnerElement)),Qs({target:this.spinnerElement,width:j.isDevice?"16px":"14px"},this.createElement),X([this.spinnerElement],AF),vs(this.spinnerElement)}},t.prototype.hideSpinner=function(){g(this.spinnerElement)||(Xs(this.spinnerElement),Z([this.spinnerElement],AF),this.spinnerElement.classList.contains(LF)?se(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.updateWrapperText=function(e,i){this.valueTemplate||!this.enableHtmlSanitizer?e.innerHTML=this.encodeHtmlEntities(i):e.innerText=i},t.prototype.updateDelimView=function(){if(this.delimiterWrapper&&this.hideDelimWrapper(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.style.display="none"),g(this.viewWrapper)||(this.viewWrapper.style.display="",this.viewWrapper.style.width="",this.viewWrapper.classList.remove(Ay)),this.value&&this.value.length){var e="",i=void 0,r=void 0,n=1,s=void 0,a=void 0,l=0,h=void 0;this.enableVirtualization||this.updateWrapperText(this.viewWrapper,e);var c={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed",overflowCountTemplate:"+${count} more..",totalCountTemplate:"${count} selected"},u=new Ri(this.getLocaleName(),c,this.locale);u.getConstant("actionFailureTemplate")===""&&(u=new Ri("dropdowns",c,this.locale)),u.getConstant("noRecordsTemplate")===""&&(u=new Ri("dropdowns",c,this.locale));var d=u.getConstant("overflowCountTemplate"),p=u.getConstant("totalCountTemplate"),f=this.createElement("span",{className:k5}),v=d.replace("${count}",this.value.length.toString());f.innerText=v,this.viewWrapper.appendChild(f),this.renderReactTemplates();var m=f.offsetWidth;if(Qe(f),this.showDropDownIcon&&(l=this.dropIcon.offsetWidth+parseInt(window.getComputedStyle(this.dropIcon).marginRight,10)),this.checkClearIconWidth(),!g(this.value)&&(this.allowCustomValue||this.listData&&this.listData.length>0))for(var y=0;!g(this.value[y]);y++){var b=this.text&&this.text.split(this.delimiterChar);if(this.enableVirtualization?b&&(e+=y===0?"":this.delimiterChar+" ",i=b[y],e+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,e)):(e+=y===0?"":this.delimiterChar+" ",i=this.getOverflowVal(y),e+=i,i=this.viewWrapper.innerHTML,this.updateWrapperText(this.viewWrapper,e)),s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10),h=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),s+l+this.clearIconWidth>h){for(r!==void 0&&r!==""&&(i=r,y=n+1),this.updateWrapperText(this.viewWrapper,i),a=this.value.length-y,s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10);s+m+l+this.clearIconWidth>h&&s!==0&&this.viewWrapper.innerHTML!=="";){var S=[];this.viewWrapper.innerHTML=S.join(this.delimiterChar),a=this.value.length,s=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10)+parseInt(window.getComputedStyle(this.viewWrapper).paddingLeft,10)}break}else s+m+l+this.clearIconWidth<=h?(r=e,n=y):y===0&&(r="",n=-1)}if(a>0){var C=h-l-this.clearIconWidth;this.viewWrapper.appendChild(this.updateRemainTemplate(f,this.viewWrapper,a,d,p,C)),this.updateRemainWidth(this.viewWrapper,C),this.updateRemainingText(f,l,a,d,p)}}else g(this.viewWrapper)||(this.viewWrapper.innerHTML="",this.viewWrapper.style.display="none")},t.prototype.checkClearIconWidth=function(){this.showClearButton&&(this.clearIconWidth=parseInt(window.getComputedStyle(this.overAllClear).width,10)||this.overAllClear.offsetWidth)},t.prototype.updateRemainWidth=function(e,i){e.classList.contains(Ay)&&i<e.offsetWidth+parseInt(window.getComputedStyle(e).paddingLeft,10)+parseInt(window.getComputedStyle(e).paddingRight,10)&&(e.style.width=i+"px")},t.prototype.updateRemainTemplate=function(e,i,r,n,s,a){i.firstChild&&i.firstChild.nodeType===3&&i.firstChild.nodeValue===""&&i.removeChild(i.firstChild),e.innerHTML="";var l=n.replace("${count}",r.toString()),h=s.replace("${count}",r.toString());return e.innerText=i.firstChild&&i.firstChild.nodeType===3?l:h,i.firstChild&&i.firstChild.nodeType===3?i.classList.remove(Ay):(i.classList.add(Ay),this.updateRemainWidth(i,a)),e},t.prototype.updateRemainingText=function(e,i,r,n,s){var a=this.componentWrapper.offsetWidth-parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft,10)-parseInt(window.getComputedStyle(this.componentWrapper).paddingRight,10),l=this.viewWrapper.offsetWidth+parseInt(window.getComputedStyle(this.viewWrapper).paddingRight,10);if(l+i>=a&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3){for(;l+i>a&&l!==0&&this.viewWrapper.firstChild&&this.viewWrapper.firstChild.nodeType===3;){var h=this.viewWrapper.firstChild.nodeValue.split(this.delimiterChar);h.pop(),this.viewWrapper.firstChild.nodeValue=h.join(this.delimiterChar),this.viewWrapper.firstChild.nodeValue===""&&this.viewWrapper.removeChild(this.viewWrapper.firstChild),r++,l=this.viewWrapper.offsetWidth}var c=a-i;this.updateRemainTemplate(e,this.viewWrapper,r,n,s,c)}},t.prototype.getOverflowVal=function(e){var i;if(this.mainData&&this.mainData.length){var r=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[e]):this.value[e];if(this.mode==="CheckBox"){var n=this.listData;this.listData=this.mainData,i=this.getTextByValue(r),this.listData=n}else i=this.getTextByValue(r)}else i=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[e]):this.value[e];return i},t.prototype.unWireEvent=function(){if(g(this.componentWrapper)||T.remove(this.componentWrapper,"mousedown",this.wrapperClick),T.remove(window,"resize",this.windowResize),!g(this.inputElement)){T.remove(this.inputElement,"focus",this.focusInHandler),T.remove(this.inputElement,"keydown",this.onKeyDown),this.mode!=="CheckBox"&&T.remove(this.inputElement,"input",this.onInput),T.remove(this.inputElement,"keyup",this.keyUp);var e=H(this.inputElement,"form");e&&T.remove(e,"reset",this.resetValueHandler),T.remove(this.inputElement,"blur",this.onBlurHandler)}g(this.componentWrapper)||(T.remove(this.componentWrapper,"mouseover",this.mouseIn),T.remove(this.componentWrapper,"mouseout",this.mouseOut)),g(this.overAllClear)||T.remove(this.overAllClear,"mousedown",this.clearAll),g(this.inputElement)||T.remove(this.inputElement,"paste",this.pasteHandler)},t.prototype.resizingWireEvent=function(){T.add(document,"mousemove",this.resizePopup,this),T.add(document,"mouseup",this.stopResizing,this),T.add(document,"touchmove",this.resizePopup,this),T.add(document,"touchend",this.stopResizing,this)},t.prototype.resizingUnWireEvent=function(){T.remove(document,"mousemove",this.resizePopup),T.remove(document,"mouseup",this.stopResizing),T.remove(document,"touchmove",this.resizePopup),T.remove(document,"touchend",this.stopResizing)},t.prototype.selectAllItem=function(e,i,r){var n;if(g(this.list)||(n=this.list.querySelectorAll(e?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.value&&this.value.length&&i&&i.target&&H(i.target,".e-close-hooker")&&this.allowFiltering&&(n=this.mainList.querySelectorAll(e?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide):not(.e-disabled):not(.e-virtual-list)')),this.enableGroupCheckBox&&this.mode==="CheckBox"&&!g(this.fields.groupBy)){var s=i?this.groupTemplate?H(i.target,".e-list-group-item"):i.target:null;if(s=i&&i.keyCode===32?r:s,s=s&&s.classList.contains("e-frame")?s.parentElement.parentElement:s,s&&s.classList.contains("e-list-group-item")){var a=s.nextElementSibling;if(g(a))return;for(;a.classList.contains("e-list-item");){if(!(this.fields.disabled&&this.isDisabledElement(a)))if(e){if(!a.firstElementChild.lastElementChild.classList.contains("e-check")){var l=this.value&&this.value.length?this.value.length:0;a.classList.contains("e-active")&&(l-=1),l<this.maximumSelectionLength&&this.updateListSelection(a,i)}}else a.firstElementChild.lastElementChild.classList.contains("e-check")&&this.updateListSelection(a,i);if(a=a.nextElementSibling,a==null)break}if(s.classList.contains("e-list-group-item")){var h=this.list.getElementsByClassName("e-item-focus")[0];h&&h.classList.remove("e-item-focus"),e?s.classList.add("e-active"):s.classList.remove("e-active"),s.classList.add("e-item-focus"),this.updateAriaActiveDescendant()}this.textboxValueUpdate(),this.checkPlaceholderSize(),!this.changeOnBlur&&i&&this.updateValueState(i,this.value,this.tempValues)}else this.updateValue(i,n,e)}else this.updateValue(i,n,e);this.addValidInputClass()},t.prototype.virtualSelectionAll=function(e,i,r){var n=this,s=0,a=i.length,l=this.maximumSelectionLength;if(e){this.virtualSelectAll=!0,a=this.virtualSelectAllData&&this.virtualSelectAllData.length!==0?this.virtualSelectAllData.length:a,this.listData=this.virtualSelectAllData;var h=this.createListItems(this.virtualSelectAllData.slice(0,30),this.fields),c=h.querySelectorAll("li"),u=document.createDocumentFragment();c.forEach(function(m){u.appendChild(m.cloneNode(!0))}),i.forEach(function(m){u.appendChild(m.cloneNode(!0))});var d=u.childNodes;if(this.virtualSelectAllData instanceof Array){for(;s<a&&s<=50&&s<l;){if(this.isSelectAllTarget=a===s+1,d[s]){var p=this.allowObjectBinding?this.getDataByValue(d[s].getAttribute("data-value")):this.getFormattedValue(d[s].getAttribute("data-value"));if(!this.allowObjectBinding&&this.value&&this.value.indexOf(p)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(p,this.value)>=0){s++;continue}this.updateListSelection(d[s],r,a-s)}else{var p=V(this.fields.value?this.fields.value:"",this.virtualSelectAllData[s]);if(p=this.allowObjectBinding?this.getDataByValue(p):p,!this.allowObjectBinding&&this.value&&this.value.indexOf(p)>=0||this.allowObjectBinding&&this.indexOfObjectInArray(p,this.value)>=0){s++;continue}this.value&&p!=null&&Array.isArray(this.value)&&(!this.allowObjectBinding&&this.value.indexOf(p)<0||this.allowObjectBinding&&!this.isObjectInArray(p,this.value))&&this.dispatchSelect(p,r,null,!1,a)}s++}a>50&&setTimeout(function(){if(n.virtualSelectAllData&&n.virtualSelectAllData.length>0&&n.virtualSelectAllData.map(function(y){if(n.value&&y[n.fields.value]!=null&&Array.isArray(n.value)&&(!n.allowObjectBinding&&n.value.indexOf(y[n.fields.value])<0||n.allowObjectBinding&&!n.isObjectInArray(y[n.fields.value],n.value))){var b=y[n.fields.value],S=y[n.fields.text].toString();n.dispatchSelect(b,r,null,!1,a,y,S)}}),n.updatedataValueItems(r),n.isSelectAllLoop=!1,n.changeOnBlur||(n.updateValueState(r,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(!0),n.popupWrapper&&i[s-1]&&i[s-1].classList.contains("e-item-focus")){var m=document.getElementsByClassName("e-selectall-parent")[0];m&&m.classList.contains("e-item-focus")&&i[s-1].classList.remove("e-item-focus")}n.checkSelectAll()},0)}}else this.virtualSelectAllData&&this.virtualSelectAllData.length>0&&this.virtualSelectAllData.map(function(m){n.virtualSelectAll=!0,n.removeValue(n.value[s],r,n.value.length-s)}),this.updatedataValueItems(r),this.changeOnBlur||(this.updateValueState(r,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),this.updateHiddenElement(),this.setProperties({value:[]},!0),this.selectedListData=[],this.virtualSelectAll=!1,!g(this.viewPortInfo.startIndex)&&!g(this.viewPortInfo.endIndex)&&this.notify("setCurrentViewDataAsync",{component:this.getModuleName(),module:"VirtualScroll"});this.checkSelectAll();var f=this.list.getElementsByClassName("e-virtual-ddl")[0];f&&(f.style=this.GetVirtualTrackHeight()),this.UpdateSkeleton();var v=this.list.getElementsByClassName("e-virtual-ddl-content")[0];v&&(v.style=this.getTransformValues())},t.prototype.updateValue=function(e,i,r){var n=this,s=i.length,a={event:e,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!e,isChecked:r,preventSelectEvent:!1};if(this.trigger("beforeSelectAll",a),i&&i.length||this.enableVirtualization&&!r){var l=0,h=0;if(this.enableGroupCheckBox?h=r?this.maximumSelectionLength-(this.value?this.value.length:0):i.length:h=r?this.maximumSelectionLength-(this.value?this.value.length:0):this.maximumSelectionLength,a.preventSelectEvent){for(var c=0;c<i.length&&c<h;c++){this.removeHover();var u=i[c].getAttribute("data-value"),d=this.getFormattedValue(u);d=this.allowObjectBinding?this.getDataByValue(d):d;var p=this.mainList?this.mainList.querySelectorAll(r?'li.e-list-item:not([aria-selected="true"]):not(.e-reorder-hide)':'li.e-list-item[aria-selected="true"]:not(.e-reorder-hide)')[c]:null;r?(this.value=this.value?this.value:[],(!this.allowObjectBinding&&this.value.indexOf(d)<0||this.allowObjectBinding&&!this.isObjectInArray(d,this.value))&&this.setProperties({value:[].concat([],this.value,[d])},!0),this.removeFocus(),this.addListSelection(i[c],p),this.updateChipStatus(),this.checkMaxSelection()):this.removeAllItems(d,e,!1,i[c],p),this.enableGroupCheckBox&&this.findGroupStart(i[c])}if(!r){var f=this.value&&this.value.length?this.value.length:0;if(f<this.maximumSelectionLength){var v=this.list.querySelectorAll("li."+de.li+":not(.e-active)");Z(v,"e-disable")}}var m={event:e,items:r?i:[],itemData:r?this.listData:[],isInteracted:!!e,isChecked:r};this.trigger("selectedAll",m)}else if(this.enableVirtualization)this.virtualSelectAllState=r,this.virtualSelectAll=!0,this.CurrentEvent=e,this.virtualSelectAllData||this.resetList(this.dataSource,this.fields,new Pe),this.virtualSelectAllData&&this.virtualSelectionAll(r,i,e);else{for(;l<s&&l<=50&&l<h;)this.isSelectAllTarget=s===l+1,this.updateListSelection(i[l],e,s-l),this.enableGroupCheckBox&&this.findGroupStart(i[l]),l++;s>50&&setTimeout(function(){for(;l<s&&l<h;)n.isSelectAllTarget=s===l+1,n.updateListSelection(i[l],e,s-l),n.enableGroupCheckBox&&n.findGroupStart(i[l]),l++;if(n.updatedataValueItems(e),n.changeOnBlur||(n.updateValueState(e,n.value,n.tempValues),n.isSelectAll=n.isSelectAll?!n.isSelectAll:n.isSelectAll),n.updateHiddenElement(),n.popupWrapper&&i[l-1].classList.contains("e-item-focus")){var y=document.getElementsByClassName("e-selectall-parent")[0];y&&y.classList.contains("e-item-focus")&&i[l-1].classList.remove("e-item-focus")}},0)}}this.updatedataValueItems(e),this.checkPlaceholderSize(),s<=50&&!a.preventSelectEvent&&(this.changeOnBlur||(this.updateValueState(e,this.value,this.tempValues),this.isSelectAll=this.isSelectAll?!this.isSelectAll:this.isSelectAll),(this.enableVirtualization&&this.value&&this.value.length>0||!this.enableVirtualization)&&this.updateHiddenElement())},t.prototype.updateHiddenElement=function(e){var i=this,r="",n="",s="",a=[];this.mode==="CheckBox"&&(this.value.map(function(l,h){r+='<option selected value ="'+l+'">'+h+"</option>",e||(i.listData?s=i.getTextByValue(l):s=l,n+=s+i.delimiterChar+" ",a.push(s))}),this.hiddenElement.innerHTML=r,e||(this.updateWrapperText(this.delimiterWrapper,n),this.setProperties({text:a.toString()},!0)),this.delimiterWrapper.setAttribute("id",Lt("delim_val")),this.inputElement.setAttribute("aria-describedby",this.delimiterWrapper.id),this.refreshInputHight(),this.refreshPlaceHolder())},t.prototype.updatedataValueItems=function(e){this.deselectHeader(),this.textboxValueUpdate(e)},t.prototype.textboxValueUpdate=function(e){var i=e&&e.target&&(H(e.target,".e-selectall-parent")||H(e.target,".e-close-hooker"));this.mode!=="Box"&&!this.isPopupOpen()&&!(this.mode==="CheckBox"&&(this.isSelectAll||i))?this.updateDelimView():this.searchWrapper.classList.remove(Ty),this.mode==="CheckBox"?(this.updateDelimView(),(!(i||this.isSelectAll)&&this.isSelectAllTarget||this.isSelectAll&&this.isSelectAllTarget)&&this.updateDelimeter(this.delimiterChar,e),this.refreshInputHight()):this.updateDelimeter(this.delimiterChar,e),this.refreshPlaceHolder()},t.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},t.prototype.updateDataSource=function(e){this.checkAndResetCache(),g(this.list)?this.renderPopup():this.resetList(this.dataSource),this.value&&this.value.length&&(this.setProperties({value:this.value}),this.refreshSelection())},t.prototype.onLoadSelect=function(){this.setDynValue=!0,this.renderPopup()},t.prototype.selectAllItems=function(e,i){var r=this;if(g(this.list))this.selectAllAction=function(){if(r.mode==="CheckBox"&&r.showSelectAll){var s={module:"CheckBoxSelection",enable:r.mode==="CheckBox",value:e?"check":"uncheck"};r.notify("checkSelectAll",s)}r.selectAllItem(e,i),r.selectAllAction=null},o.prototype.render.call(this);else{if(this.selectAllAction=null,this.mode==="CheckBox"&&this.showSelectAll){var n={value:e?"check":"uncheck",enable:this.mode==="CheckBox",module:"CheckBoxSelection"};this.notify("checkSelectAll",n)}this.selectAllItem(e,i)}(!(this.dataSource instanceof oe)||this.dataSource instanceof oe&&this.virtualSelectAllData)&&(this.virtualSelectAll=!1)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.onPropertyChanged=function(e,i){(e.dataSource&&!g(Object.keys(e.dataSource))||e.query&&!g(Object.keys(e.query)))&&(this.mainList=null,this.mainData=null,this.isFirstClick=!1,this.isDynamicDataChange=!0),this.getModuleName()==="multiselect"&&(this.isFilterAction=!1,this.setUpdateInitial(["fields","query","dataSource"],e));for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"query":case"dataSource":this.mode==="CheckBox"&&this.showSelectAll&&(g(this.popupObj)||(this.popupObj.destroy(),this.popupObj=null),this.renderPopup());break;case"htmlAttributes":this.updateHTMLAttribute();break;case"showClearButton":this.updateClearButton(e.showClearButton);break;case"text":this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),this.updateVal(this.value,this.value,"text");break;case"value":if(this.fields.disabled&&this.removeDisabledItemsValue(this.value),this.updateVal(this.value,i.value,"value"),this.addValidInputClass(),!this.closePopupOnSelect&&this.isPopupOpen()&&this.refreshPopup(),this.isPopupOpen()&&this.mode==="CheckBox"&&this.list&&this.list.querySelector(".e-active.e-disable")){var a=this.list.querySelectorAll("li."+de.li+".e-active.e-disable");Z(a,"e-disable")}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange;break;case"width":this.setWidth(e.width),this.popupObj.setProperties({width:this.calcPopupWidth()});break;case"placeholder":this.refreshPlaceHolder();break;case"filterBarPlaceholder":this.allowFiltering&&this.notify("filterBarPlaceholder",{filterBarPlaceholder:e.filterBarPlaceholder});break;case"delimiterChar":this.mode!=="Box"&&this.updateDelimView(),this.updateData(e.delimiterChar);break;case"cssClass":this.updateOldPropCssClass(i.cssClass),this.updateCssClass(),this.calculateWidth();break;case"enableRtl":this.enableRTL(e.enableRtl),o.prototype.onPropertyChanged.call(this,e,i);break;case"allowResize":if(this.allowResize=e.allowResize,!this.allowResize&&this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=Ae(l),this.popupWrapper.style.height=Ae(this.popupHeight),this.popupWrapper.style.maxHeight=Ae(this.popupHeight)):this.list.style.maxHeight=Ae(this.popupHeight)}break;case"readonly":this.updateReadonly(e.readonly),this.hidePopup();break;case"enabled":this.hidePopup(),this.enable(e.enabled);break;case"showSelectAll":this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup();break;case"showDropDownIcon":this.dropDownIcon();break;case"floatLabelType":this.setFloatLabelType(),this.addValidInputClass(),this.element.querySelector(".e-multiselect .e-float-text-content")===null&&Ie.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon");break;case"enableSelectionOrder":break;case"selectAllText":this.notify("selectAllText",!1);break;case"popupHeight":if(this.popupObj){var l=parseInt(this.popupHeight,10);this.popupHeight!=="auto"?(this.list.style.maxHeight=Ae(l),this.popupWrapper.style.maxHeight=Ae(this.popupHeight)):this.list.style.maxHeight=Ae(this.popupHeight)}break;case"headerTemplate":case"footerTemplate":this.reInitializePoup();break;case"allowFiltering":this.mode==="CheckBox"&&this.popupObj&&this.reInitializePoup(),this.updateSelectElementData(this.allowFiltering);break;case"fields":g(this.fields.groupBy)&&this.removeScrollEvent();break;default:{var h=this.getPropObject(s,e,i);o.prototype.onPropertyChanged.call(this,h.newProperty,h.oldProperty)}break}}},t.prototype.reInitializePoup=function(){this.popupObj&&(this.popupObj.destroy(),this.popupObj=null),this.renderPopup()},t.prototype.totalItemsCount=function(){var e;if(this.dataSource instanceof oe?this.remoteDataCount>=0?e=this.totalItemCount=this.dataCount=this.remoteDataCount:this.resetList(this.dataSource):e=this.dataSource&&this.dataSource.length?this.dataSource.length:0,this.mode==="CheckBox")this.totalItemCount=e!==0?e:this.totalItemCount;else if(this.hideSelectedItem){if(this.totalItemCount=e!==0&&this.value?e-this.value.length:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0)for(var i=0;i<this.virtualCustomSelectData.length;i++)for(var r=0;r<this.value.length;r++){var n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],s=V(this.fields.value?this.fields.value:"",this.virtualCustomSelectData[i]);n===s&&(this.totalItemCount+=1)}}else this.totalItemCount=e!==0?e:this.totalItemCount,this.allowCustomValue&&this.virtualCustomSelectData&&this.virtualCustomSelectData.length>0&&(this.totalItemCount+=this.virtualCustomSelectData.length)},t.prototype.presentItemValue=function(e){for(var i=[],r=0;r<this.value.length;r++){var n=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[r]):this.value[r],s=this.findListElement(this.allowFiltering&&!g(this.mainList)?this.mainList:e,"li","data-value",n);if(!s){var a=this.allowObjectBinding?this.getDataByValue(this.value[r]):this.value[r];i.push(a)}}return i},t.prototype.addNonPresentItems=function(e,i,r,n){var s=this;this.dataSource.executeQuery(this.getForQuery(e)).then(function(a){a.result.length>0&&s.addItem(a.result,r.length),s.updateActionList(i,r,n)})},t.prototype.updateVal=function(e,i,r){var n=this;if(!this.list)this.onLoadSelect(),this.enableVirtualization&&(this.setProperties({text:""},!0),this.selectedListData=[],this.checkInitialValue());else if(this.dataSource instanceof oe&&(!this.listData||!(this.mainList&&this.mainData)))this.onLoadSelect();else{var s=[];!g(this.value)&&!this.allowCustomValue&&(s=this.presentItemValue(this.ulElement));var a=s.some(function(p){return p!==null});if(r==="value"&&s.length>0&&this.dataSource instanceof oe&&!g(this.value)&&this.listData!=null&&(!this.enableVirtualization||this.enableVirtualization&&this.valueTemplate)&&a)this.mainData=null,this.setDynValue=!0,this.isaddNonPresentItems=!0,this.addNonPresentItems(s,this.ulElement,this.listData),this.isaddNonPresentItems=!1;else{if(this.selectedListData=[],r==="text"&&(this.initialTextUpdate(),e=this.value),(g(this.value)||this.value.length===0)&&(this.tempValues=i),this.allowCustomValue&&(this.mode==="Default"||this.mode==="Box")&&this.isReact&&this.inputFocus&&this.isPopupOpen()&&this.mainData!==this.listData){var l=this.mainList.cloneNode?this.mainList.cloneNode(!0):this.mainList;this.onActionComplete(l,this.mainData)}if(!this.enableVirtualization)this.initialValueUpdate();else if(this.enableVirtualization&&!(this.dataSource instanceof oe))this.initialValueUpdate(this.dataSource,!0);else if(!this.isInitRemoteVirtualData)if(this.allowObjectBinding&&!a&&this.value&&this.value.length){for(var h=this.isPrimitiveData?"":this.fields.value,c=void 0,u=0;u<this.value.length;u++){var d=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[u]):this.value[u];u===0?c=new xt(h,"equal",d):c=c.or(h,"equal",d)}this.dataSource instanceof oe&&this.dataSource.executeQuery(new Pe().where(c)).then(function(p){if(p.result.length>0){var f=p.result;n.isDynamicRemoteVirtualData=!0,setTimeout(function(){n.initialValueUpdate(f,!0),n.isDynamicRemoteVirtualData=!1,(!n.inputFocus||n.inputFocus&&n.mode!=="Default")&&n.initialUpdate()},100)}})}else this.isDynamicRemoteVirtualData=!0,this.initialValueUpdate(this.listData,!0),this.isDynamicRemoteVirtualData=!1,this.initialUpdate();this.mode!=="Box"&&!this.inputFocus&&this.updateDelimView(),this.inputFocus||this.refreshInputHight(),this.refreshPlaceHolder(),this.mode!=="CheckBox"&&this.changeOnBlur&&this.updateValueState(null,e,i),this.checkPlaceholderSize()}}this.changeOnBlur||this.updateValueState(null,e,i)},t.prototype.addItem=function(e,i){o.prototype.addItem.call(this,e,i)},t.prototype.hidePopup=function(e){var i=this,r=100;if(this.isPopupOpen()){var n={name:"FadeOut",duration:100,delay:r};this.customFilterQuery=null;var s={popup:this.popupObj,cancel:!1,animation:n,event:e||null};this.trigger("close",s,function(a){if(!a.cancel){i.fields.groupBy&&i.mode!=="CheckBox"&&i.fixedHeaderElement&&(Qe(i.fixedHeaderElement),i.fixedHeaderElement=null),i.beforePopupOpen=!1,i.overAllWrapper.classList.remove(kF);var l=i.mode==="CheckBox"?i.targetElement():null;if(i.popupObj.hide(new Mt(a.animation)),Ee(i.inputElement,{"aria-expanded":"false"}),i.inputElement.removeAttribute("aria-owns"),i.inputElement.removeAttribute("aria-activedescendant"),i.allowFiltering&&i.notify("inputFocus",{module:"CheckBoxSelection",enable:i.mode==="CheckBox",value:"clear"}),i.popupObj.hide(),Z([document.body,i.popupObj.element],"e-popup-full-page"),T.remove(i.list,"keydown",i.onKeyDown),i.mode==="CheckBox"&&i.showSelectAll&&T.remove(i.popupObj.element,"click",i.clickHandler),i.list&&i.list.parentElement&&i.allowResize){i.resizer&&i.list.parentElement.contains(i.resizer)&&i.list.parentElement.removeChild(i.resizer),i.list.parentElement.classList.contains("e-resize")&&i.list.parentElement.classList.remove("e-resize"),i.list.parentElement.style.boxSizing="",i.list.parentElement.style.paddingBottom="";var h=parseInt(i.popupHeight,10);i.list.style.maxHeight=Ae(h),i.popupHeight.toString().toLowerCase()!=="auto"&&i.initialPopupHeight>=parseInt(i.popupHeight.toString(),10)-2&&(i.list.parentElement.style.height=Ae(i.popupHeight)),i.list.parentElement.style.maxHeight=Ae(i.popupHeight)}i.resizer&&(T.remove(i.resizer,"mousedown",i.startResizing),i.resizer.remove()),i.enableVirtualization&&i.mode==="CheckBox"&&i.value&&i.value.length>0&&i.enableSelectionOrder&&(i.viewPortInfo.startIndex=i.virtualItemStartIndex=0,i.viewPortInfo.endIndex=i.virtualItemEndIndex=i.viewPortInfo.startIndex>0?i.viewPortInfo.endIndex:i.itemCount,i.virtualListInfo=i.viewPortInfo,i.previousStartIndex=0,i.previousEndIndex=i.itemCount);var c=void 0;i.dataSource instanceof oe?i.remoteDataCount>=0?i.totalItemCount=i.dataCount=i.remoteDataCount:i.resetList(i.dataSource):c=i.dataSource&&i.dataSource.length?i.dataSource.length:0,i.enableVirtualization&&(i.allowFiltering||i.allowCustomValue)&&(i.targetElement()||l)&&i.totalItemCount!==c&&(i.checkAndResetCache(),i.updateInitialData()),i.virtualCustomData&&i.viewPortInfo&&i.viewPortInfo.startIndex===0&&i.viewPortInfo.endIndex===i.itemCount&&i.renderItems(i.mainData,i.fields),i.virtualCustomData=null,i.isVirtualTrackHeight=!1}})}},t.prototype.showPopup=function(e){var i=this;if(this.enabled){this.firstItem=this.dataSource&&this.dataSource.length>0?this.dataSource[0]:null;var r={cancel:!1};this.trigger("beforeOpen",r,function(n){if(!n.cancel){if(!i.ulElement){i.beforePopupOpen=!0,i.mode==="CheckBox"&&j.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"}),o.prototype.render.call(i,e);return}i.mode==="CheckBox"&&j.isDevice&&i.allowFiltering&&i.isDeviceFullScreen&&i.notify("popupFullScreen",{module:"CheckBoxSelection",enable:i.mode==="CheckBox"});var s=i.ulElement.querySelectorAll("li.e-list-item").length,a=i.ulElement.querySelectorAll("li."+de.li+"."+Ci).length;if(s>0&&s===a&&a===i.mainData.length&&!(i.targetElement()!==""&&i.allowCustomValue)){i.beforePopupOpen=!1;return}if(i.onPopupShown(e),i.enableVirtualization&&i.listData&&i.listData.length&&(!g(i.value)&&(i.getModuleName()==="dropdownlist"||i.getModuleName()==="combobox")&&i.removeHover(),i.beforePopupOpen||(i.hideSelectedItem&&i.value&&Array.isArray(i.value)&&i.value.length>0&&i.totalItemsCount(),!i.preventSetCurrentData&&!g(i.viewPortInfo.startIndex)&&!g(i.viewPortInfo.endIndex)&&i.notify("setCurrentViewDataAsync",{component:i.getModuleName(),module:"VirtualScroll"}))),i.enableVirtualization&&!i.allowFiltering&&i.selectedValueInfo!=null&&i.selectedValueInfo.startIndex>0&&i.value!=null&&i.notify("dataProcessAsync",{module:"VirtualScroll",isOpen:!0}),i.enableVirtualization)i.updatevirtualizationList();else if(i.value&&i.value.length)for(var l=void 0,h=i.getItems(),c=0,u=i.value;c<u.length;c++){var d=u[c],p=i.allowObjectBinding?V(i.fields.value?i.fields.value:"",d):d;l=i.getElementByValue(p),l&&i.addListSelection(l)}i.allowResize&&i.setResize(),i.preventSetCurrentData=!0}})}},t.prototype.selectAll=function(e){this.isSelectAll=!0,this.selectAllItems(e)},t.prototype.getRightIconsWidth=function(){for(var e=this.overAllWrapper,i=0,r=".e-input-group-icon, .e-clear-icon",n=e.querySelectorAll(r),s=0;s<n.length;s++)i+=n[s].offsetWidth;return i},t.prototype.updateFloatLabelOverflowWidth=function(){var e=this.overAllWrapper,i=e.querySelector(".e-float-text"),r=e.clientWidth-this.getRightIconsWidth();i&&r&&(i.style.width=r+"px")},t.prototype.getModuleName=function(){return"multiselect"},t.prototype.clear=function(){var e=this;this.selectAll(!1),this.value&&this.value.length?setTimeout(function(){e.setProperties({value:null},!0)},0):this.setProperties({value:null},!0),this.checkAndResetCache(),this.enableVirtualization&&(this.updateInitialData(),this.chipCollectionWrapper&&(this.chipCollectionWrapper.innerHTML=""),this.isCustomDataUpdated||this.notify("setGeneratedData",{module:"VirtualScroll"}),this.list.scrollTop=0,this.virtualListInfo=null,this.previousStartIndex=0,this.previousEndIndex=this.itemCount)},t.prototype.render=function(){!g(this.value)&&this.value.length>0&&(this.value=this.value.slice()),this.setDynValue=this.initStatus=!1,this.isSelectAll=!1,this.selectAllEventEle=[],this.searchWrapper=this.createElement("span",{className:N5+" "+(this.mode==="Box"?H5:"")}),this.viewWrapper=this.createElement("span",{className:T5+" "+EF}),this.viewWrapper.style.display="none",this.overAllClear=this.createElement("span",{className:DF}),this.overAllClear.style.display="none",this.componentWrapper=this.createElement("div",{className:D5}),this.overAllWrapper=this.createElement("div",{className:M5}),this.mode==="CheckBox"&&X([this.overAllWrapper],"e-checkbox"),j.isDevice&&this.componentWrapper.classList.add(E5),this.setWidth(this.width),this.overAllWrapper.appendChild(this.componentWrapper),this.popupWrapper=this.createElement("div",{id:this.element.id+"_popup",className:F5}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),this.mode==="Delimiter"||this.mode==="CheckBox"?(this.delimiterWrapper=this.createElement("span",{className:EF}),this.delimiterWrapper.style.display="none",this.componentWrapper.appendChild(this.delimiterWrapper)):(this.chipCollectionWrapper=this.createElement("span",{className:A5}),this.chipCollectionWrapper.style.display="none",this.mode==="Default"?this.chipCollectionWrapper.setAttribute("id",Lt("chip_default")):this.mode==="Box"&&this.chipCollectionWrapper.setAttribute("id",Lt("chip_box")),this.componentWrapper.appendChild(this.chipCollectionWrapper)),this.mode!=="Box"&&this.componentWrapper.appendChild(this.viewWrapper),this.componentWrapper.appendChild(this.searchWrapper),this.showClearButton&&!j.isDevice?this.componentWrapper.appendChild(this.overAllClear):this.componentWrapper.classList.add(DI),this.dropDownIcon(),this.inputElement=this.createElement("input",{className:R5,attrs:{spellcheck:"false",type:"text",autocomplete:"off",tabindex:"0",role:"combobox"}}),(this.mode==="Default"||this.mode==="Box")&&this.inputElement.setAttribute("aria-describedby",this.chipCollectionWrapper.id),g(this.inputElement)||(Ee(this.inputElement,{"aria-expanded":"false"}),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName())),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.tagName===this.getNgDirective()?(this.element.appendChild(this.overAllWrapper),this.searchWrapper.appendChild(this.inputElement)):(this.element.parentElement.insertBefore(this.overAllWrapper,this.element),this.searchWrapper.appendChild(this.inputElement),this.searchWrapper.appendChild(this.element),this.element.removeAttribute("tabindex")),this.floatLabelType!=="Never"?xF(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder):this.floatLabelType==="Never"&&this.refreshPlaceHolder(),this.addValidInputClass(),this.element.style.opacity="";var e=this.element.getAttribute("id")?this.element.getAttribute("id"):Lt("ej2_dropdownlist");this.element.id=e,this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",class:B5,tabindex:"-1",multiple:""}}),this.componentWrapper.appendChild(this.hiddenElement),this.validationAttribute(this.element,this.hiddenElement),this.mode!=="CheckBox"&&this.hideOverAllClear(),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),this.updateFloatLabelOverflowWidth(),this.wireEvent(),this.enable(this.enabled),this.enableRTL(this.enableRtl),this.enableVirtualization&&this.updateVirtualizationProperties(this.itemCount,this.allowFiltering,this.mode==="CheckBox"),this.listItemHeight=this.getListHeight(),this.getSkeletonCount(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.viewPortInfo.startIndex>0?this.viewPortInfo.endIndex:this.itemCount,this.checkInitialValue(),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),this.element.querySelector(".e-multiselect .e-float-text-content")===null&&Ie.createSpanElement(this.overAllWrapper,this.createElement),this.calculateWidth(),!g(this.overAllWrapper)&&!g(this.overAllWrapper.getElementsByClassName("e-ddl-icon")[0]&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0]&&this.floatLabelType!=="Never")&&this.overAllWrapper.getElementsByClassName("e-float-text-content")[0].classList.add("e-icon"),this.renderComplete()},t.prototype.setResize=function(){var e=this,i=16;if(this.list&&this.list.parentElement&&g(this.list.parentElement.querySelector(".e-resizer-right.e-icons"))&&(this.resizer=this.createElement("div",{id:this.element.id+"_resize-popup",className:_5})),this.mode==="CheckBox"&&this.showSelectAll&&this.selectAllHeight&&this.selectAllHeight!==0&&(this.storedSelectAllHeight=this.selectAllHeight),this.list&&this.list.parentElement){this.list.parentElement.classList.add("e-resize"),this.initialPopupHeight=this.list.parentElement.clientHeight,this.popupHeight.toString().toLowerCase()!=="auto"&&this.initialPopupHeight>=parseInt(this.popupHeight.toString(),10)-2&&(this.list.parentElement.style.height="100%"),this.list.parentElement.style.boxSizing="border-box";var r=this.mode==="CheckBox"&&this.searchBoxHeight?this.searchBoxHeight+i+(this.showSelectAll?this.storedSelectAllHeight:0):i;if(this.footer){var n=this.list.style.maxHeight,s=this.list.parentElement.style.maxHeight;setTimeout(function(){var l=Math.round(e.footer.getBoundingClientRect().height),h=(parseInt(s,10)-l).toString()+"px";n=(parseInt(h,10)-2).toString()+"px",l>0&&(e.list.parentElement.style.paddingBottom=(parseInt(s,10)-parseInt(n,10)+r).toString()+"px")},1)}else this.list.parentElement.style.paddingBottom=r+"px";if(this.list.parentElement.appendChild(this.resizer),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.headerTemplate){var a=this.list.parentElement.querySelector(".e-ddl-header");a&&a.offsetHeight&&(this.headerTemplateHeight=a.offsetHeight),this.resizeHeight?this.list.style.maxHeight=this.resizeHeight-this.headerTemplateHeight-16+"px":this.list.style.maxHeight=parseInt(this.list.style.maxHeight,10)-16+"px"}}this.resizer&&(T.add(this.resizer,"mousedown",this.startResizing,this),T.add(this.resizer,"touchstart",this.startResizing,this))},t.prototype.startResizing=function(e){this.isResizing=!0,this.trigger("resizeStart",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;this.list&&this.list.parentElement&&(this.originalWidth=this.list.parentElement.offsetWidth,this.originalHeight=this.list.parentElement.offsetHeight,this.originalMouseX=i,this.originalMouseY=r),this.resizingWireEvent(),e&&e.preventDefault()},t.prototype.resizePopup=function(e){if(this.isResizing){this.trigger("resizing",e);var i=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,r=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,n=i-this.originalMouseX,s=r-this.originalMouseY,a=100,l=130;if(this.resizeWidth=Math.max(this.originalWidth+n,a),this.resizeHeight=Math.max(this.originalHeight+s,l),this.list&&this.list.parentElement){var h=parseInt(window.getComputedStyle(this.list.parentElement).minWidth,10),c=parseInt(window.getComputedStyle(this.list.parentElement).minHeight,10);h=h||100,c=c||120,this.resizeWidth=Math.max(this.originalWidth+n,h),this.resizeHeight=Math.max(this.originalHeight+s,c),this.list.parentElement.style.width=this.resizeWidth+"px",this.list.parentElement.style.height=this.resizeHeight+"px",this.list.parentElement.style.maxHeight=this.resizeHeight+"px",this.list.style.maxHeight=this.resizeHeight+"px",this.headerTemplate&&(this.list.style.maxHeight=this.resizeHeight-this.headerTemplateHeight-16+"px"),this.fixedHeaderElement&&this.ulElement&&(this.fixedHeaderElement.style.width=this.ulElement.offsetWidth+"px")}e&&e.preventDefault()}},t.prototype.stopResizing=function(e){this.isResizing&&(this.isResizing=!1,this.trigger("resizeStop",e),this.resizingUnWireEvent()),e&&e.preventDefault()},t.prototype.getListHeight=function(){var e=this.createElement("div",{className:"e-dropdownbase"}),i=this.createElement("li",{className:"e-list-item"}),r=Ae(this.popupHeight);e.style.height=parseInt(r,10).toString()+"px",e.appendChild(i),document.body.appendChild(e),this.virtualListHeight=e.getBoundingClientRect().height;var n=Math.ceil(i.getBoundingClientRect().height)+parseInt(window.getComputedStyle(i).marginBottom,10);return e.remove(),n},t.prototype.removeDisabledItemsValue=function(e){if(e){for(var i=[],r=0,n=0;n<e.length;n++){var s=e[n];typeof s=="object"&&(s=JSON.parse(JSON.stringify(s))[this.fields.value]),s!=null&&!this.isDisabledItemByIndex(this.getIndexByValue(s))&&(i[r++]=e[n])}this.value=i.length>0?i:null}},t.prototype.checkInitialValue=function(){var e=this;this.fields.disabled&&this.removeDisabledItemsValue(this.value);var i=this.dataSource instanceof Array?this.dataSource.length>0:!g(this.dataSource);if(!(this.value&&this.value.length)&&g(this.text)&&!i&&this.element.tagName==="SELECT"&&this.element.options.length>0){for(var r=this.element.options,n=[],s="",a=0,l=r.length;a<l;a++){var h=r[a];if(!g(h.getAttribute("selected")))if(h.getAttribute("value")){var c=this.allowObjectBinding?this.getDataByValue(h.getAttribute("value")):h.getAttribute("value");n.push(c)}else s+=h.text+this.delimiterChar}n.length>0?this.setProperties({value:n},!0):s!==""&&this.setProperties({text:s},!0),(n.length>0||s!=="")&&(this.refreshInputHight(),this.refreshPlaceHolder())}if((this.value&&this.value.length||!g(this.text))&&(this.list||o.prototype.render.call(this)),this.fields.disabled&&(this.text=this.text&&!this.isDisabledItemByIndex(this.getIndexByValue(this.getValueByText(this.text)))?this.text:null),!g(this.text)&&(g(this.value)||this.value.length===0)&&this.initialTextUpdate(),this.value&&this.value.length){var u;if(this.enableVirtualization){for(var d=this.isPrimitiveData?"":this.fields.value,p=void 0,f=0;f<this.value.length;f++){var c=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",this.value[f]):this.value[f];f===0?p=new xt(d,"equal",c):p=p.or(d,"equal",c)}this.dataSource instanceof oe?this.dataSource.executeQuery(new Pe().where(p)).then(function(v){v.result.length>0&&(u=v.result,e.initStatus=!1,e.isInitRemoteVirtualData=!0,setTimeout(function(){e.initialValueUpdate(u,!0),e.initialUpdate(),e.isInitRemoteVirtualData=!1},100),e.initStatus=!0)}):u=new oe(this.dataSource).executeLocal(new Pe().where(p))}this.dataSource instanceof oe?this.setInitialValue=function(){e.initStatus=!1,(!e.enableVirtualization||e.enableVirtualization&&!(e.dataSource instanceof oe))&&e.initialValueUpdate(u),e.initialUpdate(),e.setInitialValue=null,e.initStatus=!0}:(this.initialValueUpdate(u,!0),this.initialUpdate()),this.updateTempValue()}else this.initialUpdate();this.initStatus=!0,this.checkAutoFocus(),g(this.text)||this.element.setAttribute("data-initial-value",this.text)},t.prototype.checkAutoFocus=function(){this.element.hasAttribute("autofocus")&&this.inputElement.focus()},t.prototype.updatevirtualizationList=function(){if(this.value&&this.value.length){for(var e=void 0,i=0,r=this.value;i<r.length;i++){var n=r[i],s=this.allowObjectBinding?V(this.fields.value?this.fields.value:"",n):n;e=this.getElementByValue(s),e&&this.addListSelection(e)}if(this.enableVirtualization&&this.hideSelectedItem){var a=this.list.querySelectorAll("li."+de.li+":not(."+Ci+"):not(.e-reorder-hide):not(.e-virtual-list)");if(a.length){var l=this.virtualListHeight>0?Math.floor(this.virtualListHeight/this.listItemHeight):0;if(a.length<l+2){var h=this.getForQuery(this.value).clone();h=h.skip(this.viewPortInfo.startIndex),this.resetList(this.dataSource,this.fields,h)}}}}},t.prototype.setFloatLabelType=function(){C5(this.overAllWrapper,this.componentWrapper,this.searchWrapper,this.inputElement,this.value,this.floatLabelType,this.placeholder),this.floatLabelType!=="Never"&&xF(this.overAllWrapper,this.searchWrapper,this.element,this.inputElement,this.value,this.floatLabelType,this.placeholder)},t.prototype.addValidInputClass=function(){g(this.overAllWrapper)||(!g(this.value)&&this.value.length||this.floatLabelType==="Always"?X([this.overAllWrapper],"e-valid-input"):Z([this.overAllWrapper],"e-valid-input"))},t.prototype.dropDownIcon=function(){this.showDropDownIcon?(this.dropIcon=this.createElement("span",{className:NF}),this.componentWrapper.appendChild(this.dropIcon),X([this.componentWrapper],["e-down-icon"])):g(this.dropIcon)||(this.dropIcon.parentElement.removeChild(this.dropIcon),Z([this.componentWrapper],["e-down-icon"]))},t.prototype.initialUpdate=function(){this.mode!=="Box"&&!(this.setDynValue&&this.mode==="Default"&&this.inputFocus)&&this.updateDelimView(),this.viewPortInfo.startIndex=this.virtualItemStartIndex=0,this.viewPortInfo.endIndex=this.virtualItemEndIndex=this.itemCount,this.updateCssClass(),this.updateHTMLAttribute(),this.updateReadonly(this.readonly),this.refreshInputHight(),this.checkPlaceholderSize()},t.prototype.disableItem=function(e){if(this.fields.disabled){this.list||this.renderList();var i=-1;if(this.liCollections&&this.liCollections.length>0&&this.listData&&this.fields.disabled){if(typeof e=="string")i=this.getIndexByValue(e);else if(typeof e=="object"){if(e instanceof HTMLLIElement){for(var r=0;r<this.liCollections.length;r++)if(this.liCollections[r]===e){i=this.getIndexByValue(e.getAttribute("data-value"));break}}else for(var n=JSON.parse(JSON.stringify(e))[this.fields.value],r=0;r<this.listData.length;r++)if(JSON.parse(JSON.stringify(this.listData[r]))[this.fields.value]===n){i=this.getIndexByValue(n);break}}else i=e;var s=i<this.liCollections.length&&i>-1;if(s&&!JSON.parse(JSON.stringify(this.listData[i]))[this.fields.disabled]){var a=this.liCollections[i];if(a){this.disableListItem(a);var l=JSON.parse(JSON.stringify(this.listData[i]));if(l[this.fields.disabled]=!0,this.listData[i]=l,a.classList.contains(de.focus)&&this.removeFocus(),a.classList.contains(Ci)||a.classList.contains(de.selected)){var h=this.value;this.removeDisabledItemsValue(this.value),this.updateVal(this.value,h,"value")}this.mode==="CheckBox"&&this.enableGroupCheckBox&&!g(this.fields.groupBy)&&this.disableGroupHeader()}}}}},t.prototype.destroy=function(){this.isReact&&this.clearTemplate(),g(this.popupObj)||(this.popupObj.hide(),this.popupObj.destroy()),this.notify(j5,{}),this.unwireListEvents(),this.unWireEvent();var e=["readonly","aria-disabled","placeholder","aria-label","aria-expanded"],i=e.length;if(!g(this.inputElement))for(;i>0;)this.inputElement.removeAttribute(e[i-1]),i--;for(g(this.element)||(this.element.removeAttribute("data-initial-value"),this.element.style.display="block"),this.overAllWrapper&&this.overAllWrapper.parentElement&&(this.overAllWrapper.parentElement.tagName===this.getNgDirective()?Qe(this.overAllWrapper):(this.overAllWrapper.parentElement.insertBefore(this.element,this.overAllWrapper),Qe(this.overAllWrapper))),this.popupWrapper&&this.popupWrapper.parentElement&&this.popupWrapper.parentElement.remove();this.searchWrapper&&this.searchWrapper.firstChild;)this.searchWrapper.removeChild(this.searchWrapper.firstChild);this.searchWrapper&&this.searchWrapper.parentElement&&this.searchWrapper.parentElement.remove(),this.viewWrapper&&this.viewWrapper.parentElement&&this.viewWrapper.parentElement.remove(),this.overAllClear&&this.overAllClear.parentElement&&this.overAllClear.parentElement.remove(),this.delimiterWrapper&&this.delimiterWrapper.parentElement&&this.delimiterWrapper.parentElement.remove();var r=this.overAllWrapper.querySelector("select.e-multi-hidden");for(r&&r.parentElement&&r.parentElement.remove();this.componentWrapper&&this.componentWrapper.firstChild;)this.componentWrapper.removeChild(this.componentWrapper.firstChild);for(this.componentWrapper&&this.componentWrapper.parentElement&&(this.componentWrapper.removeAttribute("class"),this.componentWrapper.parentElement.remove());this.popupWrapper&&this.popupWrapper.firstChild;)this.popupWrapper.removeChild(this.popupWrapper.firstChild);if(this.inputElement)for(var n=["readonly","aria-disabled","placeholder","aria-labelledby","aria-expanded","autocomplete","aria-readonly","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-label","aria-hidden","tabindex","aria-controls","aria-describedby","size","role","type","class"],s=0;s<n.length;s++)this.inputElement.removeAttribute(n[s]);this.inputElement&&this.inputElement.remove(),this.list=null,this.popupObj=null,this.mainData=null,this.filterParent=null,this.ulElement=null,this.componentWrapper=null,this.overAllClear=null,this.overAllWrapper=null,this.hiddenElement=null,this.searchWrapper=null,this.viewWrapper=null,this.chipCollectionWrapper=null,this.targetInputElement=null,this.popupWrapper=null,this.inputElement=null,this.delimiterWrapper=null,this.liCollections=null,this.popupContentElement=null,this.header=null,this.mainList=null,this.mainListCollection=null,this.footer=null,this.selectAllEventEle=null,o.prototype.destroy.call(this)},ct([Ce({text:null,value:null,iconCss:null,groupBy:null,disabled:null},NI)],t.prototype,"fields",void 0),ct([w(!1)],t.prototype,"enablePersistence",void 0),ct([w(null)],t.prototype,"groupTemplate",void 0),ct([w("No records found")],t.prototype,"noRecordsTemplate",void 0),ct([w("Request failed")],t.prototype,"actionFailureTemplate",void 0),ct([w("None")],t.prototype,"sortOrder",void 0),ct([w(!0)],t.prototype,"enabled",void 0),ct([w(!0)],t.prototype,"enableHtmlSanitizer",void 0),ct([w(!1)],t.prototype,"enableVirtualization",void 0),ct([w([])],t.prototype,"dataSource",void 0),ct([w(null)],t.prototype,"query",void 0),ct([w("StartsWith")],t.prototype,"filterType",void 0),ct([w(1e3)],t.prototype,"zIndex",void 0),ct([w(!1)],t.prototype,"ignoreAccent",void 0),ct([w()],t.prototype,"locale",void 0),ct([w(!1)],t.prototype,"enableGroupCheckBox",void 0),ct([w(null)],t.prototype,"cssClass",void 0),ct([w("100%")],t.prototype,"width",void 0),ct([w("300px")],t.prototype,"popupHeight",void 0),ct([w("100%")],t.prototype,"popupWidth",void 0),ct([w(null)],t.prototype,"placeholder",void 0),ct([w(null)],t.prototype,"filterBarPlaceholder",void 0),ct([w({})],t.prototype,"htmlAttributes",void 0),ct([w(null)],t.prototype,"valueTemplate",void 0),ct([w(null)],t.prototype,"headerTemplate",void 0),ct([w(null)],t.prototype,"footerTemplate",void 0),ct([w(null)],t.prototype,"itemTemplate",void 0),ct([w(null)],t.prototype,"allowFiltering",void 0),ct([w(300)],t.prototype,"debounceDelay",void 0),ct([w(!0)],t.prototype,"isDeviceFullScreen",void 0),ct([w(!0)],t.prototype,"changeOnBlur",void 0),ct([w(!1)],t.prototype,"allowCustomValue",void 0),ct([w(!0)],t.prototype,"showClearButton",void 0),ct([w(1e3)],t.prototype,"maximumSelectionLength",void 0),ct([w(!1)],t.prototype,"readonly",void 0),ct([w(!1)],t.prototype,"allowResize",void 0),ct([w(null)],t.prototype,"text",void 0),ct([w(null)],t.prototype,"value",void 0),ct([w(!1)],t.prototype,"allowObjectBinding",void 0),ct([w(!0)],t.prototype,"hideSelectedItem",void 0),ct([w(!0)],t.prototype,"closePopupOnSelect",void 0),ct([w("Default")],t.prototype,"mode",void 0),ct([w(",")],t.prototype,"delimiterChar",void 0),ct([w(!0)],t.prototype,"ignoreCase",void 0),ct([w(!1)],t.prototype,"showDropDownIcon",void 0),ct([w("Never")],t.prototype,"floatLabelType",void 0),ct([w(!1)],t.prototype,"showSelectAll",void 0),ct([w("Select All")],t.prototype,"selectAllText",void 0),ct([w("Unselect All")],t.prototype,"unSelectAllText",void 0),ct([w(!0)],t.prototype,"enableSelectionOrder",void 0),ct([w(!0)],t.prototype,"openOnClick",void 0),ct([w(!1)],t.prototype,"addTagOnBlur",void 0),ct([G()],t.prototype,"change",void 0),ct([G()],t.prototype,"removing",void 0),ct([G()],t.prototype,"removed",void 0),ct([G()],t.prototype,"beforeSelectAll",void 0),ct([G()],t.prototype,"selectedAll",void 0),ct([G()],t.prototype,"beforeOpen",void 0),ct([G()],t.prototype,"open",void 0),ct([G()],t.prototype,"close",void 0),ct([G()],t.prototype,"blur",void 0),ct([G()],t.prototype,"focus",void 0),ct([G()],t.prototype,"chipSelection",void 0),ct([G()],t.prototype,"resizeStop",void 0),ct([G()],t.prototype,"resizing",void 0),ct([G()],t.prototype,"resizeStart",void 0),ct([G()],t.prototype,"filtering",void 0),ct([G()],t.prototype,"tagging",void 0),ct([G()],t.prototype,"customValueSelection",void 0),t=ct([It],t),t})(HF),U5="e-icons",Ly="e-frame",wc="e-check",RF="e-checkbox-wrapper",Bf="e-stop",W5="e-selectall-parent",q5="e-input-group-icon e-back-icon e-icons",OF="e-input-group-icon e-clear-icon e-icons",Y5="e-input-filter",G5="e-filter-parent",Q5="e-ddl-device-filter",TI="e-clear-icon",zF="e-popup-full-page",X5="e-ddl-device",PF="e-input-focus",FI=(function(){function o(t){this.activeLi=[],this.activeEle=[],this.parent=t,this.removeEventListener(),this.addEventListener()}return o.prototype.getModuleName=function(){return"CheckBoxSelection"},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("updatelist",this.listSelection,this),this.parent.on("listoption",this.listOption,this),this.parent.on("selectAll",this.setSelectAll,this),this.parent.on("checkSelectAll",this.checkSelectAll,this),this.parent.on("searchBox",this.setSearchBox,this),this.parent.on("blur",this.onBlurHandler,this),this.parent.on("targetElement",this.targetElement,this),this.parent.on("deviceSearchBox",this.setDeviceSearchBox,this),this.parent.on("inputFocus",this.getFocus,this),this.parent.on("reOrder",this.setReorder,this),this.parent.on("activeList",this.getActiveList,this),this.parent.on("selectAllText",this.setLocale,this),this.parent.on("filterBarPlaceholder",this.setPlaceholder,this),T.add(document,"mousedown",this.onDocumentClick,this),this.parent.on("addItem",this.checboxCreate,this),this.parent.on("popupFullScreen",this.setPopupFullScreen,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updatelist",this.listSelection),this.parent.off("listoption",this.listOption),this.parent.off("selectAll",this.setSelectAll),this.parent.off("checkSelectAll",this.checkSelectAll),this.parent.off("searchBox",this.setSearchBox),this.parent.off("blur",this.onBlurHandler),this.parent.off("targetElement",this.targetElement),this.parent.off("deviceSearchBox",this.setDeviceSearchBox),this.parent.off("inputFocus",this.getFocus),this.parent.off("reOrder",this.setReorder),this.parent.off("activeList",this.getActiveList),this.parent.off("selectAllText",this.setLocale),this.parent.off("filterBarPlaceholder",this.setPlaceholder),this.parent.off("addItem",this.checboxCreate),this.parent.off("popupFullScreen",this.setPopupFullScreen))},o.prototype.listOption=function(t){var e=this;if(g(this.parent.listCurrentOptions.itemCreated))this.parent.listCurrentOptions.itemCreated=function(r){e.checboxCreate(r)};else{var i=this.parent.listCurrentOptions.itemCreated;this.parent.listCurrentOptions.itemCreated=function(r){e.checboxCreate(r),i.apply(e,[r])}}},o.prototype.setPlaceholder=function(t){Ie.setPlaceholder(t.filterBarPlaceholder,this.filterInput)},o.prototype.checboxCreate=function(t){var e;if(g(t.item)?e=t:e=t.item,this.parent.enableGroupCheckBox||e.className!=="e-list-group-item "&&e.className!=="e-list-group-item"){var i=hl(this.parent.createElement,!0),r=J("div."+U5,e);return e.insertBefore(i,e.childNodes[g(r)?0:1]),J("."+Ly,i),this.parent.enableGroupCheckBox&&this.parent.popupWrapper.classList.add("e-multiselect-group"),e}else return e},o.prototype.setSelectAll=function(){this.parent.showSelectAll?(g(this.checkAllParent)&&(this.checkAllParent=this.parent.createElement("div",{className:W5}),this.selectAllSpan=this.parent.createElement("span",{className:"e-all-text"}),this.selectAllSpan.textContent="",this.checkAllParent.appendChild(this.selectAllSpan),this.setLocale(),this.checboxCreate(this.checkAllParent),this.parent.headerTemplate&&(g(this.parent.filterParent)?bt([this.checkAllParent],this.parent.popupWrapper):bt([this.checkAllParent],this.parent.filterParent)),this.parent.headerTemplate||(g(this.parent.filterParent)?$r([this.checkAllParent],this.parent.popupWrapper):this.parent.filterParent.parentNode.insertBefore(this.checkAllParent,this.parent.filterParent.nextSibling)),T.add(this.checkAllParent,"mousedown",this.clickHandler,this)),this.parent.list.classList.contains("e-nodata")||this.parent.listData&&this.parent.listData.length<=1&&!this.parent.enableVirtualization&&!this.parent.isDynamicDataChange||this.parent.isDynamicDataChange&&this.parent.listData&&this.parent.listData.length<=1?this.checkAllParent.style.display="none":this.checkAllParent.style.display="block",this.parent.selectAllHeight=this.checkAllParent.getBoundingClientRect().height):g(this.checkAllParent)||(this.checkAllParent.parentElement.removeChild(this.checkAllParent),this.checkAllParent=null)},o.prototype.destroy=function(){this.removeEventListener(),T.remove(document,"mousedown",this.onDocumentClick),this.checkAllParent=null,this.clearIconElement=null,this.filterInput=null,this.filterInputObj=null,this.checkWrapper=null,this.selectAllSpan=null},o.prototype.listSelection=function(t){var e;if(g(t.e)){var r=t.li.querySelector(".e-checkbox-wrapper");e=r?r.childNodes[1]:t.li.lastElementChild.childNodes[1]}else{var i=t.li.querySelector(".e-checkbox-wrapper .e-frame");e=g(t.e.target)?t.li.querySelector(".e-checkbox-wrapper").childNodes[1]:t.e.target.classList.contains("e-frame")&&(!this.parent.showSelectAll||this.checkAllParent&&!this.checkAllParent.contains(t.e.target))?t.e.target:t.li.querySelector(".e-checkbox-wrapper").childNodes[1]}if((this.parent.itemTemplate||this.parent.enableGroupCheckBox)&&(e=t.li.firstElementChild.childNodes[1]),g(e)||(this.checkWrapper=H(e,"."+RF)),!g(this.checkWrapper)){var n=J("."+Ly,this.checkWrapper),s=!1;this.validateCheckNode(this.checkWrapper,n.classList.contains(wc),t.li,t.e,s)}},o.prototype.validateCheckNode=function(t,e,i,r,n){this.changeState(t,e?"uncheck":"check",r,!0,n)},o.prototype.clickHandler=function(t){var e;t.currentTarget.classList.contains(this.checkAllParent.className)||t.currentTarget.classList.value===this.checkAllParent.className?e=t.currentTarget.firstElementChild.lastElementChild:e=t.currentTarget,this.checkWrapper=H(e,"."+RF);var i=!0;if(!g(this.checkWrapper)){var r=J("."+Ly,this.checkWrapper);this.validateCheckNode(this.checkWrapper,r.classList.contains(wc),null,t,i)}t.preventDefault()},o.prototype.changeState=function(t,e,i,r,n){var s=t.getElementsByClassName(Ly)[0];e==="check"&&!s.classList.contains(wc)?(s.classList.remove(Bf),s.classList.add(wc),n&&(this.parent.selectAllItems(!0,i),this.setLocale(!0))):e==="uncheck"&&(s.classList.contains(wc)||s.classList.contains(Bf))?(Z([s],[wc,Bf]),n&&(this.parent.selectAllItems(!1,i),this.setLocale())):e==="indeterminate"&&!s.classList.contains(Bf)&&(Z([s],[wc]),s.classList.add(Bf),n&&(this.parent.selectAllItems(!1,i),this.setLocale()))},o.prototype.setSearchBox=function(t){if(g(this.parent.filterParent)){this.parent.filterParent=this.parent.createElement("span",{className:G5}),this.filterInput=this.parent.createElement("input",{attrs:{type:"text"},className:Y5}),this.parent.element.parentNode.insertBefore(this.filterInput,this.parent.element);var e=!1;return j.isDevice&&this.parent.isDeviceFullScreen&&(e=!0,this.parent.mobFilter=!1),this.filterInputObj=Ie.createInput({element:this.filterInput,buttons:e?[q5,OF]:[OF],properties:{placeholder:this.parent.filterBarPlaceholder}},this.parent.createElement),g(this.parent.cssClass)||(this.parent.cssClass.split(" ").indexOf("e-outline")!==-1?X([this.filterInputObj.container],"e-outline"):this.parent.cssClass.split(" ").indexOf("e-filled")!==-1&&X([this.filterInputObj.container],"e-filled")),bt([this.filterInputObj.container],this.parent.filterParent),$r([this.parent.filterParent],t.popupElement),Ee(this.filterInput,{"aria-disabled":"false",role:"combobox",autocomplete:"off",autocapitalize:"off",spellcheck:"false","aria-label":"multiselect","aria-expanded":"true","aria-controls":t.popupElement.id}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+TI),!j.isDevice&&this.clearIconElement&&(T.add(this.clearIconElement,"mousedown",this.clearText,this),this.clearIconElement.style.visibility="hidden"),T.add(this.filterInput,"input",this.parent.onInput,this.parent),T.add(this.filterInput,"keyup",this.parent.keyUp,this.parent),T.add(this.filterInput,"keydown",this.parent.onKeyDown,this.parent),T.add(this.filterInput,"blur",this.onBlurHandler,this),T.add(this.filterInput,"paste",this.parent.pasteHandler,this.parent),this.parent.searchBoxHeight=this.filterInputObj.container.parentElement.getBoundingClientRect().height,this.filterInputObj}},o.prototype.clickOnBackIcon=function(t){this.parent.hidePopup(),Z([document.body,this.parent.popupObj.element],zF),this.parent.inputElement.focus()},o.prototype.clearText=function(t){this.parent.targetInputElement.value="",this.parent.allowFiltering&&this.parent.targetInputElement.value===""&&this.parent.search(null),this.parent.refreshListItems(null),this.parent.refreshPopup(),this.clearIconElement.style.visibility="hidden",this.filterInput.focus(),(!this.parent.enableVirtualization||this.parent.enableVirtualization&&(g(this.parent.value)||this.parent.value&&this.parent.value.length===0))&&this.setReorder(t),this.boundPreventListSelection=this.preventListSelection.bind(this),this.parent.popupWrapper.addEventListener("mouseup",this.boundPreventListSelection,!0),t.preventDefault()},o.prototype.preventListSelection=function(t){t.stopPropagation(),this.parent.popupWrapper.removeEventListener("mouseup",this.boundPreventListSelection,!0),this.boundPreventListSelection=null},o.prototype.setDeviceSearchBox=function(){this.parent.popupObj.element.classList.add(X5),this.parent.popupObj.element.classList.add(Q5),this.parent.popupObj.position={X:0,Y:0},this.parent.popupObj.dataBind(),this.setSearchBoxPosition(),this.backIconElement=this.filterInputObj.container.querySelector(".e-back-icon"),this.clearIconElement=this.filterInputObj.container.querySelector("."+TI),this.clearIconElement.style.visibility="hidden",T.add(this.backIconElement,"click",this.clickOnBackIcon,this),T.add(this.clearIconElement,"click",this.clearText,this)},o.prototype.setSearchBoxPosition=function(){var t=this.filterInput.parentElement.getBoundingClientRect().height,e=0,i=0,r=0;this.checkAllParent&&(e=this.checkAllParent.getBoundingClientRect().height),this.parent.header&&(r=this.parent.header.getBoundingClientRect().height),this.parent.footer&&(i=this.parent.footer.getBoundingClientRect().height),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%",this.parent.list.style.maxHeight=window.innerHeight-t-e-r-i+"px",this.parent.list.style.height=window.innerHeight-t-e-r-i+"px";var n=this.filterInput.parentElement.querySelector("."+TI);se(this.filterInput),n.parentElement.insertBefore(this.filterInput,n)},o.prototype.setPopupFullScreen=function(){this.parent&&this.parent.popupObj&&(Ee(this.parent.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),X([document.body,this.parent.popupObj.element],zF),this.parent.popupObj.element.style.maxHeight="100%",this.parent.popupObj.element.style.width="100%")},o.prototype.targetElement=function(){return g(this.clearIconElement)||(this.parent.targetInputElement=this.filterInput,this.clearIconElement.style.visibility=this.parent.targetInputElement.value===""?"hidden":"visible"),this.parent.targetInputElement.value},o.prototype.onBlurHandler=function(t){if(!this.parent.element.classList.contains("e-listbox")){var e=void 0;if(this.parent.keyAction)return;if(j.isIE&&(e=!g(t)&&t.target),j.isIE||(e=!g(t)&&t.relatedTarget),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&this.parent.popupObj.element.contains(e)&&!j.isIE&&this.filterInput){this.filterInput.focus();return}if(this.parent.scrollFocusStatus&&this.filterInput){t.preventDefault(),this.filterInput.focus(),this.parent.scrollFocusStatus=!1;return}this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.updateValueState(t,this.parent.value,this.parent.tempValues),this.parent.dispatchEvent(this.parent.hiddenElement,"change")),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&(this.parent.inputFocus=!1,this.parent.overAllWrapper.classList.remove(PF),this.parent.trigger("blur"),this.parent.focused=!0),this.parent.popupObj&&document.body.contains(this.parent.popupObj.element)&&!this.parent.popupObj.element.classList.contains("e-popup-close")&&!j.isDevice&&this.parent.hidePopup()}},o.prototype.onDocumentClick=function(t){if(this.parent.getLocaleName()!=="listbox"){var e=t.target;!g(this.parent.popupObj)&&H(e,'[id="'+this.parent.popupObj.element.id+'"]')&&(this.filterInput&&this.filterInput.value!==""||t.preventDefault()),!(!g(this.parent.popupObj)&&H(e,'[id="'+this.parent.popupObj.element.id+'"]'))&&!g(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(t.target)?(this.parent.overAllWrapper.classList.contains(de.focus)||this.parent.isPopupOpen())&&(this.parent.inputFocus=!1,this.parent.scrollFocusStatus=!1,this.parent.hidePopup(),this.parent.onBlurHandler(t,!0),this.parent.focused=!0):this.parent.scrollFocusStatus=(j.isIE||j.info.name==="edge")&&document.activeElement===this.filterInput,!g(this.parent.overAllWrapper)&&!this.parent.overAllWrapper.contains(t.target)&&this.parent.overAllWrapper.classList.contains("e-input-focus")&&!this.parent.isPopupOpen()&&(j.isIE?this.parent.onBlurHandler():this.parent.onBlurHandler(t)),this.filterInput===e&&this.filterInput.focus()}},o.prototype.getFocus=function(t){if(this.parent.overAllWrapper.classList.remove(PF),this.parent.keyAction&&t.value!=="clear"&&t.value!=="focus"){this.parent.keyAction=!1;return}t.value==="focus"&&(this.filterInput.focus(),this.parent.removeFocus(),T.remove(this.parent.list,"keydown",this.parent.onKeyDown)),t.value==="clear"&&(this.filterInput.value="",this.clearIconElement.style.visibility="hidden")},o.prototype.checkSelectAll=function(t){t.value==="check"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale(!0)),t.value==="uncheck"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale()),t.value==="indeterminate"&&(this.changeState(this.checkAllParent,t.value,null,null,!1),this.setLocale())},o.prototype.setLocale=function(t){if(this.parent.selectAllText!=="Select All"||this.parent.unSelectAllText!=="Unselect All"){var e=t?this.parent.unSelectAllText:this.parent.selectAllText;this.selectAllSpan.textContent="";for(var i=Et(e),r=t?"unSelectAllText":"selectAllText",n=0,s=i({},this.parent,r,null,!this.parent.isStringTemplate);n<s.length;n++){var a=s[n];this.selectAllSpan.textContent=a.textContent}}else{var l={selectAllText:"Select All",unSelectAllText:"Unselect All"},h=new Ri(this.parent.getLocaleName(),{},this.parent.locale);h.getConstant("selectAllText")===""&&(h=new Ri("dropdowns",l,this.parent.locale)),g(this.selectAllSpan)||(this.selectAllSpan.textContent=t?h.getConstant("unSelectAllText"):h.getConstant("selectAllText"))}},o.prototype.getActiveList=function(t){t.li.classList.contains("e-active")?this.activeLi.push(t.li.cloneNode(!0)):this.activeLi.splice(t.index,1)},o.prototype.setReorder=function(t){if(this.parent.enableSelectionOrder&&!g(this.parent.value)){var e=this.parent.ulElement.querySelectorAll("li.e-active").length,i=void 0,r=this.parent.createElement("ul",{className:"e-list-parent e-ul e-reorder"});if(e>0){var n=this.parent.ulElement.querySelectorAll("li.e-active");if(n.forEach(function(a){r.appendChild(a)}),i=this.parent.ulElement.querySelectorAll("li.e-active"),X(i,"e-reorder-hide"),this.parent.enableVirtualization){var s=this.parent.list.querySelector(".e-virtual-ddl-content");$r([r],s)}else $r([r],this.parent.list)}this.parent.focusAtFirstListItem()}},o})();var aR=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Ir=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},xa="e-other-month",RI="e-other-year",Hf="e-calendar",VF="e-device",K5="e-header",_F="e-rtl",$5="e-content",Z5="e-calendar-content-table",OI="e-year",zI="e-month",UF="e-decade",WF="e-icons",J5="e-prev",eW="e-next",tW="e-date-icon-prev",iW="e-date-icon-next ",rW="e-icon-container",lr="e-disabled",bh="e-overlay",nW="e-weekend",Vf="e-week-number",En="e-selected",zs="e-focused-date",Ic="e-focused-cell",Oy="e-month-hide",qF="e-today",sW="e-title",YF="e-day",GF="e-cell",aW="e-week-header",zy="e-zoomin",oW="e-footer-container",lW="e-btn",hW="e-flat",cW="e-css",uW="e-primary",QF="e-calendar-day-header-lg",PI=864e5,dW=6e4,pW=(function(o){aR(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.effect="",r.isPopupClicked=!1,r.isDateSelected=!0,r.isTodayClicked=!1,r.preventChange=!1,r.previousDates=!1,r}return t.prototype.render=function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),this.calendarMode==="Islamic"&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1941,12,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2068,2,4))),this.globalize=new Nt(this.locale),(g(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date(new Date().setHours(0,0,0,0)),this.getModuleName()==="calendar"?(this.element.classList.add(Hf),this.enableRtl&&this.element.classList.add(_F),j.isDevice&&this.element.classList.add(VF),Ee(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(Hf),this.enableRtl&&this.calendarElement.classList.add(_F),j.isDevice&&this.calendarElement.classList.add(VF),Ee(this.calendarElement,{"data-role":"calendar"})),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),this.createHeader(),this.createContent(),this.wireEvents()},t.prototype.rangeValidation=function(e,i){g(e)&&this.setProperties({min:new Date(1900,0,1)},!0),g(i)&&this.setProperties({max:new Date(2099,11,31)},!0)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs},t.prototype.validateDate=function(e){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date(new Date().setHours(0,0,0,0)),!g(e)&&this.min<=this.max&&e>=this.min&&e<=this.max&&(this.currentDate=new Date(this.checkValue(e)))},t.prototype.setOverlayIndex=function(e,i,r,n){if(n&&!g(i)&&!g(r)&&!g(e)){var s=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(s-1).toString(),e.style.zIndex=s.toString()}},t.prototype.minMaxUpdate=function(e){this.min=g(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=g(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max?Z([this.element],bh):(this.setProperties({min:this.min},!0),X([this.element],bh)),+this.min<=+this.max&&e&&+e<=+this.max&&+e>=+this.min?this.currentDate=new Date(this.checkValue(e)):+this.min<=+this.max&&!e&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))},t.prototype.createHeader=function(){var e={"aria-disabled":"false","aria-label":"previous month"},i={"aria-disabled":"false","aria-label":"next month"},r={"aria-atomic":"true","aria-live":"assertive"},n={tabindex:"0"};this.headerElement=this.createElement("div",{className:K5});var s=this.createElement("div",{className:rW});this.previousIcon=this.createElement("button",{className:""+J5,attrs:{type:"button"}}),Wi(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),Ee(this.previousIcon,e),Ee(this.previousIcon,n),this.nextIcon=this.createElement("button",{className:""+eW,attrs:{type:"button"}}),Wi(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.getModuleName()==="daterangepicker"&&(Ee(this.previousIcon,{tabIndex:"-1"}),Ee(this.nextIcon,{tabIndex:"-1"})),Ee(this.nextIcon,i),Ee(this.nextIcon,n),this.headerTitleElement=this.createElement("div",{className:""+YF+" "+sW}),Ee(this.headerTitleElement,r),Ee(this.headerTitleElement,n),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:""+tW+" "+WF})),this.nextIcon.appendChild(this.createElement("span",{className:""+iW+" "+WF})),s.appendChild(this.previousIcon),s.appendChild(this.nextIcon),this.headerElement.appendChild(s),this.getModuleName()==="calendar"?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()},t.prototype.createContent=function(){this.contentElement=this.createElement("div",{className:$5}),this.table=this.createElement("table",{attrs:{class:Z5,tabIndex:"0",role:"grid","aria-activedescendant":"","aria-labelledby":this.element.id}}),this.getModuleName()==="calendar"?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter(),this.getModuleName()!=="daterangepicker"&&(T.add(this.table,"focus",this.addContentFocus,this),T.add(this.table,"blur",this.removeContentFocus,this))},t.prototype.addContentFocus=function(e){var i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected");g(r)?g(i)||i.classList.add(Ic):r.classList.add(Ic)},t.prototype.removeContentFocus=function(e){var i=g(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-focused-date"),r=g(this.tableBodyElement)?null:this.tableBodyElement.querySelector("tr td.e-selected");g(r)?g(i)||i.classList.remove(Ic):r.classList.remove(Ic)},t.prototype.getCultureValues=function(){var e=[],i,r=g(this.dayHeaderFormat)?null:"days.stand-alone."+this.dayHeaderFormat.toLowerCase();if((this.locale==="en"||this.locale==="en-US")&&!g(r)?i=V(r,hm()):i=this.getCultureObjects(Br,""+this.locale),!g(i))for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];e.push(V(a,i))}return e},t.prototype.toCapitalize=function(e){return!g(e)&&e.length?e[0].toUpperCase()+e.slice(1):e},t.prototype.createContentHeader=function(){this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content .e-week-header")[0])||se(this.element.querySelectorAll(".e-content .e-week-header")[0]):g(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||se(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var e=6,i="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:aW}),this.weekNumber&&(i+='<th class="e-week-number" aria-hidden="true"></th>',this.getModuleName()==="calendar"?X([this.element],""+Vf):X([this.calendarElement],""+Vf));var r=this.getCultureValues().length>0&&this.getCultureValues()?this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek):null;if(!g(r))for(var n=0;n<=e;n++)i+='<th  class="">'+this.toCapitalize(r[n])+"</th>";i="<tr>"+i+"</tr>",this.tableHeadElement.innerHTML=i,this.table.appendChild(this.tableHeadElement)},t.prototype.createContentBody=function(){switch(this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content tbody")[0])||se(this.element.querySelectorAll(".e-content tbody")[0]):g(this.calendarElement.querySelectorAll(".e-content tbody")[0])||se(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}},t.prototype.updateFooter=function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today")),this.todayElement.setAttribute("tabindex","0")},t.prototype.createContentFooter=function(){if(this.showTodayButton){var e=new Date(+this.min),i=new Date(+this.max),r={today:"Today"};this.globalize=new Nt(this.locale),this.l10=new Ri(this.getModuleName(),r,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),Wi(this.todayElement),this.updateFooter(),X([this.todayElement],[lW,qF,hW,uW,cW]),(!(+new Date(e.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(i.setHours(0,0,0,0)))||this.todayDisabled)&&X([this.todayElement],lr),this.footer=this.createElement("div",{className:oW}),this.footer.appendChild(this.todayElement),this.getModuleName()==="calendar"&&this.element.appendChild(this.footer),this.getModuleName()==="datepicker"&&this.calendarElement.appendChild(this.footer),this.getModuleName()==="datetimepicker"&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(lr)||T.add(this.todayElement,"click",this.todayButtonClick,this)}},t.prototype.wireEvents=function(e,i,r,n){T.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=pe(this.defaultKeyConfigs,this.keyConfigs),this.getModuleName()==="calendar"?this.keyboardModule=new rr(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):this.keyboardModule=new rr(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.dateWireEvents=function(e,i,r,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=pe(this.defaultKeyConfigs,r),this.serverModuleName=n},t.prototype.todayButtonClick=function(e,i,r){this.showTodayButton&&(this.currentView()===this.depth?this.effect="":this.effect="e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(i)),r):this.navigateTo("Month",new Date(this.checkValue(i)),r))},t.prototype.resetCalendar=function(){this.calendarElement&&se(this.calendarElement),this.tableBodyElement&&se(this.tableBodyElement),this.table&&se(this.table),this.tableHeadElement&&se(this.tableHeadElement),this.nextIcon&&se(this.nextIcon),this.previousIcon&&se(this.previousIcon),this.footer&&se(this.footer),this.todayElement=null,this.renderDayCellArgs=null,this.calendarElement=this.tableBodyElement=this.footer=this.tableHeadElement=this.nextIcon=this.previousIcon=this.table=null},t.prototype.keyActionHandle=function(e,i,r){if(!(this.calendarElement===null&&e.action==="escape")){var n=this.tableBodyElement.querySelector("tr td.e-focused-date"),s;r?!g(n)&&+i===parseInt(n.getAttribute("id").split("_")[0],10)?s=n:s=this.tableBodyElement.querySelector("tr td.e-selected"):s=this.tableBodyElement.querySelector("tr td.e-selected");var a=this.getViewNumber(this.currentView()),l=this.getViewNumber(this.depth),h=a===l&&this.getViewNumber(this.start)>=l;switch(this.effect="",e.action){case"moveLeft":this.getModuleName()!=="daterangepicker"&&!g(e.target)&&(this.keyboardNavigate(-1,a,e,this.max,this.min),e.preventDefault());break;case"moveRight":this.getModuleName()!=="daterangepicker"&&!g(e.target)&&(this.keyboardNavigate(1,a,e,this.max,this.min),e.preventDefault());break;case"moveUp":this.getModuleName()!=="daterangepicker"&&!g(e.target)&&(a===0?this.keyboardNavigate(-7,a,e,this.max,this.min):this.keyboardNavigate(-4,a,e,this.max,this.min),e.preventDefault());break;case"moveDown":this.getModuleName()!=="daterangepicker"&&!g(e.target)&&(a===0?this.keyboardNavigate(7,a,e,this.max,this.min):this.keyboardNavigate(4,a,e,this.max,this.min),e.preventDefault());break;case"select":if(e.target===this.headerTitleElement)this.navigateTitle(e);else if(e.target===this.previousIcon&&!e.target.className.includes(lr))this.navigatePrevious(e);else if(e.target===this.nextIcon&&!e.target.className.includes(lr))this.navigateNext(e);else if(e.target===this.todayElement&&!e.target.className.includes(lr))this.todayButtonClick(e,i),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus());else{var c=g(n)?s:n;if(!g(c)&&!c.classList.contains(lr))if(h){var u=new Date(parseInt(""+c.id,0));this.selectDate(e,u,c),(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(this.isAngular?this.inputElement.focus():this.element.focus())}else e.target.className.includes(lr)||this.contentClick(null,--a,c,i)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":(!g(n)&&!h||!g(s)&&!h)&&this.contentClick(null,--a,n||s,i),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),se(this.tableBodyElement),a===0?this.renderMonths(e):a===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,a),se(this.tableBodyElement),a===0?this.renderMonths(e):a===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault();break;case"tab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&e.target===this.todayElement&&(e.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"shiftTab":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&e.target===this.headerTitleElement&&(e.preventDefault(),this.isAngular?this.inputElement.focus():this.element.focus(),this.hide());break;case"escape":(this.getModuleName()==="datepicker"||this.getModuleName()==="datetimepicker")&&(e.target===this.headerTitleElement||e.target===this.previousIcon||e.target===this.nextIcon||e.target===this.todayElement)&&this.hide();break}}},t.prototype.keyboardNavigate=function(e,i,r,n,s){var a=new Date(this.checkValue(this.currentDate));switch(i){case 2:this.addYears(this.currentDate,e),this.isMonthYearRange(this.currentDate)?(se(this.tableBodyElement),this.renderDecades(r)):this.currentDate=a;break;case 1:this.addMonths(this.currentDate,e),this.calendarMode==="Gregorian"?this.isMonthYearRange(this.currentDate)?(se(this.tableBodyElement),this.renderYears(r)):this.currentDate=a:this.isMonthYearRange(this.currentDate)?(se(this.tableBodyElement),this.renderYears(r)):this.currentDate=a;break;case 0:this.addDay(this.currentDate,e,r,n,s),this.isMinMaxRange(this.currentDate)?(se(this.tableBodyElement),this.renderMonths(r)):this.currentDate=a;break}},t.prototype.preRender=function(e){var i=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(r){i.triggerNavigate(r)}},t.prototype.minMaxDate=function(e){var i=new Date(new Date(+e).setHours(0,0,0,0)),r=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return(+i==+r||+i==+n)&&(+e<+this.min&&(e=new Date(+this.min)),+e>+this.max&&(e=new Date(+this.max))),e},t.prototype.renderMonths=function(e,i,r){var n=this.weekNumber?8:7,s;this.calendarMode==="Gregorian"?s=this.renderDays(this.currentDate,i,null,null,r,e):s=g(this.islamicModule)?null:this.islamicModule.islamicRenderDays(this.currentDate,i),this.createContentHeader(),this.calendarMode==="Gregorian"?this.renderTemplate(s,n,zI,e,i):g(this.islamicModule)||this.islamicModule.islamicRenderTemplate(s,n,zI,e,i)},t.prototype.renderDays=function(e,i,r,n,s,a){var l=[],h=42,c=s?new Date(+e):this.getDate(new Date,this.timezone),u=new Date(this.checkValue(e)),d,p=u.getMonth();this.titleUpdate(e,"days");var f=u;for(u=new Date(f.getFullYear(),f.getMonth(),0,f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds());u.getDay()!==this.firstDayOfWeek;)this.setStartDate(u,-1*PI);for(var v=0;v<h;++v){var m=this.createElement("td",{className:GF}),y=this.createElement("span");if(v%7===0&&this.weekNumber){var b=this.weekRule==="FirstDay"?6:this.weekRule==="FirstFourDayWeek"?3:0,S=new Date(u.getFullYear(),u.getMonth(),u.getDate()+b);y.textContent=""+this.getWeek(S),m.appendChild(y),X([m],""+Vf),l.push(m)}d=new Date(+u),u=this.minMaxDate(u);var C={type:"dateTime",skeleton:"full"},x=this.globalize.parseDate(this.globalize.formatDate(u,C),C),I=this.dayCell(u),D=this.globalize.formatDate(u,{type:"date",skeleton:"full"}),M=this.createElement("span");M.textContent=this.globalize.formatDate(u,{format:"d",type:"date",skeleton:"yMd"});var E=this.min>u||this.max<u;E?(X([I],lr),X([I],bh)):M.setAttribute("title",""+D),p!==u.getMonth()&&(X([I],xa),M.setAttribute("aria-disabled","true")),(u.getDay()===0||u.getDay()===6)&&X([I],nW),I.appendChild(M),this.renderDayCellArgs={date:u,isDisabled:!1,element:I,isOutOfRange:E};var A=this.renderDayCellArgs;if(this.renderDayCellEvent(A),A.isDisabled){var L=new Date(this.checkValue(i)),N=new Date(this.checkValue(A.date));if(r){if(!g(n)&&n.length>0)for(var R=0;R<n.length;R++){var P=+new Date(this.globalize.formatDate(A.date,{type:"date",skeleton:"yMd"})),k=+new Date(this.globalize.formatDate(n[R],{type:"date",skeleton:"yMd"}));P===k&&(n.splice(R,1),R=-1)}}else L&&+L==+N&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!I.classList.contains(En)&&(X([I],lr),X([I],bh),M.setAttribute("aria-disabled","true"),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var B=I.classList.contains(xa),F=I.classList.contains(lr);F||T.add(I,"click",this.clickHandler,this);var O=void 0;if(!g(a)&&a.type==="click"&&(O=a.currentTarget),r&&!g(n)&&!F){for(var z=0;z<n.length;z++){var Y=this.calendarMode==="Gregorian"?"gregorian":"islamic",K={format:null,type:"date",skeleton:"short",calendar:Y},P=this.globalize.formatDate(u,K),k=this.globalize.formatDate(n[z],K);if((P===k&&this.getDateVal(u,n[z])||this.getDateVal(u,i))&&X([I],En),!g(O)&&O.innerText===I.innerText&&this.previousDates&&I.classList.contains(En)&&O.classList.contains(En)){Z([I],En),this.previousDates=!1;for(var U=this.copyValues(n),q=0;q<U.length;q++){var ae=this.calendarMode==="Gregorian"?"gregorian":"islamic",te={format:null,type:"date",skeleton:"short",calendar:ae},he=this.globalize.formatDate(x,te),ue=this.globalize.formatDate(U[q],te);if(he===ue){var R=U.indexOf(U[q]);U.splice(R,1),n.splice(R,1)}}this.setProperties({values:U},!0)}else this.updateFocus(B,F,u,I,e)}n.length<=0&&this.updateFocus(B,F,u,I,e)}else!F&&this.getDateVal(u,i)&&X([I],En);this.updateFocus(B,F,u,I,e),!g(x)&&x.getFullYear()===c.getFullYear()&&x.getMonth()===c.getMonth()&&x.getDate()===c.getDate()&&X([I],qF),l.push(this.renderDayCellArgs.element),u=new Date(+d),this.addDay(u,1,null,this.max,this.min)}return l},t.prototype.updateFocus=function(e,i,r,n,s){s.getDate()===r.getDate()&&!e&&!i?X([n],zs):(s>=this.max&&parseInt(n.id,0)===+this.max&&!e&&!i&&X([n],zs),s<=this.min&&parseInt(n.id,0)===+this.min&&!e&&!i&&X([n],zs))},t.prototype.renderYears=function(e,i){this.removeTableHeadElement();var r=4,n=[],s=g(i),a=new Date(this.checkValue(this.currentDate)),l=a.getMonth(),h=a.getFullYear(),c=a,u=c.getFullYear(),d=new Date(this.checkValue(this.min)).getFullYear(),p=new Date(this.checkValue(this.min)).getMonth(),f=new Date(this.checkValue(this.max)).getFullYear(),v=new Date(this.checkValue(this.max)).getMonth();c.setMonth(0),this.titleUpdate(this.currentDate,"months"),c.setDate(1);for(var m=0;m<12;++m){var y=this.dayCell(c),b=this.createElement("span"),S=i&&i.getMonth()===c.getMonth(),C=i&&i.getFullYear()===h&&S,x=this.globalize.formatDate(c,{type:"date",format:"MMM y"});b.textContent=this.toCapitalize(this.globalize.formatDate(c,{format:null,type:"dateTime",skeleton:"MMM"})),this.min&&(u<d||m<p&&u===d)||this.max&&(u>f||m>v&&u>=f)?X([y],lr):!s&&C?X([y],En):c.getMonth()===l&&this.currentDate.getMonth()===l&&X([y],zs),c.setDate(1),c.setMonth(c.getMonth()+1),y.classList.contains(lr)||(T.add(y,"click",this.clickHandler,this),b.setAttribute("title",""+x)),y.appendChild(b),n.push(y)}this.renderTemplate(n,r,OI,e,i)},t.prototype.renderDecades=function(e,i){this.removeTableHeadElement();var r=4,n=12,s=[],a=new Date(this.checkValue(this.currentDate));a.setMonth(0),a.setDate(1);var l=a.getFullYear(),h=new Date(a.setFullYear(l-l%10)),c=new Date(a.setFullYear(l-l%10+9)),u=h.getFullYear(),d=c.getFullYear(),p=this.globalize.formatDate(h,{format:null,type:"dateTime",skeleton:"y"}),f=this.globalize.formatDate(c,{format:null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=p+" - "+f;for(var v=new Date(l-l%10-1,0,1),m=v.getFullYear(),y=0;y<n;++y){var b=m+y;a.setFullYear(b);var S=this.dayCell(a),C=this.createElement("span");C.textContent=this.globalize.formatDate(a,{format:null,type:"dateTime",skeleton:"y"}),b<u||b>d?(X([S],RI),C.setAttribute("aria-disabled","true"),!g(i)&&a.getFullYear()===i.getFullYear()&&X([S],En),(b<new Date(this.checkValue(this.min)).getFullYear()||b>new Date(this.checkValue(this.max)).getFullYear())&&X([S],lr)):b<new Date(this.checkValue(this.min)).getFullYear()||b>new Date(this.checkValue(this.max)).getFullYear()?X([S],lr):!g(i)&&a.getFullYear()===i.getFullYear()?X([S],En):a.getFullYear()===this.currentDate.getFullYear()&&!S.classList.contains(lr)&&X([S],zs),S.classList.contains(lr)||(T.add(S,"click",this.clickHandler,this),C.setAttribute("title",""+C.textContent)),S.appendChild(C),s.push(S)}this.renderTemplate(s,r,"e-decade",e,i)},t.prototype.dayCell=function(e){var i=this.calendarMode==="Gregorian"?"gregorian":"islamic",r={skeleton:"full",type:"dateTime",calendar:i},n=this.globalize.parseDate(this.globalize.formatDate(e,r),r),s;g(n)||(s=n.valueOf());var a={className:GF,attrs:{id:""+Lt(""+s)}};return this.createElement("td",a)},t.prototype.firstDay=function(e){var i=this.currentView()!=="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+xa+"):not(."+Vf+")"):this.tableBodyElement.querySelectorAll("td:not(."+RI);if(i.length){for(var r=0;r<i.length;r++)if(!i[r].classList.contains(lr)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.lastDay=function(e,i){var r=new Date(e.getFullYear(),e.getMonth()+1,0);if(i!==2){var n=Math.abs(r.getTimezoneOffset()-this.firstDay(e).getTimezoneOffset());return n&&r.setHours(this.firstDay(e).getHours()+n/60),this.findLastDay(r)}else return this.findLastDay(this.firstDay(r))},t.prototype.checkDateValue=function(e){return!g(e)&&e instanceof Date&&!isNaN(+e)?e:null},t.prototype.findLastDay=function(e){var i=this.currentView()==="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+RI):this.tableBodyElement.querySelectorAll("td:not(."+xa+"):not(."+Vf+")");if(i.length){for(var r=i.length-1;r>=0;r--)if(!i[r].classList.contains(lr)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.removeTableHeadElement=function(){this.getModuleName()==="calendar"?g(this.element.querySelectorAll(".e-content table thead")[0])||se(this.tableHeadElement):g(this.calendarElement.querySelectorAll(".e-content table thead")[0])||se(this.tableHeadElement)},t.prototype.renderTemplate=function(e,i,r,n,s){var a=this.getViewNumber(this.currentView()),l;this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),Z([this.contentElement,this.headerElement],[zI,UF,OI]),X([this.contentElement,this.headerElement],[r]);for(var h=41,c=35,u=6,d=i,p=0,f=0;f<e.length/i;++f){for(l=this.createElement("tr"),p=0+p;p<d;p++)!e[p].classList.contains("e-week-number")&&!g(e[p].children[0])&&(X([e[p].children[0]],[YF]),Wi(e[p].children[0],{duration:600,isCenterRipple:!0})),l.appendChild(e[p]),this.weekNumber&&p===u+1&&e[u+1].classList.contains(xa)&&X([l],Oy),!this.weekNumber&&p===u&&e[u].classList.contains(xa)&&X([l],Oy),this.weekNumber?p===h&&e[h].classList.contains(xa)&&X([l],Oy):p===c&&e[c].classList.contains(xa)&&X([l],Oy);d=d+i,p=p+0,this.tableBodyElement.appendChild(l)}this.table.querySelector("tbody").className=this.effect,this.calendarMode==="Gregorian"?this.iconHandler():this.islamicModule.islamicIconHandler(),(a!==this.getViewNumber(this.currentView())||a===0&&a!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()},t.prototype.clickHandler=function(e,i){this.clickEventEmitter(e);var r=e.currentTarget,n=this.getViewNumber(this.currentView());r.classList.contains(xa)?this.contentClick(e,0,null,i):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(e,1,null,i):n===2?this.contentClick(e,1,null,i):!r.classList.contains(xa)&&n===0?this.selectDate(e,this.getIdValue(e,null),null):this.contentClick(e,0,r,i),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.clickEventEmitter=function(e){e.preventDefault()},t.prototype.contentClick=function(e,i,r,n){var s=this.getViewNumber(this.currentView()),a=this.getIdValue(e,r);switch(i){case 0:s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?(se(this.tableBodyElement),this.currentDate=a,this.effect=zy,this.renderMonths(e)):(this.calendarMode==="Gregorian"?(this.currentDate.setMonth(a.getMonth()),a.getMonth()>0&&this.currentDate.getMonth()!==a.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(a.getFullYear())):this.currentDate=a,this.effect=zy,se(this.tableBodyElement),this.renderMonths(e));break;case 1:if(s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,a,null);else{if(this.calendarMode==="Gregorian")this.currentDate.setFullYear(a.getFullYear());else{this.islamicPreviousHeader=this.headerElement.textContent;var l=this.islamicModule.getIslamicDate(a);this.currentDate=this.islamicModule.toGregorian(l.year,l.month,1)}this.effect=zy,se(this.tableBodyElement),this.renderYears(e)}}},t.prototype.switchView=function(e,i,r,n){switch(e){case 0:se(this.tableBodyElement),this.renderMonths(i,null,n);break;case 1:se(this.tableBodyElement),this.renderYears(i);break;case 2:se(this.tableBodyElement),this.renderDecades(i)}},t.prototype.getModuleName=function(){return"calendar"},t.prototype.requiredModules=function(){var e=[];return this.calendarMode==="Islamic"&&e.push({args:[this],member:"islamic",name:"Islamic"}),e},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i,r,n){this.effect="";for(var s=0,a=Object.keys(e);s<a.length;s++){var l=a[s];switch(l){case"enableRtl":e.enableRtl?this.getModuleName()==="calendar"?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):this.getModuleName()==="calendar"?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.getModuleName()!=="datepicker"?this.createContentHeader():this.calendarElement&&this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),l==="min"?this.setProperties({min:this.checkDateValue(new Date(this.checkValue(e.min)))},!0):this.setProperties({max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.setProperties({start:this.currentView()},!0),this.tableBodyElement&&se(this.tableBodyElement),this.minMaxUpdate(),r&&this.validateValues(r,n),this.getModuleName()!=="datepicker"?this.createContentBody():this.calendarElement&&this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?(se(this.todayElement),se(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&(Z([this.todayElement],lr),se(this.todayElement),se(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody());break;case"locale":if(this.globalize=new Nt(this.locale),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody()),this.getModuleName()==="calendar"){var h={today:"Today"};this.l10=new Ri(this.getModuleName(),h,this.locale)}this.l10.setLocale(this.locale),this.showTodayButton&&this.updateFooter();break;case"showTodayButton":e.showTodayButton?this.createContentFooter():!g(this.todayElement)&&!g(this.footer)&&(se(this.todayElement),se(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:e.showTodayButton},!0);break}}},t.prototype.validateValues=function(e,i){if(e&&!g(i)&&i.length>0){for(var r=this.copyValues(i),n=0;n<r.length;n++){var s=r[n],a=this.calendarMode==="Gregorian"?"gregorian":"islamic",l=void 0,h=void 0,c=void 0;this.calendarMode==="Gregorian"?(l={type:"date",skeleton:"yMd"},h=this.globalize.formatDate(s,l),c=this.globalize.parseDate(h,l)):(l={type:"date",skeleton:"yMd",calendar:"islamic"},h=this.globalize.formatDate(s,l),c=this.globalize.parseDate(h,l));var u={type:"date",skeleton:"yMd",calendar:a},d=this.globalize.formatDate(this.min,u),p=d,f={type:"date",skeleton:"yMd",calendar:a},v=this.globalize.formatDate(this.max,f),m=v,y=this.globalize.parseDate(p,u),b=this.globalize.parseDate(m,f);(+c<+y||+c>+b)&&(r.splice(n,1),n=-1)}this.setProperties({values:r},!0)}},t.prototype.setValueUpdate=function(){g(this.tableBodyElement)||(se(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())},t.prototype.copyValues=function(e){var i=[];if(!g(e)&&e.length>0)for(var r=0;r<e.length;r++)i.push(new Date(+e[r]));return i},t.prototype.titleUpdate=function(e,i){var r=new Nt(this.locale),n,s,a=this.calendarMode==="Gregorian"?"gregorian":"islamic";switch(this.calendarMode==="Gregorian"?(n=r.formatDate(e,{type:"dateTime",skeleton:"yMMMM",calendar:a}),s=r.formatDate(e,{format:null,type:"dateTime",skeleton:"y",calendar:a})):(n=r.formatDate(e,{type:"dateTime",format:"MMMM y",calendar:a}),s=r.formatDate(e,{type:"dateTime",format:"y",calendar:a})),i){case"days":this.headerTitleElement.textContent=this.toCapitalize(n);break;case"months":this.headerTitleElement.textContent=s}},t.prototype.setActiveDescendant=function(){var e,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s,a=this.currentView();return a==="Month"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"full",calendar:n}):a==="Year"?n!=="islamic"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"yMMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"GyMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{format:null,type:"date",skeleton:"y",calendar:n}),(r||i)&&(g(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",s),e=(i||r).getAttribute("id")),e},t.prototype.iconHandler=function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}},t.prototype.destroy=function(){this.getModuleName()==="calendar"&&this.element?Z([this.element],[Hf]):this.calendarElement&&this.element&&Z([this.element],[Hf]),this.getModuleName()==="calendar"&&this.element&&(g(this.headerTitleElement)||T.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&T.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),g(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element&&(this.element.innerHTML=""),this.todayElement=null,this.tableBodyElement=null,this.todayButtonEvent=null,this.renderDayCellArgs=null,this.headerElement=null,this.nextIcon=null,this.table=null,this.tableHeadElement=null,this.previousIcon=null,this.headerTitleElement=null,this.footer=null,this.contentElement=null,o.prototype.destroy.call(this)},t.prototype.title=function(e){var i=this.getViewNumber(this.currentView());this.effect=zy,this.switchView(++i,e)},t.prototype.getViewNumber=function(e){return e==="Month"?0:e==="Year"?1:2},t.prototype.navigateTitle=function(e){e.preventDefault(),this.title(e)},t.prototype.previous=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(e);break}},t.prototype.navigatePrevious=function(e){!j.isDevice&&e.preventDefault(),this.calendarMode==="Gregorian"?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e)},t.prototype.next=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(e);break}},t.prototype.navigateNext=function(e){!j.isDevice&&e.preventDefault(),this.calendarMode==="Gregorian"?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(e)},t.prototype.navigateTo=function(e,i,r){+i>=+this.min&&+i<=+this.max&&(this.currentDate=i),+i<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+i>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(e)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(e))&&(e=this.depth),this.switchView(this.getViewNumber(e),null,null,r)},t.prototype.currentView=function(){return!g(this.contentElement)&&this.contentElement.classList.contains(OI)?"Year":!g(this.contentElement)&&this.contentElement.classList.contains(UF)?"Decade":"Month"},t.prototype.getDateVal=function(e,i){return!g(i)&&e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()},t.prototype.getCultureObjects=function(e,i){var r=g(this.dayHeaderFormat)?null:".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),n=g(this.dayHeaderFormat)?null:".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase(),s="main.";return this.calendarMode==="Gregorian"?V(s+""+this.locale+r,e):V("main."+this.locale+n,e)},t.prototype.getWeek=function(e){var i=new Date(this.checkValue(e)).valueOf(),r=new Date(e.getFullYear(),0,1).valueOf();return Math.ceil((i-r+PI)/PI/7)},t.prototype.setStartDate=function(e,i){var r=e.getTimezoneOffset(),n=new Date(e.getTime()+i),s=n.getTimezoneOffset()-r;e.setTime(n.getTime()+s*dW)},t.prototype.addMonths=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setMonth(e.getMonth()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+i,1)}},t.prototype.addYears=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setFullYear(e.getFullYear()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year+i,n.month,1)}},t.prototype.getIdValue=function(e,i){var r;e?r=e.currentTarget:r=i;var n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s={type:"dateTime",skeleton:"full",calendar:n},a=this.globalize.formatDate(new Date(parseInt(""+r.getAttribute("id"),0)),s),l=this.globalize.parseDate(a,s),h=l.valueOf()-l.valueOf()%1e3;return new Date(h)},t.prototype.adjustLongHeaderSize=function(){Z([this.element],QF),this.dayHeaderFormat==="Wide"&&X([this.getModuleName()==="calendar"?this.element:this.calendarElement],QF)},t.prototype.selectDate=function(e,i,r,n,s){var a=r||e.currentTarget;if(this.isDateSelected=!1,this.currentView()==="Decade")this.setDateDecade(this.currentDate,i.getFullYear());else if(this.currentView()==="Year")this.setDateYear(this.currentDate,i);else{if(n&&!this.checkPresentDate(i,s)){var l=this.copyValues(s);!g(s)&&l.length>0?(l.push(new Date(this.checkValue(i))),this.setProperties({values:l},!0),this.setProperties({value:s[s.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(i))]},!0)}else this.setProperties({value:new Date(this.checkValue(i))},!0);this.currentDate=new Date(this.checkValue(i))}var h=H(a,"."+Hf);if(g(h)&&(h=this.tableBodyElement),!n&&!g(h.querySelector("."+En))&&Z([h.querySelector("."+En)],En),!n&&!g(h.querySelector("."+zs))&&Z([h.querySelector("."+zs)],zs),!n&&!g(h.querySelector("."+Ic))&&Z([h.querySelector("."+Ic)],Ic),n){for(var l=this.copyValues(s),c=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),u=0;u<c.length;u++){var d=h.querySelectorAll("td."+zs)[0],p=h.querySelectorAll("td."+En)[0];c[u]===d&&Z([c[u]],zs),c[u]===p&&!this.checkPresentDate(new Date(parseInt(p.getAttribute("id").split("_")[0],10)),s)&&Z([c[u]],En)}if(a.classList.contains(En)){Z([a],En);for(var f=0;f<l.length;f++){var v=this.calendarMode==="Gregorian"?"gregorian":"islamic",m={format:null,type:"date",skeleton:"short",calendar:v},y=this.globalize.formatDate(i,m),b=this.globalize.formatDate(l[f],m);if(y===b){var u=l.indexOf(l[f]);l.splice(u,1),X([a],zs)}}this.setProperties({values:l},!0)}else X([a],En)}else X([a],En);this.isDateSelected=!0},t.prototype.checkPresentDate=function(e,i){var r=!1;if(!g(i))for(var n=0;n<i.length;n++){var s=this.calendarMode==="Gregorian"?"gregorian":"islamic",a=this.globalize.formatDate(e,{format:null,type:"date",skeleton:"short",calendar:s}),l=this.globalize.formatDate(i[n],{format:null,type:"date",skeleton:"short",calendar:s});a===l&&(r=!0)}return r},t.prototype.setAriaActiveDescendant=function(){Ee(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})},t.prototype.previousIconHandler=function(e){e?g(this.previousIcon)||(T.remove(this.previousIcon,"click",this.navigatePreviousHandler),X([this.previousIcon],""+lr),X([this.previousIcon],""+bh),this.previousIcon.setAttribute("aria-disabled","true")):(T.add(this.previousIcon,"click",this.navigatePreviousHandler),Z([this.previousIcon],""+lr),Z([this.previousIcon],""+bh),this.previousIcon.setAttribute("aria-disabled","false"))},t.prototype.renderDayCellEvent=function(e){pe(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)},t.prototype.navigatedEvent=function(e){pe(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)},t.prototype.triggerNavigate=function(e){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(e)},t.prototype.nextIconHandler=function(e){e?g(this.previousIcon)||(T.remove(this.nextIcon,"click",this.navigateNextHandler),X([this.nextIcon],lr),X([this.nextIcon],bh),this.nextIcon.setAttribute("aria-disabled","true")):(T.add(this.nextIcon,"click",this.navigateNextHandler),Z([this.nextIcon],lr),Z([this.nextIcon],bh),this.nextIcon.setAttribute("aria-disabled","false"))},t.prototype.compare=function(e,i,r){var n=i.getFullYear(),s,a;return s=n,a=0,r&&(n=n-n%r,s=n-n%r+r-1),e.getFullYear()>s?a=1:e.getFullYear()<n&&(a=-1),a},t.prototype.isMinMaxRange=function(e){return+e>=+this.min&&+e<=+this.max},t.prototype.isMonthYearRange=function(e){if(this.calendarMode==="Gregorian")return e.getMonth()>=this.min.getMonth()&&e.getFullYear()>=this.min.getFullYear()&&e.getMonth()<=this.max.getMonth()&&e.getFullYear()<=this.max.getFullYear();var i=this.islamicModule.getIslamicDate(e);return i.month>=this.islamicModule.getIslamicDate(new Date(1941,12,18)).month&&i.year>=this.islamicModule.getIslamicDate(new Date(1941,12,18)).year&&i.month<=this.islamicModule.getIslamicDate(new Date(2068,2,4)).month&&i.year<=this.islamicModule.getIslamicDate(new Date(2068,2,4)).year},t.prototype.compareYear=function(e,i){return this.compare(e,i,0)},t.prototype.compareDecade=function(e,i){return this.compare(e,i,10)},t.prototype.shiftArray=function(e,i){return e.slice(i).concat(e.slice(0,i))},t.prototype.addDay=function(e,i,r,n,s){var a=i,l=new Date(+e);if(!g(this.tableBodyElement)&&!g(r)){for(;this.findNextTD(new Date(+e),a,n,s);)a+=i;var h=new Date(l.setDate(l.getDate()+a));a=+h>+n||+h<+s?a===i?i-i:i:a}e.setDate(e.getDate()+a)},t.prototype.findNextTD=function(e,i,r,n){var s=new Date(e.setDate(e.getDate()+i)),a=[],l=!1;if((!g(s)&&s.getMonth())===(!g(this.currentDate)&&this.currentDate.getMonth())){var h=void 0;this.calendarMode==="Gregorian"?h=this.renderDays(s):h=this.islamicModule.islamicRenderDays(this.currentDate,s),a=h.filter(function(u){return u.classList.contains(lr)})}else a=this.tableBodyElement.querySelectorAll("td."+lr);if(+s<=+r&&+s>=+n&&a.length)for(var c=0;c<a.length&&(l=+s==+new Date(parseInt(a[c].id,0)),!l);c++);return l},t.prototype.getMaxDays=function(e){var i,r=new Date(this.checkValue(e));i=28;for(var n=r.getMonth();r.getMonth()===n;)++i,r.setDate(i);return i-1},t.prototype.setDateDecade=function(e,i){e.setFullYear(i),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.setDateYear=function(e,i){e.setFullYear(i.getFullYear(),i.getMonth(),e.getDate()),i.getMonth()!==e.getMonth()&&(e.setDate(0),this.currentDate=new Date(this.checkValue(i))),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.compareMonth=function(e,i){var r;return e.getFullYear()>i.getFullYear()?r=1:e.getFullYear()<i.getFullYear()?r=-1:r=e.getMonth()===i.getMonth()?0:e.getMonth()>i.getMonth()?1:-1,r},t.prototype.checkValue=function(e){return e instanceof Date?e.toUTCString():""+e},t.prototype.checkView=function(){this.start!=="Decade"&&this.start!=="Year"&&this.setProperties({start:"Month"},!0),this.depth!=="Decade"&&this.depth!=="Year"&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)},t.prototype.getDate=function(e,i){return i&&(e=new Date(e.toLocaleString("en-US",{timeZone:i}))),e},Ir([w(new Date(1900,0,1))],t.prototype,"min",void 0),Ir([w(!0)],t.prototype,"enabled",void 0),Ir([w(null)],t.prototype,"cssClass",void 0),Ir([w(new Date(2099,11,31))],t.prototype,"max",void 0),Ir([w(null)],t.prototype,"firstDayOfWeek",void 0),Ir([w("Gregorian")],t.prototype,"calendarMode",void 0),Ir([w("Month")],t.prototype,"start",void 0),Ir([w("Month")],t.prototype,"depth",void 0),Ir([w(!1)],t.prototype,"weekNumber",void 0),Ir([w("FirstDay")],t.prototype,"weekRule",void 0),Ir([w(!0)],t.prototype,"showTodayButton",void 0),Ir([w("Short")],t.prototype,"dayHeaderFormat",void 0),Ir([w(!1)],t.prototype,"enablePersistence",void 0),Ir([w(null)],t.prototype,"keyConfigs",void 0),Ir([w(null)],t.prototype,"serverTimezoneOffset",void 0),Ir([G()],t.prototype,"created",void 0),Ir([G()],t.prototype,"destroyed",void 0),Ir([G()],t.prototype,"navigated",void 0),Ir([G()],t.prototype,"renderDayCell",void 0),t=Ir([It],t),t})(ti),fW=(function(o){aR(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.render=function(){if(this.calendarMode==="Islamic"&&this.islamicModule===void 0&&lc("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&typeof this.values=="object"&&!g(this.values)&&this.values.length>0){for(var e=[],i=[],r=0;r<this.values.length;r++)e.indexOf(+this.values[r])===-1&&(e.push(+this.values[r]),i.push(this.values[r]));this.setProperties({values:i},!0);for(var n=0;n<this.values.length;n++)if(!this.checkDateValue(this.values[n]))if(typeof this.values[n]=="string"&&this.checkDateValue(new Date(this.checkValue(this.values[n])))){var s=new Date(this.checkValue(this.values[n]));this.values.splice(n,1),this.values.splice(n,0,s)}else this.values.splice(n,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),this.getModuleName()==="calendar"&&(this.setEnable(this.enabled),this.setClass(this.cssClass)),o.prototype.render.call(this),this.getModuleName()==="calendar"){var a=H(this.element,"form");a&&T.add(a,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()},t.prototype.setEnable=function(e){e?Z([this.element],lr):X([this.element],lr)},t.prototype.setClass=function(e,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(e)||(e=e.replace(/\s+/g," ").trim()),!g(i)&&i!==""&&Z([this.element],i.split(" ")),g(e)||X([this.element],e.split(" "))},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(i,e)},t.prototype.setTimeZone=function(e){if(!g(this.serverTimezoneOffset)&&this.value){var i=e,r=new Date().getTimezoneOffset()/60,n=i+r;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3)}},t.prototype.formResetHandler=function(){this.setProperties({value:null},!0)},t.prototype.validateDate=function(){typeof this.value=="string"&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),o.prototype.validateDate.call(this,this.value),!g(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)},t.prototype.minMaxUpdate=function(){this.getModuleName()==="calendar"&&(!g(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!g(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),this.getModuleName()!=="calendar"&&!g(this.value)?!g(this.value)&&this.value<this.min&&this.min<=this.max?o.prototype.minMaxUpdate.call(this,this.min):!g(this.value)&&this.value>this.max&&this.min<=this.max&&o.prototype.minMaxUpdate.call(this,this.max):o.prototype.minMaxUpdate.call(this,this.value)},t.prototype.generateTodayVal=function(e){var i=new Date;return g(this.timezone)||(i=o.prototype.getDate.call(this,i,this.timezone)),e&&g(this.timezone)?(i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()),i.setMilliseconds(e.getMilliseconds())):i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0),i},t.prototype.todayButtonClick=function(e){if(this.showTodayButton){var i=this.generateTodayVal(this.value);if(this.setProperties({value:i},!0),this.isTodayClicked=!0,this.todayButtonEvent=e,this.isMultiSelection){var r=this.copyValues(this.values);o.prototype.checkPresentDate.call(this,i,this.values)||(r.push(i),this.setProperties({values:r}))}o.prototype.todayButtonClick.call(this,e,new Date(+this.value))}},t.prototype.keyActionHandle=function(e){o.prototype.keyActionHandle.call(this,e,this.value,this.isMultiSelection)},t.prototype.preRender=function(){var e=this;this.changeHandler=function(i){e.triggerChange(i)},this.checkView(),o.prototype.preRender.call(this,this.value)},t.prototype.createContent=function(){this.previousDate=this.value,this.previousDateTime=this.value,o.prototype.createContent.call(this)},t.prototype.minMaxDate=function(e){return o.prototype.minMaxDate.call(this,e)},t.prototype.renderMonths=function(e,i,r){o.prototype.renderMonths.call(this,e,this.value,r)},t.prototype.renderDays=function(e,i,r,n,s,a){var l=o.prototype.renderDays.call(this,e,this.value,this.isMultiSelection,this.values,s,a);return this.isMultiSelection&&o.prototype.validateValues.call(this,this.isMultiSelection,this.values),l},t.prototype.renderYears=function(e){this.calendarMode==="Gregorian"?o.prototype.renderYears.call(this,e,this.value):this.islamicModule.islamicRenderYears(e,this.value)},t.prototype.renderDecades=function(e){this.calendarMode==="Gregorian"?o.prototype.renderDecades.call(this,e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)},t.prototype.renderTemplate=function(e,i,r,n){this.calendarMode==="Gregorian"?o.prototype.renderTemplate.call(this,e,i,r,n,this.value):this.islamicModule.islamicRenderTemplate(e,i,r,n,this.value),this.changedArgs={value:this.value,values:this.values},n&&n.type==="click"&&n.currentTarget.classList.contains(xa)?this.changeHandler(n):this.changeHandler()},t.prototype.clickHandler=function(e){var i=e.currentTarget;if(this.isPopupClicked=!0,i.classList.contains(xa))if(this.isMultiSelection){var r=this.copyValues(this.values);r.toString().indexOf(this.getIdValue(e,null).toString())===-1?(r.push(this.getIdValue(e,null)),this.setProperties({values:r},!0),this.setProperties({value:this.values[this.values.length-1]},!0)):this.previousDates=!0}else this.setProperties({value:this.getIdValue(e,null)},!0);var n=this.currentView();o.prototype.clickHandler.call(this,e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!g(this.tableBodyElement.querySelectorAll("."+zs)[0])&&n==="Year"&&this.tableBodyElement.querySelectorAll("."+zs)[0].classList.remove(zs)},t.prototype.switchView=function(e,i,r,n){o.prototype.switchView.call(this,e,i,this.isMultiSelection,n)},t.prototype.getModuleName=function(){return o.prototype.getModuleName.call(this),"calendar"},t.prototype.getPersistData=function(){o.prototype.getPersistData.call(this);var e=["value","values"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){this.effect="",this.rangeValidation(this.min,this.max);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"value":this.isDateSelected&&(typeof e.value=="string"?this.setProperties({value:new Date(this.checkValue(e.value))},!0):e.value=new Date(this.checkValue(e.value)),isNaN(+this.value)&&this.setProperties({value:i.value},!0),this.update());break;case"values":if(this.isDateSelected){if(typeof e.values=="string"||typeof e.values=="number")this.setProperties({values:null},!0);else{for(var a=this.copyValues(this.values),l=0;l<a.length;l++){var h=a[l];this.checkDateValue(h)&&!o.prototype.checkPresentDate.call(this,h,a)&&a.push(h)}this.setProperties({values:a},!0),this.values.length>0&&this.setProperties({value:e.values[e.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:e.isMultiSelection},!0),this.update());break;case"enabled":this.setEnable(this.enabled);break;case"cssClass":this.getModuleName()==="calendar"&&this.setClass(e.cssClass,i.cssClass);break;default:o.prototype.onPropertyChanged.call(this,e,i,this.isMultiSelection,this.values)}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},t.prototype.destroy=function(){if(o.prototype.destroy.call(this),this.getModuleName()==="calendar"){this.changedArgs=null;var e=H(this.element,"form");e&&T.remove(e,"reset",this.formResetHandler.bind(this))}},t.prototype.navigateTo=function(e,i,r){this.minMaxUpdate(),o.prototype.navigateTo.call(this,e,i,r)},t.prototype.currentView=function(){return o.prototype.currentView.call(this)},t.prototype.addDate=function(e){if(typeof e!="string"&&typeof e!="number"){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)this.checkDateValue(r[n])&&!o.prototype.checkPresentDate.call(this,r[n],i)&&(!g(i)&&i.length>0?i.push(r[n]):i=[new Date(+r[n])]);else this.checkDateValue(e)&&!o.prototype.checkPresentDate.call(this,e,i)&&(!g(i)&&i.length>0?i.push(e):i=[new Date(+e)]);this.setProperties({values:i},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,i),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.removeDate=function(e){if(typeof e!="string"&&typeof e!="number"&&!g(this.values)&&this.values.length>0){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)for(var s=0;s<i.length;s++)+i[s]==+r[n]&&i.splice(s,1);else for(var s=0;s<i.length;s++)+i[s]==+e&&i.splice(s,1);this.setProperties({values:i},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.setTodayDate=function(e){var i=new Date(+e);this.setProperties({value:i},!0),o.prototype.todayButtonClick.call(this,null,i,!0)},t.prototype.update=function(){this.validateDate(),this.minMaxUpdate(),o.prototype.setValueUpdate.call(this)},t.prototype.selectDate=function(e,i,r){o.prototype.selectDate.call(this,e,i,r,this.isMultiSelection,this.values),this.isMultiSelection&&!g(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)},t.prototype.changeEvent=function(e){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))},t.prototype.triggerChange=function(e){!g(this.todayButtonEvent)&&this.isTodayClicked&&(e=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=e||null,this.changedArgs.isInteracted=!g(e),g(this.value)||this.setProperties({value:this.value},!0),!this.isMultiSelection&&+this.value!==Number.NaN&&(!g(this.value)&&!g(this.previousDate)||this.previousDate===null&&!isNaN(+this.value))?this.changeEvent(e):!g(this.values)&&this.previousValues!==this.values.length&&(this.changeEvent(e),this.previousValues=this.values.length)},Ir([w(null)],t.prototype,"value",void 0),Ir([w(null)],t.prototype,"values",void 0),Ir([w(!1)],t.prototype,"isMultiSelection",void 0),Ir([G()],t.prototype,"change",void 0),t=Ir([It],t),t})(pW);var gW=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Oi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},vW="e-date-wrapper",Py="e-datepicker",mW="e-lib",yW="e-control",XF="e-popup-wrapper",bW="e-input-group-icon",SW="e-popup",CW="e-input-group",BI="e-input-focus",wW="e-input",KF="e-error",By="e-active",$F="e-date-overflow",xW="e-date-icon",IW="e-icons",MW=300,DW=4,jy="e-selected",EW="e-focused-date",jI="e-non-edit",ZF=["title","class","style"],UI=(function(o){gW(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isDateIconClicked=!1,r.isAltKeyPressed=!1,r.isInteracted=!0,r.invalidValueString=null,r.checkPreviousValue=null,r.maskedDateValue="",r.preventChange=!1,r.isIconClicked=!1,r.isDynamicValueChanged=!1,r.moduleName=r.getModuleName(),r.isFocused=!1,r.isBlur=!1,r.isKeyAction=!1,r.datepickerOptions=e,r}return t.prototype.render=function(){this.initialize(),this.bindEvents(),this.floatLabelType!=="Never"&&Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon"),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete(),this.setTimeZone(this.serverTimezoneOffset)},t.prototype.setTimeZone=function(e){if(!g(this.serverTimezoneOffset)&&this.value){var i=new Date().getTimezoneOffset()/60,r=e,n=r+i;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3),this.updateInput(),this.changeTrigger(null)}},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(e,i)},t.prototype.setAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):Ee(this.inputElement,{readonly:""}),this.updateIconState()},t.prototype.updateIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?Z([this.inputWrapper.container],[jI]):X([this.inputWrapper.container],[jI]):this.inputWrapper&&Z([this.inputWrapper.container],[jI])},t.prototype.initialize=function(){this.checkInvalidValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)?(this.updateInput(!0),this.updateInputValue(this.maskedDateValue)):this.enableMask||this.updateInput(!0),this.previousElementValue=this.inputElement.value,this.previousDate=g(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value},t.prototype.createInput=function(){var e={"aria-atomic":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if(this.getModuleName()==="datepicker"){var i={placeholder:this.placeholder};this.globalize=new Nt(this.locale),this.l10n=new Ri("datepicker",i,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}this.fullScreenMode&&j.isDevice&&(this.cssClass+=" e-popup-expand");var r=this.cssClass;!g(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim());var n=!this.enableMask;this.inputWrapper=Ie.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,bindClearAction:n,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:r,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[bW+" "+xW+" "+IW]},this.createElement),this.setWidth(this.width),this.inputElement.name!==""?this.inputElement.setAttribute("name",""+this.inputElement.getAttribute("name")):this.inputElement.setAttribute("name",""+this.element.id),Ee(this.inputElement,e),this.inputElement.hasAttribute("aria-label")||this.inputElement.setAttribute("aria-label",this.getModuleName()),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),Ie.addAttributes({"aria-label":"select",role:"button"},this.inputWrapper.buttons[0]),X([this.inputWrapper.container],vW)},t.prototype.updateInput=function(e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r;if(this.value&&!this.isCalendar()&&this.disabledDates(e,i),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(o.prototype.validateDate.call(this),this.minMaxUpdates(),o.prototype.minMaxUpdate.call(this)),!g(this.value)){var n=this.value,s=void 0,a=g(this.formatString)?this.dateTimeFormat:this.formatString;if(this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?s=this.globalize.formatDate(this.value,{format:a,type:"dateTime",skeleton:"yMd"}):s=this.globalize.formatDate(this.value,{format:a,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s=this.globalize.formatDate(this.value,r)),+n<=+this.max&&+n>=+this.min)this.updateInputValue(s);else{var l=+n>=+this.max||!+this.value||!+this.value||+n<=+this.min;!this.strictMode&&l&&this.updateInputValue(s)}}g(this.value)&&this.strictMode&&(this.enableMask?(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})):this.updateInputValue("")),!this.strictMode&&g(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()},t.prototype.minMaxUpdates=function(){!g(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!g(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})},t.prototype.checkStringValue=function(e){var i=null,r=null,n=null;if(this.getModuleName()==="datetimepicker"){var s=new Nt(this.locale);this.calendarMode==="Gregorian"?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(e),r)),g(i)&&this.getModuleName()==="datetimepicker"&&(i=this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(e),n))),i},t.prototype.checkInvalidValue=function(e){if(!(e instanceof Date)&&!g(e)){var i=null,r=e;typeof e=="number"&&(r=e.toString());var n=null,s=null;if(this.getModuleName()==="datetimepicker"){var a=new Nt(this.locale);this.calendarMode==="Gregorian"?(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},s={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s={format:a.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};var l=!1;if(typeof r!="string")r=null,l=!0;else if(typeof r=="string"&&(r=r.trim()),i=this.checkStringValue(r),!i){var h=null,c=null;h=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,c=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!h.test(r)&&!c.test(r)||/^[a-zA-Z0-9- ]*$/.test(r)||isNaN(+new Date(this.checkValue(r)))?l=!0:i=new Date(r)}l?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0)):this.setProperties({value:i},!0)}},t.prototype.bindInputEvent=function(){(!g(this.formatString)||this.enableMask)&&(this.enableMask||this.formatString.indexOf("y")===-1?T.add(this.inputElement,"input",this.inputHandler,this):T.remove(this.inputElement,"input",this.inputHandler))},t.prototype.bindEvents=function(){T.add(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler,this),T.add(this.inputElement,"mouseup",this.mouseUpHandler,this),T.add(this.inputElement,"focus",this.inputFocusHandler,this),T.add(this.inputElement,"blur",this.inputBlurHandler,this),T.add(this.inputElement,"keyup",this.keyupHandler,this),this.enableMask&&T.add(this.inputElement,"keydown",this.keydownHandler,this),this.bindInputEvent(),T.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&T.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&T.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=pe(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new rr(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.keydownHandler=function(e){switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Backspace":case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&(e.code!=="Delete"&&e.code!=="Backspace"&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}));break}},t.prototype.unBindEvents=function(){g(this.inputWrapper)||T.remove(this.inputWrapper.buttons[0],"mousedown",this.dateIconHandler),T.remove(this.inputElement,"mouseup",this.mouseUpHandler),T.remove(this.inputElement,"focus",this.inputFocusHandler),T.remove(this.inputElement,"blur",this.inputBlurHandler),T.remove(this.inputElement,"change",this.inputChangeHandler),T.remove(this.inputElement,"keyup",this.keyupHandler),this.enableMask&&T.remove(this.inputElement,"keydown",this.keydownHandler),this.showClearButton&&this.inputWrapper.clearButton&&T.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&T.remove(this.formElement,"reset",this.resetFormHandler)},t.prototype.resetFormHandler=function(){if(this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value");(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(e="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(e),this.errorClass())}},t.prototype.restoreValue=function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=g(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})},t.prototype.inputChangeHandler=function(e){this.enabled&&e.stopPropagation()},t.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&T.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){this.enabled&&(e.preventDefault(),this.clear(e))},t.prototype.mouseUpHandler=function(e){this.enableMask&&(e.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.enableMask||this.updateInputValue(""),g(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)));var i={event:e};if(this.trigger("cleared",i),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(e),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}),H(this.element,"form")){var r=this.element,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},t.prototype.preventEventBubbling=function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")},t.prototype.updateInputValue=function(e){Ie.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.dateIconHandler=function(e){this.enabled&&(this.isIconClicked=!0,j.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),e.preventDefault(),this.readonly||(this.isCalendar()?this.hide(e):(this.isDateIconClicked=!0,this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus(),this.inputElement.focus(),X([this.inputWrapper.container],[BI]),X(this.inputWrapper.buttons,By))),this.isIconClicked=!1)},t.prototype.updateHtmlAttributeToWrapper=function(){if(!g(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(!g(this.htmlAttributes[""+r])&&ZF.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[""+r].replace(/\s+/g," ").trim();n!==""&&X([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var s=this.inputWrapper.container.getAttribute(r);g(s)?s=this.htmlAttributes[""+r]:s.charAt(s.length-1)===";"?s=s+this.htmlAttributes[""+r]:s=s+";"+this.htmlAttributes[""+r],this.inputWrapper.container.setAttribute(r,s)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateHtmlAttributeToElement=function(){if(!g(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];ZF.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[""+r])}},t.prototype.updateCssClass=function(e,i){g(i)||(i=i.replace(/\s+/g," ").trim()),g(e)||(e=e.replace(/\s+/g," ").trim()),Ie.setCssClass(e,[this.inputWrapper.container],i),this.popupWrapper&&Ie.setCssClass(e,[this.popupWrapper],i)},t.prototype.calendarKeyActionHandle=function(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value!=+this.currentDate&&!this.isCalendar()&&this.inputWrapper.container.children[this.index].focus():this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus();break}},t.prototype.inputFocusHandler=function(){if(this.isFocused=!0,!!this.enabled){this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length),this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide");var e={model:this};this.isDateIconClicked=!1,this.trigger("focus",e),this.updateIconState(),this.clearFloatLabelOverflowWidth(),this.openOnFocus&&!this.isIconClicked&&this.show()}},t.prototype.inputHandler=function(e){this.isPopupClicked=!1,this.enableMask&&(!g(e)&&!g(e.inputType)&&e.inputType==="insertFromPaste"?this.notify("maskPasteInputHandler",{module:"MaskedDateTime"}):this.notify("inputHandler",{module:"MaskedDateTime"}))},t.prototype.inputBlurHandler=function(e){var i=this.inputElement.value===this.previousElementValue,r=this.value&&this.previousDate?this.value.getTime()===this.previousDate.getTime():this.value===this.previousDate;if(this.updateFloatLabelOverflowWidth(),!(!this.enabled||i&&r)){if(this.strictModeUpdate(),this.inputElement.value===""&&g(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.isBlur=!0,this.updateInput(!1,!0),this.isBlur=!1,this.popupUpdate(),this.changeTrigger(e),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value===this.maskedDateValue&&!this.value&&(this.floatLabelType==="Auto"||this.floatLabelType==="Never"||this.placeholder)&&this.updateInputValue(""),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.getModuleName()==="datepicker"){var n={model:this};this.trigger("blur",n)}this.isCalendar()&&(this.defaultKeyConfigs=pe(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new rr(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.calendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}},t.prototype.documentHandler=function(e){!g(this.popupObj)&&!g(this.inputWrapper)&&(this.inputWrapper.container.contains(e.target)&&e.type!=="mousedown"||this.popupObj.element&&this.popupObj.element.contains(e.target))&&e.type!=="touchstart"&&e.preventDefault();var i=e.target;!H(i,".e-datepicker.e-popup-wrapper")&&!g(this.inputWrapper)&&H(i,"."+CW)!==this.inputWrapper.container&&!i.classList.contains("e-day")?(this.hide(e),i.classList.contains("e-dlg-overlay")?e.preventDefault():this.focusOut()):H(i,".e-datepicker.e-popup-wrapper")&&(i.classList.contains("e-day")&&!g(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&H(i,".e-content")&&H(i,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(e):H(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(+this.value)==+o.prototype.generateTodayVal.call(this,this.value)&&this.hide(e))},t.prototype.inputKeyActionHandle=function(e){var i=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e),this.getModuleName()==="datepicker"&&this.show(null,e);break;case"escape":this.hide(e);break;case"enter":{var r=this.inputElement.value===this.previousElementValue,n=this.value instanceof Date&&this.previousDate instanceof Date?this.value.getTime()===this.previousDate.getTime():this.value===this.previousDate;r&&n||(this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass()),!this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break}case"tab":case"shiftTab":{var s=this.inputElement.selectionStart,a=this.inputElement.selectionEnd;if(this.enableMask&&!this.popupObj&&!this.readonly){var l=this.inputElement.value.length;(s===0&&a===l||a!==l&&e.action==="tab"||s!==0&&e.action==="shiftTab")&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}),s=this.inputElement.selectionStart,a=this.inputElement.selectionEnd}this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.enableMask&&(this.inputElement.selectionStart=s,this.inputElement.selectionEnd=a),e.action==="tab"&&e.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&(e.preventDefault(),this.headerTitleElement.focus()),e.action==="shiftTab"&&e.target===this.inputElement&&this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e);break}default:this.defaultAction(e),e.action==="select"&&i===this.depth&&this.hide(e)}},t.prototype.defaultAction=function(e){this.previousDate=!g(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(o.prototype.keyActionHandle.call(this,e),this.isCalendar()&&Ee(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))},t.prototype.popupUpdate=function(){if((g(this.value)&&!g(this.previousDate)||this.getModuleName()!=="datetimepicker"&&+this.value!=+this.previousDate||this.getModuleName()==="datetimepicker"&&+this.value!=+this.previousDateTime)&&(this.popupObj&&this.popupObj.element.querySelectorAll("."+jy).length>0&&Z(this.popupObj.element.querySelectorAll("."+jy),[jy]),!g(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){var e=new Date(this.checkValue(this.value));o.prototype.navigateTo.call(this,"Month",e)}},t.prototype.strictModeUpdate=function(){var e,i=/^y/,r=/[^a-zA-Z]/,n;if(this.getModuleName()==="datetimepicker"?e=g(this.formatString)?this.dateTimeFormat:this.formatString:(!i.test(this.formatString)||r.test(this.formatString))&&(e=g(this.formatString)?this.formatString:this.formatString.replace("dd","d")),g(e))e=this.formatString;else{var s=e.split("M").length-1;s<3&&(e=e.replace("MM","M"))}var a;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?a={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:a={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(this.calendarMode==="Gregorian"?n={format:e,type:"dateTime",skeleton:"yMd"}:n={format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},a=n);var l;if(typeof this.inputElement.value=="string"&&(this.inputElement.value=this.inputElement.value.trim()),this.getModuleName()==="datetimepicker"){if(this.checkDateValue(this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a))?l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a):(this.calendarMode==="Gregorian"?n={format:e,type:"dateTime",skeleton:"yMd"}:n={format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),n)),(g(l)||typeof l=="object"&&isNaN(l.getTime()))&&!g(this.inputFormatsString))for(var h=0,c=this.inputFormatsString;h<c.length;h++){var u=c[h],d=void 0;if(this.calendarMode==="Gregorian"?d={format:u,type:"dateTime",skeleton:"yMd"}:d={format:u,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),d),!g(l)&&l instanceof Date&&!isNaN(l.getTime()))break}}else{if(l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),a),(g(l)||typeof l=="object"&&isNaN(l.getTime()))&&!g(this.inputFormatsString))for(var p=0,f=this.inputFormatsString;p<f.length;p++){var v=f[p],d=void 0;if(this.calendarMode==="Gregorian"?d={format:v,type:"dateTime",skeleton:"yMd"}:d={format:v,type:"dateTime",skeleton:"yMd",calendar:"islamic"},l=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),d),!g(l)&&l instanceof Date&&!isNaN(l.getTime()))break}l=!g(l)&&isNaN(+l)?null:l,!g(this.formatString)&&this.inputElement.value!==""&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&this.formatString.indexOf("y")===-1&&l.setFullYear(this.value.getFullYear())}this.getModuleName()==="datepicker"&&this.value&&!isNaN(+this.value)&&l&&l.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&l?(this.updateInputValue(this.globalize.formatDate(l,a)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:l},!0),this.strictMode&&!l&&this.inputElement.value===(this.enableMask?this.maskedDateValue:"")&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),g(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)))},t.prototype.createCalendar=function(){var e=this;this.popupWrapper=this.createElement("div",{className:""+Py+" "+XF,id:this.inputElement.id+"_options"}),this.popupWrapper.setAttribute("aria-label",this.element.id),this.popupWrapper.setAttribute("role","dialog"),g(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),j.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=""+Py+" e-date-modal",document.body.className+=" "+$F,this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new es(this.popupWrapper,{content:this.calendarElement,relateTo:j.isDevice?document.body:this.inputWrapper.container,position:j.isDevice?{X:"center",Y:"center"}:this.enableRtl?{X:"right",Y:"bottom"}:{X:"left",Y:"bottom"},offsetY:DW,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:j.isDevice?{X:"fit",Y:"fit"}:this.enableRtl?{X:"fit",Y:"flip"}:{X:"flip",Y:"flip"},open:function(){j.isDevice&&e.fullScreenMode&&(e.iconRight=parseInt(window.getComputedStyle(e.calendarElement.querySelector(".e-header.e-month .e-prev")).marginRight,10)>16,e.touchModule=new jr(e.calendarElement.querySelector(".e-content.e-month"),{swipe:e.CalendarSwipeHandler.bind(e)}),T.add(e.calendarElement.querySelector(".e-content.e-month"),"touchstart",e.TouchStartHandler,e)),e.getModuleName()!=="datetimepicker"&&document.activeElement!==e.inputElement&&(e.defaultKeyConfigs=pe(e.defaultKeyConfigs,e.keyConfigs),e.calendarElement.children[1].firstElementChild.focus(),e.calendarKeyboardModules=new rr(e.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}),e.calendarKeyboardModules=new rr(e.inputWrapper.container.children[e.index],{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs})),j.isDevice&&e.allowEdit&&!e.readonly&&j.isIos&&e.inputElement.blur()},close:function(){e.isDateIconClicked&&e.inputWrapper.container.children[e.index].focus(),e.value&&e.disabledDates(),e.popupObj&&e.popupObj.destroy(),e.resetCalendar(),se(e.popupWrapper),e.popupObj=e.popupWrapper=null,e.preventArgs=null,e.calendarKeyboardModules=null,e.setAriaAttributes()},targetExitViewport:function(){j.isDevice||e.hide()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()},t.prototype.getAmPmValue=function(e){try{return typeof e=="string"&&e.trim()!==""?e.replace(/(am|pm|Am|aM|pM|Pm)/g,function(i){return i.toLocaleUpperCase()}):""}catch(i){return console.error("Error occurred while processing date:",i),""}},t.prototype.CalendarSwipeHandler=function(e){var i=0;if(this.iconRight)switch(e.swipeDirection){case"Left":i=1;break;case"Right":i=-1;break}else switch(e.swipeDirection){case"Up":i=1;break;case"Down":i=-1;break}this.touchStart&&(i===1?this.navigateNext(e):i===-1&&this.navigatePrevious(e),this.touchStart=!1)},t.prototype.TouchStartHandler=function(e){this.touchStart=!0},t.prototype.setAriaDisabled=function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)},t.prototype.modelHeader=function(){var e,i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),s=this.createElement("span",{className:"e-model-day"}),a=this.createElement("span",{className:"e-model-month"});if(this.calendarMode==="Gregorian"?e={format:"y",skeleton:"dateTime"}:e={format:"y",skeleton:"dateTime",calendar:"islamic"},r.textContent=""+this.globalize.formatDate(this.value||new Date,e),this.calendarMode==="Gregorian"?e={format:"E",skeleton:"dateTime"}:e={format:"E",skeleton:"dateTime",calendar:"islamic"},s.textContent=""+this.globalize.formatDate(this.value||new Date,e)+", ",this.calendarMode==="Gregorian"?e={format:"MMM d",skeleton:"dateTime"}:e={format:"MMM d",skeleton:"dateTime",calendar:"islamic"},a.textContent=""+this.globalize.formatDate(this.value||new Date,e),this.fullScreenMode){var l=this.createElement("span",{className:"e-popup-close"});T.add(l,"mousedown touchstart",this.modelCloseHandler,this);var h=this.calendarElement.querySelector("button.e-today");n.classList.add("e-day-wrapper"),h.classList.add("e-outline"),i.appendChild(l),i.appendChild(h)}this.fullScreenMode||i.appendChild(r),n.appendChild(s),n.appendChild(a),i.appendChild(n),this.calendarElement.insertBefore(i,this.calendarElement.firstElementChild)},t.prototype.modelCloseHandler=function(e){this.hide()},t.prototype.changeTrigger=function(e){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.isDynamicValueChanged&&this.isCalendar()&&this.popupUpdate(),this.changedArgs.value=this.value,this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!g(e),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0),this.isKeyAction=!1},t.prototype.navigatedEvent=function(e){pe(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)},t.prototype.keyupHandler=function(e){this.isKeyAction=this.inputElement.value!==this.previousElementValue,this.enableMask&&this.showClearButton&&this.inputElement&&this.inputElement.value===this.maskedDateValue&&this.inputWrapper&&this.inputWrapper.clearButton&&!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")&&this.inputWrapper.clearButton.classList.add("e-clear-icon-hide")},t.prototype.changeEvent=function(e){!this.isIconClicked&&!(this.isBlur||this.isKeyAction)&&this.selectCalendar(e),(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())?(this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.isDynamicValueChanged||(this.isAngular&&(this.previousDate=this.value&&new Date(+this.value)),this.trigger("change",this.changedArgs)),this.previousDate=this.value&&new Date(+this.value),this.isDynamicValueChanged||this.hide(e),this.previousElementValue=this.inputElement.value,this.errorClass()):e&&this.hide(e),this.isKeyAction=!1},t.prototype.requiredModules=function(){var e=[];return this.calendarMode==="Islamic"&&e.push({args:[this],member:"islamic",name:"Islamic"}),this.enableMask&&e.push({args:[this],member:"MaskedDateTime"}),e},t.prototype.selectCalendar=function(e){var i,r,n;this.getModuleName()==="datetimepicker"?r=g(this.formatString)?this.dateTimeFormat:this.formatString:r=this.formatString,this.value&&(this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n={format:r,type:"dateTime",skeleton:"yMd"}:n={format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)):(this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})),g(i)||(this.updateInputValue(i),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.isCalendar=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+XF))},t.prototype.setWidth=function(e){typeof e=="number"?this.inputWrapper.container.style.width=Ae(this.width):typeof e=="string"?this.inputWrapper.container.style.width=e.match(/px|%|em/)?this.width:Ae(this.width):this.inputWrapper.container.style.width="100%",this.updateFloatLabelOverflowWidth()},t.prototype.show=function(e,i){var r=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var n=!0,s=void 0;!g(this.value)&&!(+this.value>=+new Date(this.checkValue(this.min))&&+this.value<=+new Date(this.checkValue(this.max)))?(s=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)):s=this.value||null,this.isCalendar()||(o.prototype.render.call(this),this.setProperties({value:s||null},!0),this.previousDate=s,this.createCalendar()),j.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){n=!1},popup:this.popupObj,event:i||null,cancel:!1,appendTo:j.isDevice?this.mobilePopupWrapper:document.body};var a=this.preventArgs;this.trigger("open",a,function(l){if(r.preventArgs=l,n&&!r.preventArgs.cancel){X(r.inputWrapper.buttons,By),r.preventArgs.appendTo.appendChild(r.popupWrapper),r.popupObj.refreshPosition(r.inputElement);var h={name:"FadeIn",duration:j.isDevice?0:MW};if(r.zIndex===1e3?r.popupObj.show(new Mt(h),r.element):r.popupObj.show(new Mt(h),null),o.prototype.setOverlayIndex.call(r,r.mobilePopupWrapper,r.popupObj.element,r.modal,j.isDevice),r.setAriaAttributes(),j.isDevice){var c=r.createElement("div",{className:"e-dlg-overlay"});c.style.zIndex=(r.zIndex-1).toString(),r.mobilePopupWrapper.appendChild(c)}}else r.popupObj.destroy(),r.popupWrapper=r.popupObj=null;!g(r.inputElement)&&r.inputElement.value===""&&!g(r.tableBodyElement)&&r.tableBodyElement.querySelectorAll("td.e-selected").length>0&&(X([r.tableBodyElement.querySelector("td.e-selected")],EW),Z(r.tableBodyElement.querySelectorAll("td.e-selected"),jy)),T.add(document,"mousedown touchstart",r.documentHandler,r)})}},t.prototype.hide=function(e){var i=this;if(g(this.popupWrapper))j.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var r=!0;this.preventArgs={preventDefault:function(){r=!1},popup:this.popupObj,event:e||null,cancel:!1},Z(this.inputWrapper.buttons,By),Z([document.body],$F);var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,function(s){i.closeEventCallback(r,s)}):this.closeEventCallback(r,n)}},t.prototype.closeEventCallback=function(e,i){var r=this;this.preventArgs=i,this.isCalendar()&&e&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),Z(this.inputWrapper.buttons,By)),this.setAriaAttributes(),j.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),j.isDevice&&!g(this.mobilePopupWrapper)&&e&&(g(this.preventArgs)||!this.preventArgs.cancel)&&(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null),T.remove(document,"mousedown touchstart",this.documentHandler),j.isDevice&&this.allowEdit&&!this.readonly&&(this.inputElement.removeAttribute("readonly"),j.isIos&&setTimeout(function(){r.inputElement.focus()},1)),this.setAllowEdit()},t.prototype.focusIn=function(e){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),X([this.inputWrapper.container],[BI]))},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&(Z([this.inputWrapper.container],[BI]),this.inputElement.blur())},t.prototype.currentView=function(){var e;return this.calendarElement&&(e=o.prototype.currentView.call(this)),e},t.prototype.navigateTo=function(e,i){this.calendarElement&&o.prototype.navigateTo.call(this,e,i)},t.prototype.destroy=function(){this.unBindEvents(),this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),o.prototype.destroy.call(this),Ie.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),g(this.keyboardModules)||this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains(SW)&&o.prototype.destroy.call(this);var e={"aria-atomic":"true","aria-disabled":"true","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"};this.inputElement.hasAttribute("aria-label")&&this.inputElement.removeAttribute("aria-label"),this.inputElement&&(Ie.removeAttributes(e,this.inputElement),g(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),T.remove(this.inputElement,"blur",this.inputBlurHandler),T.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&se(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),this.ngTag===null&&(this.inputElement&&(g(this.inputWrapper)||this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),Z([this.inputElement],[wW])),Z([this.element],[Py]),g(this.inputWrapper)||se(this.inputWrapper.container)),this.formElement&&T.remove(this.formElement,"reset",this.resetFormHandler),this.inputWrapper=null,this.keyboardModules=null},t.prototype.ensureInputAttribute=function(){for(var e=[],i=0;i<this.inputElement.attributes.length;i++)e[i]=this.inputElement.attributes[i].name;for(var i=0;i<e.length;i++)g(this.inputElementCopy.getAttribute(e[i]))?(e[i].toLowerCase()==="value"&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[i])):(e[i].toLowerCase()==="value"&&(this.inputElement.value=this.inputElementCopy.getAttribute(e[i])),this.inputElement.setAttribute(e[i],this.inputElementCopy.getAttribute(e[i])))},t.prototype.preRender=function(){this.inputElementCopy=this.element.cloneNode(!0),Z([this.inputElementCopy],[Py,yW,mW]),this.inputElement=this.element,this.formElement=H(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?this.ngTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):this.getModuleName()==="datetimepicker"?(this.element.id=Lt("ej2-datetimepicker"),this.ngTag!==null&&Ee(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=Lt("ej2-datepicker"),this.ngTag!==null&&Ee(this.inputElement,{id:this.element.id+"_input"})),this.ngTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.inputFormats&&this.checkInputFormats(),this.ngTag!==null?(this.tabIndex=this.inputElement.hasAttribute("tabindex")?this.inputElement.getAttribute("tabindex"):"0",this.inputElement.removeAttribute("tabindex")):(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex")),o.prototype.preRender.call(this)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(!g(e.getAttribute(n[s]))){var a=e.getAttribute(n[s]);i.setAttribute(n[s],a),e.removeAttribute(n[s])}},t.prototype.checkFormat=function(){var e=new Nt(this.locale);if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(this.format.skeleton!==""&&!g(this.format.skeleton)){var i=this.format.skeleton;this.getModuleName()==="datetimepicker"?this.formatString=e.getDatePattern({skeleton:i,type:"dateTime"}):this.formatString=e.getDatePattern({skeleton:i,type:"date"})}else this.getModuleName()==="datetimepicker"?this.formatString=this.dateTimeFormat:this.formatString=null;else this.formatString=null},t.prototype.checkInputFormats=function(){var e=new Nt(this.locale);if(this.inputFormatsString=[],this.inputFormats){for(var i=0,r=this.inputFormats;i<r.length;i++){var n=r[i],s="";if(typeof n=="string")s=n;else if(n.skeleton!==""&&!g(n.skeleton)){var a=n.skeleton;this.getModuleName()==="datetimepicker"?s=e.getDatePattern({skeleton:a,type:"dateTime"}):s=e.getDatePattern({skeleton:a,type:"date"})}s&&this.inputFormatsString.push(s)}this.inputFormatsString.length===0&&(this.inputFormatsString=null)}else this.inputFormatsString=null},t.prototype.checkHtmlAttributes=function(e){this.globalize=new Nt(this.locale),this.checkFormat(),this.checkView();var i=e?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"],r;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?r={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(var n=0,s=i;n<s.length;n++){var a=s[n];if(!g(this.inputElement.getAttribute(a)))switch(a){case"disabled":if(g(this.datepickerOptions)||this.datepickerOptions.enabled===void 0||e){var l=!(this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true");this.setProperties({enabled:l},!e)}break;case"readonly":if(g(this.datepickerOptions)||this.datepickerOptions.readonly===void 0||e){var h=this.inputElement.getAttribute(a)==="readonly"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true";this.setProperties({readonly:h},!e)}break;case"placeholder":(g(this.datepickerOptions)||this.datepickerOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(a)},!e);break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(a));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(a));break;case"value":if(g(this.datepickerOptions)||this.datepickerOptions.value===void 0||e){var c=this.inputElement.getAttribute(a);this.setProperties(it(a,this.globalize.parseDate(this.getAmPmValue(c),r),{}),!e)}break;case"min":if(+this.min==+new Date(1900,0,1)||e){var u=this.inputElement.getAttribute(a);this.setProperties(it(a,this.globalize.parseDate(this.getAmPmValue(u),r),{}),!e)}break;case"max":if(+this.max==+new Date(2099,11,31)||e){var d=this.inputElement.getAttribute(a);this.setProperties(it(a,this.globalize.parseDate(this.getAmPmValue(d),r),{}),!e)}break;case"type":this.inputElement.getAttribute(a)!=="text"&&this.inputElement.setAttribute("type","text");break}}},t.prototype.getModuleName=function(){return"datepicker"},t.prototype.updateFloatLabelOverflowWidth=function(){for(var e=this.inputWrapper.container,i=e.querySelector(".e-float-text.e-label-bottom"),r=0,n=".e-input-group-icon, .e-clear-icon",s=e.querySelectorAll(n),a=0;a<s.length;a++)r+=s[a].offsetWidth;if(i){var l=this.element.parentElement.offsetWidth-r;l&&(i.style.width=l+"px")}},t.prototype.clearFloatLabelOverflowWidth=function(){var e=this.inputWrapper.container,i=e.querySelector(".e-float-text.e-label-top");i&&i.removeAttribute("style")},t.prototype.disabledDates=function(e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r,n,s=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value)),a=this.previousDate;this.minMaxUpdates(),(!e||e&&!g(this.renderDayCell))&&o.prototype.render.call(this),this.previousDate=a;var l=s&&+s,h='*[id^="/id"]'.replace("/id",""+l);this.strictMode||(typeof this.value=="string"||typeof this.value=="object"&&+this.value!=+s)&&this.setProperties({value:s},!0),!g(this.calendarElement)&&!g(this.calendarElement.querySelectorAll(h)[0])&&this.calendarElement.querySelectorAll(h)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date(new Date().setHours(0,0,0,0))));var c;this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n=this.globalize.formatDate(s,{format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}):n=this.globalize.formatDate(s,{format:g(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),c=n):(this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},c=this.globalize.formatDate(s,r)),this.popupObj||(this.updateInputValue(c),this.enableMask&&(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime",isBlur:i})))},t.prototype.setAriaAttributes=function(){this.isCalendar()?(Ie.addAttributes({"aria-expanded":"true"},this.inputElement),Ee(this.inputElement,{"aria-owns":this.inputElement.id+"_options"}),Ee(this.inputElement,{"aria-controls":this.inputElement.id}),this.value&&Ee(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(Ie.addAttributes({"aria-expanded":"false"},this.inputElement),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),this.inputElement.removeAttribute("aria-activedescendant"))},t.prototype.errorClass=function(){var e='*[id^="/id"]'.replace("/id",""+ +this.value),i=this.calendarElement&&this.calendarElement.querySelectorAll(e)[0]&&this.calendarElement.querySelectorAll(e)[0].classList.contains("e-disabled");!g(this.value)&&!g(this.min)&&!g(this.max)&&!(new Date(this.value).setMilliseconds(0)>=new Date(this.min).setMilliseconds(0)&&new Date(this.value).setMilliseconds(0)<=new Date(this.max).setMilliseconds(0))||!this.strictMode&&this.inputElement.value!==""&&this.inputElement.value!==this.maskedDateValue&&g(this.value)||i||!this.isValidTime(this.value)?(X([this.inputWrapper.container],KF),Ee(this.inputElement,{"aria-invalid":"true"})):g(this.inputWrapper)||(Z([this.inputWrapper.container],KF),Ee(this.inputElement,{"aria-invalid":"false"}))},t.prototype.isValidTime=function(e){return!0},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r],a=["blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"];switch(a.indexOf(s)>0&&this.isReact&&(this.isDynamicValueChanged=!0),s){case"value":this.isDynamicValueChanged=!0,this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.previousElementValue=this.inputElement.value,g(this.value)&&(this.enableMask?this.updateInputValue(this.maskedDateValue):this.updateInputValue(""),this.currentDate=new Date(new Date().setHours(0,0,0,0))),this.updateInput(!0),+this.previousDate!=+this.value&&this.changeTrigger(null),this.isInteracted=!0,this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||this.updateInputValue(this.maskedDateValue));break;case"inputFormats":this.checkInputFormats();break;case"allowEdit":this.setAllowEdit();break;case"placeholder":Ie.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":Ie.setReadonly(this.readonly,this.inputElement);break;case"enabled":Ie.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new Nt(this.locale),this.l10n.setLocale(this.locale),this.datepickerOptions&&this.datepickerOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ie.setPlaceholder(this.placeholder,this.inputElement)),this.updateInput(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"enableRtl":Ie.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&o.prototype.onPropertyChanged.call(this,e,i);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"showClearButton":Ie.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width),Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Ie.removeFloating(this.inputWrapper),Ie.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-icon");break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue),this.bindInputEvent()):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break;default:this.calendarElement&&this.isCalendar()&&o.prototype.onPropertyChanged.call(this,e,i),s==="min"&&g(this.min)&&(this.min=new Date(1900,0,1)),s==="max"&&g(this.max)&&(this.max=new Date(2099,11,31));break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},t.prototype.addDate=function(e){},Oi([w(null)],t.prototype,"width",void 0),Oi([w(null)],t.prototype,"value",void 0),Oi([w(null)],t.prototype,"cssClass",void 0),Oi([w(!1)],t.prototype,"strictMode",void 0),Oi([w(null)],t.prototype,"format",void 0),Oi([w(null)],t.prototype,"inputFormats",void 0),Oi([w(!0)],t.prototype,"enabled",void 0),Oi([w(!1)],t.prototype,"fullScreenMode",void 0),Oi([w({})],t.prototype,"htmlAttributes",void 0),Oi([w(null)],t.prototype,"values",void 0),Oi([w(!1)],t.prototype,"isMultiSelection",void 0),Oi([w(!0)],t.prototype,"showClearButton",void 0),Oi([w(!0)],t.prototype,"allowEdit",void 0),Oi([w(null)],t.prototype,"keyConfigs",void 0),Oi([w(!1)],t.prototype,"enablePersistence",void 0),Oi([w(1e3)],t.prototype,"zIndex",void 0),Oi([w(!1)],t.prototype,"readonly",void 0),Oi([w(null)],t.prototype,"placeholder",void 0),Oi([w("Never")],t.prototype,"floatLabelType",void 0),Oi([w(null)],t.prototype,"serverTimezoneOffset",void 0),Oi([w(!1)],t.prototype,"openOnFocus",void 0),Oi([w(!1)],t.prototype,"enableMask",void 0),Oi([w({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),Oi([G()],t.prototype,"open",void 0),Oi([G()],t.prototype,"cleared",void 0),Oi([G()],t.prototype,"close",void 0),Oi([G()],t.prototype,"blur",void 0),Oi([G()],t.prototype,"focus",void 0),Oi([G()],t.prototype,"created",void 0),Oi([G()],t.prototype,"destroyed",void 0),t=Oi([It],t),t})(fW);var Lae=new Date().getDate(),Nae=new Date().getMonth(),kae=new Date().getFullYear();var _I;(function(o){function t(e,i,r,n,s,a){this.calendarMode;var l,h=a*6e4,c=[],u=[];l=+i.setMilliseconds(0);for(var d=+r.setMilliseconds(0);d>=l;)u.push(l),c.push(n.formatDate(new Date(l),{format:s,type:"time"})),l+=h;var p=kt.createList(e,c,null,!0);return{collection:u,list:p}}o.createListItems=t})(_I||(_I={}));var TW=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),oi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},AW="e-date-wrapper",LW="e-datepicker",NW="e-datetime-wrapper",kW=new Date().getDate(),FW=new Date().getMonth(),RW=new Date().getFullYear(),OW=new Date().getHours(),zW=new Date().getMinutes(),PW=new Date().getSeconds(),BW=new Date().getMilliseconds(),_f="e-datetimepicker",JF="e-datetimepopup-wrapper",jW="e-input-group-icon",eR="e-popup",HW="e-time-icon",Uf="e-input-focus",tR="250px",iR="e-icon-anim",HI="e-disabled",rR="e-error",VW="e-content",_W="e-navigation",Sh="e-active",VI="e-hover",UW="e-icons",Hy=2,Ch="e-list-item",nR=100,sR="e-time-overflow",oR=(function(o){TW(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.valueWithMinutes=null,r.scrollInvoked=!1,r.moduleName=r.getModuleName(),r.formatRegex=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|'[^']*'|'[^']*'/g,r.dateFormatString="",r.dateTimeOptions=e,r}return t.prototype.focusHandler=function(){this.clearLabelOverflowWidth(),this.enabled&&X([this.inputWrapper.container],Uf)},t.prototype.focusIn=function(){o.prototype.focusIn.call(this)},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),Z([this.inputWrapper.container],[Uf]))},t.prototype.blurHandler=function(e){if(this.updateLabelOverflowWidth(),!!this.enabled){if(this.isTimePopupOpen()&&this.isPreventBlur){this.inputElement.focus();return}Z([this.inputWrapper.container],Uf);var i={model:this};this.isTimePopupOpen()&&this.hide(e),this.trigger("blur",i)}},t.prototype.destroy=function(){this.showClearButton&&(this.clearButton=document.getElementsByClassName("e-clear-icon")[0]),this.popupObject&&this.popupObject.element.classList.contains(eR)&&(this.popupObject.destroy(),se(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],g(this.rippleFn)||this.rippleFn());var e={"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-expanded":"false",role:"combobox",autocomplete:"off"};this.inputElement&&Ie.removeAttributes(e,this.inputElement),this.isCalendar()&&(this.popupWrapper&&se(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),this.liCollections=null,this.rippleFn=null,this.selectedElement=null,this.listTag=null,this.timeIcon=null,this.popupObject=null,this.preventArgs=null,this.keyboardModule=null,Ie.destroy({element:this.inputElement,floatLabelType:this.floatLabelType,properties:this.properties},this.clearButton),o.prototype.destroy.call(this)},t.prototype.render=function(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,typeof this.min=="string"&&(this.min=this.checkDateValue(new Date(this.min))),typeof this.max=="string"&&(this.max=this.checkDateValue(new Date(this.max))),typeof this.minTime=="string"&&(this.minTime=this.checkDateValue(new Date(this.minTime))),typeof this.maxTime=="string"&&(this.maxTime=this.checkDateValue(new Date(this.maxTime))),!g(H(this.element,"fieldset"))&&H(this.element,"fieldset").disabled&&(this.enabled=!1),o.prototype.updateHtmlAttributeToElement.call(this),this.checkAttributes(!1);var e={placeholder:this.placeholder};this.l10n=new Ri("datetimepicker",e,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),o.prototype.render.call(this),this.createInputElement(),o.prototype.updateHtmlAttributeToWrapper.call(this),this.bindInputEvents(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.setValue(!0),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType==="Always"||!this.floatLabelType||!this.placeholder)&&Ie.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),this.element.tagName==="EJS-DATETIMEPICKER"&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.floatLabelType!=="Never"&&Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon"),this.renderComplete()},t.prototype.setValue=function(e){if(e===void 0&&(e=!1),this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){var i=this.validateMinMaxRange(this.initValue);Ie.setValue(this.getFormattedValue(i),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:i},!0)}else g(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,o.prototype.updateInput.call(this,e)},t.prototype.validateMinMaxRange=function(e){var i=e;return this.isDateObject(e)?i=this.validateValue(e):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(i),i},t.prototype.checkValidState=function(e){this.isValidState=!0,this.strictMode||(+e>+this.max||+e<+this.min||!this.isValidTime(e))&&(this.isValidState=!1),this.checkErrorState()},t.prototype.checkErrorState=function(){this.isValidState?Z([this.inputWrapper.container],rR):X([this.inputWrapper.container],rR),Ee(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.isValidTime=function(e){if(e!=null&&(this.minTime||this.maxTime)){var i=void 0,r=void 0,n=void 0,s=void 0,a=e.getHours()*36e5+e.getMinutes()*6e4+e.getSeconds()*1e3+e.getMilliseconds();if(this.minTime&&(i=this.minTime.getHours()*36e5+this.minTime.getMinutes()*6e4+this.minTime.getSeconds()*1e3+this.minTime.getMilliseconds()),this.maxTime&&(r=this.maxTime.getHours()*36e5+this.maxTime.getMinutes()*6e4+this.maxTime.getSeconds()*1e3+this.maxTime.getMilliseconds()),this.min&&+e.getDate()==+this.min.getDate()&&+e.getMonth()==+this.min.getMonth()&&+e.getFullYear()==+this.min.getFullYear()&&(s=this.min.getHours()*36e5+this.min.getMinutes()*6e4+this.min.getSeconds()*1e3+this.min.getMilliseconds(),i=i<s?s:i),this.max&&+e.getDate()==+this.max.getDate()&&+e.getMonth()==+this.max.getMonth()&&+this.max.getFullYear()==+this.max.getFullYear()&&(n=this.max.getHours()*36e5+this.max.getMinutes()*6e4+this.max.getSeconds()*1e3+this.max.getMilliseconds(),r=r>n?n:r),this.strictMode){var l=void 0;return i&&a<i?(l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),this.minTime.getHours(),this.minTime.getMinutes(),this.minTime.getSeconds(),this.minTime.getMilliseconds()),this.setProperties({value:l},!0),this.changedArgs={value:this.value}):r&&a>r&&(l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),this.maxTime.getHours(),this.maxTime.getMinutes(),this.maxTime.getSeconds(),this.maxTime.getMilliseconds()),this.setProperties({value:l},!0),this.changedArgs={value:this.value}),!0}else return!(i&&a<i||r&&a>r)}return!0},t.prototype.validateValue=function(e){var i=e;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),i=this.max):+e<+this.min?i=this.min:+e>+this.max&&(i=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),i=e),i},t.prototype.disablePopupButton=function(e){e?(X([this.inputWrapper.buttons[0],this.timeIcon],HI),this.hide()):Z([this.inputWrapper.buttons[0],this.timeIcon],HI)},t.prototype.getFormattedValue=function(e){var i;return g(e)?null:(this.calendarMode==="Gregorian"?i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd"}:i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(e,i))},t.prototype.isDateObject=function(e){return!g(e)&&!isNaN(+e)},t.prototype.createInputElement=function(){Z([this.inputElement],LW),Z([this.inputWrapper.container],AW),X([this.inputWrapper.container],NW),X([this.inputElement],_f),this.renderTimeIcon(),this.updateLabelOverflowWidth()},t.prototype.renderTimeIcon=function(){this.timeIcon=Ie.appendSpan(jW+" "+HW+" "+UW,this.inputWrapper.container)},t.prototype.bindInputEvents=function(){T.add(this.timeIcon,"mousedown",this.timeHandler,this),T.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),T.add(this.inputElement,"blur",this.blurHandler,this),T.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=pe(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new rr(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.unBindInputEvents=function(){T.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),T.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(T.remove(this.inputElement,"blur",this.blurHandler),T.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()},t.prototype.cldrTimeFormat=function(){var e;return this.isNullOrEmpty(this.timeFormat)?this.locale==="en"||this.locale==="en-US"?e=V("timeFormats.short",hm()):e=this.getCultureTimeObject(Br,""+this.locale):e=this.timeFormat,e},t.prototype.cldrDateTimeFormat=function(){var e,i=new Nt(this.locale),r=i.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?e=r+" "+this.getCldrFormat("time"):e=this.formatString,e},t.prototype.getCldrFormat=function(e){var i;return this.locale==="en"||this.locale==="en-US"?i=V("timeFormats.short",hm()):i=this.getCultureTimeObject(Br,""+this.locale),i},t.prototype.isNullOrEmpty=function(e){return!!(g(e)||typeof e=="string"&&e.trim()==="")},t.prototype.getCultureTimeObject=function(e,i){return this.calendarMode==="Gregorian"?V("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",e):V("main."+this.locale+".dates.calendars.islamic.timeFormats.short",e)},t.prototype.timeHandler=function(e){this.enabled&&(this.isIconClicked=!0,j.isDevice&&this.inputElement.setAttribute("readonly",""),e.currentTarget===this.timeIcon&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&o.prototype.hide.call(this,e),this.isTimePopupOpen()?this.closePopup(e):(this.inputElement.focus(),this.popupCreation("time",e),X([this.inputWrapper.container],[Uf]))),this.isIconClicked=!1)},t.prototype.dateHandler=function(e){this.enabled&&(e.currentTarget===this.inputWrapper.buttons[0]&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(e),g(this.popupWrapper)||this.popupCreation("date",e)))},t.prototype.show=function(e,i){this.enabled&&this.readonly||!this.enabled||(e==="time"&&!this.dateTimeWrapper?(this.isDatePopupOpen()&&this.hide(i),this.popupCreation("time",i)):this.popupObj||(this.isTimePopupOpen()&&this.hide(i),o.prototype.show.call(this),this.popupCreation("date",i)))},t.prototype.toggle=function(e){this.isDatePopupOpen()?(o.prototype.hide.call(this,e),this.show("time",null)):this.isTimePopupOpen()?(this.hide(e),o.prototype.show.call(this,null,e),this.popupCreation("date",null)):this.show(null,e)},t.prototype.listCreation=function(){var e;this.calendarMode==="Gregorian"?(this.cldrDateTimeFormat().replace(this.formatRegex,this.TimePopupFormat()),this.dateFormatString===""&&(this.dateFormatString=this.cldrDateTimeFormat()),e=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),{format:this.dateFormatString,type:"datetime"})):e=this.globalize.parseDate(this.getAmPmValue(this.inputElement.value),{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});var i=g(this.value)?this.inputElement.value!==""?e:new Date:this.value;this.valueWithMinutes=i,this.listWrapper=et("div",{className:VW,attrs:{tabindex:"0"}});var r=this.startTime(i),n=this.endTime(i),s=_I.createListItems(this.createElement,r,n,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=s.collection,this.listTag=s.list,Ee(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),bt([s.list],this.listWrapper),this.wireTimeListEvents();var a={duration:300,selector:"."+Ch};this.rippleFn=Wi(this.listWrapper,a),this.liCollections=this.listWrapper.querySelectorAll("."+Ch)},t.prototype.popupCreation=function(e,i){if(j.isDevice&&this.element.setAttribute("readonly","readonly"),e==="date")!this.readonly&&this.popupWrapper&&(X([this.popupWrapper],JF),Ee(this.popupWrapper,{id:this.element.id+"_options"}));else if(!this.readonly){var r=et("div",{className:_f+" "+eR,attrs:{id:this.element.id+"_timepopup"}});r.style.cssText="visibility: hidden; display: block;",this.dateTimeWrapper=r,g(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!g(this.step)&&this.step>0&&(this.listCreation(),bt([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(i),(!j.isDevice||j.isDevice&&!this.fullScreenMode)&&this.popupObject.refreshPosition(this.inputElement),j.isDevice&&(this.modelWrapper.style.zIndex=(this.popupObject.zIndex-1).toString(),this.fullScreenMode&&(this.dateTimeWrapper.style.left="0px"))}},t.prototype.openPopup=function(e){var i=this;this.preventArgs={cancel:!1,popup:this.popupObject,event:e||null};var r=this.preventArgs;this.trigger("open",r,function(n){if(i.preventArgs=n,!i.preventArgs.cancel&&!i.readonly){var s={name:"FadeIn",duration:nR};i.zIndex===1e3?i.popupObject.show(new Mt(s),i.element):i.popupObject.show(new Mt(s),null),X([i.inputWrapper.container],[iR]),Ee(i.inputElement,{"aria-expanded":"true"}),Ee(i.inputElement,{"aria-owns":i.inputElement.id+"_options"}),Ee(i.inputElement,{"aria-controls":i.inputElement.id}),T.add(document,"mousedown touchstart",i.documentClickHandler,i)}})},t.prototype.documentClickHandler=function(e){var i=e.target;!g(this.popupObject)&&(this.inputWrapper.container.contains(i)&&e.type!=="mousedown"||this.popupObject.element&&this.popupObject.element.contains(i))&&e.type!=="touchstart"&&e.preventDefault(),!H(i,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))&&i!==this.inputElement&&i!==this.timeIcon&&!g(this.inputWrapper)&&i!==this.inputWrapper.container?this.isTimePopupOpen()&&(this.hide(e),i.classList.contains("e-dlg-overlay")?e.preventDefault():this.focusOut()):i!==this.inputElement&&(j.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(j.isIE||j.info.name==="edge")&&i===this.popupObject.element))},t.prototype.isTimePopupOpen=function(){return!!(this.dateTimeWrapper&&this.dateTimeWrapper.classList.contains(""+_f))},t.prototype.isDatePopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+JF))},t.prototype.renderPopup=function(){var e=this;if(this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),j.isDevice&&(this.timeModal=et("div"),this.timeModal.className=""+_f+" e-time-modal",document.body.className+=" "+sR,this.timeModal.style.display="block",document.body.appendChild(this.timeModal)),j.isDevice){this.modelWrapper=et("div",{className:"e-datetime-mob-popup-wrap"}),this.modelWrapper.appendChild(this.dateTimeWrapper);var i=et("div",{className:"e-dlg-overlay"});i.style.zIndex=(this.zIndex-1).toString(),this.modelWrapper.appendChild(i),document.body.appendChild(this.modelWrapper)}var r=4;if(this.popupObject=new es(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:j.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:j.isDevice?document.body:this.inputWrapper.container,position:j.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:r,open:function(){e.dateTimeWrapper.style.visibility="visible",X([e.timeIcon],Sh),j.isDevice||(e.timekeyConfigure=pe(e.timekeyConfigure,e.keyConfigs),e.inputEvent=new rr(e.inputWrapper.container,{keyAction:e.timeKeyActionHandle.bind(e),keyConfigs:e.timekeyConfigure,eventName:"keydown"}))},close:function(){Z([e.timeIcon],Sh),e.unWireTimeListEvents(),e.inputElement.removeAttribute("aria-activedescendant"),Qe(e.popupObject.element),e.popupObject.destroy(),e.dateTimeWrapper.innerHTML="",e.modelWrapper&&Qe(e.modelWrapper),e.listWrapper=e.dateTimeWrapper=void 0,e.inputEvent&&e.inputEvent.destroy()},targetExitViewport:function(){j.isDevice||e.hide()}}),j.isDevice&&this.fullScreenMode?(this.popupObject.element.style.maxHeight="100%",this.popupObject.element.style.width="100%"):this.popupObject.element.style.maxHeight=tR,j.isDevice&&this.fullScreenMode){var n=this.createElement("div",{className:"e-model-header"}),s=this.createElement("span",{className:"e-model-title"});s.textContent="Select time";var a=this.createElement("span",{className:"e-popup-close"});T.add(a,"mousedown touchstart",this.dateTimeCloseHandler,this),n.appendChild(a),n.appendChild(s),this.dateTimeWrapper.insertBefore(n,this.dateTimeWrapper.firstElementChild)}},t.prototype.dateTimeCloseHandler=function(e){this.hide()},t.prototype.setDimension=function(e){return typeof e=="number"?e=Ae(e):typeof e=="string"?e=e:e="100%",e},t.prototype.setPopupWidth=function(){var e=this.setDimension(this.width);if(e.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(e)/100;e=i.toString()+"px"}return e},t.prototype.wireTimeListEvents=function(){T.add(this.listWrapper,"click",this.onMouseClick,this),j.isDevice||(T.add(this.listWrapper,"mouseover",this.onMouseOver,this),T.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},t.prototype.unWireTimeListEvents=function(){this.listWrapper&&(T.remove(this.listWrapper,"click",this.onMouseClick),T.remove(document,"mousedown touchstart",this.documentClickHandler),j.isDevice||(T.add(this.listWrapper,"mouseover",this.onMouseOver,this),T.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))},t.prototype.onMouseOver=function(e){var i=H(e.target,"."+Ch);this.setTimeHover(i,VI)},t.prototype.onMouseLeave=function(){this.removeTimeHover(VI)},t.prototype.setTimeHover=function(e,i){this.enabled&&this.isValidLI(e)&&!e.classList.contains(i)&&(this.removeTimeHover(i),X([e],i))},t.prototype.getPopupHeight=function(){var e=parseInt(tR,10),i=this.dateTimeWrapper.getBoundingClientRect().height;return j.isDevice&&this.fullScreenMode?i:i>e?e:i},t.prototype.changeEvent=function(e){o.prototype.changeEvent.call(this,e),(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))},t.prototype.updateValue=function(e){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:e||null,isInteracted:!g(e),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.previousDate=this.value)},t.prototype.setTimeScrollPosition=function(){var e=this.selectedElement;g(e)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)},t.prototype.findScrollTop=function(e){var i=this.getPopupHeight(),r=e.nextElementSibling,n=r?r.offsetTop:e.offsetTop,s=e.getBoundingClientRect().height;if(n+e.offsetTop>i)if(j.isDevice&&this.fullScreenMode){var a=this.dateTimeWrapper.querySelector(".e-content");a.scrollTop=r?n-(i/Hy+s/Hy):n}else this.dateTimeWrapper.scrollTop=r?n-(i/Hy+s/Hy):n;else this.dateTimeWrapper.scrollTop=0},t.prototype.setScrollTo=function(){var e,i=this.dateTimeWrapper.querySelectorAll("."+Ch);if(i.length>=0){this.scrollInvoked=!0;var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=i[Math.round((n-r)/(this.step*6e4))]}else this.dateTimeWrapper.scrollTop=0;g(e)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(e)},t.prototype.setInputValue=function(e){if(e==="date")this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{var i=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));Ie.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0),this.enableMask&&this.createMask()}this.updateIconState()},t.prototype.getFullDateTime=function(){var e=null;return this.isDateObject(this.valueWithMinutes)?e=this.combineDateTime(this.valueWithMinutes):e=this.previousDate,this.validateMinMaxRange(e)},t.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},t.prototype.combineDateTime=function(e){if(this.isDateObject(e)){var i=this.previousDate.getDate(),r=this.previousDate.getMonth(),n=this.previousDate.getFullYear(),s=e.getHours(),a=e.getMinutes(),l=e.getSeconds();return new Date(n,r,i,s,a,l)}else return this.previousDate},t.prototype.onMouseClick=function(e){var i=e.target,r=this.selectedElement=H(i,"."+Ch);r&&r.classList.contains(Ch)&&(this.timeValue=r.getAttribute("data-value"),this.hide(e)),this.setSelection(r,e)},t.prototype.setSelection=function(e,i){if(this.isValidLI(e)&&!e.classList.contains(Sh)){this.selectedElement=e;var r=Array.prototype.slice.call(this.liCollections).indexOf(e);this.activeIndex=r,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),X([this.selectedElement],Sh),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(i)}},t.prototype.setTimeActiveClass=function(){var e=g(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!g(e)){var i=e.querySelectorAll("."+Ch);if(i.length){for(var r=0;r<i.length;r++)if(this.timeCollections[r]===+this.valueWithMinutes){i[r].setAttribute("aria-selected","true"),this.selectedElement=i[r],this.activeIndex=r,this.setTimeActiveDescendant();break}}}},t.prototype.setTimeActiveDescendant=function(){!g(this.selectedElement)&&this.value?Ee(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")}):this.inputElement.removeAttribute("aria-activedescendant")},t.prototype.addTimeSelection=function(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),g(this.selectedElement)||(X([this.selectedElement],Sh),this.selectedElement.setAttribute("aria-selected","true"))},t.prototype.removeTimeSelection=function(){if(this.removeTimeHover(VI),!g(this.dateTimeWrapper)){var e=this.dateTimeWrapper.querySelectorAll("."+Sh);e.length&&(Z(e,Sh),e[0].removeAttribute("aria-selected"))}},t.prototype.removeTimeHover=function(e){var i=this.getTimeHoverItem(e);i&&i.length&&Z(i,e)},t.prototype.getTimeHoverItem=function(e){var i=g(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper,r;return g(i)||(r=i.querySelectorAll("."+e)),r},t.prototype.isValidLI=function(e){return e&&e.classList.contains(Ch)&&!e.classList.contains(HI)},t.prototype.calculateStartEnd=function(e,i,r){var n=e.getDate(),s=e.getMonth(),a=e.getFullYear(),l=e.getHours(),h=e.getMinutes(),c=e.getSeconds(),u=e.getMilliseconds();return i?r==="starttime"?new Date(a,s,n,0,0,0):new Date(a,s,n,23,59,59):new Date(a,s,n,l,h,c,u)},t.prototype.startTime=function(e){var i,r,n=this.min,s=this.max,a=e===null?new Date:e,l=!1,h;return this.minTime?(h=new Date(a.getFullYear(),a.getMonth(),a.getDate(),this.minTime.getHours(),this.minTime.getMinutes(),this.minTime.getSeconds(),this.minTime.getMilliseconds()),l=!0):h=a,+h.getDate()==+n.getDate()&&+h.getMonth()==+n.getMonth()&&+h.getFullYear()==+n.getFullYear()||+new Date(h.getFullYear(),h.getMonth(),h.getDate())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=n,l&&+new Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())&&i.setHours(h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds())):+h<+s&&+h>+n?(r=!l,i=h):+h>=+s&&(r=!0,i=s),this.calculateStartEnd(i,r,"starttime")},t.prototype.TimePopupFormat=function(){var e="",i=0,r=this;function n(s){switch(s){case"d":case"dd":case"ddd":case"dddd":case"M":case"MM":case"MMM":case"MMMM":case"y":case"yy":case"yyy":case"yyyy":e===""?e=e+s:e=e+"/"+s,i=i+1;break}return i>2&&(r.dateFormatString=e),e}return n},t.prototype.endTime=function(e){var i,r,n=this.max,s=e===null?new Date:e,a=!1,l;return this.maxTime?(l=new Date(s.getFullYear(),s.getMonth(),s.getDate(),this.maxTime.getHours(),this.maxTime.getMinutes(),this.maxTime.getSeconds(),this.maxTime.getMilliseconds()),a=!0):l=s,+l.getDate()==+n.getDate()&&+l.getMonth()==+n.getMonth()&&+l.getFullYear()==+n.getFullYear()||+new Date(l.getUTCFullYear(),l.getMonth(),l.getDate())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.max,a&&+new Date(l.getUTCFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())&&i.setHours(l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())):+l<+this.max&&+l>+this.min?(r=!a,i=l):+l<=+this.min&&(r=!0,i=this.min),this.calculateStartEnd(i,r,"endtime")},t.prototype.hide=function(e){var i=this;if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:this.popupObj||this.popupObject,event:e||null};var r=this.preventArgs;g(this.popupObj)?this.trigger("close",r,function(n){i.dateTimeCloseEventCallback(e,n)}):this.dateTimeCloseEventCallback(e,r)}else j.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.dateTimeCloseEventCallback=function(e,i){this.preventArgs=i,this.preventArgs.cancel||(this.isDatePopupOpen()?o.prototype.hide.call(this,e):this.isTimePopupOpen()&&(this.closePopup(e),Z([document.body],sR),j.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),j.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.closePopup=function(e){if(this.isTimePopupOpen()&&this.popupObject){var i={name:"FadeOut",duration:nR,delay:0};this.popupObject.hide(new Mt(i)),this.inputWrapper.container.classList.remove(iR),Ee(this.inputElement,{"aria-expanded":"false"}),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-controls"),T.remove(document,"mousedown touchstart",this.documentClickHandler)}},t.prototype.preRender=function(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.preRender.call(this),Z([this.inputElementCopy],[_f])},t.prototype.getProperty=function(e,i){i==="min"?this.setProperties({min:this.validateValue(e.min)},!0):this.setProperties({max:this.validateValue(e.max)},!0)},t.prototype.checkAttributes=function(e){for(var i=e?g(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"],r,n=0,s=i;n<s.length;n++){var a=s[n];if(!g(this.inputElement.getAttribute(a)))switch(a){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(a));break;case"step":this.step=parseInt(this.inputElement.getAttribute(a),10);break;case"readonly":if(g(this.dateTimeOptions)||this.dateTimeOptions.readonly===void 0||e){var l=this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)===""||this.inputElement.getAttribute(a)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(g(this.dateTimeOptions)||this.dateTimeOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(a)},!e);break;case"min":(g(this.dateTimeOptions)||this.dateTimeOptions.min===void 0||e)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({min:r},!e));break;case"disabled":if(g(this.dateTimeOptions)||this.dateTimeOptions.enabled===void 0||e){var h=!(this.inputElement.getAttribute(a)==="disabled"||this.inputElement.getAttribute(a)==="true"||this.inputElement.getAttribute(a)==="");this.setProperties({enabled:h},!e)}break;case"value":(g(this.dateTimeOptions)||this.dateTimeOptions.value===void 0||e)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({value:r},!e));break;case"max":(g(this.dateTimeOptions)||this.dateTimeOptions.max===void 0||e)&&(r=new Date(this.inputElement.getAttribute(a)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({max:r},!e));break}}},t.prototype.requiredModules=function(){var e=[];return this.calendarMode==="Islamic"&&e.push({args:[this],member:"islamic",name:"Islamic"}),this.enableMask&&e.push(this.maskedDateModule()),e},t.prototype.maskedDateModule=function(){var e={args:[this],member:"MaskedDateTime"};return e},t.prototype.getTimeActiveElement=function(){return g(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll("."+Sh)},t.prototype.createDateObj=function(e){return e instanceof Date?e:null},t.prototype.getDateObject=function(e){if(!this.isNullOrEmpty(e)){var i=this.createDateObj(e),r=this.valueWithMinutes,n=!g(r);if(this.checkDateValue(i)){var s=n?r.getDate():kW,a=n?r.getMonth():FW,l=n?r.getFullYear():RW,h=n?r.getHours():OW,c=n?r.getMinutes():zW,u=n?r.getSeconds():PW,d=n?r.getMilliseconds():BW;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(l,a,s,i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(l,a,s,h,c,u,d)}}return null},t.prototype.findNextTimeElement=function(e){var i=this.inputElement.value,r=g(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,s=this.liCollections.length;if(!g(this.activeIndex)||!g(this.checkDateValue(r))){if(e.action==="home")n=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if(e.action==="end")n=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if(e.action==="down"){for(var a=0;a<s;a++)if(+r<this.timeCollections[a]){n=+this.createDateObj(new Date(this.timeCollections[a])),this.activeIndex=a;break}}else for(var a=s-1;a>=0;a--)if(+r>this.timeCollections[a]){n=+this.createDateObj(new Date(this.timeCollections[a])),this.activeIndex=a;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(g(n)?null:new Date(n))}},t.prototype.setTimeValue=function(e,i){var r,n,s=this.validateMinMaxRange(i),a=this.createDateObj(s);return this.getFormattedValue(a)!==(g(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=g(a)?null:a,n=new Date(+this.valueWithMinutes)):(this.strictMode&&(e=a),this.valueWithMinutes=this.checkDateValue(e),n=new Date(+this.valueWithMinutes)),this.calendarMode==="Gregorian"?r=this.globalize.formatDate(n,{format:g(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd"}):r=this.globalize.formatDate(n,{format:g(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&g(n)?Ie.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton):Ie.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton),n},t.prototype.timeElementValue=function(e){if(!g(this.checkDateValue(e))&&!this.isNullOrEmpty(e)){var i=e instanceof Date?e:this.getDateObject(e);return this.setTimeValue(i,e)}return null},t.prototype.timeKeyHandler=function(e){if(!(g(this.step)||this.step<=0)){var i=this.timeCollections.length;if(g(this.getTimeActiveElement())||this.getTimeActiveElement().length===0)this.liCollections.length>0&&(g(this.value)&&g(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(e));else{var r=void 0;if(e.keyCode>=37&&e.keyCode<=40){var n=e.keyCode===40||e.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=n=this.activeIndex===i?0:this.activeIndex,this.activeIndex=n=this.activeIndex<0?i-1:this.activeIndex,r=g(this.timeCollections[n])?this.timeCollections[0]:this.timeCollections[n]}else e.action==="home"?(this.activeIndex=0,r=this.timeCollections[0]):e.action==="end"&&(this.activeIndex=i-1,r=this.timeCollections[i-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(r))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,_W),this.setTimeActiveDescendant(),this.isTimePopupOpen()&&this.selectedElement!==null&&(!e||e.type!=="click")&&this.setTimeScrollPosition()}},t.prototype.timeKeyActionHandle=function(e){if(this.enabled)switch(e.action!=="right"&&e.action!=="left"&&e.action!=="tab"&&e.preventDefault(),e.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(e),this.hide(e),X([this.inputWrapper.container],Uf),this.isNavigate=!1,e.stopPropagation();break;case"escape":this.hide(e);break;default:this.isNavigate=!1;break}},t.prototype.inputKeyAction=function(e){switch(e.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(e);break}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r],a=["blur","change","cleared","close","created","destroyed","focus","navigated","open","renderDayCell"];switch(a.indexOf(s)>0&&this.isReact&&(this.isDynamicValueChanged=!0),s){case"value":this.isDynamicValueChanged=!0,this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,e.value=this.validateValue(e.value),this.enableMask?Ie.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton):Ie.setValue(this.getFormattedValue(e.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=e.value,this.setProperties({value:e.value},!0),this.popupObj&&this.popupUpdate(),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null),this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.value&&this.notify("createMask",{module:"MaskedDateTime"});break;case"min":case"max":this.getProperty(e,s),this.updateInput();break;case"enableRtl":Ie.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":g(i.cssClass)||(i.cssClass=i.cssClass.replace(/\s+/g," ").trim()),g(e.cssClass)||(e.cssClass=e.cssClass.replace(/\s+/g," ").trim()),Ie.setCssClass(e.cssClass,[this.inputWrapper.container],i.cssClass),this.dateTimeWrapper&&Ie.setCssClass(e.cssClass,[this.dateTimeWrapper],i.cssClass);break;case"locale":this.globalize=new Nt(this.locale),this.l10n.setLocale(this.locale),this.dateTimeOptions&&this.dateTimeOptions.placeholder==null&&(this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ie.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.updateInput.call(this);break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||Ie.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;case"placeholder":Ie.setPlaceholder(e.placeholder,this.inputElement);break;case"enabled":Ie.setEnabled(this.enabled,this.inputElement),this.enabled?this.inputElement.setAttribute("tabindex",this.tabIndex):this.inputElement.tabIndex=-1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width),Ie.calculateWidth(this.inputElement,this.inputWrapper.container),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"readonly":Ie.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Ie.removeFloating(this.inputWrapper),Ie.addFloating(this.inputElement,this.floatLabelType,this.placeholder),!g(this.inputWrapper.buttons[0])&&!g(this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0])&&this.floatLabelType!=="Never"&&this.inputWrapper.container.getElementsByClassName("e-float-text-overflow")[0].classList.add("e-date-time-icon");break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(e.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),Ie.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton)):this.inputElement.value===this.maskedDateValue&&(this.maskedDateValue="",Ie.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;default:o.prototype.onPropertyChanged.call(this,e,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},t.prototype.updateLabelOverflowWidth=function(){for(var e=this.inputWrapper.container,i=e.querySelector(".e-float-text.e-label-bottom"),r=0,n=".e-input-group-icon, .e-clear-icon",s=e.querySelectorAll(n),a=0;a<s.length;a++)r+=s[a].offsetWidth;if(i){var l=this.element.parentElement.offsetWidth-r;l&&(i.style.width=l+"px")}},t.prototype.clearLabelOverflowWidth=function(){var e=this.inputWrapper.container,i=e.querySelector(".e-float-text.e-label-top");i&&i.removeAttribute("style")},t.prototype.getModuleName=function(){return"datetimepicker"},t.prototype.restoreValue=function(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=g(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)},oi([w(null)],t.prototype,"timeFormat",void 0),oi([w(30)],t.prototype,"step",void 0),oi([w(null)],t.prototype,"scrollTo",void 0),oi([w(1e3)],t.prototype,"zIndex",void 0),oi([w(null)],t.prototype,"value",void 0),oi([w(null)],t.prototype,"keyConfigs",void 0),oi([w({})],t.prototype,"htmlAttributes",void 0),oi([w(!1)],t.prototype,"enablePersistence",void 0),oi([w(!0)],t.prototype,"allowEdit",void 0),oi([w(!1)],t.prototype,"isMultiSelection",void 0),oi([w(null)],t.prototype,"values",void 0),oi([w(!0)],t.prototype,"showClearButton",void 0),oi([w(null)],t.prototype,"placeholder",void 0),oi([w(!1)],t.prototype,"strictMode",void 0),oi([w(!1)],t.prototype,"fullScreenMode",void 0),oi([w(null)],t.prototype,"serverTimezoneOffset",void 0),oi([w(new Date(1900,0,1))],t.prototype,"min",void 0),oi([w(new Date(2099,11,31))],t.prototype,"max",void 0),oi([w(null)],t.prototype,"minTime",void 0),oi([w(null)],t.prototype,"maxTime",void 0),oi([w(null)],t.prototype,"firstDayOfWeek",void 0),oi([w("Gregorian")],t.prototype,"calendarMode",void 0),oi([w("Month")],t.prototype,"start",void 0),oi([w("Month")],t.prototype,"depth",void 0),oi([w(!1)],t.prototype,"weekNumber",void 0),oi([w(!0)],t.prototype,"showTodayButton",void 0),oi([w("Short")],t.prototype,"dayHeaderFormat",void 0),oi([w(!1)],t.prototype,"openOnFocus",void 0),oi([w(!1)],t.prototype,"enableMask",void 0),oi([w({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),oi([G()],t.prototype,"open",void 0),oi([G()],t.prototype,"close",void 0),oi([G()],t.prototype,"cleared",void 0),oi([G()],t.prototype,"blur",void 0),oi([G()],t.prototype,"focus",void 0),oi([G()],t.prototype,"created",void 0),oi([G()],t.prototype,"destroyed",void 0),t=oi([It],t),t})(UI);var WW=(function(){function o(t){this.intl=new Nt,g(t)||(this.intl.culture=t)}return o.prototype.getFormatFunction=function(t){return!g(t)&&(t.type==="dateTime"||t.type==="datetime"||t.type==="date"||t.type==="time")?this.intl.getDateFormat(t):this.intl.getNumberFormat(t)},o.prototype.getParserFunction=function(t){return t.type?this.intl.getDateParser(t):this.intl.getNumberParser(t)},o.prototype.fromView=function(t,e,i){return(i==="date"||i==="datetime"||i==="number")&&!g(e)&&!g(t)?e(t):t},o.prototype.toView=function(t,e){var i=t;return!g(e)&&!g(t)&&(i=e(t)),i},o.prototype.setCulture=function(t){g(t)||VL(t)},o})();var lR="actionBegin",Vy="actionComplete";var WI="filterchoicerequest",qW="filterAfterOpen",YW="filterBeforeOpen",GW="filterSearchBegin";var Gf="filterDialogCreated",QW="filter-menu-close";var qI="generateQuery";var XW="foreignKeyData";var CR="dataStateChange";var KW="beforeCustomFilterOpen",Qy="customFilterOpen";var $W="cbox-filter-begin",hR="cbox-filter-complete",Dc="filter-Prevent",Xy="before-filter-cmenu-open";var Ky="filter-cbox-value";var ZW="beforeCheckboxRenderer";var xh="filter-dialog-close",cR="refresh-cutsom-filter-ok-button",JW="refresh-cutsom-filter-clear-button",uR="render-responsive-cmenu",$y="filter-cmenu-select",eq="custom-filter-close";var tq="before-checkbox-renderer-query";var iq="after-filter-column-menu-close",rq="beforeCheckboxfilterRenderer";var nq="e-gridheader",sq="e-gridcontent";var aq="colgroup",_y="open",Uy="change",Wy="focus";function oq(o,t,e){return g(o)||o===""?"":ge.getObject(o,t)}function Wf(o,t,e,i){for(var r=pe(o,t,e),n=Object.keys(r),s=0;s<n.length;s++)i&&i.indexOf(n[parseInt(s.toString(),10)])!==-1&&delete r[n[parseInt(s.toString(),10)]];return r}function dR(o){return o instanceof Oe?V("properties",o):o}function Fr(o,t,e){for(var i=o;i&&!(e?i.id===t:i.classList.contains(t));)i=i.parentElement;return i}var lq=0;function Ro(o){return o+lq++}function nd(o,t){for(var e=0,i=t.length;e<i;e++)i===t.length?o.appendChild(t[parseInt(e.toString(),10)]):o.appendChild(t[0]);return o}function Il(o){return o.split(".").length>1}function wh(o){return o===void 0&&(o=""),o.replace(/\./g,"___")}function hq(o){for(var t={},e=[],i=0;i<o.length;i++)o[parseInt(i.toString(),10)]in t||(e.push(o[parseInt(i.toString(),10)].toString()),t[o[parseInt(i.toString(),10)]]=1);return e}function cq(o,t,e){var i=t.element.style.display;t.element.style.display="block";var r=t.width,n=Nm(o,t.element);t.element.style.display=i,t.element.style.top=n.top+o.getBoundingClientRect().height-5+"px";var s=n.left-r+o.clientWidth;if(e&&e.enableRtl){var a=e.element?e.element.clientWidth:0,l=o.getBoundingClientRect().right+r-a;l>1?t.element.style.left=s-4+"px":t.element.style.left=r+s-16+"px",parseInt(t.element.style.left,10)<0&&(t.element.style.left="0px")}else if(s<1?t.element.style.left=r+s-16+"px":t.element.style.left=s-4+"px",e&&e.element){var h=e.element.offsetWidth-parseInt(t.element.style.left,10);e.element.offsetWidth>=r&&h<r&&(t.element.style.left=e.element.offsetWidth-r+"px")}}function Mc(o){var t=o.querySelector(".e-frame"),e=t.previousSibling;t.classList.contains("e-check")?(e.checked=!1,Ai(t,["e-uncheck"],["e-check"])):(e.checked=!0,Ai(t,["e-check"],["e-uncheck"]))}function qy(o,t){o.checked=t}function Ml(o,t,e){var i=et("div",{className:e});return i.appendChild(t),i.setAttribute("data-uid",o),i}function uq(o,t){Z([o],["e-check","e-stop","e-uncheck"]),t?o.classList.add("e-check"):o.classList.add("e-uncheck")}function pR(o,t,e,i){var r=o.foreignKeyField,n=g(e)?oq(o.field,t):e;n=g(n)?"":n;var s=new Pe,a=i||(o.dataSource instanceof oe&&o.dataSource.dataSource.json.length?o.dataSource.dataSource.json:o.columnData);return n.getDay?s.where(qf({field:r,operator:"equal",value:n,matchCase:!1})):s.where(r,"==",n,!1),new oe(a).executeLocal(s)}function dq(o,t){var e;return t.some(function(i){return e=i,i.foreignKeyValue===o})&&e}function sd(o){return o<10?"0"+o:String(o)}function qf(o,t){var e,i,r,n=pe({},dR(o)),s=pe({},dR(o));if(g(o.value)||o.value==="")return e=new xt(n.field,n.operator,n.value,!1),e;var a=new Date(o.value);if(t==="dateonly"){typeof n.value=="string"&&(n.value=new Date(n.value));var l=n.value.getFullYear()+"-"+sd(n.value.getMonth()+1)+"-"+sd(n.value.getDate()),h=new xt(n.field,n.operator,l,!1);e=h}else if(o.operator=o.operator.toLowerCase(),o.operator==="equal"||o.operator==="notequal"){t==="datetime"?(i=new Date(a.setSeconds(a.getSeconds()-1)),r=new Date(a.setSeconds(a.getSeconds()+2)),o.value=new Date(a.setSeconds(r.getSeconds()-1))):(i=new Date(a.setHours(0)-1),r=new Date(a.setHours(24))),n.value=i,s.value=r,o.operator==="equal"?(n.operator="greaterthan",s.operator="lessthan"):o.operator==="notequal"&&(n.operator="lessthanorequal",s.operator="greaterthanorequal");var c=new xt(n.field,n.operator,n.value,!1),u=new xt(s.field,s.operator,s.value,!1);e=o.operator==="equal"?c.and(u):c.or(u)}else{t==="date"&&(o.operator==="lessthanorequal"||o.operator==="greaterthan")&&(n.value=new Date(a.setHours(24)-1)),typeof n.value=="string"&&(n.value=new Date(n.value));var h=new xt(n.field,n.operator,n.value,!1);e=h}return o.setProperties?o.setProperties({ejpredicate:e},!0):o.ejpredicate=e,e}function fR(o,t){if(o===void 0&&(o=""),o){for(var e=t,i=o.split("."),r=0;r<i.length&&!g(e);r++)if(e=e[i[parseInt(r.toString(),10)]],Te(e)){var n=i[parseInt(r.toString(),10)].charAt(0).toUpperCase()+i[parseInt(r.toString(),10)].slice(1);e=t[""+n]||t[(""+n).charAt(0).toLowerCase()+(""+n).slice(1)]}return e}}function gR(o,t){var e=new Nt,i,r="format",n="type";return t==="date"?i=typeof o=="object"?e.getDatePattern({type:o[""+n]?o[""+n]:"date",format:o[""+r]},!1):e.getDatePattern({type:"dateTime",skeleton:o},!1):i=typeof o=="object"?e.getDatePattern({type:o[""+n]?o[""+n]:"dateTime",format:o[""+r]},!1):e.getDatePattern({type:"dateTime",skeleton:o},!1),i}function pq(o,t,e,i){var r=o||{},n=arguments.length;i&&(n=n-1);for(var s=1;s<n;s++)if(arguments[parseInt(s.toString(),10)])for(var a=arguments[parseInt(s.toString(),10)],l=Object.keys(Object.getPrototypeOf(a)).length?Object.keys(a).concat(fq(a)):Object.keys(a),h=0;h<l.length;h++){var c=r[l[parseInt(h.toString(),10)]],u=a[l[parseInt(h.toString(),10)]],d=void 0;i&&(Ls(u)||Array.isArray(u))?Ls(u)?(d=c||{},r[l[parseInt(h.toString(),10)]]=pe({},d,u,i)):(d=c||[],r[l[parseInt(h.toString(),10)]]=pe([],d,u,i)):r[l[parseInt(h.toString(),10)]]=u}return r}function fq(o){for(var t=[];Object.getPrototypeOf(o)&&Object.keys(Object.getPrototypeOf(o)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(o))),o=Object.getPrototypeOf(o);return t}var Yf=(function(o){return o.timer=null,o})(Yf||{});function vR(o,t){o.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function wR(o,t){var e=gq(t),i=new zn;return e.dataSource=i.resolve,e.action=o,{state:e,deffered:i}}function gq(o){var t=new hc,e=new oe({url:"",adaptor:new hc}),i=t.processQuery(e,o),r=JSON.parse(i.data);return r}function xR(o,t){var e=o.createElement("div",{className:"e-grid-popup",id:o.element.id+"_e-popup"}),i=Ar(o.element,"left","Top");document.getElementById(o.element.id+"_e-popup")&&(e=document.getElementById(o.element.id+"_e-popup")),e.style.top=i.top+"px",e.style.left=i.left+"px",e.style.zIndex=t.zIndex.toString(),e.style.width=t.element.offsetWidth+"px",e.appendChild(t.element);var r=document.querySelector(".sb-demo-section,.e-grid-dialog-fixed");if(r){var n=Nm(o.element,r);e.style.top=n.top+"px",e.style.left=n.left+"px",r.insertBefore(e,r.firstChild)}else document.body.insertBefore(e,document.body.firstChild)}function mR(o,t){for(var e,i=o.split(".").length,r=o.split("."),n=t,s=0;s<i;s++)e=n[r[parseInt(s.toString(),10)]],n=e;return e}function yR(o,t,e,i){i.eventHandlers[""+o]={};for(var r=0;r<t.length;r++)i.eventHandlers[""+o][t[parseInt(r.toString(),10)]]=e[t[parseInt(r.toString(),10)]]}function bR(o,t,e){for(var i=0;i<t.length&&!o.isDestroyed;i++)o.removeEventListener(t[parseInt(i.toString(),10)],e.eventHandlers[o.element.id][t[parseInt(i.toString(),10)]])}function YI(o,t,e){o.destroyTemplate(t,void 0,e),o.isReact&&o.renderTemplates()}function Yy(o){for(var t=0;t<o.length;t++)Qe(o[t])}function SR(o,t){for(var e=0;e<o.length;e++)t.insertBefore(o[e],t.children[e])}function Gy(o,t){var e=t?et("li",{className:"e-cclist"}):et("div",{className:"e-ftrchk"});e.style.visibility="hidden",t&&(e.style.listStyle="none"),e.innerHTML=t?'<div class="e-ccheck"><div class="e-checkbox-wrapper"><span class="e-frame e-icons e-check"></span><span class="e-label">A</span></div></div>':'<div class="e-checkbox-wrapper"><span class="e-frame e-icons e-check"></span><span class="e-label e-checkboxfiltertext">A</div></span>',o.appendChild(e);var i=e.getBoundingClientRect();o.removeChild(e);var r=Math.round(i.height);return r}var Zy=(function(){function o(t){this.searchInputArgs=null,this.queryFilteredColumn=[],this.existingPredicate={},this.foreignKeyQuery=new Pe,this.filterState=!0,this.values={},this.renderEmpty=!1,this.isCheckboxFilterTemplate=!1,this.infiniteRenderMod=!1,this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1,this.infinitePermenantLocalData=[],this.infiniteQueryExecutionPending=!1,this.infiniteSkipCnt=0,this.infiniteScrollAppendDiff=0,this.prevInfiniteScrollDirection="",this.infiniteLoadedElem=[],this.infiniteDataCount=0,this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteManualSelectMaintainPred=[],this.parent=t,this.id=this.parent.element.id,this.valueFormatter=new WW(this.parent.locale),this.cBoxTrue=hl(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=hl(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&X([this.cBoxTrue,this.cBoxFalse],["e-rtl"]),this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?X([this.cBoxTrue,this.cBoxFalse],this.parent.cssClass.split(" ")):X([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass]))}return o.prototype.destroy=function(){this.closeDialog()},o.prototype.wireEvents=function(){T.add(this.dlg,"click",this.clickHandler,this),T.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=sm(this.searchBoxKeyUp,200);var t=this.dialogObj.element.querySelector(".e-searchinput");t&&(T.add(t,"keyup",this.searchHandler,this),T.add(t,"input",this.searchHandler,this))},o.prototype.unWireEvents=function(){T.remove(this.dlg,"click",this.clickHandler),T.remove(this.dlg,"keyup",this.keyupHandler);var t=this.dialogObj.element.querySelector(".e-searchinput");t&&(T.remove(t,"keyup",this.searchHandler),T.remove(t,"input",this.searchHandler))},o.prototype.foreignKeyFilter=function(t,e,i){var r=this,n={},s=[],a=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(a.where(i)).then(function(l){r.options.column.columnData=l.result,r.parent.notify(qI,{predicate:n,column:r.options.column}),t.ejpredicate=n.predicate.predicates;for(var h=n.predicate.predicates,c=0;c<h.length;c++)s.push({field:h[parseInt(c.toString(),10)].field,predicate:"or",matchCase:h[parseInt(c.toString(),10)].ignoreCase,ignoreAccent:h[parseInt(c.toString(),10)].ignoreAccent,operator:h[parseInt(c.toString(),10)].operator,value:h[parseInt(c.toString(),10)].value,type:r.options.type});t.filterCollection=s.length?s:e.filter(function(u){return u.field=r.options.field}),r.options.handler(t)})},o.prototype.searchBoxClick=function(t){var e=t.target;e.classList.contains("e-searchclear")&&(this.sInput.value=e.classList.contains("e-chkcancel-icon")?"":this.sInput.value,this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:t}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},o.prototype.searchBoxKeyUp=function(t){g(this.sInput)||(g(t)||t.key!=="ArrowUp"&&t.key!=="ArrowDown"&&t.key!=="Tab"&&!(t.key==="Tab"&&t.shiftKey))&&(!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&this.parent.showMaskRow(void 0,this.dialogObj.element),this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:t}):this.refreshCheckboxes(),this.updateSearchIcon())},o.prototype.updateSearchIcon=function(){this.sInput.value.length?(Ai(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]),g(document.body.querySelector(".e-chkcancel-icon"))||document.body.querySelector(".e-chkcancel-icon").setAttribute("title",this.localeObj.getConstant("Clear"))):(Ai(this.sIcon,["e-search-icon"],["e-chkcancel-icon"]),g(document.body.querySelector(".e-searchclear.e-search-icon"))||document.body.querySelector(".e-searchclear.e-search-icon").setAttribute("title",this.localeObj.getConstant("Search")))},o.prototype.getLocalizedLabel=function(t){return this.localeObj.getConstant(t)},o.prototype.updateDataSource=function(){var t=this.options.dataSource,e="object";if(!(t instanceof oe)){for(var i=0;i<t.length;i++)if(typeof t!==e){var r={};r[this.options.field]=t[parseInt(i.toString(),10)],t[parseInt(i.toString(),10)]=r}}},o.prototype.updateModel=function(t){this.options=t,this.existingPredicate=t.actualPredicate||{},this.options.dataSource=t.dataSource,this.options.dataManager=t.dataManager?t.dataManager:t.dataSource,this.updateDataSource(),this.options.type=t.type,this.options.format=t.format||"",this.options.ignoreAccent=t.ignoreAccent||!1,this.options.filteredColumns=t.filteredColumns||this.parent.filterSettings.columns,this.options.query=t.query||new Pe,this.options.allowCaseSensitive=t.allowCaseSensitive||!1,this.options.uid=t.column.uid,this.options.disableHtmlEncode=t.column.disableHtmlEncode||!1,this.values={},this.localeObj=t.localeObj,this.isFiltered=t.filteredColumns.length,this.infiniteRenderMod=!!(this.parent.filterSettings&&this.parent.filterSettings.enableInfiniteScrolling),this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[]},o.prototype.getAndSetChkElem=function(t){return this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{"data-uid":this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),t.hideSearchbox||(this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox),this.searchInputArgs={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search"),cssClass:this.parent.cssClass}},Ie.createInput(this.searchInputArgs,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)),this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},o.prototype.showDialog=function(t){var e={requestType:YW,columnName:this.options.field,columnType:this.options.type,cancel:!1},i="filterModel";if(e[""+i]=this,this.parent.notify($W,e),e.cancel){t.cancel=e.cancel;return}this.dialogObj=new cc({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!g(Fr(t.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""});var r="isStringTemplate";this.dialogObj[""+r]=!0,this.renderResponsiveFilter(t);var n=this.parent.filterSettings&&this.parent.filterSettings.type==="CheckBox"?this.getLocalizedLabel("CheckBoxFilterDialogARIA"):this.getLocalizedLabel("ExcelFilterDialogARIA");if(this.dlg.setAttribute("aria-label",n),t.isResponsiveFilter){var s=document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv");s.appendChild(this.dlg)}else this.parent.element.appendChild(this.dlg);this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=t.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show(),this.parent&&this.parent.filterSettings&&(this.parent.filterSettings.type==="CheckBox"||this.options.column&&this.options.column.filter&&this.options.column.filter.type==="CheckBox")&&this.parent.getContent().firstElementChild.offsetHeight<this.dialogObj.element.offsetHeight&&!Fr(this.parent.element,"e-gantt-dialog")&&xR(this.parent,this.dialogObj);var a=this.dialogObj.element.querySelector(".e-dlg-content");if(a.appendChild(this.sBox),this.wireEvents(),!this.parent.enableAdaptiveUI)!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&!this.infiniteRenderMod&&this.parent.showMaskRow(void 0,this.dialogObj.element),this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.showMask();else{if(this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"){this.getAllData();return}this.infiniteRenderMod&&(this.cBox.style.marginTop=Gy(this.cBox)+"px")}this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"||(Qs({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),vs(this.spinner)),this.getAllData()},o.prototype.renderResponsiveFilter=function(t){t.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},o.prototype.dialogCreated=function(t){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":j.isDevice?this.dialogObj.position={X:"center",Y:"center"}:cq(this.options.target,this.dialogObj,this.parent),this.options.column.showColumnMenu&&this.parent.notify(Gf,t)},o.prototype.openDialog=function(t){this.updateModel(t),this.getAndSetChkElem(t),this.showDialog(t)},o.prototype.closeDialog=function(){if(this.infiniteRenderMod&&this.infinitePermenantLocalData.length&&!this.options.isRemote&&(this.options.dataSource.dataSource.json=this.infinitePermenantLocalData),this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var t=this.options.columns.filter(function(r){return r.getFilterItemTemplate()}),e=this.parent.registeredTemplate;if(t.length&&!g(e)&&e.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&YI(this.parent,["filterItemTemplate"]),this.parent.notify(QW,{field:this.options.field}),this.unWireEvents(),this.searchInputArgs&&this.searchInputArgs.element&&this.searchInputArgs.element.parentElement&&(Ie.destroy(this.searchInputArgs),Qe(this.searchInputArgs.element)),this.searchInputArgs=null,this.sInput=null,this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string"&&(this.options.column.filter.type==="CheckBox"||this.options.column.filter.type==="Excel")&&(this.dialogObj.element.querySelector(".e-dlg-content").innerHTML=""),this.dialogObj.destroy(),this.dialogObj.dlgClosedBy==="escape"&&(this.parent.isColumnMenuFilterClosing=!0),this.dlg&&this.dlg.parentElement){Qe(this.dlg);var i=document.getElementById(this.parent.element.id+"_e-popup");g(i)||(Qe(i),i=null)}this.dlg=null,this.parent.notify(xh,{})}},o.prototype.clearFilter=function(t){var e={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(Dc,e),!e.cancel&&this.options.handler({action:"clear-filter",field:t?t.field:this.options.field})},o.prototype.btnClick=function(t){if(this.filterState){if(t.target.tagName.toLowerCase()==="input"&&t.target.classList.contains("e-searchinput")||t.keyCode===13)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var e=t.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===e?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===e&&this.clearFilter()}this.closeDialog()}else t.target&&t.target.firstChild&&t.target.firstChild.textContent.toLowerCase()===this.getLocalizedLabel("CancelButton").toLowerCase()?this.closeDialog():t.target.tagName.toLowerCase()!=="input"&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify(iq,{}),g(this.parent.focusModule)||this.parent.focusModule.filterfocus()},o.prototype.fltrBtnHandler=function(){var t=this;this.infiniteRenderMod&&(this.cBox.innerHTML="",nd(this.cBox,this.infiniteLoadedElem.slice()));var e=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)")),i=e,r="equal",n=this.dialogObj.element.querySelector(".e-dropdownlist");n&&(this.options.operator=r=n.ej2_instances[0].value),this.isMenuNotEqual=this.options.operator==="notequal";var s;this.options.hideSearchbox||(s=this.searchBox.querySelector(".e-searchinput"));var a=this.options.allowCaseSensitive,l={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:r,type:this.options.type,matchCase:a,ignoreAccent:this.options.ignoreAccent},h=this.itemsCnt!==e.length&&this.itemsCnt-e.length<e.length;h&&s&&s.value===""&&(r=this.isMenuNotEqual?"equal":"notequal",e=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),l.predicate=this.isMenuNotEqual?"or":"and",l.operator=r);var c,u,d=[];if(e.length!==this.itemsCnt||s&&s.value&&s.value!==""||this.infiniteRenderMod){if(this.infiniteRenderMod)this.infiniteRenderMod&&(!this.infiniteSearchPred||this.infiniteSearchPred&&!this.infiniteSearchPred.isComplex)?this.infiniteFltrBtnHandler(d):this.infiniteSearchPred.isComplex&&(d=this.complexQueryPredicate(e,l,h));else{if(d=this.complexQueryPredicate(e,l,h),g(d))return;d=this.filterPreventColumns?this.filterPreventColumns:d}(this.options.type==="date"||this.options.type==="dateonly"||this.options.type==="datetime")&&i.length&&(u=i.length-1,c=this.values[Fr(i[parseInt(u.toString(),10)],"e-ftrchk").getAttribute("data-uid")],g(c)&&h&&d.push({field:l.field,matchCase:l.matchCase,operator:"equal",predicate:"or",value:null}));var p=this.infiniteRenderMod?this.sBox.querySelector(".e-add-current"):this.cBox.querySelector(".e-add-current");if(p&&p.classList.contains("e-check")){var f=this.existingPredicate[this.options.field];if(f)for(var v=function(b){d.some(function(S){return S.value===f[parseInt(b.toString(),10)].value})||d.push(f[parseInt(b.toString(),10)])},m=0;m<f.length;m++)v(m);else return}if(!this.infiniteRenderMod)this.initiateFilter(d);else if(d.length)this.initiateFilter(d);else if(this.sBox.querySelector(".e-selectall").classList.contains("e-check")&&!d.length){var y=this.options.filteredColumns.some(function(b){return t.options.field===b.field});y&&this.clearFilter()}}else{var y=this.options.filteredColumns.some(function(S){return t.options.field===S.field});y&&this.clearFilter()}},o.prototype.complexQueryPredicate=function(t,e,i){for(var r,n,s=[],a=0;a<t.length;a++)r=this.values[Fr(t[parseInt(a.toString(),10)],"e-ftrchk").getAttribute("data-uid")],n=pe({},{value:r},e),r&&!r.toString().length&&(n.operator=i?"notequal":"equal"),r===""||g(r)?s=s.concat(o.generateNullValuePredicates(e)):s.push(n);var l=this.filterPreventColumns&&this.filterPreventColumns.length?this.filterPreventColumns[0]:n;return l&&!this.notifyFilterPrevEvent(l)?(this.filterPreventColumns=s,null):s},o.prototype.infiniteFltrBtnHandler=function(t){var e;if(this.infiniteManualSelectMaintainPred.length)for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(e=r.value+"",e===""||g(e)){var n={predicate:r.predicate,field:r.field,type:r.type,uid:r.uid,operator:r.operator,matchCase:r.matchCase,ignoreAccent:r.ignoreAccent};t.push.apply(t,o.generateNullValuePredicates(n))}else t.push(this.infiniteManualSelectMaintainPred[i]);this.notifyFilterPrevEvent(this.infiniteManualSelectMaintainPred[i])}if(!this.localInfiniteSelectAllClicked&&this.sInput.value===""&&!(!this.options.parentCurrentViewDataCount&&t.length))for(var i=0;i<this.infiniteUnloadParentExistPred.length;i++)t.unshift(this.infiniteUnloadParentExistPred[i]),this.notifyFilterPrevEvent(this.existingPredicate[this.options.field][i]);this.sInput.value!==""&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll)&&(this.infiniteSearchPred.predicate="or",t.unshift(this.infiniteSearchPred),this.notifyFilterPrevEvent(this.infiniteSearchPred))},o.prototype.notifyFilterPrevEvent=function(t){var e={instance:this,handler:this.fltrBtnHandler,arg1:t.field,arg2:t.predicate,arg3:t.operator,arg4:t.matchCase,arg5:t.ignoreAccent,arg6:t.value,cancel:!1};return this.parent.notify(Dc,e),!e.cancel},o.generateNullValuePredicates=function(t){var e=[];return t.type==="string"&&e.push({field:t.field,ignoreAccent:t.ignoreAccent,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:""}),e.push({field:t.field,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:null}),e.push({field:t.field,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:void 0}),e},o.prototype.initiateFilter=function(t){var e=t[0];e&&e.type==="dateonly"&&(e.value=e.value instanceof Date?e.value.getFullYear()+"-"+sd(e.value.getMonth()+1)+"-"+sd(e.value.getDate()):e.value);var i;if(!g(e)){i=e.ejpredicate?e.ejpredicate:new xt(e.field,e.operator,e.value,!e.matchCase,e.ignoreAccent);for(var r=1;r<t.length;r++)i=t[parseInt(r.toString(),10)].ejpredicate!==void 0?i[t[parseInt(r.toString(),10)].predicate](t[parseInt(r.toString(),10)].ejpredicate):i[t[parseInt(r.toString(),10)].predicate](t[parseInt(r.toString(),10)].field,t[parseInt(r.toString(),10)].operator,t[parseInt(r.toString(),10)].value,!t[parseInt(r.toString(),10)].matchCase,t[parseInt(r.toString(),10)].ignoreAccent);var n={action:"filtering",filterCollection:t,field:this.options.field,ejpredicate:xt.or(i)};this.options.handler(n)}},o.prototype.isForeignColumn=function(t){return t.isForeignColumn?t.isForeignColumn():!1},o.prototype.refreshCheckboxes=function(){var t=this,e=this.sInput.value,i=this.options.column,r=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),n=this.options.query.clone(),s=r.queries.filter(function(S){return S&&S.fn==="onWhere"})[0];r.queries=[],n.queries=[];var a=this.options.type!=="string"&&parseFloat(e)?parseFloat(e):e,l=this.options.isRemote?this.options.type==="string"?"contains":"equal":this.options.type?"contains":"equal",h=!0,c=this.options.ignoreAccent,u=this.isForeignColumn(i)?i.foreignKeyValue:i.field;a=a===""||a===void 0?void 0:a;var d=[],p={field:u,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:h,ignoreAccent:c},f,v=this.options.dataManager.adaptor.getModuleName;if(this.options.type==="boolean"&&(a!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())!==-1?a="true":a!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())!==-1&&(a="false"),a!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())!==-1&&v?a=(v(),!0):a!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())!==-1&&v&&(a=(v(),!1)),l="equal"),(this.options.type==="date"||this.options.type==="datetime"||this.options.type==="dateonly")&&this.options.format){var m=new Nt,y=typeof this.options.format=="string"?this.options.format:this.options.format.format;y?a=m.parseDate(e,{format:y})||new Date(e):a=new Date(e),this.options.type==="dateonly"&&(a=a.getFullYear()+"-"+sd(a.getMonth()+1)+"-"+sd(a.getDate()))}this.infiniteSearchValChange=!0,this.infiniteLoadedElem=[],this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!1,this.localInfiniteSelectionInteracted=!1,this.infiniteSkipCnt=0,this.infiniteDataCount=0,this.infiniteManualSelectMaintainPred=[],this.sInput.value===""?this.infiniteUnloadParentExistPred=this.infiniteRenderMod&&this.existingPredicate[this.options.column.field]?this.existingPredicate[this.options.column.field].slice():[]:this.infiniteUnloadParentExistPred=[],this.isForeignColumn(i)||this.addDistinct(r);var b={requestType:GW,filterModel:this,columnName:u,column:i,operator:l,matchCase:h,ignoreAccent:c,filterChoiceCount:null,query:r,value:a,cancel:!1};this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(b.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(lR,b,function(S){if(!S.cancel){if(S.operator=S.operator,f=new xt(u,S.operator,b.value,S.matchCase,S.ignoreAccent),t.options.type==="date"||t.options.type==="datetime"||t.options.type==="dateonly"){l="equal";var C={field:u,operator:l,value:a,matchCase:h,ignoreAccent:c};g(a)||(f=qf(C,t.options.type))}if(e&&typeof e=="string"&&t.isBlanks&&t.getLocalizedLabel("Blanks").toLowerCase().indexOf(e.toLowerCase())>=0){d=d.concat(o.generateNullValuePredicates(p));var x=o.generatePredicate(d);x.predicates.push(f),f=x,r.where(x)}else e.length?(f=g(s)?f:f.and(s.e),r.where(f)):g(s)||(f=s.e,r.where(s.e));t.infiniteSearchPred=f,S.filterChoiceCount=g(S.filterChoiceCount)?1e3:S.filterChoiceCount,t.infiniteRenderMod&&t.parent.filterSettings.itemsCount!==S.filterChoiceCount&&(t.parent.filterSettings.itemsCount=b.filterChoiceCount);var I={};if(vs(t.spinner),t.renderEmpty=!1,t.isForeignColumn(i)&&e.length){var D="result"in i.dataSource?new oe(i.dataSource.result):i.dataSource;D.executeQuery(r).then(function(M){var E=t.options.column.columnData;t.options.column.columnData=M.result,t.parent.notify(qI,{predicate:I,column:i}),I.predicate.predicates.length?n.where(I.predicate):t.renderEmpty=!0,t.options.column.columnData=E,t.infiniteRenderMod?(t.infiniteInitialLoad=!!g(t.fullData),t.makeInfiniteScrollRequest(n),n.requiresCount()):n.take(S.filterChoiceCount),t.search(S,n)})}else t.infiniteRenderMod&&t.parent.filterSettings.itemsCount?(t.infiniteInitialLoad=!!g(t.fullData),t.makeInfiniteScrollRequest(r),r.requiresCount()):r.take(S.filterChoiceCount),t.search(S,r)}})},o.prototype.search=function(t,e){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(t,e):this.processSearch(e)},o.prototype.getPredicateFromCols=function(t){for(var e=o.getPredicate(t),i=[],r={},n=this.parent.getForeignKeyColumns!==void 0,s=n?this.parent.getForeignKeyColumns():[],a=0,l=Object.keys(e);a<l.length;a++){var h=l[a],c=void 0;n&&!this.parent.getColumnByField(h)&&(c=dq(h,s)),c?(this.parent.notify(qI,{predicate:r,column:c}),r.predicate.predicates.length&&i.push(xt.or(r.predicate.predicates))):i.push(e[""+h])}return i.length&&xt.and(i)},o.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new Pe},o.prototype.getAllData=function(){var t=this;this.customQuery=!1;var e=this.getQuery(),i=this.options.dataManager.adaptor.getModuleName;!g(this.parent.getDataModule)&&i&&i()==="ODataV4Adaptor"||e.requiresCount(),this.addDistinct(e);var r={requestType:WI,query:e,filterChoiceCount:null},n="filterModel";r[""+n]=this,this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(r.filterChoiceCount=this.parent.filterSettings.itemsCount),this.parent.trigger(lR,r,function(s){s.filterChoiceCount=g(s.filterChoiceCount)?1e3:s.filterChoiceCount,t.infiniteRenderMod&&t.parent.filterSettings.itemsCount!==s.filterChoiceCount&&(t.parent.filterSettings.itemsCount=s.filterChoiceCount),t.infiniteRenderMod||e.take(s.filterChoiceCount),(!s.query.distincts.length||t.infiniteRenderMod)&&(t.customQuery=!0,t.queryGenerate(e)),t.infiniteRenderMod&&(t.infiniteInitialLoad=!!g(t.fullData),t.makeInfiniteScrollRequest(e)),t.parent.dataSource&&"result"in t.parent.dataSource?t.filterEvent(s,e):t.processDataOperation(e,!0)})},o.prototype.addDistinct=function(t){var e=this,i=ge.distinct(this.options.filteredColumns,"field");i.indexOf(this.options.column.field)<=-1&&(i=i.concat(this.options.column.field));var r=this.options.dataManager.adaptor.getModuleName;if(r&&r()==="ODataV4Adaptor"&&this.parent&&this.parent.query instanceof Pe)for(var n=this.parent.query,s=0;s<n.queries.length;s++){var a=n.queries[parseInt(s.toString(),10)];a.fn==="onWhere"&&(this.getPredicateFields(a.e),this.queryFilteredColumn.map(function(u){i.indexOf(u)===-1&&i.push(u)}),this.queryFilteredColumn=[])}if(this.infiniteRenderMod||t.distinct(i),this.infiniteRenderMod&&!this.options.isRemote&&this.sInput.value===""){this.options.dataSource=this.options.dataSource instanceof oe?this.options.dataSource:new oe(this.options.dataSource),this.infinitePermenantLocalData=this.options.dataSource.dataSource.json.slice();var l=new Pe;this.queryGenerate(l);var h=new oe(this.options.dataSource.dataSource).executeLocal(l);this.options.dataSource=new oe(ge.distinct(h,this.options.column.field,!0)),this.isForeignColumn(this.options.column)&&(this.options.column.dataSource=this.options.column.dataSource instanceof oe?this.options.column.dataSource:new oe(this.options.column.dataSource),this.options.dataSource.dataSource.json=this.options.dataSource.dataSource.json.map(function(u,d){return Object.assign({},u,e.options.column.dataSource.dataSource.json[d])}))}else if(this.infiniteRenderMod&&this.options.isRemote){t.select(this.options.column.field),t.sortBy(this.options.column.field,"ascending");var c=this.options.dataManager.adaptor.getModuleName;c&&c()&&(c()==="ODataV4Adaptor"||c()==="WebApiAdaptor"||c()==="CustomDataAdaptor"||c()==="GraphQLAdaptor"||c()==="ODataAdaptor")&&t.distinct(i)}return t},o.prototype.getPredicateFields=function(t){var e=this;t.isComplex&&t.predicates?t.predicates.forEach(function(i){Array.isArray(i)?i.forEach(function(r){return e.getPredicateFields(r)}):e.getPredicateFields(i)}):t.field&&!t.isComplex&&this.queryFilteredColumn.indexOf(t.field)<=-1&&(this.queryFilteredColumn=this.queryFilteredColumn.concat(ge.distinct([t.field],"field")))},o.prototype.filterEvent=function(t,e){var i=this,r=wR(t,e);this.parent.trigger(CR,r.state),this.addInfiniteScrollEvent(e);var n=r.deffered;n.promise.then(function(s){i.infiniteDataCount=i.infiniteRenderMod&&!i.infiniteDataCount?s.count:i.infiniteDataCount;var a=i.infiniteRenderMod?s.result:s;i.dataSuccess(a)})},o.prototype.addInfiniteScrollEvent=function(t){this.infiniteRenderMod&&(this.infiniteQuery=t.clone(),this.infiniteInitialLoad?(this.cBox.classList.add("e-checkbox-infinitescroll"),T.add(this.cBox,"scroll",this.infiniteScrollHandler,this),T.add(this.cBox,"mouseup",this.infiniteScrollMouseKeyUpHandler,this),T.add(this.cBox,"mousedown",this.infiniteScrollMouseKeyDownHandler,this)):this.infiniteSearchValChange&&(this.cBox.innerHTML=""))},o.prototype.infiniteScrollMouseKeyDownHandler=function(){T.remove(this.cBox,"scroll",this.infiniteScrollHandler)},o.prototype.infiniteScrollMouseKeyUpHandler=function(t){var e=this;T.add(this.cBox,"scroll",this.infiniteScrollHandler,this);var i=this.cBox;i.children.length>1&&(i.scrollTop>=i.scrollHeight-i.offsetHeight||i.scrollTop<=0)&&this.infiniteScrollHandler(),Yf.timer=setTimeout(function(){e.clickHandler(t),Yf.timer=null},0)},o.prototype.getShimmerTemplate=function(){return'<span class="e-mask e-skeleton e-skeleton-text e-shimmer-wave"></span>'},o.prototype.showMask=function(){var t=5,e,i=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxMaskList",className:"e-checkboxlist e-fields e-infinite-list e-masklist"});i.style.zIndex="10";var r=this.cBox;if(this.removeMask(),r){var n=getComputedStyle(r),s=Gy(r),a=r.children.length?parseInt(n.height,10):Math.floor(parseInt(n.height.split("px")[0],10))-5;this.parent.enableAdaptiveUI&&this.infiniteRenderMod&&(i.style.height=a-s+"px",this.dlg.querySelector(".e-dlg-content").style.overflow="hidden");var l=this.isExcel&&!r.children.length&&!this.dlg.classList.contains("e-excelfilter")?"":getComputedStyle(this.dlg.querySelector(".e-dlg-content")).backgroundColor;i.style.cssText="width: "+n.width+"; min-height: "+n.minHeight+"; height: "+a+"px; margin: "+n.margin+"; border-style: "+n.borderStyle+"; border-width: "+n.borderWidth+"; border-color: "+n.borderColor+"; position: absolute; background-color: "+l+";",t=Math.floor(a/s),t=r.children.length>t?r.children.length:t,e=s+"px"}var h='<div class="e-ftrchk e-mask-ftrchk"><div class="e-checkbox-wrapper"><input class="e-chk-hidden">'+this.getShimmerTemplate()+this.getShimmerTemplate()+"</div></div>";if(i.innerHTML="",!r.children.length){this.spinner.insertAdjacentHTML("beforebegin",h),this.spinner.parentElement.querySelector(".e-ftrchk.e-mask-ftrchk").style.cssText="width: 100%; height: "+e+";",this.spinner.parentElement.querySelector(".e-checkbox-wrapper").style.width="100%";var c=[].slice.call(this.spinner.parentElement.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));c[0].classList.add("e-mask-checkbox-filter-intent"),c[1].classList.add("e-mask-checkbox-filter-span-intent")}this.spinner.insertBefore(i,this.cBox);for(var u=0;t&&u<t;u++){i.innerHTML+=h,i.lastElementChild.style.cssText="width: 100%; height: "+e+";",i.lastElementChild.querySelector(".e-checkbox-wrapper").style.width="100%";var c=[].slice.call(i.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)"));c[0].classList.add("e-mask-checkbox-filter-intent"),c[1].classList.add("e-mask-checkbox-filter-span-intent")}this.cBox&&(i.scrollTop=this.cBox.scrollTop)},o.prototype.removeMask=function(){var t=this.dialogObj.element.querySelectorAll(".e-mask-ftrchk");if(t.length)for(var e=0;e<t.length;e++)Qe(t[e]);var i=this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist");i&&Qe(this.dialogObj.element.querySelector(".e-checkboxlist.e-masklist"))},o.prototype.infiniteScrollHandler=function(){var t=this.cBox;t.scrollTop>=t.scrollHeight-t.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length<=this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3&&(!this.infiniteDataCount||this.infiniteDataCount>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)?(this.makeInfiniteScrollRequest(),this.prevInfiniteScrollDirection="down"):t.scrollTop>=t.scrollHeight-t.offsetHeight&&!this.infiniteQueryExecutionPending&&this.infiniteLoadedElem.length>this.infiniteSkipCnt+this.parent.filterSettings.itemsCount&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(Yy([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt+=this.prevInfiniteScrollDirection==="down"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,nd(this.cBox,this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.parent.filterSettings.itemsCount+this.infiniteSkipCnt)),this.prevInfiniteScrollDirection="down"):t.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.infiniteLoadedElem.length>this.parent.filterSettings.itemsCount*3&&this.cBox.children.length===this.parent.filterSettings.itemsCount*3?(Yy([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt-=this.prevInfiniteScrollDirection==="up"?this.parent.filterSettings.itemsCount:this.parent.filterSettings.itemsCount*3,SR([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)),this.cBox),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up"):t.scrollTop===0&&!this.infiniteInitialLoad&&!this.infiniteSearchValChange&&this.infiniteSkipCnt&&this.infiniteLoadedElem.length&&this.cBox.children.length<this.parent.filterSettings.itemsCount*3&&(Yy([].slice.call(this.cBox.children).splice(this.parent.filterSettings.itemsCount*2,this.infiniteDataCount%this.parent.filterSettings.itemsCount)),this.infiniteSkipCnt=(Math.floor(this.infiniteDataCount/this.parent.filterSettings.itemsCount)-3)*this.parent.filterSettings.itemsCount,SR([].slice.call(this.infiniteLoadedElem.slice(this.infiniteSkipCnt,this.infiniteSkipCnt+this.parent.filterSettings.itemsCount)),this.cBox),this.cBox.scrollTop=this.infiniteScrollAppendDiff,this.prevInfiniteScrollDirection="up")},o.prototype.makeInfiniteScrollRequest=function(t){var e=this;!this.infiniteInitialLoad&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"?setTimeout(function(){e.infiniteQueryExecutionPending&&e.showMask()},500):this.infiniteInitialLoad||(Qs({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),vs(this.spinner));var i="fn";if(this.infiniteQuery&&this.infiniteQuery.queries&&this.infiniteQuery.queries.length)for(var r=0;r<this.infiniteQuery.queries.length;r++)(this.infiniteQuery.queries[r][""+i]==="onTake"||this.infiniteQuery.queries[r][""+i]==="onSkip")&&(this.infiniteQuery.queries.splice(r,1),r--);var n=!!t;if(t=t||this.infiniteQuery,this.infiniteInitialLoad||this.infiniteSearchValChange?this.infiniteSkipCnt=0:this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount,t.skip(this.infiniteSkipCnt),this.infiniteInitialLoad||this.infiniteSearchValChange?(t.take(this.parent.filterSettings.itemsCount*3),this.infiniteSkipCnt+=this.parent.filterSettings.itemsCount*2):t.take(this.parent.filterSettings.itemsCount),!n)if(this.parent.dataSource&&"result"in this.parent.dataSource){var s={requestType:WI,query:t,filterChoiceCount:null,filterModel:this};this.infiniteRenderMod&&this.parent.filterSettings.itemsCount&&(s.filterChoiceCount=this.parent.filterSettings.itemsCount),this.filterEvent(s,t)}else this.processDataOperation(t),this.infiniteQueryExecutionPending=!0},o.prototype.processDataOperation=function(t,e){var i=this;this.options.dataSource=this.options.dataSource instanceof oe?this.options.dataSource:new oe(this.options.dataSource);var r=[],n=[];if(this.isForeignColumn(this.options.column)&&e){var s="result"in this.options.column.dataSource?new oe(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=t.params,r.push(s.executeQuery(this.foreignKeyQuery)),n.push(function(l){return i.foreignKeyData=l})}if(this.addInfiniteScrollEvent(t),this.infiniteRenderMod&&this.infiniteInitialLoad&&!this.options.isRemote){var a=this.isForeignColumn(this.options.column)?this.options.foreignKeyValue:this.options.column.field;this.options.dataSource.executeQuery(new Pe().sortBy(a,ge.fnAscending)).then(function(l){i.options.dataSource.dataSource.json=l.result,i.executeQueryOperations(t,r,n)})}else this.executeQueryOperations(t,r,n)},o.prototype.executeQueryOperations=function(t,e,i){var r=this;e.push(this.options.dataSource.executeQuery(t)),i.push(this.dataSuccess.bind(this));var n=0;Promise.all(e).then(function(s){r.infiniteQueryExecutionPending=r.infiniteRenderMod?!1:r.infiniteQueryExecutionPending;for(var a=0;a<s.length;a++)r.infiniteDataCount=r.infiniteRenderMod&&!r.infiniteDataCount?s[a].count:r.infiniteDataCount,i[n++](s[parseInt(a.toString(),10)].result)}).catch(function(){r.infiniteRenderMod&&r.parent.filterSettings&&r.parent.filterSettings.loadingIndicator==="Shimmer"&&r.parent.showMaskRow(void 0,r.dialogObj.element)})},o.prototype.dataSuccess=function(t){if(!(!this.infiniteInitialLoad&&this.infiniteDataCount&&(this.infiniteSkipCnt>=this.infiniteDataCount&&!this.infiniteSearchValChange||t.length===0))){this.fullData=t;var e={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify(ZW,e),e.executeQuery){var i=new Pe;this.customQuery||this.queryGenerate(i);var r=new oe(e.dataSource).executeLocal(i),n=this.options.column;this.filteredData=o.getDistinct(r,this.options.field,n,this.foreignKeyData,this).records||[]}var s=e.executeQuery?this.filteredData:e.dataSource;this.processDataSource(null,!0,s,e),(this.infiniteRenderMod&&this.infiniteInitialLoad||!this.infiniteRenderMod)&&(this.sInput?this.sInput.focus():this.dlg.querySelector(".e-chk-hidden")&&this.dlg.querySelector(".e-ftrchk")&&(this.dlg.querySelector(".e-chk-hidden").focus(),this.dlg.querySelector(".e-ftrchk").classList.add("e-chkfocus"))),(this.infiniteInitialLoad||this.infiniteSearchValChange)&&(this.infiniteInitialLoad=!1,this.infiniteSearchValChange=!1);var a={requestType:qW,columnName:this.options.field,columnType:this.options.type},l="filterModel";a[""+l]=this,this.parent.notify(hR,a),this.isCheckboxFilterTemplate&&Xs(this.spinner)}},o.prototype.queryGenerate=function(t){if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var e=this.options.dataManager.adaptor.getModuleName;if(!g(this.parent.getDataModule)&&e&&e()==="ODataV4Adaptor")this.parent.getDataModule().searchQuery(t);else{var i=this.parent.searchSettings,r=i.fields.length?i.fields:this.options.columns.map(function(h){return h.field});t.search(i.key,r,i.operator,i.ignoreCase,i.ignoreAccent)}}if(this.options.filteredColumns.length){for(var n=[],s=0;s<this.options.filteredColumns.length;s++){var a=this.options.filteredColumns[parseInt(s.toString(),10)];this.options.uid?(a.uid=a.uid||this.parent.getColumnByField(a.field).uid,a.uid!==this.options.uid&&n.push(this.options.filteredColumns[parseInt(s.toString(),10)])):a.field!==this.options.field&&n.push(this.options.filteredColumns[parseInt(s.toString(),10)])}var l=this.getPredicateFromCols(n);l&&t.where(l)}},o.prototype.processDataSource=function(t,e,i,r){vs(this.spinner),this.updateResult();var n={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify(rq,n),this.isCheckboxFilterTemplate=n.isCheckboxFilterTemplate,this.isCheckboxFilterTemplate?this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask():this.createFilterItems(i,e,r)},o.prototype.processSearch=function(t){this.processDataOperation(t)},o.prototype.updateResult=function(){this.result={};var t=this.infiniteRenderMod&&this.existingPredicate[this.options.field]?this.getPredicateFromCols(this.existingPredicate[this.options.field]):this.getPredicateFromCols(this.options.filteredColumns),e=new Pe;t&&e.where(t),this.parent.notify(tq,{query:e});for(var i=new oe(this.fullData).executeLocal(e),r=0,n=i;r<n.length;r++){var s=n[r];this.result[fR(this.options.field,s)]=!0}},o.prototype.clickHandler=function(t){var e;g(Yf.timer)||clearTimeout(Yf.timer);var i=t.target;if(!(!g(this.parent.loadingIndicator)&&this.parent.loadingIndicator.indicatorType==="Shimmer"&&Fr(i,"e-mask-ftrchk"))){var r=Fr(i,"e-checkbox-wrapper");if(Fr(i,"e-searchbox")&&this.searchBoxClick(t),r&&!this.isCheckboxFilterTemplate){var n=r.querySelector(".e-selectall");if(n)this.updateAllCBoxes(!n.classList.contains("e-check"));else if(Mc(r.parentElement),this.infiniteRenderMod&&!r.parentElement.querySelector(".e-add-current")){this.localInfiniteSelectionInteracted=!0;var s=this.options.allowCaseSensitive,a=r.parentElement.querySelector(".e-frame"),l=a.previousSibling,h=l.checked?"equal":"notequal",c=l.checked?"or":"and",u={field:this.options.field,predicate:c,uid:this.options.uid,operator:h,type:this.options.type,matchCase:s,ignoreAccent:this.options.ignoreAccent},d=this.values[Fr(l,"e-ftrchk").getAttribute("data-uid")];if(this.updateInfiniteManualSelectPred(u,d),this.infiniteRenderMod&&!this.options.isRemote&&this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length){var p=this.getPredicateFromCols((e=this.options.filteredColumns).concat.apply(e,this.infiniteManualSelectMaintainPred)),f=new Pe;p&&f.where(p);var v=new oe(this.infinitePermenantLocalData).executeLocal(f);this.options.parentTotalDataCount!==v.length&&(this.options.parentTotalDataCount=v.length),!this.options.parentTotalDataCount&&this.infiniteUnloadParentExistPred.length&&(this.infiniteUnloadParentExistPred=[])}this.infiniteUnloadParentExistPred.length&&(this.options.parentTotalDataCount===this.infiniteDataCount||!this.options.parentTotalDataCount)&&(this.infiniteUnloadParentExistPred=[])}this.updateIndeterminatenBtn(),r.querySelector(".e-chk-hidden").focus()}this.setFocus(Fr(r,"e-ftrchk"))}},o.prototype.updateInfiniteManualSelectPred=function(t,e){for(var i=0;i<this.infiniteManualSelectMaintainPred.length;i++){var r=this.infiniteManualSelectMaintainPred[i];if(r.value+""==e+""&&(r.operator==="equal"||r.operator==="notequal")){this.infiniteManualSelectMaintainPred.splice(i,1);break}}(t.predicate==="or"&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll)||t.predicate==="and"&&(!this.localInfiniteSelectAllClicked||this.infiniteLocalSelectAll))&&(this.infiniteManualSelectMaintainPred.push(pe({},{value:e},t)),t.predicate==="or"?this.options.parentTotalDataCount++:this.options.parentTotalDataCount--)},o.prototype.focusNextOrPrev=function(t,e){var i=t.key==="ArrowUp"?e.indexOf(document.activeElement)-1:e.indexOf(document.activeElement)+1,r=e[(i+e.length)%e.length];if(r){r.focus();var n=r.classList.contains("e-chk-hidden")?Fr(r,"e-ftrchk"):r;this.setFocus(n)}},o.prototype.keyupHandler=function(t){if((t.key==="Tab"||(t.key==="ArrowUp"||t.key==="ArrowDown")&&!t.altKey)&&this.setFocus(Fr(t.target,"e-ftrchk")),(t.key==="ArrowUp"||t.key==="ArrowDown")&&!t.altKey&&this.parent.filterSettings&&this.parent.filterSettings.type==="CheckBox"){t.preventDefault();var e=Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex="-1"])'));this.focusNextOrPrev(t,e)}},o.prototype.setFocus=function(t){var e=this.dlg.querySelector(".e-chkfocus");e&&e.classList.remove("e-chkfocus"),t&&t!==e&&t.classList.add("e-chkfocus")},o.prototype.updateAllCBoxes=function(t){this.infiniteRenderMod&&(this.localInfiniteSelectAllClicked=!0,this.infiniteLocalSelectAll=t,this.infiniteUnloadParentExistPred=[],this.infiniteManualSelectMaintainPred=[]);for(var e=this.infiniteRenderMod?this.infiniteLoadedElem.map(function(s){return s.querySelector(".e-frame")}):[].slice.call(this.cBox.querySelectorAll(".e-frame:not(.e-add-current)")),i=0,r=e;i<r.length;i++){var n=r[i];uq(n,t),qy(n.previousSibling,t)}},o.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},o.prototype.createCheckbox=function(t,e,i){var r=e?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);qy(r.querySelector("input"),e);var n=r.querySelector(".e-label"),s=pq({},i,{column:this.options.column,parent:this.parent}),a=this.options.disableHtmlEncode?"textContent":"innerHTML";n[""+a]=!g(t)&&t.toString().length?this.parent.enableHtmlSanitizer?Pt.sanitize(t):t:this.getLocalizedLabel("Blanks");var l=Ro("cbox");if(n.setAttribute("id",l+"cboxLabel"),r.querySelector("input").setAttribute("aria-labelledby",n.id),n.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),typeof t=="boolean"&&(n.innerHTML=t===!0?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),X([n],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&i[this.options.column.field]!==this.getLocalizedLabel("AddCurrentSelection")){n.innerHTML="";var h=this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string"&&!(this.options.column.filter.itemTemplate.prototype&&this.options.column.filter.itemTemplate.prototype.CSPTemplate),c=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;h||c?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,n),this.parent.renderTemplates()):nd(n,this.options.template(s,this.parent,"filterItemTemplate",null,null,null,null,this.parent.root))}return r},o.prototype.updateIndeterminatenBtn=function(){var t=this.infiniteRenderMod?this.infiniteLoadedElem.length:this.cBox.children.length-1,e=[],i=!1,r=this.infiniteRenderMod?this.sBox.querySelector(".e-selectall"):this.cBox.querySelector(".e-selectall"),n=this.infiniteRenderMod?this.infiniteLoadedElem.filter(function(l){return l.querySelector(".e-check")}).length:this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)").length;this.cBox.querySelector(".e-add-current")&&(t-=1);var s;this.options.isResponsiveFilter||(s=this.dialogObj.btnObj[0],s.disabled=!1);var a=r.previousSibling;qy(a,!1),a.indeterminate=!1,this.infiniteRenderMod&&this.sInput.value===""&&!this.options.parentCurrentViewDataCount&&!this.localInfiniteSelectionInteracted&&(!this.localInfiniteSelectAllClicked||!this.infiniteLocalSelectAll&&!n)&&(t!==n||t===n)?n=0:this.infiniteRenderMod&&this.infiniteLoadedElem.length<this.infiniteDataCount&&this.infiniteUnloadParentExistPred.length&&(!n||t===n)&&this.infiniteLocalSelectAll&&(n?t+=this.infiniteUnloadParentExistPred.length:n+=this.infiniteUnloadParentExistPred.length),t===n?(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!0,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),e=["e-check"],qy(a,!0)):n?(e=["e-stop"],a.indeterminate=!0):(this.infiniteRenderMod&&(this.infiniteLocalSelectAll=!1,this.localInfiniteSelectAllClicked=!0,this.infiniteManualSelectMaintainPred=[]),e=["e-uncheck"],i=!0,s&&(s.disabled=!0)),s&&(this.filterState=!s.disabled,s.dataBind()),Z([r],["e-check","e-stop","e-uncheck"]),X([r],e),this.parent.notify(cR,{disabled:i})},o.prototype.createFilterItems=function(t,e,i){var r,n,s,a=this.parent.createElement("div"),l,h=!1;this.options.isResponsiveFilter||(l=this.dialogObj.btnObj[0]);var c=-1,u="ejValue";i.executeQuery||(u=i.field);for(var d=0;d<t.length;d++){var p=V(u,t[parseInt(d.toString(),10)]);(p===""||g(p))&&(c=c+1)}if(this.infiniteRenderMod||(this.itemsCnt=c!==-1?t.length-c:t.length),this.infiniteRenderMod&&this.parent.filterSettings&&this.parent.filterSettings.loadingIndicator==="Shimmer"&&this.removeMask(),t.length&&!this.renderEmpty){var f=this.getLocalizedLabel("SelectAll"),v=this.cBox.querySelector(".e-checkfltrnmdiv");v&&v.classList.remove("e-checkfltrnmdiv");var m=this.createCheckbox(f,!1,(r={},r[this.options.field]=f,r));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?X([m],this.parent.cssClass.split(" ")):X([m],[this.parent.cssClass])),this.infiniteInitialLoad||!this.infiniteRenderMod){var y=Ml(Ro("cbox"),m,"e-ftrchk");y.querySelector(".e-frame").classList.add("e-selectall"),this.infiniteRenderMod?(y.classList.add("e-infinitescroll"),this.parent.enableAdaptiveUI&&(this.spinner.style.height=this.spinner.offsetHeight-Gy(this.cBox)+"px"),this.sBox.insertBefore(y,this.spinner)):a.appendChild(y)}else this.sBox.querySelector(".e-ftrchk .e-selectall")&&(this.sBox.querySelector(".e-ftrchk .e-selectall").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-selectall").parentElement.classList.remove("e-checkbox-disabled"));var b=new xt("field","equal",this.options.field);this.options.foreignKeyValue&&(b=b.or("field","equal",this.options.foreignKeyValue));var S=new oe(this.options.filteredColumns).executeLocal(new Pe().where(b)).length;if(this.sInput&&this.sInput.value){var C=this.createCheckbox(this.getLocalizedLabel("AddCurrentSelection"),!1,(n={},n[this.options.field]=this.getLocalizedLabel("AddCurrentSelection"),n));if(this.parent.cssClass&&(this.parent.cssClass.indexOf(" ")!==-1?X([C],this.parent.cssClass.split(" ")):X([C],[this.parent.cssClass])),this.infiniteRenderMod&&!g(this.sBox.children[2])&&this.sBox.children[2].innerText!==this.getLocalizedLabel("AddCurrentSelection")||!this.infiniteRenderMod){var x=Ml(Ro("cbox"),C,"e-ftrchk");if(x.querySelector(".e-frame").classList.add("e-add-current"),this.infiniteRenderMod){x.classList.add("e-infinitescroll"),this.sBox.insertBefore(x,this.spinner);var I=this.spinner.querySelector(".e-checkboxlist"),D=Math.ceil(x.getBoundingClientRect().height);I.style.height=parseInt(getComputedStyle(I).height.split("px")[0],10)-D+"px",I.style.minHeight=I.style.height}else a.appendChild(x)}else this.sBox.querySelector(".e-ftrchk .e-add-current")&&(this.sBox.querySelector(".e-ftrchk .e-add-current").previousSibling.disabled=!1,this.sBox.querySelector(".e-ftrchk .e-add-current").parentElement.classList.remove("e-checkbox-disabled"))}else if(this.infiniteRenderMod&&!g(this.sBox.children[2])&&this.sBox.children[2].innerText===this.getLocalizedLabel("AddCurrentSelection")){var I=this.spinner.querySelector(".e-checkboxlist"),M=Math.ceil(this.sBox.children[2].getBoundingClientRect().height);I.style.height=parseInt(getComputedStyle(I).height.split("px")[0],10)+M+"px",I.style.minHeight=I.style.height,Qe(this.sBox.children[2])}for(var E=void 0,d=0;d<t.length;d++){var A=Ro("cbox");this.values[""+A]=V(u,t[parseInt(d.toString(),10)]);var L=V(this.options.field,t[parseInt(d.toString(),10)]);this.options.formatFn&&(this.options.type==="dateonly"&&(L=new Date(L)),L=this.valueFormatter.toView(L,this.options.formatFn));var N={value:L,column:this.options.column,data:t[parseInt(d.toString(),10)]};if(this.parent.notify(Ky,N),L=N.value,L===""||g(L)){if(E)continue;E=!0}this.infiniteRenderMod&&this.updateInfiniteUnLoadedCheckboxExistPred(L,this.infiniteUnloadParentExistPred);var R=this.localInfiniteSelectAllClicked?this.createCheckbox(L,this.infiniteLocalSelectAll,V("dataObj",t[d])):this.createCheckbox(L,this.getCheckedState(S,this.values[""+A]),V("dataObj",t[d]));a.appendChild(Ml(A,R,"e-ftrchk")),this.infiniteRenderMod&&(a.lastChild.style.height=Gy(this.cBox)+"px")}var P=this.cBox.scrollTop;!this.infiniteRenderMod||this.infiniteSearchValChange?this.cBox.innerHTML="":this.infiniteRenderMod&&this.cBox.children.length&&Yy([].slice.call(this.cBox.children).splice(0,this.parent.filterSettings.itemsCount)),this.infiniteRenderMod&&((s=this.infiniteLoadedElem).push.apply(s,[].slice.call(a.children)),this.itemsCnt=c!==-1?this.infiniteLoadedElem.length-c:this.infiniteLoadedElem.length),this.infiniteUnloadParentExistPred.length&&(this.infiniteLoadedElem.length>=this.infiniteDataCount||!this.options.parentCurrentViewDataCount||this.options.parentTotalDataCount===this.infiniteDataCount&&this.options.parentCurrentViewDataCount)&&(this.infiniteUnloadParentExistPred=[]),nd(this.cBox,[].slice.call(a.children)),this.infiniteRenderMod&&!this.infiniteScrollAppendDiff&&(this.infiniteScrollAppendDiff=Math.round(P-this.cBox.scrollTop)),this.updateIndeterminatenBtn(),this.infiniteRenderMod?l&&l.disabled?h=!0:h=!1:(l&&(l.disabled=!1),h=!1)}else{if(a.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.infiniteRenderMod){var y=this.sBox.querySelector(".e-ftrchk .e-selectall");if(y){var k=y.parentElement.parentElement;y.classList.contains("e-check")?Mc(k):y.classList.contains("e-stop")&&(Mc(k),y.classList.remove("e-stop"),Mc(k)),y.previousSibling.disabled=!0,y.parentElement.classList.add("e-checkbox-disabled")}var B=this.sBox.querySelector(".e-ftrchk .e-add-current");if(B){var F=B.parentElement.parentElement;B.classList.contains("e-check")&&Mc(F),B.previousSibling.disabled=!0,B.parentElement.classList.add("e-checkbox-disabled")}}this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),nd(this.cBox.children[0],[].slice.call(a.children)),l&&(l.disabled=!0),h=!0,this.filterState=!h}l&&t.length&&(this.filterState=!l.disabled,l.dataBind());var O={requestType:WI,dataSource:this.renderEmpty?[]:t},z="filterModel";O[""+z]=this,this.parent.notify(hR,O),this.parent.notify(cR,{disabled:h}),this.infiniteRenderMod&&this.infiniteInitialLoad&&(this.cBox.style.marginTop="0px"),Xs(this.spinner)},o.prototype.updateInfiniteUnLoadedCheckboxExistPred=function(t,e){for(var i=0;i<e.length;i++){var r=e[i],n=r.value instanceof Date?this.valueFormatter.toView(r.value,this.options.formatFn):r.value,s=this.options.column;if(s.isForeignColumn()){var a=pR(s,{},n,this.foreignKeyData)[0];t=V(s.foreignKeyField,a)}t===n&&(r.operator==="equal"||r.operator==="notequal")&&(this.infiniteManualSelectMaintainPred.push(e[i]),e.splice(i,1),i--)}},o.prototype.getCheckedState=function(t,e){if(!this.isFiltered||!t)return!0;var i=this.sInput&&this.sInput.value?!0:this.result[""+e];return this.infiniteRenderMod?i:this.options.operator==="notequal"?!i:i},o.getDistinct=function(t,e,i,r,n){for(var s=t.length,a=[],l,h="ejValue",c={},u=i&&i.isForeignColumn?i.isForeignColumn():!1;s--;){l=t[parseInt(s.toString(),10)],l=fR(e,l);var d=typeof l=="string"&&!g(n)&&!g(n.parent)&&!g(n.parent.filterSettings)&&!g(n.parent.filterSettings.enableCaseSensitivity)?l.toLowerCase():l;if(!(d in c)){var p={};if(p[""+h]=l,c[""+d]=!0,u){var f=pR(i,{},l,r)[0];it(XW,f,t[parseInt(s.toString(),10)]),l=V(i.foreignKeyValue,f)}it(e,g(l)?null:l,p),it("dataObj",t[parseInt(s.toString(),10)],p),a.push(p)}}return ge.group(ge.sort(a,e,ge.fnAscending),"ejValue")},o.getPredicate=function(t){for(var e=ge.distinct(t,"field",!0)||[],i=[],r={},n=0;n<e.length;n++)i=new oe(t).executeLocal(new Pe().where("field","equal",e[parseInt(n.toString(),10)].field)),i.length!==0&&(r[e[parseInt(n.toString(),10)].field]=o.generatePredicate(i));return r},o.generatePredicate=function(t){var e=t?t.length:0,i,r=o.updateDateFilter(t[0]);r.ignoreAccent=g(r.ignoreAccent)?!1:r.ignoreAccent,r.type==="date"||r.type==="datetime"||r.type==="dateonly"?i=qf(r,r.type):i=r.ejpredicate?r.ejpredicate:new xt(r.field,r.operator,r.value,!o.getCaseValue(r),r.ignoreAccent);for(var n=1;n<e;n++)t[parseInt(n.toString(),10)]=o.updateDateFilter(t[parseInt(n.toString(),10)]),e>2&&n>1&&(t[n].predicate==="or"&&t[n-1].predicate==="or"||t[n].predicate==="and"&&t[n-1].predicate==="and")?t[n].type==="date"||t[n].type==="datetime"||t[n].type==="dateonly"?i.predicates.push(qf(t[parseInt(n.toString(),10)],t[n].type)):i.predicates.push(new xt(t[n].field,t[parseInt(n.toString(),10)].operator,t[parseInt(n.toString(),10)].value,!o.getCaseValue(t[parseInt(n.toString(),10)]),t[parseInt(n.toString(),10)].ignoreAccent)):t[n].type==="date"||t[n].type==="datetime"||t[n].type==="dateonly"?i=i[t[parseInt(n.toString(),10)].predicate](qf(t[parseInt(n.toString(),10)],t[parseInt(n.toString(),10)].type),t[parseInt(n.toString(),10)].type,t[parseInt(n.toString(),10)].ignoreAccent):i=t[parseInt(n.toString(),10)].ejpredicate?i[t[parseInt(n.toString(),10)].predicate](t[parseInt(n.toString(),10)].ejpredicate):i[t[parseInt(n.toString(),10)].predicate](t[parseInt(n.toString(),10)].field,t[parseInt(n.toString(),10)].operator,t[parseInt(n.toString(),10)].value,!o.getCaseValue(t[parseInt(n.toString(),10)]),t[parseInt(n.toString(),10)].ignoreAccent);return i||null},o.getCaseValue=function(t){return g(t.matchCase)?!(t.type==="string"||g(t.type)&&typeof t.value=="string"):t.matchCase},o.updateDateFilter=function(t){return(t.type==="date"||t.type==="datetime"||t.type==="dateonly"||t.value instanceof Date)&&(t.type=t.type||"date"),t},o})(),vq=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),IR=(function(o){vq(t,o);function t(e,i){var r=o.call(this,e)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.focusedMenuItem=null,r.customFilterOperators=i,r.isExcel=!0,r}return t.prototype.getCMenuDS=function(e,i){var r={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","NotContains","","CustomFilter"]};r.date=r.number,r.datetime=r.number,r.dateonly=r.number;var n=[];if(!g(e))for(var s=0;s<r[""+e].length;s++)r[""+e][parseInt(s.toString(),10)].length?i?n.push({text:this.getLocalizedLabel(r[""+e][parseInt(s.toString(),10)])+"...",iconCss:"e-icons e-icon-check "+(i===r[""+e][parseInt(s.toString(),10)].toLowerCase()?"":"e-emptyicon")}):n.push({text:this.getLocalizedLabel(r[""+e][parseInt(s.toString(),10)])+"..."}):n.push({separator:!0});return n},t.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),o.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var e=this.menuObj.element.querySelector("li.e-focused");e&&Fr(e,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},t.prototype.createMenu=function(e,i,r,n){var s={string:"TextFilter",date:"DateFilter",dateonly:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"};this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),this.parent.cssClass&&this.menu.classList.add(this.parent.cssClass);var a=this.parent.createElement("ul"),l=i?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&this.parent.getModuleName()==="grid"&&!this.options.isResponsiveFilter){var h=this.parent.getColumnHeaderByUid(n.uid).getAttribute("aria-sort"),c=this.parent.getColumnByField(n.field).allowSorting,u=!c||h==="ascending"?"e-disabled e-excel-ascending":"e-excel-ascending",d=!c||h==="descending"?"e-disabled e-excel-descending":"e-excel-descending",p=e==="string"?this.getLocalizedLabel("SortAtoZ"):e==="datetime"||e==="date"?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),f=e==="string"?this.getLocalizedLabel("SortZtoA"):e==="datetime"||e==="date"?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");a.appendChild(this.createMenuElem(p,u,"e-sortascending")),a.appendChild(this.createMenuElem(f,d,"e-sortdescending"));var v=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});a.appendChild(v)}this.options.isResponsiveFilter||a.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),i?"":"e-disabled",l)),e!=="boolean"&&a.appendChild(this.createMenuElem(this.getLocalizedLabel(s[""+e]),"e-submenu",!g(e)&&r&&this.ensureTextFilter()?"e-icon-check":l+" e-emptyicon",!0)),this.menu.appendChild(a),this.parent.notify(Xy,{element:this.menu}),this.parent.notify(JW,{isFiltered:i})},t.prototype.createMenuElem=function(e,i,r,n){var s=this.parent.createElement("li",{className:i+" e-menu-item"});return s.innerHTML=e,s.tabIndex=s.classList.contains("e-disabled")?-1:0,s.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r,attrs:{"aria-hidden":"true"}}),s.firstChild),n&&s.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),s},t.prototype.wireExEvents=function(){j.isDevice||T.add(this.dlg,"mouseover",this.hoverHandler,this),T.add(this.dlg,"click",this.clickExHandler,this),T.add(this.dlg,"keyup",this.keyUp,this),T.add(this.dlg,"keydown",this.keyDown,this)},t.prototype.unwireExEvents=function(){j.isDevice||T.remove(this.dlg,"mouseover",this.hoverHandler),T.remove(this.dlg,"click",this.clickExHandler),T.remove(this.dlg,"keyup",this.keyUp),T.remove(this.dlg,"keydown",this.keyDown)},t.prototype.clickExHandler=function(e){var i={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},r=Fr(e.target,"e-menu-item");r&&(this.getLocalizedLabel("ClearFilter")===r.innerText.trim()?(this.clearFilter(),this.closeDialog()):(this.options.isResponsiveFilter||j.isDevice)&&this.getLocalizedLabel(i[this.options.type])===r.innerText.trim()&&this.hoverHandler(e))},t.prototype.focusNextOrPrevElement=function(e,i,r){var n=e.key==="ArrowUp"||e.key==="Tab"&&e.shiftKey?i.indexOf(document.activeElement)-1:i.indexOf(document.activeElement)+1,s=i[(n+i.length)%i.length];if(s){s.focus();var a=s.classList.contains("e-chk-hidden")?"e-chkfocus":r,l=s.classList.contains("e-chk-hidden")?Fr(s,"e-ftrchk"):Fr(s,"e-menu-item");this.excelSetFocus(l,a)}},t.prototype.keyUp=function(e){if(e.key==="Tab"&&e.shiftKey||e.key==="Tab"){var i=e.target.classList.contains("e-chk-hidden")?"e-chkfocus":"e-menufocus",r=e.target.classList.contains("e-menu-item")?Fr(e.target,"e-menu-item"):Fr(e.target,"e-ftrchk");this.excelSetFocus(r,i)}else if((e.key==="ArrowUp"||e.key==="ArrowDown")&&!e.altKey){e.preventDefault();var n=Array.from(this.dlg.querySelectorAll('input, button, [tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(e,n,"e-menufocus")}else(e.key==="Enter"||e.code==="ArrowRight")&&e.target.classList.contains("e-menu-item")&&(e.preventDefault(),e.target.click(),e.target.classList.contains("e-submenu")&&(this.hoverHandler(e),this.menuObj.element.querySelector(".e-menu-item").focus(),this.excelSetFocus(Fr(this.menuObj.element.querySelector(".e-menu-item"),"e-menu-item"),"e-focused"),this.focusedMenuItem=this.menuObj.element.querySelector(".e-menu-item")))},t.prototype.keyDown=function(e){(e.key==="ArrowUp"||e.key==="ArrowDown")&&e.preventDefault()},t.prototype.excelSetFocus=function(e,i){var r=this.cmenu.querySelector("."+i),n=this.menu.querySelector("."+i);r&&r.classList.remove(i),n&&n.classList.contains("e-menufocus")&&n.classList.remove(i),e&&e.classList.add(i)},t.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),T.remove(this.menuObj.element,"keydown",this.contextKeyDownHandler),Qe(this.cmenu),this.parent.notify(uR,{target:null,header:"",isOpen:!1,col:this.options.column}))},t.prototype.hoverHandler=function(e){if(!(this.options.isResponsiveFilter&&e.type==="mouseover")){var i=e.target.querySelector(".e-contextmenu"),r=Fr(e.target,"e-menu-item"),n=this.menu.querySelector(".e-focused"),s;if(n&&n.classList.remove("e-focused"),r&&(r.classList.add("e-focused"),s=r.classList.contains("e-submenu")),!i){if(!s){var a=this.menu.querySelector(".e-submenu");g(a)||a.classList.remove("e-selected"),this.destroyCMenu()}var l=this.ensureTextFilter();if(!this.isCMenuOpen&&s){r.classList.add("e-selected"),this.isCMenuOpen=!0;var h={items:this.getCMenuDS(this.options.type,l?l.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,animationSettings:{effect:j.isDevice?"ZoomIn":"None"},beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""};this.parent.element.appendChild(this.cmenu),this.menuObj=new Cy(h,this.cmenu),T.add(this.menuObj.element,"keydown",this.contextKeyDownHandler,this);var c=this.menu.querySelector(".e-submenu").getBoundingClientRect(),u={top:0,left:0};if(this.options.isResponsiveFilter){var d={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},p=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),f=p.offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+f+"px)",this.menuObj.open(f,0,document.body);var v=this.getLocalizedLabel(d[this.options.type]);this.parent.notify(uR,{target:this.menuObj.element.parentElement,header:v,isOpen:!0})}else{if(j.isDevice){this.isDevice=!0;var m=this.getContextBounds();u.top=(window.innerHeight-m.height)/2,u.left=(window.innerWidth-m.width)/2,this.closeDialog(),this.isDevice=!1}else u.top=j.isIE?window.pageYOffset+c.top:window.scrollY+c.top,u.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(u.top,u.left,e.target)}vR(this.parent.element,this.menuObj.element.parentElement)}}}},t.prototype.contextKeyDownHandler=function(e){if(e.key==="Tab"&&e.shiftKey||e.key==="Tab"){e.preventDefault();var i=Array.from(this.menuObj.element.querySelectorAll('[tabindex]:not([tabindex="-1"]), .e-menu-item:not(.e-disabled):not(.e-separator)'));this.focusNextOrPrevElement(e,i,"e-focused")}else(e.key==="ArrowLeft"||e.key==="Escape")&&(e.preventDefault(),this.menuObj.close(),this.focusedMenuItem=null,document.querySelector(".e-submenu.e-menu-item").classList.remove("e-selected"),document.querySelector(".e-submenu.e-menu-item").focus())},t.prototype.ensureTextFilter=function(){var e,i=this.existingPredicate[this.options.field];return i&&i.length===2?i[0].operator==="greaterthanorequal"&&i[1].operator==="lessthanorequal"?e="between":e="customfilter":i&&i.length===1&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=i[0].operator),e},t.prototype.preventClose=function(e){if(this.options&&this.options.isResponsiveFilter&&e.event){var i=e.event.target,r=i.classList&&(i.classList.contains("e-resfilterback")||i.classList.contains("e-res-back-btn")||i.classList.contains("e-menu-item"));e.cancel=!r}else e.event instanceof MouseEvent&&e.event.target&&e.event.target.classList&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)},t.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},t.prototype.getCMenuYPosition=function(e){var i=this.getContextBounds().width,r=e.getBoundingClientRect(),n=this.parent.element.getBoundingClientRect(),s=r.left-i-n.left,a=r.right+i-n.right,l=e.offsetWidth-e.clientWidth;l=l?l+1:0;var h=this.parent.enableRtl?s:a;return h<1?r.right+1-l:r.left-i-1+l},t.prototype.openDialog=function(e){var i=this;if(this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),!e.cancel){this.dialogObj.dataBind();var r=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter(function(s){return i.options.field===s.field}).length;this.createMenu(e.type,r>0,r===1||r===2,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent&&!g(this.parent.getContent)&&this.parent.getContent()&&this.parent.getContent().firstElementChild.offsetHeight<this.dlg.offsetHeight&&!Fr(this.parent.element,"e-gantt-dialog")&&xR(this.parent,this.dialogObj),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"});var n=this.dlg.querySelectorAll(".e-menu-item");n.forEach(function(s){s.scrollWidth>s.clientWidth&&s.setAttribute("title",s.textContent)}),e.column.showColumnMenu&&this.parent.notify(Gf,{}),this.wireExEvents()}},t.prototype.closeDialog=function(){this.destroy()},t.prototype.selectHandler=function(e){e.item&&(this.parent.notify($y,{}),this.menuItem=e.item,this.closeDialog(),this.renderDialogue(e))},t.prototype.renderDialogue=function(e){var i=this,r=e?e.element:void 0,n=this.options.field,s=!g(n)&&Il(n),a=!g(n)&&wh(n),l=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:s?a+"-xlflmenu":n+"-xlflmenu"});if(this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:s?a+"-xlfldlg":n+"-xlfldlg"}),this.options.isResponsiveFilter){var h=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv");h.appendChild(this.dlgDiv)}else this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new cc({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,locale:this.parent.locale,closeOnEscape:!0,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){for(var u=[].slice.call(i.dlgObj.element.querySelectorAll("table.e-xlfl-table tr.e-xlfl-fields")),d=0;d<u.length;d++){var p=u[d].children[1].querySelector(".e-control"),f=u[d].querySelector(".e-dropdownlist.e-control").ej2_instances[0];f.value==="isempty"||f.value==="isnotempty"||f.value==="isnull"||f.value==="isnotnull"?p.ej2_instances[0].enabled=!1:p&&!g(p.getAttribute("disabled"))&&(p.ej2_instances[0].enabled=!0)}var v=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");if(i.options.column.filterTemplate){var m=Il(i.options.column.field)?wh(i.options.column.field):i.options.column.field,y=i.parent.isReact&&typeof i.options.column.filterTemplate!="string"&&!(i.options.column.filterTemplate.prototype&&i.options.column.filterTemplate.prototype.CSPTemplate),b=i.parent.parentDetails&&i.parent.parentDetails.parentInstObj&&i.parent.parentDetails.parentInstObj.isReact;y||b?i.parent.renderTemplates(function(){v.querySelector("#"+m+"-xlfl-frstvalue").focus()}):v.querySelector("#"+m+"-xlfl-frstvalue").focus()}},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,r,n),buttons:[{click:this.filterBtnClick.bind(this,n),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:l,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});var c="isStringTemplate";this.dlgObj[""+c]=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.unshift(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},t.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var e=document.querySelector(".e-row-responsive-filter");e&&e.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},t.prototype.removeDialog=function(){this.parent.notify(eq,{}),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&YI(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),Qe(this.dlgDiv),this.parent.notify(xh,{})},t.prototype.createdDialog=function(e,i){if(this.renderCustomFilter(e,i),this.dlgObj.element.style.left="0px",!this.options.isResponsiveFilter)this.dlgObj.element.style.top="0px";else{var r=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),n=r.offsetHeight+4;this.dlgObj.element.style.top=n+"px"}!this.options.isResponsiveFilter&&j.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify(Qy,{column:i,dialog:this.dialogObj});var s={column:i,dialogInstance:this.dialogObj,cancel:!1,target:e};if(this.parent.trigger(KW,s),s.cancel){(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&YI(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),Qe(this.dlgDiv);return}this.dlgObj.show(),vR(this.parent.element,this.dlgObj.element.parentElement)},t.prototype.renderCustomFilter=function(e,i){var r=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),n=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});r.appendChild(n);var s=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});r.appendChild(s),this.renderFilterUI(i,r)},t.prototype.filterBtnClick=function(e){var i=!g(e)&&Il(e),r=!g(e)&&wh(e),n=i?r:e,s=this.dlgDiv.querySelector("#"+n+"-xlfl-frstvalue").ej2_instances[0],a=this.dlgDiv.querySelector("#"+n+"-xlfl-frstoptr").ej2_instances[0],l=this.dlgDiv.querySelector("#"+n+"-xlfl-secndvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+n+"-xlfl-secndoptr").ej2_instances[0],c;if(this.options.type==="string"){var u=this.dlgDiv.querySelector("#"+n+"-xlflmtcase").ej2_instances[0];c=u.checked}var d=this.dlgDiv.querySelector("#"+n+"e-xlfl-frstpredicate").ej2_instances[0],p=d.checked?"and":"or";this.filterByColumn(this.options.field,a.value,s.value,p,c,this.options.ignoreAccent,h.value,l.value),this.removeDialog()},t.prototype.filterByColumn=function(e,i,r,n,s,a,l,h){var c=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,u=this.isForeignColumn(c)?c.foreignKeyValue:e,d=[],p,f={instance:this,handler:this.filterByColumn,arg1:e,arg2:i,arg3:r,arg4:n,arg5:s,arg6:a,arg7:l,arg8:h,cancel:!1};if(this.parent.notify(Dc,f),!f.cancel){d.push({field:u,predicate:n,matchCase:s,ignoreAccent:a,operator:i,value:f.arg3,type:this.options.type}),p=new xt(u,i.toLowerCase(),f.arg3,!s,a),g(l)||(d.push({field:u,predicate:n,matchCase:s,ignoreAccent:a,operator:l,value:f.arg8,type:this.options.type}),p=p[""+n](u,l.toLowerCase(),h,!s,a));var v={action:"filtering",filterCollection:d,field:this.options.field,ejpredicate:p,actualPredicate:d};this.isForeignColumn(c)?this.foreignKeyFilter(v,d,p):this.options.handler(v)}},t.prototype.renderOperatorUI=function(e,i,r,n,s){var a=this.parent.createElement("tr",{className:"e-xlfl-fields",attrs:{role:"row"}});i.appendChild(a);var l=this.parent.createElement("td",{className:"e-xlfl-optr"});a.appendChild(l);var h=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),c=!g(e)&&Il(e),u=!g(e)&&wh(e),d=this.parent.createElement("input",{id:c?u+r:e+r});h.appendChild(d),l.appendChild(h);var p=this.options.type+"Operator",f=this.customFilterOperators[""+p];this.optrData=f;var v=this.dropSelectedVal(this.options.column,n,s),m="";this.menuItem&&(m=this.menuItem.text.slice(0,-3),m!==this.getLocalizedLabel("CustomFilter")&&(v=s?m:void 0),m===this.getLocalizedLabel("Between")&&(v=this.getLocalizedLabel(s?"GreaterThanOrEqual":"LessThanOrEqual")));var y=this.options.column,b=new $s(Wf({dataSource:f,fields:{text:"text",value:"value"},text:v,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},y.filter.params));this.childRefs.unshift(b);var S={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};yR(d.id,[_y,Uy],S,this),b.addEventListener(_y,this.eventHandlers[d.id][_y]),b.addEventListener(Uy,this.eventHandlers[d.id][Uy]),b.appendTo(d);var C=this.getSelectedValue(v);return{fieldElement:a,operator:C}},t.prototype.removeHandlersFromComponent=function(e){e.element.classList.contains("e-dropdownlist")?bR(e,[_y,Uy],this):e.element.classList.contains("e-autocomplete")&&bR(e,[Vy,Wy],this)},t.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},t.prototype.dropDownValueChange=function(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString();var i=e.element.closest(".e-xlfl-fields").children[1].querySelector(".e-control"),r=e.element.ej2_instances[0];r.value==="isempty"||r.value==="isnotempty"||r.value==="isnull"||r.value==="isnotnull"?i.ej2_instances[0].enabled=!1:g(i.getAttribute("disabled"))||(i.ej2_instances[0].enabled=!0)},t.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},t.prototype.getSelectedValue=function(e){var i=new oe(this.optrData).executeLocal(new Pe().where("text","equal",e));return g(i[0])?"":i[0].value},t.prototype.dropSelectedVal=function(e,i,r){var n;return i&&i.length>0?n=i.length===2?r?i[0].operator:i[1].operator:r?i[0].operator:void 0:r&&e.type==="string"&&!e.filter.operator?n="startswith":n=r?e.filter.operator||"equal":void 0,this.getSelectedText(n)},t.prototype.getSelectedText=function(e){var i=new oe(this.optrData).executeLocal(new Pe().where("value","equal",e));return g(i[0])?"":i[0].text},t.prototype.renderFilterUI=function(e,i){var r=this.existingPredicate[""+e],n=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}});i.appendChild(n);var s=this.parent.createElement(aq);s.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',n.appendChild(s);var a=this.renderOperatorUI(e,n,"-xlfl-frstoptr",r,!0);this.firstOperator=a.operator,this.renderFlValueUI(e,a,"-xlfl-frstvalue",r,!0);var l=this.parent.createElement("tr",{className:"e-xlfl-predicate",attrs:{role:"row"}});n.appendChild(l),this.renderRadioButton(e,l,r),a=this.renderOperatorUI(e,n,"-xlfl-secndoptr",r,!1),this.secondOperator=a.operator,this.renderFlValueUI(e,a,"-xlfl-secndvalue",r,!1)},t.prototype.renderRadioButton=function(e,i,r){var n=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});i.appendChild(n);var s=this.parent.createElement("div",{className:"e-xlfl-radiodiv"});s.style.display="inline-block";var a=!g(e)&&Il(e),l=!g(e)&&wh(e),h=this.parent.createElement("input",{id:a?l+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),c=this.parent.createElement("input",{id:a?l+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});s.appendChild(h),s.appendChild(c),n.appendChild(s),this.options.type==="string"&&this.renderMatchCase(e,i,n,"-xlflmtcase",r);var u=new Ou({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(u);var d=new Ou({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(d);var p=r&&r.length===2?r[1].predicate:"and";p==="and"?(u.checked=!0,d.checked=!1):(d.checked=!0,u.checked=!1),u.appendTo(h),d.appendTo(c),u.element.nextElementSibling.classList.add("e-xlfl-radio-and"),d.element.nextElementSibling.classList.add("e-xlfl-radio-or")},t.prototype.removeObjects=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n&&!n.isDestroyed&&(this.removeHandlersFromComponent(n),n.destroy())}},t.prototype.renderFlValueUI=function(e,i,r,n,s){var a=this.parent.createElement("td",{className:"e-xlfl-value"});i.fieldElement.appendChild(a);var l=!g(e)&&Il(e),h=!g(e)&&wh(e),c=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),u=this.options.filteredColumns.some(function(D){return e===D.field}),d=this.options.filteredColumns.filter(function(D){return D.field===e});if(this.options.column.filterTemplate){var p={},f=this.options.column;u&&r&&(p=this.getExcelFilterData(r,p,f,n,d));var v=this.parent.isReact&&typeof this.options.column.filterTemplate!="string"&&!(this.options.column.filterTemplate.prototype&&this.options.column.filterTemplate.prototype.CSPTemplate),m=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,y=this.parent.element.id+f.uid+"filterTemplate";if(v||m)this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",y,null,null,c);else{var b=this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",y,null,null,null,this.parent.root);nd(c,b)}v||m?this.parent.renderTemplates(function(){c.querySelector("input").id=l?h+r:e+r,a.appendChild(c)}):((this.parent.isAngular?c.children[0]:c.querySelector("input")).id=l?h+r:e+r,a.appendChild(c))}else{var S=this.parent.createElement("input",{id:l?h+r:e+r});c.appendChild(S),a.appendChild(c);var C=void 0,x=void 0;n&&n.length>0&&(x=n.length===2?s?n[0]:n[1]:s?n[0]:void 0,C=x&&x.operator===i.operator?x.value:void 0,g(C)&&(C=void 0));var I={string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),dateonly:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)};I[this.options.type](this.options,e,S,C,this.parent.enableRtl)}},t.prototype.getExcelFilterData=function(e,i,r,n,s){var a=e==="-xlfl-frstvalue"?0:1;if(e==="-xlfl-frstvalue"||s.length>1){i={column:n instanceof Array?n[parseInt(a.toString(),10)]:n};var l=this.options.column.columnData&&s.length>1?this.options.column.columnData.length===1?0:1:a;i[this.options.field]=r.foreignKeyValue?this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue]:s[parseInt(l.toString(),10)].value,this.options.foreignKeyValue&&(i[this.options.foreignKeyValue]=this.options.column.columnData[parseInt(l.toString(),10)][r.foreignKeyValue])}return i},t.prototype.renderMatchCase=function(e,i,r,n,s){var a=this.parent.createElement("div",{className:"e-xlfl-matchcasediv"});a.style.display="inline-block";var l=!g(e)&&Il(e),h=!g(e)&&wh(e),c=this.parent.createElement("input",{id:l?h+n:e+n,attrs:{type:"checkbox"}});a.appendChild(c),r.appendChild(a);var u=s&&s.length>0?s&&s.length===2?s[1].matchCase:s[0].matchCase:!1,d=new ma({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:u,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.unshift(d),d.appendTo(c)},t.prototype.renderDate=function(e,i,r,n,s){var a=gR(e.format,e.type)||e.format,l=new UI(Wf({format:a,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},e.column.filter.params));this.childRefs.unshift(l),l.appendTo(r)},t.prototype.renderDateTime=function(e,i,r,n,s){var a=gR(e.format,e.type),l=new oR(Wf({format:a,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},e.column.filter.params));this.childRefs.unshift(l),l.appendTo(r)},t.prototype.completeAction=function(e){e.result=hq(e.result)},t.prototype.renderNumericTextBox=function(e,i,r,n,s){var a=new ba(Wf({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,value:n,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.filter.params));this.childRefs.unshift(a),a.appendTo(r)},t.prototype.renderAutoComplete=function(e,i,r,n,s){var a=this.options.column,l=this.isForeignColumn(a),h=l?a.dataSource:e.dataSource,c={value:l?a.foreignKeyValue:i},u=new Ry(Wf({dataSource:h instanceof oe?h:new oe(h),fields:c,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,text:n},a.filter.params));if(h&&"result"in h){var d=wR({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger(CR,d.state);var p=d.deffered;p.promise.then(function(v){u.dataSource=new oe(v)})}this.childRefs.unshift(u);var f={actionComplete:this.acActionComplete(u,i),focus:this.acFocus(u,i,e,r)};yR(r.id,[Vy,Wy],f,this),u.addEventListener(Wy,this.eventHandlers[r.id][Wy]),u.addEventListener(Vy,this.eventHandlers[r.id][Vy]),u.appendTo(r)},t.prototype.acActionComplete=function(e,i){return function(r){var n=!g(i)&&Il(i);r.result=r.result.filter(function(s,a,l){return l.map(function(h){return n?mR(e.fields.value,h):h[e.fields.value]}).indexOf(n?mR(e.fields.value,s):s[e.fields.value])===a})}},t.prototype.acFocus=function(e,i,r,n){var s=this;return function(){var a=!g(i)&&Il(i),l=!g(i)&&wh(i),h=a?l:i;e.filterType=s.dlgDiv.querySelector("#"+h+(n.id===h+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,e.ignoreCase=r.type==="string"?!s.dlgDiv.querySelector("#"+h+"-xlflmtcase").ej2_instances[0].checked:!0,e.filterType=g(e.filterType)?"equal":e.filterType}},t})(Zy);kI.Inject(FI);kI.Inject(FI);var Qae={header:"."+nq,content:"."+sq,edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup",autofit:"e-icon-autofit",autofitall:"e-icon-autofitall",chart:"e-grid-chart-icon",barChart:"e-grid-bar-chart-icon",bar:"e-grid-bar-icon",stackingBar:"e-grid-stacking-bar-icon",stackingBar100:"e-grid-stacking-bar-100-icon",pie:"e-grid-pie-icon",columnChart:"e-grid-column-chart-icon",column:"e-grid-column-icon",stackingColumn:"e-grid-stacking-column-icon",stackingColumn100:"e-grid-stacking-column-100-icon",lineChart:"e-grid-line-chart-icon",line:"e-grid-line-icon",stackingLine:"e-grid-stacking-line-icon",stackingLine100:"e-grid-stacking-line-100-icon",areaChart:"e-grid-area-chart-icon",area:"e-grid-area-icon",stackingArea:"e-grid-stacking-area-icon",stackingArea100:"e-grid-stacking-area-100-icon",scatter:"e-grid-scatter-icon"};var Ih=(function(){function o(t){this.svgLink="http://www.w3.org/2000/svg",this.rootId=t}return o.prototype.getOptionValue=function(t,e){return t[e]},o.prototype.createSvg=function(t){return g(t.id)&&(t.id=this.rootId+"_svg"),this.svgObj=document.getElementById(t.id),g(document.getElementById(t.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(t,this.svgObj),this.setSVGSize(t.width,t.height),this.svgObj},o.prototype.setSVGSize=function(t,e){var i=document.getElementById(this.rootId),r=g(i)?null:i.getBoundingClientRect();g(this.width)||this.width<=0?this.svgObj.setAttribute("width",t?t.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),g(this.height)||this.height<=0?this.svgObj.setAttribute("height",e?e.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},o.prototype.drawPath=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"path")),e=this.setElementAttributes(t,e),e},o.prototype.drawLine=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"line")),e=this.setElementAttributes(t,e),e},o.prototype.drawRectangle=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"rect")),e=this.setElementAttributes(t,e),e},o.prototype.drawCircle=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"circle")),e=this.setElementAttributes(t,e),e},o.prototype.drawPolyline=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"polyline")),e=this.setElementAttributes(t,e),e},o.prototype.drawEllipse=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"ellipse")),e=this.setElementAttributes(t,e),e},o.prototype.drawPolygon=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"polygon")),e=this.setElementAttributes(t,e),e},o.prototype.drawImage=function(t){var e=document.createElementNS(this.svgLink,"image");return e.setAttributeNS(null,"height",t.height.toString()),e.setAttributeNS(null,"width",t.width.toString()),e.setAttributeNS("http://www.w3.org/1999/xlink","href",t.href),e.setAttributeNS(null,"x",t.x.toString()),e.setAttributeNS(null,"y",t.y.toString()),e.setAttributeNS(null,"id",t.id),e.setAttributeNS(null,"visibility",t.visibility),g(this.getOptionValue(t,"clip-path"))||e.setAttributeNS(null,"clip-path",this.getOptionValue(t,"clip-path")),g(t.preserveAspectRatio)||e.setAttributeNS(null,"preserveAspectRatio",t.preserveAspectRatio),e},o.prototype.createText=function(t,e){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(t,i),g(e)||(i.textContent=e),i},o.prototype.createTSpan=function(t,e){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(t,i),g(e)||(i.textContent=e),i},o.prototype.createTitle=function(t){var e=document.createElementNS(this.svgLink,"title");return e.textContent=t,e},o.prototype.createDefs=function(){var t=document.createElementNS(this.svgLink,"defs");return t},o.prototype.createClipPath=function(t){var e=document.createElementNS(this.svgLink,"clipPath");return e=this.setElementAttributes(t,e),e},o.prototype.createForeignObject=function(t){var e=document.createElementNS(this.svgLink,"foreignObject");return e=this.setElementAttributes(t,e),e},o.prototype.createGroup=function(t){var e=document.createElementNS(this.svgLink,"g");return e=this.setElementAttributes(t,e),e},o.prototype.createPattern=function(t,e){var i=document.createElementNS(this.svgLink,e);return i=this.setElementAttributes(t,i),i},o.prototype.createRadialGradient=function(t,e,i){var r;if(g(t[0].colorStop))r=t[0].color.toString();else{var n={id:this.rootId+"_"+e+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",n,t),r="url(#"+this.rootId+"_"+e+"radialGradient)"}return r},o.prototype.createLinearGradient=function(t,e,i){var r;if(g(t[0].colorStop))r=t[0].color.toString();else{var n={id:this.rootId+"_"+e+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",n,t),r="url(#"+this.rootId+"_"+e+"linearGradient)"}return r},o.prototype.drawGradient=function(t,e,i){var r=this.createDefs(),n=document.createElementNS(this.svgLink,t);n=this.setElementAttributes(e,n);for(var s=0;s<i.length;s++){var a=document.createElementNS(this.svgLink,"stop");a.setAttribute("offset",i[s].colorStop),a.setAttribute("stop-color",i[s].color),a.setAttribute("stop-opacity",i[s].opacity?i[s].opacity:"1"),g(i[s].style)||(a.style.cssText=i[s].style),n.appendChild(a)}return r.appendChild(n),r},o.prototype.drawClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id});t.id=t.id+"_Rect";var r=this.drawRectangle(t);return i.appendChild(r),e.appendChild(i),e},o.prototype.drawCircularClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id});t.id=t.id+"_Circle";var r=this.drawCircle(t);return i.appendChild(r),e.appendChild(i),e},o.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),r=0;r<i.length;r++)i[r]==="style"?e.style.cssText=t[i[r]]:e.setAttribute(i[r],t[i[r]]);return e},o.prototype.createCanvas=function(){return null},o})(),GI=(function(){function o(t){this.rootId=t}return o.prototype.getOptionValue=function(t,e){return t[e]},o.prototype.createCanvas=function(t){var e=document.createElement("canvas");return e.setAttribute("id",this.rootId+"_canvas"),this.ctx=e.getContext("2d"),this.canvasObj=e,this.setCanvasSize(t.width,t.height),this.canvasObj},o.prototype.setCanvasSize=function(t,e){var i=document.getElementById(this.rootId),r=g(i)?null:i.getBoundingClientRect();g(this.width)?this.canvasObj.setAttribute("width",t?t.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),g(this.height)?this.canvasObj.setAttribute("height",e?e.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},o.prototype.setAttributes=function(t){this.ctx.lineWidth=this.getOptionValue(t,"stroke-width");var e=this.getOptionValue(t,"stroke-dasharray");if(!g(e)){var i=e.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(t,"stroke")},o.prototype.drawLine=function(t){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.stroke(),this.ctx.restore()},o.prototype.drawRectangle=function(t,e){var i=this.ctx,r=t.rx;return this.ctx.save(),this.ctx.beginPath(),e&&this.ctx.translate(e[0],e[1]),this.ctx.globalAlpha=this.getOptionValue(t,"opacity"),this.setAttributes(t),this.ctx.rect(t.x,t.y,t.width,t.height),r!==null&&r>=0?this.drawCornerRadius(t):(t.fill==="none"&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,this.ctx.fillRect(t.x,t.y,t.width,t.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawCornerRadius=function(t){var e=t.rx,i=t.x,r=t.y,n=t.width,s=t.height;t.fill==="none"&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,n<2*e&&(e=n/2),s<2*e&&(e=s/2),this.ctx.beginPath(),this.ctx.moveTo(i+n-e,r),this.ctx.arcTo(i+n,r,i+n,r+s,e),this.ctx.arcTo(i+n,r+s,i,r+s,e),this.ctx.arcTo(i,r+s,i,r,e),this.ctx.arcTo(i,r,i+n,r,e),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()},o.prototype.drawPath=function(t,e){var i=t.d,r=i.split(" "),n=this.getOptionValue(t,"stroke-width"),s=this.ctx,a=!0;this.ctx.save(),this.ctx.beginPath(),e&&this.ctx.translate(e[0],e[1]),this.ctx.globalAlpha=t.opacity?t.opacity:this.getOptionValue(t,"fill-opacity"),this.setAttributes(t);for(var l=0;l<r.length;l=l+3){var h=parseFloat(r[l+1]),c=parseFloat(r[l+2]);switch(r[l]){case"M":!t.innerR&&!t.cx&&this.ctx.moveTo(h,c);break;case"L":t.innerR||this.ctx.lineTo(h,c);break;case"Q":var u=parseFloat(r[l+3]),d=parseFloat(r[l+4]);this.ctx.quadraticCurveTo(h,c,u,d),l=l+2;break;case"C":var p=parseFloat(r[l+3]),f=parseFloat(r[l+4]),v=parseFloat(r[l+5]),m=parseFloat(r[l+6]);this.ctx.bezierCurveTo(h,c,p,f,v,m),l=l+4;break;case"A":t.innerR?a&&(this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.arc(t.x,t.y,t.innerR,t.end,t.start,!t.counterClockWise),a=!1):t.cx?this.ctx.arc(t.cx,t.cy,t.radius,0,2*Math.PI,t.counterClockWise):(this.ctx.moveTo(t.x,t.y),this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.lineTo(t.x,t.y)),l=l+5;break;case"z":case"Z":this.ctx.closePath(),l=l-2;break}}return t.fill!=="none"&&t.fill!==void 0&&(this.ctx.fillStyle=t.fill,this.ctx.fill()),n>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=s,this.canvasObj},o.prototype.createText=function(t,e,i,r,n,s){var a=this.getOptionValue(t,"font-weight");!g(a)&&a.toLowerCase()==="regular"&&(a="normal");var l=this.getOptionValue(t,"font-size"),h=this.getOptionValue(t,"font-family"),c=this.getOptionValue(t,"font-style").toLowerCase(),u=c+" "+a+" "+l+" "+h,d=this.getOptionValue(t,"text-anchor"),p=t.opacity!==void 0?t.opacity:1;if(d==="middle"&&(d="center"),this.ctx.save(),this.ctx.fillStyle=t.fill,this.ctx.font=u,this.ctx.textAlign=d,this.ctx.globalAlpha=p,t.baseline&&(this.ctx.textBaseline=t.baseline),!s){var f=0;this.ctx.translate(t.x+f/2+(i||0),t.y+(r||0)),this.ctx.rotate(t.labelRotation*Math.PI/180)}return this.ctx.fillText(e,s?t.x:0,s?n:0),this.ctx.restore(),this.canvasObj},o.prototype.drawCircle=function(t,e){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),this.ctx.fillStyle=t.fill,this.ctx.globalAlpha=t.opacity,this.ctx.fill(),e&&this.ctx.translate(e[0],e[1]),this.setAttributes(t),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawPolyline=function(t){this.ctx.save(),this.ctx.beginPath();for(var e=t.points.split(" "),i=0;i<e.length-1;i++){var r=e[i].split(","),n=parseFloat(r[0]),s=parseFloat(r[1]);i===0?this.ctx.moveTo(n,s):this.ctx.lineTo(n,s)}this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore()},o.prototype.drawEllipse=function(t,e){var i=this.ctx,r=Math.max(t.rx,t.ry),n=t.rx/r,s=t.ry/r;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(t.cx,t.cy),e&&this.ctx.translate(e[0],e[1]),this.ctx.save(),this.ctx.scale(n,s),this.ctx.arc(0,0,r,0,2*Math.PI,!1),this.ctx.fillStyle=t.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i},o.prototype.drawImage=function(t){this.ctx.save();var e=new Image;g(t.href)||(e.src=t.href,this.ctx.drawImage(e,t.x,t.y,t.width,t.height)),this.ctx.restore()},o.prototype.createLinearGradient=function(t){var e;g(t[0].colorStop)||(e=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height));var i=this.setGradientValues(t,e);return i},o.prototype.createRadialGradient=function(t){var e;g(t[0].colorStop)||(e=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height));var i=this.setGradientValues(t,e);return i},o.prototype.setGradientValues=function(t,e){var i;if(g(t[0].colorStop))i=t[0].color.toString();else{for(var r=0;r<=t.length-1;r++){var n=t[r].color,s=t[r].colorStop.slice(0,-1),a=parseInt(s,10)/100;e.addColorStop(a,n)}i=e.toString()}return i},o.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),r=Object.keys(t).map(function(s){return t[s]}),n=0;n<i.length;n++)e.setAttribute(i[n],r[n]);return null},o.prototype.updateCanvasAttributes=function(t){this.setElementAttributes(t,this.canvasObj);var e=this.ctx;if(!g(this.dataUrl)){var i=new Image;i.onload=function(){e.drawImage(i,0,0)},i.src=this.dataUrl}},o.prototype.clearRect=function(t){this.ctx.restore(),this.ctx.clearRect(t.x,t.y,t.width,t.height)},o.prototype.createGroup=function(){return null},o.prototype.drawClipPath=function(){return null},o.prototype.drawCircularClipPath=function(){return null},o.prototype.canvasClip=function(t){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(t.x,t.y,t.width,t.height),this.ctx.fill(),this.ctx.clip()},o.prototype.canvasRestore=function(){this.ctx.restore()},o.prototype.drawPolygon=function(){return null},o.prototype.createDefs=function(){return null},o.prototype.createClipPath=function(){return null},o.prototype.createSvg=function(){return null},o})();function mq(o){var t;switch(o){case"Highcontrast":case"HighContrast":t={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",textStyle:{fontFamily:"Segoe UI",color:"#000000",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={tooltipFill:o==="MaterialDark"?"#F4F4F4":o==="FabricDark"?"#A19F9D":"#F0F0F0",tooltipBoldLabel:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",tooltipLightLabel:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",tooltipHeaderLine:"#9A9A9A",textStyle:o==="MaterialDark"?{fontFamily:"Roboto",color:"rgba(18, 18, 18, 1)",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:o==="FabricDark"?{fontFamily:"Segoe UI",color:"#DADADA",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:{fontFamily:"Helvetica",color:"#1A1A1A",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Bootstrap4":t={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)",textStyle:{fontFamily:"Helvetica",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind3":t={tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#D1D5DB",textStyle:{fontFamily:"Inter",color:"#F9FAFB",fontWeight:"500",size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind3Dark":t={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#374151",textStyle:{fontFamily:"Inter",color:"#1F2937",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Tailwind":t={tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",textStyle:{fontFamily:"Inter",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"TailwindDark":t={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",textStyle:{fontFamily:"Inter",color:"#1F2937",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Bootstrap5":t={tooltipFill:"#000000E5",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#FFFFFF",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"16px",boldTextSize:"14px"}};break;case"Bootstrap5Dark":t={tooltipFill:"#FFFFFFE5",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#212529",textStyle:{fontFamily:"Helvetica",color:"#212529",fontWeight:null,size:"12px",headerTextSize:"16px",boldTextSize:"14px"}};break;case"Fluent":t={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",textStyle:{fontFamily:"Segoe UI",color:"#323130",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"FluentDark":t={tooltipFill:"#323130",tooltipBoldLabel:"#F3F2F2",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#F3F2F1",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2":t={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#242424",tooltipLightLabel:"#242424",tooltipHeaderLine:"#D2D0CE",textStyle:{fontFamily:"Segoe UI",color:"#242424",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2Dark":t={tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Fluent2HighContrast":t={tooltipFill:"#000000",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",textStyle:{fontFamily:"Segoe UI",color:"#FFFFFF",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Material3":t={tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",textStyle:{fontFamily:"Roboto",color:"#F4EFF4",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;case"Material3Dark":t={tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",textStyle:{fontFamily:"Roboto",color:"#313033",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break;default:t={tooltipFill:o==="Material"?"#000816":o==="Fabric"?"#FFFFFF":"#212529",tooltipBoldLabel:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",tooltipLightLabel:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",tooltipHeaderLine:o==="Fabric"?"#D2D0CE":"#ffffff",textStyle:o==="Material"?{fontFamily:"Roboto",color:"rgba(249, 250, 251, 1)",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:o==="Fabric"?{fontFamily:"Segoe UI",color:"#333333",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}:{fontFamily:"Helvetica",color:"#F9FAFB",fontWeight:null,size:"12px",headerTextSize:"12px",boldTextSize:"12px"}};break}return t}var ER=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})();function Xe(o,t,e,i){var r=o||"",n=document.getElementById("chartmeasuretext");if(n===null&&(n=et("text",{id:"chartmeasuretext"}),document.body.appendChild(n)),typeof o=="string"&&(o.indexOf("<")>-1||o.indexOf(">")>-1)){for(var s=o.split(" "),a=0;a<s.length;a++)s[a].indexOf("<br/>")===-1&&(s[a]=s[a].replace(/[<>]/g,"&"));o=s.join(" ")}n.innerHTML=r.indexOf("<br>")>-1||r.indexOf("<br/>")>-1?r:o,n.style.position="fixed",n.style.fontSize=t.size||(i?e.headerTextSize:e.size),n.style.fontStyle=t.fontStyle||e.fontStyle,n.style.fontFamily=t.fontFamily||e.fontFamily,n.style.visibility="hidden",n.style.top="-100",n.style.left="0",n.style.whiteSpace="nowrap",n.style.lineHeight="normal";var l=n.clientWidth,h=n.clientHeight,c=n.style.fontWeight;return n.style.fontWeight=t.fontWeight||e.fontWeight,new Wt(n.style.fontWeight==="bold"&&c==="normal"?Math.max(l,n.clientWidth):n.clientWidth,n.style.fontWeight==="bold"&&c==="normal"?Math.max(h,n.clientHeight):n.clientHeight)}function MR(o,t,e,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=e.x-i&&o<=e.x+e.width+i&&t>=e.y-r&&t<=e.y+e.height+r}function yq(o,t,e,i,r,n,s,a,l,h,c){c===void 0&&(c="");var u="",d=e.x,p=e.y,f=e.x+e.width,v=e.y+e.height;return n?(u=u.concat("M "+d+" "+(p+t)+" Q "+d+" "+p+" "+(d+o)+" "+p+"  L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+t)),u=u.concat(" L "+f+" "+(v-t)+" Q "+f+" "+v+" "+(f-o)+" "+v),r!==0&&(c==="RangeNavigator"?i.x-r>f/2?(u=u.concat(" L "+(i.x+r)+" "+v),u=u.concat(" L "+(l+r)+" "+(v+r)+" L "+i.x+" "+v)):(u=u.concat(" L "+i.x+" "+v),u=u.concat(" L "+(l-r)+" "+(v+r)+" L "+(i.x-r)+" "+v)):(u=u.concat(" L "+(i.x+r)+" "+v),u=u.concat(" L "+l+" "+(v+r)+" L "+(i.x-r)+" "+v))),i.x-r>d||r===0?u=u.concat(" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-t)+" z"):u=u.concat(" L "+d+" "+(v+t)+" z")):s?(u=u.concat("M "+d+" "+(p+t)+" Q "+d+" "+p+" "+(d+o)+" "+p+" L "+(i.x-r)+" "+p),u=u.concat(" L "+l+" "+i.y),u=u.concat(" L "+(i.x+r)+" "+p),u=u.concat(" L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+(p+t)),u=u.concat(" L "+f+" "+(v-t)+" Q "+f+" "+v+" "+(f-o)+" "+v+" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-t)+" z")):a?(u=u.concat("M "+d+" "+(p+t)+" Q "+d+" "+p+" "+(d+o)+" "+p),u=u.concat(" L "+(f-o)+" "+p+" Q "+f+" "+p+" "+f+" "+((c==="RangeNavigator"?0:p+t)+" L "+f+" "+(c==="RangeNavigator"?0:i.y-r))),u=c==="RangeNavigator"?u.concat(" L "+(f+r)+" 0"):u.concat(" L "+(f+r)+" "+h),u=c==="RangeNavigator"?u.concat(" L "+f+" "+(i.y-t)):u.concat(" L "+f+" "+(i.y+r)),u=u.concat(" L "+f+" "+(v-t)+" Q "+f+" "+v+" "+(f-o)+" "+v),u=u.concat(" L "+(d+o)+" "+v+" Q "+d+" "+v+" "+d+" "+(v-t)+" z")):(u=u.concat("M "+(d+o)+" "+p+" Q "+d+" "+p+" "+d+" "+((c==="RangeNavigator"?0:p+t)+" L "+d+" "+(c==="RangeNavigator"?0:i.y-r))),u=c==="RangeNavigator"?u.concat(" L "+(d-r)+" 0"):u.concat(" L "+(d-r)+" "+h),u=c==="RangeNavigator"?u.concat(" L "+d+" "+(i.y-t)):u.concat(" L "+d+" "+(i.y+r)),u=u.concat(" L "+d+" "+(v-t)+" Q "+d+" "+v+" "+(d+o)+" "+v),u=u.concat(" L "+(f-o)+" "+v+" Q "+f+" "+v+" "+f+" "+(v-t)+" L "+f+" "+(p+t)+" Q "+f+" "+p+" "+(f-o)+" "+p+" z")),u}var Wt=(function(){function o(t,e){this.width=t,this.height=e}return o})(),Le=(function(){function o(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r}return o})(),bq=(function(){function o(t,e){this.isRight=e,this.isBottom=t}return o})(),TR=(function(){function o(t){this.id=t}return o})(),bn=(function(o){ER(t,o);function t(e,i,r,n,s,a,l,h){a===void 0&&(a="");var c=o.call(this,e)||this;return c.transform="",c.baseLine="auto",c.labelRotation=0,c.x=i,c.y=r,c.anchor=n,c.text=s,c.transform=a,c.baseLine=l,c.labelRotation=h,c}return t})(TR);function rs(o){return document.getElementById(o)}function Qf(o){var t=rs(o);t&&Qe(t)}function Sq(o,t,e,i,r,n,s){var a=new Ih(""),l=Cq(o,e,t,r,i),h=a["draw"+l.functionName](l.renderOption);return h.setAttribute("role",n),h.setAttribute("aria-label",s),h}function Cq(o,t,e,i,r){var n,s="Path",a=t.width,l=t.height,h=o.x,c=o.y,u=o.x+-a/2,d=o.y+-l/2;switch(e){case"Circle":case"Bubble":s="Ellipse",mt(i,{rx:a/2,ry:l/2,cx:h,cy:c});break;case"Plus":n="M "+u+" "+c+" L "+(h+a/2)+" "+c+" M "+h+" "+(c+l/2)+" L "+h+" "+(c+-l/2),mt(i,{d:n,stroke:i.fill});break;case"Cross":n="M "+u+" "+(c+-l/2)+" L "+(h+a/2)+" "+(c+l/2)+" M "+u+" "+(c+l/2)+" L "+(h+a/2)+" "+(c+-l/2),mt(i,{d:n,stroke:i.fill});break;case"HorizontalLine":n="M "+u+" "+c+" L "+(h+a/2)+" "+c,mt(i,{d:n,stroke:i.fill});break;case"VerticalLine":n="M "+h+" "+(c+l/2)+" L "+h+" "+(c+-l/2),mt(i,{d:n,stroke:i.fill});break;case"Diamond":n="M "+u+" "+c+" L "+h+" "+(c+-l/2)+" L "+(h+a/2)+" "+c+" L "+h+" "+(c+l/2)+" L "+u+" "+c+" z",mt(i,{d:n});break;case"Rectangle":n="M "+u+" "+(c+-l/2)+" L "+(h+a/2)+" "+(c+-l/2)+" L "+(h+a/2)+" "+(c+l/2)+" L "+u+" "+(c+l/2)+" L "+u+" "+(c+-l/2)+" z",mt(i,{d:n});break;case"Triangle":n="M "+u+" "+(c+l/2)+" L "+h+" "+(c+-l/2)+" L "+(h+a/2)+" "+(c+l/2)+" L "+u+" "+(c+l/2)+" z",mt(i,{d:n});break;case"InvertedTriangle":n="M "+(h+a/2)+" "+(c-l/2)+" L "+h+" "+(c+l/2)+" L "+(h-a/2)+" "+(c-l/2)+" L "+(h+a/2)+" "+(c-l/2)+" z",mt(i,{d:n});break;case"Pentagon":for(var p=72,f=void 0,v=void 0,m=0;m<=5;m++)f=a/2*Math.cos(Math.PI/180*(m*p)),v=l/2*Math.sin(Math.PI/180*(m*p)),m===0?n="M "+(h+f)+" "+(c+v)+" ":n=n.concat("L "+(h+f)+" "+(c+v)+" ");n=n.concat("Z"),mt(i,{d:n});break;case"Image":s="Image",mt(i,{href:r,height:l,width:a,x:u,y:d});break;case"Star":{for(var y=5,b=Math.min(a,l)/2,S=b/2,C=Math.PI/y,x="",m=0;m<2*y;m++){var I=m%2===0?b:S,D=h+I*Math.cos(m*C-Math.PI/2),M=c+I*Math.sin(m*C-Math.PI/2);x+=(m===0?"M":"L")+D+","+M}x+="Z",mt(i,{d:x});break}}return{renderOption:i,functionName:s}}var Rr=(function(o){ER(t,o);function t(e,i,r,n,s,a,l){var h=o.call(this,e)||this;return h.opacity=s,h.fill=i,h.stroke=n,h["stroke-width"]=r,h["stroke-dasharray"]=a,h.d=l,h}return t})(TR);function AR(o,t,e,i,r){var n={},s=new Ih("");n={id:o.id,x:o.x,y:o.y,fill:e,"font-size":t.size||r.size,"font-style":t.fontStyle||r.fontStyle,"font-family":t.fontFamily||r.fontFamily,"font-weight":t.fontWeight||r.fontWeight,"text-anchor":o.anchor,transform:o.transform,opacity:t.opacity,"dominant-baseline":o.baseLine};var a=typeof o.text=="string"?o.text:o.text[0],l=s.createText(n,a);return i&&i.appendChild(l),l}var is=(function(){function o(t,e){this.x=t,this.y=e}return o})(),Xf=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),St=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},wq=(function(o){Xf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return St([w(null)],t.prototype,"size",void 0),St([w("")],t.prototype,"color",void 0),St([w("Segoe UI")],t.prototype,"fontFamily",void 0),St([w("Normal")],t.prototype,"fontWeight",void 0),St([w("Normal")],t.prototype,"fontStyle",void 0),St([w(1)],t.prototype,"opacity",void 0),St([w(null)],t.prototype,"headerTextSize",void 0),St([w(null)],t.prototype,"boldTextSize",void 0),t})(Oe),xq=(function(o){Xf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return St([w("")],t.prototype,"color",void 0),St([w(1)],t.prototype,"width",void 0),St([w("")],t.prototype,"dashArray",void 0),t})(Oe),Iq=(function(o){Xf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return St([w(0)],t.prototype,"x",void 0),St([w(0)],t.prototype,"y",void 0),St([w(0)],t.prototype,"width",void 0),St([w(0)],t.prototype,"height",void 0),t})(Oe),DR=(function(o){Xf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return St([w(0)],t.prototype,"x",void 0),St([w(0)],t.prototype,"y",void 0),t})(Oe),LR=(function(o){Xf(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()},t.prototype.initPrivateVariable=function(){this.renderer=new Ih(this.element.id),this.themeStyle=mq(this.theme),this.formattedText=[],this.padding=5,this.highlightPadding=3,this.areaMargin=10,this.isFirst=!0,this.markerPoint=[]},t.prototype.removeSVG=function(){var e=document.getElementById(this.element.id+"_svg"),i=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&cm(this.element.id+"parent_template_blazorTemplate"),e&&e.parentNode&&Qe(e),i&&i.parentNode&&Qe(i)},t.prototype.render=function(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst);var e={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",e);var i=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(i.isBottom,i.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});var r=document.getElementById("chartmeasuretext");r&&Qe(r),this.allowServerDataBinding=!0},t.prototype.createTooltipElement=function(){if(this.textElements=[],!this.template||this.shared){this.enableRTL&&this.element.setAttribute("dir","ltr");var e=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(e);var i=document.getElementById(this.element.id+"_group");i||(i=this.renderer.createGroup({id:this.element.id+"_group"}),i.setAttribute("transform","translate(0,0)")),e.appendChild(i);var r=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2"||this.theme==="Fluent2HighContrast")&&!this.border.width?1:this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:(this.theme==="TailwindDark"||this.theme==="Tailwind"||this.theme==="Tailwind3Dark"||this.theme==="Tailwind3"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"||this.theme.indexOf("Fluent2")>-1)&&this.opacity===.75?1:this.opacity,stroke:this.border.color||(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2"?"#D2D0CE":this.border.color)});i.appendChild(r)}},t.prototype.drawMarker=function(e,i,r){if(this.shapes.length<=0)return null;var n,s=0,a=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),l=rs(this.element.id+"_group");if(!l)return null;for(var h=(this.enableRTL?this.elementSize.width-r/2:this.marginX*2+r/2)+(i?this.arrowPadding:0),c=0,u=this.shapes;c<u.length;c++){var d=u[c];if(d!=="None"){if(n=new Rr(this.element.id+"_Trackball_"+s,this.palette[s],1,"#cccccc",1,null),this.markerPoint[s]){var p=0;this.header.indexOf("<br")>-1&&(p=this.header.split(/<br.*?>/g).length+s);var f=this.formattedText&&this.formattedText.length>=2?this.getTooltipTextContent(this.formattedText[1])+", "+this.getTooltipTextContent(this.formattedText[0]):"";a.appendChild(Sq(new is(h,this.markerPoint[s]-this.padding+(e?this.arrowPadding:p)),d,new Wt(r,r),"",n,"img",f))}s++}}l.appendChild(a)},t.prototype.renderTooltipElement=function(e,i){var r=rs(this.element.id),n=new is(0,0),s=new is(0,0),a=rs(this.element.id+"_svg"),l=rs(this.element.id+"_group"),h=rs(this.element.id+"_path"),c,u=!1,d=!1,p=!1,f=0,v=0;if(!g(l)){if(this.header!==""&&this.showHeaderLine&&(this.elementSize.height+=this.marginY),this.isFixed){var m=this.elementSize.width+2*this.marginX,y=this.elementSize.height+2*this.marginY;c=new Le(i.x,i.y,m,y)}else this.content.length>1?(c=this.sharedTooltipLocation(e,this.location.x,this.location.y),u=!0):(c=this.tooltipLocation(e,i,n,s),this.inverted?(d=c.x<i.x+this.clipBounds.x,f=d?0:this.arrowPadding,this.allowHighlight&&(c.x+=d?this.highlightPadding:-(2*this.highlightPadding))):(u=c.y<i.y+this.clipBounds.y,p=!u,v=u?0:this.arrowPadding));if(this.header!==""&&this.showHeaderLine){var b=2,S=0,C=this.isWrap?this.wrappedText:this.header;if(this.isWrap&&typeof C=="string"&&(C.indexOf("<")>-1||C.indexOf(">")>-1)){var x=C.split("<br>");b=x.length}this.header.indexOf("<br")>-1&&(S=5*(this.header.split(/<br.*?>/g).length-1));var I="properties",D=pe({},this.textStyle,null,!0)[I],M=Xe(this.isWrap?this.wrappedText:this.header,D,this.themeStyle.textStyle).height+this.marginY*b+(p?this.arrowPadding:0)+(this.isWrap?5:S),E=this.marginX*3+(!d&&!u&&!p?this.arrowPadding:0),A="M "+E+" "+M+"L "+(c.width+(!d&&!u&&!p?this.arrowPadding:0)-this.marginX*2)+" "+M,L=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:this.theme==="Material3"||this.theme==="Material3Dark"?.2:.8,stroke:this.themeStyle.tooltipHeaderLine,d:A});l.appendChild(L)}var N=this.border.width/2,R=new Le(N+f,N+v,c.width-N,c.height-N);if(l.setAttribute("opacity","1"),this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(r,c):this.updateDiv(r,c.x,c.y),a.setAttribute("height",(c.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),a.setAttribute("width",(c.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),a.setAttribute("opacity","1"),g(this.tooltipPlacement)||(u=this.tooltipPlacement.indexOf("Top")>-1,p=this.tooltipPlacement.indexOf("Bottom")>-1,d=this.tooltipPlacement.indexOf("Left")>-1),h.setAttribute("d",yq(this.rx,this.ry,R,n,this.arrowPadding,u,p,d,s.x,s.y,this.controlName)),this.enableShadow&&this.theme!=="Bootstrap4"||this.theme.indexOf("Fluent2")>-1){var P=this.element.id+"_shadow";this.theme==="Tailwind"||this.theme==="TailwindDark"||this.theme==="Tailwind3"||this.theme==="Tailwind3Dark"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"?h.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):h.setAttribute("filter",j.isIE?"":"url(#"+P+")");var k='<filter id="'+P+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';this.theme.indexOf("Fluent2")>-1?k+='<feOffset dx="-1" dy="3.6" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.2"/>':k+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',k+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var B=this.renderer.createDefs();B.setAttribute("id",this.element.id+"SVG_tooltip_definition"),l.appendChild(B),B.innerHTML=k}var F=(this.theme==="Fabric"||this.theme==="Fluent"||this.theme==="Fluent2")&&!this.border.color?"#D2D0CE":this.theme==="Fluent2HighContrast"?"#FFFFFF":this.border.color;h.setAttribute("stroke",F),g(this.border.dashArray)||h.setAttribute("stroke-dasharray",this.border.dashArray),this.changeText(new is(f,v),p,!d&&!u&&!p),this.revert&&(this.inverted=!this.inverted,this.revert=!1)}return new bq(p,!d&&!u&&!p)},t.prototype.changeText=function(e,i,r){var n=document.getElementById(this.element.id+"_text");i&&n.setAttribute("transform","translate(0,"+this.arrowPadding+")"),r&&n.setAttribute("transform","translate("+this.arrowPadding+" 0)")},t.prototype.findFormattedText=function(){this.formattedText=[],this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)},t.prototype.renderText=function(e){var i=0,r=0,n=0,s,a="properties",l=pe({},this.textStyle,null,!0)[a],h=rs(this.element.id+"_group"),c,u,d="",p,f;this.findFormattedText(),this.isWrap=!1;var v=document.body.getAttribute("dir")==="rtl",m=v&&!this.enableRTL?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var y=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),b=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,S=Xe(this.formattedText[0],l,this.themeStyle.textStyle).width+2*this.marginX+this.arrowPadding,C=this.location.x-S<this.location.x,x=this.areaBounds.x+this.areaBounds.width<this.location.x+S,I,D=y!==""&&this.showHeaderLine?this.marginY:0,M=!0,E=!0;this.markerPoint=[];var A=this.shapes.length>0?10:0,L=this.shapes.length>0?5:0,N=4,R,P="12px",k="400",B=this.themeStyle.tooltipLightLabel,F=22/parseFloat(P)*parseFloat(l.size||this.themeStyle.textStyle.size),O=[],z=0;(!e||this.isCanvas)&&(Qf(this.element.id+"_text"),Qf(this.element.id+"_header_path"),Qf(this.element.id+"_trackball_group"),Qf(this.element.id+"SVG_tooltip_definition")),this.controlName==="Chart"&&parseFloat(P)<parseFloat(l.size||this.themeStyle.textStyle.headerTextSize)&&(z=parseFloat(l.size||this.themeStyle.textStyle.size)-parseFloat(P));for(var Y=new bn(this.element.id+"_text",this.marginX*2,z+this.marginY*2+this.padding*2+(this.marginY===2?this.controlName==="RangeNavigator"?5:3:0),m,""),K=AR(Y,l,l.color||this.themeStyle.tooltipBoldLabel,h,this.themeStyle.textStyle),U=this.formattedText.length===1&&this.formattedText[0].indexOf(" : <b>")>-1,q=this.header!=="",ae=q&&b?16:13,te=0,he=this.formattedText.length;te<he;te++)if(u=this.formattedText[te].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),this.isTextWrap&&this.header!==this.formattedText[te]&&this.formattedText[te].indexOf("<br")===-1&&(R=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/ae:this.rightSpace/ae),u=this.formattedText[te].match(new RegExp(".{1,"+R+"}","g"))),te===0&&!U&&this.isTextWrap&&(this.leftSpace<S||C)&&(this.rightSpace<S||x)&&(R=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/ae:this.rightSpace/ae),I=y!==""?y:this.formattedText[te],u=I.match(new RegExp(".{1,"+R+"}","g")),this.wrappedText=b?"<b>"+u.join("<br>")+"</b>":u.join("<br>"),this.isWrap=u.length>1),u[0]!==""){(te!==0||y==="")&&this.markerPoint.push((y!==""&&this.showHeaderLine?this.marginY:0)+Y.y+i-(z!==0?z/this.markerSize*(parseFloat(l.size||this.themeStyle.textStyle.headerTextSize)/this.markerSize):0));for(var ue=0,ne=u.length;ue<ne;ue++){s=u[ue].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,this.enableRTL?"<br>\u200E: <br>":"<br>\u200E:<br>").split("<br>"),this.enableRTL&&s.length>0&&u[ue].match(/:/g)&&(s[0]=s[0].trim(),s.reverse()),n=0,E=!0,i+=F;for(var le=0,$=s.length;le<$;le++)if(p=s[le],this.enableRTL&&p!==""&&this.isRTLText(p)&&(p=p.concat("\u200E")),!/\S/.test(p)&&p!==""&&(p=" "),!E&&p===" "||p.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""){n+=p!==" "?N:0,E&&!M?(this.header.indexOf("<br")>-1&&te!==0&&(D+=this.header.split(/<br.*?>/g).length),f={x:this.marginX*2+(A+L),dy:F+(E?D:0),fill:""},D=null):M&&E?f={x:y===""?this.marginX*2+(A+L):this.marginX*2+(this.isWrap?A+L:0)}:f={},E=!1,c=this.renderer.createTSpan(f,""),K.appendChild(c),p.indexOf("<b>")>-1||b&&le===0&&te===0&&(q||this.isWrap)?(k="600",B=this.themeStyle.tooltipBoldLabel,d="font-weight:"+k,l.fontWeight=k,c.setAttribute("fill",this.textStyle.color||B)):(d=k==="600"?"font-weight:"+k:"",l.fontWeight=k,c.setAttribute("fill",this.textStyle.color||B)),(p.indexOf("</b>")>-1||b&&le===$-1&&te===0&&(q||this.isWrap))&&(k="Normal",B=this.themeStyle.tooltipLightLabel),d!==""&&(c.style.fontWeight=d.split("font-weight:")[1],c.style.color=c.getAttribute("fill")),c.style.fontFamily="inherit",c.style.fontStyle="inherit",c.style.fontSize=this.header===this.formattedText[te]?l.size||this.themeStyle.textStyle.headerTextSize:p.indexOf("<b>")>-1||p.indexOf("</b>")>-1?l.size||this.themeStyle.textStyle.boldTextSize:l.size||this.themeStyle.textStyle.size,c.style.fontWeight=this.header===this.formattedText[te]&&(this.header.indexOf("<b>")===-1||this.header.indexOf("</b>")===-1)?this.textStyle.fontWeight||(this.theme.indexOf("Tailwind3")>-1?"500":"600"):p.indexOf("<b>")>-1||p.indexOf("</b>")>-1?this.theme.indexOf("Bootstrap5")>-1?this.textStyle.fontWeight||"600":"bold":(p.indexOf("<b>")===-1||p.indexOf("</b>")===-1)&&(this.theme.indexOf("Bootstrap5")>-1||this.theme.indexOf("Tailwind3")>-1)?this.textStyle.fontWeight||(this.theme.indexOf("Tailwind3")>-1?"500":"600"):this.textStyle.fontWeight||l.fontWeight;var ee=pe({},this.textStyle,null,!0)[a];ee.fontWeight=c.style.fontWeight,ee.size=c.style.fontSize,M=!1,c.textContent=p=this.getTooltipTextContent(p),n+=Xe(p,ee,this.themeStyle.textStyle).width}n-=N,r=Math.max(r,n),O.push(n)}}this.elementSize=new Wt(r+(r>0?2*this.marginX:0),i),this.elementSize.width+=A+L;var He=K.childNodes[0];if(y!==""&&He&&!this.isWrap){l.fontWeight="600";var qe=(this.elementSize.width+2*this.padding)/2-Xe(y,l,this.themeStyle.textStyle,!0).width/2;He.setAttribute("x",qe.toString())}this.renderContentRTL(K,q,A+L,O)},t.prototype.renderContentRTL=function(e,i,r,n){if(this.enableRTL)for(var s=void 0,a=i?1:0,l=0;l<e.childNodes.length;l++)s=e.childNodes[l],(!i||l>0)&&!g(s.getAttribute("x"))&&(s.setAttribute("x",(this.elementSize.width-(r+n[a])).toString()),a++)},t.prototype.getTooltipTextContent=function(e){var i=e.match(/<[a-zA-Z\/](.|\n)*?>/g);if(g(i))return e;for(var r=this.isRTLText(e),n=0;n<i.length;n++)this.isValidHTMLElement(i[n].replace("<","").replace("/","").replace(">","").trim())&&(e=e.replace(i[n],r?"\u200E":""));return e},t.prototype.isValidHTMLElement=function(e){return document.createElement(e).toString()!=="[object HTMLUnknownElement]"},t.prototype.isRTLText=function(e){return/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(e)},t.prototype.createTemplate=function(e,i){var r={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",r);var n=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();var s=g(n)?null:n.firstElementChild;if(s&&Qe(s),r.cancel)Qe(rs(this.element.id+"_tooltip"));else{var a=et("div",{id:this.element.id+"parent_template"}),l=void 0;if(this.controlName==="Chart"&&this.shared)for(var h=0;h<this.data.length;h++){var c=this.templateFn(this.data[h],this.controlInstance,a.id,a.id+"_blazorTemplate","");h===0?l=c:c.length>1?l[h].outerHTML=c[h].outerHTML||c[h].textContent:l[l.length-1].outerHTML+=c[0].outerHTML}else l=this.templateFn(this.data,this.controlInstance,a.id,a.id+"_blazorTemplate","");for(;l&&l.length>0;)$e()||l.length===1?(a.appendChild(l[0]),l=null):a.appendChild(l[0]);g(n)||n.appendChild(a);var u=this.isCanvas?a:this.element,d=u.getBoundingClientRect();this.padding=0,this.elementSize=new Wt(d.width,d.height);var p=this.shared?this.sharedTooltipLocation(e,this.location.x,this.location.y):this.tooltipLocation(e,i,new is(0,0),new is(0,0));if(this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(this.element,p):this.updateDiv(u,p.x,p.y),this.blazorTemplate){var f=function(){var m=rs(v.element.id).getBoundingClientRect();v.elementSize=new Wt(m.width,m.height);var y=v.tooltipLocation(e,i,new is(0,0),new is(0,0));v.updateDiv(rs(v.element.id),y.x,y.y)},v=this;f.bind(v,e,i),Rw(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,f)}}},t.prototype.sharedTooltipLocation=function(e,i,r){var n=this.elementSize.width+2*this.marginX,s=this.elementSize.height+2*this.marginY,a=new Le(i+2*this.padding,r-s-this.padding,n,s);return a.y<e.y&&(a.y+=a.height+2*this.padding),a.y+a.height>e.y+e.height&&(a.y=Math.max(e.y+e.height-(a.height+2*this.padding),e.y)),a.x+a.width>e.x+e.width&&(a.x=e.x+this.location.x-(a.width+4*this.padding)),a.x<e.x&&(a.x=e.x),a},t.prototype.getCurrentPosition=function(e,i,r,n){var s=this.tooltipPlacement,a=this.clipBounds.x,l=this.clipBounds.y,h=this.offset,c=this.elementSize.width+2*this.marginX,u=this.elementSize.height+2*this.marginY,d=new is(i.x,i.y);return s==="Top"||s==="Bottom"?(d=new is(d.x+a-this.elementSize.width/2-this.padding,d.y+l-this.elementSize.height-2*this.padding-this.arrowPadding-h),r.x=n.x=c/2,s==="Bottom"&&(d.y=i.y+l+h),e.x+e.width<d.x+c?(d.x=e.width>c?e.x+e.width-c+6:e.x,r.x=n.x=e.width>c?e.x+i.x-d.x:i.x):e.x>d.x&&(d.x=e.x,r.x=n.x=i.x)):(d=new is(d.x+a+h,d.y+l-this.elementSize.height/2-this.padding),r.y=n.y=u/2,s==="Left"&&(d.x=i.x+a-h-(c+this.arrowPadding)),e.y+e.height<d.y+u?(d.y=e.height>u?e.y+e.height-u+6:e.y,r.y=n.y=e.height>u?e.y+i.y-d.y:i.y):e.y>d.y&&(d.y=e.y,r.y=n.y=i.y)),new Le(d.x,d.y,c,u)},t.prototype.tooltipLocation=function(e,i,r,n){if(!g(this.tooltipPlacement)){var s=this.getCurrentPosition(e,i,r,n);return s}var a=new is(i.x,i.y),l=this.elementSize.width+2*this.marginX,h=this.elementSize.height+2*this.marginY,c=this.offset,u=this.clipBounds.x,d=this.clipBounds.y,p=e.x,f=e.y;return this.outOfBounds=!1,this.inverted?(a=new is(a.x+u+c,a.y+d-this.elementSize.height/2-this.padding),r.y=n.y=h/2,(a.x+l+this.arrowPadding>p+e.width||this.isNegative)&&(a.x=(i.x>e.width+e.x?e.width:i.x)+u-c-(l+this.arrowPadding)),a.x<p&&(a.x=(i.x<0?0:i.x)+u+c),a.x+l+this.arrowPadding>p+e.width&&(a.x=(i.x>e.width+e.x?e.width:i.x)+u-c-(l+this.arrowPadding)),a.y<=f&&(r.y-=f-a.y,n.y-=f-a.y,a.y=f),a.y+h>=f+e.height&&(r.y+=a.y+h-(f+e.height),n.y+=a.y+h-(f+e.height),a.y-=a.y+h-(f+e.height)),a.x+l>=p+e.width&&this.controlName==="Chart"&&(r.x+=a.x+l-(p+e.width),n.x+=a.x+l-(p+e.width),a.x-=a.x+l-(p+e.width),a.x=a.x-this.arrowPadding-this.padding),r.y+this.arrowPadding>h-this.ry&&(r.y=h-this.ry-this.arrowPadding,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=n.y=this.ry+this.arrowPadding),this.controlName==="Chart"&&((a.y+r.y<this.areaMargin+this.arrowPadding||e.y+e.height-(a.y+r.y)<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!MR(a.x,a.y,e)||this.outOfBounds)&&(this.inverted=!this.inverted,a=new is(i.x+u-this.padding-this.elementSize.width/2,i.y+d-this.elementSize.height-2*this.padding-c-this.arrowPadding),this.revert=!0,n.x=r.x=l/2,n.y=r.y=0,(a.y<f||this.isNegative)&&(a.y=(i.y<0?0:i.y)+c+d),a.y+this.arrowPadding+h>f+e.height&&(a.y=Math.min(i.y,f+e.height)+d-this.elementSize.height-2*this.padding-c-this.arrowPadding),n.x=l/2,a.x<p&&(n.x-=p-a.x,r.x-=p-a.x,a.x=p),a.x+l>e.width+p&&(r.x+=a.x+l-(e.width+p),n.x+=a.x+l-(e.width+p),a.x-=a.x+l-(e.width+p)),this.arrowPadding+r.x>l-this.rx&&(n.x=l-this.rx-this.arrowPadding,r.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding)))):(a=new is(a.x+u-this.elementSize.width/2-this.padding,a.y+d-this.elementSize.height-2*(this.allowHighlight?this.highlightPadding:this.padding)-this.arrowPadding-c),r.x=n.x=l/2,(a.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(a.y=(i.y<0?0:i.y)+d+c),a.y+h+this.arrowPadding>f+e.height&&(a.y=Math.min(i.y,f+e.height)+d-this.elementSize.height-2*this.padding-this.arrowPadding-c),(a.x+l>p+e.width&&a.y<f||this.isNegative)&&this.controlName!=="Progressbar"&&(a.y=(i.y<0?0:i.y)+d+c),n.x=l/2,a.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-a.x,n.x-=p-a.x,a.x=p),a.x+l>p+e.width&&this.controlName!=="Progressbar"&&(r.x+=a.x+l-(p+e.width),n.x+=a.x+l-(p+e.width),a.x-=a.x+l-(p+e.width)),a.x<p&&this.controlName!=="Progressbar"&&(r.x-=p-a.x,n.x-=p-a.x,a.x=p),r.x+this.arrowPadding>l-this.rx&&(r.x=l-this.rx-this.arrowPadding,n.x=l-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding),this.controlName==="Chart"&&((e.x+e.width-(a.x+r.x)<this.areaMargin+this.arrowPadding||a.x+r.x<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),this.template&&a.y<0&&(a.y=i.y+d+c),(!MR(a.x,a.y,e)||this.outOfBounds)&&(this.inverted=!this.inverted,this.revert=!0,a=new is(i.x+c+u,i.y+d-this.elementSize.height/2-this.padding),n.x=r.x=0,n.y=r.y=h/2,(a.x+this.arrowPadding+l>p+e.width||this.isNegative)&&(a.x=(i.x>p+e.width?e.width:i.x)+u-c-(this.arrowPadding+l)),a.x<p&&(a.x=(i.x<0?0:i.x)+c+u),a.y<=f&&(n.y-=f-a.y,r.y-=f-a.y,a.y=f),a.y+h>=e.height+f&&(r.y+=a.y+h-(e.height+f),n.y+=a.y+h-(e.height+f),a.y-=a.y+h-(e.height+f)),this.arrowPadding+r.y>h-this.ry&&(r.y=h-this.arrowPadding-this.ry,n.y=h),r.y-this.arrowPadding<this.ry&&(r.y=this.arrowPadding+this.ry,n.y=0)))),new Le(a.x,a.y,l,h)},t.prototype.animateTooltipDiv=function(e,i){var r=this,n=parseFloat(e.style.left),s=parseFloat(e.style.top),a=this.duration===0&&Yt==="Enable"?300:this.duration;if(this.controlName==="Chart"&&this.shared&&!this.enableRTL){var l=this.element.style.transform.split(/[(),\s]+/);n=parseFloat(l[1]),s=parseFloat(l[2]),e.style.transition="transform "+a+"ms ease"}var h;new Mt({}).animate(e,{duration:a,progress:function(c){h=c.timeStamp/c.duration,e.style.animation=null,r.controlName==="Chart"&&r.shared&&!r.enableRTL?(e.style.transform="translate("+(n+(i.x-n))+"px,"+(s+i.y-s)+"px)",e.style.left="",e.style.top=""):r.controlName==="Chart"&&r.showNearestTooltip?(e.style.transition="left "+c.duration+"ms ease-out, top "+c.duration+"ms ease-out",e.style.left=i.x+"px",e.style.top=i.y+"px"):(e.style.left=n+h*(i.x-n)+"px",e.style.top=s+h*(i.y-s)+"px",e.style.transform=r.controlName==="RangeNavigator"?e.style.transform:"")},end:function(c){r.updateDiv(e,i.x,i.y),r.trigger("animationComplete",{tooltip:r})}})},t.prototype.updateDiv=function(e,i,r){this.controlName==="Chart"&&this.shared&&!this.crosshair&&!this.enableRTL?(e.style.transform="translate("+i+"px,"+r+"px)",e.style.left="",e.style.top=""):(e.style.left=i+"px",e.style.top=r+"px",e.style.transform=this.controlName==="RangeNavigator"?e.style.transform:"")},t.prototype.updateTemplateFn=function(){if(this.template)try{typeof this.template!="function"&&document.querySelectorAll(this.template).length?this.templateFn=Et(document.querySelector(this.template).innerHTML.trim()):this.templateFn=Et(this.template)}catch{this.templateFn=Et(this.template)}},t.prototype.fadeOut=function(){var e=this,i=this.isCanvas&&!this.template?rs(this.element.id+"_svg"):rs(this.element.id),r=rs(this.element.id);if(i){var n=i.firstChild;if(n.nodeType!==Node.ELEMENT_NODE&&(n=i.firstElementChild),this.isCanvas&&!this.template&&(n=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):n),!n)return null;var s=parseFloat(n.getAttribute("opacity"));s=g(s)?1:s,new Mt({}).animate(n,{duration:200,progress:function(a){e.progressAnimation(n,s,a.timeStamp/a.duration)},end:function(){e.fadeOuted=!0,e.endAnimation(n),r.style.transition=""}})}},t.prototype.progressAnimation=function(e,i,r){e.style.animation="",e.setAttribute("opacity",(i-r).toString())},t.prototype.endAnimation=function(e){e.setAttribute("opacity","0"),this.template&&(e.style.display="none"),this.trigger("animationComplete",{tooltip:this})},t.prototype.getPersistData=function(){var e=[];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.element.classList.remove("e-tooltip")},t.prototype.onPropertyChanged=function(e,i){this.blazorTemplate&&cm(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()},St([w(!1)],t.prototype,"enable",void 0),St([w(!1)],t.prototype,"shared",void 0),St([w(!1)],t.prototype,"crosshair",void 0),St([w(!1)],t.prototype,"enableShadow",void 0),St([w(null)],t.prototype,"fill",void 0),St([w("")],t.prototype,"header",void 0),St([w(.75)],t.prototype,"opacity",void 0),St([Ce({size:"12px",fontWeight:null,color:null,fontStyle:"Normal",fontFamily:null},wq)],t.prototype,"textStyle",void 0),St([w(null)],t.prototype,"template",void 0),St([w(!0)],t.prototype,"enableAnimation",void 0),St([w(300)],t.prototype,"duration",void 0),St([w(!1)],t.prototype,"inverted",void 0),St([w(!1)],t.prototype,"isNegative",void 0),St([Ce({color:null,width:null},xq)],t.prototype,"border",void 0),St([w([])],t.prototype,"content",void 0),St([w(10)],t.prototype,"markerSize",void 0),St([Ce({x:0,y:0},DR)],t.prototype,"clipBounds",void 0),St([w([])],t.prototype,"palette",void 0),St([w([])],t.prototype,"shapes",void 0),St([Ce({x:0,y:0},DR)],t.prototype,"location",void 0),St([w(0)],t.prototype,"offset",void 0),St([w(4)],t.prototype,"rx",void 0),St([w(4)],t.prototype,"ry",void 0),St([w(5)],t.prototype,"marginX",void 0),St([w(5)],t.prototype,"marginY",void 0),St([w(7)],t.prototype,"arrowPadding",void 0),St([w(null)],t.prototype,"data",void 0),St([w("Material")],t.prototype,"theme",void 0),St([Ce({x:0,y:0,width:0,height:0},Iq)],t.prototype,"areaBounds",void 0),St([w(null)],t.prototype,"availableSize",void 0),St([w()],t.prototype,"blazorTemplate",void 0),St([w(!1)],t.prototype,"isCanvas",void 0),St([w(!1)],t.prototype,"isTextWrap",void 0),St([w(!1)],t.prototype,"isFixed",void 0),St([w(null)],t.prototype,"tooltipPlacement",void 0),St([w(null)],t.prototype,"controlInstance",void 0),St([w("")],t.prototype,"controlName",void 0),St([w(!1)],t.prototype,"showNearestTooltip",void 0),St([G()],t.prototype,"tooltipRender",void 0),St([G()],t.prototype,"loaded",void 0),St([G()],t.prototype,"animationComplete",void 0),St([w(!1)],t.prototype,"enableRTL",void 0),St([w(!1)],t.prototype,"allowHighlight",void 0),St([w(!0)],t.prototype,"showHeaderLine",void 0),t=St([It],t),t})(ti);var an=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Ue=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ld=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("Line")],t.prototype,"type",void 0),Ue([w(null)],t.prototype,"color",void 0),Ue([w(1)],t.prototype,"width",void 0),Ue([w(null)],t.prototype,"length",void 0),Ue([w("")],t.prototype,"dashArray",void 0),t})(Oe),KR=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(0)],t.prototype,"x",void 0),Ue([w(0)],t.prototype,"y",void 0),t})(Oe),Bo=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(null)],t.prototype,"accessibilityDescription",void 0),Ue([w(null)],t.prototype,"accessibilityRole",void 0),Ue([w(!0)],t.prototype,"focusable",void 0),Ue([w(0)],t.prototype,"tabIndex",void 0),t})(Oe),Mq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(null)],t.prototype,"accessibilityDescriptionFormat",void 0),t})(Bo),ea=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("Normal")],t.prototype,"fontStyle",void 0),Ue([w("16px")],t.prototype,"size",void 0),Ue([w("Normal")],t.prototype,"fontWeight",void 0),Ue([w("")],t.prototype,"color",void 0),Ue([w("Center")],t.prototype,"textAlignment",void 0),Ue([w("Segoe UI")],t.prototype,"fontFamily",void 0),Ue([w(1)],t.prototype,"opacity",void 0),Ue([w("Wrap")],t.prototype,"textOverflow",void 0),t})(Oe),Dq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("Normal")],t.prototype,"fontStyle",void 0),Ue([w("16px")],t.prototype,"size",void 0),Ue([w("Normal")],t.prototype,"fontWeight",void 0),Ue([w("")],t.prototype,"color",void 0),Ue([w("Center")],t.prototype,"textAlignment",void 0),Ue([w("Segoe UI")],t.prototype,"fontFamily",void 0),Ue([w(1)],t.prototype,"opacity",void 0),t})(Oe),Eq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(null)],t.prototype,"text",void 0),Ue([Ce({fontFamily:null,size:"16px",fontStyle:"Normal",fontWeight:"600",color:null},ea)],t.prototype,"textStyle",void 0),Ue([w(null)],t.prototype,"hoverTextFormat",void 0),t})(Oe),qn=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("")],t.prototype,"color",void 0),Ue([w(1)],t.prototype,"width",void 0),Ue([w("")],t.prototype,"dashArray",void 0),t})(Oe),Tq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(0)],t.prototype,"x",void 0),Ue([w(0)],t.prototype,"y",void 0),t})(Oe),vd=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(j.isDevice?5:10)],t.prototype,"left",void 0),Ue([w(j.isDevice?5:10)],t.prototype,"right",void 0),Ue([w(j.isDevice?5:10)],t.prototype,"top",void 0),Ue([w(j.isDevice?5:10)],t.prototype,"bottom",void 0),t})(Oe),tM=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(!0)],t.prototype,"enable",void 0),Ue([w(1e3)],t.prototype,"duration",void 0),Ue([w(0)],t.prototype,"delay",void 0),t})(Oe),$R=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(!1)],t.prototype,"enable",void 0),Ue([w(!0)],t.prototype,"enableMarker",void 0),Ue([w(!1)],t.prototype,"shared",void 0),Ue([w(null)],t.prototype,"fill",void 0),Ue([w(null)],t.prototype,"header",void 0),Ue([w(null)],t.prototype,"opacity",void 0),Ue([Ce({fontFamily:null,size:null,fontStyle:"Normal",fontWeight:null,color:null},ea)],t.prototype,"textStyle",void 0),Ue([w(null)],t.prototype,"format",void 0),Ue([w(null)],t.prototype,"template",void 0),Ue([w(!0)],t.prototype,"enableAnimation",void 0),Ue([w(300)],t.prototype,"duration",void 0),Ue([w(1e3)],t.prototype,"fadeOutDuration",void 0),Ue([w("Move")],t.prototype,"fadeOutMode",void 0),Ue([w(!1)],t.prototype,"enableTextWrap",void 0),Ue([w(!0)],t.prototype,"showNearestPoint",void 0),Ue([Ce({color:null,width:null},qn)],t.prototype,"border",void 0),Ue([Ce({x:null,y:null},KR)],t.prototype,"location",void 0),Ue([w(!1)],t.prototype,"enableHighlight",void 0),Ue([w(!1)],t.prototype,"showNearestTooltip",void 0),Ue([w(!0)],t.prototype,"showHeaderLine",void 0),t})(Oe),ZR=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(null)],t.prototype,"fill",void 0),Ue([Ce({color:"",width:0},qn)],t.prototype,"border",void 0),Ue([w("Gap")],t.prototype,"mode",void 0),t})(Oe),JR=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(0)],t.prototype,"series",void 0),Ue([w(0)],t.prototype,"point",void 0),t})(Oe),Aq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(0)],t.prototype,"topLeft",void 0),Ue([w(0)],t.prototype,"topRight",void 0),Ue([w(0)],t.prototype,"bottomLeft",void 0),Ue([w(0)],t.prototype,"bottomRight",void 0),t})(Oe),Lq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(0)],t.prototype,"left",void 0),Ue([w(0)],t.prototype,"right",void 0),Ue([w(0)],t.prototype,"top",void 0),Ue([w(0)],t.prototype,"bottom",void 0),t})(Oe),Nq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("transparent")],t.prototype,"color",void 0),Ue([w(0)],t.prototype,"width",void 0),Ue([w(.8)],t.prototype,"cornerRadius",void 0),t})(Oe),NR=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("Normal")],t.prototype,"fontStyle",void 0),Ue([w("15px")],t.prototype,"size",void 0),Ue([w("500")],t.prototype,"fontWeight",void 0),Ue([w("")],t.prototype,"color",void 0),Ue([w("Center")],t.prototype,"textAlignment",void 0),Ue([w("Segoe UI")],t.prototype,"fontFamily",void 0),Ue([w(1)],t.prototype,"opacity",void 0),Ue([w("Wrap")],t.prototype,"textOverflow",void 0),Ue([w("Top")],t.prototype,"position",void 0),Ue([w(0)],t.prototype,"x",void 0),Ue([w(0)],t.prototype,"y",void 0),Ue([w("transparent")],t.prototype,"background",void 0),Ue([Ce({},Nq)],t.prototype,"border",void 0),Ue([Ce({},Bo)],t.prototype,"accessibility",void 0),t})(Oe),kR=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w("Top")],t.prototype,"position",void 0),Ue([w(0)],t.prototype,"x",void 0),Ue([w(0)],t.prototype,"y",void 0),t})(ea),kq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([Ce({},qn)],t.prototype,"border",void 0),Ue([w("transparent")],t.prototype,"background",void 0),Ue([w(1)],t.prototype,"opacity",void 0),Ue([w(null)],t.prototype,"backgroundImage",void 0),Ue([w(null)],t.prototype,"width",void 0),Ue([Ce({left:0,right:0,top:0,bottom:0},vd)],t.prototype,"margin",void 0),t})(Oe),Fq=(function(o){an(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ue([w(!1)],t.prototype,"enable",void 0),Ue([w(null)],t.prototype,"minY",void 0),Ue([w(null)],t.prototype,"maxY",void 0),Ue([w(null)],t.prototype,"fill",void 0),t})(Oe);var Tc=(function(){function o(t,e){this.series=t,this.point=e}return o})(),Ia=(function(){function o(t,e){t<e?(this.mStart=t,this.mEnd=e):(this.mStart=e,this.mEnd=t)}return Object.defineProperty(o.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),o})(),eO=(function(){function o(t){this.isColumn=0,this.isStacking=!1,this.chart=t}return o.prototype.calculateNumericNiceInterval=function(t,e,i){var r=yO(i,t),n=e/r;if(!g(t.desiredIntervals)&&this.isAutoIntervalOnBothAxis(t))return n;for(var s=Math.pow(10,Math.floor(Tl(n,10))),a=0,l=t.intervalDivs;a<l.length;a++){var h=l[a],c=s*h;if(r<e/c)break;n=c}return n},o.prototype.isAutoIntervalOnBothAxis=function(t){return!((t.zoomFactor<1||t.zoomPosition>0)&&t.enableAutoIntervalOnZooming)},o.prototype.getActualRange=function(t,e){this.initializeDoubleRange(t),!t.startFromZero&&this.isColumn>0?(t.actualRange.interval=t.interval||this.calculateNumericNiceInterval(t,t.doubleRange.delta,e),t.actualRange.max=t.doubleRange.end+t.actualRange.interval,t.doubleRange.start-t.actualRange.interval<0&&t.doubleRange.start>0?t.actualRange.min=0:t.actualRange.min=t.doubleRange.start-(this.isStacking?0:t.actualRange.interval)):(t.actualRange.interval=t.interval||this.calculateNumericNiceInterval(t,t.doubleRange.delta,e),t.actualRange.min=t.doubleRange.start,t.actualRange.max=t.doubleRange.end)},o.prototype.initializeDoubleRange=function(t){t.minimum!==null?this.min=t.minimum:(this.min===null||this.min===Number.POSITIVE_INFINITY)&&(this.min=0),t.maximum!==null?this.max=t.maximum:(this.max===null||this.max===Number.NEGATIVE_INFINITY)&&(this.max=5),this.min===this.max&&(this.max=t.valueType.indexOf("Category")>-1?this.max:this.min+1),t.doubleRange=new Ia(this.min,this.max),t.actualRange={}},o.prototype.calculateRangeAndInterval=function(t,e){this.calculateRange(e),this.getActualRange(e,t),this.applyRangePadding(e,t),this.calculateVisibleLabels(e,this.chart)},o.prototype.calculateRange=function(t){if(this.min=null,this.max=null,!Ps(t))for(var e=0,i=t.series;e<i.length;e++){var r=i[e];r.visible&&(this.paddingInterval=0,g(r.points)||(t.maxPointLength=r.points.length),t.maxPointLength=r.points.length,((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&t.orientation==="Horizontal"||r.type.indexOf("Bar")>-1&&t.orientation==="Vertical")&&(r.xAxis.valueType==="Double"||r.xAxis.valueType==="DateTime")&&r.xAxis.rangePadding==="Auto"&&(this.paddingInterval=mO(r.xAxis,t.series)*.5),t.orientation==="Horizontal"&&(this.chart.requireInvertedAxis?this.yAxisRange(t,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),t.orientation==="Vertical"&&(this.isColumn+=r.type.indexOf("Column")!==-1||r.type.indexOf("Bar")!==-1||r.drawType==="Column"?1:0,this.isStacking=r.type.indexOf("Stacking")!==-1,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(t,r)))}},o.prototype.yAxisRange=function(t,e){if(e.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=t.visibleRange.max&&(e.yMax=this.chart.dragY+t.visibleRange.interval),this.chart.dragY<=t.visibleRange.min&&(e.yMin=this.chart.dragY-t.visibleRange.interval)),e.type==="Waterfall"){for(var i=0,r=0,n=0;n<e.yData.length;n++)!(e.intermediateSumIndexes&&e.intermediateSumIndexes.indexOf(n)!==-1)&&!(e.sumIndexes&&e.sumIndexes.indexOf(n)!==-1)&&(r+=e.yData[n]),r>i&&(i=r);this.findMinMax(e.yMin,i)}else this.findMinMax(e.yMin,e.yMax)},o.prototype.findMinMax=function(t,e){(this.min===null||this.min>t)&&(this.min=t),(this.max===null||this.max<e)&&(this.max=e),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},o.prototype.applyRangePadding=function(t,e){var i=t.actualRange.min,r=t.actualRange.max;if(!Ps(t)){var n=t.actualRange.interval,s=t.getRangePadding(this.chart);s==="Additional"||s==="Round"?this.findAdditional(t,i,r,n,e):s==="Normal"?this.findNormal(t,i,r,n,e):this.updateActualRange(t,i,r,n)}t.actualRange.delta=t.actualRange.max-t.actualRange.min,this.calculateVisibleRange(e,t)},o.prototype.updateActualRange=function(t,e,i,r){t.actualRange={min:t.minimum!=null?t.minimum:e,max:t.maximum!=null?t.maximum:i,interval:t.interval!=null?t.interval:r,delta:t.actualRange.delta}},o.prototype.findAdditional=function(t,e,i,r,n){var s,a;if(s=Math.floor(e/r)*r,a=Math.ceil(i/r)*r,t.rangePadding==="Additional"&&(s-=r,a+=r),!g(t.desiredIntervals)){var l=a-s;r=this.calculateNumericNiceInterval(t,l,n)}this.updateActualRange(t,s,a,r)},o.prototype.findNormal=function(t,e,i,r,n){var s,a,l,h=e;e<0?(h=0,a=e+e*.05,s=r+a%r,.365*r>=s&&(a-=r),a%r<0&&(a=a-r-a%r)):(a=e<5/6*i?0:e-(i-e)*.5,a%r>0&&(a-=a%r)),l=i>0?i+(i-h)*.05:i-(i-h)*.05,s=r-l%r,.365*r>=s&&(l+=r),l%r>0&&(l=l+r-l%r),t.doubleRange=new Ia(a,l),(a===0||a<0&&l<0)&&(r=this.calculateNumericNiceInterval(t,t.doubleRange.delta,n),l=Math.ceil(l/r)*r),this.updateActualRange(t,a,l,r)},o.prototype.calculateVisibleRange=function(t,e){if(e.visibleRange={max:e.actualRange.max,min:e.actualRange.min,delta:e.actualRange.delta,interval:e.actualRange.interval},this.chart.chartAreaType==="Cartesian"){var i=g(e.zoomingScrollBar)?!1:e.zoomingScrollBar.isLazyLoad;(e.zoomFactor<1||e.zoomPosition>0)&&!i&&(e.calculateVisibleRangeOnZooming(),e.visibleRange.interval=e.enableAutoIntervalOnZooming?this.calculateNumericNiceInterval(e,e.doubleRange.delta,t):e.visibleRange.interval)}var r=(e.visibleRange.max-e.visibleRange.min)%e.visibleRange.interval;if(r!==0&&!isNaN(r)&&e.valueType==="Double"&&e.orientation==="Vertical"&&e.rangePadding==="Auto"){for(var n=void 0,s=e.visibleRange.min;s<=e.visibleRange.max&&n!==s;s+=e.visibleRange.interval)n=s;n<e.visibleRange.max&&(e.visibleRange.max=n+e.visibleRange.interval)}e.triggerRangeRender(this.chart,e.visibleRange.min,e.visibleRange.max,e.visibleRange.interval)},o.prototype.calculateVisibleLabels=function(t,e){t.visibleLabels=[];var i=t.visibleRange.min,r,n=e.getModuleName(),s=n==="chart"&&e.chartAreaType==="PolarRadar";!s&&(t.zoomFactor<1||t.zoomPosition>0||this.paddingInterval)&&(i=t.visibleRange.min-t.visibleRange.min%t.visibleRange.interval);var a=this.getFormat(t),l=a.match("{value}")!==null,h=0,c=0;t.labelFormat&&t.labelFormat.indexOf("n")>-1&&(c=parseInt(t.labelFormat.substring(1,t.labelFormat.length),10)),t.format=e.intl.getNumberFormat({format:l?"":a,useGrouping:e.useGroupingSeparator}),t.startLabel=t.format(t.visibleRange.min),t.endLabel=t.format(t.visibleRange.max),t.visibleRange.interval&&(t.visibleRange.interval+"").indexOf(".")>=0&&(h=(t.visibleRange.interval+"").split(".")[1].length);for(var u;i<=t.visibleRange.max&&u!==i;i+=t.visibleRange.interval)u=i,r=pe({},V("properties",t.labelStyle),null,!0),Th(i,t.visibleRange)&&hb(e,i,this.formatValue(t,l,a,i),r,t);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(c||h)?+i.toFixed(c||h):i,i<=t.visibleRange.max&&hb(e,i,this.formatValue(t,l,a,i),r,t)),t.getMaxLabelWidth&&t.getMaxLabelWidth(this.chart)},o.prototype.getFormat=function(t){return t.labelFormat?t.labelFormat.indexOf("p")===0&&t.labelFormat.indexOf("{value}")===-1&&t.isStack100?"{value}%":t.labelFormat:t.isStack100?"{value}%":""},o.prototype.formatValue=function(t,e,i,r){var n=r%1?Number(r.toLocaleString("en-US").split(",").join("")):r;return e?i.replace("{value}",t.format(n)):i?t.format(r):t.format(n)},o.prototype.getModuleName=function(){return"Double"},o.prototype.destroy=function(){},o})();var Mh="legendClick",nb="load",Rq="animationComplete",FR="legendRender",hd="textRender",Ah="pointRender",QI="sharedTooltipRender",sb="seriesRender",RR="axisLabelRender",Oq="axisLabelClick",OR="axisRangeCalculated";var ab="tooltipRender",tO="chartMouseMove",iO="chartMouseClick",rO="chartDoubleClick",nO="pointClick",zq="pointDoubleClick",sO="pointMove",aO="chartMouseLeave",oO="chartMouseDown",lO="chartMouseUp";var zR="dragComplete",PR="selectionComplete",ob="resized",hO="beforeResize",BR="beforePrint";var lb=/~\d+~/g,jR=/\^\d+\^/g;var Al=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),nt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Pq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w("0")],t.prototype,"x",void 0),nt([w("0")],t.prototype,"y",void 0),nt([w(null)],t.prototype,"content",void 0),nt([w("Center")],t.prototype,"horizontalAlignment",void 0),nt([w("Pixel")],t.prototype,"coordinateUnits",void 0),nt([w("Chart")],t.prototype,"region",void 0),nt([w("Middle")],t.prototype,"verticalAlignment",void 0),nt([w(null)],t.prototype,"xAxisName",void 0),nt([w(null)],t.prototype,"yAxisName",void 0),nt([w(null)],t.prototype,"description",void 0),nt([Ce({},Bo)],t.prototype,"accessibility",void 0),t})(Oe),cO=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w("")],t.prototype,"color",void 0),nt([w(1)],t.prototype,"width",void 0),nt([w("Rectangle")],t.prototype,"type",void 0),t})(Oe),Bq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w(null)],t.prototype,"start",void 0),nt([w(null)],t.prototype,"end",void 0),nt([w("")],t.prototype,"text",void 0),nt([w(null)],t.prototype,"maximumTextWidth",void 0),nt([w(null)],t.prototype,"customAttributes",void 0),nt([w("")],t.prototype,"type",void 0),t})(Oe),jq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w(!0)],t.prototype,"visible",void 0),nt([w(!1)],t.prototype,"startFromAxis",void 0),nt([w(null)],t.prototype,"start",void 0),nt([w(null)],t.prototype,"end",void 0),nt([w(null)],t.prototype,"size",void 0),nt([w("#808080")],t.prototype,"color",void 0),nt([w(null)],t.prototype,"dashArray",void 0),nt([w("Auto")],t.prototype,"sizeType",void 0),nt([w(!1)],t.prototype,"isRepeat",void 0),nt([w(null)],t.prototype,"repeatEvery",void 0),nt([w(null)],t.prototype,"repeatUntil",void 0),nt([w(!1)],t.prototype,"isSegmented",void 0),nt([w(null)],t.prototype,"segmentStart",void 0),nt([w(null)],t.prototype,"segmentEnd",void 0),nt([w(null)],t.prototype,"segmentAxisName",void 0),nt([Ce({color:"transparent",width:1},qn)],t.prototype,"border",void 0),nt([w("")],t.prototype,"text",void 0),nt([w(null)],t.prototype,"rotation",void 0),nt([w("Middle")],t.prototype,"horizontalAlignment",void 0),nt([w("Middle")],t.prototype,"verticalAlignment",void 0),nt([Ce({size:"12px",color:null,fontStyle:"Normal",fontWeight:"400",fontFamily:null},ea)],t.prototype,"textStyle",void 0),nt([w("Behind")],t.prototype,"zIndex",void 0),nt([w(1)],t.prototype,"opacity",void 0),nt([w("")],t.prototype,"imageUrl",void 0),t})(Oe),Hq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w("Center")],t.prototype,"alignment",void 0),nt([w("Wrap")],t.prototype,"overflow",void 0),nt([Ce({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},ea)],t.prototype,"textStyle",void 0),nt([Ce({color:null,width:1,type:"Rectangle"},cO)],t.prototype,"border",void 0),nt([Gt([],Bq)],t.prototype,"categories",void 0),t})(Oe),Vq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w(null)],t.prototype,"minimum",void 0),nt([w(null)],t.prototype,"maximum",void 0),t})(Oe),_q=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w(!1)],t.prototype,"enable",void 0),nt([w(null)],t.prototype,"pointsLength",void 0),nt([Ce({},Vq)],t.prototype,"range",void 0),nt([w(null)],t.prototype,"trackColor",void 0),nt([w(0)],t.prototype,"scrollbarRadius",void 0),nt([w(null)],t.prototype,"scrollbarColor",void 0),nt([w(0)],t.prototype,"trackRadius",void 0),nt([w(null)],t.prototype,"gripColor",void 0),nt([w(16)],t.prototype,"height",void 0),nt([w(!0)],t.prototype,"enableZoom",void 0),nt([w("PlaceNextToAxisLine")],t.prototype,"position",void 0),t})(Oe),Uq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w("Far")],t.prototype,"horizontalAlignment",void 0),nt([w("Top")],t.prototype,"verticalAlignment",void 0),nt([w(0)],t.prototype,"x",void 0),nt([w(0)],t.prototype,"y",void 0),nt([w(!1)],t.prototype,"draggable",void 0),t})(Oe),Wq=(function(o){Al(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return nt([w(!1)],t.prototype,"visible",void 0),nt([w("transparent")],t.prototype,"fill",void 0),nt([w(null)],t.prototype,"format",void 0),nt([w(0)],t.prototype,"angle",void 0),nt([w(5)],t.prototype,"rx",void 0),nt([w(5)],t.prototype,"ry",void 0),nt([Ce({left:5,right:5,top:5,bottom:5},vd)],t.prototype,"margin",void 0),nt([Ce({width:null,color:null},qn)],t.prototype,"border",void 0),nt([Ce({size:null,color:null,fontStyle:null,fontWeight:"Bold",fontFamily:null},Dq)],t.prototype,"font",void 0),t})(Oe),Ll=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Ge=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},qq=(function(o){Ll(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.axes=[],e.nearSizes=[],e.farSizes=[],e.insideFarSizes=[],e.insideNearSizes=[],e}return t.prototype.computeSize=function(e,i,r,n){var s=0,a=5;e.visible&&e.internalVisibility&&(s+=e.findTickSize(e.crossInAxis)+(e.scrollbarSettings.position==="Right"||e.scrollbarSettings.position==="Left"?0:i)+e.findLabelSize(e.crossInAxis,a,r,n)+e.lineStyle.width*.5),e.isAxisOpposedPosition?this.farSizes.push(s):this.nearSizes.push(s)},Ge([w("100%")],t.prototype,"height",void 0),Ge([Ce({},qn)],t.prototype,"border",void 0),t})(Oe),Yq=(function(o){Ll(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.axes=[],e.nearSizes=[],e.farSizes=[],e.insideFarSizes=[],e.insideNearSizes=[],e.padding=0,e}return t.prototype.computeSize=function(e,i,r,n){var s=0,a=5;e.visible&&e.internalVisibility&&(s+=e.findTickSize(e.crossInAxis)+(e.scrollbarSettings.position==="Top"||e.scrollbarSettings.position==="Bottom"?0:i)+e.findLabelSize(e.crossInAxis,a,r,n)+e.lineStyle.width*.5),e.isAxisOpposedPosition?this.farSizes.push(s):this.nearSizes.push(s)},Ge([w("100%")],t.prototype,"width",void 0),Ge([Ce({},qn)],t.prototype,"border",void 0),t})(Oe),Gq=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(1)],t.prototype,"width",void 0),Ge([w("")],t.prototype,"dashArray",void 0),Ge([w(null)],t.prototype,"color",void 0),t})(Oe),Qq=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(.7)],t.prototype,"width",void 0),Ge([w("")],t.prototype,"dashArray",void 0),Ge([w(null)],t.prototype,"color",void 0),t})(Oe),Xq=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(1)],t.prototype,"width",void 0),Ge([w("")],t.prototype,"dashArray",void 0),Ge([w(null)],t.prototype,"color",void 0),t})(Oe),Kq=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(1)],t.prototype,"width",void 0),Ge([w(5)],t.prototype,"height",void 0),Ge([w(null)],t.prototype,"color",void 0),t})(Oe),$q=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(.7)],t.prototype,"width",void 0),Ge([w(5)],t.prototype,"height",void 0),Ge([w(null)],t.prototype,"color",void 0),t})(Oe),Zq=(function(o){Ll(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ge([w(!1)],t.prototype,"enable",void 0),Ge([w(null)],t.prototype,"fill",void 0),Ge([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ea)],t.prototype,"textStyle",void 0),t})(Oe),Jy=(function(o){Ll(t,o);function t(e,i,r,n){var s=o.call(this,e,i,r,n)||this;return s.visibleLabels=[],s.series=[],s.rect=new Le(void 0,void 0,0,0),s.axisBottomLine=null,s.intervalDivs=[10,5,2,1],s.isStack100=!1,s.crossAt=null,s.updatedRect=null,s.multiLevelLabelHeight=0,s.isChart=!0,s.isIntervalInDecimal=!0,s.titleCollection=[],s.titleSize=new Wt(0,0),s.internalVisibility=!0,s.isRTLEnabled=!1,s.angle=s.labelRotation,s}return t.prototype.findTickSize=function(e){return this.tickPosition==="Inside"||e&&(!e.visibleRange||this.isInside(e.visibleRange))?0:this.majorTickLines.height},t.prototype.isInside=function(e){return Kf(this.crossAt,e)||!this.isAxisOpposedPosition&&this.crossAt>=e.max||this.isAxisOpposedPosition&&this.crossAt<=e.min},t.prototype.findLabelSize=function(e,i,r,n){var s=0,a=this.orientation==="Horizontal";if(this.title){var l=this.titleRotation;if(g(l)?(this.titleSize=Xe(this.title,this.titleStyle,n.themeStyle.axisTitleFont),s=this.titleSize.height+i):(this.titleSize=cd(this.titleStyle,this.title,l,n,n.themeStyle.axisTitleFont),s=(this.orientation==="Vertical"?this.titleSize.width:this.titleSize.height)+i),this.rect.width||this.rect.height){var h=a?this.rect.width:this.rect.height;this.titleCollection=gd(this.title,this.titleStyle,h,n.enableRtl,n.themeStyle.axisTitleFont),s=s*this.titleCollection.length}}var c,u,d=s+i+this.titlePadding+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(e&&this.placeNextToAxisLine){var p=e.visibleRange,f=e.orientation==="Horizontal"?e.rect.width:e.rect.height;if(!p||!f)return 0;this.isInside(p)&&(u=this.findDifference(e),c=u*(f/p.delta),c=u*((f-(c<d?d-c:0))/p.delta),d=c<d?d-c:0)}var v=this.title!==""&&this.titlePadding!==5?this.titlePadding:0;return this.isAxisOpposedPosition?r.insideFarSizes.push(d):r.insideNearSizes.push(d),this.labelPosition==="Inside"?(i=n.axes.indexOf(this)>-1?-5:5,this.isAxisOpposedPosition&&r.farSizes.length<1||!this.isAxisOpposedPosition&&r.nearSizes.length<1?s+i+v:this.isAxisOpposedPosition?s+i+v+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight:s+i+v):d},t.prototype.updateCrossValue=function(){var e=this.crossAt;if(e===null||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var i=this.crossInAxis.visibleRange;this.isAxisOpposedPosition?this.crossAt<i.min&&(e=i.min):this.crossAt>i.max&&(e=i.max),this.updatedRect=pe({},this.rect,null,!0),this.orientation==="Horizontal"?(e=this.crossInAxis.rect.height-Un(e,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+e):(e=Un(e,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+e)},t.prototype.findDifference=function(e){var i=0;return this.isAxisOpposedPosition?i=e.isAxisInverse?e.visibleRange.min:e.visibleRange.max:i=e.isAxisInverse?e.visibleRange.max:e.visibleRange.min,Math.abs(this.crossAt-i)},t.prototype.calculateVisibleRangeOnZooming=function(){if(ud(this)){var e=this.actualRange,i=void 0,r=void 0;this.isAxisInverse?(i=this.actualRange.max-this.zoomPosition*this.actualRange.delta,r=i-this.zoomFactor*this.actualRange.delta):(i=this.actualRange.min+this.zoomPosition*this.actualRange.delta,r=i+this.zoomFactor*this.actualRange.delta),i<e.min&&(r=r+(e.min-i),i=e.min),r>e.max&&(i=i-(r-e.max),r=e.max),this.doubleRange=new Ia(i,r),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},t.prototype.triggerRangeRender=function(e,i,r,n){var s={cancel:!1,name:OR,axis:this,minimum:i,maximum:r,interval:n};e.trigger(OR,s),s.cancel||(this.visibleRange={min:s.minimum,max:s.maximum,interval:s.interval,delta:s.maximum-s.minimum})},t.prototype.getRangePadding=function(e){var i=this.rangePadding;if(i!=="Auto")return i;switch(this.orientation){case"Horizontal":e.requireInvertedAxis?i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":i="None";break;case"Vertical":e.requireInvertedAxis?i="None":i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal";break}return i},t.prototype.getMaxLabelWidth=function(e){var i=this,r,n=0,s=!1,a;this.angle=this.labelRotation,this.maxLabelSize=new Wt(0,0);for(var l=this.labelIntersectAction,h,c=function(v,m){if(h=u.visibleLabels[v],a=Lc(h.originalText),a)h.size=Xe(h.originalText.replace(/<br>/g," "),u.labelStyle,e.themeStyle.axisLabelFont),h.breakLabelSize=Xe(u.enableTrim?h.text.join("<br>"):h.originalText,u.labelStyle,e.themeStyle.axisLabelFont);else if(u.enableWrap){var y=e.initialClipRect.height/u.visibleLabels.length;h.text=El(h.text,u.maximumLabelWidth,u.labelStyle,e.enableRtl,null,null,e.themeStyle.axisLabelFont,u.orientation==="Vertical"?y:null);var b=0,S=0;h.text.forEach(function(R){var P=Xe(R,i.labelStyle,e.themeStyle.axisLabelFont);b=Math.max(b,P.width),S+=P.height}),h.size.width=b,h.size.height=S}else(u.angle===-90||u.angle===90||u.angle===270||u.angle===-270)&&u.orientation==="Vertical"?h.size=cd(u.labelStyle,h.text,u.angle,e,e.themeStyle.axisLabelFont):h.size=Xe(h.text,u.labelStyle,e.themeStyle.axisLabelFont);var C=a?h.breakLabelSize.width:h.size.width;C>u.maxLabelSize.width&&(u.maxLabelSize.width=C,u.rotatedLabel=h.text);var x=a?h.breakLabelSize.height:h.size.height;if(x>u.maxLabelSize.height&&(u.maxLabelSize.height=x),a&&(h.text=u.enableTrim?h.text:h.originalText.split("<br>")),l==="None"||l==="Hide"||l==="Trim")return"continue";if((l!=="None"||u.angle%360===0)&&u.orientation==="Horizontal"&&u.rect.width>0&&!s){var I=a?h.breakLabelSize.width:h.size.width;switch(r=Un(h.value,u)*u.rect.width+u.rect.x,r-=I/2,u.edgeLabelPlacement==="Shift"&&(v===0&&r<u.rect.x&&(r=u.rect.x),v===u.visibleLabels.length-1&&r+I>u.rect.x+u.rect.width&&(r=u.rect.x+u.rect.width-I)),l){case"MultipleRows":v>0&&u.findMultiRows(v,r,h,a);break;case"Rotate45":case"Rotate90":v>0&&(u.isAxisInverse?r+I>=n:r<=n)&&(u.angle=l==="Rotate45"?45:90,s=!0);break;default:{if(a){for(var D=void 0,M=[],E=void 0,A=0;A<h.text.length;A++)if(D=El(h.text[A],u.rect.width/u.visibleLabels.length,u.labelStyle,e.enableRtl,null,null,e.themeStyle.axisLabelFont),D.length>1)for(var L=0;L<D.length;L++)E=D[L],M.push(E);else M.push(D[0]);h.text=M}else h.text=El(h.text,u.rect.width/u.visibleLabels.length,u.labelStyle,e.enableRtl,null,null,e.themeStyle.axisLabelFont);var N=h.size.height*h.text.length;N>u.maxLabelSize.height&&(u.maxLabelSize.height=N);break}}n=u.isAxisInverse?r:r+I}},u=this,d=0,p=this.visibleLabels.length;d<p;d++)c(d);if(this.angle!==0&&this.orientation==="Horizontal"){this.rotatedLabel=g(this.rotatedLabel)?"":this.rotatedLabel;var f=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!f&&Lc(this.rotatedLabel)?this.maxLabelSize=new Wt(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=cd(this.labelStyle,this.rotatedLabel,this.angle,e,e.themeStyle.axisLabelFont)}else if(this.angle!==0&&this.orientation==="Vertical"){this.rotatedLabel=g(this.rotatedLabel)?"":this.rotatedLabel;var f=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!f&&Lc(this.rotatedLabel)?this.maxLabelSize=new Wt(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=cd(this.labelStyle,this.rotatedLabel,this.angle,e,e.themeStyle.axisLabelFont)}e.multiLevelLabelModule&&this.multiLevelLabels.length>0&&e.multiLevelLabelModule.getMultilevelLabelsHeight(this)},t.prototype.findMultiRows=function(e,i,r,n){for(var s,a,l,h=[],c,u=e-1;u>=0;u--)s=this.visibleLabels[u],l=n?s.breakLabelSize.width:s.size.width,a=Un(s.value,this)*this.rect.width+this.rect.x,c=this.isAxisInverse?i+r.size.width>a-l*.5:i<a+l*.5,c?(h.push(s.index),r.index=r.index>s.index?r.index:s.index+1):r.index=h.indexOf(s.index)>-1?r.index:s.index;var d=(n?r.breakLabelSize.height:r.size.height)*r.index+5*(r.index-1);d>this.maxLabelSize.height&&(this.maxLabelSize.height=d)},t.prototype.getModule=function(e){this.valueType==="Double"?this.baseModule=new eO(e):this.baseModule=e[_r(this.valueType)+"Module"]},t.prototype.setIsInversedAndOpposedPosition=function(e){e===void 0&&(e=!1),this.isAxisOpposedPosition=this.opposedPosition||!e&&this.isRTLEnabled&&this.orientation==="Vertical",this.opposedPosition&&!e&&this.isRTLEnabled&&this.orientation==="Vertical"&&(this.isAxisOpposedPosition=!1),this.isAxisInverse=this.isInversed||this.isRTLEnabled&&this.orientation==="Horizontal",this.isInversed&&!e&&this.isRTLEnabled&&this.orientation==="Horizontal"&&(this.isAxisInverse=!1)},t.prototype.updateAxis=function(){var e=this.baseModule.chart,i=e.chartAxisLayoutPanel,r=e.axisCollections.indexOf(this),n=fe(e.element.id+"AxisInsideCollection"),s=fe(e.element.id+"AxisOutsideCollection");i.element=e.renderer.createGroup({id:e.element.id+"AxisGroup"+r+"Inside"});var a=e.renderer.createGroup({id:e.element.id+"AxisGroup"+r+"Outside"}),l=i.findAxisPosition(this);i.drawAxis(this,r,l,a,n,s),e.enableCanvas||gt(e.enableCanvas,n,i.element,e.redraw)},Ge([Ce({fontFamily:null,size:"12px",fontStyle:"Normal",fontWeight:"400",color:null},ea)],t.prototype,"labelStyle",void 0),Ge([Ce({},Zq)],t.prototype,"crosshairTooltip",void 0),Ge([w("")],t.prototype,"title",void 0),Ge([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ea)],t.prototype,"titleStyle",void 0),Ge([w("")],t.prototype,"labelFormat",void 0),Ge([w("")],t.prototype,"skeleton",void 0),Ge([w("DateTime")],t.prototype,"skeletonType",void 0),Ge([w("Center")],t.prototype,"lineBreakAlignment",void 0),Ge([w(0)],t.prototype,"plotOffset",void 0),Ge([w(null)],t.prototype,"plotOffsetLeft",void 0),Ge([w(null)],t.prototype,"plotOffsetTop",void 0),Ge([w(null)],t.prototype,"plotOffsetRight",void 0),Ge([w(null)],t.prototype,"plotOffsetBottom",void 0),Ge([w(!1)],t.prototype,"isIndexed",void 0),Ge([w(10)],t.prototype,"logBase",void 0),Ge([w(0)],t.prototype,"columnIndex",void 0),Ge([w(0)],t.prototype,"rowIndex",void 0),Ge([w(1)],t.prototype,"span",void 0),Ge([w(null)],t.prototype,"desiredIntervals",void 0),Ge([w(3)],t.prototype,"maximumLabels",void 0),Ge([w(1)],t.prototype,"zoomFactor",void 0),Ge([w(0)],t.prototype,"zoomPosition",void 0),Ge([w(!0)],t.prototype,"enableScrollbarOnZooming",void 0),Ge([w(!1)],t.prototype,"opposedPosition",void 0),Ge([w(!0)],t.prototype,"enableAutoIntervalOnZooming",void 0),Ge([w("Auto")],t.prototype,"rangePadding",void 0),Ge([w("Double")],t.prototype,"valueType",void 0),Ge([w("Shift")],t.prototype,"edgeLabelPlacement",void 0),Ge([w("Auto")],t.prototype,"intervalType",void 0),Ge([w("BetweenTicks")],t.prototype,"labelPlacement",void 0),Ge([w("Outside")],t.prototype,"tickPosition",void 0),Ge([w("Outside")],t.prototype,"labelPosition",void 0),Ge([w("")],t.prototype,"name",void 0),Ge([w(!0)],t.prototype,"visible",void 0),Ge([w(0)],t.prototype,"minorTicksPerInterval",void 0),Ge([w(0)],t.prototype,"labelRotation",void 0),Ge([w(null)],t.prototype,"titleRotation",void 0),Ge([w(null)],t.prototype,"crossesAt",void 0),Ge([w(!0)],t.prototype,"placeNextToAxisLine",void 0),Ge([w(null)],t.prototype,"crossesInAxis",void 0),Ge([w(null)],t.prototype,"minimum",void 0),Ge([w(null)],t.prototype,"maximum",void 0),Ge([w(null)],t.prototype,"interval",void 0),Ge([w(34)],t.prototype,"maximumLabelWidth",void 0),Ge([w(!1)],t.prototype,"enableTrim",void 0),Ge([w(!1)],t.prototype,"enableWrap",void 0),Ge([w(5)],t.prototype,"labelPadding",void 0),Ge([w(5)],t.prototype,"titlePadding",void 0),Ge([Ce({},Kq)],t.prototype,"majorTickLines",void 0),Ge([Ce({},$q)],t.prototype,"minorTickLines",void 0),Ge([Ce({},Gq)],t.prototype,"majorGridLines",void 0),Ge([Ce({},Qq)],t.prototype,"minorGridLines",void 0),Ge([Ce({},Xq)],t.prototype,"lineStyle",void 0),Ge([w(j.isDevice?"Rotate45":"Trim")],t.prototype,"labelIntersectAction",void 0),Ge([w(!1)],t.prototype,"isInversed",void 0),Ge([w(100)],t.prototype,"coefficient",void 0),Ge([w(0)],t.prototype,"startAngle",void 0),Ge([w(!0)],t.prototype,"startFromZero",void 0),Ge([w(null)],t.prototype,"description",void 0),Ge([w(2)],t.prototype,"tabIndex",void 0),Ge([Gt([],jq)],t.prototype,"stripLines",void 0),Ge([Gt([],Hq)],t.prototype,"multiLevelLabels",void 0),Ge([Ce({color:null,width:0,type:"Rectangle"},cO)],t.prototype,"border",void 0),Ge([Ce({},_q)],t.prototype,"scrollbarSettings",void 0),t})(Oe),Jq=(function(){function o(t,e,i,r,n,s,a){n===void 0&&(n=new Wt(0,0)),s===void 0&&(s=new Wt(0,0)),a===void 0&&(a=1),this.text=t,this.originalText=r,this.value=e,this.labelStyle=i,this.size=n,this.breakLabelSize=s,this.index=a}return o})(),uO=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})();function e6(o,t,e){for(var i=pe([],o,null),r=0;r<i.length;r++)for(var n=0;n<t.length;n++)i[r][t[n]]instanceof Date&&(i[r][t[n]]=i[r][t[n]].getTime());return i.sort(function(s,a){for(var l=0,h=0,c=0;c<t.length;c++)l+=s[t[c]],h+=a[t[c]];return!e&&l<h||e&&l>h?-1:l===h?0:1}),i}function Lc(o){return o.indexOf("<br>")!==-1}function Eh(o){for(var t=pe([],o.points,null,!0),e=[],i,r=0,n=0;n<t.length;n++)i=t[n],!g(i.x)&&(i.index=r++,e.push(i));return e}function HR(o,t){var e=5,i=o.component,r=0,n=0,s=i.titleStyle.position==="Top"||i.titleStyle.position==="Bottom"&&!i.legendSettings.visible?15:5;i.title&&(r=Xe(i.title,i.titleStyle,i.themeStyle.chartTitleFont).height*i.titleCollection.length+s,i.subTitle&&(n=Xe(i.subTitle,i.subTitleStyle,i.themeStyle.chartSubTitleFont).height*i.subTitleCollection.length));var a;return t?o.axis.scrollbarSettings.position==="Top"?(a=i.margin.top+e+(o.height+e)*i.scrollBarModule.topScrollBarCount+(i.titleStyle.position==="Top"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Top"?i.subTitleStyle.border.width+n:0),i.scrollBarModule.topScrollBarCount++):o.axis.scrollbarSettings.position==="Bottom"&&(a=i.availableSize.height-((o.height+e)*i.scrollBarModule.bottomScrollBarCount+o.height+i.margin.bottom+e+(i.titleStyle.position==="Bottom"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Bottom"?i.subTitleStyle.border.width+n:0)),i.scrollBarModule.bottomScrollBarCount++):o.axis.scrollbarSettings.position==="Right"?(a=i.availableSize.width-((o.height+e)*i.scrollBarModule.rightScrollBarCount+o.height+e+i.margin.right+(i.titleStyle.position==="Right"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Right"?i.subTitleStyle.border.width+n:0)),i.scrollBarModule.rightScrollBarCount++):o.axis.scrollbarSettings.position==="Left"&&(a=i.margin.left+e+(o.height+e)*i.scrollBarModule.leftScrollBarCount+(i.titleStyle.position==="Left"?r+i.titleStyle.border.width:0)+(i.subTitleStyle.position==="Left"?i.subTitleStyle.border.width+n:0),i.scrollBarModule.leftScrollBarCount++),a}function cd(o,t,e,i,r){var n=i.element.style.transform;n&&(i.element.style.transform="");var s=new Ih(i.element.id),a,l=[],h,c,u,d,p={id:"rotate_text",x:i.initialClipRect.x,y:i.initialClipRect.y,"font-size":o.size||r.size,"font-style":o.fontStyle||r.fontStyle,"font-family":o.fontFamily,"font-weight":o.fontWeight||r.fontWeight,transform:"rotate("+e+", 0, 0)","text-anchor":"middle"};Lc(t)?(l=t.split("<br>"),a=l[0]):a=t;var f=s.createText(p,a);if(!i.delayRedraw&&!i.redraw&&!i.stockChart&&i.element.appendChild(i.svgObject),typeof l!="string"&&l.length>1)for(var v=1,m=l.length;v<m;v++)h=Xe(l[v],o,i.themeStyle.axisLabelFont).height,c=p.y+v*h,u=l[v],d=s.createTSpan({x:p.x,id:p.id,y:c},u),f.appendChild(d);var y=i.svgRenderer.createSvg({id:"AxisLabelMax_svg",width:i.availableSize.width,height:i.availableSize.height});document.body.appendChild(y),y.appendChild(f);var b=f.getBoundingClientRect();if(n&&(i.element.style.transform=n),Qe(y),!i.delayRedraw&&!i.redraw&&!i.stockChart&&!i.pointsAdded&&Qe(i.svgObject),i.enableCanvas){var S=Xe(t,o,i.themeStyle.axisLabelFont).width,C=Xe(t,o,i.themeStyle.axisLabelFont).height,x=e*Math.PI/180,I=Math.abs(Math.cos(x)*S)+Math.abs(Math.sin(x)*C),D=Math.abs(Math.sin(x)*S)+Math.abs(Math.cos(x)*C);return new Wt(I,D)}return new Wt(b.right-b.left,b.bottom-b.top)}function zt(o){if(!o)return null;var t=typeof o=="string"?fe(o):o;t&&Qe(t)}function Tl(o,t){return Math.log(o)/Math.log(t)}function pd(o,t,e,i,r,n,s,a,l){var h=document.getElementById(r),c=Xe(o,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),u=c.width+5;if(t=t+u>i?t-(u+15):t,l&&t<l.x&&(t=l.x),e=a?e-c.height/2:e+15,l&&e+c.height>l.y+l.height&&(e-=e+c.height-(l.y+l.height)),h)h.innerText=o,h.style.top=e.toString()+"px",h.style.left=(t+15).toString()+"px";else{h=et("div",{id:r,styles:"top:"+e.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),h.innerText=o,n.appendChild(h);var d=parseInt(h.style.left.replace("px",""),10);d<0&&(h.style.left="0px")}s&&setTimeout(function(){zt(r)},1500)}function Kf(o,t){return o<t.max&&o>t.min}function Th(o,t){return o<=t.max&&o>=t.min}function $f(o,t){return t.valueType==="Logarithmic"?Tl(o,t.logBase):o}function Nl(o,t,e,i){if(i.chart.zoomModule&&i.chart.zoomSettings.enableAnimation)return!0;var r=$f(t.xValue,i.xAxis),n=o?$f(o.xValue,i.xAxis):r,s=e?$f(e.xValue,i.xAxis):r,a=Math.floor(i.xAxis.visibleRange.min),l=Math.ceil(i.xAxis.visibleRange.max);return n>=a&&n<=l||r>=a&&r<=l||s>=a&&s<=l||a>=n&&a<=s}function gn(o){for(var t=0,e=0,i=o;e<i.length;e++){var r=i[e];t+=r}return t}function zo(o,t){return o.x+=t.left,o.y+=t.top,o.width-=t.left+t.right,o.height-=t.top+t.bottom,o}function dO(o,t){return o.x+=t.x,o.y+=t.y,o.width-=t.x+t.width,o.height-=t.y+t.height,o}function Tn(o,t,e){var i=o*Math.PI/180;return new at(Math.cos(i)*t+e.x,Math.sin(i)*t+e.y)}function eb(o){return o*(Math.PI/180)}function VR(o,t,e,i){for(var r=[],n=0;n<4;n++){var s=o[n],a=s.x-t,l=s.y-e,h=a*Math.cos(eb(i))-l*Math.sin(eb(i)),c=a*Math.sin(eb(i))+l*Math.cos(eb(i));s.x=h+t,s.y=c+e,r.push(new at(s.x,s.y))}return r}function pO(o,t){var e=[o,t],i,r,n,s,a,l,h,c;for(s=0;s<e.length;s++){var u=e[s];for(a=0;a<u.length;a++){var d=(a+1)%u.length,p=u[a],f=u[d],v=new at(f.y-p.y,p.x-f.x);for(i=r=void 0,l=0;l<o.length;l++)n=v.x*o[l].x+v.y*o[l].y,(g(i)||n<i)&&(i=n),(g(r)||n>r)&&(r=n);for(h=c=void 0,l=0;l<t.length;l++)n=v.x*t[l].x+v.y*t[l].y,(g(h)||n<h)&&(h=n),(g(c)||n>c)&&(c=n);if(r<h||c<i)return!1}}return!0}function t6(o,t,e,i,r){var n=Tn(270,e,new at(o,t)),s=Tn(270,e,new at(o+r/10,t));return"M "+o+" "+t+" L "+(o+e)+" "+t+" A "+e+" "+e+" 0 1 1 "+n.x+" "+n.y+" Z M "+(o+r/10)+" "+(t-i/10)+" L"+(o+e)+" "+(t-i/10)+" A "+e+" "+e+" 0 0 0 "+s.x+" "+s.y+" Z"}function i6(o,t){var e=Math.atan2(t.y-o.y,t.x-o.x);return e=e<0?6.283+e:e,e*(180/Math.PI)}function ao(o,t){for(var e=[],i=0;i<=t-1;i++)e.push(o[i]);return e}function Un(o,t){var e=t.visibleRange,i=(o-e.min)/e.delta,r=t.isChart?t.isAxisInverse:t.isInversed;return r?1-i:i}function fd(o,t,e,i,r,n){o=e.valueType==="Logarithmic"?Tl(o>1?o:1,e.logBase):o,t=i.valueType==="Logarithmic"?Tl(t>1?t:1,i.logBase):t,o+=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"&&n.type!=="Radar"?.5:0;var s=n.chart.radius*Un(t,i),a=r6(fO(o,e),n.chart.primaryXAxis.startAngle);return{x:n.clipRect.width/2+n.clipRect.x+s*a.x,y:n.clipRect.height/2+n.clipRect.y+s*a.y}}function Fc(o,t){t===void 0&&(t=!1);var e=["NaN","NaN"];return o.indexOf("_polygon")>-1?e=["NaN","NaN"]:o.indexOf("_Point_")>-1?e=o.split("_Series_")[1].split("_Point_"):o.indexOf("_shape_")>-1&&(!t||t&&o.indexOf("_legend_")===-1)?(e=o.split("_shape_"),e[0]="0"):o.indexOf("_text_")>-1&&(!t||t&&o.indexOf("_legend_")===-1)?(e=o.split("_text_"),e[0]="0"):o.indexOf("_datalabel_")>-1?(e=o.split("_datalabel_")[1].split("_g_"),e[0]=e[0].replace("Series_","")):o.indexOf("TextGroup")>-1?(e=o.split("TextGroup"),e[0]=e[1]):o.indexOf("ShapeGroup")>-1&&(e=o.split("ShapeGroup"),e[0]=e[1]),new Tc(parseInt(e[0],10),parseInt(e[1],10))}function r6(o,t){t=t<0?t+360:t;var e=Math.PI*(1.5-2*o);return e=e+t*Math.PI/180,{x:Math.cos(e),y:Math.sin(e)}}function fO(o,t){var e=t.visibleRange,i,r;return t.valueType!=="Category"?(i=e.max-(t.valueType==="DateTime"?t.dateTimeInterval:e.interval)-e.min,r=t.visibleLabels.length-1,i=i===0?1:i):(i=t.visibleLabels.length===1?1:t.visibleLabels[t.visibleLabels.length-1].value-t.visibleLabels[0].value,r=t.visibleLabels.length),t.isAxisInverse?(o-e.min)/i*(1-1/r):1-(o-e.min)/i*(1-1/r)}function n6(o,t,e,i,r,n){for(var s=5,a=t.isAxisOpposedPosition,l=o.enableRtl?"end":r?"start":"auto",h,c=o.availableSize.width,u,d,p,f=3,v,m,y=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0,b=o.enableRtl&&!r&&!t.isInversed||t.isInversed&&!(o.enableRtl&&!r),S=0;S<2;S++){if(h=Xe(S?b?t.startLabel:t.endLabel:b?t.endLabel:t.startLabel,t.labelStyle,o.themeStyle.axisLabelFont),r?(v=S?new at(n.x-y,n.y+f):new at(t.rect.x-y,n.y+n.height-f),d=n.x+(a?n.width+s+y:-(h.width+s+s+y)),p=n.y+(S?0:n.height-h.height-s),d+=d<0||c<d+h.width+s?a?-(h.width/2):h.width/2:0,m=_R(f,f,new Le(d,p,h.width+s,h.height+s),v,s,!1,!1,!a,v.x,v.y+(S?-f:f))):(v=S?new at(n.x+n.width-f,n.y+n.height+y):new at(n.x+f,n.y+n.height+y),d=n.x+(S?n.width-h.width-s:0),p=a?n.y-h.height-10-y:n.y+n.height+s+y,m=_R(f,f,new Le(d,p,h.width+s,h.height+s),v,s,a,!a,!1,v.x+(S?f:-f),v.y)),d=d+s/2,p=p+3*(h.height/4)+s/2,u=o.renderer.drawPath({id:o.element.id+"_Zoom_"+i+"_AxisLabel_Shape_"+S,fill:o.themeStyle.crosshairFill,width:2,color:o.themeStyle.crosshairFill,opacity:1,"stroke-dasharray":null,d:m},null),e.appendChild(u),o.theme==="Fluent"||o.theme==="FluentDark"){var C=o.element.id+"_shadow";u.setAttribute("filter",j.isIE?"":"url(#"+C+")");var x='<filter id="'+C+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';x+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',x+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var I=o.renderer.createDefs();I.setAttribute("id",o.element.id+"SVG_tooltip_definition"),e.appendChild(I),I.innerHTML=x,u.setAttribute("stroke","#cccccc"),u.setAttribute("stroke-width","0.5")}vn(o.renderer,new bn(o.element.id+"_Zoom_"+i+"_AxisLabel_"+S,d,p,l,S?b?t.startLabel:t.endLabel:b?t.endLabel:t.startLabel),{color:o.themeStyle.crosshairLabelFont.color,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},o.themeStyle.crosshairLabelFont.color,e,null,null,null,null,null,null,null,null,null,null,o.themeStyle.crosshairLabelFont)}return e}function _R(o,t,e,i,r,n,s,a,l,h){var c="",u=e.x,d=e.y,p=e.x+e.width,f=e.y+e.height;return n?(c=c.concat("M "+u+" "+(d+t)+" Q "+u+" "+d+" "+(u+o)+" "+d),c=c.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+t)),c=c.concat(" L "+p+" "+(f-t)+" Q "+p+" "+f+" "+(p-o)+" "+f),r!==0&&(c=c.concat(" L "+(i.x+r/2)+" "+f),c=c.concat(" L "+l+" "+(f+r)+" L "+(i.x-r/2)+" "+f)),i.x-r/2>u||r===0?c=c.concat(" L "+(u+o)+" "+f+" Q "+u+" "+f+" "+u+" "+(f-t)+" z"):c=c.concat(" L "+u+" "+(f+t)+" z")):s?(c=c.concat("M "+u+" "+(d+t)+" Q "+u+" "+d+" "+(u+o)+" "+d+" L "+(i.x-r/2)+" "+d),c=c.concat(" L "+l+" "+i.y),c=c.concat(" L "+(i.x+r/2)+" "+d),c=c.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+t)),c=c.concat(" L "+p+" "+(f-t)+" Q "+p+" "+f+" "+(p-o)+" "+f),c=c.concat(" L "+(u+o)+" "+f+" Q "+u+" "+f+" "+u+" "+(f-t)+" z")):a?(c=c.concat("M "+u+" "+(d+t)+" Q "+u+" "+d+" "+(u+o)+" "+d),c=c.concat(" L "+(p-o)+" "+d+" Q "+p+" "+d+" "+p+" "+(d+t)+" L "+p+" "+(i.y-r/2)),c=c.concat(" L "+(p+r)+" "+h),c=c.concat(" L "+p+" "+(i.y+r/2)),c=c.concat(" L "+p+" "+(f-t)+" Q "+p+" "+f+" "+(p-o)+" "+f),c=c.concat(" L "+(u+o)+" "+f+" Q "+u+" "+f+" "+u+" "+(f-t)+" z")):(c=c.concat("M "+(u+o)+" "+d+" Q "+u+" "+d+" "+u+" "+(d+t)+" L "+u+" "+(i.y-r/2)),c=c.concat(" L "+(u-r)+" "+h),c=c.concat(" L "+u+" "+(i.y+r/2)),c=c.concat(" L "+u+" "+(f-t)+" Q "+u+" "+f+" "+(u+o)+" "+f),c=c.concat(" L "+(p-o)+" "+f+" Q "+p+" "+f+" "+p+" "+(f-t)),c=c.concat(" L "+p+" "+(d+t)+" Q "+p+" "+d+" "+(p-o)+" "+d+" z")),c}function Pi(o,t,e,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=e.x-i&&o<=e.x+e.width+i&&t>=e.y-r&&t<=e.y+e.height+r}function gO(o,t,e){var i=e.isAxisInverse?1-o/t:o/t;return i*e.visibleRange.delta+e.visibleRange.min}function vO(o,t,e){var i=e.isAxisInverse?o/t:1-o/t;return i*e.visibleRange.delta+e.visibleRange.min}function $I(o,t){t===void 0&&(t=!1);var e=o.clipRect;t&&(o.type==="Polar"||o.type==="Radar")?o.drawType==="Scatter"?(e.x=o.xAxis.rect.x,e.y=o.yAxis.rect.y,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height):(e.x=o.xAxis.rect.x/2,e.y=o.yAxis.rect.y/2,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height):o.chart.requireInvertedAxis?(e.x=o.yAxis.rect.x,e.y=o.xAxis.rect.y,e.width=o.yAxis.rect.width,e.height=o.xAxis.rect.height):(e.x=o.xAxis.rect.x,e.y=o.yAxis.rect.y,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height)}function _r(o){return o.substr(0,1).toLowerCase()+o.substr(1)}function mO(o,t){for(var e=Number.MAX_VALUE,i,r,n,s=!0,a=[],l=0,h=t;l<h.length;l++){var c=h[l];if(c.visible){var u=c.points.map(function(b){return b.xValue});if(u.length!==1){s=!1;break}}}for(var d=0;d<t.length;d++){var c=t[d];if(i=[],c.visible&&(o.name===c.xAxisName||o.name==="primaryXAxis"&&c.xAxisName===null||o.name===c.chart.primaryXAxis.name&&!c.xAxisName))if(c.type.indexOf("Stacking")>-1&&a.indexOf(c.stackingGroup)===-1&&a.push(c.stackingGroup),i=c.points.map(function(S){return S.xValue}),i.sort(function(S,C){return S-C}),i.length===1&&s)if(o.valueType==="Category"){var p=c.xAxis.visibleRange.min,f=i[0]-p;f!==0&&(e=Math.min(e,f))}else if(o.valueType==="DateTime"){var v=t.length===1?2592e4:2592e6;n=c.xMin===c.xMax?c.xMin-v:c.xMin,r=i[0]-(g(n)?o.visibleRange.min:n),r!==0&&(e=Math.min(e,r))}else n=c.xMin,r=i[0]-(g(n)?o.visibleRange.min:n),r!==0&&(e=Math.min(e,r));else for(var m=0;m<i.length;m++){var y=i[m];m>0&&y&&(r=c.type.indexOf("Stacking")>-1&&o.valueType==="Category"?a.length:y-i[m-1],r!==0&&(e=Math.min(e,r)))}}return e===Number.MAX_VALUE&&(e=1),e}function iM(o){var t;switch(o){case"Linear":t=Ur;break}return t}function Ur(o,t,e,i){return-e*Math.cos(o/i*(Math.PI/2))+e+t}function Lh(o,t,e,i,r,n,s){var a=!!i.accumulation;o.style.visibility="hidden";var l=o.getAttribute("transform");new Mt({}).animate(o,{duration:e,delay:t,progress:function(h){if(h.timeStamp>h.delay&&(h.element.style.visibility="visible"),a?h.element.id.indexOf("_datalabel_Series_")>-1:(h.element.parentElement.parentElement.id.indexOf("DataLabel")>-1||o.id.indexOf("StackLabel")>-1)&&!(i.chart.stackLabels.visible&&o.getAttribute("data-collide"))){h.element.style.visibility="visible";var c=a?i.opacity:i.marker.dataLabel.opacity,u=h.timeStamp/500*c;a||o.id.indexOf("StackLabel")>-1?o.setAttribute("opacity",Math.min(u,c).toString()):(i.textElement.setAttribute("opacity",Math.min(u,c).toString()),i.shapeElement.setAttribute("opacity",Math.min(u,c).toString()))}},end:function(){(i.type==="Scatter"||i.type==="Bubble")&&i.lastValueLabelElement&&i.lastValueLabelElement.setAttribute("visibility","visible");var h=document.getElementById(i.chart.element.id+"_Annotation_Collections");h&&i.type!=="Line"&&(h.style.visibility="visible"),(o.parentElement.parentElement.id.indexOf("DataLabel")>-1||o.id.indexOf("_datalabel_Series_")>-1||o.id.indexOf("StackLabel")>-1)&&(a||o.id.indexOf("StackLabel")>-1?o.setAttribute("opacity",i.opacity.toString()):(i.textElement.setAttribute("opacity",i.marker.dataLabel.opacity.toString()),i.shapeElement.setAttribute("opacity",i.marker.dataLabel.opacity.toString()))),i.chart.stackLabels.visible&&o.getAttribute("data-collide")||(o.style.visibility=""),o.setAttribute("transform",l||""),(i.type==="Scatter"||i.type==="Bubble")&&!s&&r===i.points.length-1&&i.chart.trigger("animationComplete",{series:i})}})}function s6(o,t,e,i,r){var n=function(s){o.setAttribute("x",s.x+""),o.setAttribute("y",s.y+""),o.setAttribute("width",s.width+""),o.setAttribute("height",s.height+"")};new Mt({}).animate(et("div"),{duration:e,delay:t,progress:function(s){n(new Le(Ur(s.timeStamp,r.x,i.x-r.x,s.duration),Ur(s.timeStamp,r.y,i.y-r.y,s.duration),Ur(s.timeStamp,r.width,i.width-r.width,s.duration),Ur(s.timeStamp,r.height,i.height-r.height,s.duration)))},end:function(){n(i)}})}function fb(o,t,e,i,r){if(!e||!i&&!o)return null;var n=300;g(r)||(n=r);var s=i||o.getAttribute("d"),a=s.split(/(?=[LMCZAQ])/),l=t.split(/(?=[LMCZAQ])/),h,c=[],u=[],d,p;o.setAttribute("d",s),new Mt({}).animate(et("div"),{duration:n,progress:function(f){h="",a.map(function(v,m){if(c=v.split(" "),u=l[m]?l[m].split(" "):c,c[0]==="Z"?h+="Z ":c[0]===""?h="":h+=c[0]+" "+Ur(f.timeStamp,+c[1],+u[1]-+c[1],f.duration)+" "+Ur(f.timeStamp,+c[2],+u[2]-+c[2],f.duration)+" ",c[0]==="C"||c[0]==="Q")for(d=3,p=c[0]==="Q"?4:6;d<p;)h+=Ur(f.timeStamp,+c[d],+u[d]-+c[d],f.duration)+" "+Ur(f.timeStamp,+c[++d],+u[d]-+c[d],f.duration)+" ",++d;c[0]==="A"&&(h+="0 0 1 "+Ur(f.timeStamp,+c[6],+u[6]-+c[6],f.duration)+" "+Ur(f.timeStamp,+c[7],+u[7]-+c[7],f.duration)+" ")}),o.setAttribute("d",h)},end:function(){o.setAttribute("d",t)}})}function Ma(o,t,e,i,r,n,s){if(!e||!i&&!o)return null;var a=300;g(r)||(a=r);var l=i||o.getAttribute("d"),h=t,c="";o.setAttribute("d",l),new Mt({}).animate(et("div"),{duration:a,progress:function(u){c="";for(var d=l.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),p=h.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),f=Math.max(d.length,p.length),v=0;v<f;v++){for(var m=d[v]||"",y=p[v]||"",b=m.trim().split(/\s+/),S=y.trim().split(/\s+/),C=[],x=1;x<b.length;x++){var I=parseFloat(b[x]),D=parseFloat(S[x]);if(!isNaN(I)&&!isNaN(D)&&(b.length===S.length||s)){var M=Ur(u.timeStamp,I,D-I,a);f-1,C.push(M)}}C.length>0&&b.length!==S.length?c+="L":C.length>0&&(c+=b[0]),c+=" "+C.join(" "),c+=" "}o.setAttribute("d",c)},end:function(){o.setAttribute("d",n||t)}})}function Rc(o,t,e,i){i===void 0&&(i="drawClipPath");var r=oo(o,t.id,t,e);if(r){var n=e.createDefs();return n.appendChild(r),n}else return e[i](t)}function hb(o,t,e,i,r){var n={cancel:!1,name:RR,axis:r,text:e,value:t,labelStyle:i};if(o.trigger(RR,n),!n.cancel){var s=n.text.indexOf("<br>")!==-1,a=r.enableTrim?s?v6(r.maximumLabelWidth,n.text,r.labelStyle,o.themeStyle.axisLabelFont):Js(r.maximumLabelWidth,n.text,r.labelStyle,o.enableRtl,o.themeStyle.axisLabelFont):n.text;r.visibleLabels.push(new Jq(a,n.value,n.labelStyle,n.text))}}function Ps(o){return o.minimum!=null&&o.maximum!=null}function ud(o){return o.zoomFactor<1&&o.zoomPosition>=0}function yO(o,t){var e=t.orientation==="Horizontal"?o.width:o.height;if(g(t.desiredIntervals)){var i=(t.orientation==="Horizontal"?.533:1)*t.maximumLabels;return i=Math.max(e*(i/100),1),i}else return t.desiredIntervals}function rM(o,t,e,i,r){new Mt({}).animate(o,{duration:e,delay:t,name:i,progress:function(n){n.element.style.visibility="visible"},end:function(n){r?Qe(n.element):n.element.style.visibility="visible"}})}function Zs(o,t,e,i,r,n,s,a,l,h){var c=s||new Ih(""),u=a6(o,e,t,r,i,l,h),d=c["draw"+u.functionName](u.renderOption,a?new Int32Array([a.x,a.y]):null);return d}function a6(o,t,e,i,r,n,s){var a,l="Path",h=n,c=h&&e==="Circle"?t.width-2:t.width,u=h&&e==="Circle"?t.height-2:t.height,d=h?s.targetWidth:0,p=o.x,f=o.y,v=o.y+-u/2,m=o.x+-c/2,y=72,b,S;switch(e){case"Bubble":case"Circle":l="Ellipse",mt(i,{rx:c/2,ry:u/2,cx:p,cy:f});break;case"Plus":a="M "+m+" "+f+" L "+(p+c/2)+" "+f+" M "+p+" "+(f+u/2)+" L "+p+" "+(f+-u/2),mt(i,{d:a});break;case"Cross":a="M "+m+" "+(f+-u/2)+" L "+(p+c/2)+" "+(f+u/2)+" M "+m+" "+(f+u/2)+" L "+(p+c/2)+" "+(f+-u/2),mt(i,{d:a});break;case"Multiply":a="M "+(p-d)+" "+(f-d)+" L "+(p+d)+" "+(f+d)+" M "+(p-d)+" "+(f+d)+" L "+(p+d)+" "+(f-d),mt(i,{d:a,stroke:i.fill});break;case"HorizontalLine":a="M "+m+" "+f+" L "+(p+c/2)+" "+f,mt(i,{d:a});break;case"VerticalLine":a="M "+p+" "+(f+u/2)+" L "+p+" "+(f+-u/2),mt(i,{d:a});break;case"Diamond":a="M "+m+" "+f+" L "+p+" "+(f+-u/2)+" L "+(p+c/2)+" "+f+" L "+p+" "+(f+u/2)+" L "+m+" "+f+" z",mt(i,{d:a});break;case"ActualRect":a="M "+m+" "+(f+-u/8)+" L "+(p+d)+" "+(f+-u/8)+" L "+(p+d)+" "+(f+u/8)+" L "+m+" "+(f+u/8)+" L "+m+" "+(f+-u/8)+" z",mt(i,{d:a});break;case"TargetRect":a="M "+(m+d)+" "+(f+-u/2)+" L "+(p+d/2)+" "+(f+-u/2)+" L "+(p+d/2)+" "+(f+u/2)+" L "+(m+d)+" "+(f+u/2)+" L "+(m+d)+" "+(f+-u/2)+" z",mt(i,{d:a});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"RangeStepArea":case"StackingStepArea":case"Square":case"Flag":a="M "+m+" "+(f+-u/2)+" L "+(p+c/2)+" "+(f+-u/2)+" L "+(p+c/2)+" "+(f+u/2)+" L "+m+" "+(f+u/2)+" L "+m+" "+(f+-u/2)+" z",mt(i,{d:a});break;case"Pyramid":case"Triangle":a="M "+m+" "+(f+u/2)+" L "+p+" "+(f+-u/2)+" L "+(p+c/2)+" "+(f+u/2)+" L "+m+" "+(f+u/2)+" z",mt(i,{d:a});break;case"Funnel":case"InvertedTriangle":a="M "+(p+c/2)+" "+(f-u/2)+" L "+p+" "+(f+u/2)+" L "+(p-c/2)+" "+(f-u/2)+" L "+(p+c/2)+" "+(f-u/2)+" z",mt(i,{d:a});break;case"Pentagon":for(var C=0;C<=5;C++)b=c/2*Math.cos(Math.PI/180*(C*y)),S=u/2*Math.sin(Math.PI/180*(C*y)),C===0?a="M "+(p+b)+" "+(f+S)+" ":a=a.concat("L "+(p+b)+" "+(f+S)+" ");a=a.concat("Z"),mt(i,{d:a});break;case"Image":l="Image",mt(i,{href:r,height:u,width:c,x:m,y:v});break;case"Star":{for(var x=5,I=Math.min(c,u)/2,D=I/2,M=Math.PI/x,E="",C=0;C<2*x;C++){var A=C%2===0?I:D,L=p+A*Math.cos(C*M-Math.PI/2),N=f+A*Math.sin(C*M-Math.PI/2);E+=(C===0?"M":"L")+L+","+N}E+="Z",mt(i,{d:E});break}}return i=g6(o,new Wt(c,u),e,i).renderOption,{renderOption:i,functionName:l}}function fe(o){return document.getElementById(o)}function o6(o){var t=null;try{typeof o!="function"&&document.querySelectorAll(o).length?t=Et(document.querySelector(o).innerHTML.trim()):t=Et(o)}catch{t=Et(o)}return t}function l6(o,t,e,i,r,n,s,a,l,h){var c=o.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(e,o,n,i,r,s,a,l,h,c,!0)}function h6(o,t,e,i,r,n){var s=document.getElementById(t.element.id+"_Series_"+(i.index===void 0?i.category:i.index)+"_DataLabelCollections");s&&(e.index===0&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(s,o,e,i,i.marker.dataLabel,r,i.clipRect,n,!0))}function gb(o,t,e,i,r,n,s,a,l,h,c,u,d,p,f){var v=o6(e),m;try{var y={chart:i,series:n,point:r},b=s?s+"_template":"template",S=v?v(y,i,b,s||o.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(S.length){m=Array.prototype.slice.call(S);for(var C=m.length,x=0;x<C;x++)o.appendChild(m[x])}var I=void 0;i.getModuleName()==="accumulationchart"?(I=c.length&&c[t]?l6.bind(this,o,i,h,c,l,c[t],u,d,p,f):I,i.isReact&&i.renderReactTemplates(I)):i.getModuleName()==="chart"&&(I=r&&n?h6.bind(this,o,i,r,n,a,f):I,i.isReact&&i.renderReactTemplates(I))}catch{return o}return o}function bO(o,t){var e="";return e="font-size:"+(o.size||t.size)+"; font-style:"+(o.fontStyle||t.fontStyle)+"; font-weight:"+(o.fontWeight||t.fontWeight)+"; font-family:"+o.fontFamily+";opacity:"+o.opacity+"; color:"+o.color+";",e}function SO(o,t,e){t===void 0&&(t=!1),e||document.body.appendChild(o);var i=o.getBoundingClientRect();return t?Qe(o):e||zt(o.id),i}function c6(o,t){for(var e,i=0,r=o.length;i<r;i++)if(o[i].id.indexOf(t)>-1){e=o[i];continue}return e}function Wn(o,t,e,i,r){o=e.valueType==="Logarithmic"?Tl(o>0?o:Math.pow(e.logBase,e.visibleRange.min),e.logBase):o,t=i.valueType==="Logarithmic"?Tl(t>0?t:Math.pow(i.logBase,i.visibleRange.min),i.logBase):t,o=Un(o,e),t=Un(t,i);var n=r?e.rect.height:e.rect.width,s=r?i.rect.width:i.rect.height,a=r?t*s:o*n,l=r?(1-o)*n:(1-t)*s;return new at(a,l)}function gt(o,t,e,i,r,n,s,a,l,h,c,u,d,p,f,v,m){if(r===void 0&&(r=!1),n===void 0&&(n="x"),s===void 0&&(s="y"),h===void 0&&(h=!1),c===void 0&&(c=!1),u===void 0&&(u=null),p===void 0&&(p=!1),f===void 0&&(f=0),o)return null;var y=p?null:t.querySelector("#"+e.id),b=y||fe(e.id),S=e,C=g(d)?300:d;if(i&&r&&b)if(a=a||(b.tagName==="DIV"?new at(+b.style[n].split("px")[0],+b.style[s].split("px")[0]):new at(+b.getAttribute(n),+b.getAttribute(s))),l&&l!=="undefined")fb(e,e.getAttribute("d"),i,l,C);else if(c&&u)s6(S,0,C,new Le(+b.getAttribute("x"),+b.getAttribute("y"),+b.getAttribute("width"),+b.getAttribute("height")),u);else{var x=S.tagName==="DIV"?new at(+S.style[n].split("px")[0],+S.style[s].split("px")[0]):new at(+S.getAttribute(n),+S.getAttribute(s)),I=b.getAttribute("transform");m6(S,C,a,x,n,s,f,v,m!==void 0?new at(m.match(/\d+/g).map(Number)[0],m.match(/\d+/g).map(Number)[1]):I?new at(parseFloat(I.split(",")[1]),parseFloat(I.split(",")[2])):new at(0,0),m!==void 0)}else i&&r&&!b&&h&&rM(S,0,600,"FadeIn");y?t.replaceChild(S,b):t.appendChild(S)}function XI(o,t,e,i,r){var n=Math.abs(o-e),s=Math.abs(t-i),a=Math.max(UR(Math.min(o,e),n,r.x,r.width),r.x),l=Math.max(UR(Math.min(t,i),s,r.y,r.height),r.y);return new Le(a,l,Math.min(n,r.width),Math.min(s,r.height))}function UR(o,t,e,i){return o<e?o=e:o+t>i+e&&(o=i+e-t),o}function u6(o,t,e){var i=t.marker.dataLabel.format?t.marker.dataLabel.format:t.yAxis.labelFormat,r=[],n=i.match("{value}")!==null;switch(t.seriesType){case"XY":t.chart.chartAreaType==="PolarRadar"?t.drawType.indexOf("Stacking")!==-1?(t.yAxis.valueType==="Logarithmic"&&$f(t.stackedValues.endValues[o.index],t.yAxis)||Th(t.stackedValues.endValues[o.index],t.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):(t.yAxis.valueType==="Logarithmic"&&$f(o.yValue,t.yAxis)||Th(o.yValue,t.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):r.push(o.text||o.yValue.toString());break;case"HighLow":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString());break;case"HighLowOpenClose":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString()),r.push(o.text||Math.max(o.open,o.close).toString()),r.push(o.text||Math.min(o.open,o.close).toString());break;case"BoxPlot":r.push(o.text||o.median.toString()),r.push(o.text||o.maximum.toString()),r.push(o.text||o.minimum.toString()),r.push(o.text||o.upperQuartile.toString()),r.push(o.text||o.lowerQuartile.toString());for(var s=0,a=o.outliers;s<a.length;s++){var l=a[s];r.push(o.text||l.toString())}break}if((i||e.useGroupingSeparator)&&!o.text){t.yAxis.format=e.intl.getNumberFormat({format:n?"":i,useGrouping:e.useGroupingSeparator});for(var h=0;h<r.length;h++)r[h]=n?i.replace("{value}",t.yAxis.format(parseFloat(r[h]))):t.yAxis.format(parseFloat(r[h]))}return r}function CO(o){window.clearInterval(o)}function ad(o,t,e){var i=new Le(o.x+e.x,o.y+e.y,o.width,o.height),r=t.some(function(n){return i.x<n.x+n.width&&i.x+i.width>n.x&&i.y<n.y+n.height&&i.height+i.y>n.y});return r}function ns(o,t){return o.x<t.x+t.width&&o.x+o.width>t.x&&o.y<t.y+t.height&&o.height+o.y>t.y}function d6(o,t){return o.x<=t.x&&o.x+o.width>=t.x+t.width&&o.y<=t.y&&o.height+o.y>=t.y+t.height}function tb(o,t,e){return new Le(o.x-t.width/2-e.left,o.y-t.height/2-e.top,t.width+e.left+e.right,t.height+e.top+e.bottom)}function wO(o){return"#"+dd(o.r)+dd(o.g)+dd(o.b)}function dd(o){var t=o.toString(16);return t.length===1?"0"+t:t}function eg(o){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return t?new cb(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new cb(255,255,255)}function _n(o){o=o==="transparent"?"white":o;var t=document.getElementById("chartmeasuretext");t||(t=et("text",{id:"chartmeasuretext"}),document.body.appendChild(t)),t.style.color=o,o=window.getComputedStyle(t).color,t.style.color="";var e;if((o.indexOf("rgb")===0||o.indexOf("hsl")===0)&&(o=o.replace(/\s/g,"").replace(/[()]/g,""),e=o.slice(3).split(",")),e&&e.length){var i=e.map(function(a){return parseInt(a,10)}),r=i[0],n=i[1],s=i[2];return wO(new cb(r,n,s))}return""}function p6(o){if(o.indexOf("rgba(")===0||o.indexOf("rgb(")===0){var t=o.substring(o.indexOf("(")+1,o.lastIndexOf(")")).split(",");if(t.length===3||t.length===4)return t.every(function(i){var r=parseFloat(i);return!isNaN(r)&&r>=0&&r<=255})}else if(o.indexOf("#")===0){var e=o.substring(1);return(e.length===3||e.length===6)&&/^[0-9A-Fa-f]{3,6}$/.test(e)}return!1}function f6(o,t){o=_n(o),o=o.replace(/[^0-9a-f]/gi,""),o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]),t=t||0;for(var e="#",i,r=0;r<3;r++)i=parseInt(o.substr(r*2,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)),e+=("00"+i.toString(16)).substr(i.toString(16).length);return e}function Ec(o,t){var e=eg(o);return e.r=parseInt(Math.floor(e.r*t).toString(),10),e.g=parseInt(Math.floor(e.g*t).toString(),10),e.b=parseInt(Math.floor(e.b*t).toString(),10),"#"+dd(e.r).toUpperCase()+dd(e.g).toUpperCase()+dd(e.b).toUpperCase()}function g6(o,t,e,i){var r=10,n="",s=2,a=t.height,l=t.width,h=o.x,c=o.y;switch(e){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(h+-l*(3/4))+" "+c+" L "+(h+l*(3/4))+" "+c,mt(i,{d:n});break;case"StepLine":i.fill="transparent",n="M "+(h+-l/2-r/4)+" "+(c+a/2)+" L "+(h+-l/2+l/10)+" "+(c+a/2)+" L "+(h+-l/2+l/10)+" "+c+" L "+(h+-l/10)+" "+c+" L "+(h+-l/10)+" "+(c+a/2)+" L "+(h+l/5)+" "+(c+a/2)+" L "+(h+l/5)+" "+(c+-a/2)+" L "+(h+l/2)+" "+(c+-a/2)+"L "+(h+l/2)+" "+(c+a/2)+" L"+(h+l/2+r/4)+" "+(c+a/2),mt(i,{d:n});break;case"UpArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+-l/2)+" "+(c+a/2)+" L "+h+" "+(c-a/2)+" L "+(h+l/2)+" "+(c+a/2)+"L "+(h+l/2-s)+" "+(c+a/2)+" L "+h+" "+(c-a/2+2*s)+"L"+(h-l/2+s)+" "+(c+a/2)+" Z",mt(i,{d:n});break;case"DownArrow":n="M "+(h-l/2)+" "+(c-a/2)+" L "+h+" "+(c+a/2)+" L "+(h+l/2)+" "+(c-a/2)+"L "+(h+l/2-s)+" "+(c-a/2)+" L "+h+" "+(c+a/2-2*s)+"L"+(h-l/2+s)+" "+(c-a/2)+" Z",mt(i,{d:n});break;case"RightArrow":n="M "+(h+-l/2)+" "+(c-a/2)+" L "+(h+l/2)+" "+c+" L "+(h+-l/2)+" "+(c+a/2)+" L "+(h+-l/2)+" "+(c+a/2-s)+" L "+(h+l/2-2*s)+" "+c+" L"+(h+-l/2)+" "+(c-a/2+s)+" Z",mt(i,{d:n});break;case"LeftArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(h+l/2)+" "+(c-a/2)+" L "+(h+-l/2)+" "+c+" L "+(h+l/2)+" "+(c+a/2)+" L "+(h+l/2)+" "+(c+a/2-s)+" L "+(h+-l/2+2*s)+" "+c+" L"+(h+l/2)+" "+(c-a/2+s)+" Z",mt(i,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(h-3*(l/5))+" "+(c-a/5)+" L "+(h+3*(-l/10))+" "+(c-a/5)+" L "+(h+3*(-l/10))+" "+(c+a/2)+" L "+(h-3*(l/5))+" "+(c+a/2)+" Z M "+(h+-l/10-l/20)+" "+(c-a/4-r/2)+" L "+(h+l/10+l/20)+" "+(c-a/4-r/2)+" L "+(h+l/10+l/20)+" "+(c+a/2)+" L "+(h+-l/10-l/20)+" "+(c+a/2)+" Z M "+(h+3*(l/10))+" "+c+" L "+(h+3*(l/5))+" "+c+" L "+(h+3*(l/5))+" "+(c+a/2)+" L "+(h+3*(l/10))+" "+(c+a/2)+" Z",mt(i,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(h+-l/2+-r/4)+" "+(c-3*(a/5))+" L "+(h+3*(l/10))+" "+(c-3*(a/5))+" L "+(h+3*(l/10))+" "+(c-3*(a/10))+" L "+(h-l/2+-r/4)+" "+(c-3*(a/10))+" Z M "+(h+-l/2+-r/4)+" "+(c-a/5+r/20)+" L "+(h+l/2+r/4)+" "+(c-a/5+r/20)+" L "+(h+l/2+r/4)+" "+(c+a/10+r/20)+" L "+(h-l/2+-r/4)+" "+(c+a/10+r/20)+" Z M "+(h-l/2+-r/4)+" "+(c+a/5+r/10)+" L "+(h+-l/4)+" "+(c+a/5+r/10)+" L "+(h+-l/4)+" "+(c+a/2+r/10)+" L "+(h-l/2+-r/4)+" "+(c+a/2+r/10)+" Z",mt(i,{d:n});break;case"Spline":i.fill="transparent",n="M "+(h-l/2)+" "+(c+a/5)+" Q "+h+" "+(c-a)+" "+h+" "+(c+a/5)+" M "+h+" "+(c+a/5)+" Q "+(h+l/2)+" "+(c+a/2)+" "+(h+l/2)+" "+(c-a/2),mt(i,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(h-l/2-r/4)+" "+(c+a/2)+" L "+(h+-l/4+-r/8)+" "+(c-a/2)+" L "+h+" "+(c+a/4)+" L "+(h+l/4+r/8)+" "+(c+-a/2+a/4)+" L "+(h+a/2+r/4)+" "+(c+a/2)+" Z",mt(i,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(h-l/2)+" "+(c+a/5)+" Q "+h+" "+(c-a)+" "+h+" "+(c+a/5)+" Z M "+h+" "+(c+a/5)+" Q "+(h+l/2)+" "+(c+a/2)+" "+(h+l/2)+" "+(c-a/2)+"  Z",mt(i,{d:n});break;case"Pie":case"Doughnut":{i.stroke="transparent";var u=Math.min(a,l)/2;n=t6(h,c,u,a,l),mt(i,{d:n});break}}return{renderOption:i}}function Js(o,t,e,i,r){var n=t,s=Xe(t,e,r).width;if(s>o){for(var a=t.length,l=a-1;l>=0;--l)if(n=i?"..."+t.substring(0,l):t.substring(0,l)+"...",s=Xe(n,e,r).width,s<=o)return n}return n}function v6(o,t,e,i){for(var r=[],n=t.split("<br>"),s=0;s<n.length;s++){t=n[s];var a=Xe(t,e,i).width;if(a>o){for(var l=t.length,h=l-1;h>=0;--h)if(t=t.substring(0,h)+"...",a=Xe(t,e,i).width,a<=o){r.push(t);break}}else r.push(t)}return r}function zi(o,t){return o!=null?o.indexOf("%")!==-1?t/100*parseInt(o,10):parseInt(o,10):null}function oo(o,t,e,i){if(!o)return null;var r=fe(t);return r&&e&&i.setElementAttributes(e,r.tagName==="clipPath"?r.childNodes[0]:r),r}function m6(o,t,e,i,r,n,s,a,l,h){r===void 0&&(r="x"),n===void 0&&(n="y"),s===void 0&&(s=0),a===void 0&&(a=new at(0,0)),l===void 0&&(l=new at(0,0));var c=o.tagName==="DIV",u=function(d,p,f,v){c?(o.style[r]=d+"px",o.style[n]=p+"px"):(o.setAttribute(r,d+""),o.setAttribute(n,p+""),s&&a.x&&a.y&&l.x&&l.y&&f&&v&&o.setAttribute("transform","rotate("+s+","+f+","+v+")"),h&&o.setAttribute("transform","translate("+f+","+v+")"))};u(e.x,e.y,l.x,l.y),new Mt({}).animate(et("div"),{duration:t,progress:function(d){u(Ur(d.timeStamp,e.x,i.x-e.x,d.duration),Ur(d.timeStamp,e.y,i.y-e.y,d.duration),Ur(d.timeStamp,l.x,a.x-l.x,d.duration),Ur(d.timeStamp,l.y,a.y-l.y,d.duration))},end:function(){u(i.x,i.y,a.x,a.y)}})}function y6(o,t,e,i,r){if(o&&e&&i){var n=function(s){return r?r.replace("{value}",s.toString()):s.toString()};new Mt({}).animate(et("div"),{duration:t,progress:function(s){o.style.animation="";var a=s.timeStamp/s.duration,l=e+(i-e)*a;e%1!==0||i%1!==0?l=parseFloat(l.toFixed(1)):l=Math.round(l),o.textContent=n(l)},end:function(){o.textContent=n(i)}})}}function vn(o,t,e,i,r,n,s,a,l,h,c,u,d,p,f,v,m,y){n===void 0&&(n=!1),l===void 0&&(l=!1);var b={},S,C,x,I,D=0,M,E=0;if(t.text.length>1&&f){for(var A=0,L=t.text.length;A<L;A++)E=Math.max(E,Xe(t.text[A],e,v).width);D=Xe(t.text[0],e,v).width}M=t.text.length>1&&f?t.x+E/2-D/2:t.x,b={id:t.id,x:M,y:t.y,fill:i||"black","font-size":e.size||v.size,"font-style":e.fontStyle||v.fontStyle,"font-family":e.fontFamily||v.fontFamily,"font-weight":e.fontWeight||v.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:e.opacity,"dominant-baseline":t.baseLine};var N=typeof t.text=="string"?t.text:n?t.text[t.text.length-1]:t.text[0],R=c?c.x:0,P=c?c.y:0,k=o.createText(b,N,R,P);if(typeof t.text!="string"&&t.text.length>1)for(var A=1,L=t.text.length;A<L;A++)C=Xe(t.text[A],e,v).height,D=Xe(t.text[A],e,v).width,x=t.y+(n?-(A*C):A*C),M=f?t.x+E/2-D/2:t.x,I=n?t.text[t.text.length-(A+1)]:t.text[A],p?S=o.createText(b,I,null,null,x,!0):(S=o.createTSpan({x:M,id:t.id,y:x},I),k.appendChild(S));return d||gt(o instanceof GI,r,k,s,a,"x","y",null,null,l,!1,null,h,!1,t.labelRotation,m,y),k}function xO(o){var t=o.element.clientWidth||o.element.offsetWidth,e=o.element.clientHeight;o.stockChart&&(t=o.stockChart.availableSize.width,e=o.stockChart.availableSize.height);var i=450,r;if(o.getModuleName()==="rangeNavigator"){var n=o,s=n.tooltip.enable?35:0,a=n.periodSelectorSettings.periods.length?n.periodSelectorSettings.height:0;r=n.margin.top+n.margin.bottom+s;var l=Xe("tempString",n.labelStyle,n.themeStyle.axisLabelFont).height,h=15;if(i=(o.series.length?j.isDevice?80:120:(n.enableGrouping?40+h+l:40)+r)+a,n.disableRangeSelector&&(i=a),o.stockChart&&o.stockChart.chart&&o.stockChart.chart.axisCollections[1].labelPosition==="Outside"){var c=o.stockChart.chart.axisCollections[1].labelPadding+o.stockChart.chart.axisCollections[1].lineStyle.width*.5;o.width=(o.stockChart.availableSize.width-(o.stockChart.chart.axisCollections[1].maxLabelSize.width+c)).toString()}}o.availableSize=new Wt(zi(o.width,t)||t||600,zi(o.height,e||i)||e||i),o.getModuleName()==="chart"&&(o.scaleX=1,o.scaleY=1)}function IO(o){o.canvasRender=new GI(o.element.id),o.renderer=o.enableCanvas?o.canvasRender:new Ih(o.element.id),xO(o),o.stockChart&&o.getModuleName()==="chart"?o.svgObject=o.stockChart.chartObject:o.stockChart&&o.getModuleName()==="rangeNavigator"&&o.stockChart.selectorObject?o.svgObject=o.stockChart.selectorObject:o.enableCanvas?o.svgObject=o.renderer.createCanvas({id:o.element.id+"_canvas",width:o.availableSize.width,height:o.availableSize.height}):(o.svgObject=o.renderer.createSvg({id:o.element.id+"_svg",width:o.availableSize.width,height:o.availableSize.height}),o.svgObject.setAttribute("aria-label","Interactive chart")),o.enableCanvas&&(o.renderer.ctx.direction=o.enableRtl?"rtl":"ltr")}function gd(o,t,e,i,r){var n=[];switch(t.textOverflow){case"Wrap":n=El(o,e,t,i,o.indexOf(" ")<0?!0:null,null,r);break;case"Trim":n.push(Js(e,o,t,i,r));break;default:n.push(o);break}return n}function Nc(o,t){var e;return t.textAlignment==="Near"?e=o.x:t.textAlignment==="Center"?e=o.x+o.width/2:e=o.x+o.width,e}function El(o,t,e,i,r,n,s,a){if(r)return b6(o,t,e,s);for(var l=o.split(" "),h="",c=[],u,d=Xe("chartMeasureText",e,s).height,p=0,f=0,v=l.length;f<v;f++){if(u=l[f],Xe(h.concat(h===""?"":" "+u),e,s).width<t)h=h.concat((h===""?"":" ")+u);else if(h!==""){if(p+=d,a&&p>a)return c[c.length-1]+="...",c;c.push(n?h:Js(t,h,e,i,s)),h=u}else{if(p+=d,a&&p>a)return c[c.length-1]+="...",c;c.push(n?u:Js(t,u,e,i,s))}if(h&&f===v-1){if(p+=d,a&&p>a)return c[c.length-1]+="...",c;c.push(n?h:Js(t,h,e,i,s))}}return c}function b6(o,t,e,i){var r=Xe(o,e,i).width,n=[];if(r>t){for(var s="",a=0,l=1;l<o.length;)s=o.substring(a,l),r=Xe(s,e,i).width,r<t?l++:r===t?(a=l,n.push(s),l++,s=""):r>t&&(s=s.slice(0,-1),a=l-1,n.push(s),s="");s.length>0&&n.push(s)}else n.push(o);return n}function WR(o,t){for(var e=o.replace(t," "),i=o.match(t),r=" ",n=" ",s=0,a={0:"\u2080",1:"\u2081",2:"\u2082",3:"\u2083",4:"\u2084",5:"\u2085",6:"\u2086",7:"\u2087",8:"\u2088",9:"\u2089"},l={0:"\u2070",1:"\xB9",2:"\xB2",3:"\xB3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079"},h=0;h<=e.length-1;h++)if(e[h]===" "){r=t===lb?i[s].replace(/~/g,""):i[s].replace(/\^/g,"");for(var c=0;c<r.length;c++)n+=t===lb?a[r[c]]:l[r[c]];s++}else n+=e[h];return n.trim()}var S6=(function(){function o(t,e){this.startValues=t,this.endValues=e}return o})(),ys=(function(o){uO(t,o);function t(e,i,r,n,s,a,l,h,c){var u=o.call(this,e,i,r.width,r.color,n,c)||this;return u.y=s.y,u.x=s.x,u.height=s.height,u.width=s.width,u.rx=a||0,u.ry=l||0,u.transform=h||"",u.stroke=r.width!==0&&u.stroke!==""?r.color===null?"":r.color:"transparent",u}return t})(Rr),ZI=(function(){function o(t,e,i,r,n,s,a,l){this.height=t,this.width=e,this.href=i,this.x=r,this.y=n,this.id=s,this.visibility=a,this.preserveAspectRatio=l}return o})(),vb=(function(o){uO(t,o);function t(e,i,r,n,s,a,l){var h=o.call(this,e,i,r.width,r.color,n)||this;return h.cy=a,h.cx=s,h.r=l,h}return t})(Rr);var at=(function(){function o(t,e){this.x=t,this.y=e}return o})();var Po=(function(){function o(t,e,i,r){this.left=t,this.right=e,this.top=i,this.bottom=r}return o})(),cb=(function(){function o(t,e,i){this.r=t,this.g=e,this.b=i}return o})(),Zf=(function(){function o(t,e,i){i===void 0&&(i=0),this.point=t,this.series=e,this.lierIndex=i}return o})(),Jf=(function(){function o(t,e,i){i===void 0&&(i=0),this.point=t,this.series=e,this.index=i}return o})();function C6(o,t){var e="",i;return Number(t)===o.start?e=o.colors[0]:Number(t)===o.end?e=o.colors[o.colors.length-1]:(i=w6(Number(t),o),e=wO(i)),e}function w6(o,t){var e=t.start,i=t.end,r=0,n=i-e,s;r=(o-e)/n;var a,l;if(t.colors.length<=2)a=t.colors[0].charAt(0)==="#"?t.colors[0]:_n(t.colors[0]),l=t.colors[t.colors.length-1].charAt(0)==="#"?t.colors[t.colors.length-1]:_n(t.colors[t.colors.length-1]);else{a=t.colors[0].charAt(0)==="#"?t.colors[0]:_n(t.colors[0]),l=t.colors[t.colors.length-1].charAt(0)==="#"?t.colors[t.colors.length-1]:_n(t.colors[t.colors.length-1]);for(var h=n/(t.colors.length-1),c=void 0,u=void 0,d=t.colors.length-1,p=[],f={},v=1;v<d;v++)u=v*h,c=e+u,f={b:c,color:t.colors[v]},p.push(f);for(var m=0;m<p.length;m++)e<=o&&o<=p[m].b&&m===0?(s=p[m].color.charAt(0)==="#"?p[m].color:_n(p[m].color),l=s,r=o<=p[m].b?1-Math.abs((o-p[m].b)/h):(o-p[m].b)/h):p[m].b<=o&&o<=i&&m===p.length-1&&(s=p[m].color.charAt(0)==="#"?p[m].color:_n(p[m].color),a=s,r=o<p[m].b?1-Math.abs((o-p[m].b)/h):(o-p[m].b)/h),m!==p.length-1&&m<p.length&&p[m].b<=o&&o<=p[m+1].b&&(s=p[m].color.charAt(0)==="#"?p[m].color:_n(p[m].color),a=s,l=p[m+1].color.charAt(0)==="#"?p[m+1].color:_n(p[m+1].color),r=Math.abs(o-p[m+1].b)/h)}return x6(r,a,l)}function x6(o,t,e){var i=e.split("#")[1],r=t.split("#")[1],n=KI(o,parseInt(r.substr(0,2),16),parseInt(i.substr(0,2),16)),s=KI(o,parseInt(r.substr(2,2),16),parseInt(i.substr(2,2),16)),a=KI(o,parseInt(r.substr(4,2),16),parseInt(i.substr(4,2),16));return new cb(n,s,a)}function KI(o,t,e){var i=e-t;return Math.round(t+i*o)}function kc(o,t){switch(o){case"Near":return t?"end":"start";case"Far":return t?"start":"end";default:return"middle"}}function JI(o){var t;switch(o){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind3":t=["#2F4074","#03B4B4","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"Tailwind3Dark":t=["#8029F1","#1ABC9C","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5Dark":case"Bootstrap5":t=["#FD7E14","#6610F2","#6F42C1","#D63384","#DC3545","#FFC107","#198754","#0DCAF0"];break;case"FluentDark":t=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Fluent":t=["#1AC9E6","#DA4CB2","#EDBB40","#AF4BCF","#FF7266","#1BD565","#EE993D","#5887FF","#EC548D","#7D39C0"];break;case"Fluent2":t=["#6200EE","#09AF74","#0076E5","#CB3587","#E7910F","#0364DE","#66CD15","#F3A93C","#107C10","#C19C00"];break;case"Fluent2Dark":t=["#9BB449","#2A72D5","#43B786","#3F579A","#584EC6","#E85F9C","#6E7A89","#EA6266","#0B6A0B","#C19C00"];break;case"Fluent2HighContrast":t=["#9BB449","#2A72D5","#43B786","#3F579A","#584EC6","#E85F9C","#6E7A89","#EA6266","#0B6A0B","#C19C00"];break;case"Material3":t=["#6355C7","#00AEE0","#FFB400","#F7523F","#963C70","#FD7400","#4BE0BC","#2196F5","#DE3D8A","#162F88"];break;case"Material3Dark":t=["#4EAAFF","#FA4EAB","#FFF500","#17EA58","#38FFE7","#FF9E45","#B3F32F","#B93CE4","#FC5664","#9B55FF"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"];break}return t}function MO(o,t,e){var i,r=o==="MaterialDark"?"#383838":o==="FabricDark"?"#242424":"#1b1b1b";switch(o){case"HighContrastLight":case"HighContrast":i={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:t?"#000000":"transparent",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939",tabColor:"#FFD939",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#FFD939",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#000000",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#000000",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#969696",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":i={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:t?r:"transparent",areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:o==="MaterialDark"?"#F4F4F4":o==="FabricDark"?"#A19F9D":"#F0F0F0",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727",tabColor:o==="MaterialDark"?"#00B0FF":o==="FabricDark"?"#0074CC":"#0070F0",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:o==="MaterialDark"?"#00B0FF":o==="FabricDark"?"#0074CC":"#0070F0",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.6)":o==="FabricDark"?"#A19F9D":"#676767",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.6)":o==="FabricDark"?"#A19F9D":"#676767",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.87)":o==="FabricDark"?"#DADADA":"#FFFFFF",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:o==="MaterialDark"?"rgba(18, 18, 18, 1)":o==="FabricDark"?"#DADADA":"#1A1A1A",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:o==="MaterialDark"?"rgba(255, 255, 255, 0.24)":o==="FabricDark"?"#6F6C6C":"#414141",fontFamily:o==="MaterialDark"?"Roboto":o==="FabricDark"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap4":i={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:t?"#FFFFFF":"transparent",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairBackground:"rgba(0, 0, 0, 0.1)",crosshairFill:"#212529",crosshairLabel:"#FFFFFF",tooltipFill:"#020202",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057",tabColor:"#007BFF",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#007BFF",toolkitFill:"#495057",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(-5,-5,26,26),chartTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#495057",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#666666",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#495057",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#212529",fontFamily:"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind3":i={axisLabel:"#4B5563",axisTitle:"#6B7280",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:"#D1D5DB",chartTitle:"#111827",legendLabel:"#4B5563",background:t?"rgba(255,255,255, 0.0)":"transparent",areaBorder:"#D1D5DB",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairBackground:"rgba(107, 114, 128, 0.1)",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#D1D5DB",markerShadow:null,selectionRectFill:"rgba(224, 231, 255, 0.25)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#4F46E5",bearFillColor:"#EF291F",bullFillColor:"#0D72DE",toolkitSelectionColor:"#212529",toolkitFill:"#6B7280",toolkitIconRectOverFill:"#F9FAFB",toolkitIconRectSelectionFill:"#F3F4F6",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#111827",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},axisLabelFont:{color:"#4B5563",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#374151",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},legendLabelFont:{color:"#4B5563",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#6B7280",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},datalabelFont:{color:"#111827",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},stripLineLabelFont:{color:"#374151",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind3Dark":i={axisLabel:"#D1D5DB",axisTitle:"#9CA3AF",axisLine:" #374151",majorGridLine:"#282F3C",minorGridLine:"#282F3C",majorTickLine:"#374151",minorTickLine:" #374151",chartTitle:"#FFFFFF",legendLabel:"#D1D5DB",background:t?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#6B7280",crosshairLine:"#6B7280",crosshairBackground:"rgba(107, 114, 128, 0.1)",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#1F2937",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#374151",markerShadow:null,selectionRectFill:"rgba(30, 27, 75, 0.25)",selectionRectStroke:"#6366F1",selectionCircleStroke:"#282727",tabColor:"#22D3EE",bearFillColor:"#EF291F",bullFillColor:"#0D72DE",toolkitSelectionColor:"#FFFFFF",toolkitFill:"#FFFFFF",toolkitIconRectOverFill:"#242A38",toolkitIconRectSelectionFill:"#242A38",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#E5E7EB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},legendLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},tooltipLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#9CA3AF",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"500"},datalabelFont:{color:"#FFFFFF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#9CA3AF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"500"},stripLineLabelFont:{color:"#E5E7EB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Tailwind":i={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:t?"rgba(255,255,255, 0.0)":"transparent",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairBackground:"rgba(90, 97, 246, 0.1)",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#4F46E5",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#4F46E5",toolkitFill:"#6B7280",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:"#374151",fontFamily:"Inter",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#374151",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F9FAFB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"TailwindDark":i={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:t?"#1f2937":"transparent",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairBackground:"rgba(90, 97, 246, 0.1)",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727",tabColor:"#22D3EE",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#22D3EE",toolkitFill:"#D1D5DB",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#9CA3AF",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#D1D5DB",fontFamily:"Inter",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#1F2937",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#6B7280",fontFamily:"Inter",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap5":i={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#DEE2E6",majorGridLine:"#E9ECEF",minorGridLine:"#E9ECEF",majorTickLine:"#DEE2E6",minorTickLine:"#E9ECEF",chartTitle:"#212529",legendLabel:"#212529",background:t?"#212529":"transparent",areaBorder:"#E9ECEF",errorBar:"#343A40",crosshairLine:"#343A40",crosshairBackground:"rgba(52, 58, 64, 0.1)",crosshairFill:"#000000",crosshairLabel:"#FFFFFF",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#FFFFFF",markerShadow:null,selectionRectFill:"rgba(134,183,254, 0.1)",selectionRectStroke:"#0D6EFD",selectionCircleStroke:"#6B7280",tabColor:"#0D6EFD",bearFillColor:"#DC3545",bullFillColor:"#6F42C1",toolkitSelectionColor:"#6E757D",toolkitFill:"#6E757D",toolkitIconRectOverFill:"#F8F9FA",toolkitIconRectSelectionFill:"#F8F9FA",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:e.getModuleName()==="accumulationchart"?"#21252980":"#212529",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"14px":"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},stripLineLabelFont:{color:"#6C757D",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Bootstrap5Dark":i={axisLabel:"#DEE2E6",axisTitle:"#DEE2E6",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:"#343A40",chartTitle:"#DEE2E6",legendLabel:"#DEE2E6",background:t?"#212529":"transparent",areaBorder:"#343A40",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#212529",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#212529",markerShadow:null,selectionRectFill:"rgba(134,183,254, 0.25)",selectionRectStroke:"#0D6EFD",selectionCircleStroke:"#0D6EFD",tabColor:"#0D6EFD",bearFillColor:"#DC3545",bullFillColor:"#6F42C1",toolkitSelectionColor:"#F8F9FA",toolkitFill:"#ADB5BD",toolkitIconRectOverFill:"#2B3035",toolkitIconRectSelectionFill:"#343A40",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:e.getModuleName()==="accumulationchart"?"#DEE2E680":"#DEE2E6",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"14px":"12px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#212529",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},stripLineLabelFont:{color:"#DEE2E6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent":i={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:t?"#FFFFFF":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairBackground:"rgba(161, 159, 157, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#A19F9D",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#3B3A39",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#49454E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#323130",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#201F1E",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#3B3A39",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#323129",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#323130",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#A19F9D",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"FluentDark":i={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#414040",minorGridLine:"#414040",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:t?"#383838":"transparent",areaBorder:"#414040",errorBar:"#D2D0CE",crosshairLine:"#D2D0CE",crosshairBackground:"rgba(161, 159, 157, 0.1)",crosshairFill:"#323130",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280",tabColor:"#0078D4",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:"#0078D4",toolkitFill:"#484644",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:"#C8C6C4",fontFamily:"Segoe UI",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#F3F2F2",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#D2D0CE",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F3F2F1",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#484644",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2":i={axisLabel:"#616161",axisTitle:"#242424",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:"#D2D0CE",chartTitle:"#242424",legendLabel:"#242424",background:t?"#383838":"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#FFFFFF",crosshairLabel:"#242424",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#242424",tooltipLightLabel:"#242424",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(180, 214, 250, 0.1)",selectionRectStroke:"#0F6CBD",selectionCircleStroke:"#0F6CBD",tabColor:"#0078D4",bearFillColor:"#E7910F",bullFillColor:"#0076E5",toolkitSelectionColor:"#424242",toolkitFill:"#424242",toolkitIconRectOverFill:"#E6E6E6",toolkitIconRectSelectionFill:"#E6E6E6",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#616161",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#616161",fontFamily:"Segoe UI",size:e.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#242424",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#616161",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2HighContrast":i={axisLabel:"#FFFFFF",axisTitle:"#FFFFFF",axisLine:"#3B3A39",majorGridLine:"#292827",minorGridLine:"#3B3A39",majorTickLine:"#292827",minorTickLine:"#292827",chartTitle:"#FFFFFF",legendLabel:"#FFFFFF",background:t?"#383838":"transparent",areaBorder:"#292827",errorBar:"#8A8886",crosshairLine:"#8A8886",crosshairBackground:"rgba(255, 255, 255, 0.1)",crosshairFill:"#000000",crosshairLabel:"#FFFFFF",tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(26, 235, 255, 0.2)",selectionRectStroke:"#1AEBFF",selectionCircleStroke:"#1AEBFF",tabColor:"#0078D4",bearFillColor:"#584EC6",bullFillColor:"#43B786",toolkitSelectionColor:"#FFFFFF",toolkitFill:"#FFFFFF",toolkitIconRectOverFill:"#1AEBFF",toolkitIconRectSelectionFill:"#1AEBFF",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:e.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Fluent2Dark":i={axisLabel:"#ADADAD",axisTitle:"#FFFFFF",axisLine:"#3B3A39",majorGridLine:"#3B3A39",minorGridLine:"#3B3A39",majorTickLine:"#292827",minorTickLine:"#292827",chartTitle:"#FFFFFF",legendLabel:"#FFFFFF",background:t?"#383838":"transparent",areaBorder:"#292827",errorBar:"#8A8886",crosshairLine:"#8A8886",crosshairBackground:"rgba(138, 136, 134, 0.1)",crosshairFill:"#292929",crosshairLabel:"#FFFFFF",tooltipFill:"#292929",tooltipBoldLabel:"#FFFFFF",tooltipLightLabel:"#FFFFFF",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(14, 71, 117, 0.1)",selectionRectStroke:"#115EA3",selectionCircleStroke:"#115EA3",tabColor:"#0078D4",bearFillColor:"#584EC6",bullFillColor:"#43B786",toolkitSelectionColor:"#D6D6D6",toolkitFill:"#D6D6D6",toolkitIconRectOverFill:"#333333",toolkitIconRectSelectionFill:"#333333",toolkitIconRect:new Le(-6,-8,32,32),chartTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:e.getModuleName()==="accumulationchart"?"16px":"14px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:e.getModuleName()==="chart"?"12px":"14px",fontStyle:"Normal",fontWeight:"600"},crosshairLabelFont:{color:"#FFFFFF",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"700"},stripLineLabelFont:{color:"#ADADAD",fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Material3":i={axisLabel:"#1E192B",axisTitle:"#1C1B1F",axisLine:"#C4C7C5",majorGridLine:"#C4C7C5",minorGridLine:"#C4C7C5",majorTickLine:"#C4C7C5",minorTickLine:" #C4C7C5",chartTitle:"#1C1B1F",legendLabel:"#49454E",background:t?"#FFFFFF":"transparent",areaBorder:"#E7E0EC",errorBar:"#79747E",crosshairLine:"#49454E",crosshairBackground:"rgba(73, 69, 78, 0.1)",crosshairFill:"#313033",crosshairLabel:"#F4EFF4",tooltipFill:"#313033",tooltipBoldLabel:"#F4EFF4",tooltipLightLabel:"#F4EFF4",tooltipHeaderLine:"#F4EFF4",markerShadow:null,selectionRectFill:"rgb(98, 0, 238, 0.06)",selectionRectStroke:"#6200EE",selectionCircleStroke:"#79747E",tabColor:"#49454E",bearFillColor:"#5887FF",bullFillColor:"#F7523F",toolkitSelectionColor:"#49454E",toolkitFill:"#49454E",toolkitIconRectOverFill:"#EADDFF",toolkitIconRectSelectionFill:"#EADDFF",toolkitIconRect:new Le(-4,-5,26,26),histogram:"#D21020",chartTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#1E192B",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#49454E",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#F4EFF4",fontFamily:"Roboto",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#1C1B1F",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#49454E",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#49454E",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#F4EFF4",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#79747E",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;case"Material3Dark":i={axisLabel:"#E6E1E5",axisTitle:"#E6E1E5",axisLine:"#49454F",majorGridLine:"#444746",minorGridLine:"#444746",majorTickLine:"#444746",minorTickLine:" #444746",chartTitle:"#E6E1E5",legendLabel:"#CAC4D0",background:t?"#FFFFFF":"transparent",areaBorder:"#49454F",errorBar:"#938F99",crosshairLine:"#CAC4D0",crosshairBackground:"rgba(73, 69, 78, 0.1)",crosshairFill:"#E6E1E5",crosshairLabel:"#313033",tooltipFill:"#E6E1E5",tooltipBoldLabel:"#313033",tooltipLightLabel:"#313033",tooltipHeaderLine:"#313033",markerShadow:null,selectionRectFill:"rgba(78, 170, 255, 0.06)",selectionRectStroke:"#4EAAFF",selectionCircleStroke:"#938F99",tabColor:"#CAC4D0",bearFillColor:"#B3F32F",bullFillColor:"#FF9E45",toolkitSelectionColor:"#CAC4D0",toolkitFill:"#CAC4D0",toolkitIconRectOverFill:"#4F378B",toolkitIconRectSelectionFill:"#4F378B",toolkitIconRect:new Le(-4,-5,26,26),histogram:"#FF9E45",chartTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:"#FFFFFFE6",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:"#313033",fontFamily:"Roboto",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:"#E6E1E5",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:"#CAC4D0",fontFamily:"Roboto",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:"#313033",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:"#938F99",fontFamily:"Roboto",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break;default:i={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:t?"#FFFFFF":"transparent",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairBackground:"rgba(0, 0, 0, 0.1)",crosshairFill:o==="Material"?"#000816":o==="Fabric"?"#FFFFFF":"#212529",crosshairLabel:"#e5e5e5",tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2",tabColor:o==="Material"?"#ff4081":o==="Fabric"?"#0078D6":"#317AB9",bearFillColor:"#2ecd71",bullFillColor:"#e74c3d",toolkitSelectionColor:o==="Material"?"#ff4081":o==="Fabric"?"#0078D6":"#317AB9",toolkitFill:"#737373",toolkitIconRectOverFill:"transparent",toolkitIconRectSelectionFill:"transparent",toolkitIconRect:new Le(0,0,16,16),chartTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"16px",fontStyle:"Normal",fontWeight:"600"},axisLabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":o==="Fabric"?"#666666":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},legendTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},legendLabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":"#666666",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},tooltipLabelFont:{color:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal"},axisTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"600"},datalabelFont:{color:o==="Material"?"rgba(97, 97, 97, 1)":o==="Fabric"?"#666666":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},chartSubTitleFont:{color:o==="Material"?"rgba(0, 0, 0, 1)":o==="Fabric"?"#333333":"#212529",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"14px",fontStyle:"Normal",fontWeight:"400"},crosshairLabelFont:{color:o==="Material"?"rgba(249, 250, 251, 1)":o==="Fabric"?"#333333":"#F9FAFB",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"},stripLineLabelFont:{color:o==="Material"?"rgba(158, 158, 158, 1)":o==="Fabric"?"#A6A6A6":"#676767",fontFamily:o==="Material"?"Roboto":o==="Fabric"?"Segoe UI":"Helvetica",size:"12px",fontStyle:"Normal",fontWeight:"400"}};break}return i}var qR=10,I6=(function(){function o(t){this.chart=t,this.padding=5}return o.prototype.measureAxis=function(t){var e=this.chart,i=e.chartArea.width?zi(e.chartArea.width,e.availableSize.width):null;this.crossAt(e),this.seriesClipRect=new Le(t.x,t.y,t.width,t.height),this.initialClipRect=t,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(e,this.initialClipRect),this.initialClipRect=zo(this.initialClipRect,new Po(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(e,this.initialClipRect),this.initialClipRect=zo(this.initialClipRect,new Po(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(e,this.initialClipRect),this.seriesClipRect=zo(this.seriesClipRect,new Po(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(e,this.initialClipRect),this.seriesClipRect=zo(this.seriesClipRect,new Po(0,0,this.topSize,this.bottomSize)),i&&this.calculateFixedChartArea(e,i),this.chart.delayRedraw||(e.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},o.prototype.calculateFixedChartArea=function(t,e){this.seriesClipRect.width=e,this.seriesClipRect.x=t.availableSize.width-t.margin.right-e-(t.legendSettings.position==="Right"?t.legendModule.legendBounds.width:0);for(var i=0,r=t.rows;i<r.length;i++){var n=r[i];this.seriesClipRect.x-=gn(n.farSizes)}},o.prototype.measureRowAxis=function(t,e){var i;this.calculateRowSize(e);for(var r=0,n=t.rows;r<n.length;r++){var s=n[r];i=s,i.nearSizes=[],i.farSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,t,new Wt(t.availableSize.width,i.computedHeight)),this.leftSize<gn(i.nearSizes)&&(this.leftSize=gn(i.nearSizes)),this.rightSize<gn(i.farSizes)&&(this.rightSize=gn(i.farSizes))}},o.prototype.measureColumnAxis=function(t,e){var i;this.calculateColumnSize(e);for(var r=0,n=t.columns;r<n.length;r++){var s=n[r];i=s,i.farSizes=[],i.nearSizes=[],i.insideNearSizes=[],i.insideFarSizes=[],this.arrangeAxis(i),this.measureDefinition(i,t,new Wt(i.computedWidth,t.availableSize.height)),this.bottomSize<gn(i.nearSizes)&&(this.bottomSize=gn(i.nearSizes)),this.topSize<gn(i.farSizes)&&(this.topSize=gn(i.farSizes))}},o.prototype.measureDefinition=function(t,e,i){for(var r,n=0,s=t.axes;n<s.length;n++){var a=s[n];r=a.scrollbarSettings.height,a.scrollBarHeight=e.scrollBarModule&&e.zoomModule&&e.zoomSettings.enableScrollbar&&a.enableScrollbarOnZooming&&e.zoomModule.isZoomed&&(a.zoomFactor<1||a.zoomPosition>0)?r:0,a.scrollBarHeight=e.scrollBarModule&&(e.zoomModule&&e.zoomSettings.enableScrollbar&&a.enableScrollbarOnZooming&&e.zoomModule.isZoomed&&(a.zoomFactor<1||a.zoomPosition>0)||a.scrollbarSettings.enable)?r:0,a.getModule(e),a.baseModule.calculateRangeAndInterval(i,a),t.computeSize(a,a.scrollBarHeight,t,e)}t.farSizes.length>0&&(t.farSizes[t.farSizes.length-1]-=qR),t.nearSizes.length>0&&(t.nearSizes[t.nearSizes.length-1]-=qR)},o.prototype.calculateAxisSize=function(t){var e=this.chart,i,r,n,s,a=0,l=0,h=0,c,u,d;this.calculateRowSize(t);for(var p=!1,f=0,v=e.rows.length;f<v;f++){i=e.rows[f],a=0,l=0;for(var m=0,y=i.axes.length;m<y;m++){if(s=i.axes[m],d=s.plotOffset,s.rect.height===0){s.rect.height=i.computedHeight,h=0;for(var b=f+1,S=f+s.span;b<S;b++)n=e.rows[b],h+=n.computedHeight;s.rect.y=i.computedTop-h+(s.plotOffsetTop?s.plotOffsetTop:d),s.rect.height=s.rect.height+h-this.getAxisOffsetValue(s.plotOffsetTop,s.plotOffsetBottom,s.plotOffset),s.rect.width=0}s.name==="primaryYAxis"&&s.labelPosition==="Outside"&&(p=!0),s.isAxisOpposedPosition?(s.labelPosition==="Inside"&&s.orientation==="Vertical"?l>0?c=t.x+t.width+gn(ao(i.farSizes,l))+s.maxLabelSize.width+s.multiLevelLabelHeight+(s.tickPosition==="Inside"?s.majorTickLines.height:0)+s.labelPadding:c=t.x+t.width-gn(ao(i.insideFarSizes,l)):c=t.x+t.width+gn(ao(i.farSizes,l)),s.rect.x=s.rect.x>=c?s.rect.x:c,l++):(s.labelPosition==="Inside"&&s.orientation==="Vertical"?c=t.x+gn(ao(i.insideNearSizes,p?a-1:a)):c=t.x-gn(ao(i.nearSizes,a)),s.rect.x=s.rect.x<=c?s.rect.x:c,a++)}}this.calculateColumnSize(t);for(var f=0,v=e.columns.length;f<v;f++){r=e.columns[f],a=0,l=0;for(var m=0,C=r.axes.length;m<C;m++){if(s=r.axes[m],d=s.plotOffset,s.rect.width===0){for(var b=f,x=f+s.span;b<x;b++)n=e.columns[b],s.rect.width+=n.computedWidth;s.rect.x=r.computedLeft+(s.plotOffsetLeft?s.plotOffsetLeft:d),s.rect.width-=this.getAxisOffsetValue(s.plotOffsetLeft,s.plotOffsetRight,s.plotOffset),s.rect.height=0}s.isAxisOpposedPosition?(s.labelPosition==="Inside"&&s.orientation==="Horizontal"?l>0?u=t.y-gn(ao(r.farSizes,l))-s.maxLabelSize.height-s.multiLevelLabelHeight-(s.tickPosition==="Inside"?s.majorTickLines.height:0)-s.labelPadding:u=t.y+gn(ao(r.insideFarSizes,l)):u=t.y-gn(ao(r.farSizes,l)),s.rect.y=s.rect.y<=u?s.rect.y:u,l++):(s.labelPosition==="Inside"&&s.orientation==="Horizontal"?a>0?u=t.y+t.height+gn(ao(r.nearSizes,a))+s.maxLabelSize.height+s.multiLevelLabelHeight+(s.tickPosition==="Inside"?s.majorTickLines.height:0)+s.labelPadding:u=t.y+t.height-gn(ao(r.insideNearSizes,a)):u=t.y+t.height+gn(ao(r.nearSizes,a)),s.rect.y=s.rect.y>=u?s.rect.y:u,a++)}}},o.prototype.measure=function(){for(var t=this.chart,e,i,r,n,s,a=0,l=t.axisCollections;a<l.length;a++){var h=l[a];if(h.orientation==="Vertical"){t.verticalAxes.push(h),n=this.getActualRow(h),e=t.rows[n],this.pushAxis(e,h),s=n+h.span>t.rows.length?t.rows.length:n+h.span;for(var c=n+1;c<s;c++)r=t.rows[c],r.axes[e.axes.length-1]=h,t.rows[c]=r;t.rows[n]=e}else{t.horizontalAxes.push(h),n=this.getActualColumn(h),i=t.columns[n],this.pushAxis(i,h),s=n+h.span>t.columns.length?t.columns.length:n+h.span;for(var c=n+1;c<s;c++)r=t.columns[c],r.axes[i.axes.length-1]=h,t.columns[c]=r;t.columns[n]=i}h.isRTLEnabled=t.enableRtl,h.setIsInversedAndOpposedPosition()}},o.prototype.getAxisOffsetValue=function(t,e,i){var r=t?t+(e||i):e?e+i:2*i;return r},o.prototype.crossAt=function(t){for(var e=0,i=t.axisCollections;e<i.length;e++){var r=i[e];if(r.crossesAt!==null)if(r.crossesInAxis){for(var n=2,s=t.axisCollections.length;n<s;n++)if(r.crossesInAxis===t.axisCollections[n].name){r.crossInAxis=t.axisCollections[n],r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}else{t.requireInvertedAxis?r.crossInAxis=r.orientation==="Horizontal"?t.primaryXAxis:t.primaryYAxis:r.crossInAxis=r.orientation==="Horizontal"?t.primaryYAxis:t.primaryXAxis,r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}},o.prototype.updateCrossAt=function(t,e){switch(t.valueType){case"DateTime":{var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);return Date.parse(r(n(new Date(ge.parse.parseJson({val:e}).val))))}case"Category":return parseFloat(e)?parseFloat(e):t.labels.indexOf(e);case"Logarithmic":return Tl(e,t.logBase);default:return e}},o.prototype.pushAxis=function(t,e){for(var i=0,r=t.axes.length;i<=r;i++)if(!t.axes[i]){t.axes[i]=e;break}},o.prototype.arrangeAxis=function(t){for(var e=[],i=0,r=t.axes.length;i<=r;i++)t.axes[i]&&e.push(t.axes[i]);t.axes=e},o.prototype.getActualColumn=function(t){var e=this.chart.columns.length,i=t.columnIndex,r=i>=e?e-1:i<0?0:i;return r},o.prototype.getActualRow=function(t){var e=this.chart.rows.length,i=t.rowIndex,r=i>=e?e-1:i<0?0:i;return r},o.prototype.calculateRowSize=function(t){for(var e=this.chart,i,r=t.y+t.height,n=0,s=Math.max(0,t.height),a=0,l=e.rows.length;a<l;a++)i=e.rows[a],i.height.indexOf("%")!==-1?n=Math.min(s,t.height*parseInt(i.height,10)/100):n=Math.min(s,parseInt(i.height,10)),n=a!==l-1?n:s,i.computedHeight=n,r-=n,i.computedTop=r,s-=n},o.prototype.calculateColumnSize=function(t){for(var e=this.chart,i,r=t.x,n=0,s=Math.max(0,t.width),a=0,l=e.columns.length;a<l;a++)i=e.columns[a],i.width.indexOf("%")!==-1?n=Math.min(s,t.width*parseInt(i.width,10)/100):n=Math.min(s,parseInt(i.width,10)),n=a!==l-1?n:s,i.computedWidth=n,i.computedLeft=r,r+=n,s-=n},o.prototype.renderAxes=function(){var t=this.chart,e,i=t.renderer.createGroup({id:t.element.id+"AxisInsideCollection"}),r=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"});r&&r.setAttribute("aria-hidden","true");var n,s;t.scrollBarModule&&(t.scrollBarModule.topScrollBarCount=0,t.scrollBarModule.bottomScrollBarCount=0,t.scrollBarModule.leftScrollBarCount=0,t.scrollBarModule.rightScrollBarCount=0);for(var a=0,l=t.axisCollections.length;a<l;a++){var h=!0;e=t.axisCollections[a],e.index=a,this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+a+"Inside"}),this.element&&this.element.setAttribute("aria-hidden","true"),n=t.renderer.createGroup({id:t.element.id+"AxisGroup"+a+"Outside"}),n&&n.setAttribute("aria-hidden","true");for(var c=0,u=e.series;c<u.length;c++){var d=u[c];if(e.name===d.yAxisName||e.name===d.xAxisName){if(h=d.visible,d.category==="Pareto"&&!d.paretoOptions.showAxis&&d.type==="Line"&&(h=!1),h)break;continue}}if(!h){e.zoomingScrollBar&&e.zoomingScrollBar.removeScrollSvg();continue}s=this.findAxisPosition(e),this.drawAxis(e,a,s,n,i,r)}return this.drawPaneLines(t,i),gt(t.enableCanvas,t.svgObject,i,t.redraw),r},o.prototype.renderScrollbar=function(t,e){var i=g(t.zoomModule)?!1:t.zoomModule.isZoomed;if(e.zoomingScrollBar||t.scrollBarModule.injectTo(e,t),(i&&(e.zoomFactor<1||e.zoomPosition>0)||e.scrollbarSettings.enable&&(e.zoomFactor<=1||e.zoomPosition>=0))&&!e.zoomingScrollBar.isScrollUI)t.scrollElement||(t.scrollElement=oo(t.redraw,t.element.id+"_scrollElement")||et("div",{id:t.element.id+"_scrollElement"})),gt(!1,t.scrollElement,e.zoomingScrollBar.render(!0),!0);else if(e.zoomFactor===1&&e.zoomPosition===0&&e.zoomingScrollBar.svgObject&&!e.scrollbarSettings.enable)e.zoomingScrollBar.destroy();else if(e.zoomingScrollBar.svgObject){var r=(e.isAxisOpposedPosition&&e.orientation==="Horizontal"?-16:0)+e.rect.y+Math.max(.5,e.lineStyle.width/2),n=(e.isAxisOpposedPosition&&e.orientation!=="Horizontal"?16:0)+(e.rect.x-(e.orientation==="Horizontal"&&e.scrollbarSettings.enableZoom?e.zoomingScrollBar.svgExtraWidth/2:0))-(e.orientation==="Vertical"?e.scrollbarSettings.height:0);e.orientation!=="Horizontal"&&(e.scrollbarSettings.position==="Left"||e.scrollbarSettings.position==="Right")?n=HR(e.zoomingScrollBar,!1):e.orientation==="Horizontal"&&(e.scrollbarSettings.position==="Top"||e.scrollbarSettings.position==="Bottom")&&(r=HR(e.zoomingScrollBar,!0)),e.zoomingScrollBar.svgObject.style.top=r+"px",e.zoomingScrollBar.svgObject.style.left=n+"px"}e.zoomingScrollBar.isScrollUI&&(e.zoomingScrollBar.isScrollUI=!1)},o.prototype.drawPaneLines=function(t,e){this.element=t.renderer.createGroup({id:t.element.id+"DefinitionLine"});for(var i=0,r=t.rows.length;i<r;i++){var n=t.rows[i];n.border.color&&this.drawBottomLine(n,i,!0)}for(var i=0,r=t.columns.length;i<r;i++){var s=t.columns[i];s.border.color&&this.drawBottomLine(s,i,!1)}e=e||fe(t.element.id+"AxisInsideCollection"),this.chart.enableCanvas||e.appendChild(this.element)},o.prototype.drawAxis=function(t,e,i,r,n,s){t.updateCrossValue();var a="";t.orientation==="Horizontal"?(t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,e,t.plotOffset,0,0,0,t.plotOffsetLeft,t.plotOffsetRight,i?r:this.element,t.updatedRect),a="X"):(t.visible&&t.internalVisibility&&t.lineStyle.width>0&&this.drawAxisLine(t,e,0,t.plotOffset,t.plotOffsetBottom,t.plotOffsetTop,0,0,i?r:this.element,t.updatedRect),a="Y"),(t.majorGridLines.width>0||t.majorTickLines.width>0||t.minorTickLines.width>0||t.minorGridLines.width>0)&&this["draw"+a+"AxisGridLine"](t,e,i||t.tickPosition==="Inside"?r:this.element,t.updatedRect),t.visible&&t.internalVisibility&&(this["draw"+a+"AxisLabels"](t,e,i||t.labelPosition==="Inside"?r:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this["draw"+a+"AxisBorder"](t,e,i||t.labelPosition==="Inside"?r:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect),this["draw"+a+"AxisTitle"](t,e,i?r:this.element,t.placeNextToAxisLine?t.updatedRect:t.rect)),this.chart.enableCanvas||(n.appendChild(this.element),r&&r.childNodes.length>0&&s.appendChild(r)),this.chart.scrollBarModule&&(this.chart.zoomSettings.enableScrollbar&&t.enableScrollbarOnZooming||t.scrollbarSettings.enable)?this.renderScrollbar(this.chart,t):t.zoomingScrollBar&&t.zoomingScrollBar.destroy()},o.prototype.findAxisPosition=function(t){return t.crossAt!==null&&t.isInside(t.crossInAxis.visibleRange)},o.prototype.drawBottomLine=function(t,e,i){var r=this.chart,n={},s,a,l,h,c;i?(t=t,l=h=t.computedTop+t.computedHeight,s=this.seriesClipRect.x,a=s+this.seriesClipRect.width,c="Row"):(t=t,s=a=t.computedLeft,l=this.seriesClipRect.y,h=l+this.seriesClipRect.height,c="Column"),n={id:r.element.id+"_AxisBottom_"+c+e,x1:s,y1:l,x2:a,y2:h,"stroke-width":t.border.width,stroke:t.border.color},this.htmlObject=r.renderer.drawLine(n),gt(r.enableCanvas,this.element,this.htmlObject)},o.prototype.drawAxisLine=function(t,e,i,r,n,s,a,l,h,c){var u=this.chart,d={},p=fe(u.element.id+"AxisLine_"+e),f=p?p.getAttribute("d"):"";p=null,d={id:u.element.id+"AxisLine_"+e,d:"M "+(c.x-i-a)+" "+(c.y-r-s)+" L "+(c.x+c.width+i+l)+" "+(c.y+c.height+r+n),"stroke-dasharray":t.lineStyle.dashArray,"stroke-width":t.lineStyle.width,stroke:t.lineStyle.color||u.themeStyle.axisLine},this.htmlObject=u.renderer.drawPath(d),gt(u.enableCanvas,h,this.htmlObject,u.redraw,!0,"x","y",null,f,null,null,null,u.duration)},o.prototype.drawYAxisGridLine=function(t,e,i,r){var n=t.valueType==="Logarithmic",s=t.valueType.indexOf("Category")>-1,a,l=0,h="",c="",u,d=t.isAxisOpposedPosition,p=d?t.majorTickLines.height:-t.majorTickLines.height,f=d?t.lineStyle.width*.5:-t.lineStyle.width*.5,v=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?.5:0,m=g(t.crossesAt)&&t.scrollbarSettings.position!=="Right"&&t.scrollbarSettings.position!=="Left"?d?t.scrollBarHeight:-t.scrollBarHeight:0,y=t.tickPosition==="Inside",b=y?r.x-p-f:r.x+p+f+m,S=t.visibleLabels.length,C=this.chart.themeStyle,x=1;t.valueType.indexOf("Category")>-1&&t.labelPlacement==="BetweenTicks"&&S>0&&!this.chart.stockChart&&(S+=1);for(var I=t.minorGridLines,D=t.minorTickLines,M=0;M<S;M++)a=t.visibleLabels[M]?t.visibleLabels[M].value-v:t.visibleLabels[M-1].value+t.visibleRange.interval-v,l=Un(a,t)*r.height,l=l*-1+(r.y+r.height),l>=r.y&&r.y+r.height>=l&&(this.chart.redraw&&!this.chart.enableCanvas&&this.chart.zoomRedraw&&t.visible&&t.majorGridLines.width&&M!==0&&!fe(this.chart.element.id+"_MajorGridLine_"+e+"_"+M)&&(h="M "+this.seriesClipRect.x+" "+(this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(M||1)*x:-(this.seriesClipRect.height/(M||1)*x)))+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+(this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(M||1)*x:-(this.seriesClipRect.height/(M||1)*x))),this.updateAxisElement(t,e,h,M,"_MajorGridLine_",this.element,!1),fe(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1])),(Kf(a,t.visibleRange)||this.isBorder(t,M,l))&&(h="M "+this.seriesClipRect.x+" "+l+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+l,this.renderGridLine(t,e,h,t.majorGridLines,"_MajorGridLine_",M,this.element,C.majorGridLine,t.majorGridLines.dashArray)),this.chart.redraw&&this.chart.zoomRedraw&&t.majorTickLines.width&&M!==0&&!fe(this.chart.element.id+"_MajorTickLine_"+e+"_"+M)&&!this.chart.enableCanvas&&t.visible&&(c="M "+this.seriesClipRect.x+" "+(this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(M||1)*x:-(this.seriesClipRect.height/(M||1)*x)))+" L "+b+" "+(this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(M||1)*x:-(this.seriesClipRect.height/(M||1)*x))),this.updateAxisElement(t,e,c,M,"_MajorTickLine_",i,!1),fe(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1]),x+=1),c="M "+(r.x+f+(y?m:0))+" "+l+" L "+b+" "+l,this.renderGridLine(t,e,c,t.majorTickLines,"_MajorTickLine_",M,i,C.majorTickLine),(I.width>0||D.width>0)&&t.minorTicksPerInterval>0&&(M===0&&ud(t)&&!n&&!s&&this.renderMinorGridOnZooming(t,a,r,M,e,C,i),u=this.drawAxisMinorLine(t,a,r,M),this.renderGridLine(t,e,u[0],I,"_MinorGridLine_",M,this.element,C.minorGridLine,I.dashArray),this.renderGridLine(t,e,u[1],D,"_MinorTickLine_",M,i,C.minorTickLine),M===S-1&&ud(t)&&n&&!s&&this.renderMinorGridOnZooming(t,a+t.visibleRange.interval,r,M,e,C,i)));if(S&&this.previousYLabel>S&&!this.chart.enableCanvas&&t.visible&&this.chart.zoomRedraw&&this.chart.redraw)for(var M=S;M<this.previousYLabel;M++){var E=this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height/S*(M-S+1)+this.seriesClipRect.height:-(this.seriesClipRect.height/S*(M-S+1)));t.majorGridLines.width&&(h="M "+this.seriesClipRect.x+" "+ +E+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+E,this.updateAxisElement(t,e,h,M,"_MajorGridLine_",this.element,!0)),t.majorTickLines.width&&(c="M "+this.seriesClipRect.x+" "+E+" L "+b+" "+E,this.updateAxisElement(t,e,c,M,"_MajorTickLine_",i,!0))}},o.prototype.isBorder=function(t,e,i){var r=this.chart.chartArea.border,n=this.seriesClipRect,s=t.orientation,a=s==="Horizontal"?n.x:n.y,l=s==="Horizontal"?n.width:n.height,h=s==="Horizontal"?0:t.visibleLabels.length-1,c=s==="Horizontal"?t.visibleLabels.length-1:0;return t.plotOffset>0||(i===a||i===a+l)&&(r.width<=0||r.color==="transparent")?!0:i!==a&&e===h||i!==a+l&&e===c},o.prototype.drawYAxisLabels=function(t,e,i,r){var n=this.chart,s,a=0,l=0,h,c=t.labelPadding,u,d,p=t.labelPosition==="Inside",f=t.isAxisOpposedPosition,v,m=t.labelPosition===t.tickPosition?t.majorTickLines.height:0,y=m+c+t.lineStyle.width*.5,b=t.angle%360,S=b===-90||b===90||b===270||b===-270;y+=S?p?5:-5:0,y=f?y:-y;var C=n.renderer.createGroup({id:n.element.id+"AxisLabels"+e}),x=g(t.crossesAt)&&t.scrollbarSettings.position!=="Left"&&t.scrollbarSettings.position!=="Right"?t.scrollBarHeight*(f?1:-1):0,I,D,M,E=10,A=t.isAxisInverse,L=1,N=A?r.y:r.y+r.height,R,P,k,B,F=!f&&!p||f&&p;p?R=F?y:-y:R=F?y+(n.enableRtl?-x:x):-y+(n.enableRtl?-x:x);var O=[],z=[];t.visibleLabels.map(function(ue){O.push(ue.size.width),z.push(ue.breakLabelSize.width)});var Y=Math.max.apply(Math,O),K=Math.max.apply(Math,z);v=Y,b>=-45&&b<=45&&b!==0&&(v=Y*Math.cos(b*Math.PI/180),v<0&&(v=-v));for(var U=0,q=t.visibleLabels.length;U<q;U++){switch(s=t.visibleLabels[U],d=Lc(t.visibleLabels[U].originalText),h=d?t.visibleLabels[U].breakLabelSize:t.visibleLabels[U].size,l=Un(t.visibleLabels[U].value,t)*r.height+(n.stockChart&&t.labelPosition!=="Outside"?7:0),l=Math.floor(l*-1+(r.y+r.height)),I=h.height/8*t.visibleLabels[U].text.length/2,D=n.requireInvertedAxis&&t.labelPosition==="Inside"?0:h.height/4*3+3,P=r.height/t.visibleLabels.length,k=(t.labelIntersectAction==="Trim"||t.labelIntersectAction==="Wrap")&&b!==0&&h.width>P?P:h.width,l=d?t.labelPosition==="Inside"?l-h.height/2-I+D:l-I:t.labelPosition==="Inside"?l+D:l,t.labelPosition==="Inside"&&(U===0&&!t.isInversed||U===q-1&&t.isInversed)&&(n.stockChart?l-=D:l-=D-(n.requireInvertedAxis&&t.labelPosition==="Inside"?0:t.opposedPosition?-y:y)),t.majorGridLines.width>t.majorTickLines.width?M=t.majorGridLines.width:M=t.majorTickLines.width,t.labelStyle.textAlignment==="Far"?l=l-M-E:t.labelStyle.textAlignment==="Near"&&(l=l+M+E),p?B=R+(b===0?h.width:d?K:Y)/2:B=R-(b===0?h.width:d?K:v)/2,t.enableWrap&&n.requireInvertedAxis&&b&&(!t.opposedPosition&&t.labelPosition==="Inside"||t.opposedPosition&&t.labelPosition==="Outside")&&(B=t.opposedPosition?B-Y/2:B+Y/2),a=f?t.scrollBarHeight!==0&&t.scrollbarSettings.position!=="Right"&&t.scrollbarSettings.position!=="Left"?r.x+t.scrollBarHeight+y-B:r.x-B:r.x+B,S&&(a+=f?5:-5),B=R,u=new bn(n.element.id+e+"_AxisLabel_"+U,a,l,"middle",s.text,"","middle",b),t.edgeLabelPlacement){case"None":break;case"Hide":((U===0||A&&U===q-1)&&u.y>r.y||(U===q-1||A&&U===0)&&u.y-h.height*.5<r.y)&&(u.text="");break;case"Shift":(U===0||A&&U===q-1)&&u.y>r.y+r.height?u.y=l=r.y+r.height:(U===q-1||A&&U===0)&&u.y<=0&&(u.y=l=r.y+h.height*.5);break}var ae=u.y,te=u.y-k;if(d&&(ae=u.y-k/2,te=u.y+k/2),!((b===90||b===270)&&t.labelIntersectAction==="Hide"&&U!==0&&(A?te<=N:ae>=N))){if(N=A?ae:te,u.transform="rotate("+b+","+a+","+l+")",this.chart.redraw&&this.chart.zoomRedraw&&!fe(u.id)&&!this.chart.enableCanvas&&t.visible){var he=u.y;u.y=this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/(U||1)*L:-(this.seriesClipRect.height/(U||1)*L)),this.updateAxisElement(t,e,"",U,"_AxisLabel_",C,!1,u,s),u.y=he,L+=1}vn(n.renderer,u,s.labelStyle,s.labelStyle.color||n.themeStyle.axisLabelFont.color,C,!1,n.redraw,!0,!0,n.duration,null,null,null,n.enableCanvas,null,n.themeStyle.axisLabelFont,new at(a,l))}}if(this.previousYLabel&&t.visibleLabels.length&&this.previousYLabel>t.visibleLabels.length&&!this.chart.enableCanvas&&t.visible&&this.chart.zoomRedraw&&n.redraw&&u.text)for(var U=t.visibleLabels.length;U<this.previousYLabel;U++)u.y=this.seriesClipRect.y+(t.isInversed?this.seriesClipRect.height+this.seriesClipRect.height/t.visibleLabels.length*(U-t.visibleLabels.length+1):-(this.seriesClipRect.height/t.visibleLabels.length*(U-t.visibleLabels.length+1))),u.id=n.element.id+e+"_AxisLabel_"+U,this.updateAxisElement(t,e,"",U,"_AxisLabel_",C,!0,u,s);else this.previousYLabel=t.visibleLabels.length;this.chart.enableCanvas||(n.delayRedraw?t.visible&&t.internalVisibility&&this.createZoomingLabel(this.chart,C,t,e,r):gt(n.enableCanvas,i,C,n.redraw))},o.prototype.rangeAnimate=function(t,e,i,r,n,s,a){var l=this;e&&new Mt({}).animate(e,{duration:i,progress:function(){var h=fe(e.id);if(h.style.animation="",r)Pi(parseFloat(h.getAttribute("x")),parseFloat(h.getAttribute("y")),n)?h.style.visibility="visible":h.style.visibility="hidden";else{var c=h.getAttribute("d").split(" ");Pi(parseFloat(c[1]),parseFloat(c[2]),n)?h.style.visibility="visible":h.style.visibility="hidden"}},end:function(){var h=fe(e.id);h.style.visibility="",s&&a>=t.visibleLabels.length&&(zt(h),r&&(t.orientation==="Vertical"?l.previousYLabel=t.visibleLabels.length:l.previousXLabel=t.visibleLabels.length))}})},o.prototype.getAxisLabelXvalue=function(t,e,i){var r=e.lineBreakAlignment,n=e.labelPosition==="Inside",s=e.isAxisOpposedPosition;return s&&n||!s&&!n?r==="Right"?t:r==="Center"?t-i/2:t-i:r==="Left"?t:r==="Center"?t+i/2:t+i},o.prototype.drawYAxisBorder=function(t,e,i,r){if(t.border.width>0){var n=void 0,s=void 0,a=t.labelPosition==="Outside"&&t.scrollbarSettings.position!=="Right"&&t.scrollbarSettings.position!=="Left"?t.scrollBarHeight:0,l=t.isAxisOpposedPosition;a=(l?1:-1)*a;for(var h=r.height/t.visibleRange.delta*(t.valueType==="DateTime"?t.dateTimeInterval:t.visibleRange.interval),c=void 0,u=t.maxLabelSize.width+10+(t.tickPosition===t.labelPosition?t.majorTickLines.height:0),d="",p=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?-.5:0,f=l&&t.labelPosition==="Inside"||!l&&t.labelPosition==="Outside"?r.x-u+a:r.x+u+a,v=0,m=t.visibleLabels.length;v<m;v++)switch(s=Un(t.visibleLabels[v].value+p,t),s=(t.isAxisInverse?1-s:s)*r.height,t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?(n=s*-1+(r.y+r.height),c=s*-1-h+(r.y+r.height)):(n=s*-1+h/2+(r.y+r.height),c=s*-1-h/2+(r.y+r.height)),t.border.type){case"Rectangle":case"WithoutTopBorder":n>r.y+r.height?d+="M "+f+" "+(r.y+r.height)+" L "+f+" "+c+" ":Math.floor(r.y)>c?d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" L "+f+" "+r.y+" ":(d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" L "+f+" "+c+" ",v===t.visibleLabels.length-1&&(d+="M "+(r.x+a)+" "+c+" L "+f+" "+c+" "));break;case"WithoutTopandBottomBorder":!(n>r.y+r.height)&&!(c<Math.floor(r.y))&&(d+="M "+(r.x+a)+" "+n+" L "+f+" "+n+" M "+f+" "+c+" L "+(r.x+a)+" "+c);break}d+=t.border.type==="Rectangle"?"M "+(r.x+a)+" "+r.y+" L "+(r.x+a)+" "+(r.y+r.height)+" ":"",d!==""&&this.createAxisBorderElement(t,e,d,i)}for(var v=0;v<this.chart.visibleSeries.length;v++)if(t.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.visibleSeries[v].visible){this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(t,e,i,r);break}},o.prototype.drawYAxisTitle=function(t,e,i,r){if(t.title){var n=this.chart,s=!1,a=t.isAxisOpposedPosition,l=(t.titleRotation==null?a?90:-90:t.titleRotation)%360,h=(t.tickPosition==="Inside"?0:t.majorTickLines.height+t.titlePadding)+(t.labelPosition==="Inside"?0:t.maxLabelSize.width+t.multiLevelLabelHeight+this.padding);h=t.tickPosition!=="Outside"&&(t.tickPosition==="Inside"||t.labelPosition==="Inside")?t.titlePadding===5?h:h+t.titlePadding:h,h=a?h+(t.scrollbarSettings.position==="Right"||t.scrollbarSettings.position==="Left"?0:t.scrollBarHeight):-h-(t.scrollbarSettings.position==="Right"||t.scrollbarSettings.position==="Left"?0:t.scrollBarHeight),(l!==-90&&!a||l!==90&&a)&&(h+=t.isAxisOpposedPosition?t.titleSize.width/2+(t.labelPosition==="Inside"&&t.labelPadding!==5?0:t.labelPadding):-t.titleSize.width/2-(t.labelPosition==="Inside"&&t.labelPadding!==5?0:t.labelPadding),s=!0);var c=r.x+h,u=void 0,d=void 0;t.titleStyle.textAlignment==="Center"?(d="middle",u=r.y+r.height*.5):t.titleStyle.textAlignment==="Near"?(d=t.opposedPosition?"end":"start",u=r.height+r.y):(d=t.opposedPosition?"start":"end",u=r.y);var p=t.titleSize.height*(t.titleCollection.length-1),f=new bn(n.element.id+"_AxisTitle_"+e,c,u+(s?-p:-(t.labelPosition==="Inside"&&t.labelPadding!==5?0:t.labelPadding)-p),d,t.titleCollection,"rotate("+l+","+c+","+u+")",null,l),v=vn(n.renderer,f,t.titleStyle,t.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,null,null,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont,new at(c,u));v.setAttribute("aria-hidden","true")}},o.prototype.drawXAxisGridLine=function(t,e,i,r){var n=t.valueType==="Logarithmic",s=t.valueType.indexOf("Category")>-1,a,l=0,h="",c="",u,d=1,p=t.isAxisOpposedPosition,f=p?-t.majorTickLines.height:t.majorTickLines.height,v=p?-t.lineStyle.width*.5:t.lineStyle.width*.5,m=g(t.crossesAt)&&t.scrollbarSettings.position!=="Top"&&t.scrollbarSettings.position!=="Bottom"?p?-t.scrollBarHeight:t.scrollBarHeight:0,y=t.valueType.indexOf("Category")>-1&&t.labelPlacement==="BetweenTicks"&&!this.chart.stockChart?.5:0,b=t.visibleLabels.length,S=t.tickPosition==="Inside",C=S?r.y-f-v:r.y+f+v+m,x=this.chart.themeStyle;t.valueType.indexOf("Category")>-1&&b>0&&t.labelPlacement==="BetweenTicks"&&!this.chart.stockChart&&(b+=1);for(var I=this.calculateGridLineId(i,b),D=0;D<b;D++)if(t.valueType!=="DateTimeCategory"?a=t.visibleLabels[D]?t.visibleLabels[D].value-y:t.visibleLabels[D-1].value+t.visibleRange.interval-y:a=t.visibleLabels[D]?t.visibleLabels[D].value-y:t.visibleRange.max,l=Un(a,t)*r.width+r.x,l>=r.x&&r.x+r.width>=l){if(Kf(a,t.visibleRange)||this.isBorder(t,D,l)){if(this.chart.redraw&&(this.chart.pointsAdded&&!this.chart.pointsRemoved||this.chart.zoomRedraw)&&t.majorGridLines.width&&D!==0&&t.visible&&!fe(this.chart.element.id+"_MajorGridLine_"+e+"_"+D)&&!this.chart.enableCanvas){var M=this.seriesClipRect.x+(this.chart.enableRtl!==t.isInversed?-(this.seriesClipRect.width/b*d):this.seriesClipRect.width+this.seriesClipRect.width/(D||1)*d);h="M "+M+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+M+" "+this.seriesClipRect.y,this.renderGridLine(t,e,h,t.majorGridLines,"_MajorGridLine_",D,this.element,x.majorGridLine,t.majorGridLines.dashArray,I.MajorGridLine&&I.MajorGridLine.ids?I.MajorGridLine.ids[D]:null,I.MajorGridLine?I.MajorGridLine.isPointRemoved:!1),this.rangeAnimate(t,this.element.childNodes[this.element.childNodes.length-1],this.chart.duration,!1,new Le(this.seriesClipRect.x,t.rect.y,this.seriesClipRect.x+this.seriesClipRect.width,this.chart.availableSize.height),!1,D),fe(i.id)&&fe(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1])}h="M "+l+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+l+" "+this.seriesClipRect.y,this.renderGridLine(t,e,h,t.majorGridLines,"_MajorGridLine_",D,this.element,x.majorGridLine,t.majorGridLines.dashArray,I.MajorGridLine&&I.MajorGridLine.ids?I.MajorGridLine.ids[D]:null,I.MajorGridLine?I.MajorGridLine.isPointRemoved:!1)}this.chart.redraw&&this.chart.zoomRedraw&&t.majorTickLines.width&&!fe(this.chart.element.id+"_MajorTickLine_"+e+"_"+D)&&!this.chart.enableCanvas&&t.visible&&(c="M "+(this.seriesClipRect.x+(this.chart.enableRtl!==t.isInversed?-(this.seriesClipRect.width/b*d):this.seriesClipRect.width+this.seriesClipRect.width/(D||1)*d))+" "+(r.y+v+(S?m:0))+" L "+(this.seriesClipRect.x+(this.chart.enableRtl!==t.isInversed?-(this.seriesClipRect.width/b*d):this.seriesClipRect.width+this.seriesClipRect.width/(D||1)*d))+" "+C,this.updateAxisElement(t,e,c,D,"_MajorTickLine_",i,!1),fe(i.id).appendChild(this.element.childNodes[this.element.childNodes.length-1]),d+=1),c="M "+l+" "+(r.y+v+(S?m:0))+" L "+l+" "+C,this.renderGridLine(t,e,c,t.majorTickLines,"_MajorTickLine_",D,i,x.majorTickLine,null,I.MajorTickLine&&I.MajorTickLine.ids?I.MajorTickLine.ids[D]:null,I.MajorTickLine?I.MajorTickLine.isPointRemoved:!1),t.minorTicksPerInterval>0&&(t.minorGridLines.width>0||t.minorTickLines.width>0)&&(D===0&&ud(t)&&!n&&!s&&this.renderMinorGridOnZooming(t,a,r,D,e,x,i),u=this.drawAxisMinorLine(t,a,r,D),this.renderGridLine(t,e,u[0],t.minorGridLines,"_MinorGridLine_",D,this.element,x.minorGridLine,t.minorGridLines.dashArray,I.MinorGridLine&&I.MinorGridLine.ids?I.MinorGridLine.ids[D]:null,I.MinorGridLine?I.MinorGridLine.isPointRemoved:!1),this.renderGridLine(t,e,u[1],t.minorTickLines,"_MinorTickLine_",D,i,x.minorTickLine,null,I.MinorTickLine&&I.MinorTickLine.ids?I.MinorTickLine.ids[D]:null,I.MinorTickLine?I.MinorTickLine.isPointRemoved:!1),D===b-1&&ud(t)&&n&&!s&&this.renderMinorGridOnZooming(t,a+t.visibleRange.interval,r,D,e,x,i))}if(b&&this.previousXLabel>b&&!this.chart.enableCanvas&&t.visible&&this.chart.zoomRedraw&&this.chart.redraw)for(var D=b;D<this.previousXLabel;D++){var M=this.seriesClipRect.x+(this.chart.enableRtl!==t.isInversed?-(this.seriesClipRect.width/b*(D-b+1)):this.seriesClipRect.width+this.seriesClipRect.width/b*(D-b+1));t.majorGridLines.width&&(h="M "+M+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+M+" "+this.seriesClipRect.y,this.updateAxisElement(t,e,h,D,"_MajorGridLine_",this.element,!0)),t.majorTickLines.width&&(c="M "+M+" "+(r.y+v+(S?m:0))+" L "+M+" "+C,this.updateAxisElement(t,e,c,D,"_MajorTickLine_",i,!0))}},o.prototype.calculateGridLineId=function(t,e){var i=this,r={};if(this.chart.pointsRemoved){var n=["MajorGridLine","MajorTickLine","MinorGridLine","MinorTickLine"];n.forEach(function(s){for(var a=fe(t.id),l=a.querySelectorAll('[id*="_'+s+'_"]'),h=[],c=0;c<l.length;c++)h.push(l[c]);var u=s==="MajorGridLine"&&i.chart.chartArea.border.width?e-2:e;if(u=s==="MinorGridLine"||s==="MinorTickLine"?e-1:u,h.length>0&&h.length>u){for(var d=h.length,p=0;p<d-u;p++)h[p]&&a.removeChild(h[p]),h.shift();var f=h.map(function(v){var m=v.id.split("_");return parseInt(m[m.length-1],10)});r[s]={ids:f,isPointRemoved:!0}}})}return r},o.prototype.renderMinorGridOnZooming=function(t,e,i,r,n,s,a){var l=this.drawAxisMinorLine(t,e,i,r,!0);this.renderGridLine(t,n,l[0],t.minorGridLines,"_MinorGridLine_",-1,this.element,s.minorGridLine,t.minorGridLines.dashArray),this.renderGridLine(t,n,l[1],t.minorTickLines,"_MinorTickLine_",-1,a,s.minorTickLine)},o.prototype.drawAxisMinorLine=function(t,e,i,r,n){var s=e,a=0,l=0,h=t.visibleRange,c=t.tickPosition==="Inside",u=[],d=t.isAxisOpposedPosition?-t.minorTickLines.height:t.minorTickLines.height,p,f,v=1,m=1,y=c?i.y-d:i.y+d,b=c?i.x+d:i.x-d,S="",C="",x=t.isAxisInverse;if(t.valueType==="Logarithmic"&&(p=Math.pow(t.logBase,s-h.interval),f=Math.pow(t.logBase,s),v=(f-p)/(t.minorTicksPerInterval+1),m=p+v),t.orientation==="Horizontal")for(var I=0;I<t.minorTicksPerInterval;I++)s=this.findLogNumeric(t,m,s,r,n),m+=v,Kf(s,h)&&(l=(s-h.min)/(h.max-h.min),l=Math.ceil((x?1-l:l)*i.width),a=Math.floor(l+i.x),this.chart.enableCanvas?(S===""?S="M "+a+" "+this.seriesClipRect.y+" L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height):S=S+" M "+a+" "+this.seriesClipRect.y+" L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height),a=Math.floor(l+i.x),C===""?C=C.concat("M "+a+" "+i.y+" L "+a+" "+(y+t.scrollBarHeight)):C=C.concat(" M "+a+" "+i.y+" L "+a+" "+(y+t.scrollBarHeight))):(S=S.concat("M "+a+" "+this.seriesClipRect.y+"L "+a+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),a=Math.floor(l+i.x),C=C.concat("M "+a+" "+i.y+"L "+a+" "+(y+t.scrollBarHeight))));else for(var I=0;I<t.minorTicksPerInterval;I++)s=this.findLogNumeric(t,m,s,r,n),Kf(s,h)&&(l=(s-h.min)/(h.max-h.min),l=Math.ceil((x?1-l:l)*i.height)*-1,a=Math.floor(l+i.y+i.height),this.chart.enableCanvas?(S===""?S="M "+this.seriesClipRect.x+" "+a+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a:S=S+" M "+this.seriesClipRect.x+" "+a+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a,a=Math.floor(l+i.y+i.height),C===""?C=C.concat("M "+i.x+" "+a+" L "+(b-t.scrollBarHeight)+" "+a+" "):C=C.concat(" M "+i.x+" "+a+" L "+(b-t.scrollBarHeight)+" "+a+" ")):(S=S.concat("M "+this.seriesClipRect.x+" "+a+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+a+" "),a=Math.floor(l+i.y+i.height),C=C.concat("M "+i.x+" "+a+"L "+(b-t.scrollBarHeight)+" "+a+" "))),m+=v;return u.push(S),u.push(C),u},o.prototype.findLogNumeric=function(t,e,i,r,n){var s=t.visibleRange,a;if(t.valueType==="Logarithmic")i=Tl(e,t.logBase);else if(t.valueType==="DateTime")a=t.dateTimeInterval/(t.minorTicksPerInterval+1),i=n?i-a:i+a;else if(t.valueType==="DateTimeCategory"){var l=t.labelPlacement==="BetweenTicks"?.5:0;i+=((t.visibleLabels[r+1]?t.visibleLabels[r+1].value-l:t.visibleRange.max)-(t.visibleLabels[r]?t.visibleLabels[r].value-l:t.visibleRange.min))/(t.minorTicksPerInterval+1)}else a=s.interval/(t.minorTicksPerInterval+1),i=n?i-a:i+a;return i},o.prototype.drawXAxisLabels=function(t,e,i,r){var n=this.chart,s=0,a=0,l=0,h=t.labelPadding,c,u,d,p,f=10,v=n.renderer.createGroup({id:n.element.id+"AxisLabels"+e}),m=t.labelPosition==="Inside",y=t.isAxisOpposedPosition,b=t.labelPosition===t.tickPosition?t.majorTickLines.height:0,S=b+h+t.lineStyle.width*.5,C=t.angle%360,x=C===0||C===-180||C===180,I,D,M=t.isAxisInverse,E,A=1,L=M?r.x+r.width:r.x,N=0,R=t.visibleLabels.length,P,k,B,F=t.scrollbarSettings.enable||!m&&g(t.crossesAt)&&(t.zoomFactor<1||t.zoomPosition>0)?t.scrollbarSettings.position==="Top"||t.scrollbarSettings.position==="Bottom"?0:t.scrollBarHeight:0,O=[],z=!1,Y=[],K=new Wt(0,0);S+=C===90||C===270||C===-90||C===-270?m?5:-5:0;for(var U=!y&&!m||y&&m,q=fe(n.element.id+"AxisLabels"+e),ae=this.removeAxisLabelElements(t,q),te=n.legendModule&&n.legendSettings.position==="Right"&&n.legendModule.legendBounds.height+n.legendModule.legendBounds.y>=t.rect.y?n.legendModule.legendBounds.width:0,he=U?360>=C&&C>=180||-1>=C&&C>=-180:1<=C&&C<=180||-181>=C&&C>=-360,ue=0,ne=R;ue<ne;ue++){k=t.visibleLabels[ue],B=Lc(k.originalText)||t.labelIntersectAction==="Wrap"&&k.text.length>1,s=Un(k.value,t)*r.width+r.x,u=k.size,t.enableWrap&&(u.height=Xe(k.text,t.labelStyle,n.themeStyle.axisLabelFont).height),P=r.width/R,D=B?k.breakLabelSize.width:u.width,N=(t.labelIntersectAction==="Trim"||t.labelIntersectAction==="Wrap")&&C===0&&D>P?P:D,c=u.height/4,s-=B||C!==0?0:N/2,C!==0&&(B?s-=t.lineBreakAlignment==="Left"?k.breakLabelSize.width/2:t.lineBreakAlignment==="Right"?-(k.breakLabelSize.width/2):0:s-=C===-90||C===270?-c:C===90||C===-270?c:0),t.labelStyle.textAlignment==="Far"?s=s+N-f:t.labelStyle.textAlignment==="Near"&&(s=s-N+f),B&&t.lineBreakAlignment!=="Center"&&C===0&&(s+=t.lineBreakAlignment==="Left"?-(N/2):N/2);var le=B?x?t.opposedPosition||m?0:u.height:k.breakLabelSize.width/2:0;if(S=B?b+h+t.lineStyle.width*.5:S,m&&C?B?a=y?r.y+S+le:r.y-S-le:a=y?r.y+S+c:r.y-S-c:(B?d=U?S+F+(C?le:3*c):-(S+F+le):d=U?S+F+(C?1:3)*c:-(S+F+(C?c:k.index>1?2*c:0)),a=r.y+d*k.index),B?p=this.getAnchor(t):p=n.enableRtl?he?"":"end":n.isRtlEnabled||he?"end":"start",I=new bn(n.element.id+e+"_AxisLabel_"+ue,s,a,p),I.id=ae&&q&&q.children[ue]?q.children[ue].id:I.id,C!==0&&(K=cd(k.labelStyle,k.originalText,C,n,n.themeStyle.axisLabelFont),E=C<0&&C>-90||C<-180&&C>-270||C>90&&C<180||C>270&&C<360),t.edgeLabelPlacement)switch(t.edgeLabelPlacement){case"None":break;case"Hide":if((ue===0||M&&ue===ne-1)&&I.x<r.x||(ue===ne-1||M&&ue===0)&&I.x+(C===0?N:K.width)>r.x+r.width)continue;break;case"Shift":if(ue===ne-2&&t.labelIntersectAction!=="MultipleRows"&&(p==="start"||p===""?l=I.x+N:p==="middle"?l=I.x+N/2:l=I.x),(ue===0||M&&ue===ne-1)&&(I.x<r.x||C!==0&&E&&I.x<r.x||t.lineBreakAlignment==="Center"&&I.x-k.size.width/k.text.length/2<r.x&&C===0))if(P-=r.x-I.x,p===""||p==="start")I.x<=0?s=I.x=0:s=I.x,P=r.width/R;else if(E&&C!==0)P=r.width/R,r.x+P>I.x+K.width?I.x=s=r.x+S:I.x=s=r.x+P-S;else if(B&&t.lineBreakAlignment==="Center"&&t.labelPlacement==="OnTicks"&&C===0){for(var $=0,ee=0;ee<k.text.length;ee++){var He=Xe(k.text[ee],t.labelStyle,n.themeStyle.axisLabelFont).width;He>$&&($=He)}I.x=s=r.x+$/2}else p==="start"&&I.x>0||(I.x=s=x?r.x:r.x+S);else if((ue===ne-1||M&&ue===0)&&(I.x+N>n.availableSize.width-n.border.width-te&&(p==="start"||p==="")&&C===0||p===""&&C!==0&&!E&&I.x+K.width>n.availableSize.width-n.border.width-te||p==="middle"&&C!==0&&!E&&I.x+K.width/2>n.availableSize.width-n.border.width-te||p==="end"&&C!==0&&!E&&I.x>n.availableSize.width-n.border.width-te||p==="end"&&I.x>n.availableSize.width-n.border.width-te&&C===0||p==="middle"&&I.x+N/2>n.availableSize.width-n.border.width-te&&C===0)){var qe=C!==0?K.width:N,we=void 0,je=5;if(p==="start"||p===""?we=I.x-(I.x+qe-n.availableSize.width+n.border.width+je+te):p==="middle"?we=I.x-(I.x+qe/2-n.availableSize.width+n.border.width+je+te):we=I.x-(I.x-(n.availableSize.width+n.border.width+je+te)),l!==0&&we<l){var Ne=n.availableSize.width-l;k.text=Js(Ne,k.originalText,t.labelStyle,n.isRtlEnabled,n.themeStyle.axisLabelFont)}else I.x=s=we}break}I.text=this.getLabelText(k,t,P),I.labelRotation=C;var Ye=void 0,dt=void 0;if(B&&C===0?t.lineBreakAlignment==="Right"?(Ye=I.x-N,dt=I.x):t.lineBreakAlignment==="Center"?(Ye=I.x-N/2,dt=I.x+N/2):(Ye=I.x,dt=I.x+N):(Ye=I.x,dt=I.x+N),!(C===0&&t.labelIntersectAction==="Hide"&&ue!==0&&(M?dt>=L:Ye<=L))){if(B?t.lineBreakAlignment==="Right"?L=M?I.x-N:I.x:t.lineBreakAlignment==="Center"?L=M?I.x-N/2:I.x+N/2:L=M?I.x:I.x+N:L=M?I.x:I.x+N,C!==0){var Ke=void 0,ci=void 0;if(B){var Jt=0,vt=0;Ke=k.breakLabelSize.height,vt=k.breakLabelSize.height-4,t.lineBreakAlignment==="Center"?Jt=-(k.breakLabelSize.width/2):t.lineBreakAlignment==="Right"&&(Jt=-k.breakLabelSize.width),U&&(vt=k.breakLabelSize.height/(I.text.length+1)),ci=new Le(I.x+Jt,I.y-vt,k.breakLabelSize.width,Ke)}else Ke=a-(I.y-k.size.height/2),ci=new Le(I.x,I.y-(k.size.height/2-5),k.size.width,Ke);var bi=this.getRectanglePoints(ci),Bi=B?ci.x+ci.width/2:s,Dr=B?ci.y+ci.height/2:a-Ke/2;if(B?I.transform="rotate("+C+","+Bi+","+Dr+")":I.transform="rotate("+C+","+s+","+a+")",O.push(VR(bi,Bi,Dr,C)),z=!1,t.labelIntersectAction!=="None"){for(var vr=ue;vr>0;vr--)if(O[ue]&&O[vr-1]&&pO(O[ue],O[vr-1])){z=!0,O[ue]=null;break}}var Fi=C>0&&C<90||C>180&&C<270||C<-90&&C>-180||C<-270&&C>-360,tr=new Le(I.x,I.y-(u.height/2+S/2),k.size.width,Ke),_=this.getRectanglePoints(tr),re=[];re.push(new at(Fi?this.chart.availableSize.width:this.padding,t.rect.y)),re.push(new at(Fi?this.chart.availableSize.width:this.padding,t.rect.y+t.maxLabelSize.height)),Y.push(VR(_,Bi,Dr,C));for(var Se=new Le(0,t.rect.y,this.chart.availableSize.width,t.maxLabelSize.height*2),Be=0;Be<Y[ue].length;Be++)if(!t.opposedPosition&&!Pi(Y[ue][Be].x,Y[ue][Be].y,Se)&&typeof I.text=="string"){var _e=this.calculateIntersection(Y[ue][0],Y[ue][1],re[0],re[1]),We=Fi?this.chart.availableSize.width-s:s,Dt=_e.y-t.rect.y,_i=Math.sqrt(We*We+Dt*Dt);I.text=Js(_i,k.text,k.labelStyle,n.enableRtl,n.themeStyle.axisLabelFont)}}if(this.chart.redraw&&(n.pointsAdded&&!n.pointsRemoved||this.chart.zoomRedraw)&&!fe(I.id)&&ue!==0&&!this.chart.enableCanvas&&t.visible){var qt=I.x;I.x=this.seriesClipRect.x+(n.enableRtl!==t.isInversed?-(this.seriesClipRect.width/(ue||1)*A):this.seriesClipRect.width+this.seriesClipRect.width/(ue||1)*A);var Kn=I.transform;I.transform=C?"rotate("+C+","+I.x+","+parseFloat(I.transform.split(",")[2])+")":"";var br=vn(n.renderer,I,k.labelStyle,k.labelStyle.color||n.themeStyle.axisLabelFont.color,v,t.isAxisOpposedPosition!==(t.labelPosition==="Inside"),n.redraw,!0,null,n.duration,null,k.size,z,n.enableCanvas,null,n.themeStyle.axisLabelFont);this.rangeAnimate(t,br,this.chart.duration,!0,new Le(this.seriesClipRect.x,t.rect.y,this.seriesClipRect.x+this.seriesClipRect.width,this.chart.availableSize.height),!1,ue),I.x=qt,I.transform=Kn,A+=1}var ql=vn(n.renderer,I,k.labelStyle,k.labelStyle.color||n.themeStyle.axisLabelFont.color,v,t.isAxisOpposedPosition!==(t.labelPosition==="Inside"),n.redraw,!0,null,n.duration,null,k.size,z,n.enableCanvas,null,n.themeStyle.axisLabelFont,new at(parseFloat(I.transform.split(",")[1]),parseFloat(I.transform.split(",")[2])));ae&&(ql.id=n.element.id+e+"_AxisLabel_"+ue)}}if(this.previousXLabel&&R&&this.previousXLabel>R&&!this.chart.enableCanvas&&t.visible&&this.chart.zoomRedraw&&this.chart.redraw&&I.text)for(var ue=R;ue<this.previousXLabel;ue++)I.x=this.seriesClipRect.x+(n.enableRtl!==t.isInversed?-(this.seriesClipRect.width/R*(ue-R+1)):this.seriesClipRect.width+this.seriesClipRect.width/R*(ue-R+1)),I.id=n.element.id+e+"_AxisLabel_"+ue,I.transform=C?"rotate("+C+","+I.x+","+parseFloat(I.transform.split(",")[2])+")":"",this.updateAxisElement(t,e,"",ue,"_AxisLabel_",v,!0,I,k);else this.previousXLabel=R;this.chart.enableCanvas||(n.delayRedraw?t.visible&&t.internalVisibility&&this.createZoomingLabel(this.chart,v,t,e,r):i.appendChild(v))},o.prototype.updateAxisElement=function(t,e,i,r,n,s,a,l,h){var c,u=n.indexOf("Grid")>-1,d=n.indexOf("Label")>-1;d?c=vn(this.chart.renderer,l,h.labelStyle,h.labelStyle.color||this.chart.themeStyle.axisLabelFont.color,s,t.isAxisOpposedPosition!==(t.labelPosition==="Inside"),this.chart.redraw,!0,null,this.chart.duration,null,null,null,this.chart.enableCanvas,null,this.chart.themeStyle.axisLabelFont):(this.renderGridLine(t,e,i,u?t.majorGridLines:t.majorTickLines,n,r,this.element,u?this.chart.themeStyle.majorGridLine:this.chart.themeStyle.majorTickLine,u?t.majorGridLines.dashArray:null),this.element&&s.childNodes&&(c=this.element.childNodes[s.childNodes.length-1])),this.rangeAnimate(t,c,this.chart.duration,d,new Le(t.orientation==="Vertical"?0:this.seriesClipRect.x,t.orientation==="Vertical"?this.seriesClipRect.y:t.rect.y,this.seriesClipRect.width,this.seriesClipRect.height),a,r)},o.prototype.removeAxisLabelElements=function(t,e){if(this.chart.pointsRemoved&&e&&e.childNodes.length){var i=!1;if(t.valueType.indexOf("Category")>-1){var r=[];t.visibleLabels.map(function(l){typeof l.text!="string"?r.push(l.text.join("")):r.push(l.text)});for(var n=e.childNodes.length-1;n>=0;n--){var s=e.childNodes[n];r.indexOf(s.textContent.trim())===-1&&(e.removeChild(s),i=!0)}}else if(e.childNodes.length>t.visibleLabels.length)for(var a=0;a<e.childNodes.length-t.visibleLabels.length;a++)e.removeChild(e.childNodes[a]),i=!0;return i}return!1},o.prototype.calculateIntersection=function(t,e,i,r){var n=i.x-r.x,s=t.x-e.x,a=i.y-r.y,l=t.y-e.y,h=s*a-l*n,c=t.x*e.y-t.y*e.x,u=i.x*r.y-i.y*r.x,d=(c*n-s*u)/h,p=(c*a-l*u)/h,f={x:d,y:p};return f},o.prototype.getAnchor=function(t){return t.lineBreakAlignment==="Center"?"middle":this.chart.enableRtl?t.lineBreakAlignment==="Left"?"end":"start":t.lineBreakAlignment==="Left"?"start":"end"},o.prototype.getRectanglePoints=function(t){var e=new at(t.x,t.y),i=new at(t.x+t.width,t.y),r=new at(t.x+t.width,t.y+t.height),n=new at(t.x,t.y+t.height);return[e,i,r,n]},o.prototype.getLabelText=function(t,e,i){if(Lc(t.originalText)){for(var r=[],n=void 0,s=0;s<t.text.length;s++)n=this.findAxisLabel(e,t.text[s],i),r.push(n);return r}else return this.findAxisLabel(e,t.text,i)},o.prototype.drawXAxisBorder=function(t,e,i,r){if(t.border.width>0){for(var n=t.labelPosition==="Outside"&&t.scrollbarSettings.position!=="Top"&&t.scrollbarSettings.position!=="Bottom"?t.scrollBarHeight:0,s=t.isAxisOpposedPosition,a=void 0,l=r.y+(s?-1:1)*n,h=10,c=void 0,u=r.width/t.visibleRange.delta*(t.valueType==="DateTime"?t.dateTimeInterval:t.visibleRange.interval),d=void 0,p=t.maxLabelSize.height+(t.tickPosition===t.labelPosition?t.majorTickLines.height:0),f="",v=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?-.5:0,m=s&&t.labelPosition==="Inside"||!s&&t.labelPosition==="Outside"?r.y+p+h+n:r.y-p-h-n,y=0,b=t.visibleLabels.length;y<b;y++)switch(c=Un(t.visibleLabels[y].value+v,t),c=(t.isAxisInverse?1-c:c)*r.width,t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?(a=c+r.x,d=c+u+r.x):(a=c-u*.5+r.x,d=c+u*.5+r.x),t.border.type){case"Rectangle":case"WithoutTopBorder":a<r.x&&t.labelPlacement!=="OnTicks"?f+="M "+r.x+" "+m+" L "+d+" "+m+" ":Math.floor(d)>r.width+r.x&&t.visibleLabels.length!==1&&y!==t.visibleLabels.length-1?f+="M "+a+" "+l+" L "+a+" "+m+" L "+(r.width+r.x)+" "+m+" ":(a=y===0&&t.labelPlacement==="OnTicks"?r.x:a,d=y===t.visibleLabels.length-1&&t.labelPlacement==="OnTicks"?d-u*.5:d,f+="M "+a+" "+l+" L "+a+" "+m+" L "+d+" "+m+" ",y===0&&(f+="M "+a+" "+l+" L "+a+" "+m+" M "+a+" "+m+" L "+r.x+" "+m),y===t.visibleLabels.length-1&&(f+="M "+d+" "+l+" L "+d+" "+m+" M "+d+" "+m+" L "+(r.width+r.x)+" "+m));break;case"WithoutTopandBottomBorder":!(a<r.x)&&!(Math.floor(d)>r.width+r.x)&&(f+="M "+a+" "+l+" L "+a+" "+m+" M "+d+" "+l+" L "+d+" "+m);break}f+=t.border.type==="Rectangle"?"M  "+r.x+" "+l+"L "+(r.x+r.width)+" "+l:"",f!==""&&this.createAxisBorderElement(t,e,f,i)}for(var y=0;y<this.chart.visibleSeries.length;y++)if(this.chart.multiLevelLabelModule&&t.multiLevelLabels.length>0&&this.chart.visibleSeries[y].visible){this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(t,e,i,r);break}},o.prototype.createAxisBorderElement=function(t,e,i,r){var n=fe(this.chart.element.id+"_BorderLine_"+e),s=n?n.getAttribute("d"):"",a=this.chart.renderer.drawPath(new Rr(this.chart.element.id+"_BorderLine_"+e,"transparent",t.border.width,t.border.color||this.chart.themeStyle.axisLine,1,"",i));a.style.pointerEvents="none",gt(this.chart.enableCanvas,r,a,this.chart.redraw,!1,"x","y",null,s,!0,null,null,this.chart.duration)},o.prototype.findAxisLabel=function(t,e,i){return t.labelIntersectAction==="Trim"&&t.angle%360===0&&!t.enableTrim?Js(i,e,t.labelStyle,this.chart.enableRtl,this.chart.themeStyle.axisLabelFont):e},o.prototype.drawXAxisTitle=function(t,e,i,r){if(t.title){var n=this.chart,s=Xe(t.title,t.titleStyle,this.chart.themeStyle.axisTitleFont),a=g(t.crossesAt)&&t.scrollbarSettings.position!=="Top"&&t.scrollbarSettings.position!=="Bottom"?t.scrollBarHeight:0,l=(t.tickPosition==="Inside"?0:t.majorTickLines.height+t.titlePadding)+(t.labelPosition==="Inside"?0:t.maxLabelSize.height+t.multiLevelLabelHeight+t.labelPadding);l=t.tickPosition!=="Outside"&&(t.tickPosition==="Inside"||t.labelPosition==="Inside")?t.titlePadding===5?l:l+t.titlePadding:l;var h=t.titleSize.height*(t.titleCollection.length-1);l=t.isAxisOpposedPosition?-(l+s.height/4+a+h):l+3*s.height/4+a;var c=t.titleRotation?t.titleRotation:0,u=void 0,d=r.y+l,p=void 0;t.titleStyle.textAlignment==="Center"?(p="middle",u=r.x+r.width*.5):t.titleStyle.textAlignment==="Near"?(p="start",u=r.x):(p="end",u=r.x+r.width),c!==0&&(d+=t.opposedPosition?-(t.titleSize.height/2+s.height/4):t.titleSize.height/2-s.height/4);var f=new bn(n.element.id+"_AxisTitle_"+e,u,d,p,t.titleCollection,"rotate("+c+","+u+","+d+")",null,c),v=vn(n.renderer,f,t.titleStyle,t.titleStyle.color||n.themeStyle.axisTitleFont.color,i,null,n.redraw,n.redraw,null,null,null,null,null,n.enableCanvas,null,n.themeStyle.axisTitleFont,new at(u,d));v.setAttribute("aria-hidden","true")}},o.prototype.renderGridLine=function(t,e,i,r,n,s,a,l,h,c,u){h===void 0&&(h=null),c===void 0&&(c=null),u===void 0&&(u=!1);var d=this.chart,p,f;r.width>0&&t.visible&&t.internalVisibility&&i&&(f=fe(d.element.id+n+e+"_"+(u?c:s)),p=f?f.getAttribute("d"):null,f=null,this.htmlObject=d.renderer.drawPath(new Rr(d.element.id+n+e+"_"+(u?c:s),"transparent",r.width,r.color||l,null,h,i)),gt(d.enableCanvas,a,this.htmlObject,d.redraw,!0,"x","y",null,p,!0,null,null,d.duration),u&&(this.htmlObject.id=d.element.id+n+e+"_"+s))},o.prototype.findParentNode=function(t,e,i){return document.getElementById(t+"AxisGroup"+i+"Inside").contains(document.getElementById(e.id))?document.getElementById(t+"AxisGroup"+i+"Inside"):document.getElementById(t+"AxisGroup"+i+"Outside")},o.prototype.createZoomingLabel=function(t,e,i,r,n){var s=this.findParentNode(t.element.id,e,r);e.setAttribute("opacity","0.3");var a=t.renderer.createGroup({id:t.element.id+"AxisLabels_Zoom"+r});a=n6(t,i,a,r,i.orientation==="Vertical",n),s.replaceChild(e,document.getElementById(e.id)),fe(t.element.id+"AxisLabels_Zoom"+r)?s.replaceChild(a,document.getElementById(a.id)):s.appendChild(a)},o})(),nM=(function(){function o(t){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.commonXvalues=[],this.chart=t,this.lierIndex=0}return o.prototype.getData=function(){for(var t=this.chart,e=null,i=null,r,n,s,a,l=t.visibleSeries.length,h=l-1;h>=0;h--){if(i=t.visibleSeries[h],r=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.height+5)/2:0,n=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.width+5)/2:0,s=t.mouseX,a=t.mouseY,i.dragSettings.enable&&i.isRectSeries)if(!(i.type==="Bar"&&t.isTransposed)&&(t.isTransposed||i.type==="Bar")){var c=i.marker.width/2;s=i.yAxis.isAxisInverse?s+c:s-c}else{var u=i.marker.height/2;a=i.yAxis.isAxisInverse?a-u:a+u}if(i.visible&&Pi(s,a,i.clipRect,r,n)&&(e=this.getRectPoint(i,i.clipRect,s,a)),e)return new Zf(e,i)}return new Zf(e,i)},o.prototype.isSelected=function(t){return(t.selectionMode.indexOf("Drag")>-1||t.selectionMode.indexOf("Lasso")>-1)&&t.selectionModule&&t.selectionModule.rectPoints!==null},o.prototype.getRectPoint=function(t,e,i,r){var n=this.chart,s,a,l,h=0,c,u,d;if(n.isScrolling)return null;for(var p=0,f=t.points;p<f.length;p++){var v=f[p];if(!(!v.regionData&&(!v.regions||!v.regions.length))){if(v.regionData&&this.chart.chartAreaType==="PolarRadar"&&t.drawType.indexOf("Column")>-1&&(s=i-(t.clipRect.width/2+t.clipRect.x),a=r-(t.clipRect.height/2+t.clipRect.y),h=2*Math.PI*(v.regionData.currentXPosition<0?1+v.regionData.currentXPosition:v.regionData.currentXPosition),l=(Math.atan2(a,s)+.5*Math.PI-h)%(2*Math.PI),l=l<0?2*Math.PI+l:l,l=l+2*Math.PI*t.chart.primaryXAxis.startAngle,c=v.regionData.startAngle,c-=h,c=c<0?2*Math.PI+c:c,u=v.regionData.endAngle,u-=h,u=u<0?2*Math.PI+u:u,d=Math.sqrt(Math.pow(Math.abs(s),2)+Math.pow(Math.abs(a),2)),l>=c&&l<=u&&(d>=v.regionData.innerRadius&&d<=v.regionData.radius||d<=v.regionData.innerRadius&&d>=v.regionData.radius)&&d<=t.chart.radius))return v;if((t.dragSettings.enable&&t.isRectSeries||t.isRectSeries&&t.marker.visible&&this.chart.chartAreaType!=="PolarRadar")&&this.isPointInThresholdRegion(i,r,v,e,t))return this.insideRegion=!0,v;if(!this.insideRegion&&this.checkRegionContainsPoint(v.regions,e,i,r))return v;if(this.insideRegion&&this.checkRegionContainsPoint(v.regions,e,i,r))return v}}return null},o.prototype.checkRegionContainsPoint=function(t,e,i,r){var n=this;return t.some(function(s,a){return n.lierIndex=a,Pi(i,r,new Le((n.chart.chartAreaType==="Cartesian"?e.x:0)+s.x,(n.chart.chartAreaType==="Cartesian"?e.y:0)+s.y,s.width,s.height))})},o.prototype.isPointInThresholdRegion=function(t,e,i,r,n){var s=this,a=n.type==="Bar",l=n.yAxis.isAxisInverse,h=n.chart.isTransposed,c=10,u=0,d=0,p,f=p=2*c;return l&&h?a?(u=i.regions[0].height-c,p=i.regions[0].width):(d=-c,f=i.regions[0].height):l||i.yValue<0?a?(d=-c,f=i.regions[0].height):(u=i.regions[0].height-c,p=i.regions[0].width):h?a?(u=-c,p=i.regions[0].width):(d=i.regions[0].width-c,f=i.regions[0].height):a?(d=i.regions[0].width-c,f=i.regions[0].height):(u=-c,p=i.regions[0].width),i.regions.some(function(v){return Pi(t,e,new Le((s.chart.chartAreaType==="Cartesian"?r.x:0)+v.x+d,(s.chart.chartAreaType==="Cartesian"?r.y:0)+v.y+u,p,f))})},o.prototype.getClosest=function(t,e,i){var r,n,s=i||t.xData,a=s.length,l=.5,h=.5;if(t.xAxis.valueType==="DateTime"&&t.points.length===1){l=t.xAxis.visibleRange.min,h=t.xAxis.visibleRange.max;for(var c=0;c<t.chart.visibleSeries.length;c++){var u=t.chart.visibleSeries[c];u.xMin>=l&&u.xMin<t.xMin&&(l=u.xMin+.1),u.xMax<=h&&u.xMax>t.xMax&&(h=u.xMax-.1),u.visible&&u.points.length>1&&(u.xMax>=l&&u.xMax<t.xMin&&(l=u.xMax+.1),u.xMin<=h&&u.xMin>t.xMax&&(h=u.xMin-.1))}l!==t.xAxis.visibleRange.min&&(l=Math.abs(t.xMin-l)/2),h!==t.xAxis.visibleRange.max&&(h=Math.abs(t.xMax-h)/2)}if(e>=t.xMin-l&&e<=t.xMax+h)for(var d=0;d<a;d++)n=s[d],(r==null||Math.abs(n-e)<Math.abs(r-e))&&(r=n);var p=t.xData.indexOf(r)!==-1;return p?r:null},o.prototype.binarySearch=function(t,e){for(var i=0,r=e.length,n=-1,s=!1,a;s===!1&&i<=r;)a=Math.floor((i+r)/2),e[a].xValue===t?(s=!0,n=a):e[a].xValue>t?r=a-1:i=a+1;return n!==-1?e[n]:null},o.prototype.getClosestX=function(t,e,i){var r,n=e.clipRect;t.mouseX<=n.x+n.width&&t.mouseX>=n.x&&(t.requireInvertedAxis?r=vO(t.mouseY-n.y,n.height,e.xAxis):r=gO(t.mouseX-n.x,n.width,e.xAxis));var s=this.getClosest(e,r,i),a=(s||s===0)&&e.points.length>0?this.binarySearch(s,e6(e.points,["xValue"])):null;return a&&a.visible&&this.chart.chartAreaType==="Cartesian"&&(e.category==="Indicator"&&e.name==="Histogram"||a.symbolLocations&&a.symbolLocations.length>0&&a.symbolLocations[0].x>=0&&a.symbolLocations[0].x<=n.width)?new Zf(a,e):null},o.prototype.mergeXvalues=function(t){if(t.length&&(!this.commonXvalues.length||this.commonXvalues.length!==t[0].xData.length)){this.commonXvalues=t[0].xData;for(var e=1;e<t.length;e++)this.commonXvalues=this.getDistinctValues(this.commonXvalues,t[e].xData)}return this.commonXvalues},o.prototype.commonXValue=function(t){for(var e=[],i=0;i<t.length;i++)for(var r=0;t[i].points&&r<t[i].points.length;r++){var n=t[i].points[r];n&&(n.index===0||n.index===t[i].points.length-1||n.symbolLocations&&n.symbolLocations.length>0)&&e.push(n.xValue)}return e},o.prototype.getDistinctValues=function(t,e){t===void 0&&(t=[]),e===void 0&&(e=[]);var i={},r=[],n;for(n=0;n<t.length;n++){var s=t[n];i[s]||(i[s]=!0,r.push(s))}for(n=0;n<e.length;n++){var s=e[n];i[s]||(i[s]=!0,r.push(s))}return r},o.prototype.findMouseValues=function(t,e,i){e.requireInvertedAxis?(i.valueY=(1-Un(t.point.xValue,t.series.xAxis))*t.series.xAxis.rect.height+t.series.xAxis.rect.y,i.valueX=e.mouseX,e.crosshair.snapToData&&(t.series.type==="BoxAndWhisker"&&t.point.regions.length?i.valueX=t.point.regions[0].x+t.series.clipRect.x:e.tooltip.shared?e.crosshairModule.valueX=t.point.symbolLocations[0].x+t.series.clipRect.x:i.valueX=t.point.symbolLocations[0].x+t.series.clipRect.x)):(e.chartAreaType==="PolarRadar"?i.valueX=fO(t.point.xValue,t.series.xAxis)*t.series.xAxis.rect.width+t.series.xAxis.rect.x:i.valueX=t.series.category==="TrendLine"&&e.tooltip.shared?i.valueX:Un(t.point.xValue,t.series.xAxis)*t.series.xAxis.rect.width+t.series.xAxis.rect.x,i.valueY=e.mouseY,e.crosshair.snapToData&&(t.series.type==="BoxAndWhisker"&&t.point.regions.length?i.valueY=t.point.regions[0].y+t.series.clipRect.y:i.valueY=t.point.symbolLocations[0].y+t.series.clipRect.y))},o})(),jo=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Me=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},M6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(!1)],t.prototype,"enable",void 0),Me([Ce({size:null,color:null,fontStyle:null,fontWeight:null,fontFamily:null},ea)],t.prototype,"font",void 0),Me([w(null)],t.prototype,"background",void 0),Me([Ce({},qn)],t.prototype,"border",void 0),Me([w("")],t.prototype,"lineColor",void 0),Me([w(1)],t.prototype,"lineWidth",void 0),Me([w("")],t.prototype,"dashArray",void 0),Me([w(5)],t.prototype,"rx",void 0),Me([w(5)],t.prototype,"ry",void 0),t})(Oe),D6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(!1)],t.prototype,"visible",void 0),Me([w(!0)],t.prototype,"showZero",void 0),Me([w(null)],t.prototype,"name",void 0),Me([w("transparent")],t.prototype,"fill",void 0),Me([w(null)],t.prototype,"format",void 0),Me([w(1)],t.prototype,"opacity",void 0),Me([w(0)],t.prototype,"angle",void 0),Me([w(!1)],t.prototype,"enableRotation",void 0),Me([w("Auto")],t.prototype,"position",void 0),Me([w(5)],t.prototype,"rx",void 0),Me([w(5)],t.prototype,"ry",void 0),Me([w("Center")],t.prototype,"alignment",void 0),Me([Ce({width:null,color:null},qn)],t.prototype,"border",void 0),Me([Ce({left:5,right:5,top:5,bottom:5},vd)],t.prototype,"margin",void 0),Me([Ce({size:null,color:null,fontStyle:null,fontWeight:null,fontFamily:null},ea)],t.prototype,"font",void 0),Me([w(null)],t.prototype,"template",void 0),Me([w("Hide")],t.prototype,"labelIntersectAction",void 0),t})(Oe),sM=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(!1)],t.prototype,"visible",void 0),Me([w(null)],t.prototype,"shape",void 0),Me([w("")],t.prototype,"imageUrl",void 0),Me([w(5)],t.prototype,"height",void 0),Me([w(!1)],t.prototype,"isFilled",void 0),Me([w(5)],t.prototype,"width",void 0),Me([Ce({width:2,color:null},qn)],t.prototype,"border",void 0),Me([Ce({x:0,y:0},Tq)],t.prototype,"offset",void 0),Me([w(null)],t.prototype,"fill",void 0),Me([w(!0)],t.prototype,"allowHighlight",void 0),Me([w(1)],t.prototype,"opacity",void 0),Me([Ce({},D6)],t.prototype,"dataLabel",void 0),t})(Oe),E6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(null)],t.prototype,"fill",void 0),Me([w(1)],t.prototype,"width",void 0),Me([w("0")],t.prototype,"dashArray",void 0),Me([Ce(null,sM)],t.prototype,"marker",void 0),Me([w(!0)],t.prototype,"showAxis",void 0),t})(Oe),eM=(function(){function o(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0,this.verticalError=null,this.verticalNegativeError=null,this.horizontalError=null,this.horizontalNegativeError=null,this.verticalPositiveError=null,this.horizontalPositiveError=null}return o})(),T6=(function(o){jo(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.clipRect=new Le(0,0,0,0),e}return t.prototype.setDataSource=function(e,i){e&&(this.points=e.points),i.trendLineModule.initDataSource(this),i.visibleSeriesCount++},Me([w("")],t.prototype,"name",void 0),Me([w("")],t.prototype,"dashArray",void 0),Me([w(!0)],t.prototype,"visible",void 0),Me([w("Linear")],t.prototype,"type",void 0),Me([w(2)],t.prototype,"period",void 0),Me([w(2)],t.prototype,"polynomialOrder",void 0),Me([w(0)],t.prototype,"backwardForecast",void 0),Me([w(0)],t.prototype,"forwardForecast",void 0),Me([Ce({},tM)],t.prototype,"animation",void 0),Me([Ce({},sM)],t.prototype,"marker",void 0),Me([w(!0)],t.prototype,"enableTooltip",void 0),Me([w(null)],t.prototype,"intercept",void 0),Me([w("")],t.prototype,"fill",void 0),Me([w(1)],t.prototype,"width",void 0),Me([w("SeriesType")],t.prototype,"legendShape",void 0),Me([Ce({},Bo)],t.prototype,"accessibility",void 0),t})(Oe),A6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(1)],t.prototype,"width",void 0),Me([w(10)],t.prototype,"length",void 0),Me([w(null)],t.prototype,"color",void 0),Me([w(1)],t.prototype,"opacity",void 0),t})(Oe),L6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(null)],t.prototype,"value",void 0),Me([w(null)],t.prototype,"color",void 0),Me([w("0")],t.prototype,"dashArray",void 0),t})(Oe),N6=(function(o){jo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Me([w(!1)],t.prototype,"visible",void 0),Me([w("Fixed")],t.prototype,"type",void 0),Me([w("Both")],t.prototype,"direction",void 0),Me([w("Vertical")],t.prototype,"mode",void 0),Me([w(null)],t.prototype,"color",void 0),Me([w(1)],t.prototype,"verticalError",void 0),Me([w(1)],t.prototype,"width",void 0),Me([w(1)],t.prototype,"horizontalError",void 0),Me([w(3)],t.prototype,"verticalPositiveError",void 0),Me([w(3)],t.prototype,"verticalNegativeError",void 0),Me([w(1)],t.prototype,"horizontalPositiveError",void 0),Me([w(1)],t.prototype,"horizontalNegativeError",void 0),Me([Ce(null,A6)],t.prototype,"errorBarCap",void 0),Me([w("")],t.prototype,"errorBarColorMapping",void 0),t})(Oe),DO=(function(o){jo(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.rangeColorPoints=[],e.isAdvancedColor=void 0,e.currentViewData=[],e.clipRect=new Le(0,0,0,0),e.seriesType="XY",e.isRectTypeSeries=!1,e.removedPointIndex=null,e.isLegendClicked=!1,e}return t.prototype.processJsonData=function(){var e=0,i=new eM,r=this instanceof Zr&&this.type==="Histogram"?"x":this.xName,n=this instanceof Zr&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof Zr&&((this.type==="Waterfall"||this.type==="Histogram")&&(this.currentViewData=this.chart[_r(this.type)+"SeriesModule"].processInternalData(pe([],this.currentViewData,null,!0),this)),this.category==="Pareto"&&(this.currentViewData=pe([],this.currentViewData,null,!0),this.type==="Line"&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);var s=(this.currentViewData||[]).length;if(this.points=[],this.xMin=1/0,this.xMax=-1/0,this.yMin=1/0,this.yMax=-1/0,this.sizeMax=-1/0,this.getSeriesType(),this.xAxis.valueType==="Category")for(;e<s;)this.pushCategoryPoint(i,e,n,r),e++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var a={skeleton:"full",type:"dateTime"},l=this.chart.intl.getDateParser(a),h=this.chart.intl.getDateFormat(a);e<s;)this.pushDateTimePoint(i,e,n,r,l,h),e++;else for(;e<s;)this.pushDoublePoint(i,e,n,r),e++;this.updateSplineValue(),this.updateYAxisForErrorBars(),this instanceof Zr&&this.type==="Waterfall"&&g(this.yAxis.minimum)&&(this.yMin=Math.min.apply(Math,this.chart.waterfallSeriesModule.cumulativeSums))},t.prototype.updateYAxisForErrorBars=function(){if(this instanceof Zr&&this.chart.errorBarModule){var e=void 0,i=void 0;if(this.errorBar.verticalError)for(var r=0;r<this.points.length;r++){for(var n=[],s=[],a=0;a<this.points.length;a++){var l=this.points[a];l.verticalError&&(n.push(l.verticalError),s.push(l.yValue-l.verticalError))}e=n&&n.length>0?Math.max.apply(Math,n):0,i=n&&n.length>0?Math.min.apply(Math,s):0}this.yMax+=!isNaN(e)&&g(this.yAxis.maximum)?e:0,this.yMin=!isNaN(i)&&i<this.yMin&&i<0&&g(this.yAxis.minimum)?i:this.yMin}},t.prototype.pushCategoryPoint=function(e,i,r,n){e=this.dataPoint(i,r,n),this.pushCategoryData(e,i,e.x),this.pushData(e,i),this.setEmptyPoint(e,i),this.rangeColorsInterior(e)},t.prototype.pushDoublePoint=function(e,i,r,n){e=this.dataPoint(i,r,n),e.xValue=e.x,this.pushData(e,i),this.setEmptyPoint(e,i)},t.prototype.pushDateTimePoint=function(e,i,r,n,s,a){e=this.dataPoint(i,r,n),!g(e.x)&&e.x!==""?(e.x=new Date(ge.parse.parseJson({val:e.x}).val),this.xAxis.valueType==="DateTime"?e.xValue=Date.parse(e.x.toString()):this.pushCategoryData(e,i,Date.parse(s(a(e.x))).toString()),this.pushData(e,i),this.setEmptyPoint(e,i)):e.visible=!1},t.prototype.updateSplineValue=function(){if(this instanceof Zr&&!(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory")){if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&this.chart.chartAreaType==="PolarRadar"){var e=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,i=this.type.indexOf("Range")>-1;this.chart["spline"+(e?i?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this);this.type.indexOf("Histogram")>-1&&this.points.length===1&&(this.xMin=this.xMin-this.histogramValues.binWidth,this.xMax=this.xMax+this.histogramValues.binWidth)}},t.prototype.rangeColorsInterior=function(e){this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")&&(this.rangeColorPoints[e.interior]?this.rangeColorPoints[e.interior]!==void 0&&this.rangeColorPoints[e.interior].push(e):this.rangeColorPoints[e.interior]=[])},t.prototype.pushData=function(e,i){e.index=i,e.yValue=e.y,e.series=this,this.xMin=Math.min(this.xMin,e.xValue),this.xMax=Math.max(this.xMax,e.xValue),this.xData.push(e.xValue)},t.prototype.dataPoint=function(e,i,r){this.points[e]=new eM;var n=this.points[e],s=this.currentViewData[e],a=this.enableComplexProperty?V:this.getObjectValue;n.x=a(r,s);var l=this.yAxis.valueType.indexOf("DateTime")>-1;return n.high=l?new Date(a(this.high,s)):a(this.high,s),n.low=l?new Date(a(this.low,s)):a(this.low,s),n.open=l?new Date(a(this.open,s)):a(this.open,s),n.close=l?new Date(a(this.close,s)):a(this.close,s),n.volume=l?new Date(a(this.volume,s)):a(this.volume,s),n.interior=a(this.pointColorMapping,s),this instanceof Zr&&(this.errorBar.visible&&(n.errorBarColor=a(this.errorBar.errorBarColorMapping,s),n.verticalError=typeof this.errorBar.verticalError=="string"?a(this.errorBar.verticalError,s):this.errorBar.verticalError,n.horizontalError=typeof this.errorBar.horizontalError=="string"?a(this.errorBar.horizontalError,s):this.errorBar.horizontalError,n.verticalNegativeError=typeof this.errorBar.verticalNegativeError=="string"?a(this.errorBar.verticalNegativeError,s):this.errorBar.verticalNegativeError,n.verticalPositiveError=typeof this.errorBar.verticalPositiveError=="string"?a(this.errorBar.verticalPositiveError,s):this.errorBar.verticalPositiveError,n.horizontalNegativeError=typeof this.errorBar.horizontalNegativeError=="string"?a(this.errorBar.horizontalNegativeError,s):this.errorBar.horizontalNegativeError,n.horizontalPositiveError=typeof this.errorBar.horizontalPositiveError=="string"?a(this.errorBar.horizontalPositiveError,s):this.errorBar.horizontalPositiveError),n.y=l?new Date(a(this.yName,s)):a(this.yName,s),n.size=a(this.size,s),n.text=a(i,s),n.tooltip=a(this.tooltipMappingName,s),this.isAdvancedColorSupported()&&(this.rangeColorName=this.colorName.length>0?this.colorName:this.yName,n.colorValue=a(this.rangeColorName,s),n.interior=this.getPointFillColor(n.interior,n.colorValue))),n},t.prototype.isAdvancedColorSupported=function(){return g(this.isAdvancedColor)&&(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")?this.isAdvancedColor=!0:this.isAdvancedColor=!1),this.isAdvancedColor},t.prototype.getPointFillColor=function(e,i){var r=e;if(i&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(var n=0,s=this.chart.rangeColorSettings;n<s.length;n++){var a=s[n];i>=a.start&&i<=a.end&&(a.colors.length>1?r=C6(a,i):r=a.colors[0])}return r},t.prototype.getObjectValue=function(e,i){return i[e]},t.prototype.setEmptyPoint=function(e,i){if(!this.findVisibility(e))return e.visible=!0,null;e.isEmpty=!0;var r=this instanceof Zr&&e.isPointInRange?this.emptyPointSettings.mode:"Drop";switch(r){case"Zero":e.visible=!0,this instanceof Zr&&this.seriesType.indexOf("HighLow")>-1?(e.high=e.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=e.close=0)):e.y=e.yValue=this.yData[i]=0;break;case"Average":this instanceof Zr&&(this.seriesType.indexOf("HighLow")>-1?(e.high=g(e.high)||isNaN(+e.high)?this.getAverage(this.high,i):e.high,e.low=g(e.low)||isNaN(+e.low)?this.getAverage(this.low,i):e.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=g(e.open)||isNaN(+e.open)?this.getAverage(this.open,i):e.open,e.close=g(e.close)||isNaN(+e.close)?this.getAverage(this.close,i):e.close)):e.y=e.yValue=this.yData[i]=this.getAverage(this.yName,i)),e.visible=!0;break;case"Drop":case"Gap":this.yData[i]=null,e.visible=!1;break}},t.prototype.findVisibility=function(e){var i=this instanceof Zr?this.seriesType:"HighLowOpenClose",r,n=this.yAxis.minimum,s=this.yAxis.maximum;switch(i){case"XY":return this.chart.chartAreaType==="PolarRadar"&&(!g(n)&&e.yValue<n||!g(s)&&e.yValue>s)?(e.isPointInRange=!1,!0):(this.setXYMinMax(e.yValue),this.yData.push(e.yValue),this instanceof Zr&&this.type==="Bubble"&&(this.sizeMax=Math.max(this.sizeMax,g(e.size)||isNaN(+e.size)?this.sizeMax:e.size)),g(e.x)||g(e.y)||isNaN(+e.y));case"HighLow":return this.setHiloMinMax(e.high,e.low),g(e.x)||g(e.low)||isNaN(+e.low)||g(e.high)||isNaN(+e.high);case"HighLowOpenClose":return this.setHiloMinMax(e.high,e.low),g(e.x)||g(e.low)||isNaN(+e.low)||g(e.open)||isNaN(+e.open)||g(e.close)||isNaN(+e.close)||g(e.high)||isNaN(+e.high);case"BoxPlot":return r=(e.y||[null]).filter(function(a){return!g(a)&&!isNaN(a)}).sort(function(a,l){return a-l}),e.y=r,this.yMin=Math.min(this.yMin,Math.min.apply(Math,r)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,r)),!r.length}},t.prototype.setXYMinMax=function(e){var i=this.yAxis.valueType==="Logarithmic"||this.xAxis.valueType==="Logarithmic",r=e<0||this.yAxis.rangePadding==="None",n;this.isRectTypeSeries&&!Ps(this.yAxis)?n=i||r?e:0:n=e,this.yMin=i?Math.min(this.yMin,g(n)||isNaN(n)||n===0||n.toString()==="0"||n.toString()===""?this.yMin:n):Math.min(this.yMin,g(n)||isNaN(n)?this.yMin:n),this.yMax=Math.max(this.yMax,g(e)||isNaN(e)?this.yMax:e)},t.prototype.setHiloMinMax=function(e,i){this.yMin=Math.min(this.yMin,Math.min(g(i)||isNaN(i)?this.yMin:i,g(e)||isNaN(e)?this.yMin:e)),this.yMax=Math.max(this.yMax,Math.max(g(i)||isNaN(i)?this.yMax:i,g(e)||isNaN(e)?this.yMax:e))},t.prototype.getSeriesType=function(){var e;if(this instanceof Zr){var i=this.chart.chartAreaType==="PolarRadar"?this.drawType:this.type;if(i)switch(i){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":e="HighLow";break;case"HiloOpenClose":case"Candle":e="HighLowOpenClose";break;case"BoxAndWhisker":e="BoxPlot";break;default:e="XY"}}this.seriesType=e},t.prototype.pushCategoryData=function(e,i,r){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[i]?this.xAxis.labels[i]+=", "+r:this.xAxis.labels.push(r),e.xValue=i):(this.xAxis.indexLabels[r]===void 0&&(this.xAxis.indexLabels[r]=this.xAxis.labels.length,this.xAxis.labels.push(r)),e.xValue=this.xAxis.indexLabels[r])},t.prototype.getAverage=function(e,i,r){r===void 0&&(r=this.currentViewData);var n=r[i-1]&&r[i-1][e]||0,s=r[i+1]&&r[i+1][e]||0;return(n+s)/2},t.prototype.refreshDataManager=function(e){var i=this;this.chart=e;var r,n="isAngular";if(e[n]?r=Object.keys(this.dataSource).length?this.dataSource:e.dataSource:r=this.dataSource||e.dataSource,!(r instanceof oe)&&g(this.query)){this.dataManagerSuccess({result:r,count:r.length},!1);return}var s=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());s.then(function(a){return i.dataManagerSuccess(a)})},t.prototype.dataManagerSuccess=function(e,i){if(i===void 0&&(i=!0),this.currentViewData=e.count?e.result:[],this.chart.allowServerDataBinding=!1,this instanceof Zr){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var r={name:sb,series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger(sb,r),this.interior=r.fill,this.currentViewData=r.data}this.chart.stockChart&&!(this instanceof Zr)&&(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=e.count,this.refreshChart(i)},t.prototype.refreshChart=function(e){var i=this.chart;if(this instanceof Zr&&(i.visibleSeriesCount+=e?1:0),i.refreshTechnicalIndicator(this),this instanceof Zr&&this.category!=="TrendLine")for(var r=0,n=this.trendlines;r<n.length;r++){var s=n[r];s.setDataSource(this,i)}i.visibleSeries.length===i.visibleSeriesCount&&(i.refreshBound(),i.trigger("loaded",{chart:i}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof Zr&&(i.visibleSeriesCount+=e?0:1)},Me([w("")],t.prototype,"xName",void 0),Me([w("")],t.prototype,"colorName",void 0),Me([w("")],t.prototype,"high",void 0),Me([w("")],t.prototype,"low",void 0),Me([w("")],t.prototype,"open",void 0),Me([w("")],t.prototype,"close",void 0),Me([w("")],t.prototype,"volume",void 0),Me([w("")],t.prototype,"pointColorMapping",void 0),Me([w(!0)],t.prototype,"visible",void 0),Me([w(null)],t.prototype,"xAxisName",void 0),Me([w(null)],t.prototype,"yAxisName",void 0),Me([Ce(null,tM)],t.prototype,"animation",void 0),Me([w(null)],t.prototype,"fill",void 0),Me([w(1)],t.prototype,"width",void 0),Me([w("")],t.prototype,"dashArray",void 0),Me([w("")],t.prototype,"dataSource",void 0),Me([w()],t.prototype,"query",void 0),Me([Gt([],L6)],t.prototype,"segments",void 0),Me([w("X")],t.prototype,"segmentAxis",void 0),Me([w(!1)],t.prototype,"enableComplexProperty",void 0),t})(Oe),Zr=(function(o){jo(t,o);function t(e,i,r,n){var s=o.call(this,e,i,r,n)||this;return s.visibleSeriesCount=0,s.category="Series",s.isRectSeries=!1,s.drawPoints=[],s.lowDrawPoints=[],s.delayedAnimation=!1,s.rangeColorName=s.colorName.length>0?s.colorName:s.yName,s.currentData=[],s}return t.prototype.refreshAxisLabel=function(){if(this.xAxis.valueType.indexOf("Category")===-1)return null;this.xAxis.labels=[],this.xAxis.indexLabels={};for(var e={skeleton:"full",type:"dateTime"},i=this.chart.intl.getDateParser(e),r=this.chart.intl.getDateFormat(e),n=0,s=this.xAxis.series;n<s.length;n++){var a=s[n];if(a.visible&&a.category!=="TrendLine"){a.xMin=1/0,a.xMax=-1/0;for(var l=0,h=a.points;l<h.length;l++){var c=h[l];a.pushCategoryData(c,c.index,this.xAxis.valueType==="DateTimeCategory"?Date.parse(i(r(c.x))).toString():c.x),a.xMin=Math.min(a.xMin,c.xValue),a.xMax=Math.max(a.xMax,c.xValue)}}}},t.prototype.findSeriesCollection=function(e,i,r){for(var n=[],s=0,a=i.axes;s<a.length;s++)for(var l=a[s],h=0,c=l.series;h<c.length;h++)for(var u=c[h],d=0,p=e.axes;d<p.length;d++)for(var f=p[d],v=0,m=f.series;v<m.length;v++){var y=m[v];y===u&&y.visible&&this.rectSeriesInChart(y,r)&&n.push(y)}return n},t.prototype.rectSeriesInChart=function(e,i){var r=e.type.toLowerCase();return r.indexOf("column")!==-1||r.indexOf("bar")!==-1||r.indexOf("histogram")!==-1||r.indexOf("hiloopenclose")!==-1||r.indexOf("candle")!==-1||r.indexOf("pareto")!==-1||r.indexOf("hilo")!==-1||e.drawType.indexOf("Column")!==-1||r.indexOf("waterfall")!==-1||r.indexOf("boxandwhisker")!==-1||i},t.prototype.calculateStackedValue=function(e,i){for(var r=0,n=i.columns;r<n.length;r++)for(var s=n[r],a=0,l=i.rows;a<l.length;a++){var h=l[a];this.calculateStackingValues(this.findSeriesCollection(s,h,!0),e)}},t.prototype.calculateStackingValues=function(e,i){var r,n,s=[],a=[],l=[],h,c,u,d=[];i&&(d=this.findFrequencies(e));for(var p=[],f=[],v=0;v<e.length;v++){var m=e[v];p[m.stackingGroup]?p[m.stackingGroup]!==void 0&&p[m.stackingGroup].push(m):(p[m.stackingGroup]=[],p[m.stackingGroup].push(m))}for(var y=Object.keys(p),b=0;b<y.length;b++){for(var S=[],C=[],x=p[y[b]],I=0,D=x;I<D.length;I++){var m=D[I];if(m.type.indexOf("Stacking")!==-1||m.drawType.indexOf("Stacking")!==-1&&m.chart.chartAreaType==="PolarRadar"){h=m.type.indexOf("StackingArea")!==-1?"StackingArea100":m.type.indexOf("StackingLine")!==-1?"StackingLine100":m.stackingGroup,m.type.indexOf("100")!==-1?(i=!0,d=[],d=this.findFrequencies(x)):i=!1,a[h]||(a[h]=[],l[h]=[]),s=m.yData,r=[],n=[],S.push(m),f=Eh(m);for(var M=0,E=f.length;M<E;M++)c=0,u=+s[M],a[h][f[M].xValue]===void 0&&(a[h][f[M].xValue]=0),l[h][f[M].xValue]===void 0&&(l[h][f[M].xValue]=0),i?(u=u/d[h][f[M].xValue]*100,u=isNaN(u)?0:u,f[M].percentage=+u.toFixed(2)):C[M]=C[M]?C[M]+Math.abs(u):Math.abs(u),u>=0?(c=a[h][f[M].xValue],a[h][f[M].xValue]+=u):(c=l[h][f[M].xValue],l[h][f[M].xValue]+=u),r.push(c),n.push(u+c),i&&n[M]>100&&(n[M]=100);m.stackedValues=new S6(r,n);var A=m.yAxis.valueType==="Logarithmic",L=m.type.indexOf("Column")!==-1||m.type.indexOf("Bar")!==-1;m.yMin=A&&L&&m.yMin<1?m.yMin:m.yAxis.startFromZero&&m.yAxis.rangePadding==="Auto"&&m.yMin>=0?0:parseFloat(Math.min.apply(0,i?r:n).toFixed(10)),m.yMax=Math.max.apply(0,n),m.yMin>Math.min.apply(0,n)&&(m.yMin=i?-100:A&&L&&m.yMin<1?m.yMin:Math.min.apply(0,n)),m.yMax<Math.max.apply(0,r)&&(m.yMax=0)}}this.findPercentageOfStacking(S,C,i)}},t.prototype.findPercentageOfStacking=function(e,i,r){for(var n=0,s=e;n<s.length;n++){var a=s[n];if(r)return null;for(var l=0,h=Eh(a);l<h.length;l++){var c=h[l];c.percentage=Math.abs(+(c.y/i[c.index]*100).toFixed(2))}}},t.prototype.findFrequencies=function(e){for(var i=[],r,n=[],s=0,a=e;s<a.length;s++){var l=a[s];if(l.yAxis.isStack100=l.type.indexOf("100")!==-1,n=Eh(l),l.type.indexOf("Stacking")!==-1){r=l.type.indexOf("StackingArea")!==-1?"StackingArea100":l.type.indexOf("StackingLine")!==-1?"StackingLine100":l.stackingGroup,i[r]||(i[r]=[]);for(var h=0,c=n.length;h<c;h++)i[r][n[h].xValue]===void 0&&(i[r][n[h].xValue]=0),l.yData[h]>0?i[r][n[h].xValue]+=l.yData[h]:i[r][n[h].xValue]-=l.yData[h]}}return i},t.prototype.renderSeries=function(e){if(this.chart.stockChart&&this.xAxis.valueType==="DateTimeCategory"){for(var i=0;i<this.points.length;i++){var r=this.xAxis.labels.indexOf(Date.parse(this.points[i].x.toString()).toString());this.points[i].xValue=r,e.series.length>1&&(this.xData[i]=r,this.xMin=this.xMin>r?r:this.xMin,this.xMax=this.xMax<r?r:this.xMax)}if(this instanceof t&&this.type.indexOf("Spline")>-1){var n=this.type.indexOf("Area")>-1,s=this.type.indexOf("Range")>-1;this.chart["spline"+(n?s?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}}var a=_r(this.type);a=a.replace("100",""),e[a+"SeriesModule"]&&(this.category!=="Indicator"&&this.category!=="TrendLine"&&this.createSeriesElements(e),this.visiblePoints=Eh(this),this.chart.enableCanvas?(this.chart.canvasRender.ctx.save(),this.chart.canvasRender.ctx.beginPath(),e.requireInvertedAxis?this.chart.canvasRender.ctx.rect(this.yAxis.rect.x,this.xAxis.rect.y,this.yAxis.rect.width,this.xAxis.rect.height):this.chart.canvasRender.ctx.rect(this.xAxis.rect.x,this.yAxis.rect.y,this.xAxis.rect.width,this.yAxis.rect.height),this.chart.canvasRender.ctx.clip(),e[a+"SeriesModule"].render(this,this.xAxis,this.yAxis,e.requireInvertedAxis),this.chart.canvasRender.ctx.restore()):e[a+"SeriesModule"].render(this,this.xAxis,this.yAxis,e.requireInvertedAxis),this.category!=="Indicator"&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&(this.chart.enableCanvas?(this.chart.canvasRender.ctx.save(),this.chart.canvasRender.ctx.beginPath(),e.requireInvertedAxis?this.chart.canvasRender.ctx.rect(this.yAxis.rect.x,this.xAxis.rect.y,this.yAxis.rect.width,this.xAxis.rect.height):this.chart.canvasRender.ctx.rect(this.xAxis.rect.x,this.yAxis.rect.y,this.xAxis.rect.width,this.yAxis.rect.height),this.chart.canvasRender.ctx.clip(),e.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.chart.canvasRender.ctx.restore()):e.dataLabelModule.render(this,this.chart,this.marker.dataLabel)),!this.chart.enableCanvas&&this.lastValueLabel.enable&&e.lastValueLabelModule.render(this,this.chart,this.lastValueLabel),this.appendSeriesElement(e.seriesElements,e)),this.chart.enableCanvas||this.performAnimation(e,a,this.errorBar,this.marker,this.marker.dataLabel))},t.prototype.createSeriesElements=function(e){if(this.category!=="Indicator"){var i=e.element.id,r=this.marker.border.width+8+5,n=this.type==="Bubble"||this.type==="Scatter"||!this.marker.visible&&e.tooltip.shared&&e.enableCanvas?e.svgRenderer:e.renderer,s=this.index===void 0?this.category:this.index,a=void 0,l=void 0,h=void 0;if(this.type==="Scatter"||this.drawType==="Scatter"?(a=(this.marker.height+r)/2,l=(this.marker.width+r)/2):(a=0,l=0),e.chartAreaType==="PolarRadar"){var c=this.drawType==="Scatter"?Math.max(this.marker.width,this.marker.height):0;h=new vb(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,e.radius+c),this.clipRectElement=Rc(e.redraw,h,n,"drawCircularClipPath")}else h=new ys(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,{x:this.xAxis.columnIndex===0?-l:0,y:this.yAxis.rowIndex===e.rows.length-1?-a:0,width:this.clipRect.width+(this.xAxis.columnIndex===e.columns.length-1?l*2:l),height:this.clipRect.height+(this.yAxis.rowIndex===0?a*2:a)}),this.clipRectElement=Rc(e.redraw,h,n);var u=e.chartAreaType==="Cartesian"?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=n.createGroup({id:i+"SeriesGroup"+s,transform:u,"clip-path":"url(#"+i+"_ChartSeriesClipRect_"+s+")"}),this.seriesElement&&(this.seriesElement.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.seriesElement.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.seriesElement.style.outline="none",this.seriesElement.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.name+","+this.type+" series with "+this.points.length+" data points"),this.seriesElement.setAttribute("aria-hidden","false")),(!this.chart.enableCanvas||this.type==="Bubble")&&(this.seriesElement.setAttribute("tabindex",this.accessibility.focusable?s===0?"0":this.checkTabindex(e.visibleSeries,s)?"":String(this.accessibility.tabIndex):"-1"),this.seriesElement.style.outline="none",this.seriesElement.appendChild(this.clipRectElement))}},t.prototype.checkTabindex=function(e,i){for(var r=0;r<i;r++)if(e[r].visible)return!0;return!1},t.prototype.appendSeriesElement=function(e,i){var r=this.marker,n=r.dataLabel,s=this.lastValueLabel,a=i.redraw;if(this.category!=="TrendLine"){gt(i.enableCanvas,i.seriesElements,this.seriesElement,a);var l=this.errorBar;l.visible&&(i.chartAreaType==="PolarRadar"?gt(i.enableCanvas,i.seriesElements,this.seriesElement,a):gt(i.enableCanvas,i.seriesElements,this.errorBarElement,a))}r.visible&&(i.chartAreaType==="Cartesian"||this.drawType!=="Scatter"&&i.chartAreaType==="PolarRadar")&&this.type!=="Scatter"&&this.type!=="Bubble"&&this.type!=="Candle"&&this.type!=="Hilo"&&this.type!=="HiloOpenClose"&&this.symbolElement&&gt(i.enableCanvas,i.seriesElements,this.symbolElement,a),n.visible&&this.textElement&&(gt(i.enableCanvas,i.dataLabelElements,this.shapeElement,a),gt(i.enableCanvas,i.dataLabelElements,this.textElement,a)),!i.enableCanvas&&i.dataLabelElements.hasChildNodes()&&i.seriesElements.appendChild(i.dataLabelElements),s.enable&&this.lastValueLabelElement&&gt(i.enableCanvas,i.lastValueLabelElements,this.lastValueLabelElement,a)},t.prototype.performAnimation=function(e,i,r,n,s){(this.animation.enable&&Yt!=="Disable"||Yt==="Enable")&&e.animateSeries&&(!e.stockChart||!e.stockChart.isStockChartRendered)&&(e[i+"SeriesModule"].doAnimation(this),r.visible&&e.errorBarModule.doErrorBarAnimation(this),n.visible&&(this.isRectSeries||this.type==="Line"||this.type==="Polar"||this.type==="Radar")&&e.markerRender.doMarkerAnimation(this),s.visible&&j.info.name!=="edge"&&!j.isIE&&e.dataLabelModule.doDataLabelAnimation(this))},t.prototype.setPointColor=function(e,i){return i=e.interior||i,e.isEmpty&&this.emptyPointSettings.fill||i},t.prototype.setBorderColor=function(e,i){return i.width=e.isEmpty&&this.emptyPointSettings.border.width||i.width,i.color=e.isEmpty&&this.emptyPointSettings.border.color||i.color,i},t.prototype.addPoint=function(e,i){var r=this.yMin,n=this.yMax;if(this.removeTrackballElements(),this.dataSource.push(e),this.type==="Radar"||this.type==="Polar")return this.chart.refresh();if(this.type==="Histogram"){this.currentViewData=this.chart[_r(this.type)+"SeriesModule"].processInternalData(pe([],this.dataSource,null,!0),this);for(var s=0;s<this.currentViewData.length;s++)this.updatePoint(s)}else{this.currentViewData=this.dataSource;var a=this.points.length===0?0:this.points[this.points.length-1].index+1;this.updatePoint(a)}if(this.category==="Pareto"){var l=pe([],this.dataSource,null,!0),h=this.chart.visibleSeries[this.index+this.chart.series.length];h.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(l,this);for(var s=0;s<h.currentViewData.length;s++)h.points[s]||h.updatePoint(s),h.points[s].y=h.points[s].yValue=h.currentViewData[s][h.yName]}this.visiblePoints.push(this.points[this.points.length-1]),this.updateSplineValue(),this.chart.calculateStackValues(),this.chart.redraw=this.chart.enableAnimation;var c=this.chart.duration;if(this.chart.duration=g(i)?500:i,this.chart.animateSeries=!1,this.chart.pointsAdded=!0,this.chart.enableAnimation&&!(this.isRectSeries||this.type==="Bubble"||this.type==="Scatter")&&this.type.indexOf("step")===-1&&this.marker&&this.marker.visible&&this.visible){for(var s=this.points.length-2;s>=0;s--)if(this.points[s]&&!g(this.points[this.points.length-2].y)&&this.points[s].symbolLocations&&this.points[s].symbolLocations[0]!==void 0){this.chart.markerRender.renderMarker(this,this.points[this.points.length-2],this.points[s].symbolLocations[0],null,!0);break}}this.yMin>=r&&this.yMax<=n&&(Ps(this.xAxis)||(this.xAxis.baseModule.calculateRangeAndInterval(new Wt(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis()),this.chart.pointsAdded=!1,this.updateSeries(!0,!1)),(this.yMin<r||this.yMax>n)&&(this.updateChartAxis(),this.chart.pointsAdded=!1,this.updateSeries(!0,!0)),this.chart.redraw=!1,this.chart.duration=c},t.prototype.removePoint=function(e,i){var r=pe([],this.dataSource,null,!0),n=this.chart.duration;if(r.length>0&&e>=0&&e<r.length){if(r.splice(e,1),this.dataSource.splice(e,1),this.removeTrackballElements(e),this.type==="Radar"||this.type==="Polar")return this.chart.refresh();if(this.chart.redraw=this.chart.enableAnimation,this.chart.animateSeries=!1,this.chart.pointsAdded=!0,this.chart.duration=g(i)?500:i,this.type==="Histogram"){var s=this.points.length;this.points=[],this.visiblePoints=[],this.currentViewData=this.chart[_r(this.type)+"SeriesModule"].processInternalData(pe([],this.dataSource,null,!0),this);for(var a=0;a<this.currentViewData.length;a++)this.updatePoint(a);s>this.points.length&&(this.removedPointIndex=e)}else this.removedPointIndex=e,this.points.splice(e,1),this.visiblePoints.splice(e,1);this.yData=[],this.xData=[];var l=this.yMin,h=this.yMax;this.yMin=1/0,this.xMin=1/0,this.yMax=-1/0,this.xMax=-1/0,this.xAxis.valueType.indexOf("Category")>-1&&(this.xAxis.labels=[],this.xAxis.indexLabels={}),e===0&&(this.chart.pointsRemoved=this.chart.enableAnimation);for(var a=0;a<this.points.length;a++)this.updatePointsAfterRemoval(a);if(this.category==="Pareto"){var c=this.chart.visibleSeries[this.index+this.chart.series.length];c.yMin=1/0,c.xMin=1/0,c.yMax=-1/0,c.xMax=-1/0,c.points.splice(e,1),c.visiblePoints.splice(e,1),c.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.dataSource,this);for(var a=0;a<c.currentViewData.length;a++)c.points[a].y=c.points[a].yValue=c.currentViewData[a][c.yName],c.updatePointsAfterRemoval(a)}this.updateSplineValue(),this.chart.calculateStackValues(),!Ps(this.xAxis)&&h===this.yMax&&l===this.yMin?(this.xAxis.baseModule.calculateRangeAndInterval(new Wt(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis(),this.createSeriesElements(this.chart),this.chart.pointsAdded=!1,this.updateSeries(!0,!1)):(h<this.yMax||l>this.yMin||h>this.yMax||l<this.yMin)&&(this.updateChartAxis(),this.createSeriesElements(this.chart),this.chart.pointsAdded=!1,this.updateSeries(!0,!0))}gt(this.chart.enableCanvas,this.chart.seriesElements,this.seriesElement,!0),this.chart.redraw=!1,this.chart.duration=n,this.chart.pointsRemoved=!1,this.removedPointIndex=null},t.prototype.updatePointsAfterRemoval=function(e){var i=this.points[e],r={skeleton:"full",type:"dateTime"},n=this.chart.intl.getDateParser(r),s=this.chart.intl.getDateFormat(r);this.xAxis.valueType==="Category"?this.pushCategoryData(i,e,i.x):this.xAxis.valueType==="DateTimeCategory"&&this.chart.series.length===1&&this.pushCategoryData(i,e,Date.parse(n(s(i.x))).toString()),this.pushData(i,e),this.setEmptyPoint(this.points[e],e)},t.prototype.removeTrackballElements=function(e){if(this.marker.visible)if(e!==void 0){var i=this.chart.element.id+"_Series_"+this.index+"_Point_"+e+"_Trackball_",r=fe(i+"0");r&&r.remove();var n=fe(i+"1");n&&n.remove();var s=fe(this.chart.element.id+"_Series_"+this.index+"_Point_"+e+"_Symbol");s&&s.setAttribute("visibility","visible")}else{var a=this.chart.element.id+"_EJ2-Trackball_Series_"+this.index+"_Point_",l=document.querySelectorAll('[class*="'+a+'"]');if(l[0]){var h=l[0].id.match(/_Point_(\d+)_/),c=h?parseInt(h[1],10):null;l[0].remove();var s=fe(this.chart.element.id+"_Series_"+this.index+"_Point_"+c+"_Symbol");s&&s.setAttribute("visibility","visible")}l[1]&&l[1].remove()}if(this.chart.tooltip.enable){this.chart.tooltipModule.previousPoints=[];var u=fe(this.chart.element.id+"_tooltip");u&&u.remove()}},t.prototype.setData=function(e,i){var r=this;if(!e)return null;this.currentViewData=null;var n=[];if(this.dataSource.length===e.length){for(var s=0;s<e.length;s++)if(e[s][this.xName]instanceof Date?n.push(e[s][this.xName].getTime()):n.push(e[s][this.xName]),this.currentData.length<this.dataSource.length){var a=pe([],this.dataSource,null,!0);a[s][this.xName]instanceof Date?this.currentData.push(a[s][this.xName].getTime()):this.currentData.push(a[s][this.xName])}}var l=n.every(function(E){return r.currentData.indexOf(E)!==-1});this.currentViewData&&(l=!0);var h=!1,c=this.yMin,u=this.yMax;this.yMin=1/0,this.yMax=-1/0;var d=[];this.chart.dataLabelCollections=[],this.chart.rotatedDataLabelCollections=[];var p=!1,f=null;if(this.dataSource.length===e.length&&!(this.type==="Radar"||this.type==="Polar")&&l)if(p=!0,this.yData=[],this.type==="Histogram"&&this.dataSource.length===e.length){var v=this.chart[_r(this.type)+"SeriesModule"].processInternalData(pe([],e,null,!0),this);this.currentViewData=v;for(var m=0;m<v.length;m++)this.updatePoint(m)}else for(var s=0;s<e.length;s++){var y=e[s][this.xName],b=this.dataSource[s][this.xName];e[s][this.xName]instanceof Date&&(y=e[s][this.xName].getTime(),b=this.dataSource[s][this.xName].getTime()),this.currentData[s]!==y&&(h=!0);var S=this.points[s],C=this.enableComplexProperty?V:this.getObjectValue,x=this.dataSource[s],I=e[s];this.seriesType==="XY"||this.seriesType==="BoxPlot"?(S.y=C(this.yName,I),this.type==="Bubble"&&x[this.size]!==I[this.size]&&(S.size=C(this.size,I)),d.push(s)):(x[this.high]!==I[this.high]||x[this.low]!==I[this.low]||x[this.open]!==I[this.open]||x[this.close]!==I[this.close]||x[this.volume]!==I[this.volume])&&(S.high=C(this.high,I),S.low=C(this.low,I),S.open=C(this.open,I),S.close=C(this.close,I),S.volume=C(this.volume,I),d.push(s)),S.yValue=S.y,S.x=C(this.xName,I),this.currentViewData||(S.index=this.xAxis.valueType==="DateTime"&&typeof S.x!="number"?this.currentData.indexOf(S.x.getTime()):this.currentData.indexOf(S.x)),(this.xAxis.valueType==="Category"||this.xAxis.valueType==="DateTimeCategory")&&s<this.xAxis.visibleLabels.length&&(this.xAxis.visibleLabels[s].value=n.indexOf(this.currentData[s*this.xAxis.visibleRange.interval]),this.xAxis.labels[s]=String(n[s])),this.setEmptyPoint(S,s),this.dataSource[s]=e[s]}if(!p)this.dataSource=e;else{this.chart.redraw=this.chart.enableAnimation,this.chart.animateSeries=!1,this.chart.pointsAdded=!0;var D=this.chart.duration;if(this.chart.duration=g(i)?500:i,this.type.indexOf("Stacking")!==-1&&this.chart.calculateStackValues(),this.updateSplineValue(),u===this.yMax&&c===this.yMin&&this.visible)this.chart.pointsAdded=!1,this.chart[_r(this.category==="Pareto"?"Column":this.type.replace("100",""))+"SeriesModule"].updateDirection(this,d,this.chart.requireInvertedAxis),this.lastValueLabel.enable&&this.chart.lastValueLabelModule&&(this.chart.lastValueLabelCollections=[],this.chart.lastValueLabelModule.render(this,this.chart,this.lastValueLabel,!0),this.lastValueLabelElement&&gt(this.chart.enableCanvas,this.chart.lastValueLabelElements,this.lastValueLabelElement,!0)),this.chart.annotationModule&&this.chart.annotationModule.renderAnnotations(fe(this.chart.element.id+"_Secondary_Element")),!Ps(this.xAxis)&&h&&this.xAxis.updateAxis();else if((u<this.yMax||c>this.yMin||u>this.yMax||c<this.yMin)&&this.visible){var M=this.yAxis.maxLabelSize.width;this.yAxis.baseModule.calculateRangeAndInterval(new Wt(this.chart.availableSize.width,this.yAxis.rect.height),this.yAxis),M<this.yAxis.maxLabelSize.width?(this.chart.calculateBounds(),this.chart.axisCollections.forEach(function(E){Ps(E)||E.updateAxis()}),this.chart.chartAxisLayoutPanel.drawPaneLines(this.chart),this.chart.renderAreaBorder()):(Ps(this.yAxis)||this.yAxis.updateAxis(),!Ps(this.xAxis)&&h&&this.xAxis.updateAxis(),this.type==="Histogram"&&!Ps(this.xAxis)&&(this.xAxis.baseModule.calculateRangeAndInterval(new Wt(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis())),this.chart.pointsAdded=!1,h&&(this.chart[_r(this.category==="Pareto"?"Column":this.type.replace("100",""))+"SeriesModule"].updateDirection(this,d,this.chart.requireInvertedAxis),f=this.index),this.updateSeries(!1,!0,f),this.chart.stripLineModule&&this.chart.stripLineModule.renderStripLine(this.chart,"Behind",this.chart.axisCollections)}this.chart.redraw=!1,this.chart.pointsRemoved=!1,this.chart.duration=D}},t.prototype.updateChartAxis=function(){var e=this.yAxis.maxLabelSize.width;this.yAxis.baseModule.calculateRangeAndInterval(new Wt(this.chart.availableSize.width,this.yAxis.rect.height),this.yAxis),e<this.yAxis.maxLabelSize.width?(this.chart.calculateBounds(),this.chart.axisCollections.forEach(function(i){Ps(i)||i.updateAxis()}),this.chart.chartAxisLayoutPanel.drawPaneLines(this.chart),this.chart.renderAreaBorder()):(Ps(this.xAxis)||(this.xAxis.baseModule.calculateRangeAndInterval(new Wt(this.xAxis.rect.width,this.chart.availableSize.height),this.xAxis),this.xAxis.updateAxis()),Ps(this.yAxis)||this.yAxis.updateAxis()),this.chart.stripLineModule&&this.chart.stripLineModule.renderStripLine(this.chart,"Behind",this.chart.axisCollections)},t.prototype.updateSeries=function(e,i,r){var n=[];if(e&&i){var s=new Set(this.xAxis.series.concat(this.yAxis.series));s.forEach(function(u){n.push(u)})}else n=e?this.xAxis.series.slice():this.yAxis.series.slice();for(var a=0,l=n;a<l.length;a++){var h=l[a];if(h.visible&&h.index!==r){$I(h,this.chart.enableCanvas);var c="translate("+this.clipRect.x+","+this.clipRect.y+")";h.seriesElement.setAttribute("transform",c),h.chart[_r(h.type.replace("100",""))+"SeriesModule"].render(h,h.xAxis,h.yAxis,h.chart.requireInvertedAxis,h.chart.enableAnimation),h.marker.visible&&h.chart.chartAreaType==="Cartesian"&&h.type!=="Scatter"&&h.type!=="Bubble"&&h.type!=="Candle"&&h.type!=="Hilo"&&h.type!=="HiloOpenClose"&&h.symbolElement&&(h.symbolElement.setAttribute("transform",c),gt(h.chart.enableCanvas,h.chart.seriesElements,h.symbolElement,!0)),h.marker.dataLabel.visible&&h.chart.dataLabelModule&&(h.chart.dataLabelCollections=[],h.chart.dataLabelModule.render(h,h.chart,h.marker.dataLabel),h.textElement&&(h.shapeElement&&h.shapeElement.setAttribute("transform",c),gt(h.chart.enableCanvas,h.chart.dataLabelElements,h.shapeElement,!0),h.textElement.setAttribute("transform",c),gt(h.chart.enableCanvas,h.chart.dataLabelElements,h.textElement,!0))),h.lastValueLabel.enable&&h.chart.lastValueLabelModule&&(h.chart.lastValueLabelCollections=[],h.chart.lastValueLabelModule.render(h,h.chart,h.lastValueLabel,!0),h.lastValueLabelElement&&gt(h.chart.enableCanvas,h.chart.lastValueLabelElements,h.lastValueLabelElement,!0)),h.chart.annotationModule&&h.chart.annotationModule.renderAnnotations(fe(h.chart.element.id+"_Secondary_Element"))}}},t.prototype.updatePoint=function(e){var i=new eM,r=this instanceof t&&this.marker.dataLabel.name?this.marker.dataLabel.name:"",n=this instanceof t&&this.type==="Histogram"?"x":this.xName;if(this.xAxis.valueType==="Category")this.pushCategoryPoint(i,e,r,n);else if(this.xAxis.valueType.indexOf("DateTime")>-1){var s=this.points[e],a={skeleton:"full",type:"dateTime"},l=this.chart.intl.getDateParser(a),h=this.chart.intl.getDateFormat(a);this.pushDateTimePoint(s,e,r,n,l,h)}else this.pushDoublePoint(i,e,r,n)},t.prototype.formatAccessibilityDescription=function(e,i){var r=i.accessibility.accessibilityDescriptionFormat;return r.replace("${series.name}",i&&i.name?i.name:"").replace("${point.x}",e&&e.x?e.x.toString():"").replace("${point.y}",e&&e.y?e.y.toString():"").replace("${point.high}",e&&e.high?e.high.toString():"").replace("${point.low}",e&&e.low?e.low.toString():"").replace("${point.close}",e&&e.close?e.close.toString():"").replace("${point.open}",e&&e.open?e.open.toString():"").replace("${point.maximum}",e&&e.maximum?e.maximum.toString():"").replace("${point.minimum}",e&&e.minimum?e.minimum.toString():"").replace("${point.median}",e&&e.median?e.median.toString():"").replace("${point.lowerQuartile}",e&&e.lowerQuartile?e.lowerQuartile.toString():"").replace("${point.upperQuartile}",e&&e.upperQuartile?e.upperQuartile.toString():"")},Me([w("")],t.prototype,"name",void 0),Me([w("")],t.prototype,"yName",void 0),Me([w("Line")],t.prototype,"drawType",void 0),Me([w(!0)],t.prototype,"isClosed",void 0),Me([w(null)],t.prototype,"bearFillColor",void 0),Me([w(null)],t.prototype,"bullFillColor",void 0),Me([w(!1)],t.prototype,"enableSolidCandles",void 0),Me([w("")],t.prototype,"size",void 0),Me([w(null)],t.prototype,"binInterval",void 0),Me([w(!1)],t.prototype,"showNormalDistribution",void 0),Me([w("")],t.prototype,"stackingGroup",void 0),Me([Ce({color:null,width:0},qn)],t.prototype,"border",void 0),Me([Ce({},M6)],t.prototype,"lastValueLabel",void 0),Me([w(1)],t.prototype,"opacity",void 0),Me([w(0)],t.prototype,"zOrder",void 0),Me([w("")],t.prototype,"groupName",void 0),Me([w("Line")],t.prototype,"type",void 0),Me([Ce(null,N6)],t.prototype,"errorBar",void 0),Me([Ce(null,sM)],t.prototype,"marker",void 0),Me([Ce(null,E6)],t.prototype,"paretoOptions",void 0),Me([Ce({},Fq)],t.prototype,"dragSettings",void 0),Me([Gt([],T6)],t.prototype,"trendlines",void 0),Me([w(!0)],t.prototype,"enableTooltip",void 0),Me([w(!0)],t.prototype,"showNearestTooltip",void 0),Me([w("")],t.prototype,"tooltipFormat",void 0),Me([w("")],t.prototype,"tooltipMappingName",void 0),Me([w("SeriesType")],t.prototype,"legendShape",void 0),Me([w("")],t.prototype,"legendImageUrl",void 0),Me([w(null)],t.prototype,"selectionStyle",void 0),Me([w(null)],t.prototype,"unSelectedStyle",void 0),Me([w(null)],t.prototype,"nonHighlightStyle",void 0),Me([w(1)],t.prototype,"minRadius",void 0),Me([w(3)],t.prototype,"maxRadius",void 0),Me([w("Natural")],t.prototype,"splineType",void 0),Me([w(.5)],t.prototype,"cardinalSplineTension",void 0),Me([Ce(null,ZR)],t.prototype,"emptyPointSettings",void 0),Me([w(!0)],t.prototype,"showMean",void 0),Me([w("Normal")],t.prototype,"boxPlotMode",void 0),Me([w(!0)],t.prototype,"showOutliers",void 0),Me([w(null)],t.prototype,"columnWidth",void 0),Me([w(null)],t.prototype,"columnWidthInPixel",void 0),Me([w("Rectangle")],t.prototype,"columnFacet",void 0),Me([w(0)],t.prototype,"columnSpacing",void 0),Me([w("#C64E4A")],t.prototype,"negativeFillColor",void 0),Me([w("#4E81BC")],t.prototype,"summaryFillColor",void 0),Me([w()],t.prototype,"intermediateSumIndexes",void 0),Me([w()],t.prototype,"sumIndexes",void 0),Me([w("Left")],t.prototype,"step",void 0),Me([w(!1)],t.prototype,"noRisers",void 0),Me([Ce({},Mq)],t.prototype,"accessibility",void 0),Me([Ce({color:"black",width:2},ld)],t.prototype,"connector",void 0),Me([Ce(null,Aq)],t.prototype,"cornerRadius",void 0),t})(DO),EO=(function(){function o(t,e){this.initDataManager(t,e)}return o.prototype.initDataManager=function(t,e){this.dataManager=t instanceof oe?t:new oe(t),this.query=e instanceof Pe?e:new Pe},o.prototype.generateQuery=function(){var t=this.query.clone();return t},o.prototype.getData=function(t){var e=this;if(this.dataManager.ready){var i=new zn,r=this.dataManager.ready;return r.then(function(){e.dataManager.executeQuery(t).then(function(n){i.resolve(n)})}).catch(function(n){i.reject(n)}),i.promise}else return this.dataManager.executeQuery(t)},o})(),k6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),F6=(function(o){k6(t,o);function t(e){var i=o.call(this,e)||this;return i.elementId=e.element.id,i.commonXvalues=[],i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(j.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(j.touchEndEvent,this.mouseUpHandler,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(j.touchMoveEvent,this.mouseMoveHandler),this.chart.off(j.touchEndEvent,this.mouseUpHandler))},t.prototype.mouseUpHandler=function(){var e=this.chart;e.isTouch&&!e.crosshair.enable&&!this.isSelected(e)&&!(this.chart.zoomModule&&fe(this.elementId+"_ZoomArea"))&&this.markerMove(!0)},t.prototype.mouseMoveHandler=function(){var e=this.chart;(e.highlightMode!=="None"||e.tooltip.enable)&&(!e.isTouch||e.startMove)&&!this.isSelected(e)&&!(this.chart.zoomModule&&(fe(this.elementId+"_ZoomArea")||this.chart.zoomModule.startPanning))&&this.markerMove(!1)},t.prototype.markerMove=function(e){var i=this,r=this.chart;this.currentPoints=[];var n,s,a,l;if(!r.tooltip.shared||!r.tooltip.enable)n=this.getData(),l=n.series,s=this.previousPoints[0],a=l&&(l.type==="Bubble"||l.drawType==="Scatter"||l.type==="Scatter"||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose"&&l.marker.visible&&l.marker.width!==0&&l.marker.height!==0),n.lierIndex=this.lierIndex,n.point&&a&&(!s||s.point!==n.point||s&&s.lierIndex>3&&s.lierIndex!==this.lierIndex)&&this.currentPoints.push(n),n.point&&a&&r.isPointMouseDown&&this.currentPoints.push(n),this.currentPoints.length===0&&n.point&&!a&&!g(s)&&s.point!==n.point&&(this.removeHighlightedMarker(s.series,s.point),this.previousPoints=pe([],n,null,!0)),r.tooltip.showNearestTooltip&&this.chart.tooltipModule&&this.chart.tooltipModule.currentPoints&&(a||l.type==="Pareto"&&l.paretoOptions.marker.visible)&&this.currentPoints.length===0&&Pi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect)&&(this.currentPoints=this.chart.tooltipModule.currentPoints);else{if(!Pi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))return null;if(r.tooltip.enable){var h=r.chartAreaType==="PolarRadar"?this.getData():null;if(!this.chart.tooltip.showNearestPoint)this.currentPoints=this.chart.tooltipModule.currentPoints;else for(var c=0,u=r.visibleSeries;c<u.length;c++){var d=u[c];!d.enableTooltip||d.category==="Indicator"||(r.chartAreaType==="Cartesian"&&d.visible?n=this.getClosestX(r,d,this.commonXValue(this.chart.visibleSeries)):r.chartAreaType==="PolarRadar"&&d.visible&&h.point!==null&&(n=new Zf(d.points[h.point.index],d)),n&&(this.currentPoints.push(n),n=null))}}}var p=this.previousPoints.length;if((this.currentPoints.length>0||p>0&&r.tooltip.shared)&&(p===0||r.isPointMouseDown||p>0&&(this.currentPoints.length===0||this.previousPoints[0].point!==this.currentPoints[0].point))){if(p>0)for(var f=0,v=this.previousPoints;f<v.length;f++){var m=v[f];g(m)||this.removeHighlightedMarker(m.series,m.point)}for(var y=function(I){(I&&I.point||l.type!=="Candle"&&l.type!=="Hilo"&&l.type!=="HiloOpenClose")&&(CO(b.markerExplode),b.isRemove=!0,I.point.symbolLocations.map(function(D,M){I.series.marker.allowHighlight&&(!I.series.isRectSeries||I.point.marker.visible)&&i.drawTrackBall(I.series,I.point,D,M)}))},b=this,S=0,C=this.currentPoints;S<C.length;S++){var x=C[S];y(x)}this.previousPoints=pe([],this.currentPoints,null,!0)}!r.tooltip.enable&&(this.currentPoints.length===0&&this.isRemove||e&&this.isRemove||!Pi(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))&&(this.isRemove=!1,g(this.previousPoints[0])||(this.markerExplode=+setTimeout(function(){i.previousPoints[0]&&i.removeHighlightedMarker(i.previousPoints[0].series,i.previousPoints[0].point)},2e3))),this.currentPoints=[]},t.prototype.animationDuration=function(){var e=200;return this.chart.maxPointCount>100?e=10:this.chart.maxPointCount>50&&(e=100),e},t.prototype.drawTrackBall=function(e,i,r,n){var s=i.marker,a=e.marker,l=s.shape||a.shape||"Circle",h;if(l==="None"||l==="Image")return null;var c=e.symbolElement||e.seriesElement,u;this.chart.highlightModule&&this.chart.highlightMode!=="None"&&(u=this.chart.highlightModule.generateStyle(e)),this.chart.selectionModule&&this.chart.selectionMode!=="None"&&(u=this.chart.selectionModule.generateStyle(e));var d=this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Trackball"+(n||"");fe(d+"_1")&&fe(d+"_1").getAttribute("e-animate")&&(Mt.stop(fe(d+"_1")),Qe(fe(d+"_1")));var p=new Wt((s.width||a.width)+3,(s.height||a.height)+3),f=s.border||e.border,v=e.type==="BoxAndWhisker"||e.type==="Bubble"||e.type==="Scatter",m=f.color&&f.color!=="transparent"?f.color:s.fill||i.interior||(v?i.color:e.interior),y=eg(_n(m)),b=s.border?s.border.width:a.border.width,S=e.chart.themeStyle.markerShadow||"rgba("+y.r+","+y.g+","+y.b+",0.2)",C=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Symbol");if(g(C)||C.setAttribute("visibility","visible"),this.chart.enableCanvas){var x=document.getElementById(this.chart.element.id+"_Secondary_Element");h=this.chart.svgRenderer.createSvg({id:this.chart.element.id+"_trackball_svg",width:this.chart.availableSize.width,height:this.chart.availableSize.height}),h.style.cssText="position: absolute; display:block; pointer-events: none",x.appendChild(h)}for(var I=0;I<2;I++){var D=new Rr(d+"_"+I,I?s.fill||i.color||(v?e.interior:"#ffffff"):"transparent",b+(I?0:8),I?m:S,s.opacity||a.opacity,e.marker.border.dashArray,""),M=Zs(r,l,p,s.imageUrl,D,"",this.chart.svgRenderer,e.clipRect);M.setAttribute("class",this.elementId+"_EJ2-Trackball_Series_"+e.index+"_Point_"+i.index);var E=c.id.indexOf("Symbol")!==-1?"_Symbol":"",A=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+E);u!==""&&!g(u)&&!g(A)&&A.hasAttribute("class")&&u===A.getAttribute("class")&&M.classList.add(u),M.setAttribute("clip-path",c.getAttribute("clip-path")),M.setAttribute("transform",c.getAttribute("transform")),this.chart.enableCanvas?h.appendChild(M):this.chart.svgObject.appendChild(M),i.symbolLocations.length>1&&e.marker.visible&&e.type!=="Bubble"&&e.type!=="Scatter"&&this.trackballAnimate(M,0,this.animationDuration(),e,i.index,r,!1,!1)}i.symbolLocations.length<2&&e.marker.visible&&this.doAnimation(e,i,!1)},t.prototype.doAnimation=function(e,i,r){if(r===void 0&&(r=!1),!(e.type==="Bubble"||e.type==="Scatter"))for(var n=this.animationDuration(),s=0,a=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+e.index+"_Point_"+i.index),l=0,h=a.length;l<h;l++)this.trackballAnimate(a[l],s,n,e,i.index,i.symbolLocations[0],!1,r)},t.prototype.trackballAnimate=function(e,i,r,n,s,a,l,h,c){var u=a.x,d=a.y,p=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.x:0,f=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.y:0,v=e.getAttribute("transform"),m=n.marker.width/(n.marker.width+3),y=n.marker.height/(n.marker.height+3),b=Math.min(m,y);c||e.setAttribute("transform","translate("+(u+p)+" "+(d+f)+") scale("+b+") translate("+-u+" "+-d+")"),new Mt({}).animate(e,{duration:r,delay:i,progress:function(S){if(S.element.style.animation="",S.timeStamp>S.delay){if(!n.visible&&c){Qe(e);return}var C=S.timeStamp/S.duration,x=c?Math.max(b,1-(1-b)*C):Math.min(1,b+(1-b)*C);e.setAttribute("transform","translate("+(u+p)+" "+(d+f)+") scale("+x+") translate("+-u+" "+-d+")")}},end:function(){e.style.visibility="",e.setAttribute("transform",v),!l&&s===n.points.length-1&&n.chart.trigger("animationComplete",{series:n}),(c||h)&&Qe(e)}})},t.prototype.removeHighlightedMarker=function(e,i,r){if(e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=!1),!g(e)&&!g(i)){var n=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Symbol"),s=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+e.index+"_Point_"+i.index);if(s.length===0){var a=document.querySelectorAll('[class*="'+(this.elementId+"_EJ2-Trackball_Series_"+e.index+"_Point_"+i.index)+'"]');a[1]&&a[1].remove(),a[0]&&a[0].remove()}for(var l=s.length-1;l>=0;l--)(!e.marker.visible||s[l]&&s[l].id[s[l].id.length-1]==="0"||e.type==="Scatter")&&Qe(s[l]);for(var l=s.length-1;l>=0;l--)s[l]&&s[l].id[s[l].id.length-1]==="1"&&e.type!=="Bubble"&&e.type!=="Scatter"&&e.marker.visible&&(s[l].setAttribute("opacity",n?n.getAttribute("opacity"):s[l].getAttribute("opacity")),this.trackballAnimate(s[l],0,this.animationDuration(),e,i.index,i.symbolLocations[l],null,null,!0));g(n)||n.setAttribute("visibility","visible")}else for(var h=0,c=e.points;h<c.length;h++)for(var u=c[h],a=document.getElementsByClassName(this.elementId+"_EJ2-Trackball_Series_"+e.index+"_Point_"+u.index),n=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+u.index+"_Symbol"),l=0,d=a.length;l<d;l++)g(n)||n.setAttribute("visibility","visible"),Qe(a[0]);r&&(this.previousPoints=[])},t})(nM),R6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),TO=["Circle","Triangle","Diamond","Rectangle","Pentagon","InvertedTriangle","VerticalLine","Cross","Plus","HorizontalLine","Star"],O6=(function(o){R6(t,o);function t(e){var i=o.call(this,e)||this;return i.addEventListener(),i}return t.prototype.render=function(e){var i=this,r=e.chart.redraw;this.createElement(e,r);for(var n=function(h){h.visible&&h.symbolLocations&&h.symbolLocations.length&&h.symbolLocations.map(function(c,u){if(e.chart.chartAreaType==="Cartesian"&&(!e.isRectSeries||e.type.indexOf("Column")>-1)&&e.type.indexOf("100")===-1&&e.type.indexOf("Range")===-1){var d=e.chart.axisCollections.filter(function(p){return e.chart.isTransposed?p.orientation==="Horizontal":p.orientation==="Vertical"}).some(function(p){var f=p.actualRange;if(p.valueType==="Logarithmic"){var v=Tl(h.yValue,p.logBase);return isFinite(v)&&v>=f.min&&v<=f.max}return h.yValue>=f.min&&h.yValue<=f.max});e.marker.shape!=="None"&&d&&i.renderMarker(e,h,c,u,r)}else e.marker.shape!=="None"&&i.renderMarker(e,h,c,u,r)})},s=0,a=e.points;s<a.length;s++){var l=a[s];n(l)}},t.prototype.renderMarker=function(e,i,r,n,s){var a=e.index===void 0?e.category:e.index,l=e.marker;e.marker.shape=e.marker.shape?e.marker.shape:TO[a%10];var h={color:l.border.color,width:l.border.width},c=l.border.color,u,d,p,f;r.x=r.x+l.offset.x,r.y=r.y-l.offset.y;var v=e.type==="BoxAndWhisker",m=l.fill||(v||e.marker.isFilled?i.interior||e.interior:"#ffffff"),y,b=v&&!this.chart.enableCanvas?c6(e.seriesElement.childNodes,"Series_"+e.index+"_Point_"+i.index):e.symbolElement;h.color=c||e.setPointColor(i,e.interior);var S=this.elementId+"_Series_"+a+"_Point_"+(e.removedPointIndex!==null&&e.removedPointIndex<=i.index||this.chart.pointsAdded?i.index+1:i.index)+"_Symbol"+(n||""),C={cancel:!1,name:Ah,series:e,point:i,fill:i.isEmpty&&e.emptyPointSettings.fill||m,border:{color:e.type==="BoxAndWhisker"?!g(c)&&c!=="transparent"?c:f6(m,-.6):h.color,width:h.width},height:l.height,width:l.width,shape:l.shape};if(C.border=e.setBorderColor(i,{width:C.border.width,color:C.border.color}),(!e.isRectSeries||e.type==="BoxAndWhisker")&&(this.chart.trigger(Ah,C),i.color=C.fill),C.cancel)r=null,i.marker={visible:!1};else{var x=void 0;e.type==="RangeArea"||e.type==="RangeColumn"||e.drawType==="RangeColumn"||e.type==="SplineRangeArea"||e.type==="RangeStepArea"?x=n?i.low:i.high:v?x=i.outliers[n]:x=i.y;var I=C.point.marker.fill||C.fill,D=void 0;g(C.point.marker.border)?D={color:C.border.color,width:C.border.width}:D={color:C.point.marker.border.color||C.border.color,width:C.point.marker.border.width||C.border.width};var M=C.point.marker.width||C.width,E=C.point.marker.height||C.height,A=C.point.marker.opacity||l.opacity,L=C.point.marker.shape||C.shape,N=C.point.marker.imageUrl||l.imageUrl;f=new Rr(S,I,D.width,D.color,A,e.marker.border.dashArray),(b!=null||this.chart.enableCanvas)&&(s&&fe(f.id)&&(y=fe(f.id),p=L==="Circle"?"c":"",u={x:+y.getAttribute(p+"x"),y:+y.getAttribute(p+"y")},d=y.getAttribute("d")),y=Zs(r,L,new Wt(M,E),N,f,i.x.toString()+":"+x.toString(),this.chart.renderer,e.clipRect),y&&(y.setAttribute("role","img"),e.category==="TrendLine"&&f.id===this.elementId+"_Series_0_Point_0_Symbol"&&(y.setAttribute("tabindex","0"),y.setAttribute("class","e-chart-focused")),y.setAttribute("aria-label",e.accessibility.accessibilityDescriptionFormat?e.formatAccessibilityDescription(i,e):i.x+": "+i.y+", "+e.name)),gt(this.chart.enableCanvas,b,y,s,!0,p+"x",p+"y",u,d,!1,!1,null,e.chart.duration),e.removedPointIndex!==null&&e.removedPointIndex<=i.index&&(b.lastChild.id=this.elementId+"_Series_"+a+"_Point_"+i.index+"_Symbol"+(n||""))),i.marker={border:D,fill:I,height:E,visible:!0,shape:L,width:M,imageUrl:N}}},t.prototype.createElement=function(e,i){var r,n=e.marker,s=n.border.width+(this.chart.zoomModule&&this.chart.zoomModule.isAxisZoomed(this.chart.axisCollections)?0:13),a=e.chart.svgRenderer,l=e.index===void 0?e.category:e.index,h,c=e.chart.chartAreaType==="Cartesian"?"translate("+e.clipRect.x+","+e.clipRect.y+")":"";if(n.visible){var u=(n.height+s)/2,d=(n.width+s)/2;if(e.chart.chartAreaType==="Cartesian"?(h=new ys(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,{x:-d,y:-u,width:e.clipRect.width+d*2,height:e.clipRect.height+u*2},0,0,"",e.marker.border.dashArray),r=Rc(i,h,a)):(h=new vb(this.elementId+"_ChartMarkerClipRect_"+l,"transparent",{width:1,color:"Gray"},1,e.clipRect.width/2+e.clipRect.x,e.clipRect.height/2+e.clipRect.y,e.chart.radius+Math.max(u,d)),r=Rc(i,h,a,"drawCircularClipPath")),h={id:this.elementId+"SymbolGroup"+l,transform:c,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+l+")"},e.symbolElement=a.createGroup(h),e.symbolElement.appendChild(r),this.chart.enableCanvas){var p=document.getElementById(this.chart.element.id+"_tooltip_svg");p.appendChild(e.symbolElement)}}},t.prototype.getRangeLowPoint=function(e,i){var r=e.x,n=e.y;return i.chart.requireInvertedAxis?(n+=e.height/2,r+=i.yAxis.isAxisInverse?e.width:0):(n+=i.yAxis.isAxisInverse?0:e.height,r+=e.width/2),{x:r,y:n}},t.prototype.calculateDistance=function(e,i){var r=i.x-e.x,n=i.y-e.y;return Math.sqrt(r*r+n*n)},t.prototype.doMarkerAnimation=function(e){if(!(e.type==="Scatter"||e.type==="Bubble"||e.type==="Candle"||e.type==="Hilo"||e.type==="HiloOpenClose"||e.chart.chartAreaType==="PolarRadar"&&e.drawType==="Scatter")){for(var i=e.symbolElement.childNodes,r=e.animation.delay+(e.animation.duration===0&&Yt==="Enable"?1e3:e.animation.duration),n=e.chart.animated?e.chart.duration:200,s=r,a=e.pathElement?e.pathElement.getTotalLength():0,l=[],h=1;e.type==="Line"&&h<e.points.length;h++)if(e.points[h-1].symbolLocations[0]&&e.points[h].symbolLocations[0]){var c=this.calculateDistance(e.points[h-1].symbolLocations[0],e.points[h].symbolLocations[0]);l.push(c)}for(var u=1,d=e.type==="RangeArea"||e.type==="RangeColumn"||e.type==="SplineRangeArea"||e.type==="RangeStepArea"?2:1,h=0;h<e.points.length;h++)if(e.points[h].symbolLocations){if(!e.points[h].symbolLocations.length||!i[u])continue;if(e.type==="Line"&&(h===0&&(s=0),h>0&&(s+=l[h-1]/a*r,n=0)),Lh(i[u],s,n,e,h,e.points[h].symbolLocations[0],!1),d===2){var p=this.getRangeLowPoint(e.points[h].regions[0],e);Lh(i[u+1],s,n,e,h,p,!1)}u+=d}}},t})(F6),z6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),mi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},AO=(function(o){z6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return mi([w(!0)],t.prototype,"visible",void 0),mi([w(null)],t.prototype,"height",void 0),mi([w(null)],t.prototype,"width",void 0),mi([Ce({x:0,y:0},KR)],t.prototype,"location",void 0),mi([w("Auto")],t.prototype,"position",void 0),mi([w("Series")],t.prototype,"mode",void 0),mi([w(8)],t.prototype,"padding",void 0),mi([w(null)],t.prototype,"itemPadding",void 0),mi([w("Center")],t.prototype,"alignment",void 0),mi([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ea)],t.prototype,"textStyle",void 0),mi([w(10)],t.prototype,"shapeHeight",void 0),mi([w(10)],t.prototype,"shapeWidth",void 0),mi([Ce({},qn)],t.prototype,"border",void 0),mi([Ce({left:0,right:0,top:0,bottom:0},vd)],t.prototype,"margin",void 0),mi([Ce({left:0,right:0,top:0,bottom:0},Lq)],t.prototype,"containerPadding",void 0),mi([w(8)],t.prototype,"shapePadding",void 0),mi([w("transparent")],t.prototype,"background",void 0),mi([w(1)],t.prototype,"opacity",void 0),mi([w(!0)],t.prototype,"toggleVisibility",void 0),mi([w(!1)],t.prototype,"enableHighlight",void 0),mi([w(null)],t.prototype,"description",void 0),mi([w(3)],t.prototype,"tabIndex",void 0),mi([w(null)],t.prototype,"title",void 0),mi([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ea)],t.prototype,"titleStyle",void 0),mi([w("Top")],t.prototype,"titlePosition",void 0),mi([w("Normal")],t.prototype,"textWrap",void 0),mi([w("Ellipsis")],t.prototype,"textOverflow",void 0),mi([w(100)],t.prototype,"maximumTitleWidth",void 0),mi([w(null)],t.prototype,"maximumLabelWidth",void 0),mi([w(!0)],t.prototype,"enablePages",void 0),mi([w(!1)],t.prototype,"isInversed",void 0),mi([w(!1)],t.prototype,"reverse",void 0),mi([w("Auto")],t.prototype,"layout",void 0),mi([w(null)],t.prototype,"maximumColumns",void 0),mi([w(!1)],t.prototype,"fixedWidth",void 0),mi([Ce({},Bo)],t.prototype,"accessibility",void 0),t})(Oe),LO=(function(){function o(t){this.maxItemHeight=0,this.rowHeights=[],this.pageHeights=[],this.columnHeights=[],this.pageXCollections=[],this.chartRowCount=1,this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=t,this.legend=t.legendSettings,this.legendID=t.element.id+"_chart_legend",this.isChartControl=t.getModuleName()==="chart"||t.getModuleName()==="chart3d",this.isAccChartControl=t.getModuleName()==="accumulationchart"||t.getModuleName()==="circularchart3d",this.isBulletChartControl=t.getModuleName()==="bulletChart",this.isStockChartControl=t.getModuleName()==="stockChart",this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return o.prototype.calculateLegendBounds=function(t,e,i,r,n){var s=this.legend,a=this.isBulletChartControl||(this.chart.getModuleName()==="accumulationchart"||this.chart.getModuleName()==="chart")&&(this.legend.layout!=="Auto"||this.legend.maximumColumns>0)?"40%":"20%";this.getPosition(s.position,e),this.legendBounds=new Le(t.x,t.y,0,0),this.isVertical=this.position==="Left"||this.position==="Right",this.itemPadding=this.legend.itemPadding?this.legend.itemPadding:this.isVertical?8:20,this.isVertical?(this.legendBounds.height=zi(s.height,e.height-(t.y-this.chart.margin.top))||t.height,this.legendBounds.width=zi(s.width||a,e.width)):(this.legendBounds.width=zi(s.width,e.width)||t.width,this.legendBounds.height=zi(s.height||a,e.height)),this.chart.getModuleName()==="chart3d"?this.library.get3DLegendBounds(e,this.legendBounds,s):this.library.getLegendBounds(e,this.legendBounds,s),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,s.alignment,this.legendBounds,t,e,i,r,n)},o.prototype.getPosition=function(t,e){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position=t!=="Auto"?t:"Bottom":(t==="Auto"&&((i||r).visibleSeries&&(i||r).visibleSeries[0].type==="Funnel"||(i||r).visibleSeries[0].type==="Pyramid")&&(t="Top"),this.position=t!=="Auto"?t:e.width>e.height?"Right":"Bottom")},o.prototype.setBounds=function(t,e,i,r){var n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),t=Math.min(t,r.width),e=Math.min(e,r.height),i.mode==="Gradient"?(r.width=i.width?r.width:this.isVertical?t:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:e):(r.width=i.width?r.width:t,r.height=i.height?r.height:e),this.isBulletChartControl||this.isTop&&i.titleStyle.textOverflow!=="None"&&(this.calculateLegendTitle(i,r),r.height+=i.titleStyle.textOverflow==="Wrap"&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},o.prototype.getLocation=function(t,e,i,r,n,s,a,l){var h=this.legend.border.width,c=this.isBulletChartControl,u=this.bulletChart,d=u.labelPosition==="Inside",p=u.tickPosition==="Inside",f=u.orientation==="Vertical",v=c&&u.categoryField!==""?s.width+this.chart.border.width+h*3:0,m=this.chart.margin.bottom,y=i.height+h+this.legend.margin.top+this.legend.margin.bottom,b=i.width+h+this.legend.margin.left+this.legend.margin.right;if(t==="Bottom")i.x=this.alignLegend(i.x,n.width,i.width,e),i.y=a&&(i.height===a.height||this.chart.series[0].type!=="Pie")?a.y:r.y+(r.height-y)+h+this.legend.margin.top,i.y+=c&&!u.opposedPosition&&!d&&!p&&!f?u.majorTickLines.height+m+this.legend.border.width+h*2:f&&u.categoryField!==""?s.height+h*2:0,(!l||i.height!==a.height)&&zo(r,new Po(0,0,0,y));else if(t==="Top"){var S=void 0;this.isChartControl&&(S=Xe("100",this.chart.verticalAxes[0].labelStyle,this.chart.themeStyle.legendLabelFont)),i.x=this.alignLegend(i.x,n.width,i.width,e),i.y=a&&(i.height===a.height||this.chart.series[0].type!=="Pie")?a.y:r.y+h+this.legend.margin.top,i.y-=c&&u.opposedPosition&&!d&&!p&&!f?u.majorTickLines.height+this.chart.margin.top:0,y-=c?-h*2:this.isChartControl?-h*2-S.height/2:0,(!l||i.height!==a.height)&&zo(r,new Po(0,0,y,0))}else t==="Right"?(i.x=a&&(i.width===a.width||this.chart.series[0].type!=="Pie")?a.x:r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+m),i.height,e),b+=c&&u.opposedPosition&&!d&&!p&&f?this.chart.margin.left+this.chart.margin.right+u.majorTickLines.height:0,(!l||i.width!==a.width)&&zo(r,new Po(0,b,0,0))):t==="Left"?(i.x=a&&(i.width===a.width||this.chart.series[0].type!=="Pie")?a.x:i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+m),i.height,e),b+=c&&!u.opposedPosition&&!d&&!p&&f?i.x-this.chart.margin.left+h+u.majorTickLines.height:u.orientation!=="Vertical"&&u.categoryField!==""?v:0,(!l||i.width!==a.width)&&zo(r,new Po(b,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,zo(r,new Po(0,0,0,0)))},o.prototype.alignLegend=function(t,e,i,r){switch(r){case"Far":t=e-i-t;break;case"Center":t=(e-i)/2;break}return t},o.prototype.renderLegend=function(t,e,i,r,n){var s=0,a=0,l=new Le(0,0,0,0),h=new Le(0,0,0,0),c,u;n&&(c=fe(this.legendID+"_element").getAttribute("x"),u=fe(this.legendID+"_element").getAttribute("y"));var d=this.findFirstLegendPosition(this.legendCollections),p=e.padding;this.itemPadding=this.isBulletChartControl?e.padding:this.itemPadding;var f=e.enablePages,v=e.titlePosition,m=this.isPaging&&!e.enablePages&&this.isVertical&&(t.getModuleName()!=="accumulationchart"&&t.getModuleName()!=="chart"||this.legend.layout==="Auto")?this.pageButtonSize:0,y=t.renderer.createGroup({id:this.legendID+"_g"}),b=this.createLegendElements(t,i,y,e,this.legendID,r);this.legendRegions=[],this.chartRowCount=1;var S=0;if(s=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,this.isChartControl||this.isAccChartControl&&(!this.isVertical||e.layout&&e.layout!=="Auto")){for(var C=1,x=this.rowHeights[0]+(this.isVertical||this.rowHeights.length>1&&this.legend.itemPadding&&this.chart.getModuleName()==="chart"?this.itemPadding:p),I=1;I<this.rowHeights.length;I++)x+this.rowHeights[I]+((this.isVertical||this.rowHeights.length>1&&this.chart.getModuleName()==="chart")&&this.legend.itemPadding?this.itemPadding:p)>this.legendBounds.height-this.pageButtonSize-this.maxItemHeight/2-this.legend.containerPadding.top-this.legend.containerPadding.bottom&&(this.pageHeights[C-1]=x+s,C++,x=0),x+=this.rowHeights[I]+(this.isVertical||this.rowHeights.length>1&&this.legend.itemPadding&&this.chart.getModuleName()==="chart"?this.itemPadding:p);this.pageHeights[C-1]=x+s,this.totalPages=C}for(var I=0;I<this.legendCollections.length;I++)if(this.legendCollections[I].text!==""){S=Math.max(this.legendCollections[I].textSize.height,S);break}else continue;if(!this.isChartControl&&!this.isAccChartControl&&(this.maxItemHeight=Math.max(S,e.shapeHeight)),!f&&this.isPaging&&!this.isVertical?(a=this.isTitle&&v==="Left"?this.legendTitleSize.width:0,a+=this.pageButtonSize+2*this.fivePixel):this.isTitle&&!this.isVertical&&(a=v===(this.isRtlEnable?"Right":"Left")?this.fivePixel+this.legendTitleSize.width:0),t.legendSettings.mode==="Gradient"&&this.legendCollections.length>1)this.getLinearLegend(i,t,e,b),this.totalPages=1;else if(d!==this.legendCollections.length){var D=void 0,M=0,E=this.legendCollections[d],A=this.isBulletChartControl?p:a+p+e.shapeWidth/2+e.containerPadding.left,L=this.isBulletChartControl&&!this.isRtlEnable?i.x+a+p+e.shapeWidth/2:this.isRtlEnable?i.x+(this.chart.getModuleName()==="accumulationchart"&&this.isVertical&&e.layout==="Auto"&&!(e.maximumColumns>0)?this.maxWidth:i.width)-A:i.x+A,N=new at(L,this.isBulletChartControl?i.y+s+m+p+this.maxItemHeight/2:i.y+s+m+p+this.maxItemHeight/2+e.containerPadding.top),R=t.isRtlEnabled||t.enableRtl?"end":"start",P=new bn("",N.x,N.y,R),k=e.shapePadding+this.itemPadding+e.shapeWidth;this.totalPages=this.totalPages=this.isAccChartControl||this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[d].location=N;var B=void 0;if(!e.enablePages&&this.isPaging){var F=N.x-this.fivePixel,O=N.y-this.fivePixel,z=this.isTitle&&!this.isVertical&&v==="Left"?this.legendTitleSize.width+this.fivePixel:0,Y=this.isVertical?this.pageButtonSize+Math.abs(O-i.y):0,K=this.isTitle&&!this.isVertical&&v==="Right"?this.legendTitleSize.width+this.fivePixel:0;K+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,l=new Le(F,O,i.width-K-z,i.height-Y),h=l}else h=i;for(var U=void 0,I=0;I<this.legendCollections.length;I++)U=this.legendCollections[I],B=this.isReverse?this.legendCollections.length-1-M:M,this.chart.getModuleName()==="accumulationchart"&&this.chart.accumulationLegendModule.legendRenderArgFill.indexOf(I)===-1&&(U.fill=(this.chart||this.chart||this.chart||this.chart).visibleSeries[0].points[U.pointIndex].color),this.chart.getModuleName()==="stockChart"&&(U.type=this.chart.visibleSeries[M].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+U.text:"Click to show or hide the "+U.text+" series",U.render&&U.text&&U.text!==""&&(D=t.renderer.createGroup({id:this.legendID+this.generateId(U,"_g_",B)}),D&&(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="accumulationchart")?(D.setAttribute("tabindex",I===0&&e.accessibility.focusable?String(e.accessibility.tabIndex):""),D.style.outline="none",D.setAttribute("aria-label",e.accessibility.accessibilityDescription?e.accessibility.accessibilityDescription:U.text+" series is "+(U.visible?"showing, press enter to hide the ":"hidden, press enter to show the ")+U.text+" series"),D.setAttribute("role",e.accessibility.accessibilityRole?e.accessibility.accessibilityRole:"button"),D.setAttribute("aria-pressed",U.visible?"true":"false")):D&&(D.setAttribute("tabindex",I===0?"0":""),D.style.outline="none",D.setAttribute("aria-label",e.description||U.text+" series is "+(U.visible?"showing, press enter to hide the ":"hidden, press enter to show the ")+U.text+" series"),D.setAttribute("role","button"),D.setAttribute("aria-pressed",U.visible?"true":"false")),this.library.getRenderPoint(U,N,k,E,h,M,d),this.renderSymbol(U,D,B),this.renderText(t,U,D,P,M,B),D&&(D.style.cssText="pointer-events: bounding-box; cursor: "+(!e.toggleVisibility&&(t.selectionMode==="None"||t.highlightMode==="None"||t.selectionMode==="None")||this.isBulletChartControl?"auto":"pointer")),b&&b.appendChild(D),E=U),M++;this.totalPages=this.isPaging&&!this.isBulletChartControl&&!this.legend.enablePages&&!this.isVertical&&this.totalPages>this.chartRowCount?this.chartRowCount:this.totalPages,this.currentPage=this.currentPage>1&&this.currentPage>this.totalPages?this.totalPages:this.currentPage,this.isPaging&&this.totalPages>1?this.renderPagingElements(t,i,P,y):this.totalPages=1}if(n){var q="translate("+(this.rowCount>1?0:Math.round(Number(c))-Math.round(this.legendBounds.x))+` 
              + ',' + `+(Math.round(Number(u))-Math.round(this.legendBounds.y))+")",ae="translate("+(Math.round(Number(c))-Math.round(this.legendBounds.x))+", "+(Math.round(Number(u))-Math.round(this.legendBounds.y))+")";gt(t.enableCanvas,t.svgObject,y,r,!0,"x","y",void 0,void 0,void 0,void 0,void 0,t.duration,void 0,void 0,new at(0,0),this.position==="Top"||this.position==="Bottom"?q:ae)}else gt(t.enableCanvas,t.svgObject,y,r)},o.prototype.getLinearLegend=function(t,e,i,r){var n="http://www.w3.org/2000/svg",s=this.legendCollections[0],a=this.legendCollections[1],l=this.chart.renderer.createDefs(),h=0,c=document.createElementNS(n,"linearGradient"),u=1,d=[],p=[];i.title&&(this.isVertical?(t.y+=this.legendTitleSize.height,t.height-=this.legendTitleSize.height):i.titlePosition==="Left"?(t.x+=this.legendTitleSize.width,t.width-=this.legendTitleSize.width):i.titlePosition==="Right"?t.width-=this.legendTitleSize.width:i.titlePosition==="Top"&&(t.y+=this.legendTitleSize.height,t.height-=this.legendTitleSize.height));for(var f=0,v=this.chart.rangeColorSettings;f<v.length;f++){var m=v[f];if(p.indexOf(m.start)<0&&p.push(m.start),m.colors.length>2){var y=m.end-m.start,b=m.colors.length-1;if(y>0){y=y/b;for(var S=1;S<b;S++){var C=m.start+y*S;p.push(C)}}else for(var S=1;S<b;S++)p.push(m.start)}p.indexOf(m.end)<0&&p.push(m.end);for(var x=0,I=m.colors;x<I.length;x++){var D=I[x];d.indexOf(D)<0&&d.push(D)}m.colors.length>0&&m.colors.length<2&&d.push(m.colors[0])}var M=this.isRtlEnable&&!this.isVertical?"100%":"0%",E=this.isVertical||this.isRtlEnable?"0%":"100%",A=this.isVertical?"100%":"0%";c.setAttribute("id",this.generateId(s,"linearGradient",h)),c.setAttribute("x1",M),c.setAttribute("y1","0%"),c.setAttribute("x2",E),c.setAttribute("y2",A);for(var L=p[p.length-1]-p[0],N=0;N<d.length;N++){var R=p[N]-p[0];R=R/L;var P=document.createElementNS(n,"stop");P.setAttribute("offset",R.toString()),P.setAttribute("stop-color",d[N]),P.setAttribute("stop-opacity",u.toString()),c.appendChild(P)}var k=s.text.toString(),B=a.text.toString(),F=Xe(k,i.textStyle,this.chart.themeStyle.legendLabelFont),O=Xe(B,i.textStyle,this.chart.themeStyle.legendLabelFont),z=F.width>O.width?F.width:O.width,Y=F.height>O.height?F.height:O.height,K=2*z+4*i.padding,U=t.width,q=t.height,ae=t.x+z+2*i.padding,te=t.y+i.padding,he,ue,ne,le;if(this.isVertical){if(K=2*Y+4*i.padding,U=t.width-2*i.padding,q=t.height-K,ae=t.x+i.padding,te=t.y+Y+2*i.padding,he=t.y+i.padding+Y,ue=te+q+Y,ne=t.x+t.width*.5-z*.5,le=ne,U>30){var $=U-30;U=30,ae=ae+$/2}}else if(U=t.width-K,q=t.height-2*i.padding,ne=t.x+(this.isRtlEnable?U+3*i.padding+z:i.padding+(z-F.width)),le=t.x+(this.isRtlEnable?i.padding+(z-O.width):U+3*i.padding+z),he=t.y+t.height*.5+Y*.25,ue=he,q>30){var ee=q-30;q=30,te=te+ee/2}var He=e.enableRtl?"end":"",qe=new bn("",ne,he,He,k),we="#D3D3D3";qe.id=this.legendID+this.generateId(s,"_text_",1);var je=s.visible?i.textStyle.color||e.themeStyle.legendLabelFont.color:we,Ne=this.isStockChartControl?!1:this.chart.enableCanvas;vn(e.renderer,qe,i.textStyle,je,r,!1,!1,!1,!1,null,this.currentPageNumber&&Ne?new Le(0,-this.translatePage(Ne,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),qe=new bn("",le,ue,He,B),qe.id=this.legendID+this.generateId(s,"_text_",2),vn(e.renderer,qe,i.textStyle,je,r,!1,!1,!1,!1,null,this.currentPageNumber&&Ne?new Le(0,-this.translatePage(Ne,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont);var Ye=e.renderer.drawRectangle({width:U,height:q,x:ae,y:te,fill:"url(#"+this.generateId(s,"linearGradient",h)+")"});l.appendChild(c),r.appendChild(l),r.appendChild(Ye)},o.prototype.findFirstLegendPosition=function(t){for(var e=0,i=0,r=t;i<r.length;i++){var n=r[i];if(n.render&&n.text&&n.text!=="")break;e++}return e},o.prototype.calculateLegendTitle=function(t,e){if(t.title){this.isTop=t.titlePosition==="Top";var i=t.titleStyle.textOverflow==="Trim"?2*t.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=gd(t.title,t.titleStyle,e.width-i,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont):this.legendTitleCollections[0]=Js(t.maximumTitleWidth,t.title,t.titleStyle,this.chart.enableRtl,this.chart.themeStyle.legendTitleFont);var r=this.isTop?t.title:this.legendTitleCollections[0];this.legendTitleSize=Xe(r,t.titleStyle,this.chart.themeStyle.legendTitleFont),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new Wt(0,0)},o.prototype.renderLegendTitle=function(t,e,i,r){var n=e.padding,s=e.titleStyle.textAlignment;this.isTop=e.titlePosition==="Top";var a=kc(e.titleStyle.textAlignment,t.enableRtl),l=Nc(i,e.titleStyle);a=this.isTop||this.isVertical?a:t.enableRtl?"end":"",l=s==="Near"?l+n:s==="Far"?l-n:l,l=this.isTop||this.isVertical?l:i.x+(e.titlePosition==="Left"?5:i.width-this.legendTitleSize.width-5);var h=i.height/2+this.legendTitleSize.height/4,c=i.y+(!this.isTop&&!this.isVertical?h:this.legendTitleSize.height/this.legendTitleCollections.length),u=new bn(this.legendID+"_title",l,c,a,this.legendTitleCollections);vn(t.renderer,u,e.titleStyle,e.titleStyle.color||this.chart.themeStyle.legendTitleFont.color,r,null,null,null,null,null,null,null,null,null,null,this.chart.themeStyle.legendTitleFont)},o.prototype.createLegendElements=function(t,e,i,r,n,s){var a=r.padding,l=new ys(n+"_element",r.background,r.border,r.opacity,e,0,0,"",this.legend.border.dashArray),h=t.renderer.createGroup({id:n+"_collections"}),c=this.isStockChartControl?!1:t.enableCanvas,u=t.renderer.createClipPath({id:n+"_clipPath"});return l.width=this.isRtlEnable&&this.chart.getModuleName()==="accumulationchart"&&this.isVertical&&r.layout==="Auto"&&!(r.maximumColumns>0)?this.maxWidth:e.width,i?i.appendChild(t.renderer.drawRectangle(l)):t.renderer.drawRectangle(l),r.title&&this.renderLegendTitle(t,r,e,i),c||i.appendChild(h),this.legendTranslateGroup=t.renderer.createGroup({id:n+"_translate_g"}),c||h.appendChild(this.legendTranslateGroup),l.y+=(this.isTop?this.legendTitleSize.height:0)+(this.isBulletChartControl?0:r.containerPadding.top),l.height-=(this.isTop&&(this.isChartControl||!this.isVertical||r.layout!=="Auto")?this.legendTitleSize.height:0)+(this.isBulletChartControl?0:r.containerPadding.top),l.id+="_clipPath_rect",l.width=!this.isChartControl&&t.getModuleName()!=="bulletChart"&&!this.isStockChartControl&&!(t.getModuleName()==="accumulationchart"&&(r.layout!=="Auto"||r.maximumColumns>0))&&this.isVertical?this.maxWidth-a+r.containerPadding.left+r.containerPadding.right:e.width,l.width=t.legendSettings.titlePosition==="Right"?l.width-this.legendTitleSize.width-a:l.width,c?this.pagingClipRect=l:(this.clipRect=t.renderer.drawRectangle(l),u.appendChild(this.clipRect)),gt(c,t.svgObject,u,s),c||(h.style.cssText="clip-path:url(#"+u.id+")"),this.legendTranslateGroup},o.prototype.renderSymbol=function(t,e,i){var r=this.isBulletChartControl?this.chart:null,n=t.visible?t.fill:"#D3D3D3",s=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(t.shape==="SeriesType"&&t.type.toLowerCase().indexOf("line")>-1&&t.type.toLowerCase().indexOf("area")===-1||t.shape==="HorizontalLine"||t.shape==="VerticalLine"||t.shape==="Cross"),a=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(t.type==="Scatter"||t.type==="Bubble"),l=this.isStockChartControl?!1:this.chart.enableCanvas,h,c=t.shape==="SeriesType"?t.type:t.shape,u=s?this.legend.mode==="Series"?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&t.shape==="Multiply"?4:1,d;if(c=c==="Scatter"?t.markerShape:c,a&&i<this.chart.visibleSeries.length){var p=this.chart.visibleSeries[i],f=p.border,v=c==="HorizontalLine"||c==="VerticalLine";h=v?n:f.color?f.color:n,u=v?p.width:f.width?f.width:1}for(var m=new Rr(this.legendID+this.generateId(t,"_shape_",i),n,u,a?h:n,this.legend.opacity,t.dashArray,""),y=Xe(t.text,this.legend.textStyle,this.chart.themeStyle.legendLabelFont),b=0,S=0,C=t.textCollection;S<C.length;S++){var x=C[S],I=Xe(x,this.legend.textStyle,this.chart.themeStyle.legendLabelFont);I.width>b&&(b=I.width)}var D=this.legend.isInversed&&!this.isRtlEnable?t.location.x+(this.legend.textWrap==="Wrap"&&t.textCollection.length>1?b:y.width)+this.legend.shapePadding:t.location.x,M=t.location.y;l?(d=-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),Zs({x:D,y:M},c,new Wt(this.legend.shapeWidth,this.legend.shapeHeight),"",m,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Le(0,d,0,0):null,this.isBulletChartControl,r),this.legendRegions.push({rect:new Le(t.location.x-this.legend.shapeWidth,t.location.y,this.legend.shapeWidth+this.legend.shapePadding,this.legend.shapeHeight+d),index:i})):e.appendChild(Zs({x:D,y:M},c,new Wt(this.legend.shapeWidth,this.legend.shapeHeight),t.url,m,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,r)),(c==="Line"&&t.markerVisibility&&t.markerShape!=="Image"||t.type==="Doughnut"&&c==="Doughnut")&&(m.id=this.legendID+this.generateId(t,"_shape_marker_",i),c=t.type==="Doughnut"?"Circle":t.markerShape,m.fill=t.type==="Doughnut"?"#FFFFFF":m.fill,l?Zs({x:D,y:M},c,new Wt(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",m,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new Le(0,-this.translatePage(l,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,r):e.appendChild(Zs({x:D,y:M},c,new Wt(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",m,this.accessbilityText,null,null,this.isBulletChartControl,r)))},o.prototype.renderText=function(t,e,i,r,n,s){var a=this,l=t.legendSettings,h="#D3D3D3",c=e.visible?l.textStyle.color||t.themeStyle.legendLabelFont.color:h,u=this.isStockChartControl?!1:this.chart.enableCanvas;if(r.id=this.legendID+this.generateId(e,"_text_",s),r.text=e.textCollection.length>0?e.textCollection:e.text,l.isInversed&&!this.isRtlEnable)r.x=e.location.x-l.shapeWidth/2;else if(this.isRtlEnable){var d=e.textCollection.length>1,p=d?Math.max.apply(Math,e.textCollection.map(function(y){return Xe(y,l.textStyle,a.chart.themeStyle.legendLabelFont).width})):Xe(e.text,l.textStyle,this.chart.themeStyle.legendLabelFont).width;r.x=this.chart.getModuleName()==="bulletChart"?e.location.x-l.shapeWidth:e.location.x-(p+l.shapeWidth/2+l.shapePadding)}else r.x=e.location.x+l.shapeWidth/2+l.shapePadding;if(r.y=e.location.y+this.maxItemHeight/4,vn(t.renderer,r,l.textStyle,c,i,!1,!1,!1,!1,null,this.currentPageNumber&&u?new Le(0,-this.translatePage(u,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,null,null,null,null,this.chart.themeStyle.legendLabelFont),u){for(var f=Xe(e.text,l.textStyle,this.chart.themeStyle.legendLabelFont),v=void 0,m=0;m<this.legendRegions.length;m++)if(this.legendRegions[m].index===n){v=this.legendRegions[m];break}v.rect.y=r.y<v.rect.y?r.y:v.rect.y,v.rect.width+=f.width,v.rect.height=f.height,v.rect.y-=f.height*.5,v.rect.x-=this.isRtlEnable?v.rect.width:0}},o.prototype.renderPagingElements=function(t,e,i,r){var n=t.renderer.createGroup({id:this.legendID+"_navigation"}),s=this.isStockChartControl?!1:t.enableCanvas,a=this.isBulletChartControl?0:this.legendTitleSize.height,l=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":"#545454",h=t.legendSettings,c=8,u=this.legendID+(this.isRtlEnable?"_pagedown":"_pageup"),d=this.legendID+(this.isRtlEnable?"_pageup":"_pagedown"),p=new Rr(u,"transparent",5,l,1,"",""),f=t.availableSize.width<110||t.availableSize.height<190?4:this.pageButtonSize,v=pe({},V("properties",h.textStyle),null,!0);v.size=t.availableSize.width<110||t.availableSize.height<190&&!this.isBulletChartControl&&this.chart.getModuleName()==="accumulationchart"?"8px":h.textStyle.size;var m=!h.enablePages&&this.isPaging&&!this.isVertical&&!this.isBulletChartControl?1:this.rowCount-1,y=this.isTitle&&h.titlePosition==="Left"?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=this.currentPage!==1?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,s||r.appendChild(n),!this.isChartControl&&!this.isAccChartControl&&(this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns)),n&&(n.style.cursor="pointer"),(this.isChartControl||this.isAccChartControl)&&!(!h.enablePages&&this.isPaging)?this.clipPathHeight=this.pageHeights[0]-(this.isTitle&&this.isTop&&(this.isChartControl||!this.isVertical||h.layout!=="Auto")?this.legendTitleSize.height:0)-h.containerPadding.top-h.containerPadding.bottom:this.clipPathHeight=m*(this.maxItemHeight+h.padding),s?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-h.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=h.border.width,this.pagingClipRect.width-=h.border.width+h.border.width/2,this.chart.renderer.clearRect(new Le(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var b,S=e.x+f/2,C=e.y+this.clipPathHeight+(a+e.height-this.clipPathHeight)/2;this.isPaging&&!h.enablePages&&!this.isVertical&&!this.isBulletChartControl&&(S=e.x+this.pageButtonSize+y,C=h.title&&this.isTop?e.y+c+a+f/1+.5:e.y+c+f+.5);var x=Xe(this.totalPages+"/"+this.totalPages,v,this.chart.themeStyle.legendLabelFont),I=this.isRtlEnable?h.border.width+f/2:e.width-(2*(f+c)+c+x.width);s?Zs({x:S,y:C},"LeftArrow",new Wt(f,f),"",p,"LeftArrow",this.chart.renderer,new Le(I,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(S=e.x+e.width/2,C=e.y+f/2+c/2+a,p.opacity=this.backwardArrowOpacity,n.appendChild(Zs({x:S,y:C},"UpArrow",new Wt(f,f),"",p))):(p.opacity=this.isBulletChartControl?p.opacity:h.enablePages?1:this.isRtlEnable?this.forwardArrowOpacity:this.backwardArrowOpacity,n.appendChild(Zs({x:S,y:C},"LeftArrow",new Wt(f,f),"",p))),this.pagingRegions.push(new Le(this.isRtlEnable?S:S+e.width-(2*(f+c)+c+x.width)-f*.5,C-f*.5,f,f)),i.x=S+f/2+c,i.y=C+x.height/4,i.id=this.legendID+"_pagenumber",i.text=this.isRtlEnable?this.totalPages+"/1":"1/"+this.totalPages;var D=this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("Contrast")>-1?"#FFFFFF":h.textStyle.color||this.chart.theme==="Tailwind3"?"#111827":this.chart.theme==="Tailwind3Dark"?"#FFFFFF":this.chart.themeStyle.legendLabelFont.color;s&&this.totalNoOfPages&&(i.text=this.isRtlEnable?this.totalNoOfPages+"/"+this.currentPageNumber:this.currentPageNumber+"/"+this.totalNoOfPages),(h.enablePages||this.isBulletChartControl)&&(b=vn(t.renderer,i,v,D,n,!1,!1,!1,!1,null,new Le(I,0,0,0),null,null,null,null,this.chart.themeStyle.legendLabelFont)),S=i.x+c+f/2+x.width,this.isPaging&&!h.enablePages&&!this.isBulletChartControl&&!this.isVertical&&(S=e.x+e.width-(this.isBulletChartControl?this.fivePixel:0)-this.pageButtonSize-(h.title&&h.titlePosition==="Right"?this.legendTitleSize.width+this.fivePixel:0)),p.id=d,p.opacity=h.enablePages?1:this.isRtlEnable?this.backwardArrowOpacity:this.forwardArrowOpacity,s?Zs({x:S,y:C},"RightArrow",new Wt(f,f),"",p,"RightArrow",this.chart.renderer,new Le(I,0,0,0)):this.isVertical&&!h.enablePages&&!this.isBulletChartControl?(S=e.x+e.width/2,C=e.y+e.height-f/2,n.appendChild(Zs({x:S,y:C},"DownArrow",new Wt(f,f),"",p))):n.appendChild(Zs({x:S,y:C},"RightArrow",new Wt(f,f),"",p)),this.pagingRegions.push(new Le(this.isRtlEnable?S:S+(e.width-(2*(f+c)+c+x.width)-f*.5),C-f*.5,f,f)),!s&&(h.enablePages||this.isBulletChartControl)?n.setAttribute("transform","translate("+I+", 0)"):(this.currentPageNumber===1&&this.calTotalPage&&(h.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),!h.enablePages&&!this.isBulletChartControl&&this.translatePage(s,null,this.currentPage-1,this.currentPage,h)),(h.enablePages||this.isBulletChartControl)&&this.translatePage(s,b,this.currentPage-1,this.currentPage,h)},o.prototype.getPageHeight=function(t,e){for(var i=0,r=0;r<e;r++)i+=t[r]-(this.isTitle&&this.isTop?this.legendTitleSize.height:0);return i},o.prototype.translatePage=function(t,e,i,r,n){var s=this.isChartControl||this.isAccChartControl?i?this.getPageHeight(this.pageHeights,i):0:this.clipPathHeight*i;!t&&(this.isChartControl||this.isAccChartControl)&&(this.clipRect.setAttribute("height",(this.pageHeights[i]-(this.isTitle&&this.isTop&&(this.isChartControl||!this.isVertical||n.layout!=="Auto")?this.legendTitleSize.height:0)-n.containerPadding.top-n.containerPadding.bottom).toString()),this.isAccChartControl&&this.isPaging&&!n.enablePages&&this.isVertical&&(this.chart.getModuleName()!=="accumulationchart"||n.layout==="Auto")&&this.clipRect.setAttribute("height",this.legendBounds.height.toString()));var a="translate(0,-"+s+")";if(!this.isChartControl&&!this.isBulletChartControl&&!this.isStockChartControl&&!(this.chart.getModuleName()==="accumulationchart"&&n.layout!=="Auto")&&this.isVertical){var l=this.pageXCollections[i*this.maxColumns];s=this.isRtlEnable?this.legendBounds.x+this.maxWidth-l:l-this.legendBounds.x,s=s<0?0:s,a=(this.isRtlEnable?"translate(":"translate(-")+s+",0)"}return this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",a),!this.chart.enableCanvas&&(n.enablePages||this.isBulletChartControl)&&(e.textContent=r+"/"+this.totalPages),this.currentPage=r,s},o.prototype.changePage=function(t,e){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),s=this.isStockChartControl?!1:this.chart.enableCanvas,a=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,l=i.enablePages||this.isBulletChartControl?parseInt(a.textContent.split("/")[0],10):this.currentPage;e&&l>1?this.translatePage(s,a,l-2,l-1,i):!e&&l<this.totalPages&&this.translatePage(s,a,l,l+1,i),this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),this.currentPage===1?this.hideArrow(r):this.showArrow(r))},o.prototype.hideArrow=function(t){t.setAttribute("opacity","0")},o.prototype.showArrow=function(t){t.setAttribute("opacity","1")},o.prototype.generateId=function(t,e,i){return this.isChartControl||this.isStockChartControl?e+i:e+t.pointIndex},o.prototype.move=function(t){var e=this,i=this.chart.mouseX,r=this.chart.mouseY;if(t.target.textContent.indexOf("...")>-1){var n=t.target.id.split(this.legendID+"_text_");if(n.length===2){var s=parseInt(n[1],10),a=this.chart.element;if(!isNaN(s))if(this.chart.isTouch&&zt(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl)pd(this.chart.visibleSeries[s].name,i,r,a.offsetWidth,a.id+"_EJ2_Legend_Tooltip",fe(this.chart.element.id+"_Secondary_Element"),null,null,this.legendBounds);else{var l=this.isReverse?this.legendCollections.length-1-s:s,h=this.chart.getModuleName()==="accumulationchart"?this.legendCollections[l].originalText:this.chart.visibleSeries[0].points[s].x.toString();pd(h,i+10,r+10,a.offsetWidth,a.id+"_EJ2_Legend_Tooltip",fe(this.chart.element.id+"_Secondary_Element"))}}}else zt(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){zt(e.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},o})(),Ac=(function(){function o(t,e,i,r,n,s,a,l,h,c,u,d){this.location={x:0,y:0},this.textCollection=[],this.text=t,this.fill=e,this.shape=i,this.url=s,this.visible=r,this.type=n,this.markerVisibility=l,this.markerShape=a,this.pointIndex=h,this.seriesIndex=c,this.dashArray=u,this.originalText=d}return o})(),P6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),sn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},YR=(function(o){P6(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.clipRect=new Le(0,0,0,0),e}return t.prototype.setDataSource=function(e,i){e&&(this.xData=e.xData,this.yData=e.yData,this.points=e.points);var r=_r(this.type);this.visible&&i[r+"IndicatorModule"].initDataSource(this,i),i.visibleSeriesCount+=this.targetSeries.length},sn([w("Sma")],t.prototype,"type",void 0),sn([w(14)],t.prototype,"period",void 0),sn([w(14)],t.prototype,"kPeriod",void 0),sn([w(3)],t.prototype,"dPeriod",void 0),sn([w(80)],t.prototype,"overBought",void 0),sn([w(20)],t.prototype,"overSold",void 0),sn([w(2)],t.prototype,"standardDeviation",void 0),sn([w("Close")],t.prototype,"field",void 0),sn([w(12)],t.prototype,"slowPeriod",void 0),sn([w(26)],t.prototype,"fastPeriod",void 0),sn([w(!0)],t.prototype,"showZones",void 0),sn([Ce({color:"#ff9933",width:2},ld)],t.prototype,"macdLine",void 0),sn([w("Both")],t.prototype,"macdType",void 0),sn([w("#2ecd71")],t.prototype,"macdPositiveColor",void 0),sn([w("#e74c3d")],t.prototype,"macdNegativeColor",void 0),sn([w("rgba(211,211,211,0.25)")],t.prototype,"bandColor",void 0),sn([Ce({color:"#ffb735",width:1},ld)],t.prototype,"upperLine",void 0),sn([Ce({color:"#f2ec2f",width:1},ld)],t.prototype,"lowerLine",void 0),sn([Ce({color:"#f2ec2f",width:1},ld)],t.prototype,"periodLine",void 0),sn([Ce({},Bo)],t.prototype,"accessibility",void 0),sn([w("")],t.prototype,"seriesName",void 0),t})(DO),NO=(function(){function o(t){this.control=t}return o.prototype.print=function(t){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var e={cancel:!1,htmlContent:this.getHTMLContent(t),name:BR};this.control.trigger(BR,e),e.cancel||Aw(e.htmlContent,this.printWindow)},o.prototype.getHTMLContent=function(t){var e=et("div");if(t)if(t instanceof Array)for(var i=0;i<t.length;i++){var r=t[i];e.appendChild(fe(r).cloneNode(!0))}else t instanceof Element?e.appendChild(t.cloneNode(!0)):e.appendChild(fe(t).cloneNode(!0));else e.appendChild(this.control.element.cloneNode(!0));for(var n=0;n<e.children.length;n++){for(var s=this.control.theme.indexOf("Dark")>-1||this.control.theme.indexOf("HighContrast")>-1?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)",a=e.children[n],l=0;l<a.children.length;l++){var h=void 0,c=!1;a.id.indexOf("_stockChart_svg")>-1?(h=a.children[0].getAttribute("fill"),c=!0):a.children[l].id.indexOf("_svg")>-1&&(h=a.children[l].children[0].getAttribute("fill"),c=!0),c&&(h=h==="transparent"?s:h,a.children[l].children[0].setAttribute("fill",h))}e[n]=a}return e},o})(),mb=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Fe=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},B6=(function(o){mb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Fe([w()],t.prototype,"start",void 0),Fe([w()],t.prototype,"end",void 0),Fe([w([])],t.prototype,"colors",void 0),Fe([w("")],t.prototype,"label",void 0),t})(Oe),j6=(function(o){mb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Fe([w(!1)],t.prototype,"enable",void 0),Fe([w("")],t.prototype,"dashArray",void 0),Fe([Ce({color:null,width:1},qn)],t.prototype,"line",void 0),Fe([w("Both")],t.prototype,"lineType",void 0),Fe([w("")],t.prototype,"verticalLineColor",void 0),Fe([w("")],t.prototype,"horizontalLineColor",void 0),Fe([w(1)],t.prototype,"opacity",void 0),Fe([w(!1)],t.prototype,"snapToData",void 0),Fe([w(!1)],t.prototype,"highlightCategory",void 0),t})(Oe),H6=(function(o){mb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Fe([w(!1)],t.prototype,"enableSelectionZooming",void 0),Fe([w(!1)],t.prototype,"enablePinchZooming",void 0),Fe([w(!1)],t.prototype,"showToolbar",void 0),Fe([w(!1)],t.prototype,"enableMouseWheelZooming",void 0),Fe([w(!0)],t.prototype,"enableDeferredZooming",void 0),Fe([w("XY")],t.prototype,"mode",void 0),Fe([w(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),Fe([w(!1)],t.prototype,"enablePan",void 0),Fe([w(!1)],t.prototype,"enableScrollbar",void 0),Fe([w(!1)],t.prototype,"enableAnimation",void 0),Fe([Ce({},Uq)],t.prototype,"toolbarPosition",void 0),Fe([Ce({},Bo)],t.prototype,"accessibility",void 0),t})(Oe),yb=(function(o){mb(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.maxPointCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.isCrosshair=!0,r.chartid=57723,r.isLegendClicked=!1,r.isZoomed=!1,r.previousTargetId="",r.currentPointIndex=0,r.currentSeriesIndex=0,r.currentLegendIndex=0,r.previousPageX=null,r.previousPageY=null,r.allowPan=!1,r.pointsRemoved=!1,r.pointsAdded=!1,r.zoomRedraw=!1,it("mergePersistData",r.mergePersistChartData,r),r}return t.prototype.mergePersistChartData=function(){var e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(g(e)||e==="")){var i=JSON.parse(e),r=Object.keys(i);this.isProtectedOnChange=!0;for(var n=0,s=r;n<s.length;n++){var a=s[n];typeof this[a]=="object"&&!g(this[a])?pe(this[a],i[a]):this[a]=i[a]}this.isProtectedOnChange=!1}},t.prototype.isIdHasSpecialCharacter=function(e){var i=/^[A-Za-z ]+$/,r=/^[0-9 ]+$/,n="";if(i.test(e))return e;var s=0;r.test(e[0])&&(n+="\\3"+e[0],s=1);for(var a=s;a<e.length;a++)!i.test(e[a])&&e.indexOf("-")===-1&&e.indexOf("_")===-1&&e.indexOf("\\")===-1&&!r.test(e[a])?n+="\\"+e[a]:n+=e[a];return n},t.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id),this.allowServerDataBinding=!1,this.markerIndex=0,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(this.stockChart.tooltip.header===null&&(this.tooltip.header=this.stockChart.theme.indexOf("Tailwind3")>-1?"${point.x}":"<b>${point.x}</b>"),this.stockChart.tooltip.format===null&&(this.tooltip.format=this.stockChart.theme.indexOf("Tailwind3")>-1?"High : ${point.high}<br/>Low : ${point.low}<br/>Open : ${point.open}<br/>Close : ${point.close}":"High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>")),this.element.setAttribute("dir",this.enableRtl?"rtl":"ltr")},t.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.dragY=null,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.element.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.element.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.element.style.outline="none",this.element.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.title+". Syncfusion interactive chart."),this.element.classList.contains("e-chart-focused")||this.element.setAttribute("class",this.element.getAttribute("class")+" e-chart-focused"),this.element.id===""){for(var e=document.getElementsByClassName("e-chart").length,i="chart_"+this.chartid+"_"+e;document.getElementById(i);)e++,i="chart_"+this.chartid+"_"+e;this.element.id="chart_"+this.chartid+"_"+e}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},t.prototype.render=function(){var e=this;this.svgRenderer=new Ih(this.element.id);var i={chart:this,theme:this.theme,name:nb,cancel:!1};this.stockChart?(this.isRtlEnabled=window.getComputedStyle(document.querySelector("body")).direction==="rtl",this.cartesianChartRendering(i)):this.trigger(nb,i,function(){i.cancel||e.cartesianChartRendering(i)}),this.applyZoomkit()},t.prototype.cartesianChartRendering=function(e){this.setTheme(),this.createChartSvg(),this.markerRender=new O6(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.mouseMoveEvent(),this.allowServerDataBinding=!0},t.prototype.getLocalizedLabel=function(e){return this.localeObject.getConstant(e)},t.prototype.animate=function(e){if(this.redraw=!0,this.animated=!0,this.duration=e||1e3,this.tooltipModule)this.tooltipModule.removeHighlightedMarker(this.tooltipModule.previousPoints,!0);else if(this.markerRender.previousPoints)for(var i=0;i<this.markerRender.previousPoints.length;i++)this.markerRender.removeHighlightedMarker(this.markerRender.previousPoints[i].series,this.markerRender.previousPoints[i].point)},t.prototype.refreshBound=function(){this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds();var e=this.series.every(function(i){var r=i.dataSource||[];return r.length===0});if(this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),this.renderNoDataTemplate(e&&!g(this.noDataTemplate)),zt("chartmeasuretext"),this.removeSelection(),this.markerRender&&this.markerRender.mergeXvalues(this.visibleSeries)},t.prototype.renderNoDataTemplate=function(e){var i=this.element.querySelector("#"+this.element.id+"_NoDataTemplate_wrapper");if(i&&i.remove(),e){var r=this.enableHtmlSanitizer?this.sanitize(this.noDataTemplate):this.noDataTemplate,n=et("div",{id:this.element.id+"_NoDataTemplate_wrapper"}),s=0,a=this.element.querySelector("#"+this.element.id+"_ChartBorder");if(a){var l=a.getAttribute("stroke-width");s=l?parseFloat(l):0}var h=s,c=s,u=this.availableSize.width-s*2,d=this.availableSize.height-s*2;if(this.title){var p=this.title?Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height:0,f=this.subTitle?Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height:0,v=this.subTitle?5:0,m=p+f+v;switch(this.titleStyle.position){case"Top":h=m+11,d-=m+11;break;case"Left":c=m+11,u-=m+11;break;case"Bottom":d=d-m-16;break;case"Right":u=u-m-11;break}}n.style.cssText="position: absolute; top: "+h+"px; left: "+c+"px; width: "+u+`px;
            height: `+d+`px; z-index: 1;
        `;var y=fe(this.element.id+"_Secondary_Element");y.appendChild(n),gb(n,null,r,this,null,null,this.element.id+"_NoData")}},t.prototype.calculateStackValues=function(){for(var e,i=!1,r=0,n=this.visibleSeries.length;r<n;r++)e=this.visibleSeries[r],e.visible&&(e.position=e.rectCount=void 0),(e.type.indexOf("Stacking")!==-1||e.drawType.indexOf("Stacking")!==-1&&this.chartAreaType==="PolarRadar")&&!i&&(e.calculateStackedValue(e.type.indexOf("100")>-1,this),i=!0)},t.prototype.removeSelection=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];if(r.visible)for(var n=0,s=r.points;n<s.length;n++){var a=s[n];a.isSelect=!1}}fe(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),zt(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new Le(0,0,0,0),!0)):fe(this.element.id+"_ej2_drag_group")&&(this.selectionMode!=="Lasso"&&(this.selectionModule.filterArray=[]),zt(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new Le(0,0,0,0),!0))},t.prototype.renderElements=function(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition(),this.renderAnnotation(),this.stackLabels.visible&&this.visibleSeries.some(function(e){return e.type&&e.type.indexOf("Stacking")>-1})&&this.dataLabelModule&&this.dataLabelModule.renderStackLabels()},t.prototype.renderAxes=function(){this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"});var e;return this.rows.length>0&&this.columns.length>0&&(e=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),e},t.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var e=this.legendSettings.border.width,i=this.legendModule.legendBounds,r=new Le(i.x,i.y,i.width,i.height);this.enableCanvas&&(this.canvasRender.ctx.beginPath(),r=new Le(r.x-e/2,r.y-e/2,r.width+e,r.height+e),this.renderer.canvasClip(r)),this.legendModule.renderLegend(this,this.legendSettings,i),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?fe(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},t.prototype.setSecondaryElementPosition=function(){var e=fe(this.element.id+"_Secondary_Element");if(e){var i=this.element.getBoundingClientRect(),r=fe(this.svgId).getBoundingClientRect();e.style.left=Math.max((r.left-i.left)/this.scaleX,0)+"px",e.style.top=Math.max((r.top-i.top)/this.scaleY,0)+"px"}},t.prototype.initializeModuleElements=function(){this.dataLabelCollections=[],this.lastValueLabelCollections=[];var e=this.element.id;this.series.length&&(this.seriesElements=this.svgRenderer.createGroup({id:e+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:e+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:e+"TrendLineCollection"})),this.lastValueLabelModule&&(this.lastValueLabelElements=this.renderer.createGroup({id:e+"LastValueLabelCollection"})),this.dataLabelElements=this.renderer.createGroup({id:e+"DataLabelCollection"})},t.prototype.hasTrendlines=function(){for(var e,i=0,r=this.series;i<r.length;i++){var n=r[i];if(e=!!n.trendlines.length,e)break}return e},t.prototype.renderSeriesElements=function(e){this.initializeModuleElements();var i=this.element.id;if(this.element.tagName!=="g"){var r=oo(this.redraw,i+"_Secondary_Element")||this.createElement("div");r.id=i+"_Secondary_Element",r.style.cssText="position: relative",gt(!1,this.element,r,this.redraw)}if(this.enableCanvas){var n=document.getElementById(i+"_Secondary_Element");n=n||this.createElement("div",{id:i+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});var s=this.svgRenderer.createSvg({id:i+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});s.style.cssText="position: absolute; pointer-events: none",n.appendChild(s)}if(this.tooltip.enable&&!this.stockChart&&gt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:i+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0){if(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.enableCanvas)for(var a=0,l=this.visibleSeries;a<l.length;a++){var h=l[a];h.lastValueLabel.enable&&this.lastValueLabelModule.render(h,this,h.lastValueLabel)}this.trendLineElements&&gt(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(e)}},t.prototype.renderSeries=function(){var e;this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.category==="TrendLine"?e=this.series[n.sourceIndex].trendlines[n.index].visible:e=n.visible,e||n.lastValueLabelElement&&(zt(n.lastValueLabelElement.id),n.lastValueLabelElement=null),e?(this.visible++,$I(n,this.enableCanvas),this.enableCanvas&&this.renderCanvasSeries(),n.renderSeries(this)):n.isLegendClicked&&(n.type.indexOf("StackingArea")>-1||n.type.indexOf("StackingBar")>-1||n.type.indexOf("StackingColumn")>-1)&&($I(n,this.enableCanvas),n.renderSeries(this))}this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0;var s={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};if(!(!this.seriesElements||s.height<0||s.width<0)){var a;this.chartAreaType==="PolarRadar"?a=Rc(this.redraw,s,this.renderer,"drawCircularClipPath"):a=Rc(this.redraw,s,this.renderer),this.enableCanvas||this.seriesElements.appendChild(a);var l=document.getElementById(this.element.id+"_series_svg");l?gt(!1,l,this.seriesElements,this.redraw):gt(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}},t.prototype.renderCanvasSeries=function(){var e;if(this.enableCanvas){var i=e;e=i}else e=this.svgObject},t.prototype.initializeIndicator=function(){for(var e=0,i=this.indicators;e<i.length;e++){var r=i[e];this[_r(r.type)+"IndicatorModule"]&&this[_r(r.type)+"IndicatorModule"].createIndicatorElements(this,r,r.index)}this.indicatorElements&&gt(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},t.prototype.initializeTrendLine=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];r.trendlines.length&&this.trendLineModule.getTrendLineElements(r,this)}},t.prototype.appendElementsAfterSeries=function(e){this.chartAreaType==="PolarRadar"&&gt(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),gt(this.enableCanvas,this.svgObject,e,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&gt(!1,fe(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),(!this.tooltip.enable||this.stockChart)&&gt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents(),this.lastValueLabelElements&&this.lastValueLabelElements.hasChildNodes()&&gt(this.enableCanvas,this.svgObject,this.lastValueLabelElements,this.redraw)},t.prototype.applyZoomkit=function(){this.chartAreaType!=="PolarRadar"&&(!this.redraw||this.zoomRedraw)&&this.zoomModule&&(!this.zoomSettings.enablePan||this.zoomModule.performedUI||this.zoomSettings.showToolbar)&&this.zoomModule.applyZoomToolkit(this,this.axisCollections)},t.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(fe((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},t.prototype.performSelection=function(){var e=[];this.selectionModule&&(e=pe([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),e.length>0&&(this.selectionModule.selectedDataIndexes=e,this.selectionModule.redrawSelection(this,this.selectionMode))},t.prototype.processData=function(e){e===void 0&&(e=!0),this.visibleSeriesCount=0;for(var i=!0,r=0,n=0,s=this.visibleSeries;n<s.length;n++){var a=s[n];if(!a.visible&&!this.legendSettings.visible){this.visibleSeriesCount++;continue}a.category!=="Indicator"&&a.category!=="TrendLine"&&this.initializeDataModule(a)}for(var l=0,h=this.indicators;l<h.length;l++){var c=h[l];if(c.dataSource){var u=c;this.initializeDataModule(u),i=!1}}if(e&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&i)&&(this.refreshBound(),this.trigger("loaded",{chart:this})),!this.stockChart&&this.visibleSeries.length>0)for(var d=0,p=this.visibleSeries;d<p.length;d++){var a=p[d];g(a.points)||(this.maxPointCount=Math.max(r,a.points.length),r=a.points.length)}},t.prototype.initializeDataModule=function(e){e.xData=[],e.yData=[];var i,r="isAngular";this[r]?i=Object.keys(e.dataSource).length?e.dataSource:this.dataSource:i=e.dataSource||this.dataSource,e.dataModule=new EO(i,e.query),e.points=[],e.refreshDataManager(this)},t.prototype.calculateBounds=function(){var e=this.margin,i=0,r=0,n=this.titleStyle.position==="Top"||this.titleStyle.position==="Bottom"&&!this.legendSettings.visible?15:5,s=e.left+this.border.width,a=this.availableSize.width-s-e.right-this.border.width,l=0;this.titleCollection=[],this.subTitleCollection=[],this.title?(this.titleCollection=gd(this.title,this.titleStyle,a,this.enableRtl,this.themeStyle.chartTitleFont),i=Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length+n,this.subTitle&&(this.subTitleCollection=gd(this.subTitle,this.subTitleStyle,a,this.enableRtl,this.themeStyle.chartSubTitleFont),r=Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length+n)):this.legendSettings.position!=="Top"&&this.border.width&&(l=10);var h=e.top+l+this.border.width+this.chartArea.border.width*.5,c=this.availableSize.height-h-this.border.width-e.bottom,u=r+i+this.titleStyle.border.width+this.subTitleStyle.border.width;switch(this.titleStyle.position){case"Top":h+=u,c-=u;break;case"Bottom":c-=u;break;case"Left":s+=u,a-=u;break;case"Right":s-=this.titleStyle.border.width+this.subTitleStyle.border.width,a-=u;break}if(this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?h+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(s+=this.stockChart.stockLegendModule.legendBounds.width)),this.scrollBarModule&&(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.zoomModule.isZoomed||this.scrollSettingEnabled))for(var d=10,p=0,f=this.axisCollections.length;p<f;p++){var v=this.axisCollections[p];v.orientation==="Horizontal"&&v.scrollbarSettings.position==="Bottom"?c-=v.scrollbarSettings.height+d:v.orientation==="Horizontal"&&v.scrollbarSettings.position==="Top"?(c-=v.scrollbarSettings.height+d,h+=v.scrollbarSettings.height+d):v.orientation==="Vertical"&&v.scrollbarSettings.position==="Right"?a-=v.scrollbarSettings.height+d:v.orientation==="Vertical"&&v.scrollbarSettings.position==="Left"&&(a-=v.scrollbarSettings.height+d,s+=v.scrollbarSettings.height+d)}this.initialClipRect=new Le(s,h,a,c),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.initialClipRect.y+=this.chartArea.margin.top,this.initialClipRect.height-=this.chartArea.margin.top+this.chartArea.margin.bottom,this.initialClipRect.x+=this.chartArea.margin.left,this.initialClipRect.width-=this.chartArea.margin.left+this.chartArea.margin.right,this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},t.prototype.print=function(e){var i=new NO(this),r=this.width;this.getModuleName()==="chart"&&parseInt(this.width,10)>=80&&this.width.indexOf("%")>-1&&(this.width="80%",this.dataBind()),i.print(e),this.getModuleName()==="chart"&&parseInt(this.width,10)>=80&&this.width.indexOf("%")>-1&&(this.width=r,this.dataBind())},t.prototype.initTrendLines=function(){this.isProtectedOnChange=!0;for(var e=0,i=this.visibleSeries;e<i.length;e++)for(var r=i[e],n=0,s=0,a=r.trendlines;s<a.length;s++){var l=a[s],h=l;this.trendLineModule&&(h.index=n,h.sourceIndex=r.index,this.trendLineModule.initSeriesCollection(h,this),h.targetSeries&&(h.targetSeries.xAxisName=r.xAxisName,h.targetSeries.yAxisName=r.yAxisName,this.visibleSeries.push(h.targetSeries))),n++}this.isProtectedOnChange=!1},t.prototype.calculateAreaType=function(){var e=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,e&&(this.requireInvertedAxis=e.type.indexOf("Bar")!==-1&&!this.isTransposed||e.type.indexOf("Bar")===-1&&this.isTransposed&&this.chartAreaType!=="PolarRadar"),this.chartAxisLayoutPanel=this.chartAreaType==="PolarRadar"?this.polarSeriesModule||this.radarSeriesModule:new I6(this)},t.prototype.calculateVisibleAxis=function(){var e,i=[this.primaryXAxis,this.primaryYAxis];i=this.chartAreaType==="Cartesian"?i.concat(this.axes):i,this.paretoSeriesModule&&this.series[0]&&this.series[0].type==="Pareto"&&(i=i.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(i)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=i)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=i);for(var r=0,n=i.length;r<n;r++){e=i[r],e.series=[],e.labels=[],e.indexLabels={},e.orientation=r===0&&this.visibleSeries.length===0?this.requireInvertedAxis?"Vertical":"Horizontal":r===1&&this.visibleSeries.length===0?this.requireInvertedAxis?"Horizontal":"Vertical":e.orientation;for(var s=0,a=this.visibleSeries;s<a.length;s++){var l=a[s];this.initAxis(l,e,!0),l.category==="Pareto"&&l.type==="Line"&&l.yAxis&&(l.yAxis.internalVisibility=l.paretoOptions.showAxis)}for(var h=0,c=this.indicators;h<c.length;h++){var u=c[h];this.initAxis(u,e,!1)}this.scrollBarModule&&!e.zoomingScrollBar&&this.scrollBarModule.injectTo(e,this),e.orientation!=null&&this.axisCollections.push(e)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},t.prototype.initAxis=function(e,i,r){e.xAxisName===i.name||e.xAxisName==null&&i.name==="primaryXAxis"?(i.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",e.xAxis=i,r&&i.series.push(e)):(e.yAxisName===i.name||e.yAxisName==null&&i.name==="primaryYAxis")&&(i.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",e.yAxis=i,r&&i.series.push(e))},t.prototype.initTechnicalIndicators=function(){for(var e=0,i=0,r=this.indicators;i<r.length;i++){var n=r[i],s=n,a=_r(s.type);if(this[a+"IndicatorModule"]){s.index=e,this[a+"IndicatorModule"].initSeriesCollection(s,this);for(var l=0,h=s.targetSeries;l<h.length;l++){var c=h[l];(n.seriesName||n.dataSource)&&this.visibleSeries.push(c)}}e++}},t.prototype.refreshTechnicalIndicator=function(e){if(this.indicators.length){var i=null;if(e instanceof Zr&&e.category!=="Indicator")for(var r=0,n=this.indicators;r<n.length;r++){var s=n[r];s.seriesName===e.name&&!s.dataSource&&(i=s,i.setDataSource(e,this))}else e instanceof YR&&(i=e,i.setDataSource(e instanceof Zr?e:null,this))}},t.prototype.calculateVisibleSeries=function(){var e;this.visibleSeries=[];for(var i=this.palettes.length?this.palettes:JI(this.theme),r=i.length,n=this.series.sort(function(l,h){return l.zOrder-h.zOrder}),s=0,a=n.length;s<a;s++){switch(e=n[s],e.category=n[0].type==="Pareto"?"Pareto":"Series",e.index=s,e.interior=e.fill||i[s%r],!e.marker.shape&&(e.marker.visible||e.type==="Scatter"||e.drawType==="Scatter")&&(e.marker.shape=TO[this.markerIndex%10],this.markerIndex++),this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some(function(l){return l.visible})),this.isSecondaryAxis(e.yAxis)&&(e.yAxis.internalVisibility=e.yAxis.series.some(function(l){return l.visible})),e.type){case"Bar":case"StackingBar":case"StackingBar100":if(n[0].type.indexOf("Bar")===-1)continue;break;case"Polar":case"Radar":if(this.chartAreaType!=="PolarRadar"||this.chartAreaType==="PolarRadar"&&(e.xAxisName!==null&&this.primaryXAxis.name!==e.xAxisName||e.yAxisName!==null&&this.primaryYAxis.name!==e.yAxisName))continue;break;case"Pareto":this.visibleSeries.push(e),this.paretoSeriesModule.initSeries(e,this);continue;default:if(this.chartAreaType==="PolarRadar"||n[0].type.indexOf("Bar")>-1)continue;break}this.visibleSeries.push(e),n[s]=e}},t.prototype.isSecondaryAxis=function(e){return this.axes.indexOf(e)>-1},t.prototype.renderTitle=function(){var e,i=this.margin,r=5;if(this.title){var n=kc(this.titleStyle.textAlignment,this.enableRtl),s=Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont);e=new Le(i.left,0,this.availableSize.width-i.left-i.right,0);var a=this.titleStyle.border.width,l=this.margin.top+s.height*3/4,h=Nc(e,this.titleStyle||this.themeStyle.chartTitleFont)+a,c=void 0,u=this.titleStyle.textAlignment,d=Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont);switch(this.titleStyle.position){case"Top":l+=a*.5,h+=n==="start"?a*.5+this.border.width:n==="end"?-a*2-this.border.width:0;break;case"Bottom":h+=n==="start"?a*.5+this.border.width:n==="end"?-a*2-this.border.width:0,l=this.availableSize.height-this.margin.bottom-d.height-s.height/2-a*.5-this.subTitleStyle.border.width*.5;break;case"Left":h=this.margin.left+s.height*3/4+a*.5,l=u==="Near"?i.bottom+a*.5+this.border.width:u==="Far"?this.availableSize.height-i.bottom-a*.5-this.border.width:this.availableSize.height/2,n=u==="Near"?"end":u==="Far"?"start":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,c="rotate(-90,"+h+","+l+")";break;case"Right":h=this.availableSize.width-this.margin.right-s.height*3/4-a*.5,l=u==="Near"?i.bottom+a*.5+this.border.width:u==="Far"?this.availableSize.height-i.bottom-a*.5-this.border.width:this.availableSize.height/2,n=u==="Near"?"start":u==="Far"?"end":"middle",n=this.enableRtl?n==="end"?"start":n==="start"?"end":n:n,c="rotate(90,"+h+","+l+")";break;case"Custom":h=this.titleStyle.x,l=this.titleStyle.y,n="middle";break}var p={id:this.element.id+"_ChartTitleBorder",x:h-(n==="middle"?s.width/2+r:n==="end"?s.width+r:r),y:l-s.height+s.height/4,rx:this.titleStyle.border.cornerRadius,ry:this.titleStyle.border.cornerRadius,width:s.width+r*2,height:s.height*this.titleCollection.length,fill:this.titleStyle.background,"stroke-width":a,stroke:this.titleStyle.border.color,transform:c||"",d:""},f=oo(this.redraw,this.element.id+"_ChartTitleBorder",p,this.renderer)||this.renderer.drawRectangle(p);gt(this.enableCanvas,this.svgObject,f,this.redraw);var v=new bn(this.element.id+"_ChartTitle",h,l,n,this.titleCollection,c,"auto"),m=oo(this.redraw,this.element.id+"_ChartTitle",v,this.renderer)||vn(this.renderer,v,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartTitleFont);m&&!this.enableCanvas&&(m.setAttribute("tabindex",this.titleStyle.accessibility.focusable?String(this.titleStyle.accessibility.tabIndex):"-1"),m.style.outline="none",m.setAttribute("class","e-chart-focused"),m.setAttribute("role",this.titleStyle.accessibility.accessibilityRole),m.setAttribute("aria-label",this.titleStyle.accessibility.accessibilityDescription)),this.subTitle&&this.renderSubTitle(v)}},t.prototype.renderSubTitle=function(e){for(var i=0,r=0,n=0,s=0,a=10,l=this.titleStyle.textAlignment,h=0,c=this.titleCollection;h<c.length;h++){var u=c[h];n=Xe(u,this.titleStyle,this.themeStyle.chartTitleFont).width,i=n>i?n:i}for(var d=0,p=this.subTitleCollection;d<p.length;d++){var f=p[d];s=Xe(f,this.subTitleStyle,this.themeStyle.chartSubTitleFont).width,r=s>r?s:r}i=Math.max(n,r);var v=Xe(this.subTitleCollection.reduce(function(M,E){return M.length>E.length?M:E}),this.subTitleStyle,this.themeStyle.chartSubTitleFont),m=kc(this.subTitleStyle.textAlignment,this.enableRtl),y=new Le(l==="Center"?e.x-i*.5:l==="Far"?e.x-i:e.x,0,i,0);this.titleStyle.position==="Left"&&(y.x=l==="Center"?e.x-i*.5:l==="Far"?this.margin.left+v.height*3/4:e.x-i);var b=Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont),S=e.y*e.text.length+v.height+a/2+this.titleStyle.border.width+this.subTitleStyle.border.width*.5;this.titleStyle.position==="Bottom"&&(S=e.y*e.text.length+a/2+b.height/2+v.height/2);var C={id:this.element.id+"_ChartSubTitleBorder",x:Nc(y,this.subTitleStyle)-(m==="middle"?v.width/2+a/2:m==="end"?v.width+a/2:a/2),y:S-v.height+v.height/4,rx:this.subTitleStyle.border.cornerRadius,ry:this.subTitleStyle.border.cornerRadius,width:v.width+a,height:v.height*this.subTitleCollection.length,fill:this.subTitleStyle.background,"stroke-width":this.subTitleStyle.border.width,stroke:this.subTitleStyle.border.color,transform:e.transform,d:""},x=oo(this.redraw,this.element.id+"_ChartSubTitleBorder",C,this.renderer)||this.renderer.drawRectangle(C);gt(this.enableCanvas,this.svgObject,x,this.redraw);var I=new bn(this.element.id+"_ChartSubTitle",Nc(y,this.subTitleStyle),S,kc(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,e.transform,"auto"),D=oo(this.redraw,this.element.id+"_ChartSubTitle",I,this.renderer)||vn(this.renderer,I,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas,null,this.themeStyle.chartSubTitleFont);D&&!this.enableCanvas&&(D.setAttribute("tabindex",this.subTitleStyle.accessibility.focusable?String(this.subTitleStyle.accessibility.tabIndex):"-1"),this.subTitleStyle.accessibility.focusable&&(D.style.outline="none"),D.setAttribute("class","e-chart-focused"),D.setAttribute("role",this.subTitleStyle.accessibility.accessibilityRole),D.setAttribute("aria-label",this.subTitleStyle.accessibility.accessibilityDescription))},t.prototype.renderBorder=function(){var e=0,i=0,r=this.border.width,n=this.backgroundImage,s=n?"transparent":this.background||this.themeStyle.background;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?i+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(e+=this.stockChart.stockLegendModule.legendBounds.width));var a=new ys(this.element.id+"_ChartBorder",s,this.border,1,new Le(r*.5+e,r*.5+i,this.availableSize.width-r,this.availableSize.height-r),0,0,"",this.border.dashArray);if(this.htmlObject=oo(this.redraw,this.element.id+"_ChartBorder",a,this.renderer)||this.renderer.drawRectangle(a),this.htmlObject.setAttribute("aria-hidden","true"),gt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),n){var l=new ZI(this.availableSize.height-r,this.availableSize.width-r,n,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=oo(this.redraw,this.element.id+"_ChartBackground",l,this.renderer)||this.renderer.drawImage(l),gt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}},t.prototype.renderAreaBorder=function(){if(this.chartAreaType==="PolarRadar")return null;var e=fe(this.element.id+"_ChartAreaBorder"),i=e?new Le(+e.getAttribute("x"),+e.getAttribute("y"),+e.getAttribute("width"),+e.getAttribute("height")):null,r=new ys(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect,0,0,"",this.chartArea.border.dashArray);if(r.height<0||r.width<0)return null;this.htmlObject=this.renderer.drawRectangle(r),this.htmlObject.setAttribute("aria-hidden","true"),gt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,i),this.htmlObject=null;var n=this.chartArea.backgroundImage;if(n){var s=this.chartArea.border.width,a=new ZI(this.initialClipRect.height-s,this.initialClipRect.width-s,n,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(a),gt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}},t.prototype.addSeries=function(e){for(var i=window.scrollY||document.documentElement.scrollTop,r=0,n=e;r<n.length;r++){var s=n[r];s=new Zr(this,"series",s,!0),this.series.push(s)}this.refresh(),window.scrollTo(0,i)},t.prototype.removeSeries=function(e){this.redraw=!1;var i=window.scrollY||document.documentElement.scrollTop,r=this.visibleSeries[e];r&&(r.xAxis.series.length<=1&&(r.xAxis.orientation=null),r.yAxis.series.length<=1&&(r.yAxis.orientation=null));for(var n=0;n<this.axes.length;n++)this.axes[n].orientation===null&&this.axes.splice(n,1);this.series.splice(e,1),this.refresh(),window.scrollTo(0,i)},t.prototype.clearSeries=function(){this.series=[];var e=window.scrollY||document.documentElement.scrollTop;this.refresh(),window.scrollTo(0,e)},t.prototype.addAxes=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n=new Jy(this,"axes",n),this.axes.push(n)}this.refresh()},t.prototype.removeAxis=function(e){this.redraw=!1,this.axes.splice(e,1),this.refresh()},t.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.visibleSeriesCount=null,this.dataLabelElements=null,this.lastValueLabelCollections=null,this.lastValueLabelElements=null,this.yAxisElements=null;var e=document.getElementById(this.element.id+"Keyboard_chart_focus");e&&e.remove();var i=document.getElementById(this.element.id+"_ej2_chart_highlight");i&&i.remove();var r=document.getElementById(this.element.id+"_ej2_chart_selection");r&&r.remove(),zt("chartmeasuretext"),this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),o.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},t.prototype.getModuleName=function(){return"chart"},t.prototype.getPersistData=function(){var e=["loaded","animationComplete","primaryXAxis","primaryYAxis"];return this.addOnPersist(e)},t.prototype.createChartSvg=function(){this.removeSvg(),IO(this)},t.prototype.unWireEvents=function(){var e=j.touchStartEvent,i=j.touchMoveEvent,r=j.touchEndEvent,n=j.isPointer?"pointerleave":"mouseleave";T.remove(this.element,e,this.chartOnMouseDown),T.remove(this.element,i,this.mouseMove),T.remove(this.element,r,this.mouseEnd),T.remove(this.element,"click",this.chartOnMouseClick),T.remove(this.element,"dblclick",this.chartOnDoubleClick),T.remove(this.element,"contextmenu",this.chartRightClick),T.remove(this.element,n,this.mouseLeave),T.remove(this.element,"keydown",this.chartKeyDown),T.remove(document.body,"keydown",this.documentKeyHandler),T.remove(this.element,"keyup",this.chartKeyUp),window.removeEventListener(j.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},t.prototype.wireEvents=function(){if(this.element){var e=j.isPointer?"pointerleave":"mouseleave";T.add(this.element,j.touchStartEvent,this.chartOnMouseDown,this),T.add(this.element,j.touchMoveEvent,this.mouseMove,this),T.add(this.element,j.touchEndEvent,this.mouseEnd,this),T.add(this.element,"click",this.chartOnMouseClick,this),T.add(this.element,"dblclick",this.chartOnDoubleClick,this),T.add(this.element,"contextmenu",this.chartRightClick,this),T.add(this.element,e,this.mouseLeave,this),T.add(this.element,"keydown",this.chartKeyDown,this),T.add(document.body,"keydown",this.documentKeyHandler,this),T.add(this.element,"keyup",this.chartKeyUp,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(j.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new jr(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500}),this.setStyle(this.element)}},t.prototype.chartRightClick=function(e){return this.crosshair.enable&&this.crosshairModule&&(e.buttons===2||e.which===0||e.pointerType==="touch")?(e.preventDefault(),e.stopPropagation(),!1):!0},t.prototype.setStyle=function(e){var i=this.zoomSettings,r=i.enableSelectionZooming||i.enablePinchZooming||this.selectionMode!=="None"||this.highlightMode!=="None";e.style.touchAction=r?"none":"element",e.style.msTouchAction=r?"none":"element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block",e.style.overflow="hidden",e.style.height=e.style.height||this.height&&this.height.indexOf("%")===-1?e.style.height:"inherit"},t.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},t.prototype.longPress=function(e){return this.mouseX=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientX:0,this.mouseY=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.allowPan=this.stockChart?!1:this.allowPan,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",e),!1},t.prototype.setMouseXY=function(e,i){if(fe(this.svgId)){var r=fe(this.svgId).getBoundingClientRect(),n=this.element.getBoundingClientRect();this.scaleX=r.width/this.availableSize.width,this.scaleY=r.height/this.availableSize.height,this.mouseY=(i-n.top-Math.max(r.top-n.top,0))/this.scaleY,this.mouseX=(e-n.left-Math.max(r.left-n.left,0))/this.scaleX,this.stockChart&&(this.mouseX+=this.stockChart.legendSettings.position==="Left"?this.stockChart.stockLegendModule.legendBounds.width:0,this.mouseY+=this.stockChart.legendSettings.position==="Top"?this.stockChart.stockLegendModule.legendBounds.height:0)}},t.prototype.export=function(e,i){this.exportModule&&(this.exportModule.export(e,i),this.afterExport&&this.exportModule.getDataUrl(this))},t.prototype.chartResize=function(){var e=this;this.animateSeries=!1;var i={chart:this,name:ob,currentSize:new Wt(0,0),previousSize:new Wt(this.availableSize.width,this.availableSize.height)},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(hO,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(e.isDestroyed||e.stockChart){clearTimeout(e.resizeTo);return}e.createChartSvg(),i.currentSize=e.availableSize,e.trigger(ob,i),e.refreshAxis(),e.refreshBound(),e.trigger("loaded",{chart:e})},500)),!1},t.prototype.mouseMove=function(e){var i,r,n;return this.allowPan||(e.type==="touchmove"?(this.isTouch=!0,n=e,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=e.pointerType==="touch"||e.pointerType==="2"||this.isTouch,i=e.clientX,r=e.clientY),this.previousPageX=i,this.previousPageY=r,fe(this.svgId)&&(this.setMouseXY(i,r),this.chartOnMouseMove(e))),!1},t.prototype.mouseLeave=function(e){var i,r,n;return this.stockChart&&this.stockChart.onPanning||(e.type==="touchleave"?(this.isTouch=!0,n=e,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=e.pointerType==="touch"||e.pointerType==="2",i=e.clientX,r=e.clientY),this.previousPageX=null,this.previousPageY=null,this.setMouseXY(i,r),this.chartOnMouseLeave(e)),!1},t.prototype.chartOnMouseLeave=function(e){var i=e.target,r=j.isPointer?"pointerleave":"mouseleave";return this.trigger(aO,{target:i.id,x:this.mouseX,y:this.mouseY}),zt(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(r,e),!1},t.prototype.chartOnDoubleClick=function(e){var i=e.target;return this.trigger(rO,{target:i.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.chartKeyDown=function(e){var i="";return(this.isZoomed&&e.code==="Tab"||e.code==="Space")&&e.preventDefault(),this.tooltip.enable&&(e.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||e.code==="Escape")&&(i="ESC"),this.highlightMode!=="None"&&e.code==="Tab"&&this.previousTargetId.indexOf("_chart_legend_")>-1&&this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),e.ctrlKey&&(e.key==="+"||e.code==="Equal"||e.key==="-"||e.code==="Minus")?(e.preventDefault(),this.isZoomed=this.zoomModule&&(this.zoomSettings.enableDeferredZooming||this.zoomSettings.enableSelectionZooming||this.zoomSettings.enablePinchZooming||this.zoomSettings.enableMouseWheelZooming),i=this.isZoomed?e.code:""):e.keyCode===82&&this.isZoomed?(e.preventDefault(),this.isZoomed=!1,i="R"):e.code.indexOf("Arrow")>-1&&(e.preventDefault(),i=this.isZoomed?e.code:""),e.ctrlKey&&e.key==="p"&&(e.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(e,e.target.id,i),e.code==="Tab"&&this.removeNavigationStyle(),!1},t.prototype.chartKeyUp=function(e){var i="",r=e.target.id,n,s,a=e.target,l=fe(this.element.id+"_ChartTitle"),h=fe(this.element.id+"SeriesCollection"),c=fe(this.element.id+"_chart_legend_translate_g"),u=fe(this.element.id+"_chart_legend_pageup");if(l&&l.setAttribute("class","e-chart-focused"),h&&h.firstElementChild&&h.firstElementChild.children[1]){var d=h.firstElementChild.children[1],p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(c){var d=c.firstElementChild,p=d.getAttribute("class");p&&p.indexOf("e-chart-focused")===-1?p=p+" e-chart-focused":p||(p="e-chart-focused"),d.setAttribute("class",p)}if(u&&u.setAttribute("class","e-chart-focused"),e.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Series_")>-1&&r.indexOf("_Series_")===-1){n=fe(this.element.id+"SeriesCollection");var f=void 0;(this.previousTargetId.indexOf("_Symbol")>-1?fe(this.element.id+"SymbolGroup"+this.currentSeriesIndex):n.children[this.currentSeriesIndex])&&(f=this.previousTargetId.indexOf("_Symbol")>-1?fe(this.element.id+"SymbolGroup"+this.currentSeriesIndex).children[this.currentPointIndex+1]:this.previousTargetId.indexOf("_Point_")>-1?n.children[this.currentSeriesIndex].children[this.currentPointIndex+1]:n.children[this.currentSeriesIndex]),this.currentPointIndex=0,this.currentSeriesIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(e.target,fe(this.element.id+"_chart_legend_pageup")):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("_chart_legend_g_")===-1&&(n=fe(this.element.id+"_chart_legend_translate_g"),this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild));if(this.previousTargetId=r,r.indexOf("SeriesGroup")>-1){this.currentSeriesIndex=+r.split("SeriesGroup")[1],a.removeAttribute("tabindex"),a.blur(),a.children.length>1&&a.children[1].id.indexOf("_Point_")===-1&&(s=fe(this.element.id+"SymbolGroup"+r.split("SeriesGroup")[1]));var v=null;s&&s.children.length>1?v=s.children[1]:a.children.length>1&&(v=a.children[1]),v&&(r=this.focusChild(v))}else r.indexOf("_ChartTitle")>-1&&this.setNavigationStyle(r);i=r!==this.element.id?"Tab":""}else if(e.code.indexOf("Arrow")>-1){if(e.preventDefault(),this.previousTargetId=r,r.indexOf("_chart_legend_page")>-1)e.code==="ArrowLeft"?(fe(this.element.id+"_chart_legend_pagedown").removeAttribute("tabindex"),this.focusChild(fe(this.element.id+"_chart_legend_pageup"))):e.code==="ArrowRight"&&(fe(this.element.id+"_chart_legend_pageup").removeAttribute("tabindex"),this.focusChild(fe(this.element.id+"_chart_legend_pagedown")));else if(r.indexOf("_chart_legend_")>-1){var m=a.parentElement.children;m[this.currentLegendIndex].removeAttribute("tabindex"),this.currentLegendIndex+=e.code==="ArrowUp"||e.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,m.length);var y=m[this.currentLegendIndex];this.focusChild(y),this.removeNavigationStyle(),this.setNavigationStyle(y.id),r=y.children[1].id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Series_")>-1){n=a.parentElement.parentElement;var b=e.target;if(a.removeAttribute("tabindex"),a.blur(),e.code==="ArrowRight"||e.code==="ArrowLeft"){for(var S=[],C=0;C<n.children.length;C++)n.children[C].id.indexOf("SeriesGroup")>-1&&S.push(+n.children[C].id.split("SeriesGroup")[1]);this.currentSeriesIndex=S.indexOf(this.currentSeriesIndex)+(e.code==="ArrowRight"?1:-1),this.currentSeriesIndex=S[this.getActualIndex(this.currentSeriesIndex,S.length)]}else this.currentPointIndex+=e.code==="ArrowUp"?1:-1;r.indexOf("_Symbol")>-1?(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,fe(this.element.id+"SymbolGroup"+this.currentSeriesIndex).childElementCount-1),b=fe(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex+"_Symbol")):r.indexOf("_Point_")>-1&&(this.currentPointIndex=this.getActualIndex(this.currentPointIndex,fe(this.element.id+"SeriesGroup"+this.currentSeriesIndex).childElementCount-1),b=fe(this.element.id+"_Series_"+this.currentSeriesIndex+"_Point_"+this.currentPointIndex)),r=this.focusChild(b),i="ArrowMove"}}else(e.code==="Enter"||e.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_page")>-1?r:r.indexOf("_chart_legend_")>-1?a.children[1].id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(e,r,i),!1},t.prototype.setTabIndex=function(e,i){e&&e.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},t.prototype.getActualIndex=function(e,i){return e>i-1?0:e<0?i-1:e},t.prototype.focusChild=function(e){e.setAttribute("tabindex","0");var i=e.getAttribute("class");return e.setAttribute("tabindex","0"),i&&i.indexOf("e-chart-focused")===-1?i="e-chart-focused "+i:i||(i="e-chart-focused"),e.setAttribute("class",i),e.focus(),e.id},t.prototype.documentKeyHandler=function(e){e.altKey&&e.keyCode===74&&!g(this.element)&&(this.element.focus(),this.setNavigationStyle(this.element.id))},t.prototype.setNavigationStyle=function(e){var i=document.getElementById(e);i&&(i.style.setProperty("outline",this.focusBorderWidth+"px solid "+(this.focusBorderColor||this.themeStyle.tabColor)),i.style.setProperty("margin",this.focusBorderMargin+"px"))},t.prototype.removeNavigationStyle=function(){var e=document.querySelectorAll("[id*=_Point_], [id*="+this.element.id+"], [id*=_ChartBorder], text[id*=_ChartTitle],g[id*=_chart_legend],  text[id*=_ChartSubTitle], div[id*=_Annotation], g[id*=IndicatorGroup], g[id*=_Zooming_Zoom], g[id*=_Zooming_ZoomIn], g[id*=_Zooming_ZoomOut], g[id*=_Zooming_Pan], g[id*=_Zooming_Reset], path[id*=_TrendLine_]");e&&e.forEach(function(i){(i instanceof HTMLElement||i instanceof SVGElement)&&(i.style.setProperty("outline","none"),i.style.setProperty("margin",""))})},t.prototype.chartKeyboardNavigations=function(e,i,r){switch(this.isLegendClicked=!1,this.removeNavigationStyle(),(r.indexOf("Arrow")>-1||r==="Tab")&&this.setNavigationStyle(i),r){case"Tab":case"ArrowMove":if(this.highlightModule&&this.highlightModule.removeLegendHighlightStyles(),i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],s=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],a=this.visibleSeries[n].points[s].symbolLocations[0];this.mouseX=a.x+this.initialClipRect.x-(this.visibleSeries[n].type.indexOf("StackingBar")>-1?this.visibleSeries[n].marker.height/2:0),this.mouseY=a.y+this.initialClipRect.y+(this.visibleSeries[n].type.indexOf("StackingColumn")>-1?this.visibleSeries[n].marker.height/2:0),this.highlightModule&&(this.highlightModule.highlightChart(document.getElementById(i),"mousemove"),this.highlightModule.completeSelection(document.getElementById(i),"mousemove")),this.tooltipModule&&this.tooltipModule.tooltip()}if(this.highlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var l=this.element.id+"_chart_legend",h=[l+"_text_",l+"_shape_marker_",l+"_shape_"],c=0;c<h.length;c++){var u=h[c];if(i.indexOf(u)>-1){document.getElementById(i).setAttribute("class",""),this.highlightModule.legendSelection(this,parseInt(i.split(u)[1],10),document.getElementById(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1?(this.isLegendClicked=!0,this.legendModule.click(e),this.focusChild(document.getElementById(i).parentElement),this.setNavigationStyle(document.getElementById(i).parentElement.id)):(this.selectionModule&&this.selectionModule.calculateSelectedElements(document.getElementById(i),"click"),this.setNavigationStyle(i));break;case"CtrlP":this.print();break;case"ESC":this.tooltipModule.removeTooltip(1);break;case"Equal":case"Minus":this.zoomModule.isZoomed=this.zoomModule.performedUI=!0,this.zoomModule.isPanning=this.isChartDrag=!1,r==="Equal"?this.zoomModule.toolkit.zoomInOutCalculation(1,this,this.axisCollections,this.zoomSettings.mode):this.zoomModule.toolkit.zoomInOutCalculation(-1,this,this.axisCollections,this.zoomSettings.mode),this.zoomModule.performZoomRedraw(this),this.element.focus();break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":{var d=r==="ArrowUp"?10:r==="ArrowDown"?-10:0,p=r==="ArrowLeft"?-10:r==="ArrowRight"?10:0;this.zoomModule.isPanning=this.isChartDrag=!0,this.zoomModule.doPan(this,this.axisCollections,p,d),this.zoomModule.performZoomRedraw(this),this.element.focus();break}case"R":this.zoomModule.toolkit.reset(e);break}},t.prototype.chartOnMouseClick=function(e){var i=this,r=e.target,n=this;this.clickCount++;var s=this.FindXYPointValue(n.mouseX,n.mouseY),a=400;this.clickCount===1?this.singleClickTimer=+setTimeout(function(){n.clickCount=0,n.trigger(iO,{target:r.id,x:n.mouseX,y:n.mouseY,axisData:s})},a):this.clickCount===2&&!this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0);var l="isAngular";if(this[l]){var h="observers";a=this.pointDoubleClick[h].length>0?400:0}else a=this.pointDoubleClick?400:0;return this.clickCount===1&&this.pointClick?this.singleClickTimer=+setTimeout(function(){i.clickCount=0,i.triggerPointEvent(nO,e)},a):this.clickCount===2&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent(zq,e)),this.axisLabelClick&&this.triggerAxisLabelClickEvent(Oq,e),this.removeNavigationStyle(),this.notify("click",e),!1},t.prototype.FindXYPointValue=function(e,i){if(Pi(e,i,this.chartAxisLayoutPanel.seriesClipRect)&&this.series.some(function(c){return c.visible})){for(var r=void 0,n=void 0,s=void 0,a={},l=0,h=this.axisCollections.length;l<h;l++)r=this.axisCollections[l],r.orientation==="Horizontal"?(n=gO(Math.abs(e-r.rect.x),r.rect.width,r),a[this.axisCollections[l].name]=n):(s=vO(Math.abs(i-r.rect.y),r.rect.height,r),a[this.axisCollections[l].name]=s);return a}return null},t.prototype.triggerPointEvent=function(e,i){var r=i,n=new nM(this),s=n.getData();s.series&&s.point&&this.trigger(e,{series:s.series,point:s.point,seriesIndex:s.series.index,pointIndex:s.point.index,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},t.prototype.triggerAxisLabelClickEvent=function(e,i){var r=i.target,n=i;if(r.id.indexOf("_AxisLabel_")!==-1){var s=r.id.split("_AxisLabel_"),a=+s[0].slice(-1),l=+s[1],h=this.axisCollections[a];h.visible&&(a===0||a===1)&&this.trigger(e,{chart:this,axis:h,text:h.visibleLabels[l].text,labelID:r.id,index:l,location:new at(n.pageX,n.pageY),value:h.visibleLabels[l].value})}},t.prototype.chartOnMouseMove=function(e){var i=e.target,r=this.FindXYPointValue(this.mouseX,this.mouseY);return this.trigger(tO,{target:i.id,x:this.mouseX,y:this.mouseY,axisData:r}),this.pointMove&&this.triggerPointEvent(sO,e),this.isTouch||(this.titleTooltip(e,this.mouseX,this.mouseY),this.axisTooltip(e,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(e),this.crosshair.enable&&this.startMove&&e.preventDefault(),this.notify(j.touchMoveEvent,e),this.isTouch=!1,!1},t.prototype.titleTooltip=function(e,i,r,n){var s=e.target.id,a=s===this.element.id+"_ChartTitle"||s===this.element.id+"_ChartSubTitle"||s.indexOf("_AxisTitle")>-1||s.indexOf("_legend_title")>-1,l=0;if(s.indexOf("_AxisTitle")>-1&&(l=parseInt(s.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),a&&e.target.textContent.indexOf("...")>-1){var h=s===this.element.id+"_ChartTitle"?this.title:s.indexOf("_AxisTitle")>-1?this.axisCollections[l].title:s.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title;pd(h,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",fe(this.element.id+"_Secondary_Element"),n)}else zt(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.axisTooltip=function(e,i,r,n){var s=e.target.id;if((s.indexOf("AxisLabel")>-1||s.indexOf("Axis_MultiLevelLabel")>-1)&&e.target.textContent.indexOf("...")>-1){var a=this.legendSettings.visible||this.primaryXAxis.title==="";pd(this.findAxisLabel(s),i,r,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",fe(this.element.id+"_Secondary_Element"),n,a)}else zt(this.element.id+"_EJ2_AxisLabel_Tooltip")},t.prototype.findAxisLabel=function(e){var i;return e.indexOf("AxisLabel")>-1?(i=e.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(i[0],10)].visibleLabels[parseInt(i[1],10)].originalText):(i=e.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(i[0],10)].multiLevelLabels[parseInt(i[1],10)].categories[parseInt(i[2],10)].text)},t.prototype.chartOnMouseDown=function(e){var i,r,n,s,a=this.FindXYPointValue(this.mouseX,this.mouseY),l=j.isDevice?20:30,h=this.element.getBoundingClientRect(),c=e.target;this.stockChart&&this.stockChart.zoomSettings.enablePan&&(this.allowPan=!0),this.trigger(oO,{target:c.id,x:this.mouseX,y:this.mouseY,axisData:a}),e.type==="touchstart"?(this.isTouch=!0,s=e,i=s.changedTouches[0].clientX,r=s.changedTouches[0].clientY,n=s.target):(this.isTouch=e.pointerType==="touch",i=e.clientX,r=e.clientY,n=e.target);var u=fe(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=i-h.left-Math.max(u.left-h.left,0),this.mouseDownY=this.previousMouseMoveY=r-h.top-Math.max(u.top-h.top,0),this.isTouch&&(this.isDoubleTap=new Date().getTime()<this.threshold&&n.id.indexOf(this.element.id+"_Zooming_")===-1&&(this.mouseDownX-l>=this.mouseX||this.mouseDownX+l>=this.mouseX)&&(this.mouseDownY-l>=this.mouseY||this.mouseDownY+l>=this.mouseY)&&(this.mouseX-l>=this.mouseDownX||this.mouseX+l>=this.mouseDownX)&&(this.mouseY-l>=this.mouseDownY||this.mouseY+l>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(j.touchStartEvent,e),!1},t.prototype.mouseEnd=function(e){var i,r,n;return e.type==="touchend"?(n=e,r=n.changedTouches[0].clientX,this.isTouch=!0,i=n.changedTouches[0].clientY):(i=e.clientY,r=e.clientX,this.isTouch=e.pointerType==="touch"||e.pointerType==="2"),this.setMouseXY(r,i),this.chartOnMouseUp(e),!1},t.prototype.chartOnMouseUp=function(e){var i=e.target,r=this.FindXYPointValue(this.mouseX,this.mouseY);return this.trigger(lO,{target:i.id,x:this.mouseX,y:this.mouseY,axisData:r}),this.isChartDrag=!1,this.allowPan=!1,this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.threshold=new Date().getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(j.touchEndEvent,e),!1},t.prototype.setCulture=function(){this.intl=new Nt,this.setLocaleConstants(),this.localeObject=new Ri(this.getModuleName(),this.defaultLocalConstants,this.locale)},t.prototype.setAnnotationValue=function(e,i){var r=fe(this.element.id+"_Annotation_Collections"),n=this.annotations[e],s;i!==null&&(n.content=i,r?(zt(this.element.id+"_Annotation_"+e),s=this.createElement("div"),this.annotationModule.processAnnotation(n,e,s),r.appendChild(s.children[0])):this.annotationModule.renderAnnotations(fe(this.element.id+"_Secondary_Element")))},t.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},t.prototype.setTheme=function(){this.themeStyle=MO(this.theme,this.enableCanvas,this)},t.prototype.requiredModules=function(){var e=this,i=[],r=this.series,n=!1,s,a=!1,l=!1,h=!1,c=this.zoomSettings,u=!1;return this.chartAreaType=r.length>0&&(r[0].type==="Polar"||r[0].type==="Radar")?"PolarRadar":"Cartesian",this.tooltip.enable&&i.push({member:"Tooltip",args:[this]}),r.map(function(d){e.isLegend=e.legendSettings.visible&&(d.name!==""||!!e.isLegend),s=d.type.indexOf("100")!==-1?d.type.replace("100","")+"Series":d.type+"Series",a=d.errorBar.visible||a,h=d.marker.dataLabel.visible||h||d.type==="Pareto"&&d.paretoOptions.marker.dataLabel.visible,u=d.lastValueLabel.enable||u,l=d.dragSettings.enable||l,i.some(function(p){return p.member===s})||i.push({member:s,args:[e,r]}),e.chartAreaType==="PolarRadar"&&i.push({member:d.drawType+"Series",args:[e,r]}),d.type==="Pareto"&&(i.push({member:"ColumnSeries",args:[e,r]}),i.push({member:"LineSeries",args:[e,r]}))}),this.findIndicatorModules(i),this.findTrendLineModules(i),i=this.findAxisModule(i),n=this.annotations.some(function(d){return d.content!==null}),a&&i.push({member:"ErrorBar",args:[this,r]}),this.isLegend&&i.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&i.push({member:"Export",args:[this]}),this.chartAreaType!=="PolarRadar"&&this.crosshair.enable&&i.push({member:"Crosshair",args:[this]}),this.chartAreaType!=="PolarRadar"&&!this.scrollSettingEnabled&&(c.enableSelectionZooming||c.enableMouseWheelZooming||c.enablePinchZooming||c.enablePan||c.enableScrollbar||c.showToolbar)&&(i.push({member:"Zoom",args:[this,this.zoomSettings]}),c.enableScrollbar&&i.push({member:"ScrollBar",args:[this]})),this.selectionMode!=="None"&&!(this.chartAreaType==="PolarRadar"&&this.selectionMode.indexOf("Drag")>-1)&&i.push({member:"Selection",args:[this]}),(this.highlightMode!=="None"||this.legendSettings.enableHighlight)&&i.push({member:"Highlight",args:[this]}),(h||this.stackLabels.visible)&&i.push({member:"DataLabel",args:[this,r]}),u&&i.push({member:"LastValueLabel",args:[this,r]}),l&&i.push({member:"DataEditing",args:[this]}),n&&i.push({member:"Annotation",args:[this]}),i},t.prototype.findAxisModule=function(e){var i=[];i.push(this.primaryXAxis),i.push(this.primaryYAxis),i=i.concat(this.axes);for(var r=!1,n=!1,s=!1,a=!1,l=!1,h=!1,c=0,u=i;c<u.length;c++){var d=u[c];r=d.valueType==="DateTime"||r,n=d.valueType==="Category"||n,s=d.valueType==="Logarithmic"||s,l=d.valueType==="DateTimeCategory"||l,a=this.findStriplineVisibility(d.stripLines)||a,h=d.multiLevelLabels.length>0||h,this.scrollSettingEnabled=d.scrollbarSettings.enable?!0:this.scrollSettingEnabled}return r&&e.push({member:"DateTime",args:[this]}),n&&e.push({member:"Category",args:[this]}),s&&e.push({member:"Logarithmic",args:[this]}),a&&e.push({member:"StripLine",args:[this]}),h&&e.push({member:"MultiLevelLabel",args:[this]}),l&&e.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&e.push({member:"ScrollBar",args:[this]}),e},t.prototype.findIndicatorModules=function(e){var i,r,n=this.indicators;if(this.indicators.length){e.push({member:"LineSeries",args:[this]}),n.map(function(h){i=i||h.type==="Macd",r=r||h.type==="BollingerBands"}),i&&e.push({member:"ColumnSeries",args:[this]}),r&&e.push({member:"RangeAreaSeries",args:[this]}),r&&e.push({member:"SplineRangeAreaSeries",args:[this]});for(var s=0,a=this.indicators;s<a.length;s++){var l=a[s];e.push({member:l.type+"Indicator",args:[this]})}}},t.prototype.findTrendLineModules=function(e){for(var i=this,r,n,s=function(u){var d;u.trendlines.map(function(p){d=d||i.getActualProperties(p).marker&&i.getActualProperties(p).marker.visible,r=!!(r||p.type==="Linear"||p.type==="MovingAverage"),n=!!(n||!r||p.type==="Exponential"||p.type==="Logarithmic"||p.type==="Power"||p.type==="Polynomial")}),d&&e.push({member:"Marker",args:[a,u]})},a=this,l=0,h=this.series;l<h.length;l++){var c=h[l];s(c)}(r||n)&&e.push({member:"TrendLine",args:[this]}),r&&e.push({member:"LineSeries",args:[this]}),n&&e.push({member:"SplineSeries",args:[this]})},t.prototype.findStriplineVisibility=function(e){for(var i=!1,r=0,n=e;r<n.length;r++){var s=n[r];if(s.visible){i=!0;break}}return i},t.prototype.removeSvg=function(){if(this.redraw)return null;if(this.enableCanvas&&this.svgObject&&this.svgObject.tagName==="CANVAS")return this.renderer.clearRect(new Le(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&Qe(this.svgObject),null;zt(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();var e=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),e=1),this.svgObject){for(;this.svgObject.childNodes.length>e;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&!this.stockChart&&Qe(this.svgObject)}this.trendLineElements=null},t.prototype.refreshDefinition=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n.axes=[]}},t.prototype.refreshAxis=function(){var e=this.primaryXAxis;e.rect=new Le(void 0,void 0,0,0),e=this.primaryYAxis,e.isStack100=!1,e.rect=new Le(void 0,void 0,0,0);for(var i=0,r=this.axes;i<r.length;i++){var n=r[i];e=n,e.rect=new Le(void 0,void 0,0,0),e.isStack100=!1}if(this.paretoSeriesModule&&this.series[0]&&this.series[0].type==="Pareto")for(var s=0,a=this.paretoSeriesModule.paretoAxes;s<a.length;s++){var n=a[s];e=n,e.rect=new Le(void 0,void 0,0,0),e.isStack100=!1}},t.prototype.axisChange=function(e){return!e.name&&!e.valueType?!1:(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},t.prototype.getVisibleSeries=function(e,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},t.prototype.refreshLiveData=function(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1)},t.prototype.removeStyles=function(){zt(this.element.id+"_ej2_chart_selection"),zt(this.element.id+"_ej2_chart_highlight")},t.prototype.mouseMoveEvent=function(){if(this.tooltip.enable&&this.previousPageX!==null&&this.previousPageY!==null){var e=document.createEvent("MouseEvent");e.initMouseEvent("mousemove",!0,!1,window,1,100,100,this.previousPageX,this.previousPageY,!1,!1,!1,!1,0,null),this.element.dispatchEvent(e)}},t.prototype.showTooltip=function(e,i,r){if(r===void 0&&(r=!1),r)for(var n=0,s=this.visibleSeries;n<s.length;n++)for(var a=s[n],l=0,h=a.points;l<h.length;l++){var c=h[l],u=a.xAxis.valueType==="DateTime"?c.xValue:c.x,d=e;if(a.xAxis.valueType==="DateTime"&&(d=new Date(d).getTime()),e===u&&i===c.yValue){this.mouseX=c.regions[0].x+this.chartAxisLayoutPanel.seriesClipRect.x,this.mouseY=c.regions[0].y+this.chartAxisLayoutPanel.seriesClipRect.y,this.tooltipModule.tooltip(),this.markerRender.mouseMoveHandler();break}}else this.isTouch&&(this.startMove=!0),this.mouseX=e,this.mouseY=i,this.tooltipModule.mouseMoveHandler(),this.markerRender.mouseMoveHandler()},t.prototype.hideTooltip=function(){this.tooltipModule.removeTooltip(j.isDevice?2e3:1e3)},t.prototype.showCrosshair=function(e,i){this.mouseX=e,this.mouseY=i,this.isCrosshair=!1,Pi(this.mouseX,this.mouseY,this.chartAxisLayoutPanel.seriesClipRect)?this.crosshairModule.crosshair():this.hideCrosshair(),this.isCrosshair=!0},t.prototype.hideCrosshair=function(){this.crosshairModule.removeCrosshair(j.isDevice?2e3:1e3)},t.prototype.sanitize=function(e){return this.enableHtmlSanitizer?Pt.sanitize(e):e},t.prototype.onPropertyChanged=function(e,i){var r=!1,n=!1;this.animateSeries=!1;var s,a=!1,l=!1;if(!this.delayRedraw&&!this.zoomRedraw){for(var h=0,c=Object.keys(e);h<c.length;h++){var u=c[h];switch(a=a||u!=="primaryXAxis"&&u!=="primaryYAxis"&&u!=="axes",l&&a&&(this.redraw=!1),u){case"primaryXAxis":s=e.primaryXAxis,n=this.axisChange(s),e.primaryXAxis.edgeLabelPlacement&&(r=!0),e.primaryXAxis.crosshairTooltip||(n=!0),e.primaryXAxis.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.primaryXAxis.setIsInversedAndOpposedPosition(),(!this.primaryXAxis.zoomingScrollBar||!this.primaryXAxis.zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a),e.primaryXAxis.crosshairTooltip&&(e.primaryXAxis.crosshairTooltip.enable||(zt(this.element.id+"_axis_tooltip_0"),zt(this.element.id+"_axis_tooltip_text_0")));break;case"primaryYAxis":s=e.primaryYAxis,n=this.axisChange(s),e.primaryYAxis.edgeLabelPlacement&&(r=!0),e.primaryYAxis.crosshairTooltip||(n=!0),e.primaryYAxis.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.primaryYAxis.setIsInversedAndOpposedPosition(),(!this.primaryYAxis.zoomingScrollBar||!this.primaryYAxis.zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a),e.primaryYAxis.crosshairTooltip&&(e.primaryYAxis.crosshairTooltip.enable||(zt(this.element.id+"_axis_tooltip_1"),zt(this.element.id+"_axis_tooltip_text_1")));break;case"axes":for(var d=0,p=Object.keys(e.axes);d<p.length;d++){var f=p[d];s=e.axes[f],n=n||this.axisChange(s),s.crosshairTooltip||(n=!0),s.scrollbarSettings&&(n=!0),(!g(s.isInversed)||!g(s.opposedPosition))&&this.axes[f].setIsInversedAndOpposedPosition(),(!this.axes[f].zoomingScrollBar||!this.axes[f].zoomingScrollBar.isScrollUI)&&this.zoomModule&&(!g(s.zoomFactor)||!g(s.zoomPosition))&&(this.redraw=this.zoomSettings.enableAnimation&&!a,l=this.zoomSettings.enableAnimation&&!a),s.crosshairTooltip&&(s.crosshairTooltip.enable||(zt(this.element.id+"_axis_tooltip_"+this.axes[f].index),zt(this.element.id+"_axis_tooltip_text_"+this.axes[f].index)))}break;case"height":case"width":this.createChartSvg(),n=!0;break;case"subTitle":case"title":n=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow||e.titleStyle.position)?n=!0:r=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?n=!0:r=!0;break;case"border":r=!0;break;case"dataSource":this.processData(!1),n=!0;break;case"enableCanvas":this.refresh();break;case"series":{for(var v=this.series.length,m=!1,y=void 0,b=0;b<v;b++){if(y=e.series[b],!g(y)&&y.lastValueLabel&&this.series[b].lastValueLabel.enable&&this.lastValueLabelModule){this.lastValueLabelCollections=[];var S=pe(this.series[b].lastValueLabel,y.lastValueLabel);this.lastValueLabelModule.render(this.series[b],this,S,!0),this.series[b].lastValueLabelElement&&gt(this.enableCanvas,this.lastValueLabelElements,this.series[b].lastValueLabelElement,!0)}else!g(y)&&y.lastValueLabel&&!y.lastValueLabel.enable&&this.series[b]&&this.series[b].lastValueLabelElement&&(zt(this.series[b].lastValueLabelElement.id),this.series[b].lastValueLabelElement=null);!g(y)&&(y.dataSource||y.query||y.errorBar||y.xName||y.yName||y.size||y.high||y.low||y.open||y.close||y.trendlines||y.fill||y.name||y.marker||y.width||y.binInterval||y.type||y.visible!==i.series[b].visible||y.legendShape||y.emptyPointSettings||y.opacity||y.columnWidth||y.columnSpacing||y.opacity||y.dashArray||y.bearFillColor||y.bullFillColor)&&(pe(this.getVisibleSeries(this.visibleSeries,b),y,null,!0),m=!0)}m&&(this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),n=!0);break}case"indicators":n=!0;break;case"zoomSettings":(e.zoomSettings.enableScrollbar||i.zoomSettings.enableScrollbar)&&(n=!0),r=!0;break;case"background":r=!0;break;case"chartArea":e.chartArea.border&&e.chartArea.border.width&&(n=!0),r=!0;break;case"legendSettings":(!e.legendSettings.background||!e.legendSettings.opacity)&&(n=!0),r=!0;break;case"palettes":this.calculateVisibleSeries(),r=!0;break;case"selectedDataIndexes":this.selectionModule?(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0)):this.highlightModule&&(this.highlightModule.currentMode=this.highlightMode,this.highlightModule.highlightDataIndexes=this.selectedDataIndexes,this.highlightModule.styleId=this.element.id+"_ej2_chart_highlight",this.highlightModule.redrawSelection(this,i.selectionMode,!0));break;case"selectionMode":this.selectionModule&&e.selectionMode&&e.selectionMode.indexOf("Drag")===-1&&(this.selectionModule.currentMode=this.selectionMode,i.selectionMode==="None"&&this.selectionModule.invokeSelection(this),this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!e.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),r=!0;break;case"theme":this.animateSeries=!0;break;case"enableRtl":case"locale":case"currencyCode":this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[],this.tooltip.template&&(this.tooltipModule.template=this.tooltip.template));break}}!n&&r&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this})),n&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.dragY=null,this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this}),this.redraw=!1,this.animated=!1)}this.zoomRedraw=!1},Fe([w(null)],t.prototype,"noDataTemplate",void 0),Fe([w(null)],t.prototype,"width",void 0),Fe([w(null)],t.prototype,"height",void 0),Fe([w("")],t.prototype,"title",void 0),Fe([w("")],t.prototype,"dataSource",void 0),Fe([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},NR)],t.prototype,"titleStyle",void 0),Fe([w("")],t.prototype,"subTitle",void 0),Fe([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null,accessibility:{focusable:!1}},NR)],t.prototype,"subTitleStyle",void 0),Fe([Ce({},vd)],t.prototype,"margin",void 0),Fe([Ce({color:"#DDDDDD",width:0},qn)],t.prototype,"border",void 0),Fe([w(null)],t.prototype,"background",void 0),Fe([Ce({border:{color:null,width:.5},background:"transparent"},kq)],t.prototype,"chartArea",void 0),Fe([w(!1)],t.prototype,"enableHtmlSanitizer",void 0),Fe([Ce({name:"primaryXAxis"},Jy)],t.prototype,"primaryXAxis",void 0),Fe([Ce({name:"primaryYAxis"},Jy)],t.prototype,"primaryYAxis",void 0),Fe([Gt([{}],qq)],t.prototype,"rows",void 0),Fe([Gt([{}],Yq)],t.prototype,"columns",void 0),Fe([Gt([{}],Jy)],t.prototype,"axes",void 0),Fe([Gt([{}],Zr)],t.prototype,"series",void 0),Fe([Gt([{accessibility:{focusable:!1}}],Pq)],t.prototype,"annotations",void 0),Fe([w([])],t.prototype,"palettes",void 0),Fe([w("Material")],t.prototype,"theme",void 0),Fe([Ce({},$R)],t.prototype,"tooltip",void 0),Fe([Ce({},j6)],t.prototype,"crosshair",void 0),Fe([Ce({},AO)],t.prototype,"legendSettings",void 0),Fe([Gt([{}],B6)],t.prototype,"rangeColorSettings",void 0),Fe([Ce({},H6)],t.prototype,"zoomSettings",void 0),Fe([w("")],t.prototype,"highlightColor",void 0),Fe([w("None")],t.prototype,"selectionMode",void 0),Fe([w("None")],t.prototype,"highlightMode",void 0),Fe([w("None")],t.prototype,"selectionPattern",void 0),Fe([w("None")],t.prototype,"highlightPattern",void 0),Fe([w(!1)],t.prototype,"isMultiSelect",void 0),Fe([w(!1)],t.prototype,"allowMultiSelection",void 0),Fe([w(!0)],t.prototype,"enableExport",void 0),Fe([w(!1)],t.prototype,"allowExport",void 0),Fe([Gt([],JR)],t.prototype,"selectedDataIndexes",void 0),Fe([w(!1)],t.prototype,"useGroupingSeparator",void 0),Fe([w(!1)],t.prototype,"enableAutoIntervalOnBothAxis",void 0),Fe([w(!1)],t.prototype,"isTransposed",void 0),Fe([w(!1)],t.prototype,"enableCanvas",void 0),Fe([w(null)],t.prototype,"backgroundImage",void 0),Fe([Gt([],YR)],t.prototype,"indicators",void 0),Fe([w(!0)],t.prototype,"enableAnimation",void 0),Fe([w(null)],t.prototype,"description",void 0),Fe([w(1)],t.prototype,"tabIndex",void 0),Fe([w(!0)],t.prototype,"enableSideBySidePlacement",void 0),Fe([Ce({},Bo)],t.prototype,"accessibility",void 0),Fe([w(null)],t.prototype,"focusBorderColor",void 0),Fe([w(1.5)],t.prototype,"focusBorderWidth",void 0),Fe([w(0)],t.prototype,"focusBorderMargin",void 0),Fe([Ce({},Wq)],t.prototype,"stackLabels",void 0),Fe([G()],t.prototype,"resized",void 0),Fe([G()],t.prototype,"beforeResize",void 0),Fe([G()],t.prototype,"annotationRender",void 0),Fe([G()],t.prototype,"beforePrint",void 0),Fe([G()],t.prototype,"loaded",void 0),Fe([G()],t.prototype,"beforeExport",void 0),Fe([G()],t.prototype,"afterExport",void 0),Fe([G()],t.prototype,"load",void 0),Fe([G()],t.prototype,"animationComplete",void 0),Fe([G()],t.prototype,"legendRender",void 0),Fe([G()],t.prototype,"textRender",void 0),Fe([G()],t.prototype,"pointRender",void 0),Fe([G()],t.prototype,"seriesRender",void 0),Fe([G()],t.prototype,"axisLabelRender",void 0),Fe([G()],t.prototype,"axisLabelClick",void 0),Fe([G()],t.prototype,"axisRangeCalculated",void 0),Fe([G()],t.prototype,"axisMultiLabelRender",void 0),Fe([G()],t.prototype,"legendClick",void 0),Fe([G()],t.prototype,"multiLevelLabelClick",void 0),Fe([G()],t.prototype,"tooltipRender",void 0),Fe([G()],t.prototype,"sharedTooltipRender",void 0),Fe([G()],t.prototype,"chartMouseMove",void 0),Fe([G()],t.prototype,"chartMouseClick",void 0),Fe([G()],t.prototype,"chartDoubleClick",void 0),Fe([G()],t.prototype,"pointClick",void 0),Fe([G()],t.prototype,"pointDoubleClick",void 0),Fe([G()],t.prototype,"pointMove",void 0),Fe([G()],t.prototype,"chartMouseLeave",void 0),Fe([G()],t.prototype,"chartMouseDown",void 0),Fe([G()],t.prototype,"chartMouseUp",void 0),Fe([G()],t.prototype,"dragComplete",void 0),Fe([G()],t.prototype,"selectionComplete",void 0),Fe([G()],t.prototype,"zoomComplete",void 0),Fe([G()],t.prototype,"onZooming",void 0),Fe([G()],t.prototype,"scrollStart",void 0),Fe([G()],t.prototype,"scrollEnd",void 0),Fe([G()],t.prototype,"scrollChanged",void 0),Fe([G()],t.prototype,"dragStart",void 0),Fe([G()],t.prototype,"drag",void 0),Fe([G()],t.prototype,"dragEnd",void 0),Fe([w("USD")],t.prototype,"currencyCode",void 0),t=Fe([It],t),t})(ti),V6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),kO=(function(o){V6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.calculateDateTimeNiceInterval=function(e,i,r,n,s){s===void 0&&(s=!0);var a=1440*60*1e3,l=new Date(r),h=new Date(n),c=Math.abs((l.getTime()-h.getTime())/a),u;e.actualIntervalType=e.intervalType;var d=e.intervalType;switch(d){case"Years":u=this.calculateNumericNiceInterval(e,c/365,i);break;case"Quarter":u=this.calculateNumericNiceInterval(e,c/365*4,i);break;case"Months":u=this.calculateNumericNiceInterval(e,c/30,i);break;case"Weeks":u=this.calculateNumericNiceInterval(e,c/7,i);break;case"Days":u=this.calculateNumericNiceInterval(e,c,i);break;case"Hours":u=this.calculateNumericNiceInterval(e,c*24,i);break;case"Minutes":u=this.calculateNumericNiceInterval(e,c*24*60,i);break;case"Seconds":u=this.calculateNumericNiceInterval(e,c*24*60*60,i);break;case"Auto":return u=this.calculateNumericNiceInterval(e,c/365,i),u>=1?(e.actualIntervalType="Years",u):(u=this.calculateNumericNiceInterval(e,c/30,i),u>=1?(e.actualIntervalType="Months",u):(u=this.calculateNumericNiceInterval(e,c/7,i),u>=1&&!s?(e.actualIntervalType="Weeks",u):(u=this.calculateNumericNiceInterval(e,c,i),u>=1?(e.actualIntervalType="Days",u):(u=this.calculateNumericNiceInterval(e,c*24,i),u>=1?(e.actualIntervalType="Hours",u):(u=this.calculateNumericNiceInterval(e,c*24*60,i),u>=1?(e.actualIntervalType="Minutes",u):(u=this.calculateNumericNiceInterval(e,c*24*60*60,i),e.actualIntervalType="Seconds",u))))))}return u},t.prototype.getSkeleton=function(e,i,r){var n,s=e.actualIntervalType;return e.skeleton?e.skeleton:(s==="Years"?n=e.isChart?e.valueType==="DateTime"&&e.isIntervalInDecimal?"y":"yMMM":"y":s==="Quarter"?n="yMMM":s==="Months"?n=e.isChart?"MMMd":"MMM":s==="Weeks"?n="MEd":s==="Days"?n=e.isChart?e.valueType==="DateTime"?"MMMd":"yMd":"MMMd":s==="Hours"?n=e.isChart?e.valueType==="DateTime"?"Hm":"EHm":"h":s==="Minutes"?n=e.isChart?"Hms":"hm":n=e.isChart?"Hms":"hms",n)},t.prototype.findCustomFormats=function(e){var i=e.labelFormat?e.labelFormat:"";return e.isChart&&!e.skeleton&&e.actualIntervalType==="Months"&&!i&&(i=e.valueType==="DateTime"?"MMM yyyy":"yMMM"),i},t})(eO),_6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),FO=(function(o){_6(t,o);function t(e){return o.call(this,e)||this}return t.prototype.calculateRangeAndInterval=function(e,i){this.calculateRange(i),this.getActualRange(i,e),this.applyRangePadding(i,e),this.calculateVisibleLabels(i,this.chart)},t.prototype.getActualRange=function(e,i){var r={skeleton:"full",type:"dateTime"},n=this.chart.intl.getDateParser(r),s=this.chart.intl.getDateFormat(r);e.minimum!==null?this.min=Date.parse(n(s(new Date(ge.parse.parseJson({val:e.minimum}).val)))):(this.min===null||this.min===Number.POSITIVE_INFINITY)&&(this.min=Date.parse(n(s(new Date(1970,1,1))))),e.maximum!==null?this.max=Date.parse(n(s(new Date(ge.parse.parseJson({val:e.maximum}).val)))):(this.max===null||this.max===Number.NEGATIVE_INFINITY)&&(this.max=Date.parse(n(s(new Date(1970,5,1))))),this.min===this.max&&(this.max=this.max+2592e6,this.min=this.min-2592e6),e.actualRange={},e.doubleRange=new Ia(this.min,this.max);var a=this.calculateDateTimeNiceInterval(e,i,e.doubleRange.start,e.doubleRange.end);e.interval?e.actualRange.interval=e.interval:e.actualRange.interval=a,e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end},t.prototype.applyRangePadding=function(e,i){this.min=e.actualRange.min,this.max=e.actualRange.max;var r,n,s=e.actualRange.interval;if(!Ps(e)){var a=e.getRangePadding(this.chart);r=new Date(this.min),n=new Date(this.max);var l=e.actualIntervalType;if(a==="None")this.min=r.getTime(),this.max=n.getTime();else if(a==="Additional"||a==="Round")switch(l){case"Years":this.getYear(r,n,a,s);break;case"Months":this.getMonth(r,n,a,s);break;case"Days":this.getDay(r,n,a,s);break;case"Hours":this.getHour(r,n,a,s);break;case"Minutes":{var h=r.getMinutes()/s*s,c=n.getMinutes()+(r.getMinutes()-h);a==="Round"?(this.min=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),h,0).getTime(),this.max=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),c,59).getTime()):(this.min=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),h+-s,0).getTime(),this.max=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),c+s,0).getTime());break}case"Seconds":{var u=r.getSeconds()/s*s,d=n.getSeconds()+(r.getSeconds()-u);a==="Round"?(this.min=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),u,0).getTime(),this.max=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),d,0).getTime()):(this.min=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),u+-s,0).getTime(),this.max=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),d+s,0).getTime());break}}}e.actualRange.min=e.minimum!=null?this.min:this.min,e.actualRange.max=e.maximum!=null?this.max:this.max,e.actualRange.delta=e.actualRange.max-e.actualRange.min,e.doubleRange=new Ia(e.actualRange.min,e.actualRange.max),this.calculateVisibleRange(i,e)},t.prototype.getYear=function(e,i,r,n){var s=e.getFullYear(),a=i.getFullYear();r==="Additional"?(this.min=new Date(s-n,1,1,0,0,0).getTime(),this.max=new Date(a+n,1,1,0,0,0).getTime()):(this.min=new Date(s,0,0,0,0,0).getTime(),this.max=new Date(a,11,30,23,59,59).getTime())},t.prototype.getMonth=function(e,i,r,n){var s=e.getMonth(),a=i.getMonth();r==="Round"?(this.min=new Date(e.getFullYear(),s,0,0,0,0).getTime(),this.max=new Date(i.getFullYear(),a,new Date(i.getFullYear(),i.getMonth(),0).getDate(),23,59,59).getTime()):(this.min=new Date(e.getFullYear(),s+-n,1,0,0,0).getTime(),this.max=new Date(i.getFullYear(),a+n,a===2?28:30,0,0,0).getTime())},t.prototype.getDay=function(e,i,r,n){var s=e.getDate(),a=i.getDate();r==="Round"?(this.min=new Date(e.getFullYear(),e.getMonth(),s,0,0,0).getTime(),this.max=new Date(i.getFullYear(),i.getMonth(),a,23,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),s+-n,0,0,0).getTime(),this.max=new Date(i.getFullYear(),i.getMonth(),a+n,0,0,0).getTime())},t.prototype.getHour=function(e,i,r,n){var s=e.getHours()/n*n,a=i.getHours()+(e.getHours()-s);r==="Round"?(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),s,0,0).getTime(),this.max=new Date(i.getFullYear(),i.getMonth(),i.getDate(),a,59,59).getTime()):(this.min=new Date(e.getFullYear(),e.getMonth(),e.getDate(),s+-n,0,0).getTime(),this.max=new Date(i.getFullYear(),i.getMonth(),i.getDate(),a+n,0,0).getTime())},t.prototype.calculateVisibleRange=function(e,i){i.visibleRange={min:i.actualRange.min,max:i.actualRange.max,interval:i.actualRange.interval,delta:i.actualRange.delta};var r=g(i.zoomingScrollBar)?!1:i.zoomingScrollBar.isLazyLoad;ud(i)&&!r&&(i.calculateVisibleRangeOnZooming(),i.visibleRange.interval=i.enableAutoIntervalOnZooming?this.calculateDateTimeNiceInterval(i,e,i.visibleRange.min,i.visibleRange.max):i.visibleRange.interval),i.dateTimeInterval=this.increaseDateTimeInterval(i,i.visibleRange.min,i.visibleRange.interval).getTime()-i.visibleRange.min,i.triggerRangeRender(this.chart,i.visibleRange.min,i.visibleRange.max,i.visibleRange.interval)},t.prototype.calculateVisibleLabels=function(e,i){e.visibleLabels=[];var r=e.visibleRange.min,n,s,a=e.visibleLabels;for(e.minimum===null&&(r=this.alignRangeStart(e,r,e.visibleRange.interval).getTime()),this.startValue&&this.startValue<r&&i.zoomModule&&i.zoomModule.isPanning?r=this.startValue:this.startValue=r;r<=e.visibleRange.max;){if(n=pe({},V("properties",e.labelStyle),null,!0),s=a.length?e.visibleLabels[a.length-1].value:r,e.format=i.intl.getDateFormat({format:this.findCustomFormats(e),type:_r(e.skeletonType),skeleton:this.getSkeleton(e,r,s)}),e.startLabel=e.format(new Date(e.visibleRange.min)),e.endLabel=e.format(new Date(e.visibleRange.max)),Th(r,e.visibleRange)){var l=this.increaseDateTimeInterval(e,r,e.visibleRange.interval).getTime();l>e.visibleRange.max&&(e.endLabel=e.format(new Date(r))),hb(i,r,e.format(new Date(r)),n,e)}var h=r;if(r=this.increaseDateTimeInterval(e,r,e.visibleRange.interval).getTime(),h===r)break}(e.actualIntervalType==="Months"||e.actualIntervalType==="Days")&&e.isChart&&(e.format=i.intl.getDateFormat({format:e.labelFormat||(e.actualIntervalType==="Months"&&!e.skeleton?"y MMM":""),type:_r(e.skeletonType),skeleton:e.skeleton||(e.actualIntervalType==="Days"?"MMMd":"")})),e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.increaseDateTimeInterval=function(e,i,r){var n=new Date(i);e.interval?(e.isIntervalInDecimal=r%1===0,e.visibleRange.interval=r):(r=Math.ceil(r),e.visibleRange.interval=r);var s=e.actualIntervalType;if(e.isIntervalInDecimal)switch(s){case"Years":return n.setFullYear(n.getFullYear()+r),n;case"Quarter":return n.setMonth(n.getMonth()+3*r),n;case"Months":return n.setMonth(n.getMonth()+r),n;case"Weeks":return n.setDate(n.getDate()+r*7),n;case"Days":return n.setDate(n.getDate()+r),n;case"Hours":return n.setHours(n.getHours()+r),n;case"Minutes":return n.setMinutes(n.getMinutes()+r),n;case"Seconds":return n.setSeconds(n.getSeconds()+r),n}else n=this.getDecimalInterval(n,r,s);return n},t.prototype.alignRangeStart=function(e,i,r){var n=new Date(i);switch(e.actualIntervalType){case"Years":{var s=Math.floor(Math.floor(n.getFullYear()/r)*r);return n=new Date(s,n.getMonth(),n.getDate(),0,0,0),n}case"Months":{var a=Math.floor(Math.floor(n.getMonth()/r)*r);return n=new Date(n.getFullYear(),a,n.getDate(),0,0,0),n}case"Days":{var l=Math.floor(Math.floor(n.getDate()/r)*r);return n=new Date(n.getFullYear(),n.getMonth(),l,0,0,0),n}case"Hours":{var h=Math.floor(Math.floor(n.getHours()/r)*r);return n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),h,0,0),n}case"Minutes":{var c=Math.floor(Math.floor(n.getMinutes()/r)*r);return n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),c,0,0),n}case"Seconds":{var u=Math.floor(Math.floor(n.getSeconds()/r)*r);return n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),u,0),n}}return n},t.prototype.getDecimalInterval=function(e,i,r){var n=Math.floor(i),s=i-n;switch(r){case"Years":{var a=Math.round(12*s);return e.setFullYear(e.getFullYear()+n),e.setMonth(e.getMonth()+a),e}case"Quarter":return e.setMonth(e.getMonth()+3*i),e;case"Months":{var l=Math.round(30*s);return e.setMonth(e.getMonth()+n),e.setDate(e.getDate()+l),e}case"Weeks":return e.setDate(e.getDate()+i*7),e;case"Days":{var h=Math.round(24*s);return e.setDate(e.getDate()+n),e.setHours(e.getHours()+h),e}case"Hours":{var c=Math.round(60*s);return e.setHours(e.getHours()+n),e.setMinutes(e.getMinutes()+c),e}case"Minutes":{var u=Math.round(60*s);return e.setMinutes(e.getMinutes()+n),e.setSeconds(e.getSeconds()+u),e}case"Seconds":{var d=Math.round(1e3*s);return e.setSeconds(e.getSeconds()+n),e.setMilliseconds(e.getMilliseconds()+d),e}}return e},t.prototype.getModuleName=function(){return"DateTime"},t.prototype.destroy=function(){},t})(kO),U6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),RO=(function(o){U6(t,o);function t(e){return o.call(this,e)||this}return t.prototype.calculateRangeAndInterval=function(e,i){this.calculateRange(i),this.getActualRange(i,e),this.applyRangePadding(i,e),this.calculateVisibleLabels(i)},t.prototype.getActualRange=function(e,i){this.initializeDoubleRange(e),e.actualRange={},e.interval?e.actualRange.interval=Math.ceil(e.interval):e.actualRange.interval=Math.max(1,Math.floor(e.doubleRange.delta/yO(i,e))),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end,e.actualRange.delta=e.doubleRange.delta},t.prototype.applyRangePadding=function(e,i){var r;e.series.forEach(function(s){r||(r=(s.type.indexOf("Column")>-1||s.type.indexOf("Bar")>-1)&&!(e.zoomFactor<1||e.zoomPosition>0)&&g(e.minimum)&&g(e.maximum))});var n=(e.labelPlacement==="BetweenTicks"||r)&&!this.chart.stockChart&&this.chart.chartAreaType!=="PolarRadar"?.5:0;n>0?(e.actualRange.min-=n,e.actualRange.max+=n):e.actualRange.max+=e.actualRange.max?0:.5,e.doubleRange=new Ia(e.actualRange.min,e.actualRange.max),e.actualRange.delta=e.doubleRange.delta,this.calculateVisibleRange(i,e)},t.prototype.calculateVisibleLabels=function(e){e.visibleLabels=[],e.visibleRange.interval=e.visibleRange.interval<1?1:e.visibleRange.interval;var i=Math.ceil(e.visibleRange.min),r;(e.zoomFactor<1||e.zoomPosition>0)&&(i=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var n;for(e.startLabel=e.labels[Math.round(e.visibleRange.min)],e.endLabel=e.labels[Math.floor(e.visibleRange.max)];i<=e.visibleRange.max;i+=e.visibleRange.interval)r=pe({},V("properties",e.labelStyle),null,!0),Th(i,e.visibleRange)&&e.labels.length>0&&(n=Math.round(i),hb(this.chart,n,e.labels[n]?e.labels[n].toString():"",r,e));e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Category"},t.prototype.destroy=function(){},t})(kO);var bb=(function(){function o(t){this.chart=t}return o.prototype.enableComplexProperty=function(t){var e=[],i=[],r=t.xAxis.visibleRange,n=t.yAxis.visibleRange,s=t.points,a=t.clipRect,l=this.chart&&this.chart.zoomRedraw&&this.chart.redraw?this.previousX:Math.abs(r.delta/a.width),h=this.chart&&this.chart.zoomRedraw&&this.chart.redraw?this.previousY:Math.abs(n.delta/a.height),c=s[0]&&s[0].xValue>l?0:l,u=s[0]&&s[0].y>h?0:h;this.previousX=l,this.previousY=h;for(var d=0,p=0,f=0,v=s;f<v.length;f++){var m=v[f];m.symbolLocations=[],d=g(m.xValue)?r.min:m.xValue,p=g(m.yValue)?n.min:m.yValue,(Math.abs(c-d)>=l||Math.abs(u-p)>=h)&&(e.push(m),c=d,u=p)}for(var y,b=0;b<e.length;b++)y=e[b],!(g(y.x)||t.category==="Indicator"&&(isNaN(y.xValue)||isNaN(y.yValue)))&&i.push(y);return i},o.prototype.getLineDirection=function(t,e,i,r,n,s){var a="";if(t!=null){var l=n(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i),h=n(e.xValue,e.yValue,i.xAxis,i.yAxis,r,i);a=s+" "+l.x+" "+l.y+" L "+h.x+" "+h.y+" "}return a},o.prototype.appendLinePath=function(t,e,i){var r=this.appendPathElement(t,e,i);fb(r.element,t.d,e.chart.redraw,r.previousDirection,r.chart.duration)},o.prototype.appendPathElement=function(t,e,i){var r=fe(t.id),n=e.chart,s=r?r.getAttribute("d"):null,a=e.chart.renderer.drawPath(t,new Int32Array([e.clipRect.x,e.clipRect.y]));if(a&&a.setAttribute("clip-path",i),e.category==="TrendLine"&&a){var l=n.series[e.sourceIndex].trendlines[e.index];l.marker.visible||a.setAttribute("tabindex",l.accessibility.focusable?String(l.accessibility.tabIndex):"-1"),a.setAttribute("role",l.accessibility.accessibilityRole?l.accessibility.accessibilityRole:""),a.setAttribute("aria-label",l.accessibility.accessibilityDescription?l.accessibility.accessibilityDescription:"")}return e.pathElement=a,e.chart.enableCanvas||e.seriesElement.appendChild(a),e.isRectSeries=!1,{element:r,previousDirection:s,chart:n}},o.prototype.addPath=function(t,e,i){var r=this.appendPathElement(t,e,i);if(r.previousDirection!==""&&t.d!==""){var n=r.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),s=t.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=Math.max(n.length,s.length),l=Math.min(n.length,s.length);if(n.length<s.length){for(var h=l;h<a;h++)s.length!==n.length&&n.push(n[n.length-1].replace("M","L"));Ma(r.element,t.d,e.chart.redraw,n.join(" "),this.chart.duration)}else if(n.length>s.length){for(var h=l;h<a;h++)s.length!==n.length&&(e.removedPointIndex===e.points.length?s.push(s[s.length-1].replace("M","L")):s.splice(1,0,s[0].replace("M","L")));Ma(r.element,s.join(""),e.chart.redraw,r.previousDirection,this.chart.duration,t.d)}else Ma(r.element,t.d,e.chart.redraw,r.previousDirection,this.chart.duration)}},o.prototype.addAreaPath=function(t,e,i){var r=this.appendPathElement(t,e,i);if(r.previousDirection!==""&&t.d!==""){var n=r.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),s=t.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=Math.max(n.length,s.length),l=Math.min(n.length,s.length);if(l<s.length){for(var h=l;h<a;h++)s.length!==n.length&&s.length!==n.length&&(n.length===1?n.push(n[n.length-(t.id.indexOf("border")!==-1?1:2)].replace("M","L")):n.splice(n.length-1,0,n[n.length-(t.id.indexOf("border")!==-1?1:2)]));Ma(r.element,t.d,e.chart.redraw,n.join(" "),this.chart.duration)}else if(n.length>s.length){for(var h=l;h<a;h++)s.length!==n.length&&(e.removedPointIndex===e.points.length?s.length===1?s.push(s[s.length-(t.id.indexOf("border")!==-1?1:2)].replace("M","L")):s.splice(s.length-1,0,s[s.length-(t.id.indexOf("border")!==-1?1:2)]):s.splice(1,0,s[1]?s[1]:s[0]));Ma(r.element,s.join(""),e.chart.redraw,r.previousDirection,this.chart.duration,t.d)}else Ma(r.element,t.d,e.chart.redraw,r.previousDirection,this.chart.duration)}},o.prototype.renderMarker=function(t){t.marker&&t.marker.visible&&t.chart.markerRender.render(t)},o.prototype.doProgressiveAnimation=function(t,e){var i=new Mt({}),r=t.pathElement,n=r.getAttribute("stroke-dasharray"),s=t.pathElement.getTotalLength(),a;r.style.visibility="hidden",i.animate(r,{duration:e.duration===0&&Yt==="Enable"?1e3:e.duration,delay:e.delay,progress:function(l){r.style.visibility="visible",a=Math.abs(Math.round(l.timeStamp*s/l.duration)),r.setAttribute("stroke-dasharray",a+","+s)},end:function(){var l=fe(t.chart.element.id+"_Annotation_Collections");l&&(l.style.visibility="visible"),t.lastValueLabelElement&&t.lastValueLabelElement.setAttribute("visibility","visible"),r.setAttribute("stroke-dasharray",n),r.style.visibility="",t.chart.trigger("animationComplete",{series:t})}})},o.prototype.storePointLocation=function(t,e,i,r){var n=e.marker&&e.marker.width?e.marker.width:0,s=e.marker&&e.marker.height?e.marker.height:0;t.symbolLocations.push(r(t.xValue,t.yValue,e.xAxis,e.yAxis,i,e)),t.regions.push(new Le(t.symbolLocations[0].x-n,t.symbolLocations[0].y-s,2*n,2*s))},o.prototype.withinYRange=function(t,e){return t.yValue>=e.visibleRange.min&&t.yValue<=e.visibleRange.max},o.prototype.GetStepLineDirection=function(t,e,i,r,n,s){r===void 0&&(r="L");var a=n.noRisers&&s?" M ":" L ";if(i==="Right")return r=n.noRisers&&s?"M":"L",r+" "+e.x+" "+t.y+" L "+t.x+" "+t.y+" ";if(i==="Center"){var l=e.x+(t.x-e.x)/2;return r+" "+l+" "+e.y+a+l+" "+t.y+" L "+t.x+" "+t.y+" "}else return r+" "+t.x+" "+e.y+a+t.x+" "+t.y+" "},o.prototype.getFirstLastVisiblePoint=function(t){for(var e=null,i=null,r=0,n=t;r<n.length;r++){var s=n[r];e===null&&s.visible&&(e=i=s),i=s.visible?s:i}return{first:e||t[0],last:i||t[t.length-1]}},o.prototype.getBorderDirection=function(t){var e=t.split(" ");return e.length>3&&!this.chart.stackingAreaSeriesModule&&!this.chart.stackingStepAreaSeriesModule?e.splice(e.length-4,3):(this.chart.stackingAreaSeriesModule||this.chart.stackingStepAreaSeriesModule)&&(e.splice(e.length/2+1,e.length/2+1),(e[e.length-1]==="L"||e[e.length-1]==="M")&&e.splice(e.length-1,1)),e.join(" ")},o.prototype.removeEmptyPointsBorder=function(t){var e=0,i=t.split(" "),r;if(i.length===4)return i.join(" ");do r=i.indexOf("M",e),r>-1&&(i.splice(r+1,3),e=r+1,r-6>0&&(i.splice(r-6,6),e-=6));while(r!==-1);return i.join(" ")},o.prototype.doLinearAnimation=function(t,e){var i=t.clipRectElement.childNodes[0].childNodes[0],r=t.chart.animated?t.chart.duration:e.duration,n=iM("Linear"),s=+i.getAttribute("height"),a=+i.getAttribute("width"),l=+i.getAttribute("x"),h=t.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y"),c;if(i.style.visibility="hidden",this.animateRect(t,e,i,r,n,s,a,l,h,c),t.marker&&t.marker.visible&&t.symbolElement){var u=t.symbolElement.childNodes[0].childNodes[0];u.style.visibility="hidden",this.animateRect(t,e,u,r,n,s,a,l,h,c)}},o.prototype.animateRect=function(t,e,i,r,n,s,a,l,h,c){new Mt({}).animate(i,{duration:r===0&&Yt==="Enable"?1e3:r,delay:e.delay,progress:function(u){i.style.visibility="visible",t.chart.requireInvertedAxis?(c=n(u.timeStamp,0,s,u.duration),i.setAttribute("transform","translate("+l+" "+h+") scale(1,"+c/s+") translate("+-l+" "+-h+")")):(c=n(u.timeStamp,0,a,u.duration),i.setAttribute("transform","translate("+l+" "+h+") scale("+c/a+", 1) translate("+-l+" "+-h+")"))},end:function(){var u=fe(t.chart.element.id+"_Annotation_Collections");u&&(u.style.visibility="visible"),t.lastValueLabelElement&&t.lastValueLabelElement.setAttribute("visibility","visible");var d=document.getElementById(t.chart.element.id+"_StackLabelGroup");d&&(Lh(d,0,r,t,null,null,!1),d.setAttribute("visibility","visible")),i.setAttribute("transform","translate(0,0)"),t.chart.trigger("animationComplete",{series:t})}})},o})(),W6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),OO=(function(o){W6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n,s,a){for(var l,h,c="",u=null,d="M",p=e.chart&&e.chart.chartAreaType==="PolarRadar",f=e.emptyPointSettings&&e.emptyPointSettings.mode==="Drop",v=p?fd:Wn,m=e.category==="TrendLine"?e.points:this.enableComplexProperty(e),y=0,b=m;y<b.length;y++){var S=b[y];S.regions=[],S.symbolLocations=[],S.visible&&Nl(m[S.index-1],S,m[S.index+1],e)?(c+=this.getLineDirection(u,S,e,n,v,d),d=u?"L":d,u=S,this.storePointLocation(S,e,n,v),c===""&&m.length===1&&(c="M "+S.symbolLocations[0].x+" "+S.symbolLocations[0].y)):(u=f?u:null,d=f?d:"M")}if(p&&e.isClosed){var C=this.getFirstLastVisiblePoint(m);h=v(C.last.xValue,C.last.yValue,i,r,n,e),l=v(C.first.xValue,C.first.yValue,i,r,n,e),c=c.concat(d+" "+h.x+" "+h.y+" L "+l.x+" "+l.y)}var x=e.category==="Indicator"?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:e.category==="TrendLine"?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+(e.index===void 0?e.category:e.index),I=new Rr(x,"none",e.width,e.interior,e.opacity,e.dashArray,c);this[s?"addPath":"appendLinePath"](I,e,""),a||this.renderMarker(e)},t.prototype.updateDirection=function(e,i){this.render(e,e.xAxis,e.yAxis,e.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)e.marker&&e.marker.visible&&e.chart.markerRender.renderMarker(e,e.points[i[r]],e.points[i[r]].symbolLocations[0],null,!0),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[i[r]],null,e.marker.dataLabel))},t.prototype.doAnimation=function(e){var i=e.animation;this.doProgressiveAnimation(e,i)},t.prototype.getModuleName=function(){return"LineSeries"},t.prototype.destroy=function(){},t})(bb),Sb=(function(){function o(){}return o.prototype.getSideBySideInfo=function(t){if(t.isRectSeries=!0,(t.chart.enableSideBySidePlacement&&!t.position||!g(t.columnWidthInPixel))&&this.getSideBySidePositions(t),t.columnWidthInPixel)return new Ia(0,0);var e=t.type==="Histogram"||!t.chart.enableSideBySidePlacement?0:t.position,i=t.type==="Histogram"||!t.chart.enableSideBySidePlacement?1:t.rectCount,r=t.chart.visibleSeries,n=t.chart.enableSideBySidePlacement?t.columnSpacing:0,s=t.columnWidth===null||isNaN(+t.columnWidth)?t.type==="Histogram"?1:.7:Math.min(t.columnWidth,1),a=mO(t.xAxis,r),l=a*s,h,c=e/i-.5,u=new Ia(c,c+1/i);if(!(isNaN(u.start)||isNaN(u.end))){if(t.groupName&&t.type.indexOf("Stacking")===-1){var d=.7;t.chart.series.filter(function(m){m.columnWidth>d&&(d=m.columnWidth)});var p=a*d,f=new Ia(u.start*p,u.end*p),v=(f.delta-(u.end*l-u.start*l))/2;u=new Ia(f.start+v,f.end-v)}else u=new Ia(u.start*l,u.end*l);h=n*u.delta,u=new Ia(u.start+h/2,u.end-h/2)}return u},o.prototype.getRectangle=function(t,e,i,r,n){var s=Wn(t,e,n.xAxis,n.yAxis,n.chart.requireInvertedAxis),a=Wn(i,r,n.xAxis,n.yAxis,n.chart.requireInvertedAxis);return new Le(Math.min(s.x,a.x),Math.min(s.y,a.y),Math.abs(a.x-s.x),Math.abs(a.y-s.y))},o.prototype.drawCylinder=function(t,e,i,r,n){var s=r.width,a=r.height;if(n.chart.enableCanvas){var l=n.chart.canvasRender.ctx,h=l;l.save();var c=_n(t.fill),u=r.x+n.clipRect.x,d=r.y+n.clipRect.y,p=2*Math.PI+.1,f=void 0,v=void 0,m=void 0,y=void 0,b=void 0,S=void 0,C=void 0,x=void 0,I=void 0,D=void 0,M=void 0,E=void 0,A=void 0,L=void 0,N=void 0,R=void 0,P=void 0,k=void 0,B=void 0,F=0,O=0,z=0,Y=0,K=0;l.fillStyle=Ec(c,.9),l.lineWidth=0,l.strokeStyle=Ec(c,.9),l.globalAlpha=t.opacity,i.isColumn?(F=u,O=s+u,f=s/2,v=f/4,y=m=u+f,D=b=d-v,x=u,C=u+s,S=I=d+a-v,P=Math.PI,k=-f,B=v,i.stacking&&(i.isLastSeries||(D=b=d+v))):(Y=a+d,z=d,v=a/2,f=v/4,x=m=u+f,C=y=u+s+f,I=d+a,D=d,S=b=d+v,K=Math.PI/2,P=Math.PI*1.5,i.stacking&&(i.isLastSeries||(C=y=u+s-f)),v=-v,f=-f,k=f,B=-v);var U=Ec(c,.7),q=l.createLinearGradient(F,z,O,Y);q.addColorStop(0,c),q.addColorStop(.3,U),q.addColorStop(.7,U),q.addColorStop(1,c);for(var ae=1;ae<=4;ae++){var te=0;for(ae<4&&l.beginPath(),ae%2===0?(M=y,E=S,A=x,L=D):(M=m,E=b,A=C,L=I),ae===4&&(f=k,v=B,l.fillStyle=q),ae>2&&(te=K,p=P);te<=p;te+=.1)N=M-f*Math.cos(te),R=E+v*Math.sin(te),te===0?l.moveTo(N,R):l.lineTo(N,R);ae>2&&l.lineTo(A,L),ae!==3&&(l.stroke(),l.fill())}t.id.indexOf("Series")>=0&&(l.clip(),l.restore(),l=h)}else{var he=n.chart,u=r.x,d=r.y,ue=t.id,c=t.fill,ne=c,le=p6(c);le||(c=_n(c));var $=0,ee=0,He=0,qe=0,we=0,je=0,Ne=void 0,Ye=void 0,dt=void 0,Ke=void 0,ci=void 0,Jt=void 0,f=void 0,v=void 0,te=2;for(i.isColumn?(f=s/2,v=f/4,Ne=dt=u,Ye=v<d?d-v:i.stacking?d+v:d-v,Ke=Ye,$=2*f,qe=v<d||a<2*v?a:i.stacking?a-2*v:a,ci=Ne,Jt=v<d?Ye+a:a<Ye?a+Ye:i.stacking?a+(d-v):a+Ye,we=100,i.stacking&&(i.isLastSeries||(Ye=Ke=d+v,qe=a<f/2?a:a-f/2))):(v=a/2,f=v/4,Ye=Ke=d,Ne=dt=Math.abs(u-f),ee=2*v,He=s,ci=Ne+s,Jt=Ye,je=100,i.stacking&&(i.isLastSeries||(ci=Ne+s-f*2,He=s-f*2))),Qe(this.element);te--;)t.d="M"+Ne.toString()+","+Ye.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+$.toString()+","+ee.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+(-1*$).toString()+","+(-1*ee).toString(),t.id=ue+"_Region_"+te,t.fill=Ec(c,.9),te%2===0&&n.type!=="StackingBar100"&&n.type!=="StackingBar"&&n.type!=="Bar"&&(t.fill=t.fill+"10"),this.element=he.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),gt(n.chart.enableCanvas,n.seriesElement,this.element,he.redraw),Ne=ci,Ye=Jt;t.d="M"+dt.toString()+","+Ke.toString()+"a"+f.toString()+","+v.toString()+" 0 1,0 "+$.toString()+","+ee.toString()+"l"+He.toString()+" "+qe.toString()+"a"+f.toString()+","+v.toString()+" 0 1,1 "+(-1*$).toString()+","+(-1*ee).toString()+" z",t.id=ue+"_Region_2",t.fill=Ec(c,.7);var vt=void 0;if(ne.indexOf("url")===-1){if(!document.getElementById(ue)){vt={id:ue,x1:"0%",y1:"0%",x2:we.toString()+"%",y2:je.toString()+"%"};var bi=[{colorStop:"0%",color:c},{colorStop:"30%",color:Ec(c,.7)},{colorStop:"70%",color:Ec(c,.7)},{colorStop:"100%",color:c}];this.drawGradient(vt,bi,n)}t.fill="url(#"+vt.id+")"}this.element=he.renderer.drawPath(this.options,new Int32Array([n.clipRect.x,n.clipRect.y])),gt(n.chart.enableCanvas,n.seriesElement,this.element,he.redraw)}},o.prototype.drawGradient=function(t,e,i){var r=i.chart,n=r.renderer.createDefs(),s="http://www.w3.org/2000/svg",a=document.createElementNS(s,"linearGradient");a.setAttribute("id",t.id),a.setAttribute("x1",t.x1),a.setAttribute("y1",t.y1),a.setAttribute("x2",t.x2),a.setAttribute("y2",t.y2);for(var l=0;l<e.length;l++){var h=document.createElementNS(s,"stop");h.setAttribute("offset",e[l].colorStop),h.setAttribute("stop-color",e[l].color),h.setAttribute("stop-opacity","1"),a.appendChild(h)}i.seriesElement.appendChild(n),n.appendChild(a)},o.prototype.getSideBySidePositions=function(t){for(var e=t.chart,i=0,r=e.columns;i<r.length;i++)for(var n=r[i],s=0,a=e.rows;s<a.length;s++){var l=a[s];this.findRectPosition(t.findSeriesCollection(n,l,!1))}},o.prototype.findRectPosition=function(t){for(var e=[],i={rectCount:0,position:null},r=0;r<t.length;r++){var n=t[r];if(n.type.indexOf("Stacking")!==-1||n.groupName!==""){var s=n.type.indexOf("Stacking")!==-1?n.stackingGroup:n.type+n.groupName;s?e[s]===void 0?(n.position=i.rectCount,e[s]=i.rectCount++):n.position=e[s]:i.position===null?(n.position=i.rectCount,i.position=i.rectCount++):n.position=i.position}else n.position=i.rectCount++}for(var r=0;r<t.length;r++){var n=t[r];n.rectCount=i.rectCount}},o.prototype.updateSymbolLocation=function(t,e,i){i.chart.requireInvertedAxis?this.updateYRegion(t,e,i):this.updateXRegion(t,e,i),i.type==="Histogram"&&(t.minimum=+t.x-i.histogramValues.binWidth/2,t.maximum=+t.x+i.histogramValues.binWidth/2)},o.prototype.updateXRegion=function(t,e,i){t.symbolLocations.push({x:e.x+e.width/2,y:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||t.yValue>=0==!i.yAxis.isAxisInverse?e.y:e.y+e.height}),this.getRegion(t,e,i),i.type==="RangeColumn"&&t.symbolLocations.push({x:e.x+e.width/2,y:e.y+e.height})},o.prototype.updateYRegion=function(t,e,i){t.symbolLocations.push({x:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||t.yValue>=0==!i.yAxis.isAxisInverse?e.x+e.width:e.x,y:e.y+e.height/2}),this.getRegion(t,e,i),i.type==="RangeColumn"&&t.symbolLocations.push({x:e.x,y:e.y+e.height/2})},o.prototype.renderMarker=function(t){t.marker&&t.marker.visible&&t.chart.markerRender.render(t)},o.prototype.getRegion=function(t,e,i){if(t.y===0){var r=i.marker&&i.marker.width?i.marker.width:0,n=i.marker&&i.marker.height?i.marker.height:0;t.regions.push(new Le(t.symbolLocations[0].x-r,t.symbolLocations[0].y-n,2*r,2*n))}else t.regions.push(e)},o.prototype.triggerEvent=function(t,e,i,r){var n={cancel:!1,name:Ah,series:t,point:e,fill:t.setPointColor(e,i),border:t.setBorderColor(e,r),cornerRadius:t.cornerRadius};return t.chart.trigger(Ah,n),e.color=n.fill,n},o.prototype.drawRectangle=function(t,e,i,r){var n=t.chart,s=n.requireInvertedAxis?i.height:i.width;if(s<=0)return null;var a;if(e.y===0)a=this.calculateRoundedRectPath(i,0,0,0,0);else{var l=void 0,h=void 0,c=void 0,u=void 0,d=e.y<0;n.requireInvertedAxis?(l=d?r.cornerRadius.topRight:r.cornerRadius.topLeft,h=d?r.cornerRadius.topLeft:r.cornerRadius.topRight,c=d?r.cornerRadius.bottomRight:r.cornerRadius.bottomLeft,u=d?r.cornerRadius.bottomLeft:r.cornerRadius.bottomRight):(l=d?r.cornerRadius.bottomLeft:r.cornerRadius.topLeft,h=d?r.cornerRadius.bottomRight:r.cornerRadius.topRight,c=d?r.cornerRadius.topLeft:r.cornerRadius.bottomLeft,u=d?r.cornerRadius.topRight:r.cornerRadius.bottomRight),a=this.calculateRoundedRectPath(i,l,h,c,u,n.requireInvertedAxis)}var p=t.category==="Indicator"?n.element.id+"_Indicator_"+t.index+"_"+t.name+"_Point_"+e.index:n.element.id+"_Series_"+t.index+"_Point_"+(t.removedPointIndex!==null&&t.removedPointIndex<=e.index?e.index+1:e.index),f=oo(n.redraw,p),v=f?f.getAttribute("d"):"";switch(this.options=new Rr(p,r.fill,r.border.width,r.border.color,t.opacity,t.border.dashArray,t.columnFacet==="Cylinder"?"":a),this.element=n.renderer.drawPath(this.options,new Int32Array([t.clipRect.x,t.clipRect.y])),t.removedPointIndex!==null&&t.removedPointIndex<=e.index&&(this.element.id=n.element.id+"_Series_"+t.index+"_Point_"+e.index),t.seriesType){case"XY":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",t.accessibility.accessibilityDescriptionFormat?t.formatAccessibilityDescription(e,t):e.x+":"+e.yValue+", "+t.name);break;case"HighLow":this.element.setAttribute("role","img"),this.element.setAttribute("aria-label",t.accessibility.accessibilityDescriptionFormat?t.formatAccessibilityDescription(e,t):e.x+":"+e.high+", "+e.low+", "+t.name);break}t.columnFacet==="Cylinder"&&(n.redraw||!n.enableAnimation)&&t.seriesElement.querySelector("#"+this.element.id)||gt(t.chart.enableCanvas,t.seriesElement,this.element,n.redraw),t.chart.enableCanvas||fb(this.element,t.columnFacet==="Cylinder"?"":a,n.redraw,v,n.duration)},o.prototype.animate=function(t){for(var e=t.seriesElement.childNodes,i=t.category==="Indicator"?0:1,r=Eh(t),n=0,s=r;n<s.length;n++){var a=s[n];if(!(!a.symbolLocations.length&&!(t.type==="BoxAndWhisker"&&a.regions.length)))if((t.type==="Column"||t.type==="Bar"||t.type==="StackingColumn"||t.type==="StackingColumn100"||t.type==="StackingBar"||t.type==="StackingBar100")&&t.columnFacet==="Cylinder")for(var l=0;l<e.length;l++)this.animateRect(e[l],t,a);else this.animateRect(e[i],t,a),i++}},o.prototype.animateRect=function(t,e,i){var r=e.animation,n=e.chart.animated?e.chart.duration:r.duration,s=iM("Linear"),a=i.yValue<0,l,h,c=+i.regions[0].height,u=+i.regions[0].width,d,p;e.chart.requireInvertedAxis?(h=+i.regions[0].y,e.type.indexOf("Stacking")>-1?(l=Un(0,e.yAxis)*e.yAxis.rect.width,d=l,p=h):(l=+i.regions[0].x,p=a?h:h+c,d=e.seriesType.indexOf("HighLow")!==-1||e.type.indexOf("Waterfall")!==-1?l+u/2:a!==e.yAxis.isAxisInverse?l+u:l)):(l=+i.regions[0].x,e.type.indexOf("Stacking")>-1?(h=(1-Un(0,e.yAxis))*e.yAxis.rect.height,d=l,p=h):(h=+i.regions[0].y,p=e.seriesType.indexOf("HighLow")!==-1||e.type.indexOf("Waterfall")!==-1?h+c/2:a!==e.yAxis.isAxisInverse?h:h+c,d=a?l:l+u));var f;g(t)||(t.style.visibility="hidden",new Mt({}).animate(t,{duration:n===0&&Yt==="Enable"?1e3:n,delay:r.delay,progress:function(v){v.timeStamp>=v.delay&&(t.style.visibility="visible",e.chart.requireInvertedAxis?(u=u||1,f=s(v.timeStamp-v.delay,0,u,v.duration),t.setAttribute("transform","translate("+d+" "+p+") scale("+f/u+", 1) translate("+-d+" "+-p+")")):(c=c||1,f=s(v.timeStamp-v.delay,0,c,v.duration),t.setAttribute("transform","translate("+d+" "+p+") scale(1,"+f/c+") translate("+-d+" "+-p+")")))},end:function(){var v=document.getElementById(e.chart.element.id+"_Annotation_Collections");v&&(v.style.visibility="visible"),e.lastValueLabelElement&&e.lastValueLabelElement.setAttribute("visibility","visible");var m=document.getElementById(e.chart.element.id+"_StackLabelGroup");m&&(Lh(m,0,n,e,null,null,!1),m.setAttribute("visibility","visible")),t.setAttribute("transform","translate(0,0)");var y=e.seriesElement;if((t===y.lastElementChild||i.index===e.points.length-1||e.type==="Waterfall"&&t===y.children[y.childElementCount-2])&&(e.chart.trigger("animationComplete",{series:e}),e.type==="Waterfall"))for(var b=y.childNodes,S=0;S<b.length;S++)b[S].id.indexOf("Connector")!==-1&&(b[S].style.visibility="visible",b[S].setAttribute("transform","translate(0,0)"))}}))},o.prototype.calculateRoundedRectPath=function(t,e,i,r,n,s){var a=t.width/2,l=t.height/2;return e=Math.min(e,a,l),i=Math.min(i,a,l),r=Math.min(r,a,l),n=Math.min(n,a,l),"M "+t.x+" "+(e+t.y)+" Q "+t.x+" "+t.y+" "+(t.x+e)+" "+t.y+" L "+(t.x+t.width-i)+" "+t.y+" Q "+(t.x+t.width)+" "+t.y+" "+(t.x+t.width)+" "+(t.y+i)+" L "+(t.x+t.width)+" "+(t.y+t.height-n)+" Q "+(t.x+t.width)+" "+(t.y+t.height)+" "+(t.x+t.width-n)+" "+(t.y+t.height)+" L "+(t.x+r)+" "+(t.y+t.height)+" Q "+t.x+" "+(t.y+t.height)+" "+t.x+" "+(t.y+t.height-r)+" L "+t.x+" "+(e+t.y)+" Z"},o})(),q6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),zO=(function(o){q6(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.sideBySideInfo=[],e}return t.prototype.render=function(e){this.sideBySideInfo[e.index]=this.getSideBySideInfo(e);for(var i=Math.max(e.yAxis.visibleRange.min,0),r=0,n=e.points;r<n.length;r++){var s=n[r];this.renderPoint(e,s,this.sideBySideInfo[e.index],i)}this.renderMarker(e)},t.prototype.renderPoint=function(e,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&Nl(e.points[i.index-1],i,e.points[i.index+1],e)){this.rect=this.getRectangle(i.xValue+r.start,i.yValue,i.xValue+r.end,n,e),this.rect.width=e.columnWidthInPixel?e.columnWidthInPixel-(e.chart.enableSideBySidePlacement?e.columnWidthInPixel*e.columnSpacing:0):this.rect.width,this.rect.x=e.columnWidthInPixel?this.rect.x-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):this.rect.x;var s=e.category==="Indicator"?i.color:e.interior,a=this.triggerEvent(e,i,s,{width:e.border.width,color:e.border.color});if(!a.cancel){var l=this.rect.y;if(i.yValue<n&&i.yValue>=0&&e.chart.zoomModule&&e.chart.zoomModule.isAxisZoomed(e.chart.axisCollections)&&(l=Wn(i.xValue+r.start,i.yValue,e.xAxis,e.yAxis,e.chart.requireInvertedAxis).y),this.updateSymbolLocation(i,new Le(this.rect.x,l,this.rect.width,this.rect.height),e),this.drawRectangle(e,i,this.rect,a),e.columnFacet==="Cylinder"){var h={isColumn:!0,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,h,this.rect,e)}}}},t.prototype.updateDirection=function(e,i){for(var r=Math.max(e.yAxis.visibleRange.min,0),n=0;n<i.length;n++)this.renderPoint(e,e.points[i[n]],this.sideBySideInfo[e.index],r),e.marker&&e.marker.visible&&e.chart.markerRender.renderMarker(e,e.points[i[n]],e.points[i[n]].symbolLocations[0],null,!0),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[i[n]],null,e.marker.dataLabel))},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"ColumnSeries"},t.prototype.destroy=function(){},t})(Sb),Y6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),G6=(function(o){Y6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.getAreaPathDirection=function(e,i,r,n,s,a,l){var h="",c;return a===null&&(c=s(e,i,r.xAxis,r.yAxis,n,r),h+=l+" "+c.x+" "+c.y+" "),h},t.prototype.getAreaEmptyDirection=function(e,i,r,n,s){var a="";return a+=this.getAreaPathDirection(e.x,e.y,r,n,s,null,"L"),a+=this.getAreaPathDirection(i.x,i.y,r,n,s,null,"L"),a},t.prototype.setPointColor=function(e,i,r,n,s){if(r.pointColorMapping===""){for(var a=void 0,l=void 0,h=0;h<s.length;h++)if(a=s[h],l=n?e.xValue:e.yValue,l<=this.getAxisValue(a.value,n?r.xAxis:r.yAxis,r.chart)||!a.value&&a.value!==0){e.interior=a.color;break}return e.interior==null&&(e.interior=r.interior),!1}else return i?r.setPointColor(e,r.interior)!==r.setPointColor(i,r.interior):!1},t.prototype.sortSegments=function(e,i){var r=this,n=e.segmentAxis==="X"?e.xAxis:e.yAxis,s=[].concat(i);return s.sort(function(a,l){return r.getAxisValue(a.value,n,e.chart)-r.getAxisValue(l.value,n,e.chart)})},t.prototype.applySegmentAxis=function(e,i,r,n){var s=this;if(e.pointColorMapping!=="")return i.map(function(S){s[n?"addMulticolorPath":"appendLinePath"](S,e,"")}),null;var a=e.segmentAxis==="X",l=a?e.xAxis:e.yAxis,h=e.chart,c;this.includeSegment(r,l,e,r.length);for(var u=r.length,d,p,f,v=0,m=function(S){c=r[S],d=y.getAxisValue(c.value,l,e.chart),p=y.createClipRect(S?y.getAxisValue(r[S-1].value,l,e.chart):l.visibleRange.min,d,e,S,a),p&&i.map(function(C){v+=1,f={"clip-path":p,"stroke-dasharray":c.dashArray,opacity:C.opacity,stroke:e.type.indexOf("Line")>-1?c.color||e.interior:C.stroke,"stroke-width":C["stroke-width"],fill:e.type.indexOf("Line")>-1?"none":c.color||e.interior,id:C.id+"_Segment_"+S,d:C.d},v%2===0&&s.chart.multiColoredAreaSeriesModule&&e.border.color!=="transparent"&&f["stroke-width"]!==0&&(f.fill="transparent"),n?s.addMulticolorPath(f,e,"",!0):fb(fe(f.id),f.d,h.redraw),e.pathElement=h.renderer.drawPath(f),!e.chart.enableCanvas&&!n&&e.seriesElement.appendChild(h.renderer.drawPath(f))})},y=this,b=0;b<u;b++)m(b)},t.prototype.includeSegment=function(e,i,r,n){if(n<=0)return e.push({value:i.visibleRange.max,color:r.interior}),null;this.getAxisValue(e[n-1].value,i,r.chart)<i.visibleRange.max&&e.push({value:i.visibleRange.max,color:r.interior})},t.prototype.addMulticolorPath=function(e,i,r,n){var s=this.appendPathElement(e,i,r);if((s.previousDirection===null||s.previousDirection==="")&&(s.previousDirection="M "+e.d.split(" ").slice(-3)[0]+" "+e.d.split(" ").slice(-5)[0]+" L "+e.d.split(" ").slice(-3)[0]+" "+e.d.split(" ").slice(-5)[0]+" L "+e.d.split(" ").slice(-3)[0]+" "+e.d.split(" ").slice(-5)[0]),(e.d===null||e.d==="")&&(e.d="M "+s.previousDirection.split(" ").slice(-3)[0]+" "+s.previousDirection.split(" ").slice(-5)[0]+" L "+s.previousDirection.split(" ").slice(-3)[0]+" "+s.previousDirection.split(" ").slice(-5)[0]),n){var a=s.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),l=e.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),h=Math.max(a.length,l.length),c=Math.min(a.length,l.length);if(a.length===l.length&&Ma(fe(e.id),e.d,i.chart.redraw,s.previousDirection,this.chart.duration),a.length<l.length){for(var u=c;u<h;u++)l.length!==a.length&&a.splice(a.length-(i.type.indexOf("Line")!==-1?1:2),0,a[a.length-(i.type.indexOf("Line")!==-1?1:2)]);Ma(fe(e.id),e.d,i.chart.redraw,a.join(" "),this.chart.duration)}if(a.length>l.length){for(var u=c;u<h;u++)l.length!==a.length&&l.splice(1,0,l[1].replace("M","L"));Ma(s.element,l.join(""),i.chart.redraw,a.join(""),this.chart.duration,e.d)}}},t.prototype.createClipRect=function(e,i,r,n,s){var a=r.chart.requireInvertedAxis,l=Wn(s?e:r.xAxis.visibleRange.min,s?r.yAxis.visibleRange.max:i,r.xAxis,r.yAxis,a),h=Wn(s?i:r.xAxis.visibleRange.max,s?r.yAxis.visibleRange.min:e,r.xAxis,r.yAxis,a);h=a?[l,l=h][0]:h;var c;return(r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x>0:h.x-l.x>0)&&(r.yAxis.isInversed?l.y-h.y>0:h.y-l.y>0)?(c=new ys(r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n,"transparent",{width:1,color:"Gray"},1,{x:r.xAxis.isInversed||r.xAxis.isAxisInverse?h.x:l.x,y:r.yAxis.isInversed?h.y:l.y,width:r.xAxis.isInversed||r.xAxis.isAxisInverse?l.x-h.x:h.x-l.x,height:r.yAxis.isInversed?l.y-h.y:h.y-l.y}),r.chart.enableCanvas||r.seriesElement.appendChild(Rc(r.chart.redraw,c,r.chart.renderer)),"url(#"+r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n+")"):null},t.prototype.getAxisValue=function(e,i,r){if(e===null&&(e=i.visibleRange.max),i.valueType==="DateTime"){var n={skeleton:"full",type:"dateTime"};return Date.parse(r.intl.getDateParser(n)(r.intl.getDateFormat(n)(new Date(ge.parse.parseJson({val:e}).val))))}else if(i.valueType.indexOf("Category")>-1){var s=i.valueType==="DateTimeCategory"?e.getTime().toString():e;return i.labels.indexOf(s)<0?+e:i.labels.indexOf(s)}else return+e},t})(bb),Q6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),PO=(function(o){Q6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n,s,a){var l=null,h="",c=e.chart&&e.chart.chartAreaType==="PolarRadar",u=Math.max(e.yAxis.visibleRange.min,0);if(c){var d=this.getFirstLastVisiblePoint(e.points);u=d.first.yValue}for(var p,f=e.emptyPointSettings&&e.emptyPointSettings.mode==="Drop",v=e.border.width?e.border.width:0,m=e.border.color?e.border.color:e.interior,y=e.chart.chartAreaType==="PolarRadar"?fd:Wn,b=this.enableComplexProperty(e),S,C="",x=0;x<b.length;x++)S=b[x],p=S.xValue,S.symbolLocations=[],S.regions=[],S.visible&&Nl(b[x-1],S,b[x+1],e)&&(h+=this.getAreaPathDirection(p,u,e,n,y,l,"M"),l=l||new at(p,u),h+=this.getAreaPathDirection(p,S.yValue,e,n,y,null,"L"),b[x+1]&&!b[x+1].visible&&(!c||c&&this.withinYRange(b[x+1],r))&&!f&&(h+=this.getAreaEmptyDirection({x:p,y:u},l,e,n,y),l=null),this.storePointLocation(S,e,n,y));if(c&&h!==""){var I="",D=this.chart;I+=this.getAreaPathDirection(0,u,e,n,y,null,"L"),(i.isAxisInverse||r.isAxisInverse)&&(h+=e.type==="Polar"?D.polarSeriesModule.getPolarIsInversedPath(i,I):D.radarSeriesModule.getRadarIsInversedPath(i,I)),h=h.concat(h+" Z")}this[s?"addAreaPath":"appendLinePath"](new Rr(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,h!==""?h+this.getAreaPathDirection(e.points[e.points.length-1].xValue,e.chart.chartAreaType==="PolarRadar"?e.points[e.points.length-1].yValue:u,e,n,y,null,"L"):""),e,""),e.border.width!==0&&(C=this.removeEmptyPointsBorder(h),this[s?"addAreaPath":"appendLinePath"](new Rr(e.chart.element.id+"_Series_border_"+e.index,"transparent",v,m,1,e.border.dashArray,C),e,"")),a||this.renderMarker(e)},t.prototype.updateDirection=function(e,i){this.render(e,e.xAxis,e.yAxis,e.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)e.marker&&e.marker.visible&&e.chart.markerRender.renderMarker(e,e.points[i[r]],e.points[i[r]].symbolLocations[0],null,!0),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[i[r]],null,e.marker.dataLabel))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AreaSeries"},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t})(G6),X6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),BO=(function(o){X6(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.sideBySideInfo=[],e}return t.prototype.render=function(e){var i=Math.max(e.yAxis.visibleRange.min,0);this.sideBySideInfo[e.index]=this.getSideBySideInfo(e);for(var r=0,n=e.points;r<n.length;r++){var s=n[r];this.renderPoint(e,s,this.sideBySideInfo[e.index],i)}this.renderMarker(e)},t.prototype.renderPoint=function(e,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&Nl(e.points[i.index-1],i,e.points[i.index+1],e)){this.rect=this.getRectangle(i.xValue+r.start,i.yValue,i.xValue+r.end,n,e),this.rect.height=e.columnWidthInPixel?e.columnWidthInPixel:this.rect.height,this.rect.y=e.columnWidthInPixel?this.rect.y-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):this.rect.y;var s=this.triggerEvent(e,i,e.interior,{width:e.border.width,color:e.border.color});if(!s.cancel&&(this.updateSymbolLocation(i,this.rect,e),this.drawRectangle(e,i,this.rect,s),e.columnFacet==="Cylinder")){var a={isColumn:!1,stacking:!1,isLastSeries:!0};this.drawCylinder(this.options,this.element,a,this.rect,e)}}},t.prototype.updateDirection=function(e,i){for(var r=Math.max(e.yAxis.visibleRange.min,0),n=0;n<i.length;n++)this.renderPoint(e,e.points[i[n]],this.sideBySideInfo[e.index],r),e.marker&&e.marker.visible&&e.chart.markerRender.renderMarker(e,e.points[i[n]],e.points[i[n]].symbolLocations[0],null,!0),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[i[n]],null,e.marker.dataLabel))},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BarSeries"},t})(Sb);var K6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),jO=(function(o){K6(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.sideBySideInfo=[],e}return t.prototype.render=function(e){this.sideBySideInfo[e.index]=this.getSideBySideInfo(e);for(var i=e.stackedValues,r=0,n=e.points;r<n.length;r++){var s=n[r];this.renderPoint(e,s,this.sideBySideInfo[e.index],i)}e.visible&&this.renderMarker(e)},t.prototype.renderPoint=function(e,i,r,n){if(i.symbolLocations=[],i.regions=[],i.visible&&Nl(e.points[i.index-1],i,e.points[i.index+1],e)){var s=void 0,a=void 0;if(!e.visible&&e.isLegendClicked){for(var l=e.index;l>=0;l--)if(e.chart.visibleSeries[l].visible){s=e.chart.visibleSeries[l].index;break}a=e.index>0&&s!==void 0?e.chart.visibleSeries[s].stackedValues.endValues[i.index]:e.stackedValues.startValues[i.index]}this.rect=this.getRectangle(i.xValue+r.start,!e.visible&&e.isLegendClicked?a:n.endValues[i.index],i.xValue+r.end,!e.visible&&e.isLegendClicked?a:n.startValues[i.index],e),e.chart.isTransposed&&e.columnWidthInPixel?(this.rect.width=e.columnWidthInPixel?e.columnWidthInPixel:this.rect.height,this.rect.x-=e.columnWidthInPixel/2):this.rect.height=e.columnWidthInPixel?e.columnWidthInPixel:this.rect.height,this.rect.y=e.columnWidthInPixel?e.chart.isTransposed?this.rect.y:this.rect.y-e.columnWidthInPixel/2:this.rect.y;var h=this.triggerEvent(e,i,e.interior,{width:e.visible?e.border.width:0,color:e.visible?e.border.color:""});if(!h.cancel&&(this.drawRectangle(e,i,this.rect,h),this.updateSymbolLocation(i,this.rect,e),e.columnFacet==="Cylinder")){var c={isColumn:!1,stacking:e.type==="StackingBar100",isLastSeries:!0};this.drawCylinder(this.options,this.element,c,this.rect,e)}}},t.prototype.updateDirection=function(e,i){for(var r=[],n=0;n<e.yAxis.series.length;n++){var s=e.yAxis.series[n];s.stackingGroup===e.stackingGroup&&r.push(s)}for(var a=0;a<r.length;a++)for(var n=0;n<i.length;n++)this.renderPoint(r[a],r[a].points[i[n]],this.sideBySideInfo[e.index],r[a].stackedValues),e.marker&&e.marker.visible&&r[a].chart.markerRender.renderMarker(r[a],r[a].points[i[n]],r[a].points[i[n]].symbolLocations[0],null,!0),r[a].marker.dataLabel.visible&&r[a].chart.dataLabelModule&&(r[a].chart.dataLabelModule.commonId=r[a].chart.element.id+"_Series_"+r[a].index+"_Point_",r[a].chart.dataLabelModule.renderDataLabel(r[a],r[a].points[i[n]],null,r[a].marker.dataLabel))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingBarSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t})(Sb);var $6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),HO=(function(o){$6(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.sideBySideInfo=[],e}return t.prototype.render=function(e){e.isRectSeries=!0,this.sideBySideInfo[e.index]=this.getSideBySideInfo(e);for(var i=e.stackedValues,r=Eh(e),n=0,s=r;n<s.length;n++){var a=s[n];this.renderPoint(e,a,this.sideBySideInfo[e.index],i,r)}e.visible&&this.renderMarker(e)},t.prototype.renderPoint=function(e,i,r,n,s){if(i.symbolLocations=[],i.regions=[],i.visible&&Nl(s[i.index-1],i,s[i.index+1],e)){var a=void 0,l=void 0;if(!e.visible&&e.isLegendClicked){for(var h=e.index;h>=0;h--)if(e.chart.visibleSeries[h].visible){a=e.chart.visibleSeries[h].index;break}l=e.index>0&&a!==void 0?e.chart.visibleSeries[a].stackedValues.endValues[i.index]:e.stackedValues.startValues[i.index]}this.rect=this.getRectangle(i.xValue+r.start,!e.visible&&e.isLegendClicked?l:n.endValues[i.index],i.xValue+r.end,!e.visible&&e.isLegendClicked?l:n.startValues[i.index],e),e.chart.isTransposed&&e.columnWidthInPixel?(this.rect.height=e.columnWidthInPixel?e.columnWidthInPixel:this.rect.width,this.rect.y-=e.columnWidthInPixel/2):this.rect.width=e.columnWidthInPixel?e.columnWidthInPixel:this.rect.width,this.rect.x=e.columnWidthInPixel?e.chart.isTransposed?this.rect.x:this.rect.x-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.position):this.rect.x;var c=this.triggerEvent(e,i,e.interior,{width:e.visible?e.border.width:0,color:e.visible?e.border.color:""});if(!c.cancel&&(this.drawRectangle(e,i,this.rect,c),this.updateSymbolLocation(i,this.rect,e),e.columnFacet==="Cylinder")){var u={isColumn:!0,stacking:e.type==="StackingColumn100",isLastSeries:!0};this.drawCylinder(this.options,this.element,u,this.rect,e)}}},t.prototype.updateDirection=function(e,i){for(var r=[],n=0;n<e.xAxis.series.length;n++){var s=e.xAxis.series[n];s.stackingGroup===e.stackingGroup&&r.push(s)}for(var a=0;a<r.length;a++)for(var l=Eh(r[a]),n=0;n<i.length;n++)this.renderPoint(r[a],r[a].points[i[n]],this.sideBySideInfo[e.index],r[a].stackedValues,l),e.marker&&e.marker.visible&&r[a].chart.markerRender.renderMarker(r[a],r[a].points[i[n]],r[a].points[i[n]].symbolLocations[0],null,!0),r[a].marker.dataLabel.visible&&r[a].chart.dataLabelModule&&(r[a].chart.dataLabelModule.commonId=r[a].chart.element.id+"_Series_"+r[a].index+"_Point_",r[a].chart.dataLabelModule.renderDataLabel(r[a],r[a].points[i[n]],null,r[a].marker.dataLabel))},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingColumnSeries"},t})(Sb);var Z6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),VO=(function(o){Z6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n,s,a){var l=e.chart.chartAreaType==="PolarRadar",h=l?fd:Wn,c="",u=this.enableComplexProperty(e),d=u.length,p=e.stackedValues,f,v,m=l?Math.max(e.yAxis.visibleRange.min,p.endValues[0]):Math.max(e.yAxis.visibleRange.min,p.startValues[0]),y=0,b,S,C="";d>0&&(b=h(u[0].xValue,m,i,r,n,e),c=c.concat("M "+b.x+" "+b.y+" "));for(var x=e.chart&&e.chart.chartAreaType==="PolarRadar",I,D=e.index;D>=0;D--)if(e.chart.visibleSeries[D].visible&&e.chart.visibleSeries[D].type.indexOf("Stacking")>-1){I=e.chart.visibleSeries[D].index;break}for(var D=0;D<d;D++)if(f=u[D].index,u[D].symbolLocations=[],u[D].regions=[],u[D].visible&&Nl(u[D-1],u[D],u[D+1],e)){var M=e.index>0&&I!==void 0?this.chart.visibleSeries[I].stackedValues.endValues[f]:p.startValues[f];b=h(u[D].xValue,!e.visible&&e.isLegendClicked?M:p.endValues[f],i,r,n,e),c=c.concat("L "+b.x+" "+b.y+" "),u[D].symbolLocations.push(h(u[D].xValue,p.endValues[f],i,r,n,e)),u[D].regions.push(new Le(u[D].symbolLocations[0].x-e.marker.width,u[D].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height))}else if(!x&&e.emptyPointSettings.mode!=="Drop"){for(var E=D-1;E>=y;E--)f=u[E].index,S=h(u[E].xValue,p.startValues[f],i,r,n,e),c=c.concat("L "+S.x+" "+S.y+" ");u[D+1]&&u[D+1].visible&&(!x||x&&this.withinYRange(u[D+1],r))&&(v=u[D+1].index,b=h(u[D+1].xValue,p.startValues[v],i,r,n,e),c=c.concat("M "+b.x+" "+b.y+" ")),y=D+1}if(e.chart.chartAreaType==="PolarRadar"&&u.length>1){var A=this.getFirstLastVisiblePoint(e.points),L=this.chart;b={x:A.first.xValue,y:p.endValues[A.first.index]},S=h(b.x,b.y,i,r,n,e),c+="L "+S.x+" "+S.y+" ",this.chart.visible===1&&(i.isAxisInverse||r.isAxisInverse)&&(this.chart.enableAnimation=!1,c=e.type==="Polar"?L.polarSeriesModule.getPolarIsInversedPath(i,c):L.radarSeriesModule.getRadarIsInversedPath(i,c))}if(!x||x&&e.index!==this.getFirstSeriesIndex(e.chart.visibleSeries)){for(var E=d-1;E>=y;E--)if(f=u[E].index,!(x&&!u[E].visible)){var N=this.getPreviousSeries(e);(N.emptyPointSettings.mode!=="Drop"||!N.points[E].isEmpty)&&(S=h(u[E].xValue,!e.visible&&e.isLegendClicked&&e.index>0&&I!==void 0?this.chart.visibleSeries[I].stackedValues.endValues[f]:p.startValues[f],i,r,n,e),p.startValues[f]===p.endValues[f]&&(S.y=Math.floor(S.y)),c=c.concat((E===d-1&&l?"M":"L")+" "+S.x+" "+S.y+" "))}}var R=new Rr(e.chart.element.id+"_Series_"+e.index,e.interior,0,"transparent",e.opacity,e.dashArray,c);if(this[s?"addAreaPath":"appendLinePath"](R,e,""),e.border.width!==0&&e.visible){C=this.removeEmptyPointsBorder(this.getBorderDirection(c));var P=new Rr(e.chart.element.id+"_Series_border_"+e.index,"transparent",e.visible?e.border.width:0,e.border.color?e.border.color:e.interior,1,e.border.dashArray,C);this[s?"addAreaPath":"appendLinePath"](P,e,"")}!a&&e.visible&&this.renderMarker(e)},t.prototype.updateDirection=function(e,i){for(var r=0;r<e.xAxis.series.length;r++){var n=e.xAxis.series[r];this.render(n,n.xAxis,n.yAxis,n.chart.requireInvertedAxis,!1,!0);for(var s=0;s<i.length;s++)n.marker&&n.marker.visible&&n.chart.markerRender.renderMarker(n,n.points[i[s]],n.points[i[s]].symbolLocations[0],null,!0),n.marker.dataLabel.visible&&n.chart.dataLabelModule&&(n.chart.dataLabelModule.commonId=n.chart.element.id+"_Series_"+n.index+"_Point_",n.chart.dataLabelModule.renderDataLabel(n,n.points[i[s]],null,n.marker.dataLabel))}},t.prototype.addAreaPath=function(e,i,r){var n=this.appendPathElement(e,i,r);if(n.previousDirection!==""&&e.d!==""){var s=n.previousDirection.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),a=e.d.match(/[MLHVCSQTAZ][^MLHVCSQTAZ]*/g),l=Math.max(s.length,a.length),h=Math.min(s.length,a.length);if(s.length<a.length){for(var c=s.length;c<a.length;c++)a.length!==s.length&&s.splice((s.length+1)/2,0,s.slice((s.length-1)/2)[0],s.slice((s.length-1)/2)[1]);Ma(n.element,e.d,i.chart.redraw,s.join(" "),this.chart.duration)}else if(s.length>a.length){for(var c=h;c<l;c++)a.length!==s.length&&(a.splice(1,0,a[1]),a.splice(a.length-1,0,a[a.length-1]));Ma(n.element,a.join(""),i.chart.redraw,n.previousDirection,this.chart.duration,e.d)}else Ma(n.element,e.d,i.chart.redraw,n.previousDirection,this.chart.duration)}},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingAreaSeries"},t.prototype.getPreviousSeries=function(e){for(var i=e.chart.visibleSeries,r=0,n=i.length;r<n;r++)if(e.index===i[r].index&&r!==0)return i[r-1];return i[0]},t.prototype.getFirstSeriesIndex=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.visible)return n.index}return 0},t})(bb);var J6=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),_O=(function(o){J6(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n,s,a){for(var l=e.chart.chartAreaType==="PolarRadar",h=l?fd:Wn,c="",u=this.enableComplexProperty(e),d=u.length,p=e.stackedValues,f,v,m,y,b=0;b<d;b++)u[b].regions=[],u[b].symbolLocations=[],f=u[b].index,u[b].visible&&Nl(u[b-1],u[b],u[b+1],e)?(m=h(u[b].xValue,p.endValues[f],i,r,n,e),c=c.concat((b?"L":"M")+" "+m.x+" "+m.y+" "),u[b].symbolLocations.push(h(u[b].xValue,p.endValues[f],i,r,n,e)),u[b].regions.push(new Le(u[b].symbolLocations[0].x-e.marker.width,u[b].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height))):e.emptyPointSettings.mode!=="Drop"&&u[b+1]&&u[b+1].visible&&(v=u[b+1].index,m=h(u[b+1].xValue,p.endValues[v],i,r,n,e),c=c.concat("M "+m.x+" "+m.y+" "));e.chart.chartAreaType==="PolarRadar"&&u.length>1&&(m={y:p.endValues[0],x:e.points[0].xValue},y=h(m.x,m.y,i,r,n,e),c+="L "+y.x+" "+y.y+" ");var S=new Rr(e.chart.element.id+"_Series_"+e.index,"none",e.width,e.interior,e.opacity,e.dashArray,c);this[s?"addPath":"appendLinePath"](S,e,""),a||this.renderMarker(e)},t.prototype.updateDirection=function(e,i){this.render(e,e.xAxis,e.yAxis,e.chart.requireInvertedAxis,!1,!0);for(var r=0;r<i.length;r++)e.marker&&e.marker.visible&&e.chart.markerRender.renderMarker(e,e.points[i[r]],e.points[i[r]].symbolLocations[0],null,!0),e.marker.dataLabel.visible&&e.chart.dataLabelModule&&(e.chart.dataLabelModule.commonId=e.chart.element.id+"_Series_"+e.index+"_Point_",e.chart.dataLabelModule.renderDataLabel(e,e.points[i[r]],null,e.marker.dataLabel))},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingLineSeries"},t})(bb),UO=(function(){function o(){}return o.prototype.render=function(t,e,i,r){t.isRectSeries=!1;for(var n=t.marker,s=this.enableComplexProperty(t),a=t.chart.chartAreaType==="PolarRadar"?fd:Wn,l={width:this.isLineShapeMarker(n.shape)?t.width:t.border.width,color:this.isLineShapeMarker(n.shape)?t.interior:t.border.color},h=0,c=s;h<c.length;h++){var u=c[h];this.renderPoint(t,u,r,a,l,s)}},o.prototype.renderPoint=function(t,e,i,r,n,s){var a=t.chart.redraw,l,h=a&&e.symbolLocations?e.symbolLocations[0]:null;e.symbolLocations=[],e.regions=[],e.visible&&Nl(s[e.index-1],e,s[e.index+1],t)&&(l={cancel:!1,name:Ah,series:t,point:e,fill:t.setPointColor(e,t.interior),border:t.setBorderColor(e,{width:n.width,color:n.color}),height:t.marker.height,width:t.marker.width,shape:t.marker.shape},t.chart.trigger(Ah,l),l.border={width:this.isLineShapeMarker(l.shape)?t.width:t.border.width,color:this.isLineShapeMarker(l.shape)?t.interior:t.border.color},l.cancel?e.marker={visible:!0}:(e.symbolLocations.push(r(e.xValue,e.yValue,t.xAxis,t.yAxis,i,t)),e.color=l.fill,this.refresh(t,e,l,h)))},o.prototype.updateDirection=function(t,e,i){for(var r=t.marker,n=this.enableComplexProperty(t),s=t.chart.chartAreaType==="PolarRadar"?fd:Wn,a={width:this.isLineShapeMarker(r.shape)?t.width:t.border.width,color:this.isLineShapeMarker(r.shape)?t.interior:t.border.color},l=0;l<e.length;l++)this.renderPoint(t,t.points[e[l]],i,s,a,n),t.marker.dataLabel.visible&&t.chart.dataLabelModule&&(t.chart.dataLabelModule.commonId=t.chart.element.id+"_Series_"+t.index+"_Point_",t.chart.dataLabelModule.renderDataLabel(t,t.points[e[l]],null,t.marker.dataLabel))},o.prototype.isLineShapeMarker=function(t){return t.indexOf("Line")>-1||t==="Plus"||t==="Cross"},o.prototype.enableComplexProperty=function(t){for(var e=[],i=[],r=t.yAxis.visibleRange,n=t.xAxis.visibleRange,s=t.clipRect,a=t.points,l=Math.abs(r.delta/s.height),h=Math.abs(n.delta/s.width),c=a[0]&&a[0].y>l?0:l,u=a[0]&&a[0].x>h?0:h,d=0,p=0,f=0,v=a;f<v.length;f++){var m=v[f];m.symbolLocations||(m.symbolLocations=[]),d=m.yValue?m.yValue:r.min,p=m.xValue?m.xValue:n.min,(Math.abs(c-d)>=l||Math.abs(u-p)>=h)&&(i.push(m),c=d,u=p)}for(var y,b=0;b<i.length;b++)y=i[b],!(g(y.x)||y.x==="")&&e.push(y);return e},o.prototype.refresh=function(t,e,i,r){var n=t.chart,s,a,l=t.marker,h=i.point.marker.imageUrl||l.imageUrl,c=new Rr(n.element.id+"_Series_"+t.index+"_Point_"+e.index,i.fill,i.border.width,t.chart.enableCanvas&&!i.border.color?i.fill:i.border.color,t.opacity,t.border.dashArray);if(n.redraw&&fe(c.id)){s=i.shape==="Circle"?"c":"",a=fe(c.id).getAttribute("d");var u=fe(c.id);r={x:+u.getAttribute(s+"x"),y:+u.getAttribute(s+"y")}}var d=Zs(e.symbolLocations[0],i.shape,new Wt(i.width,i.height),h,c,e.x.toString()+":"+e.yValue.toString(),t.chart.renderer,t.clipRect);gt(t.chart.enableCanvas,t.seriesElement,d,n.redraw,!0,s+"x",s+"y",r,a,!1,!1,null,n.duration,!0),e.regions.push(new Le(e.symbolLocations[0].x-l.width,e.symbolLocations[0].y-l.height,2*l.width,2*l.height)),e.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:h}},o.prototype.doAnimation=function(t){for(var e=t.animation.duration,i=t.animation.delay,r=t.seriesElement.childNodes,n=1,s=0,a=t.points;s<a.length;s++){var l=a[s];!l.symbolLocations.length||!r[n]||(Lh(r[n],i,e,t,l.index,l.symbolLocations[0],!1),n++)}},o.prototype.getModuleName=function(){return"ScatterSeries"},o.prototype.destroy=function(){},o})();var WO=(function(){function o(t){this.selectionStyle=[],this.control=t}return o.prototype.seriesStyles=function(){var t,e=document.getElementById(this.styleId),i="{}",r,n,s=this.control.selectionPattern,a=this.control.highlightPattern;if(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""||g(e)||s!=="None"||a!=="None"){document.getElementById(this.styleId)&&document.getElementById(this.styleId).remove(),e=this.control.createElement("div"),e.setAttribute("id",this.styleId);for(var l=0,h=this.control.visibleSeries;l<h.length;l++){var c=h[l],u=this.control.visibleSeries[c.index]||this.control.visibleSeries[c.index];if(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""||(!g(s)||!g(a))&&(s!=="None"||a!=="None")){var d=this.styleId.indexOf("highlight")>0?a:s;if((u.type==="Pie"||u.type==="Funnel"||u.type==="Pyramid"||this.control.getModuleName()==="circularchart3d")&&this.control.highlightColor!=="transparent")for(var p=0;p<u.points.length;p++)n=u.opacity,r=this.pattern(this.control,this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:u.points[p].color,c.points[p].index,d,n),i="{ fill:"+r+"}",t=c.selectionStyle||this.styleId+"_series_"+c.index+"_point_"+c.points[p].index+",."+this.styleId+"_series_"+c.index+"_point_"+c.points[p].index+"> *",this.control.highlightMode==="None"&&this.control.legendSettings.enableHighlight&&!c.isRectSeries&&(e.innerText+="."+this.styleId+"_series_"+c.index+"> * { stroke-width:3;} ",this.selectionStyle.push([this.styleId+"_series_"+c.index,"stroke-width","3"])),i=i.indexOf("None")>-1?"{fill:"+(this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:u.points[p].color)+"!important}":i,this.selectionStyle.push([this.styleId+"_series_"+c.index+"_point_"+c.points[p].index,"fill",r?r.indexOf("None")>-1?this.styleId.indexOf("highlight")>-1?this.control.highlightColor:"":r:""]);else u.type&&this.control.highlightColor!=="transparent"&&(n=u.opacity,r=this.pattern(this.control,this.styleId.indexOf("highlight")>0&&this.control.highlightColor!==""?this.control.highlightColor:u.pointColorMapping!==""||this.control.rangeColorSettings&&this.control.rangeColorSettings.length>1?u.points[0].color:u.interior,c.index,d,n),i="{ fill:"+r+"}")}t=c.selectionStyle||this.styleId+"_series_"+c.index+",."+this.styleId+"_series_"+c.index+"> *",this.control.highlightMode==="None"&&this.control.legendSettings.enableHighlight&&!c.isRectSeries&&this.selectionStyle.push([this.styleId+"_series_"+c.index,"stroke-width",(parseFloat(c.width?c.width.toString():"0")+1).toString()]),i=i.indexOf("None")>-1?"{}":i,this.selectionStyle.push([this.styleId+"_series_"+c.index,"fill",r?r.indexOf("None")>-1?this.styleId.indexOf("highlight")>-1?this.control.highlightColor:"":r:""])}var f=this.control.highlightColor!=="transparent"?this.control.getModuleName()==="circularchart3d"?.2:.3:n;g(this.control.selectionModule)&&this.control.selectionMode==="None"&&this.control.highlightColor!==""&&(f=1),this.selectionStyle.push([this.unselected,"opacity",f.toString()]);var v=document.getElementById(this.control.element.id+"_Secondary_Element");v&&v.appendChild(e)}},o.prototype.pattern=function(t,e,i,r,n){var s="#ffffff",a=t.svgObject,l=[],h={id:t.element.id+"_"+r+"_Selection_"+i,patternUnits:"userSpaceOnUse"},c="height",u="width",d=10,p=12,f=6,v=17,m=1,y=21,b=9,S=18,C=1,x=20;switch(r){case"Dots":h[c]=h[u]=f,h[u]=f,l[0]={x:0,y:0,width:7,height:7,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={cx:3,cy:3,r:2,"stroke-width":1,fill:e,name:"circle"};break;case"Pacman":h[c]="18.384",h[u]="17.917",l[0]={name:"rect",x:0,y:0,width:17.917,height:18.384,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M9.081,9.194l5.806-3.08c-0.812-1.496-2.403-3.052-4.291-3.052H8.835C6.138,3.063,3,6.151,3,8.723v1.679   c0,2.572,3.138,5.661,5.835,5.661h1.761c2.085,0,3.835-1.76,4.535-3.514L9.081,9.194z","stroke-width":1,stroke:e,fill:e};break;case"Chessboard":h[c]=h[u]=d,l[0]={x:0,y:0,width:d,height:d,fill:s,opacity:n,name:"rect"},l[1]={x:0,y:0,width:5,height:5,fill:e,opacity:n,name:"rect"},l[2]={x:5,y:5,width:5,height:5,fill:e,opacity:n,name:"rect"};break;case"Crosshatch":h[c]=h[u]="8",l[0]={x:0,y:0,width:8,height:8,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M0 0L8 8ZM8 0L0 8Z","stroke-width":1,stroke:e,name:"path"};break;case"DiagonalForward":h[c]=h[u]=f,l[0]={x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M 3 -3 L 9 3 M 6 6 L 0 0 M 3 9 L -3 3","stroke-width":2,stroke:e,name:"path"};break;case"DiagonalBackward":h[c]=h[u]=f,l[0]={x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n,name:"rect"},l[1]={d:"M 3 -3 L -3 3 M 0 6 L 6 0 M 9 3 L 3 9","stroke-width":2,stroke:e,name:"path"};break;case"Grid":h[c]=h[u]=f,l[0]={name:"rect",x:0,y:0,width:f,height:f,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M1 3.5L11 3.5 M0 3.5L11 3.5 M0 7.5L11 7.5 M0 11.5L11 11.5 M5.5 0L5.5 12 M11.5 0L11.5 12Z","stroke-width":1,stroke:e};break;case"Turquoise":h[c]=h[u]=v,l[0]={name:"rect",x:0,y:0,width:v,height:v,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0.5739999999999998,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[2]={name:"path",d:"M11.805,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[3]={name:"path",d:"M6.19,2.643a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[4]={name:"path",d:"M11.805,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[5]={name:"path",d:"M6.19,8.217a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[6]={name:"path",d:"M11.805,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e},l[7]={name:"path",d:"M6.19,13.899a2.123,2.111 0 1,0 4.246,0a2.123,2.111 0 1,0 -4.246,0","stroke-width":m,"stroke-miterlimit":d,stroke:e,fill:e};break;case"Star":h[c]=h[u]=y,l[0]={name:"rect",x:0,y:0,width:y,height:y,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M15.913,18.59L10.762 12.842 5.613 18.75 8.291 11.422 0.325 9.91 8.154 8.33 5.337 0.91 10.488 6.658 15.637 0.75 12.959 8.078 20.925 9.59 13.096 11.17 z","stroke-width":1,stroke:e,fill:e};break;case"Triangle":h[c]=h[u]=d,l[0]={name:"rect",x:0,y:0,width:d,height:d,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M4.987,0L7.48 4.847 9.974 9.694 4.987 9.694 0 9.694 2.493 4.847 z","stroke-width":1,stroke:e,fill:e};break;case"Circle":h[c]=h[u]=b,l[0]={name:"rect",x:0,y:0,width:b,height:b,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"circle",cx:5.125,cy:3.875,r:3.625,"stroke-width":1,fill:e};break;case"Tile":h[c]=h[u]=S,l[0]={name:"rect",x:0,y:0,width:S,height:S,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,9L0 0 9 0 z","stroke-width":C,stroke:e,fill:e},l[2]={name:"path",d:"M9,9L9 0 18 0 z","stroke-width":C,stroke:e,fill:e},l[3]={name:"path",d:"M0,18L0 9 9 9 z","stroke-width":C,stroke:e,fill:e},l[4]={name:"path",d:"M9,18L9 9 18 9 z","stroke-width":C,stroke:e,fill:e};break;case"HorizontalDash":h[c]=h[u]=p,l[0]={name:"rect",x:0,y:0,width:p,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,1.5 L10 1.5 M0,5.5 L10 5.5 M0,9.5 L10 9.5 z","stroke-width":1,stroke:e,fill:e};break;case"VerticalDash":h[c]=h[u]=p,l[0]={name:"rect",x:0,y:0,width:p,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M1.5,0 L1.5 10 M5.5,0 L5.5 10 M9.5,0 L9.5 10 z","stroke-width":1,stroke:e,fill:e};break;case"Rectangle":h[c]=h[u]=p,l[0]={name:"rect",width:p,height:p,fill:s,opacity:n},l[1]={name:"rect",x:1,y:2,width:4,height:9,fill:e,opacity:n},l[2]={name:"rect",x:7,y:2,width:4,height:9,fill:e,opacity:n};break;case"Box":h[c]=h[u]=d,l[0]={name:"rect",width:13,height:13,fill:s,opacity:n},l[1]={name:"rect",x:1.5,y:1.5,width:d,height:9,fill:e,opacity:n};break;case"HorizontalStripe":h[c]=p,h[u]=d,l[0]={name:"rect",x:0,y:0,width:d,height:p,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0,0.5 L10 0.5 M0,4.5 L10 4.5 M0,8.5 L10 8.5 z","stroke-width":1,stroke:e,fill:e};break;case"VerticalStripe":h[c]=d,h[u]=p,l[0]={name:"rect",x:0,y:0,width:p,height:d,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"path",d:"M0.5,0 L0.5 10 M4.5,0 L4.5 10 M8.5,0 L8.5 10 z","stroke-width":1,stroke:e,fill:e};break;case"Bubble":h[c]=h[u]=x,l[0]={name:"rect",x:0,y:0,width:x,height:x,transform:"translate(0,0)",fill:s,opacity:n},l[1]={name:"circle",cx:5.217,cy:11.325,r:3.429,"stroke-width":1,fill:"#D0A6D1"},l[2]={name:"circle",cx:13.328,cy:6.24,r:4.884,"stroke-width":1,fill:e},l[3]={name:"circle",cx:13.277,cy:14.66,r:3.018,"stroke-width":1,fill:"#D0A6D1"};break}var I=t.svgRenderer||t.renderer,D=I.createPattern(h,"pattern");return this.loadPattern(t,l,D,I),a.appendChild(D),"url(#"+t.element.id+"_"+r+"_Selection_"+i+")"},o.prototype.loadPattern=function(t,e,i,r){var n;for(n=0;n<e.length;n++){var s=r.createPattern(e[n],e[n].name);i.appendChild(s)}},o.prototype.concatIndexes=function(t,e){return t.concat(e)},o.prototype.checkVisibility=function(t,e){if(e===void 0&&(e=null),!t)return!1;for(var i=!1,r=[],n=0,s=t;n<s.length;n++){var a=s[n];r.indexOf(a.series)===-1&&r.push(a.series)}for(var l=0,h=r;l<h.length;l++){var a=h[l];if(e!=null&&e.rangeColorSettings&&e.rangeColorSettings.length>0&&e.rangeColorSettings[0].colors.length>0){if(this.control.series[0].visible){i=!0;break}}else if(this.control.visibleSeries[a].visible){i=!0;break}}return i},o.prototype.addSvgClass=function(t,e){var i=t.getAttribute("class")||"";i+=i!==""?" ":"";var r=t.id.indexOf("datalabel")>-1||t.id.indexOf("Text")>-1||t.id.indexOf("TextShape")>-1;if(i.indexOf(e)===-1){t.setAttribute("class",i+e);var n=this.selectionStyle;if(e&&e.indexOf("highlight")!==-1&&(this.control.getModuleName()==="chart"&&this.control.highlightModule?n=this.control.highlightModule.selectionStyle:this.control.getModuleName()==="accumulationchart"&&this.control.accumulationHighlightModule?n=this.control.accumulationHighlightModule.selectionStyle:this.control.getModuleName()==="chart3d"&&this.control.highlight3DModule?n=this.control.highlight3DModule.selectionStyle:this.control.getModuleName()==="circularchart3d"&&this.control.circularChartHighlight3DModule&&(n=this.control.circularChartHighlight3DModule.selectionStyle)),t.tagName.toLowerCase()==="g")t.querySelectorAll("*").forEach(function(c){for(var u=0;u<n.length;u++){var d=n[u],p=d[0],f=c.getAttribute("class")?c.getAttribute("class"):"";(p===e||p.indexOf(e)!==-1)&&f.indexOf("selection")===-1&&(d[1]==="fill"&&d[2]&&!r&&(c.style.fill=d[2]),d[1]==="opacity"&&d[2]&&(c.style.opacity=d[2],c.style.fill=""),d[1]==="stroke-width"&&d[2]&&(c.style.strokeWidth=d[2]))}});else for(var s=0;s<n.length;s++){var a=n[s],l=a[0],h=t.getAttribute("class")?t.getAttribute("class"):"";(l===e||l.indexOf(e)!==-1)&&(e.indexOf("highlight")===-1||h.indexOf("selection")===-1)&&(a[1]==="fill"&&a[2]&&!r&&(t.style.fill=a[2]),a[1]==="opacity"&&a[2]&&(t.style.opacity=a[2],t.style.fill=""),a[1]==="stroke-width"&&a[2]&&t.id.indexOf("legend_shape")===-1&&(t.style.strokeWidth=a[2]))}}},o.prototype.removeSvgClass=function(t,e){var i=t.getAttribute("class")||"";if(i.indexOf(e)>-1){t.setAttribute("class",i.replace(e,"").trim());var r=this.selectionStyle;if(e&&e.indexOf("highlight")!==-1&&(this.control.getModuleName()==="chart"&&this.control.highlightModule?r=this.control.highlightModule.selectionStyle:this.control.getModuleName()==="accumulationchart"&&this.control.accumulationHighlightModule?r=this.control.accumulationHighlightModule.selectionStyle:this.control.getModuleName()==="chart3d"&&this.control.highlight3DModule?r=this.control.highlight3DModule.selectionStyle:this.control.getModuleName()==="circularchart3d"&&this.control.circularChartHighlight3DModule&&(r=this.control.circularChartHighlight3DModule.selectionStyle)),t.tagName.toLowerCase()==="g")t.querySelectorAll("*").forEach(function(h){for(var c=0;c<r.length;c++){var u=r[c],d=u[0],p=h.getAttribute("class")?h.getAttribute("class"):"";(d===e||d.indexOf(e)!==-1)&&p.indexOf("selection")===-1&&(u[1]==="fill"&&u[2]&&(h.style.fill=""),u[1]==="opacity"&&u[2]&&(h.style.opacity=""),u[1]==="stroke-width"&&u[2]&&(h.style.strokeWidth=""))}});else for(var n=0;n<r.length;n++){var s=r[n],a=s[0],l=t.getAttribute("class")?t.getAttribute("class"):"";(a===e||a.indexOf(e)!==-1)&&(e.indexOf("highlight")===-1||l.indexOf("selection")===-1)&&(s[1]==="fill"&&s[2]&&(t.style.fill=""),s[1]==="opacity"&&s[2]&&(t.style.opacity=""),s[1]==="stroke-width"&&s[2]&&(t.style.strokeWidth=""))}}},o.prototype.getChildren=function(t){for(var e=[],i=0;i<t.childNodes.length;i++)t.childNodes[i].tagName!=="defs"&&e.push(t.childNodes[i]);return e},o})(),eY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),tY=(function(o){eY(t,o);function t(e){var i=o.call(this,e)||this;i.isdrawRect=!0,i.multiDataIndexes=[],i.pathIndex=0,i.seriesIndex=0,i.count=-1,i.dragRectArray=[],i.filterArray=[],i.totalSelectedPoints=[],i.chart=e,i.renderer=e.renderer;var r=e.selectionMode;return i.isMultiDrag=e.isMultiSelect&&r.indexOf("Drag")>-1,i.addEventListener(),i}return t.prototype.addEventListener=function(){if(!(this.chart.isDestroyed||this.chart.stockChart&&this.chart.stockChart.onPanning)){var e=j.isPointer?"pointerleave":"mouseleave";this.chart.on(j.touchMoveEvent,this.mouseMove,this),this.chart.on(e,this.mouseLeave,this),this.chart.on("click",this.mouseClick,this),this.chart.on(j.touchStartEvent,this.mousedown,this),this.chart.on(j.touchEndEvent,this.mouseLeave,this)}},t.prototype.mousedown=function(e){var i=this.chart;i.isPointMouseDown||i.selectionMode==="None"||i.isChartDrag||(i.isDoubleTap||!i.isTouch||this.rectPoints)&&this.dragStart(i,i.chartAxisLayoutPanel.seriesClipRect,i.mouseDownX,i.mouseDownY,e)},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(j.touchMoveEvent,this.mouseMove),this.chart.off("pointerleave",this.mouseLeave),this.chart.off("click",this.mouseClick),this.chart.off(j.touchStartEvent,this.mousedown),this.chart.off(j.touchEndEvent,this.mouseLeave))},t.prototype.initPrivateVariables=function(e){this.styleId=e.element.id+"_ej2_chart_selection",this.unselected=e.element.id+"_ej2_deselected",this.closeIconId=e.element.id+"_ej2_drag_close",this.draggedRectGroup=e.element.id+"_ej2_drag_group",this.multiRectGroup=e.element.id+"_ej2_drag_multi_group",this.draggedRect=e.element.id+"_ej2_drag_rect",this.lassoPath=e.element.id+"_ej2_drag_path",this.selectedDataIndexes=[],this.rectPoints=null,this.isSeriesMode=e.selectionMode==="Series"},t.prototype.invokeSelection=function(e){this.initPrivateVariables(e),this.series=pe({},e.visibleSeries,null,!0),this.seriesStyles(),this.currentMode=e.selectionMode,e.selectionMode.indexOf("Drag")>-1||this.selectDataIndex(e,this.concatIndexes(e.selectedDataIndexes,this.selectedDataIndexes))},t.prototype.generateStyle=function(e){return e?(this.styleId.indexOf("selection")>1&&this.chart.selectionMode!=="None"&&(this.unselected=e.unSelectedStyle||this.unselected),this.styleId.indexOf("highlight")>0&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(this.unselected=e.nonHighlightStyle||this.unselected),e.selectionStyle||this.styleId+"_series_"+e.index):"undefined"},t.prototype.selectDataIndex=function(e,i){for(var r=0,n=i;r<n.length;r++){var s=n[r];this.performSelection(s,e,this.getElementByIndex(e,s,"",this.series[s.series].marker.visible)[0])}},t.prototype.getElementByIndex=function(e,i,r,n,s){r===void 0&&(r="");var a=e.element.id+"_Series_"+i.series+"_Point_"+i.point,l=e.series[i.series];return a=l.type!=="Scatter"&&l.type!=="Bubble"&&n?a+"_Symbol"+r:a,!n&&s?[fe(a+"_Text_0"+r),fe(a+"_TextShape_0"+r)]:[fe(a),(l.type==="RangeArea"||l.type==="SplineRangeArea"||l.type==="RangeStepArea")&&l.marker.visible?fe(a+"1"):null]},t.prototype.getClusterElements=function(e,i){for(var r=[],n,s,a=0,l=e.visibleSeries;a<l.length;a++){var h=l[a];if(h.visible){i=new Tc(h.index,i.point),h.isRectSeries&&r.push(this.getElementByIndex(e,i)[0]),r.push(this.getElementByIndex(e,i,"",h.marker.visible)[0]);var c=document.getElementById(e.element.id+"_Series_"+h.index+"_Point_"+i.point+"_Text_0"),u=document.getElementById(e.element.id+"_Series_"+h.index+"_Point_"+i.point+"_TextShape_0");c&&r.push(c),u&&r.push(u),n=this.generateStyle(e.visibleSeries[i.series]),s=document.querySelectorAll("."+n),this.findTrackballElements(s,n);var d=h.marker.visible&&h.isRectSeries?2:1;d+=c&&u?2:c||u?1:0,!e.isMultiSelect&&s.length>0&&s[0].id!==(r[r.length-d]?r[r.length-d].id:"")&&this.removeSelection(e,i.series,s,n,!0)}}return r},t.prototype.findTrackballElements=function(e,i){for(var r,n,s=0;s<e.length;s++)if(!g(e[s])&&(r=g(e[s].parentNode)?[]:[].slice.call(e[0].parentNode.querySelectorAll("."+i)),r.length>0)){n=[];for(var a=0;a<r.length;a++)r[a].id.indexOf("Trackball")>-1&&n.push(r[a]);this.removeStyles(n)}},t.prototype.findElements=function(e,i,r,n,s,a){return n===void 0&&(n=""),this.isSeriesMode?this.getSeriesElements(i):this.currentMode==="Cluster"?this.getClusterElements(e,r):this.getElementByIndex(e,r,n,s,a)},t.prototype.isAlreadySelected=function(e,i){if(i==="click"?(this.currentMode=this.chart.selectionMode,this.styleId=this.chart.element.id+(this.chart.selectionModule&&this.chart.selectionMode!=="None"?"_ej2_chart_selection":"_ej2_chart_highlight")):(i==="mousemove"||i==="pointermove")&&(this.currentMode=this.chart.highlightMode,this.highlightDataIndexes=[],this.styleId=this.chart.element.id+"_ej2_chart_highlight"),this.chart.highlightMode!=="None"&&this.chart.selectionMode==="None"&&i==="click")return!1;if((this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&this.previousSelectedEle&&this.previousSelectedEle[0]){var r=e.parentNode?e.parentNode.id:"",n=void 0;e.parentNode&&(n=r.indexOf("SeriesGroup")>0||r.indexOf("SymbolGroup")>0);for(var s=0;s<this.previousSelectedEle.length;s++)if(this.previousSelectedEle[s]&&this.previousSelectedEle[s].hasAttribute("class"))if(this.previousSelectedEle[s].getAttribute("class").indexOf("highlight")>-1&&(n||i==="click")){if(this.previousSelectedEle[s].removeAttribute("class"),this.previousSelectedEle[s].id.indexOf("Group")>0)for(var a=0;a<this.previousSelectedEle[s].children.length;a++)this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.previousSelectedEle[s].children[a].setAttribute("fill",this.previousSelectedEle[s].children[a].id.indexOf("Text")>-1||this.previousSelectedEle[s].children[a].id.indexOf("TextShape")>-1?this.previousSelectedEle[s].children[a].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[s].id).series].interior),this.previousSelectedEle[s].children[a].removeAttribute("style");else this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.previousSelectedEle[s].setAttribute("fill",this.previousSelectedEle[s].id.indexOf("Text")>-1||this.previousSelectedEle[s].id.indexOf("TextShape")>-1?this.previousSelectedEle[s].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(this.previousSelectedEle[s].id).series].interior),this.previousSelectedEle[s].removeAttribute("style");this.addOrRemoveIndex(this.highlightDataIndexes,this.indexFinder(this.previousSelectedEle[s].id))}else!n&&this.previousSelectedEle[s].getAttribute("class").indexOf("highlight")>-1&&this.performSelection(this.indexFinder(this.previousSelectedEle[s].id),this.chart,this.previousSelectedEle[s])}return!0},t.prototype.mouseClick=function(e){this.calculateSelectedElements(e.target,e.type,!0),this.chart.highlightModule&&this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&e.target.id.indexOf("_chart_legend_")===-1&&this.chart.isTouch&&j.isDevice&&this.removeLegendHighlightStyles()},t.prototype.calculateSelectedElements=function(e,i,r){if(!g(e)&&!(this.chart.selectionMode==="None"&&this.chart.highlightMode==="None"||e.id&&e.id.indexOf(this.chart.element.id+"_")===-1)&&!((i==="mousemove"||i==="pointermove")&&(e.hasAttribute("class")&&(e.getAttribute("class").indexOf("highlight")>-1||e.getAttribute("class").indexOf("selection")>-1)||!g(e.parentNode)&&e.parentNode.hasAttribute("class")&&(e.parentNode.getAttribute("class").indexOf("highlight")>0||e.parentNode.getAttribute("class").indexOf("selection")>0)))&&(this.isAlreadySelected(e,i),e.id&&e.id.indexOf("_Series_")>-1&&e.id.indexOf("_Text_")===-1)){var n=void 0;if(e.id.indexOf("_Trackball_1")>-1)n=fe(e.id.split("_Trackball_")[0]+"_Symbol"),n=g(n)?fe(e.id.split("_Trackball_")[0]):n;else if(e.id.indexOf("_Trackball_0")>-1)return null;this.performSelection(this.indexFinder(e.id),this.chart,n||e,r)}},t.prototype.performSelection=function(e,i,r,n){if(this.isSeriesMode=this.currentMode==="Series",i.visibleSeries[e.series].type==="BoxAndWhisker"&&r&&r.id===i.element.id+"_Series_"+e.series+"_Point_"+e.point+"_BoxPath"&&(r=r.parentNode),i.visibleSeries[e.series].type==="Area"&&(this.currentMode==="Point"||this.currentMode==="Cluster")&&r&&r.id===this.chart.element.id+"_Series_"+e.series){var s=this.generateStyle(i.series[e.series]),a=document.querySelectorAll("."+s);this.findTrackballElements(a,s),this.blurEffect(i.element.id,i.visibleSeries,!1,e.point)}switch(this.currentMode){case"Series":this.selection(i,e,this.getSeriesElements(i.series[e.series])),this.selectionComplete(i,e,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,e.point);break;case"Point":if(!isNaN(e.point)&&r||!n&&isNaN(e.point)){var l=[];l.push(r);var h=this.chart.visibleSeries[e.series],c=i.element.id+"_Series_"+e.series+"_Point_"+e.point,u=document.getElementById(c+"_Text_0");h.marker.dataLabel.visible&&u!==null&&(l.push(u),l.push(document.getElementById(c+"_TextShape_0"))),l[0]!==null&&i.series[e.series].marker.visible&&(i.series[e.series].type.indexOf("Column")!==-1||i.series[e.series].type.indexOf("Bar")!==-1)&&(r.id.indexOf("_Symbol")===-1&&fe(r.id+"_Symbol")?l.push(fe(r.id+"_Symbol")):r.id.indexOf("_Symbol")!==-1&&fe(r.id.replace("_Symbol",""))&&l.push(fe(r.id.replace("_Symbol","")))),this.selection(i,e,!n&&isNaN(e.point)?this.getSeriesElements(i.series[e.series]):l),this.selectionComplete(i,e,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,e.point)}break;case"Cluster":(!isNaN(e.point)||!n&&isNaN(e.point))&&(!n&&isNaN(e.point)?this.selection(i,e,this.getSeriesElements(i.series[e.series])):this.clusterSelection(i,e),this.selectionComplete(i,e,this.currentMode),this.blurEffect(i.element.id,i.visibleSeries,!1,e.point));break}},t.prototype.selectionComplete=function(e,i,r){var n,s,a,l=[],h,c;if(r==="Cluster")for(var u=0,d=e.visibleSeries;u<d.length;u++){var p=d[u];if(p.visible)for(var f=0;f<this.selectedDataIndexes.length;f++)s=e.isMultiSelect?this.selectedDataIndexes[f].point:i.point,a=p.index,n=p.points,!isNaN(s)&&s<n.length&&(h=p.type!=="RangeArea"||p.type.indexOf("SplineRangeArea")>-1||p.type.indexOf("RangeStepArea")>-1?n[s].yValue:n[s].regions[0].y,c=n[s].xValue,e.primaryXAxis.valueType==="Category"?c=n[s].x.toLocaleString():e.primaryXAxis.valueType==="DateTime"&&(c=new Date(n[s].xValue)),p.category!=="Indicator"&&l.push({x:c,y:h,seriesIndex:a,pointIndex:s}),(p.type==="RangeArea"||p.type==="SplineRangeArea"||p.type==="RangeStepArea")&&l.push({x:c,y:n[s].regions[0].y,seriesIndex:a,pointIndex:s}))}else if(r==="Series")if(e.isMultiSelect)for(var f=0;f<this.selectedDataIndexes.length;f++)a=this.selectedDataIndexes[f].series,this.selectedDataIndexes.length>0&&l.push({seriesIndex:a});else a=this.selectedDataIndexes.length>0?this.selectedDataIndexes[0].series:this.highlightDataIndexes&&this.highlightDataIndexes.length>0?this.highlightDataIndexes[0].series:0,(this.selectedDataIndexes.length>0||this.highlightDataIndexes&&this.highlightDataIndexes.length>0)&&l.push({seriesIndex:a});else if(r==="Point"){var v=[];this.styleId.indexOf("highlight")>-1?v=this.highlightDataIndexes:v=this.selectedDataIndexes;for(var f=0;f<v.length;f++){s=v[f].point,a=v[f].series;var p=e.series[a];n=p.points,isNaN(s)||(c=n[s].xValue,h=p.type!=="RangeArea"||p.type.indexOf("SplineRangeArea")>-1||p.type.indexOf("RangeStepArea")>-1?n[s].yValue:n[s].regions[0].y,e.primaryXAxis.valueType==="Category"?c=n[s].x.toLocaleString():e.primaryXAxis.valueType==="DateTime"&&(c=new Date(n[s].xValue)),l.push({x:c,y:h,seriesIndex:a,pointIndex:s}))}}var m={name:PR,selectedDataValues:l,cancel:!1,chart:e};e.trigger(PR,m)},t.prototype.selection=function(e,i,r){this.currentMode!=="Lasso"&&!e.isMultiSelect&&this.currentMode.indexOf("Drag")===-1&&this.styleId.indexOf("highlight")===-1&&e.selectionMode!=="None"&&this.removeMultiSelectElements(e,this.selectedDataIndexes,i,e.series);var n=this.rangeColorMappingEnabled()?0:i.series;if(!g(r[0])){e.visibleSeries[n].isRectSeries&&r[0].id&&(document.getElementById(r[0].id+"_Symbol")?r.push(fe(r[0].id+"_Symbol")):r[0].id.indexOf("SeriesGroup")!==-1&&document.getElementById(r[0].id.replace("SeriesGroup","SymbolGroup"))&&r.push(fe(r[0].id.replace("SeriesGroup","SymbolGroup"))));var s=void 0,a=r[0]&&(r[0].getAttribute("class")||"");a=a.replace("e-chart-focused","").trim();var l=r[0].parentNode&&(r[0].parentNode.getAttribute("class")||"");a!==""&&this.currentMode!=="Cluster"&&this.findTrackballElements(r,a),r[0]&&a.indexOf(this.getSelectionClass(r[0].id))>-1?this.removeStyles(r):r[0].parentNode&&l.indexOf(this.getSelectionClass(r[0].id))>-1?this.removeStyles([r[0].parentNode]):(this.previousSelectedEle=e.highlightMode!=="None"||e.legendSettings.enableHighlight?r:[],this.applyStyles(r),s=!0),this.styleId.indexOf("highlight")>0&&(e.highlightMode!=="None"||e.legendSettings.enableHighlight)?this.addOrRemoveIndex(this.highlightDataIndexes,i,s):this.addOrRemoveIndex(this.selectedDataIndexes,i,s)}},t.prototype.clusterSelection=function(e,i){this.selection(e,i,this.getClusterElements(e,new Tc(i.series,i.point)))},t.prototype.removeMultiSelectElements=function(e,i,r,n){for(var s,a=0;a<i.length;a++)s=n[i[a].series],(this.isSeriesMode&&!this.toEquals(i[a],r,this.isSeriesMode)||this.currentMode==="Cluster"&&!this.toEquals(i[a],r,!1)||!this.isSeriesMode&&this.toEquals(i[a],r,!0)&&!this.toEquals(i[a],r,!1))&&(this.removeStyles(this.findElements(e,s,i[a],"",!1)),s.marker.visible&&this.removeStyles(this.findElements(e,s,i[a],"",!0)),s.marker.dataLabel.visible&&this.removeStyles(this.findElements(e,s,i[a],"",!1,!0)),i.splice(a,1),a--)},t.prototype.blurEffect=function(e,i,r,n){r===void 0&&(r=!1),n===void 0&&(n=0);for(var s=this.checkVisibility(this.highlightDataIndexes,this.chart)||this.checkVisibility(this.selectedDataIndexes,this.chart),a=0,l=i;a<l.length;a++){var h=l[a],c=void 0,u=void 0;this.rangeColorMappingEnabled()?r===!1?(c=Object.keys(h.rangeColorPoints).indexOf(h.points[n].interior),u=h.points[n].interior):(c=n,u=document.getElementById(e+"_chart_legend_shape_"+n).getAttribute("fill")):(c=h.index,u=this.chart.visibleSeries[h.index].interior),h.visible&&(this.checkSelectionElements(fe(e+"SeriesGroup"+h.index),this.generateStyle(h),s,r,c,u),h.marker.dataLabel.visible&&!g(h.shapeElement)&&(this.checkSelectionElements(h.shapeElement,this.generateStyle(h),s,r,c,u),this.checkSelectionElements(h.textElement,this.generateStyle(h),s,r,c,u)),g(fe(e+"SymbolGroup"+h.index))||this.checkSelectionElements(fe(e+"SymbolGroup"+h.index),this.generateStyle(h),s,r,c,u))}},t.prototype.checkSelectionElements=function(e,i,r,n,s,a){if(n===void 0&&(n=!0),s===void 0&&(s=0),a===void 0&&(a="#D3D3D3"),e){var l=this.isSeriesMode?e.childNodes||[e]:e.childNodes||e;this.chart.selectionMode!=="None"&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(l=e.childNodes||e),this.chart.selectionMode==="Cluster"&&e.tagName.toLowerCase()==="text"&&e.id.indexOf("_Text_")>=0&&(l=[e]);for(var h=void 0,c=void 0,u=void 0,d=e,p=this.chart.visibleSeries[this.rangeColorMappingEnabled()?0:s].marker.dataLabel.visible&&(e.id.indexOf("Text")>-1||e.id.indexOf("TextShape")>-1)&&e.tagName!=="g",f=0;f<l.length&&!p;f++)h=l[f].getAttribute("class")||"",c=l[f].parentNode.getAttribute("class")||"",this.chart.selectionMode!=="None"&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)&&(i=h.indexOf("selection")>0||h.indexOf("highlight")>0?h:i,i=c.indexOf("selection")>0||c.indexOf("highlight")>0?c:i),h.indexOf(i)===-1&&c.indexOf(i)===-1&&r?this.addSvgClass(l[f],this.unselected):(d=l[f],this.removeSvgClass(l[f],this.unselected),this.removeSvgClass(l[f].parentNode,this.unselected),l[f].id!==""&&h.indexOf(this.unselected)!==-1&&c.indexOf(i)===-1&&this.highlightAnimation(l[f],this.chart.series.length===1?0:this.indexFinder(l[f].id).series,700,.3)),l[f].id.indexOf("Trackball")>0&&d.classList[0]===i&&(this.removeSvgClass(l[f],this.unselected),this.removeSvgClass(l[f].parentNode,this.unselected),this.addSvgClass(l[f],i));if(e.id.indexOf("Symbol")>-1&&e.querySelectorAll("."+i)[0]&&e.querySelectorAll("."+i)[0].getAttribute("class")===i){var v=fe(this.control.element.id+"_Series_"+e.id[e.id.length-1]),m=v&&v.hasAttribute("class")?v.getAttribute("class"):"";m.indexOf(this.unselected)>-1&&this.removeSvgClass(v,this.unselected)}if(this.control.legendModule&&this.control.legendSettings.visible&&this.control.legendSettings.visible&&!(n&&this.rangeColorMappingEnabled&&(e===this.control.visibleSeries[0].textElement||e===this.control.visibleSeries[0].shapeElement))&&(u=fe(this.control.element.id+"_chart_legend_shape_"+s),u)){u.hasAttribute("class")&&(this.removeSvgClass(u,u.getAttribute("class")),!g(this.chart.highlightColor&&this.chart.highlightColor!=="")&&!this.chart.legendSettings.enableHighlight&&(u.setAttribute("stroke",a),this.chart.highlightPattern==="None"&&u.setAttribute("fill",a))),h=d.getAttribute("class")||"",c=d.parentNode.getAttribute("class")||"",h.indexOf(i)===-1&&c.indexOf(i)===-1&&r?(this.addSvgClass(u,this.chart.highlightMode==="None"&&this.chart.legendSettings.enableHighlight&&(!this.chart.selectionModule||this.chart.selectionModule.selectedDataIndexes.length===0)?i:this.unselected),this.removeSvgClass(u,i),this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&(u.setAttribute("stroke",this.control.visibleSeries[s].interior),this.chart.highlightPattern==="None"&&u.setAttribute("fill",this.control.visibleSeries[s].interior))):(this.removeSvgClass(u,this.unselected),!g(this.chart.highlightColor)&&this.chart.highlightColor!==""&&(u.setAttribute("stroke",this.control.visibleSeries[s].interior),this.chart.highlightPattern==="None"&&u.setAttribute("fill",this.control.visibleSeries[s].interior)),h===""&&c===""||h.trim()==="EJ2-Trackball"?this.removeSvgClass(u,i):(this.addSvgClass(u,i),i.indexOf("highlight")>0&&this.chart.highlightColor!==""&&this.chart.highlightColor!=="transparent"&&!g(this.chart.highlightColor)&&(u.setAttribute("stroke",this.chart.highlightColor),this.styleId.indexOf("highlight")>0&&this.chart.highlightPattern==="None"&&u.setAttribute("fill",this.chart.highlightColor))));var y=void 0;if(this.rangeColorMappingEnabled())for(var f=0;f<this.chart.rangeColorSettings.length;f++)y=document.getElementById(this.chart.element.id+"_chart_legend_shape_"+f),u!==y?(this.addSvgClass(y,this.unselected),this.removeSvgClass(y,i)):n===!0&&this.addSvgClass(y,i),h.indexOf(i)===-1&&n===!1&&this.removeSvgClass(y,this.unselected);n&&c.indexOf(i)>-1&&this.addSvgClass(u,i)}}},t.prototype.applyStyles=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n){if(this.removeSvgClass(n.parentNode,this.unselected),this.removeSvgClass(n,this.unselected),this.chart.series[0].pointColorMapping==="fill"||this.rangeColorMappingEnabled()){var s=this.getSelectionClass(n.id),a=s.indexOf("highlight")>-1?parseInt(s.split(this.chart.element.id+"_ej2_chart_highlight_series_")[1],10):parseInt(s.split(this.chart.element.id+"_ej2_chart_selection_series_")[1],10),l=this.styleId.indexOf("highlight")>0?this.chart.highlightPattern:this.chart.selectionPattern,h=void 0;if((s.indexOf("highlight")>-1||s.indexOf("selection")>-1)&&(h=document.getElementById(this.chart.element.id+"_"+l+"_Selection_"+a)),n.id.indexOf("legend")===-1&&n.id.indexOf("Text")===-1&&n.id.indexOf("TextShape")===-1&&n.id.indexOf("Group")===-1&&h!=null)for(var c=1;c<h.children.length;c++)h.children[c].setAttribute("fill",n.getAttribute("fill")),h.children[c].setAttribute("stroke",n.getAttribute("fill"))}if(this.addSvgClass(n,this.getSelectionClass(n.id)),n.id.indexOf("Group")>0)for(var u=this.indexFinder(n.id),c=0;c<n.children.length;c++)n.children[c].nodeName!=="defs"&&this.stopElementAnimation(n.children[c],u.series);if(this.styleId.indexOf("highlight")>0&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightPattern==="None"&&this.chart.highlightColor!=="transparent")if(n.id.indexOf("Group")>0)for(var c=0;c<n.children.length;c++)n.children[c].setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.children[c].getAttribute("fill"):this.chart.highlightColor);else n.setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.getAttribute("fill"):this.chart.highlightColor)}}},t.prototype.getSelectionClass=function(e){return this.generateStyle(this.control.visibleSeries[this.indexFinder(e).series])},t.prototype.removeStyles=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n&&(this.removeSvgClass(n,this.getSelectionClass(n.id)),this.chart.highlightPattern==="None"&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor)&&this.chart.highlightColor!=="transparent"))if(n.id.indexOf("Group")>0)for(var s=0;s<n.children.length;s++)n.children[s].setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.children[s].getAttribute("fill"):this.control.visibleSeries[this.indexFinder(n.id).series].interior);else n.setAttribute("fill",n.id.indexOf("Text")>-1||n.id.indexOf("TextShape")>-1?n.getAttribute("fill"):this.control.visibleSeries[this.indexFinder(n.id).series].interior)}},t.prototype.addOrRemoveIndex=function(e,i,r){for(var n=0;n<e.length;n++)this.toEquals(e[n],i,this.isSeriesMode)&&(e.splice(n,1),n--);r&&e.push(i)},t.prototype.toEquals=function(e,i,r){return(e.series===i.series||this.currentMode==="Cluster"&&!r)&&(r||e.point===i.point)},t.prototype.redrawSelection=function(e,i,r){this.isSeriesMode=i==="Series",g(i)||(i.indexOf("Drag")!==-1||i==="Lasso"||r?e.isRedrawSelection=!1:e.isRedrawSelection=!0);var n=pe([],this.selectedDataIndexes,null,!0),s=pe([],this.highlightDataIndexes,null,!0);this.styleId.indexOf("highlight")>0&&s.length>0?(this.removeSelectedElements(e,this.highlightDataIndexes,e.series),n=s):this.removeSelectedElements(e,this.selectedDataIndexes,e.series),this.blurEffect(e.element.id,e.visibleSeries,!1),this.selectDataIndex(e,n)},t.prototype.legendSelection=function(e,i,r,n){if(n==="mousemove"){if(r.id.indexOf("text")>1&&(r=fe(r.id.replace("text","shape"))),r.id.indexOf("marker")>1&&(r=fe(r.id.replace("_marker",""))),r.id.indexOf("g")>1&&(r=fe(r.id.replace("_g_","_shape_"))),r.hasAttribute("class")&&(r.getAttribute("class").indexOf("highlight")>-1||r.getAttribute("class").indexOf("selection")>-1))return;this.currentMode=this.chart.highlightMode}var s=this.isAlreadySelected(r,n);if(s){var a=this.generateStyle(e.visibleSeries[i]),l=document.querySelectorAll("."+a);this.isSeriesMode=this.currentMode==="Series";var h=!0;if(l.length>0)this.removeSelection(e,i,l,a,h);else{for(var c=0,u=e.visibleSeries;c<u.length;c++){var d=u[c];d.index!==i&&!e.isMultiSelect&&(a=this.generateStyle(e.visibleSeries[d.index]),l=document.querySelectorAll("."+a),this.removeSelection(e,i,l,a,h))}var p=[];if(this.rangeColorMappingEnabled()){for(var f=0,v=e.visibleSeries[0].seriesElement.children;f<v.length;f++){var m=v[f];if(r.getAttribute("fill")===m.getAttribute("fill")){if(e.visibleSeries[0].marker.dataLabel.visible){var y=this.indexFinder(m.id).point;if(!isNaN(y)&&y>=0){var b=document.getElementById(this.chart.element.id+"_Series_0_Point_"+y+"_Text_0"),S=document.getElementById(this.chart.element.id+"_Series_0_Point_"+y+"_TextShape_0");b&&p.push(b),S&&p.push(S)}}p.push(m)}}for(var C=0,x=p;C<x.length;C++){var d=x[C];if(g(d))return;this.checkSelectionElements(d,a,!1,!0,i)}}else if(e.visibleSeries[i].visible){p=this.getSeriesElements(e.visibleSeries[i]);for(var I=0,D=p;I<D.length;I++){var M=D[I];if(g(M))return;this.checkSelectionElements(M,a,!1,!0,i)}}this.isSeriesMode=!0,this.selection(e,new Tc(i,NaN),p),this.isSeriesMode=e.selectionMode==="Series",this.blurEffect(e.element.id,e.visibleSeries,!0,i)}}},t.prototype.rangeColorMappingEnabled=function(){return!!(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&this.chart.rangeColorSettings[0].colors.length>0&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble"))},t.prototype.removeSelection=function(e,i,r,n,s){if(r.length>0){for(var a=[],l=0;l<r.length;l++)a.push(r[l]);this.removeStyles(a),this.isSeriesMode=!0,this.addOrRemoveIndex(this.selectedDataIndexes,new Tc(i,NaN));for(var h=0,c=e.visibleSeries;h<c.length;h++){var u=c[h];if(n=this.generateStyle(u),document.querySelectorAll("."+n).length>0){for(var d=0,p=a;d<p.length;d++){var f=p[d];this.checkSelectionElements(f,n,!0,!0,i)}s=!1;break}}s&&(this.isSeriesMode=e.selectionMode==="Series",this.blurEffect(e.element.id,e.visibleSeries))}},t.prototype.getSeriesElements=function(e){var i=[e.seriesElement];return(e.marker.visible&&e.type!=="Scatter"&&e.type!=="Bubble"&&!e.isRectSeries||e.marker.visible&&e.isRectSeries)&&i.push(e.symbolElement),e.marker.dataLabel.visible&&(i.push(e.textElement),i.push(e.shapeElement)),i},t.prototype.indexFinder=function(e){var i=["NaN","NaN"];return e.indexOf("SeriesGroup")>-1?(i=e.split("SeriesGroup"),i[0]=i[1]):e.indexOf("SymbolGroup")>-1?(i=e.split("SymbolGroup"),i[0]=i[1]):e.indexOf("_Point_")>-1?i=e.split("_Series_")[1].split("_Point_"):e.indexOf("_border_")>-1?i[0]=e.split("_border_")[1]:e.indexOf("_Series_")>-1?i[0]=e.split("_Series_")[1]:e.indexOf("_chart_legend_shape_")>-1?(i=e.split("_chart_legend_shape_"),i[0]=i[1]):e.indexOf("TextGroup")>-1?(i=e.split("TextGroup"),i[0]=i[1]):e.indexOf("ShapeGroup")>-1&&(i=e.split("ShapeGroup"),i[0]=i[1]),new Tc(parseInt(i[0],10),parseInt(i[1],10))},t.prototype.calculateDragSelectedElements=function(e,i,r){this.removeSelectedElements(e,this.selectedDataIndexes,e.series);var n=e.selectionMode==="Lasso",s=new Le(i.x,i.y,i.width,i.height),a=new at(e.chartAxisLayoutPanel.seriesClipRect.x,e.chartAxisLayoutPanel.seriesClipRect.y);this.removeOffset(s,a);var l,h,c=[],u=[];this.isSeriesMode=!1;var d=e.allowMultiSelection&&(this.rectGrabbing||this.resizing);if(this.rectPoints=this.dragRectArray[d?this.targetIndex:this.count]=new Le(i.x,i.y,i.width,i.height),i.width&&i.height&&!r){var p=new Le(i.x,i.y,i.width,i.height);this.removeOffset(p,a),this.filterArray[d?this.targetIndex:this.count]=p}for(var f=function(I){if(I.visible){l=I.points,c=[];var D,M;(e.isTransposed||I.type.indexOf("Bar")!==-1)&&!(e.isTransposed&&I.type.indexOf("Bar")!==-1)?(D=I.xAxis.rect.y-a.y,M=I.yAxis.rect.x-a.x):(D=I.xAxis.rect.x-a.x,M=I.yAxis.rect.y-a.y);for(var E=0;E<l.length;E++){var A=I.type!=="RangeArea"||I.type.indexOf("SplineRangeArea")>-1||I.type.indexOf("RangeStepArea")>-1?l[E].yValue:l[E].regions[0].y,L=void 0,N=l[E].xValue;e.primaryXAxis.valueType==="Category"?N=l[E].x.toLocaleString():e.primaryXAxis.valueType==="DateTime"&&(N=new Date(l[E].xValue)),I.type==="BoxAndWhisker"?L=l[E].regions.some(function(R){return Pi(R.x+D,R.y+M,s)}):e.selectionMode==="Lasso"?L=l[E].isSelect:L=e.allowMultiSelection?v.isPointSelect(l[E],D,M,v.filterArray):l[E].symbolLocations.some(function(R){return R&&Pi(R.x+D,R.y+M,s)}),L&&I.category!=="Indicator"&&(h=new Tc(I.index,l[E].index),v.selection(e,h,v.findElements(e,I,h,"",I.isRectSeries?!1:I.marker.visible)),c.push({x:N,y:A})),L&&(I.type==="RangeArea"||I.type==="SplineRangeArea"||I.type==="RangeStepArea")&&c.push({x:N,y:l[E].regions[0].y})}u.push(c)}},v=this,m=0,y=e.visibleSeries;m<y.length;m++){var b=y[m];f(b)}this.blurEffect(e.element.id,e.visibleSeries);var S=n?e.mouseDownX:i.x+i.width,C=n?e.mouseDownY:i.y;r||this.createCloseButton(S,C);var x={name:zR,selectedDataValues:u,cancel:!1};e.trigger(zR,x)},t.prototype.removeOffset=function(e,i){e.x-=i.x,e.y-=i.y},t.prototype.isPointSelect=function(e,i,r,n){for(var s=e.symbolLocations[0],a=0,l=n;a<l.length;a++){var h=l[a];if(h&&s&&Pi(s.x+i,s.y+r,h))return!0}return!1},t.prototype.drawDraggingRect=function(e,i){var r=e.chartAxisLayoutPanel.seriesClipRect,n=e.chartArea.border.width,s=e.themeStyle.selectionRectFill,a=e.themeStyle.selectionRectStroke,l=e.selectionMode==="Lasso";switch(this.isdrawRect&&(r.x=r.x-n/2,r.y=r.y-n/2,r.width=r.width+n,r.height=r.height+n,this.isdrawRect=!1),e.selectionMode){case"DragX":i.y=r.y,i.height=r.height;break;case"DragY":i.x=r.x,i.width=r.width;break}if((i.width<5||i.height<5)&&!l)return null;var h=e.selectionMode.indexOf("Drag")>-1||e.selectionMode==="Lasso";if(e.allowMultiSelection&&h){var c=void 0,u=void 0,d=fe(this.multiRectGroup);if(d||(d=e.svgRenderer.createGroup({id:this.multiRectGroup}),e.svgObject.appendChild(d)),this.rectGrabbing||this.resizing){var p=fe(this.draggedRect+this.targetIndex);p.nextSibling&&Qe(p.nextSibling),this.setAttributes(p,i)}else if(!fe(this.draggedRectGroup+this.count)){u=e.svgRenderer.createGroup({id:this.draggedRectGroup+this.count});var f=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?f.appendChild(u):d.appendChild(u)}e.selectionMode!=="Lasso"?(c=e.svgRenderer.drawRectangle(new ys(this.draggedRect+this.count,s,{color:a,width:1},1,i,0,0,"",e.theme.indexOf("Fluent2")<1?"3":"")),c.style.cursor="move"):c=e.svgRenderer.drawPath(new Rr(this.lassoPath+this.count,s,3,a,1,"",this.path)),!u&&!this.rectGrabbing&&!this.resizing?fe(this.draggedRectGroup+this.count).appendChild(c):!this.rectGrabbing&&!this.resizing&&u.appendChild(c)}else{var c=fe(l?this.lassoPath:this.draggedRect);if(this.closeIcon&&zt(this.closeIconId),c)l?c.setAttribute("d",this.path):this.setAttributes(c,i);else{var u=e.svgRenderer.createGroup({id:this.draggedRectGroup}),f=document.getElementById(e.element.id+"_series_svg");e.enableCanvas?f.appendChild(u):e.svgObject.appendChild(u),e.selectionMode!=="Lasso"?c=e.svgRenderer.drawRectangle(new ys(this.draggedRect,s,{color:a,width:1},1,i,0,0,"",e.theme.indexOf("Fluent2")<1?"3":"")):c=e.svgRenderer.drawPath(new Rr(this.lassoPath,s,3,a,1,"",this.path)),u.appendChild(c)}}},t.prototype.getIndex=function(e){var i;for(i=e.length-1;i>0;i--){var r=Number(e[i]);if(isNaN(r))break}var n=+e.substr(i+1,e.length-1);return n},t.prototype.createCloseButton=function(e,i){var r=this.chart.allowMultiSelection,n=this.chart.themeStyle.selectionCircleStroke,s=this.rectGrabbing||this.resizing,a=this.chart.svgRenderer.createGroup({id:this.closeIconId+(r?s?this.targetIndex:this.count:""),style:"cursor:pointer; visibility: visible;"});a.appendChild(this.chart.svgRenderer.drawCircle(new vb(this.closeIconId+"_circle"+(r?s?this.targetIndex:this.count:""),"#FFFFFF",{color:n,width:1},1,e,i,10)));var l="M "+(e-4)+" "+(i-4)+" L "+(e+4)+" "+(i+4)+" M "+(e-4)+" "+(i+4)+" L "+(e+4)+" "+(i-4);a.appendChild(this.chart.svgRenderer.drawPath({id:this.closeIconId+"_cross"+(r?s?this.targetIndex:this.count:""),d:l,stroke:n,"stroke-width":2,fill:n})),this.closeIcon=a;var h=fe(this.draggedRectGroup+(r?s?this.targetIndex:this.count:""));h&&h.appendChild(a)},t.prototype.removeDraggedElements=function(e,i,r){if(i.id&&i.id.indexOf(this.closeIconId)>-1&&r.indexOf("move")===-1){var n=!0;if(e.allowMultiSelection){var s=this.getIndex(i.id),a=fe(this.multiRectGroup);if(Qe(fe(this.draggedRectGroup+s)),this.dragRectArray[s]=null,this.filterArray[s]=null,this.totalSelectedPoints[s]=null,a&&a.childElementCount===0&&(zt(a),this.dragRectArray=[],this.filterArray=[],this.totalSelectedPoints=[]),this.currentMode==="Lasso"){if(this.multiDataIndexes[s]!=null)for(var l=0;l<this.multiDataIndexes[s].length;l++)this.multiDataIndexes[s][l].isSelect=!1;this.multiDataIndexes[s]=null;for(var h=0;h<this.multiDataIndexes.length;h++)if(this.multiDataIndexes[h]!=null){n=!1;for(var c=0;c<this.multiDataIndexes[h].length;c++)this.multiDataIndexes[h][c].isSelect=!0}this.calculateDragSelectedElements(e,this.dragRect,!0)}else if(this.filterArray.length)for(var l=0;l<this.filterArray.length;l++)this.filterArray[l]&&(n=!1,this.calculateDragSelectedElements(e,this.filterArray[l],!0));else this.calculateDragSelectedElements(e,new Le(0,0,0,0),!0)}else Qe(fe(this.draggedRectGroup)),this.removeSelectedElements(e,this.selectedDataIndexes,e.series);this.blurEffect(e.element.id,e.visibleSeries),this.changeCursorStyle(!1,e.svgObject,"auto"),(!e.allowMultiSelection||n)&&(this.rectPoints=null)}},t.prototype.resizingSelectionRect=function(e,i,r,n){var s;if(e.allowMultiSelection&&n.id.indexOf("_ej2_drag_rect")>-1||this.dragRectArray[this.targetIndex]){n.id.indexOf("_ej2_drag_rect")>-1&&(this.targetIndex=this.getIndex(n.id));var a=this.dragRectArray[this.targetIndex];s=new Le(a.x,a.y,a.width,a.height)}if(e.allowMultiSelection||(s=new Le(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height)),s){var l=this.findResizeMode(e.svgObject,s,i);this.resizing&&(s=XI(s.x,s.y,s.x+s.width,s.y+s.height,e.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(e,s),this.dragRect=s),r&&(this.resizing=l)}else return},t.prototype.findResizeMode=function(e,i,r){var n="se-resize",s=!1;if(this.resizing){var h=i.x,c=i.y,u=r.x-h,d=r.y-c;switch(this.resizeMode){case 0:d=Math.abs(i.height+i.y-r.y),i.y=Math.min(i.height+i.y,r.y),i.height=d;break;case 1:u=Math.abs(i.width+i.x-r.x),i.x=Math.min(i.width+i.x,r.x),i.width=u;break;case 2:i.height=Math.abs(d),i.y=Math.min(r.y,c);break;case 3:i.width=Math.abs(u),i.x=Math.min(r.x,h);break;case 4:i.width=Math.abs(u),i.height=Math.abs(d),i.x=Math.min(r.x,h),i.y=Math.min(r.y,c);break}}else for(var a=[new Le(i.x,i.y,i.width-5,5),new Le(i.x,i.y,5,i.height),new Le(i.x,i.y+i.height-5,i.width-5,5),new Le(i.x+i.width-5,i.y+5,5,i.height-15),new Le(i.x+i.width-10,i.y+i.height-10,10,10)],l=0;l<a.length;l++)if(Pi(r.x,r.y,a[l])){n=l===4?n:l%2===0?"ns-resize":"ew-resize",s=!0,this.resizeMode=l;break}return this.currentMode!=="Lasso"&&this.changeCursorStyle(s,fe(this.chart.allowMultiSelection?this.draggedRect+this.targetIndex:this.draggedRect),n),this.changeCursorStyle(s,e,n),s},t.prototype.changeCursorStyle=function(e,i,r){r=e?r:this.control.svgObject===i?"auto":"move",i&&(i.style.cursor=r)},t.prototype.removeSelectedElements=function(e,i,r){i=e.isRedrawSelection?i:i.splice(0,i.length);for(var n,s=0,a=r;s<a.length;s++){var l=a[s];if(l.visible){n=this.getSeriesElements(l),this.removeStyles(n);for(var h=0,c=n;h<c.length;h++){var u=c[h];this.removeStyles(this.getChildren(u))}}}},t.prototype.setAttributes=function(e,i){for(var r=Object.keys(i),n=0,s=r;n<s.length;n++){var a=s[n];e.setAttribute(a,i[a])}},t.prototype.draggedRectMoved=function(e,i,r){var n;if((this.resizing||this.rectGrabbing)&&e.allowMultiSelection){var s=this.dragRectArray[this.targetIndex];n=new Le(s.x,s.y,s.width,s.height)}else n=new Le(this.rectPoints.x,this.rectPoints.y,this.rectPoints.width,this.rectPoints.height);n.x-=i.x-e.mouseX,n.y-=i.y-e.mouseY,n=XI(n.x,n.y,n.x+n.width,n.height+n.y,e.chartAxisLayoutPanel.seriesClipRect),r?this.drawDraggingRect(e,n):this.calculateDragSelectedElements(e,n)},t.prototype.mouseLeave=function(e){this.completeSelection(e.target,e.type)},t.prototype.completeSelection=function(e,i){var r=this.chart;r.selectionMode!=="None"&&(this.currentMode=r.selectionMode,(this.dragging||this.resizing)&&this.dragRect.width>5&&this.dragRect.height>5?this.calculateDragSelectedElements(r,this.dragRect):!r.allowMultiSelection&&this.rectGrabbing&&this.rectPoints.width&&this.rectPoints.height?this.draggedRectMoved(r,this.dragRect):this.rectGrabbing&&this.dragRectArray[this.targetIndex].width&&this.dragRectArray[this.targetIndex].height&&this.draggedRectMoved(r,this.dragRect),r.selectionMode==="Lasso"&&this.dragging&&this.path&&this.path.indexOf("L")!==-1&&(r.allowMultiSelection?fe(this.lassoPath+this.count)&&(fe(this.lassoPath+this.count).setAttribute("d",this.path+"Z"),this.pointChecking(fe(this.lassoPath+this.count))):(fe(this.lassoPath).setAttribute("d",this.path+"Z"),this.pointChecking(fe(this.lassoPath))),(this.dragging||this.resizing)&&this.calculateDragSelectedElements(r,this.dragRect)),this.dragging=!1,this.rectGrabbing=!1,this.resizing=!1,this.removeDraggedElements(r,e,i))},t.prototype.getDragRect=function(e,i){return XI(e.mouseDownX,e.mouseDownY,e.mouseX,e.mouseY,i)},t.prototype.dragStart=function(e,i,r,n,s){var a=e.selectionMode;this.currentMode=e.selectionMode,this.dragging=(a.indexOf("Drag")>-1||a==="Lasso")&&(e.isDoubleTap||!e.isTouch)&&e.chartAreaType!=="PolarRadar";var l=s.target;if(this.path=void 0,this.dragging&&(this.count=fe(this.multiRectGroup)?this.count+1:0,this.dragRect=new Le(e.mouseDownX,e.mouseDownY,0,0),(e.mouseDownX<i.x||e.mouseDownX>i.x+i.width||e.mouseDownY<i.y||e.mouseDownY>i.y+i.height)&&(this.dragging=!1)),a==="Lasso")for(var h=0,c=e.visibleSeries;h<c.length;h++){var u=c[h];if(u.visible)for(var d=0,p=u.points;d<p.length;d++){var f=p[d];e.allowMultiSelection||(f.isSelect=!1)}}if(a!=="Lasso"&&(this.rectPoints&&!e.allowMultiSelection&&(this.dragRect=new Le(e.mouseDownX,e.mouseDownY,0,0),this.resizingSelectionRect(e,new at(r,n),!0),this.rectGrabbing=Pi(r,n,this.rectPoints)),e.allowMultiSelection)){var v=this.getIndex(l.id);this.targetIndex=this.isDragRect(l.id)?v:void 0,this.dragRectArray.length&&this.isDragRect(l.id)&&(this.resizingSelectionRect(e,new at(r,n),!0,l),this.rectGrabbing=Pi(r,n,this.dragRectArray[v]))}},t.prototype.isDragRect=function(e){return e.indexOf("_ej2_drag_rect")>-1},t.prototype.mouseMove=function(e){var i=this.chart,r=e.target,n=e.type;this.highlightChart(r,n),i.selectionMode!=="None"&&(n==="touchmove"&&(j.isIos||j.isIos7)&&this.dragging&&e.preventDefault&&e.preventDefault(),this.selectionAndDrag(i,r,n))},t.prototype.highlightChart=function(e,i){if(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight){if(!g(e)){if(e.id.indexOf("_legend_text")>1&&(e=fe(e.id.replace("text","shape"))),e.id.indexOf("marker")>1&&(e=fe(e.id.replace("_marker",""))),e.id.indexOf("g")>1&&(e=fe(e.id.replace("_g_","_shape_"))),e.hasAttribute("class")&&(e.getAttribute("class").indexOf("highlight")>-1||e.getAttribute("class").indexOf("selection")>-1))return;this.calculateSelectedElements(e,i),this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&e.id.indexOf("_chart_legend_g_")===-1&&e.id.indexOf("chart_legend_shape")===-1&&e.id.indexOf("_Series_")===-1?this.removeLegendHighlightStyles():this.chart.highlightModule.highlightDataIndexes&&this.chart.highlightModule.highlightDataIndexes.length>0&&e.id.indexOf("_chart_legend_")===-1&&e.id.indexOf("_Series_")>-1&&this.chart.tooltip&&this.chart.tooltip.enableHighlight&&this.chart.highlightMode==="None"&&this.removeLegendHighlightStyles(!0)}return}},t.prototype.selectionAndDrag=function(e,i,r){var n=Pi(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect);n&&!this.chart.enableCanvas?(this.rectGrabbing&&!this.resizing?this.draggedRectMoved(e,this.dragRect,!0):this.dragging&&!this.resizing&&(e.selectionMode==="Lasso"?(this.getPath(e.mouseDownX,e.mouseDownY,e.mouseX,e.mouseY),this.drawDraggingRect(e,this.dragRect)):(this.dragRect=this.getDragRect(e,e.chartAxisLayoutPanel.seriesClipRect),this.drawDraggingRect(e,this.dragRect))),this.rectPoints&&!e.allowMultiSelection?this.resizingSelectionRect(e,new at(e.mouseX,e.mouseY),null,i):(e.allowMultiSelection&&!this.dragging||this.resizing)&&this.resizingSelectionRect(e,new at(e.mouseX,e.mouseY),null,i)):this.completeSelection(i,r)},t.prototype.removeLegendHighlightStyles=function(e){this.chart.highlightModule.highlightDataIndexes=[];for(var i,r=0;r<this.chart.visibleSeries.length;r++)if(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r])),this.selectedDataIndexes.length===0){for(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r]));i.length>0;){var n=i[0];if(n&&(this.removeSvgClass(n,n.getAttribute("class")),n.id.indexOf("Group")>0&&!this.chart.visibleSeries[r].isRectSeries))for(var s=this.indexFinder(n.id),a=0;a<n.children.length;a++)n.children[a].nodeName!=="defs"&&this.highlightAnimation(n.children[a],s.series,e?0:700,.3,!e)}for(i=document.getElementsByClassName(this.unselected);i.length>0;){var n=i[0];n&&(this.removeSvgClass(n,n.getAttribute("class")),n.id!==""&&this.highlightAnimation(n,this.chart.series.length===1?0:this.indexFinder(n.id).series,e?0:700,.3))}}else for(i=document.getElementsByClassName(this.generateStyle(this.chart.visibleSeries[r]));i.length>0;){var n=i[0];n&&(this.removeSvgClass(n,n.getAttribute("class")),this.addSvgClass(n,this.unselected))}},t.prototype.getPath=function(e,i,r,n){this.dragging&&(this.path?this.path=this.path+" L"+r+" "+n:this.path="M "+e+" "+i)},t.prototype.highlightAnimation=function(e,i,r,n,s){var a=this,l,h,c=parseFloat(this.chart.visibleSeries[i].width.toString())+1;s?e.id.indexOf("border")!==-1&&this.chart.visibleSeries[i].border.width?h=parseFloat(this.chart.visibleSeries[i].border.width.toString()):e.id.indexOf("Symbol")!==-1&&this.chart.visibleSeries[i].marker.border.width?h=parseFloat(this.chart.visibleSeries[i].marker.border.width.toString()):h=parseFloat(this.chart.visibleSeries[i].width.toString()):(e.id.indexOf("border")!==-1?l=1:e.id.indexOf("Symbol")!==-1?l=parseFloat(this.chart.visibleSeries[i].marker.opacity.toString()):e.id.indexOf("legend_shape")!==-1?l=parseFloat(this.chart.legendSettings.opacity.toString()):l=parseFloat(this.chart.visibleSeries[i].opacity.toString()),g(this.chart.selectionModule)&&this.chart.selectionMode==="None"&&this.chart.highlightColor!==""&&(n=1)),(l||s&&h&&c)&&new Mt({}).animate(e,{duration:r,progress:function(u){if(e.style.animation="",!(a.chart.tooltip.enableHighlight&&a.chart.tooltipModule.svgTooltip)){var d=u.timeStamp/u.duration;if(s){var p=c+(h-c)*d;e.setAttribute("stroke-width",p.toString())}else{var f=n+(l-n)*d;e.setAttribute("opacity",f.toString())}}},end:function(){a.chart.tooltip.enableHighlight&&a.chart.tooltipModule.svgTooltip||(s?e.setAttribute("stroke-width",h.toString()):e.setAttribute("opacity",l.toString()))}})},t.prototype.stopElementAnimation=function(e,i){var r;e.id.indexOf("border")!==-1?r=1:e.id.indexOf("Symbol")!==-1?r=parseFloat(this.chart.visibleSeries[i].marker.opacity.toString()):r=parseFloat(this.chart.visibleSeries[i].opacity.toString()),e.getAttribute("e-animate")&&Mt.stop(e),e.setAttribute("opacity",r.toString())},t.prototype.pointChecking=function(e){var i=this,r=this.chart,n,s=fe(r.svgId).getBoundingClientRect(),a=r.chartAxisLayoutPanel.seriesClipRect.x+Math.max(s.left,0),l=r.chartAxisLayoutPanel.seriesClipRect.y+Math.max(s.top,0);this.multiDataIndexes[this.count]=[];for(var h=0,c=r.visibleSeries;h<c.length;h++){var u=c[h];u.points.filter(function(d){d.symbolLocations&&d.symbolLocations.length&&(n=document.elementFromPoint(d.symbolLocations[0].x+a,d.symbolLocations[0].y+l)),n===e?(d.isSelect=!0,i.chart.allowMultiSelection&&i.currentMode==="Lasso"&&(i.multiDataIndexes[i.count][i.seriesIndex]=d,i.seriesIndex++)):r.allowMultiSelection||(d.isSelect=!1)})}this.seriesIndex=0},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.removeEventListener()},t})(WO),iY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),qO=(function(o){iY(t,o);function t(e){var i=o.call(this,e)||this;return i.element=i.chart.element,i.textStyle=e.tooltip.textStyle,i.control=e,i.template=e.tooltip.template,i}return t.prototype.getElement=function(e){return document.getElementById(e)},t.prototype.getTooltipElement=function(e){this.inverted=this.chart.requireInvertedAxis,this.header=this.control.tooltip.header===null?this.control.tooltip.shared?"${point.x}":"${series.name}":this.control.tooltip.header,this.formattedText=[];var i=document.getElementById(this.chart.element.id+"_tooltip"),r=this.chart.element.id.indexOf("stockChart")>-1;return!e&&!i||r?this.createElement():null},t.prototype.createElement=function(){var e=document.createElement("div");return e.id=this.element.id+"_tooltip",e.className="ejSVGTooltip",e.style.pointerEvents="none",e.style.position="absolute",e.style.zIndex="1",e},t.prototype.pushData=function(e,i,r,n,s){return e.series.enableTooltip?(s?this.currentPoints.push(e):n?this.currentPoints.push(e):this.currentPoints.push(e),this.stopAnimation(),r&&!document.getElementById(r.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(r):document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),!0):!1},t.prototype.removeHighlight=function(){for(var e,i=0,r=this.previousPoints.length;i<r;i++)if(e=this.previousPoints[i],e.series.isRectSeries||this.chart.tooltip.enableHighlight){e.series.visible&&this.highlightPoint(e.series,e.point.index,!1);continue}},t.prototype.animateHighlight=function(e,i,r,n){var s=this,a=parseFloat(i.getAttribute("opacity")),l=null;n!==null&&(l=parseFloat(i.getAttribute("stroke-width"))),new Mt({}).animate(i,{duration:r,progress:function(h){if(i.style.animation="",!s.svgTooltip){if(n!==null){var c=l+h.timeStamp/h.duration*(n-l);i.setAttribute("stroke-width",Math.max(c,n).toString())}var u=a+h.timeStamp/h.duration*(e-a);i.setAttribute("opacity",Math.min(u,e).toString())}},end:function(){s.svgTooltip||(n!==null&&i.setAttribute("stroke-width",n.toString()),i.setAttribute("opacity",e.toString()))}})},t.prototype.highlightPoint=function(e,i,r){var n=this,s=e.type==="BoxAndWhisker"?this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+i+"_BoxPath"):this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+i),a=this.control.accumulationSelectionModule,l=this.chart.getModuleName()==="accumulationchart",h=!!(a&&a.selectedDataIndexes.length>0);if(s||!e.isRectSeries)if(!h||h&&s.getAttribute("class")&&s.getAttribute("class").indexOf("_ej2_chart_selection_series_")===-1||!e.isRectSeries)if(e.isRectSeries&&this.chart.highlightColor!==""&&!g(this.chart.highlightColor))s.setAttribute("fill",r&&this.chart.highlightColor!=="transparent"?this.chart.highlightColor:e.pointColorMapping!==""?e.points[0].color:e.points[i].color||e.interior);else if(this.control.highlightMode==="None"&&this.chart.tooltip.enableHighlight&&(!this.chart.tooltip.shared||l)){if(r&&(l?this.control.accumulationSelectionModule&&this.control.accumulationSelectionModule.selectedDataIndexes.length>0:this.chart.selectionModule&&this.chart.selectionModule.selectedDataIndexes.length>0))return;for(var c=this.element.id+"_Series_"+e.index+"_Point_"+i,u=function(m){var y=[],b=typeof m.width=="number"?m.width:parseFloat(m.width);if(y=l?[d.getElement(d.chart.element.id+"_Series_"+m.index)]:new tY(d.chart).getSeriesElements(m),l&&d.control.series[0].dataLabel.visible){var S=d.getElement(d.element.id+"_datalabel_Series_0");S&&y.push(S)}y.forEach(function(C){C.childNodes.forEach(function(x){var I=x.id.indexOf("border")>-1?1:x.id.indexOf("Symbol")>-1?m.marker.opacity:m.opacity,D=x.id.indexOf("border")>-1&&m.border.width?parseFloat(m.border.width.toString()):x.id.indexOf("Symbol")>-1&&m.marker.border.width?parseFloat(m.marker.border.width.toString()):b;r&&n.chart.highlightColor!=="transparent"&&x.id!==""?(l?C.getAttribute("id").indexOf("datalabel")>-1?Fc(x.id).point===i:x.id===c:C.getAttribute("id")===n.element.id+"DataLabelCollection"?Fc(x.id).series===e.index:m.index===e.index)?(x.setAttribute("opacity",I.toString()),(!e.isRectSeries||x.id.indexOf("border")>-1)&&!l&&x.setAttribute("stroke-width",(D+1).toString())):(x.setAttribute("opacity",l?x.id.indexOf("datalabel")>-1?"0.5":"0.3":x.getAttribute("id").indexOf("Text")>-1?"0.5":"0.3"),(!e.isRectSeries||x.id.indexOf("border")>-1)&&!l&&x.setAttribute("stroke-width",D.toString())):!n.currentPoints[0]&&x.id!==""&&n.animateHighlight(I,x,n.chart.tooltip.duration,(!e.isRectSeries||x.id.indexOf("border")>-1)&&!l?D:null)})})},d=this,p=0,f=this.chart.visibleSeries;p<f.length;p++){var v=f[p];u(v)}}else e.isRectSeries&&s.setAttribute("opacity",(r&&this.chart.highlightColor!=="transparent"?e.opacity/2:e.opacity).toString());else s.setAttribute("opacity",e.opacity.toString())},t.prototype.highlightPoints=function(){for(var e=0,i=this.currentPoints;e<i.length;e++){var r=i[e];(r.series.isRectSeries||this.chart.tooltip.enableHighlight)&&r.series.category==="Series"&&this.highlightPoint(r.series,r.point.index,!0)}},t.prototype.createTooltip=function(e,i,r,n,s,a,l,h,c,u,d,p){c===void 0&&(c=!1),u===void 0&&(u=null),d===void 0&&(d=null);var f=this.currentPoints[0].series,v=e.tooltipModule||e.tooltip3DModule||e.accumulationTooltipModule;if(!v||r===null){zt(this.chart.element.id+"_tooltip");return}i?(this.svgTooltip=new LR({opacity:e.tooltip.opacity?e.tooltip.opacity:this.chart.theme==="Material3"||this.chart.theme==="Material3Dark"||this.chart.theme.indexOf("Bootstrap5")>-1?1:.75,header:this.headerText,content:this.text,fill:e.tooltip.fill,border:e.tooltip.border,enableAnimation:e.tooltip.enableAnimation,location:r,shared:this.control.tooltip.shared,crosshair:c,shapes:a,clipBounds:this.chart.chartAreaType==="PolarRadar"?new at(0,0):n,areaBounds:h,palette:this.findPalette(),template:p||this.template,data:d,theme:e.theme,offset:l,textStyle:e.tooltip.textStyle,isNegative:f.isRectSeries&&f.type!=="Waterfall"&&s&&s.y<0,inverted:this.chart.requireInvertedAxis&&f.isRectSeries,arrowPadding:this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,availableSize:e.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isFixed:this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null,isTextWrap:e.tooltip.enableTextWrap&&e.getModuleName()==="chart",blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,enableRTL:e.enableRtl,controlName:"Chart",allowHighlight:e.getModuleName()==="chart"&&!f.marker.allowHighlight,tooltipRender:function(){v.removeHighlight(),v.highlightPoints(),v.updatePreviousPoint(u)},animationComplete:function(m){m.tooltip.fadeOuted&&v.fadeOut(v.previousPoints)},showHeaderLine:this.chart.tooltip.showHeaderLine,showNearestTooltip:this.chart.tooltip.showNearestTooltip}),this.svgTooltip.appendTo(this.getElement(this.element.id+"_tooltip"))):this.svgTooltip&&(this.svgTooltip.location=r,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=l,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=a,this.svgTooltip.data=d,this.svgTooltip.template=this.template,this.svgTooltip.controlName="Chart",this.svgTooltip.crosshair=c,this.svgTooltip.textStyle=e.tooltip.textStyle,this.svgTooltip.isNegative=f.isRectSeries&&f.type!=="Waterfall"&&s&&s.y<0,this.svgTooltip.clipBounds=this.chart.chartAreaType==="PolarRadar"?new at(0,0):n,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart||this.chart.tooltip.location.x!==null||this.chart.tooltip.location.y!==null?0:7,this.svgTooltip.allowHighlight=e.getModuleName()==="chart"&&!f.marker.allowHighlight,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates()},t.prototype.findPalette=function(){for(var e=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];e.push(this.findColor(n,n.series))}return e},t.prototype.findColor=function(e,i){return i.isRectSeries&&(i.type==="Candle"||i.type==="Hilo"||i.type==="HiloOpenClose")?e.point.color:(e.point.color&&e.point.color!=="#ffffff"?e.point.color:e.point.interior)||i.marker.fill||i.interior},t.prototype.updatePreviousPoint=function(e){e&&(this.currentPoints=this.currentPoints.concat(e)),this.previousPoints=pe([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(e){var i=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg")||this.getElement(this.element.id+"_tooltipparent_template"),r=i&&parseInt(i.getAttribute("opacity"),10)>0;r||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(e,!0),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(e,i){if(this.chart.markerRender)for(var r=0,n=e;r<n.length;r++){var s=n[r];zt(this.element.id+"_Series_"+s.series.index+"_Point_"+s.point.index+"_Trackball"),this.chart.markerRender.removeHighlightedMarker(s.series,s.point,i)}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var e=this.getElement(this.element.id+"_tooltip_group");if(e&&e.childNodes.length>0)for(;e.lastChild&&e.childNodes.length!==1;)e.removeChild(e.lastChild)},t.prototype.stopAnimation=function(){CO(this.toolTipInterval)},t.prototype.removeTooltip=function(e){var i=this,r=this.getElement(this.element.id+"_tooltip");this.stopAnimation(),r&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){i.svgTooltip&&i.svgTooltip.fadeOut()},e))},t})(nM),rY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),YO=(function(o){rY(t,o);function t(e){var i=o.call(this,e)||this;return i.commonXvalues=[],i.addEventListener(),i}return t.prototype.addEventListener=function(){if(!this.chart.isDestroyed){var e=j.isPointer?"pointerleave":"mouseleave";this.chart.on(e,this.mouseLeaveHandler,this),this.chart.on("tapHold",this.longPress,this),this.chart.on(j.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(j.touchEndEvent,this.mouseUpHandler,this)}},t.prototype.mouseUpHandler=function(){var e=this.control,i=this.getData();i.lierIndex=this.lierIndex,e.isTouch&&!this.isSelected(e)&&(Pi(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&e.tooltip.shared||!e.tooltip.shared)?e.crosshair.enable?e.startMove&&e.tooltip.fadeOutMode==="Move"&&this.removeTooltip(2e3):(this.tooltip(),e.tooltip.fadeOutMode==="Move"&&this.removeTooltip(e.tooltip.fadeOutDuration)):!this.findData(i,this.previousPoints[0])&&e.tooltip.fadeOutMode==="Click"&&this.removeTooltip(0)},t.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.chart.tooltip.fadeOutDuration)},t.prototype.mouseMoveHandler=function(){var e=this.chart;e.stockChart&&e.stockChart.onPanning&&(e.mouseY<e.chartAxisLayoutPanel.seriesClipRect.y?e.mouseY=e.chartAxisLayoutPanel.seriesClipRect.y:e.mouseY>e.chartAxisLayoutPanel.seriesClipRect.y+e.chartAxisLayoutPanel.seriesClipRect.height&&(e.mouseY=e.chartAxisLayoutPanel.seriesClipRect.y+e.chartAxisLayoutPanel.seriesClipRect.height)),!e.disableTrackTooltip&&!this.isSelected(e)&&(!e.tooltip.shared&&(!e.isTouch||e.startMove)&&this.tooltip(),Pi(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)?e.tooltip.shared&&(!e.isTouch||e.startMove)&&this.tooltip():e.tooltip.shared&&e.tooltip.fadeOutMode==="Move"&&this.removeTooltip(this.chart.tooltip.fadeOutDuration))},t.prototype.longPress=function(){var e=this.chart;return e.crosshair.enable&&Pi(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect)&&(this.tooltip(),e.markerRender.markerMove(!1)),!1},t.prototype.tooltip=function(){var e=this.chart.enableCanvas?this.element.id+"_tooltip_group":this.element.id+"_tooltip_svg",i=this.getElement(e),r=this.chart.stockChart&&i&&i.firstChild.childNodes.length>1,n=i&&parseInt(i.getAttribute("opacity"),10)>0&&!r,s=this.getTooltipElement(n);this.chart.enableCanvas&&s&&(document.getElementById(this.chart.element.id+"_Secondary_Element").appendChild(s),s.appendChild(document.getElementById(this.chart.element.id+"_tooltip_svg"))),this.chart.tooltip.shared?this.renderGroupedTooltip(this.chart,!n,s):this.renderSeriesTooltip(this.chart,!n,s)},t.prototype.findHeader=function(e){return this.header===""?"":(this.header=this.parseTemplate(e.point,e.series,this.header,e.series.xAxis,e.series.yAxis),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},t.prototype.findShapes=function(){if(!this.chart.tooltip.enableMarker)return[];for(var e=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];e.push(n.point.marker.shape||n.series.marker.shape||"Circle")}return e},t.prototype.renderSeriesTooltip=function(e,i,r){var n=this.getData(),s=null,a=1/0;if(n.lierIndex=this.lierIndex,this.currentPoints=[],this.findData(n,this.previousPoints[0])){if(!(e.dataEditingModule&&e.dataEditingModule.isPointDragging)&&this.previousPoints[0]&&n.point.index===this.previousPoints[0].point.index&&n.series.index===this.previousPoints[0].series.index)return null;this.pushData(n,i,r,!0)&&this.triggerTooltipRender(n,i,this.getTooltipText(n),this.findHeader(n))}else{var l=Pi(e.mouseX,e.mouseY,e.chartAxisLayoutPanel.seriesClipRect);if(!n.point&&this.isRemove&&e.tooltip.fadeOutMode==="Move"&&(!e.tooltip.showNearestTooltip||!l))this.removeTooltip(this.chart.tooltip.fadeOutDuration),this.isRemove=!1;else{for(var h=this.mergeXvalues(this.chart.visibleSeries),c=e.visibleSeries.length-1;c>=0;c--){var u=e.visibleSeries[c];if(u.visible&&u.category!=="TrendLine"&&(n=this.getClosestX(e,u,h)||n,e.tooltip.showNearestTooltip&&l&&u.showNearestTooltip&&n&&n.point&&u.enableTooltip&&n.point.symbolLocations[0])){var d=Math.sqrt(Math.pow(e.mouseX-n.series.clipRect.x-n.point.symbolLocations[0].x,2)+Math.pow(e.mouseY-n.series.clipRect.y-n.point.symbolLocations[0].y,2));d<a&&(a=d,s=n)}}e.tooltip.showNearestTooltip&&s&&this.pushData(s,i,r,!0)&&(n=s,this.triggerTooltipRender(n,i,this.getTooltipText(n),this.findHeader(n)))}}n&&n.point&&this.findMouseValues(n,e,this)},t.prototype.triggerTooltipRender=function(e,i,r,n){var s=this,a,l={cancel:!1,name:ab,text:r,headerText:n,template:a,series:e.series,textStyle:this.textStyle,point:e.point,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,seriesName:e.series.name,pointIndex:e.point.index,pointText:e.point.text}},h=this.chart.border.width,c=3,u=this.chart.tooltip,d=function(p){if(p.cancel)s.removeHighlight(),Qe(s.getElement(s.element.id+"_tooltip"));else{e.series.type==="BoxAndWhisker"&&(s.removeText(),i=!0),s.headerText=p.headerText,s.formattedText=s.formattedText.concat(p.text),s.text=s.formattedText;var f=s.getSymbolLocation(e);f=f||new at(null,null),f.x=u.location.x!==null?u.location.x:f.x,f.y=u.location.y!==null?u.location.y:f.y,f=f.x===null&&f.y===null?null:f,s.createTooltip(s.chart,i,f,e.series.clipRect,e.point,s.findShapes(),s.findMarkerHeight(s.currentPoints[0]),new Le(h,h,s.chart.availableSize.width-c-h*2,s.chart.availableSize.height-c-h*2),s.chart.crosshair.enable,null,s.getTemplateText(e),s.template?p.template:"")}s.isRemove=!0};d.bind(this,e),this.chart.trigger(ab,l,d)},t.prototype.findMarkerHeight=function(e){var i=0,r=e.series;return i=(r.marker.visible||this.chart.tooltip.shared&&(!r.isRectSeries||r.marker.visible)||r.type==="Scatter"||r.drawType==="Scatter")&&!(r.type==="Candle"||r.type==="Hilo"||r.type==="HiloOpenClose")?(r.marker.height+2)/2+2*r.marker.border.width:0,i},t.prototype.findData=function(e,i){return e.point&&(!i||i.point!==e.point||i&&i.lierIndex>3&&i.lierIndex!==this.lierIndex||i.point===e.point)},t.prototype.getSymbolLocation=function(e){var i;if(e.series.type!=="BoxAndWhisker"){if(!e.point.symbolLocations[0])return null;i=new at(e.point.symbolLocations[0].x,e.point.symbolLocations[0].y)}switch(e.series.type){case"BoxAndWhisker":return this.getBoxLocation(e);case"Waterfall":return this.getWaterfallRegion(e,i);case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"RangeColumn":return this.getRangeArea(e,i);default:return i}},t.prototype.getRangeArea=function(e,i){return e.point.regions[0]&&(this.inverted?i.x=e.point.regions[0].x+e.point.regions[0].width/2:i.y=e.point.regions[0].y+e.point.regions[0].height/2,e.series.type==="RangeStepArea"&&(i.y=e.point.regions[0].y+e.point.regions[0].height/2+e.point.regions[0].width)),i},t.prototype.getWaterfallRegion=function(e,i){return this.inverted?i.x=e.point.y<0?i.x+(this.chart.enableRtl?-e.point.regions[0].width:e.point.regions[0].width):i.x:i.y=e.point.y<0?i.y-e.point.regions[0].height:i.y,i},t.prototype.getTooltipText=function(e){var i=e.series;return this.parseTemplate(e.point,i,this.getFormat(this.chart,i),i.xAxis,i.yAxis)},t.prototype.getTemplateText=function(e){if(this.template=this.chart.enableHtmlSanitizer?this.chart.sanitize(this.template):this.template,this.template&&this.chart.tooltip.shared){for(var i=[],r=0;r<e.length;r++)i[r]=pe({},e[r].point),i[r].x=this.formatPointValue(e[r].point,e[r].series.xAxis,"x",!0,!1),e[r].series.seriesType==="XY"?i[r].y=this.formatPointValue(e[r].point,e[r].series.yAxis,"y",!1,!0):(i[r].low=this.formatPointValue(e[r].point,e[r].series.yAxis,"low",!1,!0),i[r].high=this.formatPointValue(e[r].point,e[r].series.yAxis,"high",!1,!0));return i}else if(this.template){var i=pe({},e.point);return i.x=this.formatPointValue(e.point,e.series.xAxis,"x",!0,!1),e.series.seriesType==="XY"?i.y=this.formatPointValue(e.point,e.series.yAxis,"y",!1,!0):(i.low=this.formatPointValue(e.point,e.series.yAxis,"low",!1,!0),i.high=this.formatPointValue(e.point,e.series.yAxis,"high",!1,!0)),i}else return e.point},t.prototype.renderGroupedTooltip=function(e,i,r){var n,s=[],a,l=e.chartAreaType==="PolarRadar"?this.getData():null;this.stopAnimation(),this.removeHighlight(),this.currentPoints=[];var h=[],c=Number.MAX_VALUE,u=Number.MAX_VALUE,d,p,f;i&&(e.stockChart?r&&!rs(r.id)&&document.getElementById(e.stockChart.element.id+"_Secondary_Element").appendChild(r):r&&document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),this.removeText();for(var v={text:[],cancel:!1,name:QI,data:[],point:[],series:[],headerText:"",textStyle:this.textStyle,template:[]},m=0,y=0,b=e.visibleSeries;y<b.length;y++){var S=b[y];!S.enableTooltip||!S.visible||(e.chartAreaType==="Cartesian"&&S.visible?n=this.getClosestX(e,S,this.commonXValue(this.chart.visibleSeries)):e.chartAreaType==="PolarRadar"&&S.visible&&l.point!==null&&(n=new Zf(S.points[l.point.index],S)),e.tooltip.showNearestPoint&&!n&&(n=this.getClosestX(e,S,this.commonXValue([S]))),n&&(v.data.push({pointX:n.point.x,pointY:n.point.y,seriesIndex:n.series.index,seriesName:n.series.name,pointIndex:n.point.index,pointText:n.point.text}),v.series[m]=n.series,v.point[m]=n.point,v.headerText=this.findHeader(n),this.currentPoints.push(n),this.template!=null&&v.template.push(e.enableHtmlSanitizer?e.sanitize(this.template.toString()):this.template.toString()),v.text.push(this.getTooltipText(n)),d=e.requireInvertedAxis?e.mouseY-n.series.clipRect.y:e.mouseX-n.series.clipRect.x,p=e.mouseY-n.series.clipRect.y,n.point.symbolLocations&&n.point.symbolLocations.length&&Math.abs(d-n.point.symbolLocations[0].x)<=c&&Math.abs(n.point.symbolLocations[0].y-p)<Math.abs(u-p)&&(c=Math.abs(d-n.point.symbolLocations[0].x),u=n.point.symbolLocations[0].y,f=n),a=n.series.category==="TrendLine"&&e.tooltip.shared?a:f||n,s.push(n)),m++)}if(!e.tooltip.showNearestPoint){var C=[];this.currentPoints=[],v.point=[],v.series=[],v.data=[],v.text=[];for(var x=0,I=s;x<I.length;x++){var D=I[x];(D.point.symbolLocations[0].x===a.point.symbolLocations[0].x||(D.series.type.indexOf("Column")!==-1||a.series.type.indexOf("Column")!==-1)&&D.point.xValue===a.point.xValue)&&(v.point.push(D.point),v.series.push(D.series),v.text.push(this.getTooltipText(D)),v.headerText=this.findHeader(D),C.push(D),v.data.push({pointX:D.point.x,pointY:D.point.y,seriesIndex:D.series.index,seriesName:D.series.name,pointIndex:D.point.index,pointText:D.point.text}))}s=C,this.currentPoints=C}s.length>0&&this.currentPoints.length>0?this.triggerSharedTooltip(v,a,h,e,i,s):this.getElement(this.element.id+"_tooltip_path")&&this.getElement(this.element.id+"_tooltip_path").setAttribute("d","")},t.prototype.triggerSharedTooltip=function(e,i,r,n,s,a){var l=this,h=e.template,c={cancel:!1,name:QI,text:e.text,headerText:e.headerText,textStyle:e.textStyle,template:h,point:e.point,series:e.series,data:e.data},u=this.chart.border.width,d=3,p,f,v=[];n.stockChart&&(p=n.stockChart.enablePeriodSelector?n.stockChart.toolbarHeight:0,f=Xe(this.chart.stockChart.title,this.chart.stockChart.titleStyle,this.chart.themeStyle.tooltipLabelFont).height+10);var m=function(y){if(y.cancel)zt(l.element.id+"_tooltip"),r.push(i);else{i.series.type==="BoxAndWhisker"&&(l.removeText(),s=!0);for(var b=0;b<y.text.length;b++)y.text[b]&&v.push(l.currentPoints[b]);l.currentPoints=v,l.formattedText=l.formattedText.concat(y.text),l.text=y.text,l.headerText=y.headerText,typeof y.template!="object"?(y.template=y.template.split(","),y.template.length>v.length&&(y.template=y.template.splice(y.template.length-1))):y.template.length>v.length&&y.template.splice(y.template.length-1);var S=l.chart.tooltip;l.findMouseValues(i,l.chart,l);var C=l.findSharedLocation();C=C||new at(null,null),C.x=S.location.x!==null?S.location.x:C.x,C.y=S.location.y!==null?S.location.y:C.y,C=C.x===null&&C.y===null?null:C,i.series.type.indexOf("Range")===-1||Pi(C.x,C.y,n.chartAxisLayoutPanel.seriesClipRect)?l.createTooltip(n,s,C,l.currentPoints.length===1?l.currentPoints[0].series.clipRect:null,a.length===1?a[0].point:null,l.findShapes(),l.findMarkerHeight(l.currentPoints[0]),new Le(u,n.stockChart?p+f+u:u,l.chart.availableSize.width-d-u*2,l.chart.availableSize.height-d-u*2),l.chart.crosshair.enable,r,l.template?l.getTemplateText(a):null,l.template?y.template.join(""):""):(zt(l.element.id+"_tooltip"),r.push(i)),i=null}};m.bind(this,i,r),this.chart.trigger(QI,c,m)},t.prototype.findSharedLocation=function(){var e=this.chart.stockChart;if(e){this.text.length===1&&this.text.push("");var i=e.enablePeriodSelector?e.toolbarHeight:0,r=document.getElementById(e.element.id+"_ChartTitle"),n=e.title!==""?r.getBoundingClientRect().height+10:0;return e.tooltip.position==="Nearest"?new at(this.valueX,this.valueY+i+n):new at(this.chart.chartAxisLayoutPanel.seriesClipRect.x+5,this.chart.chartAxisLayoutPanel.seriesClipRect.y+i+5+n)}else return this.currentPoints.length>1?new at(this.valueX,this.valueY):this.getSymbolLocation(this.currentPoints[0])},t.prototype.getBoxLocation=function(e){var i=this.lierIndex>3?e.point.outliers.length>0?e.point.symbolLocations[this.lierIndex-4]:null:{x:e.point.regions[0].x+e.point.regions[0].width/2,y:e.point.regions[0].y+e.point.regions[0].height/2};return i},t.prototype.parseTemplate=function(e,i,r,n,s){for(var a,l,h=RegExp,c=0,u=Object.keys(e);c<u.length;c++){var d=u[c];a=new h("${point."+d+"}","gm"),r=r.replace(a.source,this.formatPointValue(e,a.source==="${point.x}"?n:s,d,a.source==="${point.x}"&&i.category!=="TrendLine",a.source==="${point.high}"||a.source==="${point.open}"||a.source==="${point.close}"||a.source==="${point.low}"||a.source==="${point.y}"||a.source==="${point.minimum}"||a.source==="${point.maximum}"||a.source==="${point.outliers}"||a.source==="${point.upperQuartile}"||a.source==="${point.lowerQuartile}"||a.source==="${point.median}"))}for(var p=0,f=Object.keys(Object.getPrototypeOf(i));p<f.length;p++){var d=f[p];a=new h("${series."+d+"}","gm"),l=i[d],r=r.replace(a.source,l)}return r},t.prototype.formatPointValue=function(e,i,r,n,s){var a,l,h;if(i.valueType!=="Category"&&n){l=i.labelFormat&&i.labelFormat.match("{value}")!==null;var c=i.valueType==="Double"?+e[r]:e[r];a=l?i.labelFormat.replace("{value}",i.format(c)):i.format(c)}else if(s&&!g(e[r]))l=i.labelFormat&&i.labelFormat.match("{value}")!==null,h=r==="outliers"?i.format(e[r][this.lierIndex-4]):i.valueType==="DateTime"?i.format(new Date(+e[r])):i.format(+e[r]),a=l?i.labelFormat.replace("{value}",h):h;else if(r==="size"){var u=this.chart.intl.getNumberFormat({format:"",useGrouping:this.chart.useGroupingSeparator});a=typeof e[r]=="number"?u(e[r]):e[r],a=a||""}else a=e[r];return a},t.prototype.getFormat=function(e,i){if(i.tooltipFormat)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,e,e.tooltip.format):i.tooltipFormat;if(!i.tooltipFormat&&e.tooltip.format)return i.seriesType==="XY"&&i.category==="Indicator"?this.getIndicatorTooltipFormat(i,e,e.tooltip.format):e.tooltip.format;var r=i.type==="Histogram"?"${point.minimum}-${point.maximum}":"${point.x}",n=e.tooltip.shared?"${series.name}":r;switch(i.seriesType){case"XY":return i.category==="Indicator"&&this.getIndicatorTooltipFormat(i,e,e.tooltip.format),n+" : "+(i.type==="Bubble"?e.theme.indexOf("Tailwind3")>-1?"${point.y}  Size : ${point.size}":"<b>${point.y}</b>  Size : <b>${point.size}</b>":e.theme.indexOf("Tailwind3")>-1?"${point.y}":"<b>${point.y}</b>");case"HighLow":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b>";case"HighLowOpenClose":return n+"<br/>High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>";case"BoxPlot":return n+"<br/>"+(this.lierIndex>3?"Outliers : <b>${point.outliers}</b>":"Maximum : <b>${point.maximum}</b><br/>Q3 : <b>${point.upperQuartile}</b><br/>Median : <b>${point.median}</b><br/>Q1 : <b>${point.lowerQuartile}</b><br/>Minimum : <b>${point.minimum}</b>")}},t.prototype.getIndicatorTooltipFormat=function(e,i,r){var n;return e.seriesType==="XY"?n=e.name+" : <b>${point.y}</b>":n=r,n},t.prototype.removeHighlightedMarker=function(e,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];zt(this.element.id+"_Series_"+s.series.index+"_Point_"+s.point.index+"_Trackball"),this.chart.markerRender&&this.chart.markerRender.removeHighlightedMarker(s.series,s.point,i)}this.previousPoints=[]},t.prototype.getModuleName=function(){return"Tooltip"},t.prototype.destroy=function(){},t})(qO);var GO=(function(){function o(t){this.errorHeight=0,this.dataLabelRectCollection={},this.chart=t}return o.prototype.initPrivateVariables=function(t,e){var i="",r="",n=t.chart.renderer,s=t.index===void 0?t.category:t.index;t.chart.chartAreaType==="Cartesian"&&(i="translate("+t.clipRect.x+","+t.clipRect.y+")",r="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"),e.dataLabel.visible&&!this.chart.enableCanvas&&(t.shapeElement=n.createGroup({id:this.chart.element.id+"ShapeGroup"+s,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"}),t.textElement=n.createGroup({id:this.chart.element.id+"TextGroup"+s,transform:i,"clip-path":r}),t.textElement.setAttribute("aria-hidden","true")),this.markerHeight=t.type==="Scatter"||e.visible?e.height/2:0,this.commonId=this.chart.element.id+"_Series_"+s+"_Point_",this.calculateErrorHeight(t,t.marker.dataLabel.position),this.chartBackground=this.chart.chartArea.background==="transparent"?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},o.prototype.calculateErrorHeight=function(t,e){if(t.errorBar.visible)if(t.errorBar.visible&&this.chart.chartAreaType!=="PolarRadar"){var i=t.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,n=this.chart.errorBarModule.negativeHeight;this.isRectSeries(t)?((e==="Top"||e==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0),(e==="Outer"||e==="Auto")&&(i==="Both"||i==="Plus"?this.errorHeight=r:this.errorHeight=0)):((e==="Top"||e==="Outer"||e==="Auto")&&((i==="Both"||i==="Plus")&&!t.chart.isTransposed?this.errorHeight=r:this.errorHeight=0),(e==="Bottom"||e==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0))}else this.errorHeight=0;else return null},o.prototype.isRectSeries=function(t){return t.isRectSeries||t.type==="RangeArea"||t.type==="SplineRangeArea"||t.type==="RangeStepArea"},o.prototype.render=function(t,e,i){this.initPrivateVariables(t,t.marker),this.inverted=e.requireInvertedAxis,this.yAxisInversed=t.yAxis.isAxisInverse;var r=e.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabelCollections",n=et("div",{id:r}),s=Eh(t);if(t.visible)for(var a=0;a<s.length;a++)this.renderDataLabel(t,s[a],n,i);n.childElementCount&&(e.enableCanvas?fe(e.element.id+"_Secondary_Element").appendChild(n):gt(e.enableCanvas,fe(e.element.id+"_Secondary_Element"),n,e.redraw,!1,"x","y",null,"",!1,!1,null,e.duration))},o.prototype.renderDataLabel=function(t,e,i,r){if(!r.showZero&&(e.y===0||e.y===0&&t.emptyPointSettings.mode==="Zero"))return null;this.margin=r.margin;var n=[],s,a,l,h,c,u,d,p,f={x:0,y:0},v,m=t.clipRect,y,b=!1,S=[],C;r.angle=r.labelIntersectAction==="Rotate90"?90:r.angle,r.enableRotation=r.labelIntersectAction==="Rotate90"?!0:r.enableRotation;var x=u=r.angle,I={width:r.border.width,color:r.border.color},D=pe({},V("properties",r.font),null,!0);if(e.symbolLocations.length&&e.symbolLocations[0]||t.type==="BoxAndWhisker"&&e.regions.length){n=e.text!==null?u6(e,t,this.chart):[],s=n.length;for(var M=0;M<s;M++){var E={cancel:!1,name:hd,series:t,point:e,text:n[M],border:I,color:r.fill,template:r.template,font:D,location:f,textSize:Xe(n[M],r.font,this.chart.themeStyle.datalabelFont)};if(this.chart.trigger(hd,E),!E.cancel)if(this.fontBackground=E.color,this.isDataLabelShape(E),this.markerHeight=t.type==="Bubble"?e.regions[0].height/2:this.markerHeight,E.template!==null)this.createDataLabelTemplate(i,t,r,e,E,M,this.chart.redraw);else{r.enableRotation?v=cd(r.font,E.text,r.angle,this.chart,this.chart.themeStyle.datalabelFont):v=Xe(E.text,r.font,this.chart.themeStyle.datalabelFont);var A=this.calculateTextPosition(e,t,v,r,M),L=new Le(A.x+m.x,A.y+m.y,A.width,A.height);if(r.enableRotation){var N=this.getRectanglePoints(L);if(d=A.x+A.width/2,p=A.y+A.height/2,b=r.labelIntersectAction==="Rotate90"||x===-90?!1:this.isDataLabelOverlapWithChartBound(N,this.chart,{x:0,y:0,width:0,height:0}),!b){this.chart.rotatedDataLabelCollections.push(N);for(var R=this.chart.rotatedDataLabelCollections.length-1,P=R;P>=0;P--)if(this.chart.rotatedDataLabelCollections[R]&&this.chart.rotatedDataLabelCollections[P-1]&&pO(this.chart.rotatedDataLabelCollections[R],this.chart.rotatedDataLabelCollections[P-1])){b=!0,this.chart.rotatedDataLabelCollections[R]=null;break}}}else b=ad(A,this.chart.dataLabelCollections,m);if(!b||r.labelIntersectAction==="None"){var k=fe(this.commonId+e.index+"_TextShape_"+M);k&&(C={x:+k.getAttribute("x"),y:+k.getAttribute("y")}),this.chart.dataLabelCollections.push(L),this.isShape&&(y=this.chart.renderer.drawRectangle(new ys(this.commonId+e.index+"_TextShape_"+M,E.color,E.border,r.opacity,A,r.rx,r.ry,"",r.border.dashArray),new Int32Array([m.x,m.y])),t.shapeElement&&gt(this.chart.enableCanvas,t.shapeElement,y,this.chart.redraw,!0,"x","y",C));var B=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1||this.chart.theme.indexOf("HighContrast")>-1?"black":"white":this.fontBackground,F=eg(_n(B)),O=Math.round((F.r*299+F.g*587+F.b*114)/1e3);a=A.x+this.margin.left+v.width/2+f.x,l=r.enableRotation&&this.chart.chartAreaType!=="PolarRadar"?A.y+this.margin.top+v.height/2+v.width/4+(r.position==="Auto"?e.regions[0].width/10:0)+f.y:A.y+this.margin.top+v.height*3/4+f.y,f={x:0,y:0},x!==0&&r.enableRotation?(h=d,c=p,u=x>360?x-360:x<-360?x+360:x):(u=0,h=A.x,c=A.y,a-=this.chart.chartAreaType==="Cartesian"&&a+v.width/2>m.width?!this.chart.requireInvertedAxis&&a>m.width?0:a+v.width/2-m.width:0,l-=l+v.height>m.y+m.height&&!(t.type.indexOf("Bar")>-1)?l+v.height-(m.y+m.height):0);var z=r.labelIntersectAction==="Rotate90"?r.position==="Top"?"start":r.position==="Middle"?"middle":"end":x===-90&&r.enableRotation?r.position==="Top"?"end":r.position==="Middle"?"middle":"start":"middle",Y=void 0;this.chart.redraw&&document.getElementById(this.commonId+e.index+"_Text_"+M)&&(Y=document.getElementById(this.commonId+e.index+"_Text_"+M).textContent),E.text&&S.push(vn(this.chart.renderer,new bn(this.commonId+(t.removedPointIndex!==null&&t.removedPointIndex<=e.index?e.index+1:e.index)+"_Text_"+M,a,l,z,E.text,"rotate("+u+","+h+","+c+")","auto",u),E.font,E.font.color||(this.chart.theme==="Bootstrap5"?"#212529":this.chart.theme==="Bootstrap5Dark"?"#DEE2E6":O>=128||t.type==="Hilo"||t.type==="HiloOpenClose"?this.chart.theme.indexOf("Tailwind3")>-1?"#111827":"black":this.chart.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"),t.textElement,!1,this.chart.redraw,!0,!1,t.chart.duration,t.clipRect,null,null,this.chart.enableCanvas,null,this.chart.themeStyle.datalabelFont,new at(h,c))),this.isShape&&r.enableRotation&&y.setAttribute("transform","rotate("+r.angle+", "+h+", "+c+")"),this.chart.stackLabels.visible&&t.type.indexOf("Stacking")>-1&&(this.dataLabelRectCollection=this.dataLabelRectCollection?this.dataLabelRectCollection:{},this.dataLabelRectCollection[this.commonId+(t.removedPointIndex!==null&&t.removedPointIndex<=e.index?e.index+1:e.index)+"_Text_"+M]=L,this.dataLabelRectCollection[this.commonId+e.index+"_TextShape_"+M]=L),t.removedPointIndex!==null&&t.removedPointIndex<=e.index&&(t.textElement.lastChild.id=this.commonId+e.index+"_Text_"+M),this.chart.redraw&&Y!==E.text&&y6(t.textElement.querySelector("#"+this.commonId+e.index+"_Text_"+M),this.chart.duration,parseFloat(Y),parseFloat(E.text),t.marker.dataLabel.format||t.yAxis.labelFormat)}else fe(this.commonId+e.index+"_Text_0")&&t.chart.redraw&&t.currentData&&fe(this.commonId+e.index+"_Text_0").remove()}}}return S},o.prototype.renderStackLabels=function(){var t=this.chart.renderer.createGroup({id:this.chart.element.id+"_StackLabelGroup"});!this.chart.enableCanvas&&t&&this.chart.seriesElements.appendChild(t);var e={},i={},r=[],n=[],s=0;if(this.chart.visibleSeries&&this.chart.visibleSeries.length>0){for(var a=0;a<this.chart.visibleSeries.length;a++){n=Object.keys(r);var l=this.chart.visibleSeries[a];r[l.stackingGroup]?r[l.stackingGroup]!==void 0&&r[l.stackingGroup].push(l):(r[l.stackingGroup]=[],r[l.stackingGroup].push(l))}if(n[0]!=="")for(var h=0;h<n.length;h++){e={},i={};for(var c=r[n[h]][r[n[h]].length-1].index,u=c;u>=0;u--){var l=this.chart.visibleSeries[u];if(!this.chart.enableCanvas&&l.animation.enable&&this.chart.animateSeries&&t.setAttribute("visibility","hidden"),l.visible&&l.points&&l.points.length>0)for(var d=0;d<l.points.length;d++){var p=l.points[d],f=String(p.x);!e[f]&&l.stackedValues.endValues[d]>0&&p.visible&&(e[f]=p),!i[f]&&l.stackedValues.endValues[d]<0&&p.visible&&(i[f]=p)}}s=this.calculateStackLabel(e,i,t,s)}else{for(var u=this.chart.visibleSeries.length-1;u>=0;u--){var l=this.chart.visibleSeries[u];if(!this.chart.enableCanvas&&l.animation.enable&&this.chart.animateSeries&&t.setAttribute("visibility","hidden"),l.visible&&l.points&&l.points.length>0)for(var d=0;d<l.points.length;d++){var p=l.points[d],f=String(p.x);!e[f]&&l.stackedValues.endValues[d]>0&&p.visible&&(e[f]=p),!i[f]&&l.stackedValues.endValues[d]<0&&p.visible&&(i[f]=p)}}this.calculateStackLabel(e,i,t,s)}}},o.prototype.calculateStackLabel=function(t,e,i,r){var n=this;return[t,e].forEach(function(s,a){if(s){var l=0,h;Object.keys(s).forEach(function(c){var u=s[c].series.stackedValues.endValues[s[c].index],d=e[c]?e[c].series.stackedValues.endValues[e[c].index]:0;if(a===0?(l=u+d,h=s[c]):t[c]||(l=u,h=s[c]),h&&h.symbolLocations[0]&&Pi(h.symbolLocations[0].x+h.series.clipRect.x,h.symbolLocations[0].y+h.series.clipRect.y,h.series.clipRect)){var p=h.series,f=h.symbolLocations[0],v=n.chart.stackLabels.format,m=l%1===0?l.toFixed(0):l.toFixed(2).slice(-1)==="0"?l.toFixed(1):l.toFixed(2);if(v){var y=v.match("{value}")!==null;m=y?v.replace("{value}",m.toString()):n.chart.intl.getNumberFormat({format:v,useGrouping:n.chart.useGroupingSeparator})(l)}var b=pe({},V("properties",n.chart.stackLabels.font),null,!0),S={cancel:!1,name:hd,series:p,point:null,text:m,border:n.chart.stackLabels.border,color:n.chart.stackLabels.fill,template:null,font:b,location:null,textSize:Xe(m,n.chart.stackLabels.font,n.chart.themeStyle.datalabelFont)};if(n.chart.trigger(hd,S),!S.cancel){var C=Xe(S.text,S.font,n.chart.themeStyle.datalabelFont),x=10;n.chartBackground===void 0&&(n.chartBackground=n.chart.chartArea.background==="transparent"?n.chart.background||n.chart.themeStyle.background:n.chart.chartArea.background);var I=S.color==="transparent"&&n.chartBackground==="transparent"?n.chart.theme.indexOf("Dark")>-1||n.chart.theme.indexOf("HighContrast")>-1?"black":"white":n.chart.stackLabels.fill!=="transparent"?n.chart.stackLabels.fill:n.chartBackground,D=eg(_n(I)),M=Math.round((D.r*299+D.g*587+D.b*114)/1e3),E=C.width+S.border.width+n.chart.stackLabels.margin.left+n.chart.stackLabels.margin.right-x/2,A=n.chart.requireInvertedAxis?x/2:n.chart.primaryYAxis.isInversed?a===0?C.height+x/2:-x:a===0?-x:C.height+x/2,L=n.chart.requireInvertedAxis?n.chart.primaryYAxis.isInversed?a===0?-(x+C.width/2):x+C.width/2:a===0?x+C.width/2:-(x+C.width/2):0;L+=S.font.textAlignment==="Far"?E:S.font.textAlignment==="Near"?-E:0;var N=Math.max(p.clipRect.x+C.width,Math.min(L+p.clipRect.x+f.x,p.clipRect.x+p.clipRect.width-C.width)),R=Math.max(p.clipRect.y+C.height,Math.min(A+p.clipRect.y+f.y-(n.chart.stackLabels.angle>0&&!n.chart.requireInvertedAxis?C.width/2:0),p.clipRect.y+p.clipRect.height-C.height));n.chart.enableCanvas&&(N-=p.clipRect.x,R-=p.clipRect.y);var P=new Le(N-C.width/2-n.chart.stackLabels.margin.left,R-C.height-n.chart.stackLabels.margin.top,C.width+(n.chart.stackLabels.margin.left+n.chart.stackLabels.margin.right),C.height+x/2+(n.chart.stackLabels.margin.top+n.chart.stackLabels.margin.bottom)),k=n.chart.renderer.drawRectangle(new ys(n.chart.element.id+"StackLabel_TextShape_"+r,S.color,S.border,null,P,n.chart.stackLabels.rx,n.chart.stackLabels.ry,"",null),new Int32Array([f.x,f.y]));k.setAttribute("transform","rotate("+n.chart.stackLabels.angle+", "+N+", "+R+")"),gt(n.chart.enableCanvas,i,k,n.chart.redraw),vn(n.chart.renderer,new bn(n.chart.element.id+"_StackLabel_"+r,N,R,"middle",S.text,"rotate("+n.chart.stackLabels.angle+", "+N+", "+R+")","auto",n.chart.stackLabels.angle),S.font,S.font.color||(n.chart.theme==="Bootstrap5"?"#212529":n.chart.theme==="Bootstrap5Dark"?"#DEE2E6":M>=128?n.chart.theme.indexOf("Tailwind3")>-1?"#111827":"black":n.chart.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"),i,null,n.chart.redraw,!0,null,n.chart.duration,p.clipRect,null,null,n.chart.enableCanvas,null,n.chart.themeStyle.datalabelFont,null),(p.type==="StackingLine"||p.type==="StackingArea")&&document.querySelectorAll('[id^="'+n.chart.element.id+"_Series_"+p.index+"_Point_"+h.index+`_Text_"], 
                                [id^="`+n.chart.element.id+"_Series_"+p.index+"_Point_"+h.index+'_TextShape_"]').forEach(function(Y){Y.id&&(Y.style.visibility="hidden",Y.setAttribute("data-collide","true"))});for(var B in n.dataLabelRectCollection)if(Object.prototype.hasOwnProperty.call(n.dataLabelRectCollection,B)){var F=n.dataLabelRectCollection[B];if(F){var O=ad(P,[F],{x:0,y:0,height:0,width:0});if(O){var z=document.getElementById(B);z&&(z.style.visibility="hidden",z.setAttribute("data-collide","true"))}}}}}r++})}}),r},o.prototype.getRectanglePoints=function(t){var e=new at(t.x,t.y),i=new at(t.x+t.width,t.y),r=new at(t.x+t.width,t.y+t.height),n=new at(t.x,t.y+t.height);return[e,i,r,n]},o.prototype.isDataLabelOverlapWithChartBound=function(t,e,i){for(var r=0;r<t.length;r++)if(!Pi(t[r].x+i.x,t[r].y+i.y,e.initialClipRect))return!0;return!1},o.prototype.createDataLabelTemplate=function(t,e,i,r,n,s,a){this.margin={left:0,right:0,bottom:0,top:0};var l=e.clipRect,h=gb(et("div",{id:this.chart.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabel_"+r.index+(s?"_"+s:""),styles:"position: absolute;background-color:"+n.color+";"+bO(i.font,this.chart.themeStyle.datalabelFont)+";border:"+n.border.width+"px solid "+n.border.color+";"}),r.index,this.chart.enableHtmlSanitizer?this.chart.sanitize(n.template):n.template,this.chart,r,e,this.chart.element.id+"_DataLabel",s);this.calculateTemplateLabelSize(t,h,r,e,i,s,l,a)},o.prototype.calculateTemplateLabelSize=function(t,e,i,r,n,s,a,l,h){var c=SO(e,l,h),u=this.calculateTextPosition(i,r,{width:c.width,height:c.height},n,s),d=0,p=0,f=!1;h&&(f=c.width===0||c.height===0),e.style.left=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.x)+u.x-d+"px",e.style.top=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.y)+u.y+p+"px";var v=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,m=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;e.childElementCount&&!f&&(!ad(u,this.chart.dataLabelCollections,a)||n.labelIntersectAction==="None")&&(r.seriesType!=="XY"||i.yValue===void 0||Th(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&Th(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&Th(i.xValue,r.xAxis.visibleRange)&&parseFloat(e.style.top)>=v.rect.y&&parseFloat(e.style.left)>=m.rect.x&&parseFloat(e.style.top)<=v.rect.y+v.rect.height&&parseFloat(e.style.left)<=m.rect.x+m.rect.width&&(this.chart.dataLabelCollections.push(new Le(u.x+a.x,u.y+a.y,u.width,u.height)),gt(this.chart.enableCanvas,t,e,l,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,e):this.chart.enableCanvas&&t.appendChild(e))},o.prototype.calculateTextPosition=function(t,e,i,r,n){var s=n>1&&e.type==="Candle"?t.regions[1]:t.regions[0];n>1&&e.type==="HiloOpenClose"&&(s=n===2?t.regions[1]:t.regions[2]);var a;a=this.getLabelLocation(t,e,i,n);var l=5,h=e.clipRect;if(!this.chart.requireInvertedAxis||!this.isRectSeries(e)||e.type==="BoxAndWhisker"){this.locationX=a.x;var c=i.height+this.borderWidth*2+this.markerHeight+this.margin.bottom+this.margin.top+l;a.x=r.position==="Auto"?a.x:this.calculateAlignment(c,a.x,r.alignment,this.isRectSeries(e)?t.yValue<0:!1),a.y=!this.isRectSeries(e)||e.type==="BoxAndWhisker"?this.calculatePathPosition(a.y,r.position,e,t,i,n):this.calculateRectPosition(a.y,s,t.yValue<0!==this.yAxisInversed,r.position,e,i,n,t),this.isRectSeries(e)&&this.chart.chartAreaType==="PolarRadar"&&(a=this.calculatePolarRectPosition(a,r.position,e,t,i,n,r.alignment,c))}else{this.locationY=a.y;var c=i.width+this.borderWidth+this.margin.left+this.margin.right-l;a.x=r.position==="Auto"?a.x:this.calculateAlignment(c,a.x,r.alignment,t.yValue<0),a.x=this.calculateRectPosition(a.x,s,t.yValue<0!==this.yAxisInversed,r.position,e,i,n,t)}var u=tb(a,i,this.margin);!(r.enableRotation===!0&&r.angle!==0)&&!(u.y>h.y+h.height||u.x>h.x+h.width||u.x+u.width<0||u.y+u.height<0)&&(u.x=u.x<0?e.type==="StackingColumn"&&!this.inverted?0:l:u.x,u.y=u.y<0&&!this.chart.requireInvertedAxis&&r.labelIntersectAction!=="None"?l:u.y,u.x-=u.x+u.width>h.x+h.width?u.x+u.width-(h.x+h.width)+l:0,u.y-=u.y+u.height>h.y+h.height?u.y+u.height-(h.y+h.height)+l:0,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground);var d;return this.inverted&&e.isRectSeries&&u.x+u.width>s.x+s.width&&(d=!0),this.fontBackground=d?this.chartBackground:this.fontBackground,u},o.prototype.calculatePolarRectPosition=function(t,e,i,r,n,s,a,l){var h=5,c,u=this.chart.availableSize.width,d=a==="Center"?0:a==="Far"?1:-1,p=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return s===0?c=r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:c=r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?e=e==="Outer"?"Top":e:i.drawType.indexOf("Range")>-1&&(e=e==="Outer"||e==="Top"?e:"Auto"),e==="Outer"?c=s===0?c+2*h+this.markerHeight:c-2*h-this.markerHeight:e==="Middle"?(c=c/2+h,i.drawType==="StackingColumn"&&(c=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+h-n.height/2)):e==="Top"?c=s===0?c-2*h-this.markerHeight:c+2*h+this.markerHeight:e==="Bottom"?(c=2*h,c+=i.drawType==="StackingColumn"?r.regionData.innerRadius+this.markerHeight:0):s===0?c=c>=i.chart.radius?c-h:i.drawType==="StackingColumn"?c-2*h:c+2*h:c=c>=i.chart.radius?c+h:c-2*h,c+=l*d,t.x=i.clipRect.width/2+i.clipRect.x+c*Math.cos(p),i.drawType==="StackingColumn"?t.x=t.x<u/2?t.x+n.width/2:t.x>u/2?t.x-n.width/2:t.x:i.drawType==="Column"&&(t.x=t.x<u/2?t.x-n.width/2:t.x>u/2?t.x+n.width/2:t.x),t.y=i.clipRect.height/2+i.clipRect.y+c*Math.sin(p),t},o.prototype.getLabelLocation=function(t,e,i,r){var n=new at(0,0),s=e.type==="Candle"&&r>1?t.regions[1]:t.regions[0];e.type==="HiloOpenClose"&&(s=r===2?t.regions[1]:t.regions[2]);var a=e.xAxis,l=e.yAxis,h=e.chart.requireInvertedAxis;if(e.type==="BoxAndWhisker"){switch(this.markerHeight=0,r){case 0:n=Wn(t.xValue,t.median,a,l,h);break;case 1:n=Wn(t.xValue,t.maximum,a,l,h);break;case 2:n=Wn(t.xValue,t.minimum,a,l,h);break;case 3:n=Wn(t.xValue,t.upperQuartile,a,l,h);break;case 4:n=Wn(t.xValue,t.lowerQuartile,a,l,h);break;default:{n=Wn(t.xValue,t.outliers[r-5],a,l,h),this.markerHeight=e.marker.height/2;break}}h?n.y=t.regions[0].y+t.regions[0].height/2:n.x=t.regions[0].x+t.regions[0].width/2}else h&&e.type.indexOf("Stacking")>-1&&t.yValue===0?n={x:s.x+s.width,y:s.y+s.height/2}:r===0||r===1?n=new at(t.symbolLocations[0].x,t.symbolLocations[0].y):(r===2||r===3)&&e.type==="Candle"?n=new at(t.symbolLocations[1].x,t.symbolLocations[1].y):h?n={x:s.x+s.width/2,y:s.y}:n={x:s.x+s.width,y:s.y+s.height/2};if(r>1&&e.type==="HiloOpenClose")if(e.chart.requireInvertedAxis){var c=s.height;n.y=s.y+c/2+2*(r===2?1:-1)}else{var u=s.width;n.x=s.x+u/2+2*(r===2?1:-1)}return n},o.prototype.calculateRectPosition=function(t,e,i,r,n,s,a,l){if(n.chart.chartAreaType==="PolarRadar")return null;var h=5,c=this.margin,u=n.marker.dataLabel.enableRotation||this.inverted?s.width:s.height;switch(r==="Bottom"&&n.type==="StackingColumn"&&!this.inverted&&e.height<s.height?this.extraSpace=this.borderWidth+(Math.abs(e.height-s.height/2)<h?0:h):this.extraSpace=this.borderWidth+u/2+(r!=="Outer"&&n.type.indexOf("Column")>-1&&Math.abs(e.height-s.height)<h?0:h),n.type==="StackingColumn100"||n.type==="StackingBar100"?r=r==="Outer"?"Top":r:n.type.indexOf("Range")>-1?r=r==="Outer"||r==="Top"?r:"Auto":n.type==="Waterfall"&&(r=r==="Auto"?"Middle":r),r){case"Bottom":t=this.inverted?i?t+(n.type==="Waterfall"?+this.extraSpace+c.left+this.markerHeight:+e.width-this.extraSpace-c.left):t-e.width+this.extraSpace+c.right:i?t+(n.type==="Waterfall"?-this.extraSpace-c.top-this.markerHeight:-e.height+this.extraSpace+c.top):t+e.height-this.extraSpace-c.bottom;break;case"Middle":t=t=this.inverted?i?t+e.width/2:t-e.width/2:i?t-e.height/2:t+e.height/2;break;case"Auto":t=this.calculateRectActualPosition(t,e,i,n,s,a,l);break;default:this.extraSpace+=this.errorHeight,t=this.calculateTopAndOuterPosition(t,e,r,n,a,this.extraSpace,i,l);break}var d=this.inverted?t<e.x||t>e.x+e.width:t<e.y||t>e.y+e.height;this.fontBackground=d?this.fontBackground==="transparent"?this.chartBackground:this.fontBackground:this.fontBackground==="transparent"?l.color||n.interior:this.fontBackground;var p=n.chart.series.length;if(r==="Outer"&&n.type.indexOf("Stacking")>-1&&p-1>n.index){for(var f=void 0,v=void 0,m=n.index+1;m<p;m++)if(f=n.chart.series[m],v=f.points[l.index],f.type.indexOf("Stacking")>-1&&f.type.indexOf("100")===-1){this.fontBackground=v&&(v.yValue<0&&l.yValue<0||v.yValue>0&&l.yValue>0)?v?v.color:f.interior:this.fontBackground;break}}return t},o.prototype.calculatePathPosition=function(t,e,i,r,n,s){var a=5;switch(i.type.indexOf("Area")>-1&&i.type!=="RangeArea"&&i.type!=="SplineRangeArea"&&i.type!=="RangeStepArea"&&this.yAxisInversed&&i.marker.dataLabel.position!=="Auto"&&(e=e==="Top"?"Bottom":e==="Bottom"?"Top":e),this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,e){case"Top":case"Outer":t=t-this.markerHeight-this.borderWidth-n.height/2-this.margin.bottom-a-this.errorHeight;break;case"Bottom":t=t+this.markerHeight+this.borderWidth+n.height/2+this.margin.top+a+this.errorHeight;break;case"Auto":t=this.calculatePathActualPosition(t,this.markerHeight,i,r,n,s);break}return t},o.prototype.isDataLabelShape=function(t){this.isShape=t.color!=="transparent"||t.border.width>0,this.borderWidth=t.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},o.prototype.calculateRectActualPosition=function(t,e,i,r,n,s,a){for(var l,h,c=!0,u=0,d=this.chart.dataLabelCollections,p=r.type.indexOf("Range")!==-1||r.type==="Hilo"?2:4;c&&u<p;){var f=this.getPosition(u);this.fontBackground=r.marker.dataLabel.fill,r.type.indexOf("Stacking")>-1&&f==="Outer"&&(f="Top",u++),l=this.calculateRectPosition(t,e,i,f,r,n,s,a),this.inverted?(h=tb(new at(l,this.locationY),n,this.margin),c=h.x<0||ad(h,d,r.clipRect)||h.x+h.width>r.clipRect.width):(r.marker.dataLabel.enableRotation&&(n.width=n.width-a.regions[0].width/10),h=tb(new at(this.locationX,l),n,this.margin),c=h.y<0||ad(h,d,r.clipRect)||h.y>r.clipRect.height,r.marker.dataLabel.template===null&&c!==!0&&(c=h.y/2+n.height+(f==="Outer"?a.regions[0].height+this.extraSpace:a.regions[0].height-2*this.extraSpace)>r.clipRect.height)),u++}return l},o.prototype.calculateAlignment=function(t,e,i,r){switch(i){case"Far":e=this.inverted?r?e-t:e+t:r?e+t:e-t;break;case"Near":e=this.inverted?r?e+t:e-t:r?e-t:e+t;break}return e},o.prototype.calculateTopAndOuterPosition=function(t,e,i,r,n,s,a,l){var h=this.margin,c;switch(r.type){case"RangeColumn":case"RangeArea":case"RangeStepArea":case"SplineRangeArea":case"Hilo":c=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c);break;case"Candle":c=(n===0||n===2)&&!this.yAxisInversed||(n===1||n===3)&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c,n>1);break;case"HiloOpenClose":n<=1?(c=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c)):this.yAxisInversed?t=this.inverted?t-s-h.right:t+s+h.top:t=this.inverted?t+s+h.left:t-s-h.bottom;break;default:a&&i==="Top"||!a&&i==="Outer"||i==="Top"&&r.visiblePoints[l.index].yValue===0?t=this.inverted?t+(a&&r.type==="Waterfall"?+e.width-s-h.left:+s+h.left+this.markerHeight):t+(a&&r.type==="Waterfall"?-e.height+s+h.bottom:-s-h.bottom-this.markerHeight):t=this.inverted?t+(a&&r.type==="Waterfall"?+e.width+s+h.top:-s-h.right-this.markerHeight):t+(a&&r.type==="Waterfall"?-e.height-s-h.top:+s+h.top+this.markerHeight);break}return t},o.prototype.updateLabelLocation=function(t,e,i,r,n,s,a){return a===void 0&&(a=!1),this.inverted?s?e=t==="Outer"&&!a?e+i+r.left+this.markerHeight:e-i-r.right-this.markerHeight:e=t==="Outer"&&!a?e-n.width-i-r.right-this.markerHeight:e-n.width+i+r.left+this.markerHeight:s?e=t==="Outer"&&!a?e-i-r.bottom-this.markerHeight:e+i+r.top+this.markerHeight:e=t==="Outer"&&!a?e+n.height+i+r.top+this.markerHeight:e+n.height-i-r.bottom-this.markerHeight,e},o.prototype.calculatePathActualPosition=function(t,e,i,r,n,s){var a=i.points,l=r.index,h=a[l].yValue,c,u=a.length-1>l?a[l+1]:null,d=l>0?a[l-1]:null,p,f=!0,v,m,y,b=this.chart.dataLabelCollections;if(i.type==="Bubble")c="Top";else if(i.type.indexOf("Step")>-1)c="Top",l&&(c=!d||!d.visible||h>d.yValue!==this.yAxisInversed||h===d.yValue?"Top":"Bottom");else if(i.type==="BoxAndWhisker")s===1||s===3||s>4?c=i.yAxis.isAxisInverse?"Bottom":"Top":s===2||s===4?c=i.yAxis.isAxisInverse?"Top":"Bottom":(f=!1,c="Middle",p=this.calculatePathPosition(t,c,i,r,n,s));else if(l===0)c=!u||!u.visible||h>u.yValue||h<u.yValue&&this.yAxisInversed?"Top":"Bottom";else if(l===a.length-1)c=!d||!d.visible||h>d.yValue||h<d.yValue&&this.yAxisInversed?"Top":"Bottom";else if(!u.visible&&!(d&&d.visible))c="Top";else if(!u.visible||!d)c=u.yValue>h||d&&d.yValue>h?"Bottom":"Top";else{var S=(u.yValue-d.yValue)/2,C=S*l+(u.yValue-S*(l+1));c=this.yAxisInversed?C<h?"Bottom":"Top":C<h?"Top":"Bottom"}for(m=c==="Bottom",y=["Outer","Top","Bottom","Middle","Auto"].indexOf(c);f&&y<4;)p=this.calculatePathPosition(t,this.getPosition(y),i,r,n,s),v=tb(new at(this.locationX,p),n,this.margin),f=v.y<0||ad(v,b,i.clipRect)||v.y+v.height>i.clipRect.height,y=m?y-1:y+1,m=!1;return p},o.prototype.doDataLabelAnimation=function(t,e){for(var i=t.shapeElement.childNodes,r=t.textElement.childNodes,n=t.animation.delay+t.animation.duration,s=t.chart.animated?t.chart.duration:200,a,l=e?1:r.length,h,c=0;c<l;c++)h=r[c],e?(e.style.visibility="hidden",rM(e,n,s,"ZoomIn")):(a=new at(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),Lh(h,n,t.animation.duration,t,null,a,!0),i[c]&&(h=i[c],a=new at(+h.getAttribute("x")+ +h.getAttribute("width")/2,+h.getAttribute("y")+ +h.getAttribute("height")/2),Lh(h,n,t.animation.duration,t,null,a,!0)))},o.prototype.getPosition=function(t){return["Outer","Top","Bottom","Middle","Auto"][t]},o.prototype.getModuleName=function(){return"DataLabel"},o.prototype.destroy=function(){},o})();var nY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),QO=(function(o){nY(t,o);function t(e){var i=o.call(this,e)||this;return i.library=i,i.addEventListener(),i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(j.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(j.touchEndEvent,this.mouseEnd,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(j.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(j.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(e){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(e),this.chart.highlightModule&&(this.chart.highlightMode!=="None"||this.chart.legendSettings.enableHighlight)))for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],r=e.target.id,n=void 0,s=0,a=i;s<a.length;s++){var l=a[s];if(r.indexOf(l)>-1){n=parseInt(r.split(l)[1],10),this.chart.highlightModule.legendSelection(this.chart,n,e.target,e.type);break}}},t.prototype.mouseEnd=function(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)},t.prototype.getLegendOptions=function(e,i){this.legendCollections=[];var r,n,s=[];this.isRtlEnable=i.enableRtl,this.isReverse=!this.isRtlEnable&&i.legendSettings.reverse,e.length>1&&(this.legend.mode="Series");for(var a=0,l=e;a<l.length;a++){var h=l[a];if(this.legend.mode==="Series")h.category!=="Indicator"&&(r=i.chartAreaType==="PolarRadar"?h.drawType:h.type,n=h.interior,this.legendCollections.push(new Ac(h.name,n,h.legendShape,h.category==="TrendLine"?this.chart.series[h.sourceIndex].trendlines[h.index].visible:h.visible,r,h.legendImageUrl?h.legendImageUrl:h.type==="Scatter"&&h.marker.shape==="Image"?h.marker.imageUrl:"",h.marker.shape,h.marker.visible,null,null,h.dashArray)));else if(this.legend.mode==="Point")for(var c=0,u=h.points;c<u.length;c++){var d=u[c];r=i.chartAreaType==="PolarRadar"?h.drawType:h.type,n=d.interior?d.interior:h.interior,this.legendCollections.push(new Ac(d.x.toString(),n,h.legendShape,h.category==="TrendLine"?this.chart.series[h.sourceIndex].trendlines[h.index].visible:d.visible,r,h.type==="Scatter"&&h.marker.shape==="Image"?h.marker.imageUrl:"",h.marker.shape,h.marker.visible,null,null,h.dashArray))}else if(this.legend.mode==="Range")for(var p=0,f=h.points;p<f.length;p++){var d=f[p];r=i.chartAreaType==="PolarRadar"?h.drawType:h.type,n=d.interior?d.interior:h.interior;var v="Others";if(s.indexOf(n)<0&&(s.push(n),i.rangeColorSettings.length>=1&&i.rangeColorSettings[0].colors.length===1)){for(var m=0,y=i.rangeColorSettings;m<y.length;m++){var b=y[m];b.colors[0]===n&&(v=b.label)}this.legendCollections.push(new Ac(v,n,h.legendShape,h.category==="TrendLine"?this.chart.series[h.sourceIndex].trendlines[h.index].visible:d.visible,r,h.type==="Scatter"&&h.marker.shape==="Image"?h.marker.imageUrl:"",h.marker.shape,h.marker.visible,null,null,h.dashArray))}}else if(this.legendCollections.length===0&&i.rangeColorSettings.length>0){var S=i.rangeColorSettings[0].start.toString(),C=i.rangeColorSettings[i.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new Ac(S,h.interior,"Rectangle",!0,r,"",h.marker.shape,h.marker.visible)),this.legendCollections.push(new Ac(C,h.interior,"Rectangle",!0,r,"",h.marker.shape,h.marker.visible))}}this.isReverse&&i.legendSettings.mode!=="Gradient"&&this.legendCollections.reverse()},t.prototype.getLegendBounds=function(e,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title,this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var n=r.padding,s=r.titlePosition,a=0,l,h=0,c=this.arrowWidth,u=this.arrowHeight,d=this.isVertical&&!r.enablePages?u:0,p=this.isTitle&&s==="Top"?this.legendTitleSize.height+this.fivePixel:0;p=this.isTitle&&this.isVertical&&s!=="Top"?this.legendTitleSize.height+this.fivePixel:p,this.isVertical?h=r.width?0:e.width/100*5:a=r.height?0:e.height/100*5,i.height+=a,i.width+=h;var f=r.shapeWidth,v=r.shapePadding,m=0,y=0,b=0,S=0,C=0,x=0,I=0,D,M=!1;this.maxItemHeight=Math.max(Xe("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);var E=r.layout==="Auto"&&r.maximumColumns>0;if(r.fixedWidth)for(var A=0;A<this.legendCollections.length;A++){var L=f+v+(this.isVertical||A===0?n:this.itemPadding)+(r.maximumLabelWidth?r.maximumLabelWidth:Xe(this.legendCollections[A].text,r.textStyle,this.chart.themeStyle.legendLabelFont).width);this.maxWidth=Math.max(this.maxWidth,L)}for(var A=0;A<this.legendCollections.length;A++)if(l=this.legendCollections[A],lb.test(l.text)&&(l.text=WR(l.text,lb)),jR.test(l.text)&&(l.text=WR(l.text,jR)),D={fill:l.fill,text:l.text,shape:l.shape,markerShape:l.markerShape,name:FR,cancel:!1},this.chart.trigger(FR,D),l.render=!D.cancel,l.text=D.text,l.fill=D.fill,l.shape=D.shape,l.markerShape=D.markerShape,l.textSize=Xe(l.text,r.textStyle,this.chart.themeStyle.legendLabelFont),f=l.text?r.shapeWidth:0,v=l.text?r.shapePadding:0,l.render&&l.text){M=!0,b=r.fixedWidth?this.maxWidth:f+v+(r.maximumLabelWidth?r.maximumLabelWidth:l.textSize.width)+(!this.isVertical||r.layout==="Horizontal"?A===0||C===1&&x>0&&r.layout==="Horizontal"?n:this.itemPadding:n),y=y+b,!r.enablePages&&!this.isVertical&&(I=this.isTitle&&s!=="Top"?this.legendTitleSize.width+this.fivePixel:0,I+=c),this.getLegendHeight(l,r,i,y,this.maxItemHeight,n),(E?C===r.maximumColumns:r.layout==="Vertical"||i.width<n+y+I||this.isVertical&&r.layout==="Auto")&&(m=Math.max(m,y+n+I-(this.isVertical&&this.legend.layout==="Auto"?0:b)),x===0&&b!==y&&(x=1),y=this.isVertical&&this.legend.layout==="Auto"?0:b,x++,C=0,S=d);var N=x>0?x-1:0;this.rowHeights[N]=Math.max(this.rowHeights[N]?this.rowHeights[N]:0,Math.max(l.textSize.height,r.shapeHeight)),this.columnHeights[C]=(this.columnHeights[C]?this.columnHeights[C]:0)+Math.max(l.textSize.height,r.shapeHeight)+(this.isVertical||x>0&&this.legend.itemPadding?A===0?n:this.itemPadding:n),C++}S=Math.max.apply(null,this.columnHeights)+n+p,S=Math.max(S,this.maxItemHeight+n+n+p),r.layout==="Horizontal"&&(S=this.maxItemHeight+n*2+p+this.pageButtonSize+r.border.width),this.isPaging=(i.height<S||r.layout==="Horizontal"&&this.rowHeights.length>1)&&!E,this.isPaging&&!r.enablePages&&(this.isVertical||(S=this.maxItemHeight+n+n+(s==="Top"?p:0))),this.totalPages=x,E&&this.maxWidth&&r.fixedWidth&&(y=this.maxWidth*r.maximumColumns,this.isPaging=!1),(!this.isPaging||this.legend.layout!=="Auto")&&!this.isVertical&&(y+=this.isTitle&&s!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),M?this.setBounds(Math.max(y+n,m),S,r,i):this.setBounds(0,0,r,i)},t.prototype.getLegendHeight=function(e,i,r,n,s,a){var l=e.textSize.width,h=i.shapePadding+a*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?e.textCollection=El(e.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,null,null,this.chart.themeStyle.legendLabelFont):e.textCollection.push(e.text),e.textSize.height=s*e.textCollection.length;break}},t.prototype.getRenderPoint=function(e,i,r,n,s,a,l){var h=this.legend.padding,c=this.legend.fixedWidth?this.maxWidth:r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),u=n.location.x+(this.isRtlEnable?-c:c);(this.legend.layout==="Auto"&&this.legend.maximumColumns>0?a%this.legend.maximumColumns===0:this.legend.layout==="Vertical"||this.isWithinBounds(u,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:e.textSize.width)+r-this.itemPadding,s)||this.isVertical&&this.legend.layout==="Auto")?(e.location.x=i.x,a!==l&&this.chartRowCount++,e.location.y=a===l?n.location.y:n.location.y+(this.isVertical&&this.legend.layout!=="Horizontal"&&!(this.legend.maximumColumns>0)?Math.max(n.textSize.height,this.legend.shapeHeight):this.rowHeights[this.chartRowCount-2])+(this.isVertical||this.chartRowCount>1&&this.legend.itemPadding?this.itemPadding:h)):(e.location.x=a===l?n.location.x:u,e.location.y=n.location.y);var d=this.isRtlEnable?e.location.x-r+this.itemPadding+this.legend.shapeWidth/2-this.legendBounds.x:this.legendBounds.x+this.legendBounds.width-(e.location.x+r-this.itemPadding-this.legend.shapeWidth/2);!this.isVertical&&this.isPaging&&!this.legend.enablePages&&(d=this.legendBounds.width-e.location.x-this.fivePixel),d=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,d):d,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(e.text=Js(+d.toFixed(4),e.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendLabelFont))},t.prototype.isWithinBounds=function(e,i,r){return this.isRtlEnable?e-i<r.x-this.legend.shapeWidth/2:e+i>r.x+r.width+this.legend.shapeWidth/2},t.prototype.LegendClick=function(e,i){var r=this.chart,n=r.legendSettings.mode==="Series"?e:0,s=this.isReverse?this.legendCollections.length-1-e:e,a=r.visibleSeries[n],l=this.legendCollections[s],h="isProtectedOnChange";if(r.legendSettings.mode==="Series"){var c={legendText:l.text,legendShape:l.shape,chart:r,series:a,points:a.points,name:Mh,cancel:!1};this.chart.trigger(Mh,c),a.legendShape=c.legendShape,c.cancel||(a.fill!==null&&(r.visibleSeries[e].interior=a.fill),r.legendSettings.toggleVisibility?(a.chart[h]=!0,a.category==="TrendLine"?!r.series[a.sourceIndex].trendlines[a.index].visible&&r.series[a.sourceIndex].visible?r.series[a.sourceIndex].trendlines[a.index].visible=!0:r.series[a.sourceIndex].trendlines[a.index].visible=!1:this.changeSeriesVisiblity(a,a.visible),l.visible=a.category==="TrendLine"?r.series[a.sourceIndex].trendlines[a.index].visible:a.visible,this.refreshLegendToggle(r,a),r.highlightModule&&r.legendSettings.enableHighlight&&r.highlightModule.legendSelection(r,e,i.target,"mousemove")):r.highlightModule?r.highlightModule.legendSelection(r,e,i.target,i.type):r.selectionModule&&r.selectionModule.legendSelection(r,e,i.target,i.type),a.chart[h]=!1)}else if(r.legendSettings.mode==="Point"){var u=a.points[e],c={legendText:l.text,legendShape:l.shape,chart:r,series:a,points:[u],name:Mh,cancel:!1};if(this.chart.trigger(Mh,c),r.legendSettings.toggleVisibility&&!c.cancel){u.visible=!u.visible;var d=this.legendCollections[e];d.visible=u.visible,this.refreshLegendToggle(r,a)}}else if(r.legendSettings.mode==="Range"){for(var p=[],d=this.legendCollections[e],f=0,v=a.points;f<v.length;f++){var u=v[f];d.fill===(u.interior||a.interior)&&p.push(u)}var c={legendText:l.text,legendShape:l.shape,chart:r,series:a,points:p,name:Mh,cancel:!1};if(this.chart.trigger(Mh,c),r.legendSettings.toggleVisibility&&!c.cancel){d.visible=!d.visible;for(var m=0,y=p;m<y.length;m++){var u=y[m];u.visible=!u.visible}this.refreshLegendToggle(r,a)}}},t.prototype.refreshLegendToggle=function(e,i){var r=[];if(e.selectionModule&&(r=pe([],e.selectionModule.selectedDataIndexes,null,!0)),e.svgObject.childNodes.length>0&&!e.enableAnimation&&!e.enableCanvas){for(;e.svgObject.lastChild;)e.svgObject.removeChild(e.svgObject.lastChild);Qe(e.svgObject)}e.animateSeries=!1,e.redraw=e.enableAnimation,i.isLegendClicked=!0,e.rotatedDataLabelCollections=[],zt(rs(e.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),this.redrawSeriesElements(i,e),e.removeSvg(),e.refreshAxis(),i.refreshAxisLabel(),this.refreshSeries(e.visibleSeries);for(var n=0,s=e.visibleSeries;n<s.length;n++){var a=s[n];g(a)||e.markerRender.removeHighlightedMarker(a,null,!0)}e.refreshBound(),e.trigger("loaded",{chart:e}),r.length>0&&(e.selectionModule.selectedDataIndexes=r,e.selectionModule.redrawSelection(e,e.selectionMode)),!e.enableCanvas&&e.highlightModule&&(e.highlightMode!=="None"||e.legendSettings.enableHighlight)&&e.highlightModule.redrawSelection(e,e.highlightMode),e.redraw=!1,i.isLegendClicked=!1},t.prototype.changeSeriesVisiblity=function(e,i){e.visible=!i,this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some(function(r){return r.visible})),(this.isSecondaryAxis(e.yAxis)||e.category==="Pareto"&&e.type==="Line")&&(e.yAxis.internalVisibility=e.yAxis.series.some(function(r){return r.visible})),e.trendlines.length&&e.visible&&e.trendlines.forEach(function(r){r.visible=!0})},t.prototype.isSecondaryAxis=function(e){return this.chart.axes.indexOf(e)>-1},t.prototype.redrawSeriesElements=function(e,i){if(!i.redraw)return null;zt(i.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabelCollections")},t.prototype.refreshSeries=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.type.indexOf("Spline")>-1){var s=n.type.indexOf("Area")>-1||n.drawType.indexOf("Area")>-1,a=n.type.indexOf("Range")>-1;this.chart["spline"+(s?a?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(n)}n.visible&&(n.position=void 0)}},t.prototype.click=function(e){var i=this;if(this.chart.legendSettings.visible){for(var r=this.chart.mouseX,n=this.chart.mouseY,s=[],a=e.target.id.indexOf("_chart_legend_g_")>-1?e.target.firstChild.id:e.target.id,l=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"],h,c=0,u=l;c<u.length;c++){var d=u[c];if(a.indexOf(d)>-1){h=parseInt(a.split(d)[1],10),this.LegendClick(h,e);break}}a.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):a.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(r,n),s=this.legendRegions.filter(function(p){return Pi(r,n+(i.isPaging?(i.currentPageNumber-1)*i.translatePage(i.chart.enableCanvas,null,1,2):0),p.rect)}),s.length&&this.chart.enableCanvas&&this.LegendClick(s[0].index,e)}},t.prototype.checkWithinBounds=function(e,i){var r=this.chart.renderer,n=this.legendBounds,s=this.chart.legendSettings.border.width,a=new Le(n.x,n.y,n.width,n.height);if(a.x=a.x-s/2,a.y=a.y-s/2,a.width=a.width+s,a.height=a.height+s,Pi(e,i,this.pagingRegions[0]))return this.isRtlEnable?this.canvasPageUp(r,a,n):this.canvasPageDown(r,a,n),null;if(Pi(e,i,this.pagingRegions[1]))return this.isRtlEnable?this.canvasPageDown(r,a,n):this.canvasPageUp(r,a,n),null},t.prototype.canvasPageDown=function(e,i,r){--this.currentPageNumber>0?(this.legendRegions=[],e.clearRect(i),e.canvasClip(new ys("legendClipPath","transparent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),e.canvasRestore()):++this.currentPageNumber},t.prototype.canvasPageUp=function(e,i,r){++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],e.clearRect(i),e.canvasClip(new ys("legendClipPath","transpaent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),e.canvasRestore()):--this.currentPageNumber},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.removeEventListener()},t})(LO);var Cb=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ft=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},sY=(function(o){Cb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ft([w(null)],t.prototype,"content",void 0),ft([w("0")],t.prototype,"x",void 0),ft([w("0")],t.prototype,"y",void 0),ft([w("Pixel")],t.prototype,"coordinateUnits",void 0),ft([w("Chart")],t.prototype,"region",void 0),ft([w("Middle")],t.prototype,"verticalAlignment",void 0),ft([w("Center")],t.prototype,"horizontalAlignment",void 0),ft([w(null)],t.prototype,"description",void 0),t})(Oe),aY=(function(o){Cb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ft([w(!1)],t.prototype,"visible",void 0),ft([w(!0)],t.prototype,"showZero",void 0),ft([w(null)],t.prototype,"name",void 0),ft([w("transparent")],t.prototype,"fill",void 0),ft([w("Inside")],t.prototype,"position",void 0),ft([w(5)],t.prototype,"rx",void 0),ft([w(5)],t.prototype,"ry",void 0),ft([w(0)],t.prototype,"angle",void 0),ft([w(!1)],t.prototype,"enableRotation",void 0),ft([Ce({width:null,color:null},qn)],t.prototype,"border",void 0),ft([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},ea)],t.prototype,"font",void 0),ft([Ce({},ld)],t.prototype,"connectorStyle",void 0),ft([w(null)],t.prototype,"template",void 0),ft([w("")],t.prototype,"format",void 0),ft([w(null)],t.prototype,"maxWidth",void 0),ft([w("Ellipsis")],t.prototype,"textOverflow",void 0),ft([w("Normal")],t.prototype,"textWrap",void 0),t})(Oe),oY=(function(o){Cb(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ft([w("50%")],t.prototype,"x",void 0),ft([w("50%")],t.prototype,"y",void 0),t})(Oe),GR=(function(){function o(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null}return o})(),lY=(function(o){Cb(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.points=[],e.clubbedPoints=[],e.sumOfPoints=0,e.isRectSeries=!0,e.clipRect=new Le(0,0,0,0),e.category="Series",e.rightSidePoints=[],e.leftSidePoints=[],e}return t.prototype.refreshDataManager=function(e,i){var r=this;this.accumulation=e,this.radius=this.radius?this.radius:j.isDevice&&this.dataLabel.position==="Outside"?"40%":"80%";var n=this.dataSource||e.dataSource;if(!(n instanceof oe)&&g(this.query)){this.dataManagerSuccess({result:n,count:n.length},e,i);return}var s=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());s.then(function(a){return r.dataManagerSuccess(a,e)})},t.prototype.dataManagerSuccess=function(e,i,r){r===void 0&&(r=!0);var n={name:sb,series:this,data:e.result};i.allowServerDataBinding=!1,i.trigger(sb,n),this.resultData=e.result!==""?e.result:[],r||this.getPoints(this.resultData,i),++i.seriesCounts===i.visibleSeries.length&&r&&(this.getPoints(this.resultData,i),i.refreshChart())},t.prototype.getPoints=function(e,i){var r=Object.keys(e).length;if(this.sumOfPoints=0,r===0)return this.points=[],null;this.groupTo&&this.findSumOfPoints(e),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;for(var n,s=this.palettes.length?this.palettes:JI(i.theme),a=zi(this.groupTo,this.sumOfPoints),l=0;l<r;l++)n=this.setPoints(e,l,s,i),this.isClub(n,a,l)?(n.index=this.clubbedPoints.length,n.isExplode=!0,this.clubbedPoints.push(n),n.isSliced=!0):(g(n.y)&&(n.visible=!1),this.pushPoints(n,s));if(this.groupTo||this.findSumOfPoints(e),this.lastGroupTo=this.groupTo,this.sumOfClub>0){var h=this.generateClubPoint();this.pushPoints(h,s);var c=this.points.length-1;this.clubbedPoints.map(function(u){u.index+=c,u.color=h.color})}this.clubbedPoints.length&&this.explode&&this.type==="Pie"&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},t.prototype.generateClubPoint=function(){var e=new GR;return e.isClubbed=!0,e.x="Others",e.y=this.sumOfClub,e.text=e.originalText=e.x+": "+this.sumOfClub,e.sliceRadius="80%",e},t.prototype.pushPoints=function(e,i){e.index=this.points.length,e.isExplode=this.explodeAll||e.index===this.explodeIndex,e.color=e.color||i[e.index%i.length],this.points.push(e)},t.prototype.isClub=function(e,i,r){if(!g(i)){if(this.groupMode==="Value"&&Math.abs(e.y)<=i)return this.sumOfClub+=Math.abs(e.y),!0;if(this.groupMode==="Point"&&r>=i)return this.sumOfClub+=Math.abs(e.y),!0}return!1},t.prototype.findSumOfPoints=function(e){for(var i=Object.keys(e).length,r=0;r<i;r++)!g(e[r])&&!g(e[r][this.yName])&&!isNaN(e[r][this.yName])&&(this.points.length&&this.points[r]&&this.points[r].visible&&!g(this.points[r].y)||this.groupTo)&&(this.sumOfPoints+=Math.abs(e[r][this.yName]))},t.prototype.setPoints=function(e,i,r,n){var s=new GR;return s.x=V(this.xName,e[i]),s.y=V(this.yName,e[i]),s.legendImageUrl=V(this.legendImageUrl,e[i]),s.color=V(this.pointColorMapping,e[i]),s.text=s.originalText=V(this.dataLabel.name||"",e[i]),s.tooltip=V(this.tooltipMappingName||"",e[i]),s.sliceRadius=V(this.radius,e[i]),s.sliceRadius=g(s.sliceRadius)?"80%":s.sliceRadius,s.separatorY=n.intl.formatNumber(s.y,{useGrouping:n.useGroupingSeparator}),this.setVisibility(s,i),this.setAccEmptyPoint(s,i,e),s},t.prototype.renderSeries=function(e,i){var r=i?fe(e.element.id+"_Series_"+this.index):e.renderer.createGroup({id:e.element.id+"_Series_"+this.index});this.renderPoints(e,r,i);var n;e.accumulationDataLabelModule&&this.dataLabel.visible&&(n=e.renderer.createGroup({id:e.element.id+"_datalabel_Series_"+this.index}),n.style.visibility=(this.animation.enable&&Yt!=="Disable"||Yt==="Enable")&&e.animateSeries&&this.type==="Pie"?"hidden":"visible",this.renderDataLabel(e,n,i)),this.type==="Pie"&&(e.redraw||this.findMaxBounds(this.labelBound,this.accumulationBound),e.pieSeriesModule.animateSeries(e,this.animation,this,r,this.borderRadius,this.points)),!e.redraw&&e.accumulationLegendModule&&(this.labelBound.x-=e.explodeDistance,this.labelBound.y-=e.explodeDistance,this.labelBound.height+=e.explodeDistance-this.labelBound.y,this.labelBound.width+=e.explodeDistance-this.labelBound.x)},t.prototype.renderPoints=function(e,i,r,n,s,a){for(var l=e.element.id+"_Series_"+this.index+"_Point_",h,c,u=[],d=[],p=["Chessboard","Dots","DiagonalForward","Crosshatch","Pacman","DiagonalBackward","Grid","Turquoise","Star","Triangle","Circle","Tile","HorizontalDash","VerticalDash","Rectangle","Box","VerticalStripe","HorizontalStripe","Bubble"],f=0,v=this.points;f<v.length;f++){var m=v[f];m.percentage=+(m.y/this.sumOfPoints*100).toFixed(2);var y={cancel:!1,name:Ah,series:this,point:m,fill:m.color,border:this.isEmpty(m)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color},pattern:this.applyPattern?p[m.index%p.length]:"None"};if(e.trigger(Ah,y),m.color=y.fill,c=m.color,this.applyPattern){var b=new WO(e);c=b.pattern(e,m.color,m.index,y.pattern,this.opacity)}h=new Rr(l+m.index,c,y.border.width||1,y.border.color||m.color,this.opacity,y.series.dashArray,""),this.funnelMode==="Trapezoidal"&&this.type==="Funnel"?(u.push(h),m.visible&&d.push(m)):e[_r(this.type)+"SeriesModule"].renderPoint(m,this,e,h,i,r,n,s,a)}this.funnelMode==="Trapezoidal"&&this.type==="Funnel"?e[_r(this.type)+"SeriesModule"].renderTrapezoidalFunnel(this,d,e,u,i,r):gt(!1,e.getSeriesElement(),i,r)},t.prototype.renderDataLabel=function(e,i,r){e.accumulationDataLabelModule.findAreaRect();var n=et("div",{id:e.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];for(var s=[],a=[],l=0,h=this.points;l<h.length;l++){var c=h[l];c.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(c.y!==0||c.y===0&&this.emptyPointSettings.mode==="Zero"))&&e.accumulationDataLabelModule.renderDataLabel(c,this.dataLabel,i,this.points,this.index,n,r),c.midAngle>=90&&c.midAngle<=270?this.leftSidePoints.push(c):c.midAngle>=0&&c.midAngle<=90?a.push(c):s.push(c)}if(s.sort(function(d,p){return d.midAngle-p.midAngle}),a.sort(function(d,p){return d.midAngle-p.midAngle}),this.leftSidePoints.sort(function(d,p){return d.midAngle-p.midAngle}),this.rightSidePoints=s.concat(a),e.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,i,n,r),this.dataLabel.template!==null&&n.childElementCount){var u=e.accumulationDataLabelModule.drawDataLabels.bind(e.accumulationDataLabelModule,this,this.dataLabel,i,n,r);e.isReact&&e.renderReactTemplates(u),gt(!1,fe(e.element.id+"_Secondary_Element"),n,r)}gt(!1,e.getSeriesElement(),i,r)},t.prototype.findMaxBounds=function(e,i){e.x=i.x<e.x?i.x:e.x,e.y=i.y<e.y?i.y:e.y,e.height=i.y+i.height>e.height?i.y+i.height:e.height,e.width=i.x+i.width>e.width?i.x+i.width:e.width},t.prototype.findMaxLabelWidth=function(){for(var e,i=0;i<this.points.length;i++)e=this.points[0].textSize.width,e<this.points[i].textSize.width&&(e=this.points[i].textSize.width);return e},t.prototype.setAccEmptyPoint=function(e,i,r){if(!(g(e.y)||isNaN(e.y)))return null;switch(e.color=this.emptyPointSettings.fill||e.color,this.emptyPointSettings.mode){case"Zero":e.y=0,e.visible=!0;break;case"Average":{var n=r[i-1]&&r[i-1][this.yName]||0,s=r[i+1]&&r[i+1][this.yName]||0;e.y=(Math.abs(n)+Math.abs(s))/2,this.sumOfPoints+=e.y,e.visible=!0;break}default:e.visible=!1;break}},t.prototype.setVisibility=function(e,i){this.accumulation.accumulationLegendModule&&this.accumulation.accumulationLegendModule.legendCollections&&this.accumulation.accumulationLegendModule.legendCollections[i]&&!this.accumulation.accumulationLegendModule.legendCollections[i].visible&&(e.visible=!1)},t.prototype.setData=function(e,i){if(!e)return null;var r=!1;if(this.dataSource.length===e.length){r=!0;for(var n=0;n<e.length;n++)if(this.dataSource[n][this.xName]===e[n][this.xName]){var s=this.points[n],a=this.dataSource[n];a[this.yName]!==e[n][this.yName]&&(s.y=e[n][this.yName],this.dataSource[n]=e[n])}else{r=!1;break}}if(!r)this.dataSource=e;else{this.sumOfPoints=0;for(var l=[],n=0;n<this.resultData.length;n++)this.points[n]&&this.points[n].visible&&l.push(this.resultData[n]);this.findSumOfPoints(l),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation,this.accumulation.animateSeries=!1;var h=this.accumulation.duration;this.accumulation.duration=g(i)?500:i,this.accumulation[_r(this.type)+"SeriesModule"].initProperties(this.accumulation,this),this.renderPoints(this.accumulation,fe(this.accumulation.element.id+"_Series_"+this.index),this.accumulation.redraw,null,null,!0),this.accumulation.centerLabel.text&&this.accumulation.renderCenterLabel(!0,!0),this.accumulation.annotationModule&&this.accumulation.annotationModule.renderAnnotations(fe(this.accumulation.element.id+"_Secondary_Element")),this.accumulation.accumulationDataLabelModule&&this.dataLabel.visible&&this.renderDataLabel(this.accumulation,fe(this.accumulation.element.id+"_datalabel_Series_"+this.index),this.accumulation.redraw),this.accumulation.redraw=!1,this.accumulation.duration=h}},t.prototype.addPoint=function(e,i){var r;this.accumulation.series[0].dataLabel.visible&&(r=this.findMaxLabelWidth()),this.dataSource.push(e),this.resultData=this.dataSource,this.sumOfPoints=0;for(var n=[],s=0;s<this.resultData.length;s++)this.points[s]&&this.points[s].visible?n.push(this.resultData[s]):s===this.resultData.length-1&&n.push(this.resultData[s]);var a=this.points.length===0?0:this.points[this.points.length-1].index+1,l=this.palettes.length?this.palettes:JI(this.accumulation.theme),h=this.setPoints(this.dataSource,a,l,this.accumulation);this.pushPoints(h,l),this.findSumOfPoints(n),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation;var c=this.accumulation.duration;this.accumulation.duration=g(i)?500:i,this.updateSeries(fe(this.accumulation.element.id+"_Series_"+this.index),r,"addPoint"),this.accumulation.redraw=!1,this.accumulation.duration=c},t.prototype.removePoint=function(e,i){var r=pe([],this.dataSource,null,!0),n=this.accumulation.duration;if(r.length>0&&e>=0&&e<r.length){this.sumOfPoints=0;for(var s=[],a=0;a<this.dataSource.length;a++)a!==e&&this.points[a]&&this.points[a].visible&&s.push(this.dataSource[a]);r.splice(e,1),this.dataSource.splice(e,1),this.accumulation.redraw=this.borderRadius?!1:this.accumulation.enableAnimation,this.accumulation.duration=g(i)?500:i,this.points.splice(e,1);for(var a=e;a<this.points.length;a++){var l=this.points[a];l.index=a,l.y=this.points[a].y}this.findSumOfPoints(s);var h=fe(this.accumulation.element.id+"_Series_0_Point_"+this.points.length);h&&h.parentNode.removeChild(h),this.updateSeries(fe(this.accumulation.element.id+"_Series_"+this.index),void 0,"removePoint",e),this.accumulation.redraw=!1,this.accumulation.duration=n}},t.prototype.updateSeries=function(e,i,r,n){var s=this.accumulation[_r(this.type)+"SeriesModule"].radius,a=this.accumulation[_r(this.type)+"SeriesModule"].center,l;if(this.accumulation.legendSettings.visible){if(r==="addPoint")this.accumulation.accumulationLegendModule.legendCollections.push(new Ac(this.points[this.points.length-1].x.toString(),this.points[this.points.length-1].color,this.legendShape,this.points[this.points.length-1].visible,this.type,this.points[this.points.length-1].legendImageUrl,null,null,this.points[this.points.length-1].index,this.index));else{this.accumulation.accumulationLegendModule.legendCollections.splice(n,1);for(var h=n;h<this.accumulation.accumulationLegendModule.legendCollections.length;h++)this.accumulation.accumulationLegendModule.legendCollections[h].pointIndex=h}if(this.accumulation.accumulationLegendModule.legendCollections.length>=1&&(l=this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.accumulationLegendModule.calculateLegendBounds(this.accumulation.initialClipRect,this.accumulation.availableSize,null,l,!0),this.dataLabel&&this.dataLabel.position==="Outside"&&(this.accumulation.legendSettings.position==="Bottom"||this.accumulation.legendSettings.position==="Top")?l.height!==this.accumulation.accumulationLegendModule.legendBounds.height:l.width!==this.accumulation.accumulationLegendModule.legendBounds.width)){var c=this.accumulation.title?Xe(this.accumulation.title,this.accumulation.titleStyle,this.accumulation.themeStyle.chartTitleFont).height*this.accumulation.titleCollection.length:0,u=this.accumulation.subTitle?Xe(this.accumulation.subTitle,this.accumulation.subTitleStyle,this.accumulation.themeStyle.chartSubTitleFont).height*this.accumulation.subTitleCollection.length:0;this.accumulation.initialClipRect=new Le(this.accumulation.margin.left,this.accumulation.margin.top,this.accumulation.availableSize.width,this.accumulation.availableSize.height),dO(this.accumulation.initialClipRect,new Le(0,u+c,this.accumulation.margin.right+this.accumulation.margin.left,this.accumulation.margin.bottom+this.accumulation.margin.top)),this.accumulation.accumulationLegendModule.calculateLegendBounds(this.accumulation.initialClipRect,this.accumulation.availableSize,null)}}if(this.accumulation[_r(this.type)+"SeriesModule"].initProperties(this.accumulation,this),this.renderPoints(this.accumulation,e,this.accumulation.redraw,s,a,!0),l&&(this.accumulation.legendSettings.position==="Bottom"||this.accumulation.legendSettings.position==="Top"?l.height!==this.accumulation.accumulationLegendModule.legendBounds.height:l.width!==this.accumulation.accumulationLegendModule.legendBounds.width)&&this.accumulation.centerLabel.text&&this.accumulation.renderCenterLabel(!0,!0),this.accumulation.annotationModule&&this.accumulation.annotationModule.renderAnnotations(fe(this.accumulation.element.id+"_Secondary_Element")),this.accumulation.accumulationDataLabelModule&&this.dataLabel.visible){var d=this.accumulation.renderer.createGroup({id:this.accumulation.element.id+"_datalabel_Series_"+this.index});this.renderDataLabel(this.accumulation,d,this.accumulation.redraw)}this.accumulation.legendSettings.visible&&(this.type==="Pie"&&(this.dataLabel.visible&&this.points[this.points.length-1]&&this.points[this.points.length-1].textSize.width>i&&this.accumulation.legendSettings.position!=="Top"&&this.accumulation.legendSettings.position!=="Bottom"&&(this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,this.points[this.points.length-1].labelRegion),this.findMaxBounds(this.labelBound,this.accumulationBound),this.labelBound.x-=this.accumulation.explodeDistance,this.labelBound.y-=this.accumulation.explodeDistance,this.labelBound.height+=this.accumulation.explodeDistance-this.labelBound.y,this.labelBound.width+=this.accumulation.explodeDistance-this.labelBound.x),this.accumulation.accumulationLegendModule.getSmartLegendLocation(this.accumulation.visibleSeries[0].labelBound,this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.margin)),this.accumulation.accumulationLegendModule.renderLegend(this.accumulation,this.accumulation.legendSettings,this.accumulation.accumulationLegendModule.legendBounds,this.accumulation.redraw,!0))},t.prototype.isEmpty=function(e){return e.color===this.emptyPointSettings.fill},ft([w("")],t.prototype,"dataSource",void 0),ft([w()],t.prototype,"query",void 0),ft([w("")],t.prototype,"xName",void 0),ft([w("")],t.prototype,"name",void 0),ft([w("")],t.prototype,"tooltipMappingName",void 0),ft([w("")],t.prototype,"yName",void 0),ft([w(!0)],t.prototype,"visible",void 0),ft([Ce({color:null,width:0},qn)],t.prototype,"border",void 0),ft([Ce(null,tM)],t.prototype,"animation",void 0),ft([w("SeriesType")],t.prototype,"legendShape",void 0),ft([w("")],t.prototype,"legendImageUrl",void 0),ft([w("")],t.prototype,"pointColorMapping",void 0),ft([w(!1)],t.prototype,"applyPattern",void 0),ft([w(null)],t.prototype,"selectionStyle",void 0),ft([w(null)],t.prototype,"groupTo",void 0),ft([w("Value")],t.prototype,"groupMode",void 0),ft([Ce({},aY)],t.prototype,"dataLabel",void 0),ft([w([])],t.prototype,"palettes",void 0),ft([w(0)],t.prototype,"startAngle",void 0),ft([w(null)],t.prototype,"endAngle",void 0),ft([w(null)],t.prototype,"radius",void 0),ft([w("0")],t.prototype,"innerRadius",void 0),ft([w("Pie")],t.prototype,"type",void 0),ft([w(!0)],t.prototype,"enableTooltip",void 0),ft([w(!1)],t.prototype,"explode",void 0),ft([w("30%")],t.prototype,"explodeOffset",void 0),ft([w(!1)],t.prototype,"explodeAll",void 0),ft([w(null)],t.prototype,"explodeIndex",void 0),ft([Ce({mode:"Drop"},ZR)],t.prototype,"emptyPointSettings",void 0),ft([w(0)],t.prototype,"gapRatio",void 0),ft([w("80%")],t.prototype,"width",void 0),ft([w("80%")],t.prototype,"height",void 0),ft([w("20%")],t.prototype,"neckWidth",void 0),ft([w("20%")],t.prototype,"neckHeight",void 0),ft([w("Linear")],t.prototype,"pyramidMode",void 0),ft([w("Standard")],t.prototype,"funnelMode",void 0),ft([w(1)],t.prototype,"opacity",void 0),ft([w("0")],t.prototype,"dashArray",void 0),ft([Ce({},Bo)],t.prototype,"accessibility",void 0),ft([w(0)],t.prototype,"borderRadius",void 0),t})(Oe);function hY(o,t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(o===r.index)return r}return t[0]}function XO(o,t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(r.index===o)return r}return null}var aM=(function(){function o(t){this.accumulation=t}return Object.defineProperty(o.prototype,"center",{get:function(){return this.pieCenter||(this.accumulation.visibleSeries[0].type==="Pie"?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(t){this.pieCenter=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"radius",{get:function(){return this.pieRadius!==void 0?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(t){this.pieRadius=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelRadius",{get:function(){return this.pieLabelRadius!==void 0?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(t){this.pieLabelRadius=t},enumerable:!0,configurable:!0}),o.prototype.isCircular=function(){return this.accumulation.type==="Pie"},o.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},o.prototype.processExplode=function(t){if(t.target.id.indexOf("_Series_")>-1||t.target.id.indexOf("_datalabel_")>-1){var e=Fc(t.target.id).point;if(isNaN(e)||t.target.id.indexOf("_datalabel_")>-1&&this.accumulation.visibleSeries[0].points[e].labelPosition==="Outside")return null;this.explodePoints(e,this.accumulation),this.deExplodeAll(e,this.accumulation.enableAnimation?300:0)}},o.prototype.invokeExplode=function(){for(var t=this.accumulation.visibleSeries[0],e=this.accumulation.enableAnimation?300:0,i=0,r=t.points;i<r.length;i++){var n=r[i];n.isExplode&&n.y!==0&&this.pointExplode(n.index,n,e)}if(this.accumulation.accumulationSelectionModule&&this.accumulation.selectionMode!=="None"&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(var s=0,a=this.accumulation.accumulationSelectionModule.selectedDataIndexes;s<a.length;s++){var l=a[s];this.explodePoints(l.point,this.accumulation,!0),this.deExplodeAll(l.point,e)}},o.prototype.deExplodeAll=function(t,e){for(var i=this.accumulation.element.id+"_Series_0_Point_",r=this.accumulation.visibleSeries[0].points,n=0,s=r;n<s.length;n++){var a=s[n];(t!==a.index&&!a.isSliced||a.isClubbed)&&(a.isExplode=!1,this.deExplodeSlice(a.index,i,e))}},o.prototype.explodePoints=function(t,e,i,r){i===void 0&&(i=!1);var n=e.visibleSeries[0],s=n.points,a=XO(t,s),l=!0,h=this.accumulation.enableAnimation?300:0;if(g(a))return null;var c=!i&&(a.isSliced||n.clubbedPoints.length&&s[s.length-1].index===n.clubbedPoints[n.clubbedPoints.length-1].index);n.type==="Pie"&&(c||a.isClubbed)&&(l=this.clubPointExplode(t,a,n,s,e,h,c)),l&&a.y!==0&&this.pointExplode(t,a,h,i,r)},o.prototype.getSum=function(t){var e=0;return t.map(function(i){e+=i.visible?i.y:0}),e},o.prototype.clubPointExplode=function(t,e,i,r,n,s,a){if(a===void 0&&(a=!1),e.isClubbed)return n.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map(function(h){h.visible=!0,h.isExplode=!0}),n.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(t,s),i.sumOfPoints=this.getSum(n.visibleSeries[0].points),n.refreshChart(),!1;if(a||e.isSliced){n.animateSeries=!1,r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var l=i.generateClubPoint();if(l.index=r.length,l.color=i.clubbedPoints[0].color,r.push(l),i.sumOfPoints=this.getSum(r),this.deExplodeAll(t,s),l.isExplode=!1,n.visibleSeries[0].points=r,n.refreshChart(),this.pointExplode(l.index,r[l.index],0,!0),l.isExplode=!1,this.deExplodeSlice(l.index,n.element.id+"_Series_0_Point_",s),e.isSliced)return!1}return!0},o.prototype.pointExplode=function(t,e,i,r,n){var s,a=this.accumulation.element.id+"_Series_0_Point_",l=this.accumulation;this.isCircular()?s=Tn(e.midAngle,l.explodeDistance,this.center):s={x:e.labelRegion&&e.labelRegion.x<e.region.x?-l.explodeDistance:l.explodeDistance,y:0},this.isExplode(a+t)||r?(e.isExplode=!0,this.explodeSlice(t,s,a,this.center||{x:0,y:0},i,n)):(e.isExplode=!1,this.deExplodeSlice(t,a,i))},o.prototype.isExplode=function(t){var e=fe(t),i=e?e.getAttribute("transform"):null;return e&&(i==="translate(0, 0)"||i===null||i==="translate(0)")},o.prototype.deExplodeSlice=function(t,e,i){var r=fe(e+t),n=r?r.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&r&&n&&n!=="translate(0, 0)"&&n!=="translate(0)"){var s=n.split("(")[1].split(")")[0].split(",");this.performAnimation(t,e,0,0,+s[0],+s[1]||0,i,!0)}else this.performAnimation(t,e,0,0,0,0,i,!0)},o.prototype.setTranslate=function(t,e,i,r){this.setElementTransform(e+t,i),this.setElementTransform(e+t+"_polygon",i),this.accumulation.visibleSeries[0].dataLabel.visible&&(e=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(e+"shape_"+t,i),this.setElementTransform(e+"text_"+t,i+r),this.setElementTransform(e+"connector_"+t,i))},o.prototype.setElementTransform=function(t,e){var i=fe(t);i&&i.setAttribute("transform",e)},o.prototype.explodeSlice=function(t,e,i,r,n,s){s&&fe(this.accumulation.element.id+"_Series_0_Point_"+t).getAttribute("transform")?this.setElementTransform(i+t,"translate("+(e.x-r.x)+", "+(e.y-r.y)+")"):this.performAnimation(t,i,0,0,e.x-r.x,e.y-r.y,n)},o.prototype.performAnimation=function(t,e,i,r,n,s,a,l){var h=this,c=this.accumulation,u=e.split("_"),d=parseInt(e.split("_")[u.length-3],10),p=c.visibleSeries[d].points[t];if(a<=0)return this.setTranslate(t,e,"translate("+n+", "+s+")",p.transform),null;var f,v,m=this.accumulation.series[d].type==="Pie"&&this.accumulation.animateSeries&&this.accumulation.series[0].animation.enable?this.accumulation.series[0].animation.duration:0;new Mt({}).animate(et("div"),{duration:a,delay:m,progress:function(y){f=Ur(y.timeStamp,i,n,y.duration),v=Ur(y.timeStamp,r,s,y.duration),h.setTranslate(t,e,"translate("+(l?n-f:f)+", "+(l?s-v:v)+")",p.transform)},end:function(){h.setTranslate(t,e,"translate("+(l?i:n)+", "+(l?i:s)+")",p.transform)}})},o})(),cY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),uY=(function(o){cY(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.initProperties=function(e,i){this.accumulation=e,this.size=Math.min(e.initialClipRect.width,e.initialClipRect.height),this.initAngles(i);var r=.8,n=parseInt(i.radius,10);if((i.radius.indexOf("%")!==-1||typeof n=="number")&&!isNaN(n))this.isRadiusMapped=!1,this.pieBaseRadius=zi(i.radius,i.border.width>20?.5*r*this.size:this.size/2),this.innerRadius=zi(i.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius=i.dataLabel.position==="Inside"?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+zi(i.dataLabel.connectorStyle.length||"4%",this.size/2);else{var s=[];this.isRadiusMapped=!0;for(var a=0;a<Object.keys(i.points).length;a++)i.points[a].sliceRadius.indexOf("%")!==-1?s[a]=zi(i.points[a].sliceRadius,this.size/2):s[a]=parseInt(i.points[a].sliceRadius,10);var l=Math.min.apply(null,s),h=Math.max.apply(null,s);this.pieBaseRadius=this.seriesRadius=h,this.innerRadius=zi(i.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>l?this.innerRadius/2:this.innerRadius}this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,e.explodeDistance=i.explode?zi(i.explodeOffset,this.pieBaseRadius):0,this.findCenter(e,i),this.center=this.pieBaseCenter,e.redraw||this.defaultLabelBound(i,i.dataLabel.visible,i.dataLabel.position),this.totalAngle-=.001},t.prototype.getLabelRadius=function(e,i){return e.dataLabel.position==="Inside"?(zi(i.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:zi(i.sliceRadius,this.size/2)+zi(e.dataLabel.connectorStyle.length||"4%",this.size/2)},t.prototype.findCenter=function(e,i){this.accumulation=e,this.pieBaseCenter={x:zi(e.center.x,e.initialClipRect.width)+e.initialClipRect.x,y:zi(e.center.y,e.initialClipRect.height)+e.initialClipRect.y};var r=this.getSeriesBound(i),n=new at(r.x+r.width/2,r.y+r.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-n.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-n.y,this.accumulation.origin=this.pieBaseCenter},t.prototype.initAngles=function(e){var i=g(e.endAngle)?e.startAngle:e.endAngle;this.totalAngle=(i-e.startAngle)%360,this.startAngle=e.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},t.prototype.defaultLabelBound=function(e,i,r){var n=this.getSeriesBound(e);e.accumulationBound=n,e.labelBound=new Le(n.x,n.y,n.width+n.x,n.height+n.y),i&&r==="Outside"&&(e.labelBound=new Le(1/0,1/0,-1/0,-1/0))},t.prototype.getSeriesBound=function(e){var i=new Le(1/0,1/0,-1/0,-1/0);this.initAngles(e);var r=this.startAngle,n=this.totalAngle,s=(this.startAngle+n)%360;s=s===0?360:s,e.findMaxBounds(i,this.getRectFromAngle(r)),e.findMaxBounds(i,this.getRectFromAngle(s)),e.findMaxBounds(i,new Le(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));var a=(Math.floor(r/90)*90+90)%360,l=Math.floor(s/90)*90%360;l=l===0?360:l,(n>=90||l===a)&&(e.findMaxBounds(i,this.getRectFromAngle(a)),e.findMaxBounds(i,this.getRectFromAngle(l))),(r===0||r+n>=360)&&e.findMaxBounds(i,this.getRectFromAngle(0));for(var h=a===l?0:Math.floor(n/90),c=1;c<h;c++)a=a+90,(a<l||s<r||n===360)&&e.findMaxBounds(i,this.getRectFromAngle(a));return i.width-=i.x,i.height-=i.y,i},t.prototype.getRectFromAngle=function(e){var i=Tn(e,this.pieBaseRadius,this.pieBaseCenter);return new Le(i.x,i.y,0,0)},t.prototype.getPathArc=function(e,i,r,n,s,a,l,h){var c=r-i;c=c<0?c+360:c;var u=c<180?0:1;return!s&&s===0?this.getPiePath(e,Tn(i,n,e),Tn(r,n,e),n,u,a,h):this.getDoughnutPath(e,Tn(i,n,e),Tn(r,n,e),n,Tn(i,s,e),Tn(r,s,e),s,u,a,l,h)},t.prototype.getPiePath=function(e,i,r,n,s,a,l){var h=this.sliceCheck(l);a=h===1?0:a;var c=Math.atan2(i.y-e.y,i.x-e.x),u=Math.atan2(r.y-e.y,r.x-e.x);a=this.adjustCornerRadius(c,u,n,a);var d=i.x-a*Math.cos(c),p=i.y-a*Math.sin(c),f=r.x-a*Math.cos(Math.PI/2+u),v=r.y-a*Math.sin(Math.PI/2+u),m=r.x-a*Math.cos(u),y=r.y-a*Math.sin(u),b=i.x+a*Math.cos(Math.PI/2+c),S=i.y+a*Math.sin(Math.PI/2+c);return"M "+e.x+" "+e.y+" L "+d+" "+p+" A "+a+" "+a+" 0 0 1 "+b+" "+S+" A "+n+" "+n+" 0 "+s+" 1 "+f+" "+v+" A "+a+" "+a+" 0 0 1 "+m+" "+y+" Z"},t.prototype.getDoughnutPath=function(e,i,r,n,s,a,l,h,c,u,d){var p=this.sliceCheck(d);c=p===1?0:c;var f=Math.atan2(i.y-s.y,i.x-s.x),v=Math.atan2(r.y-a.y,r.x-a.x);c=this.adjustCornerRadius(f,v,l,c),c=u&&this.innerRadius===0?c*-1:c;var m=i.x-c*Math.cos(f),y=i.y-c*Math.sin(f),b=r.x-c*Math.cos(Math.PI/2+v),S=r.y-c*Math.sin(Math.PI/2+v),C=a.x+c*Math.cos(v),x=a.y+c*Math.sin(v),I=s.x+c*Math.cos(Math.PI/2+f),D=s.y+c*Math.sin(Math.PI/2+f),M=i.x+c*Math.cos(Math.PI/2+f),E=i.y+c*Math.sin(Math.PI/2+f),A=r.x-c*Math.cos(v),L=r.y-c*Math.sin(v),N=a.x-c*Math.cos(Math.PI/2+v),R=a.y-c*Math.sin(Math.PI/2+v),P=s.x+c*Math.cos(f),k=s.y+c*Math.sin(f);return u?"M "+M+" "+E+" A "+n+" "+n+" 0 "+h+" 1 "+b+" "+S+" L "+N+" "+R+" A "+l+" "+l+" 0 "+h+" 0 "+I+" "+D+" Z":"M "+m+" "+y+" A "+c+" "+c+" 0 0 1 "+M+" "+E+" A "+n+" "+n+" 0 "+h+" 1 "+b+" "+S+" A "+c+" "+c+" 0 0 1 "+A+" "+L+" L "+C+" "+x+" A "+c+" "+c+" 0 0 1 "+N+" "+R+" A "+l+" "+l+" 0 "+h+" 0 "+I+" "+D+" A "+c+" "+c+" 0 0 1 "+P+" "+k+" Z"},t.prototype.adjustCornerRadius=function(e,i,r,n){var s=Math.abs(i-e);s>Math.PI&&(s=2*Math.PI-s);var a=s/(2*Math.PI),l=r*a;return Math.min(n,l)},t.prototype.sliceCheck=function(e){for(var i=0,r=0;r<e.length;r++){var n=e[r];n.visible&&i++}return i},t.prototype.doAnimation=function(e,i,r,n,s){var a=this,l=i.startAngle-90,h=this.accumulation.duration?this.accumulation.duration:i.animation.duration,c;this.pieBaseCenter.x+=1;var u=Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width)*.75;u+=u*.414;var d=iM("Linear");new Mt({}).animate(e,{duration:h===0&&Yt==="Enable"?1e3:h,delay:i.animation.delay,progress:function(p){c=d(p.timeStamp,l,a.totalAngle,p.duration),e.setAttribute("d",a.getPathArc(a.pieBaseCenter,l,c,u,0,n,!1,s))},end:function(){a.pieBaseCenter.x-=1,e.setAttribute("d",a.getPathArc(a.pieBaseCenter,0,359.99999,u,0,n,!1,s)),a.accumulation.trigger(Rq,{series:i,accumulation:a.accumulation,chart:a.accumulation});var p=fe(a.accumulation.element.id+"_datalabel_Series_"+i.index);p&&Lh(p,i.animation.delay,i.animation.duration,i,null,null,!1),r.style.cssText="";var f=fe(a.accumulation.element.id+"_Annotation_Collections");f&&(f.style.visibility="visible")}})},t})(aM),dY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ub=(function(o){dY(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.renderPoint=function(e,i,r,n,s,a,l,h,c){var u=i.sumOfPoints,d=this.accumulation.visibleSeries[0].points,p=i.borderRadius;e.startAngle=this.startAngle;var f=e.visible?e.y:0,v=u?Math.abs(f)/u*this.totalAngle:null,m=Math.PI/180*(90-(360-this.startAngle)-90);if(this.radius=this.isRadiusMapped?zi(e.sliceRadius,this.seriesRadius):this.radius,n.d=this.getPathOption(e,v,this.startAngle%360,p,d),e.midAngle=(this.startAngle-v/2)%360,e.endAngle=this.startAngle%360,e.symbolLocation=Tn(e.midAngle,(this.radius+this.innerRadius)/2,this.center),a){var y=r.renderer.drawPath(n);!e.isExplode&&c&&y.setAttribute("transform","translate(0, 0)"),y.setAttribute("role",i.accessibility.accessibilityRole?i.accessibility.accessibilityRole:"img"),y.setAttribute("tabindex",e.index===0&&i.accessibility.focusable?String(i.accessibility.tabIndex):"-1"),y.style.outline="none",y.setAttribute("stroke-linejoin","round"),y.setAttribute("aria-label",i.accessibility.accessibilityDescription?i.accessibility.accessibilityDescription:e.x+": "+e.y+"%. "+i.name),e.degree===void 0&&(e.degree=v,e.start=m),s.appendChild(y),this.refresh(e,v,m,r,n,p,d,l,h,c)}else{var y=r.renderer.drawPath(n);y.setAttribute("role",i.accessibility.accessibilityRole?i.accessibility.accessibilityRole:"img"),y.setAttribute("tabindex",e.index===0&&i.accessibility.focusable?String(i.accessibility.tabIndex):"-1"),y.style.outline="none",y.setAttribute("stroke-linejoin","round"),y.setAttribute("aria-label",i.accessibility.accessibilityDescription?i.accessibility.accessibilityDescription:e.x+": "+e.y+"%. "+i.name),s.appendChild(y),e.degree=v,e.start=m}},t.prototype.findSeries=function(e,i){var r=3,n=2,s=this.innerRadius===0?this.radius+r:this.innerRadius-r,a=this.innerRadius===0?s+n:s-n;this.toggleInnerPoint(e,s,a,i)},t.prototype.toggleInnerPoint=function(e,i,r,n){var s=e.target,a=Fc(s.id,!0),l=e.target.id.substring(0,e.target.id.indexOf("Series")-1),h=document.getElementById(this.accumulation.element.id+"PointHover_Border"),c,u=this.accumulation.visibleSeries[0].points,d=a.series,p=a.point,f=fe(l+"_Series_"+d+"_Point_"+p);if(!isNaN(a.series)&&f){if(!g(d)&&!isNaN(d)&&!g(p)&&!isNaN(p)){var v=this.accumulation.visibleSeries[0].points[p],m=f.getAttribute("class")===l+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,y=this.getPathArc(this.accumulation.pieSeriesModule.center,v.startAngle%360,(v.startAngle+v.degree)%360,i,r,n,!0,u);h&&l===this.accumulation.element.id&&(h.getAttribute("d")!==y||v.isExplode)&&(h.parentNode.removeChild(h),h=null);var b=fe(l+"_Series_"+d);if(!h&&(!v.isExplode||v.isExplode&&e.type!=="click")){var S=new Rr(l+"PointHover_Border",v.color,1,v.color,m,"",y);if(c=this.accumulation.renderer.drawPath(S),c.removeAttribute("transform"),this.accumulation.selectionMode!=="None"&&e.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(c,e.target.getAttribute("class")),b.appendChild(c),v.isExplode&&c){var C=f.getAttribute("transform");C&&c.setAttribute("transform",C)}}}}else h&&(this.removeBorder(h,1e3),h=null)},t.prototype.removeBorder=function(e,i){e&&setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},i)},t.prototype.refresh=function(e,i,r,n,s,a,l,h,c,u){var d=this,p=fe(s.id),f=n.duration?n.duration:300;new Mt({}).animate(et("div"),{duration:f,delay:0,progress:function(v){var m=Ur(v.timeStamp,e.degree,i-e.degree,v.duration),y=Ur(v.timeStamp,e.start,r-e.start,v.duration);if(y=(y/(Math.PI/180)+360)%360,h&&c){var b=Ur(v.timeStamp,h,d.radius-h,v.duration),S=Ur(v.timeStamp,c.x,d.center.x-c.x,v.duration),C=Ur(v.timeStamp,c.y,d.center.y-c.y,v.duration);p.setAttribute("d",d.getPathOption(e,m,y,a,l,b,S,C))}else p.setAttribute("d",d.getPathOption(e,m,y,a,l));e.isExplode&&n.accBaseModule.explodePoints(e.index,n,!0,u),p.style.visibility="visible"},end:function(){p.style.visibility=e.visible?"visible":"hidden",p.setAttribute("d",s.d),e.degree=i,e.start=r}})},t.prototype.getPathOption=function(e,i,r,n,s,a,l,h){if(!i)return"";var c=this.getPathArc(l?{x:l,y:h}:this.center,r%360,(r+i)%360,this.isRadiusMapped?zi(e.sliceRadius,this.size/2):a||this.radius,this.innerRadius,n,!1,s);return this.startAngle+=i,c},t.prototype.animateSeries=function(e,i,r,n,s,a){var l=e.element.id+"SeriesGroup"+r.index;if((r.animation.enable&&Yt!=="Disable"||Yt==="Enable")&&e.animateSeries){var h=e.renderer.createClipPath({id:l+"_clipPath"}),c=new Rr(l+"_slice","transparent",1,"transparent",1,"",""),u=e.renderer.drawPath(c);h.appendChild(u),e.svgObject.appendChild(h),n.style.cssText="clip-path:url(#"+h.id+"); -webkit-clip-path:url(#"+h.id+");",this.doAnimation(u,r,n,s,a)}},t.prototype.getModuleName=function(){return"PieSeries"},t.prototype.destroy=function(){},t})(uY),pY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),yt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},oM=(function(o){pY(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.currentLegendIndex=0,r.currentPointIndex=0,r.previousTargetId="",r.isLegendClicked=!1,r.chartid=57724,r}return t.prototype.animate=function(e){this.duration=e===0&&Yt==="Enable"?700:e,this.animateselected=!0,this.animateSeries=!1;var i=0,r=[],n=[],s=[],a=this.visibleSeries[0],l=[];if(l=a.dataSource,a.sumOfPoints=0,a.points.length<Object.keys(a.dataSource).length)this.refresh();else if(a.points.length>Object.keys(a.dataSource).length){var h=this.visibleSeries[0];h.points=h.points.filter(function(p){return p.visible=!1,n.push(p.index),r.push(p.color),l.some(function(f){var v=f;return p.x===v.x&&(p.visible=!0,s.push(p.index),p.index=i,i++),p.x===v.x})});for(var c=n.filter(function(p){return s.indexOf(p)<0}),u=n.length-c.length,d=n.length-1;d>=u;d--)zt("container_Series_0_Point_"+n[d]);for(var d=0;d<h.points.length;d++)h.points[d].y=h.dataSource[d].y,h.points[d].color=r[d],h.sumOfPoints+=h.dataSource[d].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(var d=0;d<a.points.length;d++)a.points[d].y=a.dataSource[d][a.yName],a.points[d].color=a.dataSource[d][a.pointColorMapping]!=null?a.dataSource[d][a.pointColorMapping]:a.points[d].color,a.sumOfPoints+=a.dataSource[d][a.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(a.points),this.renderElements()}},Object.defineProperty(t.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),t.prototype.preRender=function(){if(this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,this.element.id===""){for(var e=document.getElementsByClassName("e-accumulationchart").length,i="acc_chart_"+this.chartid+"_"+e;document.getElementById(i);)e++,i="acc_chart_"+this.chartid+"_"+e;this.element.id="acc_chart_"+this.chartid+"_"+e}this.wireEvents(),this.element.setAttribute("dir",this.enableRtl?"rtl":"ltr"),this.element.style.outline="none"},t.prototype.setTheme=function(){this.themeStyle=MO(this.theme,!1,this)},t.prototype.render=function(){var e=this;this.element.className.indexOf("e-accumulationchart")===-1&&this.element.classList.add("e-accumulationchart"),this.element.setAttribute("role",this.accessibility.accessibilityRole?this.accessibility.accessibilityRole:"region"),this.element.setAttribute("tabindex",this.accessibility.focusable?String(this.accessibility.tabIndex):"-1"),this.element.setAttribute("aria-label",this.accessibility.accessibilityDescription?this.accessibility.accessibilityDescription:this.title+". Syncfusion interactive chart."),this.element.setAttribute("class",this.element.getAttribute("class")+" e-accumulationchart-focused");var i={chart:this,accumulation:this,theme:this.theme,name:nb,cancel:!1};this.trigger(nb,i,function(){e.setTheme(),e.accBaseModule=new aM(e),e.pieSeriesModule=new ub(e),e.calculateVisibleSeries(),e.processData(),e.renderComplete(),e.allowServerDataBinding=!0})},t.prototype.unWireEvents=function(){var e=j.isPointer,i=j.touchStartEvent,r=j.touchMoveEvent,n=j.touchEndEvent,s=e?"pointerleave":"mouseleave";T.remove(this.element,r,this.accumulationMouseMove),T.remove(this.element,n,this.accumulationMouseEnd),T.remove(this.element,i,this.accumulationMouseStart),T.remove(this.element,"click",this.accumulationOnMouseClick),T.remove(this.element,"dblclick",this.accumulationOnDoubleClick),T.remove(this.element,"contextmenu",this.accumulationRightClick),T.remove(this.element,s,this.accumulationMouseLeave),T.remove(this.element,"keydown",this.accumulationChartKeyDown),T.remove(document.body,"keydown",this.documentKeyHandler),T.remove(this.element,"keyup",this.accumulationChartKeyUp),window.removeEventListener(j.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},t.prototype.wireEvents=function(){if(this.element){var e=j.isPointer,i=j.touchStartEvent,r=j.touchEndEvent,n=j.touchMoveEvent,s=e?"pointerleave":"mouseleave";T.add(this.element,n,this.accumulationMouseMove,this),T.add(this.element,r,this.accumulationMouseEnd,this),T.add(this.element,i,this.accumulationMouseStart,this),T.add(this.element,"click",this.accumulationOnMouseClick,this),T.add(this.element,"dblclick",this.accumulationOnDoubleClick,this),T.add(this.element,"contextmenu",this.accumulationRightClick,this),T.add(this.element,s,this.accumulationMouseLeave,this),T.add(this.element,"keydown",this.accumulationChartKeyDown,this),T.add(document.body,"keydown",this.documentKeyHandler,this),T.add(this.element,"keyup",this.accumulationChartKeyUp,this),this.accumulationResizeBound=this.accumulationResize.bind(this),window.addEventListener(j.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound),new jr(this.element),this.setStyle(this.element)}},t.prototype.setMouseXY=function(e){var i,r,n=fe(this.element.id+"_svg");if(n&&this.element){var s=n.getBoundingClientRect(),a=this.element.getBoundingClientRect();if(e.type.indexOf("touch")>-1){this.isTouch=!0;var l=e;r=l.changedTouches[0].clientY,i=l.changedTouches[0].clientX}else this.isTouch=e.pointerType==="touch"||e.pointerType==="2",i=e.clientX,r=e.clientY;this.mouseY=r-a.top-Math.max(s.top-a.top,0),this.mouseX=i-a.left-Math.max(s.left-a.left,0)}},t.prototype.accumulationMouseEnd=function(e){return this.setMouseXY(e),this.trigger(lO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e)),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(e),this.notify(j.touchEndEvent,e),!1},t.prototype.accumulationMouseStart=function(e){return this.setMouseXY(e),this.trigger(oO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.accumulationResize=function(){var e=this;this.animateSeries=!1;var i={accumulation:this,previousSize:new Wt(this.availableSize.width,this.availableSize.height),name:ob,currentSize:new Wt(0,0),chart:this},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(hO,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(e.isDestroyed){clearTimeout(e.resizeTo);return}xO(e),i.currentSize=e.availableSize,e.trigger(ob,i),e.refreshSeries(),e.refreshChart()},500)),!1},t.prototype.print=function(e){var i=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="";var r=new NO(this);r.print(e),document.getElementById(this.element.id+"_Series_0").style.clipPath=i},t.prototype.export=function(e,i){this.exportModule&&(this.exportModule.export(e,i),this.afterExport&&this.exportModule.getDataUrl(this))},t.prototype.setStyle=function(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block",e.style.overflow="hidden",e.style.height=e.style.height||this.height&&this.height.indexOf("%")===-1?e.style.height:"inherit",this.theme},t.prototype.setAnnotationValue=function(e,i){var r=this.annotations[e],n,s=fe(this.element.id+"_Annotation_Collections");i&&(r.content=i,s?(n=this.createElement("div"),zt(this.element.id+"_Annotation_"+e),this.annotationModule.processAnnotation(r,e,n),s.appendChild(n.children[0])):this.annotationModule.renderAnnotations(fe(this.element.id+"_Secondary_Element")))},t.prototype.accumulationMouseMove=function(e){return fe(this.element.id+"_svg")&&(this.setMouseXY(e),this.trigger(tO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(sO,e.target,e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY),this.centerLabel.hoverTextFormat&&this.updateCenterLabel(e),this.isTouch||this.titleTooltip(e,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&this.type==="Pie"&&this.pieSeriesModule&&Pi(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(e,this.series[0].borderRadius),this.notify(j.touchMoveEvent,e)),!1},t.prototype.titleTooltip=function(e,i,r,n){var s=e.target.id,a=s===this.element.id+"_title"||s===this.element.id+"_subTitle"||s===this.element.id+"_chart_legend_title";if(e.target.textContent.indexOf("...")>-1&&a){var l=s===this.element.id+"_title"?this.title:s===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title;pd(l,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",fe(this.element.id+"_Secondary_Element"),n)}else zt(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.accumulationChartKeyDown=function(e){var i="";return this.tooltip.enable&&(e.code==="Tab"&&this.previousTargetId.indexOf("Series")>-1||e.code==="Escape")&&(i="ESC"),e.code.indexOf("Arrow")>-1&&e.preventDefault(),e.ctrlKey&&e.key==="p"&&(e.preventDefault(),i="CtrlP"),i!==""&&this.chartKeyboardNavigations(e,e.target.id,i),e.code==="Tab"&&this.removeNavigationStyle(),!1},t.prototype.accumulationChartKeyUp=function(e){var i="",r=e.target.id,n=fe(this.element.id+"_chart_legend_translate_g"),s=fe(this.element.id+"_chart_legend_pageup");if(n){var a=n.firstElementChild,l=a.getAttribute("class");l&&l.indexOf("e-accumulationchart-focused")===-1?l=l+" e-accumulationchart-focused":l||(l="e-accumulationchart-focused"),a.setAttribute("class",l)}if(s&&s.setAttribute("class","e-accumulationchart-focused"),this.removeNavigationStyle(),e.code==="Tab"){if(this.previousTargetId!=="")if(this.previousTargetId.indexOf("_Point_")>-1&&r.indexOf("_Point_")===-1){var h=document.getElementById(this.previousTargetId).parentElement;this.setTabIndex(h.children[this.currentPointIndex],h.firstElementChild),this.currentPointIndex=0}else this.previousTargetId.indexOf("_chart_legend_page")>-1&&r.indexOf("_chart_legend_page")===-1&&r.indexOf("_chart_legend_g_")===-1?this.setTabIndex(e.target,s):this.previousTargetId.indexOf("_chart_legend_g_")>-1&&r.indexOf("chart_legend_g_")===-1&&n&&this.setTabIndex(n.children[this.currentLegendIndex],n.firstElementChild);this.previousTargetId=r,r.indexOf("_chart_legend_g_")>-1&&this.highlightMode!=="None"?(r=e.target.lastElementChild.id,i="Tab"):r.indexOf("_Point_")>-1&&(this.highlightMode!=="None"||this.tooltip.enable)&&(i="Tab")}else if(e.code.indexOf("Arrow")>-1){if(e.preventDefault(),r.indexOf("_chart_legend_page")>-1)e.target.removeAttribute("tabindex"),this.previousTargetId=r=this.element.id+"_chart_legend_page"+(e.code==="ArrowRight"?"up":"down"),this.focusTarget(fe(r));else if(r.indexOf("_chart_legend_")>-1&&n){e.target.removeAttribute("tabindex"),this.currentLegendIndex+=e.code==="ArrowUp"||e.code==="ArrowRight"?1:-1,this.currentLegendIndex=this.getActualIndex(this.currentLegendIndex,n.children.length);var c=n.children[this.currentLegendIndex];this.focusTarget(c),this.removeNavigationStyle(),this.setNavigationStyle(c.id),this.previousTargetId=r=c.lastElementChild.id,i=this.highlightMode!=="None"?"ArrowMove":""}else if(r.indexOf("_Point_")>-1){e.target.setAttribute("tabindex","-1"),this.currentPointIndex+=e.code==="ArrowUp"||e.code==="ArrowRight"?1:-1;for(var u=0,d=0;d<e.target.parentElement.children.length;d++)u=e.target.parentElement.children[d].id.indexOf("_Point_")>-1?u+1:u;this.currentPointIndex=this.getActualIndex(this.currentPointIndex,u),r=this.element.id+"_Series_0_Point_"+this.currentPointIndex,this.focusTarget(fe(r)),this.removeNavigationStyle(),this.setNavigationStyle(r),i=this.tooltip.enable?"ArrowMove":""}}else(e.code==="Enter"||e.code==="Space")&&(r.indexOf("_chart_legend_")>-1||r.indexOf("_Point_")>-1)&&(r=r.indexOf("_chart_legend_g")>-1?e.target.lastElementChild.id:r,i="Enter");return i!==""&&this.chartKeyboardNavigations(e,r,i),e.code==="Tab"&&this.setNavigationStyle(r),!1},t.prototype.setTabIndex=function(e,i){e&&e.removeAttribute("tabindex"),i&&i.setAttribute("tabindex","0")},t.prototype.getActualIndex=function(e,i){return e>i-1?0:e<0?i-1:e},t.prototype.focusTarget=function(e){var i=e.getAttribute("class");return e.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i=i+" e-accumulationchart-focused":i||(i="e-accumulationchart-focused"),e.setAttribute("tabindex","0"),e.setAttribute("class",i),e.focus(),e.id},t.prototype.documentKeyHandler=function(e){e.altKey&&e.keyCode===74&&!g(this.element)&&this.element.focus()},t.prototype.setNavigationStyle=function(e){var i=document.getElementById(e);i&&(i.style.setProperty("outline",this.focusBorderWidth+"px solid "+(this.focusBorderColor||this.themeStyle.tabColor)),i.style.setProperty("margin",this.focusBorderMargin+"px"))},t.prototype.removeNavigationStyle=function(){var e=document.querySelectorAll("path[id*=_Series_0_Point_], [id*="+this.element.id+"], [id*=_ChartBorder], text[id*=_title],g[id*=_chart_legend]");e&&e.forEach(function(i){(i instanceof HTMLElement||i instanceof SVGElement)&&(i.style.setProperty("outline","none"),i.style.setProperty("margin",""))})},t.prototype.chartKeyboardNavigations=function(e,i,r){switch(this.isLegendClicked=!1,r){case"Tab":case"ArrowMove":if(this.accumulationHighlightModule,i.indexOf("_Point_")>-1){var n=+i.split("_Series_")[1].split("_Point_")[0],s=+i.split("_Series_")[1].replace("_Symbol","").split("_Point_")[1],a=this.visibleSeries[n].points[s].symbolLocation;if(this.mouseX=a.x+this.initialClipRect.x,this.mouseY=a.y+this.initialClipRect.y,this.accumulationHighlightModule){var l=fe(i);if(!g(l)){if(l.id.indexOf("text")>1&&(l=fe(l.id.replace("text","shape"))),l.hasAttribute("class")&&l.getAttribute("class").indexOf("highlight")>-1)return;this.accumulationHighlightModule.calculateSelectedElements(this,l,"mousemove");return}}if(this.accumulationTooltipModule){var h=this.visibleSeries[n],c=void 0;h.enableTooltip&&(c=new Jf(h.points[s],h)),this.accumulationTooltipModule.renderSeriesTooltip(this,c)}}if(this.accumulationHighlightModule&&this.highlightMode!=="None"){i=i.indexOf("_chart_legend_g_")>-1?document.getElementById(i).firstChild.id:i;for(var u=this.element.id+"_chart_legend",d=[u+"_text_",u+"_shape_marker_",u+"_shape_"],p=0;p<d.length;p++){var f=d[p];if(i.indexOf(f)>-1){document.getElementById(i).setAttribute("class",""),this.accumulationHighlightModule.legendSelection(this,0,parseInt(i.split(f)[1],10),fe(i),"mousemove");break}}}break;case"Enter":case"Space":i.indexOf("_chart_legend_")>-1&&this.accumulationLegendModule?(this.isLegendClicked=!0,this.accumulationLegendModule.click(e),this.focusChild(document.getElementById(i).parentElement),this.setNavigationStyle(document.getElementById(i).parentElement.id)):(this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,document.getElementById(i),"click"),this.setNavigationStyle(i));break;case"CtrlP":this.print();break;case"ESC":this.accumulationTooltipModule&&this.accumulationTooltipModule.removeTooltip(1);break}},t.prototype.focusChild=function(e){e.setAttribute("tabindex","0");var i=e.getAttribute("class");return e.setAttribute("tabindex","0"),i&&i.indexOf("e-accumulationchart-focused")===-1?i="e-accumulationchart-focused "+i:i||(i="e-accumulationchart-focused"),e.setAttribute("class",i),e.focus(),e.id},t.prototype.accumulationOnDoubleClick=function(e){return this.trigger(rO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.accumulationOnMouseClick=function(e){return this.setMouseXY(e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(e),this.selectionMode!=="None"&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,e.target,e.type),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(e),this.enableBorderOnMouseMove&&this.pieSeriesModule&&this.type==="Pie"&&this.pieSeriesModule.findSeries(e,this.series[0].borderRadius),this.trigger(iO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent(nO,e.target,e),this.removeNavigationStyle(),!1},t.prototype.triggerPointEvent=function(e,i,r){var n=r,s=Fc(i.id,!0);s.series>=0&&s.point>=0&&this.trigger(e,{series:this.series[s.series],point:this.series[s.series].points[s.point],seriesIndex:s.series,pointIndex:s.point,x:this.mouseX,y:this.mouseY,pageX:n.pageX,pageY:n.pageY})},t.prototype.accumulationRightClick=function(e){return e.buttons===2&&e.pointerType==="touch"?(e.preventDefault(),e.stopPropagation(),!1):!0},t.prototype.accumulationMouseLeave=function(e){this.setMouseXY(e),this.trigger(aO,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify(j.isPointer?"pointerleave":"mouseleave",e);var i=document.getElementById(this.element.id+"PointHover_Border");return i&&(this.pieSeriesModule.removeBorder(i,1e3),i=null),!1},t.prototype.setCulture=function(){this.intl=new Nt},t.prototype.createPieSvg=function(){this.removeSvg(),IO(this)},t.prototype.removeSvg=function(){if(this.redraw)return null;if(zt(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&Qe(this.svgObject)}zt("EJ2_legend_tooltip"),zt("EJ2_datalabel_tooltip"),zt(this.element.id+"PointHover_Border")},t.prototype.createSecondaryElement=function(){var e=oo(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});gt(!1,this.element,e,this.redraw)},t.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var e=0,i=this.series.length;e<i;e++)if(this.series[e].index=e,this.series[e].type===this.type&&this.visibleSeries.length===0){this.visibleSeries.push(this.series[e]);break}},t.prototype.processData=function(e){e===void 0&&(e=!0),this.seriesCounts=0;for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.dataModule=new EO(n.dataSource||this.dataSource,n.query),n.refreshDataManager(this,e)}},t.prototype.refreshChart=function(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),zt("chartmeasuretext")},t.prototype.doGrouppingProcess=function(){var e=this.visibleSeries[0];!g(e.resultData)&&!g(e.lastGroupTo)&&e.lastGroupTo!==e.groupTo&&e.getPoints(e.resultData,this)},t.prototype.calculateBounds=function(){this.initialClipRect=new Le(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];var e=0,i=0,r=0;if(this.title&&(this.titleCollection=gd(this.title,this.titleStyle,this.initialClipRect.width,this.enableRtl,this.themeStyle.chartTitleFont)),e=this.title?Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height*this.titleCollection.length:e,this.subTitle){for(var n=0,s=this.titleCollection;n<s.length;n++){var a=s[n];r=Xe(a,this.titleStyle,this.themeStyle.chartSubTitleFont).width}this.subTitleCollection=gd(this.subTitle,this.subTitleStyle,this.initialClipRect.width,this.enableRtl,this.themeStyle.chartSubTitleFont),i=Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height*this.subTitleCollection.length}var l=this.margin.left+this.border.width,h=this.availableSize.width-l-this.margin.right-this.border.width,c=this.margin.top+this.border.width,u=this.availableSize.height-c-this.border.width-this.margin.bottom,d=i+e;switch(this.titleStyle.position){case"Top":l=0,c=i+e,h=this.margin.right+this.margin.left,u=this.margin.bottom+this.margin.top;break;case"Bottom":u-=d+this.margin.bottom*2;break;case"Left":l+=d,h-=d;break;case"Right":h-=d;break}this.titleStyle.position!=="Top"?this.initialClipRect=new Le(l,c,h,u):this.initialClipRect=dO(this.initialClipRect,new Le(l,c,h,u)),this.calculateLegendBounds()},t.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},t.prototype.renderElements=function(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderCenterLabel(!0),this.renderLegend(),gt(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition();var e=this.series.every(function(i){var r=i.dataSource||[];return r.length===0});e&&!g(this.noDataTemplate)&&this.renderNoDataTemplate(!0),this.trigger("loaded",{accumulation:this,chart:this}),this.animateSeries=!1},t.prototype.setSecondaryElementPosition=function(){var e=fe(this.element.id+"_Secondary_Element");if(e){var i=this.element.getBoundingClientRect(),r=fe(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(r.left-i.left,0)+"px",e.style.top=Math.max(r.top-i.top,0)+"px"}},t.prototype.renderNoDataTemplate=function(e){var i=this.element.querySelector("#"+this.element.id+"_NoDataTemplate_wrapper");if(i&&i.remove(),e){var r=typeof this.noDataTemplate=="function"?this.noDataTemplate():this.noDataTemplate,n=this.enableHtmlSanitizer&&typeof r=="string"?this.sanitize(r):r,s=et("div",{id:this.element.id+"_NoDataTemplate_wrapper"}),a=0,l=this.element.querySelector("#"+this.element.id+"_border");l&&(a=parseFloat(l.getAttribute("stroke-width")));var h=this.availableSize.width-a*2,c=this.availableSize.height-a*2,u=a,d=a,p=0;if(this.title){var f=Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont).height,v=this.subTitle?Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont).height:0,m=this.subTitle?5:0;switch(p=f+v+m,this.titleStyle.position){case"Top":u+=p+10,c-=p+10;break;case"Left":d+=p+10,h-=p+10;break;case"Bottom":c-=p+16;break;case"Right":h-=p+10;break}}s.style.cssText="position: absolute; top: "+u+"px; left: "+d+"px; width: "+h+`px;
                height: `+c+`px; z-index: 1;
            `;var y=fe(this.element.id+"_Secondary_Element");y.appendChild(s),gb(s,null,n,this,null,null,this.element.id+"_NoData")}},t.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(fe(this.element.id+"_Secondary_Element"))},t.prototype.processExplode=function(){if(this.redraw||!this.visibleSeries[0].explode)return null;this.accBaseModule.invokeExplode()},t.prototype.renderSeries=function(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];r.visible&&this[_r(r.type)+"SeriesModule"]&&(this[_r(r.type)+"SeriesModule"].initProperties(this,r),r.renderSeries(this,this.redraw))}},t.prototype.renderBorder=function(){var e=this.border.width,i=new ys(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new Le(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e),0,0,"",this.border.dashArray),r=this.renderer.drawRectangle(i);r.setAttribute("aria-hidden","true"),gt(!1,this.svgObject,r,this.redraw);var n=this.backgroundImage;if(n){var s=new ZI(this.availableSize.height-e,this.availableSize.width-e,n,0,0,this.element.id+"_background","visible","none");gt(!1,this.svgObject,this.renderer.drawImage(s),this.redraw)}},t.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&(this.visibleSeries[0].type==="Pie"&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},t.prototype.processSelection=function(){var e=[];this.accumulationSelectionModule&&this.selectionMode!=="None"&&(e=pe([],this.accumulationSelectionModule.selectedDataIndexes,null,!0),this.accumulationSelectionModule.invokeSelection(this)),this.accumulationHighlightModule&&this.highlightMode!=="None"&&this.accumulationHighlightModule.invokeHighlight(this),e.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=e,this.accumulationSelectionModule.redrawSelection(this))},t.prototype.renderTitle=function(){var e=this.margin;if(!this.title)return null;var i=kc(this.titleStyle.textAlignment,this.enableRtl),r=Xe(this.title,this.titleStyle,this.themeStyle.chartTitleFont),n=20,s=this.margin.top+r.height*3/4,a=this.accumulationLegendModule===void 0?0:this.legendSettings.position==="Top"?this.accumulationLegendModule.legendBounds.height:0,l=this.explodeDistance===0?0:this.explodeDistance,h=a!==0?0:l/2,c=new Le(e.left,0,this.availableSize.width-e.left-e.right,0),u=this.margin.top+r.height*3/4,d=Nc(c,this.titleStyle||this.themeStyle.chartTitleFont),p,f=this.titleStyle.textAlignment,v=Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont);switch(this.titleStyle.position){case"Top":d=Nc(c,this.titleStyle),u=s;break;case"Bottom":d+=i==="start"?this.border.width:i==="end"?this.border.width:0,u=this.availableSize.height-this.margin.bottom-v.height-r.height/2;break;case"Left":d=this.margin.left+r.height*3/4,u=f==="Near"?e.bottom+this.border.width:f==="Far"?this.availableSize.height-e.bottom-this.border.width:this.availableSize.height/2,i=f==="Near"?"end":f==="Far"?"start":"middle",i=this.enableRtl?i==="end"?"start":i==="start"?"end":i:i,p="rotate(-90,"+d+","+u+")";break;case"Right":d=this.availableSize.width-this.margin.right-r.height*3/4,u=f==="Near"?e.bottom+this.border.width:f==="Far"?this.availableSize.height-e.bottom-this.border.width:this.availableSize.height/2,i=f==="Near"?"start":f==="Far"?"end":"middle",i=this.enableRtl?i==="end"?"start":i==="start"?"end":i:i,p="rotate(90,"+d+","+u+")";break;case"Custom":d=this.titleStyle.x,u=this.titleStyle.y,i="middle";break}var m=new bn(this.element.id+"_title",d,u,i,this.titleCollection,p,"auto"),y=this.series[0].type==="Pie"&&this.visibleSeries[0].dataLabel.position==="Outside"&&this.visibleSeries[0].dataLabel.connectorStyle.length?zi(this.visibleSeries[0].dataLabel.connectorStyle.length,this.accBaseModule.radius):0;!this.subTitle&&this.series[0].type!=="Funnel"&&this.series[0].type!=="Pyramid"&&this.titleStyle.position==="Top"&&(m.y=parseInt(this.series[0].radius,10)>=80?m.y:this.accBaseModule.center.y-this.accBaseModule.radius-n-s-a-h-y,this.series[0].type==="Pie"&&(parseInt(this.series[0].radius,10)<80||isNaN(parseInt(this.series[0].radius,10)))&&(m.y=m.y<this.initialClipRect.y-a?this.initialClipRect.y-a:m.y));var b=vn(this.renderer,m,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont);b&&(b.setAttribute("tabindex","0"),b.style.outline="none",b.parentNode.insertBefore(b,this.svgObject.children&&this.svgObject.children[1])),this.subTitle&&this.renderSubTitle(m)},t.prototype.updateCenterLabel=function(e){var i=this.getPieData(e);this.format=i.point==null?"":this.parseFormat(i.point,this.visibleSeries[0],this.centerLabel.hoverTextFormat),this.renderCenterLabel()},t.prototype.getPieData=function(e){var i=Fc(e.target.id,!0);return isNaN(i.series)?new Jf(null,null):new Jf(this.visibleSeries[0].points[i.point],this.visibleSeries[0])},t.prototype.parseFormat=function(e,i,r){for(var n,s,a=RegExp,l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];n=new a("${point."+c+"}","gm"),r=r.replace(n.source,e[c])}for(var u=0,d=Object.keys(Object.getPrototypeOf(i));u<d.length;u++){var c=d[u];n=new a("${series."+c+"}","gm"),s=i[c],r=r.replace(n.source,s)}return r},t.prototype.renderCenterLabel=function(e,i){var r=this;if(!this.centerLabel.text||this.type!=="Pie")return null;var n=[];if(i){var s=fe(this.element.id+"_centerLabel").querySelectorAll("tspan");s.forEach(function(I){n.push({x:I.getAttribute("x"),y:I.getAttribute("y")})})}for(var a=this.series[0],l,h=kc(this.centerLabel.textStyle.textAlignment,this.enableRtl),c=10,u=this.pieSeriesModule.innerRadius?2*this.pieSeriesModule.innerRadius*.7071067:2*this.pieSeriesModule.radius*.7071067,d=(this.format||this.centerLabel.text).split("<br>"),p=Xe(d[0],this.centerLabel.textStyle,this.themeStyle.chartTitleFont),f=d.length,v=0;v<f;v++){var m=Xe(d[v],this.centerLabel.textStyle,this.themeStyle.chartTitleFont);m.width>u&&d.splice.apply(d,[v,1].concat(El(d[v],u,this.centerLabel.textStyle,this.enableRtl,null,null,this.themeStyle.chartTitleFont)))}p.height*d.length>u?l=this.accBaseModule.center.y+(p.height+c)/2-u/2:a.startAngle&&a.endAngle&&Math.abs(a.endAngle-a.startAngle)===180?(l=this.accBaseModule.center.y-p.height*d.length/2+(p.height+c)/2-this.pieSeriesModule.innerRadius/2+(this.pieSeriesModule.innerRadius?c:0),p.height*d.length+this.pieSeriesModule.innerRadius/2+c>u&&(l=this.accBaseModule.center.y+(p.height+c)/2-u/2)):l=d.length>1?this.accBaseModule.center.y-p.height*d.length/2+(p.height+c)/2:this.accBaseModule.center.y+p.height/4;for(var y=new bn(this.element.id+"_centerLabel",(this.series[0].animation.enable&&Yt!=="Disable"||Yt==="Enable")&&e?this.pieSeriesModule.center.x-1:this.pieSeriesModule.center.x,l,h,"","","auto"),b=vn(this.renderer,y,this.centerLabel.textStyle,this.centerLabel.textStyle.color||this.themeStyle.chartTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartTitleFont),S=[],v=0;v<d.length;v++){var C={x:y.x,y:y.y+v*p.height,fill:""},x=this.renderer.createTSpan(C,"");x.style.fontFamily="inherit",x.style.fontStyle="inherit",x.style.fontSize="inherit",x.style.fontWeight=d[v].indexOf("<b>")>-1||d[v].indexOf("</b>")>-1?"bold":"inherit",x.textContent=d[v].replace(/<\/?b>/g,""),b.appendChild(x),S.push(x)}i&&S.forEach(function(I,D){r.animateTspan(I,Number(n[D].x),Number(n[D].y),Number(I.getAttribute("x")),Number(I.getAttribute("y")),r.duration)}),e&&(this.series[0].animation.enable&&Yt!=="Disable"||Yt==="Enable")&&this.animateSeries&&this.centerLabelDelay(b)},t.prototype.animateTspan=function(e,i,r,n,s,a){new Mt({}).animate(e,{duration:a,progress:function(l){e.style.animation="";var h=l.timeStamp/l.duration,c=i+(n-i)*h,u=r+(s-r)*h;e.setAttribute("x",c.toString()),e.setAttribute("y",u.toString())},end:function(){e.setAttribute("x",n.toString()),e.setAttribute("y",s.toString())}})},t.prototype.centerLabelDelay=function(e){e.style.visibility="hidden";var i=new Mt({});i.animate(e,{delay:this.duration?this.duration:this.series[0].animation.duration,progress:function(r){r.element.style.visibility="visible"}})},t.prototype.renderSubTitle=function(e){for(var i=0,r=0,n=10,s=this.titleStyle.textAlignment,a=Xe(this.subTitle,this.subTitleStyle,this.themeStyle.chartSubTitleFont),l=0,h=this.titleCollection;l<h.length;l++){var c=h[l];r=Xe(c,this.titleStyle,this.themeStyle.chartSubTitleFont).width,i=r>i?r:i}var u=new Le(s==="Center"?e.x-i/2:s==="Far"?e.x-i:e.x,0,i,0);this.titleStyle.position==="Left"&&(u.x=s==="Center"?e.x-i*.5:s==="Far"?this.margin.left+a.height*3/4:e.x-i);var d=new bn(this.element.id+"_subTitle",Nc(u,this.subTitleStyle),e.y*e.text.length+a.height*3/4+n,kc(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,e.transform,"auto");vn(this.renderer,d,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartSubTitleFont.color,this.svgObject,!1,this.redraw,null,null,null,null,null,null,null,null,this.themeStyle.chartSubTitleFont)},t.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},t.prototype.refreshSeries=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];this.refreshPoints(r.points)}},t.prototype.refreshPoints=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n.labelPosition=null,n.labelRegion=null,n.labelVisible=!0}},t.prototype.getModuleName=function(){return"accumulationchart"},t.prototype.destroy=function(){if(this.element){this.unWireEvents(),o.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.element.classList.remove("e-accumulationchart-focused");var e=document.getElementById(this.element.id+"Keyboard_accumulationchart_focus");e&&e.remove(),zt("chartmeasuretext"),this.removeSvg();var i=document.getElementById(this.element.id+"_ej2_chart_highlight");i&&i.remove();var r=document.getElementById(this.element.id+"_ej2_chart_selection");r&&r.remove(),this.svgObject=null}},t.prototype.requiredModules=function(){var e=[],i=!1;return e.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&e.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&e.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&e.push({member:"AccumulationTooltip",args:[this]}),this.selectionMode!=="None"&&e.push({member:"AccumulationSelection",args:[this]}),this.highlightMode!=="None"&&e.push({member:"AccumulationHighlight",args:[this]}),(this.enableExport||this.allowExport)&&e.push({member:"Export",args:[this]}),i=this.annotations.some(function(r){return r.content!==null}),i&&e.push({member:"Annotation",args:[this]}),e},t.prototype.findDatalabelVisibility=function(){for(var e=0,i=this.series;e<i.length;e++){var r=i[e];if(r.dataLabel.visible)return!0}return!1},t.prototype.changeVisibleSeries=function(e,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},t.prototype.getPersistData=function(){return""},t.prototype.sanitize=function(e){return this.enableHtmlSanitizer?Pt.sanitize(e):e},t.prototype.onPropertyChanged=function(e,i){for(var r={refreshElements:!1,refreshBounds:!1},n=0,s=Object.keys(e);n<s.length;n++){var a=s[n];switch(a){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":r.refreshBounds=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"legendSettings":r.refreshBounds=!0,r.refreshElements=!0;break;case"dataSource":this.processData(!1),r.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var l=this.series.length,h=!1,c=void 0,u=0;u<l;u++)c=e.series[u],e.series[u]&&(e.series[u].dataSource||e.series[u].yName||e.series[u].xName||c.type||e.series[u].dataLabel||c.radius||c.innerRadius||c.startAngle||c.endAngle||c.gapRatio||c.neckWidth||c.explode||c.neckWidth||c.pyramidMode||c.explodeOffset||c.funnelMode)&&(pe(this.changeVisibleSeries(this.visibleSeries,u),c,null,!0),h=!0),e.series[u]&&!g(e.series[u].explodeIndex)&&e.series[u].explodeIndex>=0&&e.series[u].explodeIndex!==i.series[u].explodeIndex?(this.accBaseModule.explodePoints(e.series[u].explodeIndex,this),this.accBaseModule.deExplodeAll(e.series[u].explodeIndex,this.enableAnimation?300:0)):e.series[u].explodeIndex<0&&this.accBaseModule.deExplodeAll(e.series[u].explodeIndex,this.enableAnimation?300:0),this.pieSeriesModule||(this.pieSeriesModule=new ub(this));h&&(this.calculateVisibleSeries(),this.processData(!1),r.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"enableRtl":case"locale":case"currencyCode":o.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":r.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&(g(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):(this.accumulationSelectionModule.selectedDataIndexes=this.selectedDataIndexes,this.accumulationSelectionModule.redrawSelection(this)));break;case"tooltip":this.accumulationTooltipModule&&(this.accumulationTooltipModule.previousPoints=[],this.tooltip.template&&(this.accumulationTooltipModule.template=this.tooltip.template));break;case"center":g(e.center.x)||(this.center.x=e.center.x,r.refreshElements=!0),g(e.center.y)||(this.center.y=e.center.y,r.refreshElements=!0);break}}!r.refreshBounds&&r.refreshElements?(this.createPieSvg(),this.renderElements()):r.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},yt([w(null)],t.prototype,"noDataTemplate",void 0),yt([w(null)],t.prototype,"width",void 0),yt([w(null)],t.prototype,"height",void 0),yt([w(null)],t.prototype,"title",void 0),yt([w(null)],t.prototype,"backgroundImage",void 0),yt([Ce({},oY)],t.prototype,"center",void 0),yt([w("")],t.prototype,"dataSource",void 0),yt([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},kR)],t.prototype,"titleStyle",void 0),yt([w(null)],t.prototype,"subTitle",void 0),yt([Ce({fontFamily:null,size:null,fontStyle:null,fontWeight:null,color:null},kR)],t.prototype,"subTitleStyle",void 0),yt([Ce({},AO)],t.prototype,"legendSettings",void 0),yt([Ce({},$R)],t.prototype,"tooltip",void 0),yt([Ce({},Eq)],t.prototype,"centerLabel",void 0),yt([w("None")],t.prototype,"selectionMode",void 0),yt([w("")],t.prototype,"highlightColor",void 0),yt([w("None")],t.prototype,"highlightMode",void 0),yt([w("None")],t.prototype,"selectionPattern",void 0),yt([w("None")],t.prototype,"highlightPattern",void 0),yt([w(!1)],t.prototype,"enableHtmlSanitizer",void 0),yt([w(!0)],t.prototype,"enableBorderOnMouseMove",void 0),yt([w(!1)],t.prototype,"isMultiSelect",void 0),yt([w(!0)],t.prototype,"enableAnimation",void 0),yt([Gt([],JR)],t.prototype,"selectedDataIndexes",void 0),yt([Ce({},vd)],t.prototype,"margin",void 0),yt([w(!0)],t.prototype,"enableSmartLabels",void 0),yt([Ce({color:"#DDDDDD",width:0},qn)],t.prototype,"border",void 0),yt([w(null)],t.prototype,"background",void 0),yt([Gt([{}],lY)],t.prototype,"series",void 0),yt([Gt([{}],sY)],t.prototype,"annotations",void 0),yt([w("Material")],t.prototype,"theme",void 0),yt([w(!1)],t.prototype,"useGroupingSeparator",void 0),yt([w(!0)],t.prototype,"enableExport",void 0),yt([w(!1)],t.prototype,"allowExport",void 0),yt([Ce({},Bo)],t.prototype,"accessibility",void 0),yt([w(null)],t.prototype,"focusBorderColor",void 0),yt([w(1.5)],t.prototype,"focusBorderWidth",void 0),yt([w(0)],t.prototype,"focusBorderMargin",void 0),yt([G()],t.prototype,"loaded",void 0),yt([G()],t.prototype,"legendClick",void 0),yt([G()],t.prototype,"load",void 0),yt([G()],t.prototype,"seriesRender",void 0),yt([G()],t.prototype,"legendRender",void 0),yt([G()],t.prototype,"textRender",void 0),yt([G()],t.prototype,"tooltipRender",void 0),yt([G()],t.prototype,"pointRender",void 0),yt([G()],t.prototype,"annotationRender",void 0),yt([G()],t.prototype,"beforePrint",void 0),yt([G()],t.prototype,"chartMouseMove",void 0),yt([G()],t.prototype,"chartMouseClick",void 0),yt([G()],t.prototype,"chartDoubleClick",void 0),yt([G()],t.prototype,"pointClick",void 0),yt([G()],t.prototype,"pointMove",void 0),yt([G()],t.prototype,"animationComplete",void 0),yt([G()],t.prototype,"chartMouseDown",void 0),yt([G()],t.prototype,"chartMouseLeave",void 0),yt([G()],t.prototype,"chartMouseUp",void 0),yt([G()],t.prototype,"beforeResize",void 0),yt([G()],t.prototype,"resized",void 0),yt([G()],t.prototype,"beforeExport",void 0),yt([G()],t.prototype,"afterExport",void 0),yt([G()],t.prototype,"selectionComplete",void 0),yt([w("USD")],t.prototype,"currencyCode",void 0),t=yt([It],t),t})(ti);var fY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),KO=(function(o){fY(t,o);function t(e){var i=o.call(this,e)||this;return i.legendRenderArgFill=[],i.library=i,i.titleRect=new Le(0,e.margin.top,0,0),i.addEventListener(),i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(j.touchMoveEvent,this.mouseMove,this),this.chart.on(j.touchEndEvent,this.mouseEnd,this),this.chart.on("click",this.click,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(j.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(j.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(e){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&this.chart.accumulationHighlightModule&&this.chart.highlightMode!=="None"){this.chart.legendSettings.toggleVisibility||this.click(e);for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_",this.legendID+"_g_"],r=e.target.id,n=void 0,s=0,a=i;s<a.length;s++){var l=a[s];if(r.indexOf(l)>-1){n=parseInt(r.split(l)[1],10),this.chart.accumulationHighlightModule.legendSelection(this.chart,0,n,e.target,e.type);break}}}},t.prototype.mouseEnd=function(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)},t.prototype.getLegendOptions=function(e,i){this.legendCollections=[],this.isRtlEnable=e.enableRtl,this.isReverse=!this.isRtlEnable&&e.legendSettings.reverse;for(var r=0;r<1;r++){var n=i[r].type;(n==="Pie"||n==="Doughnut")&&(n=i[r].innerRadius!=="0"&&i[r].innerRadius!=="0%"?"Doughnut":"Pie");for(var s=0,a=i[r].points;s<a.length;s++){var l=a[s];!g(l.x)&&!g(l.y)&&this.legendCollections.push(new Ac(e.useGroupingSeparator&&typeof l.x=="number"?e.intl.formatNumber(l.x,{useGrouping:!0}):l.x.toString(),l.color,i[r].legendShape,l.visible,n,l.legendImageUrl,null,null,l.index,i[r].index,null,l.x.toString()))}this.isReverse&&this.legendCollections.reverse()}},t.prototype.getLegendBounds=function(e,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title;var n=0,s=0,a;this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var l=r.padding,h=r.titlePosition,c=0,u=this.arrowWidth,d=r.enablePages?0:this.arrowHeight;this.isVertical?n=r.width?0:e.width/100*5:s=r.height?0:e.height/100*5,i.width+=n,i.height+=s;var p=r.shapePadding,f=r.maximumLabelWidth?r.maximumLabelWidth:0,v=r.shapeWidth,m=0,y=0,b=0,S=[],C=[],x=0,I=0,D=0,M=0,E=0;this.maxItemHeight=Math.max(Xe("MeasureText",r.textStyle,this.chart.themeStyle.legendLabelFont).height,r.shapeHeight);var A,L=!1,N=r.layout==="Auto"&&r.maximumColumns>0;if(r.fixedWidth)for(var R=0;R<this.legendCollections.length;R++){var P=v+p+(this.isVertical||R===0?l:this.itemPadding)+(r.maximumLabelWidth?r.maximumLabelWidth:Xe(this.legendCollections[R].text,r.textStyle,this.chart.themeStyle.legendLabelFont).width);this.maxColumnWidth=this.maxColumnWidth>P?this.maxColumnWidth:P}for(var R=0;R<this.legendCollections.length;R++)if(a=this.legendCollections[R],A={fill:a.fill,text:a.text,shape:a.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",A),a.render=!A.cancel,a.text=a.originalText=A.text.indexOf("&")>-1?this.convertHtmlEntities(A.text):A.text,a.fill!==A.fill&&this.legendRenderArgFill.push(R),a.fill=A.fill,a.shape=A.shape,a.textSize=Xe(a.text,r.textStyle,this.chart.themeStyle.legendLabelFont),a.render&&a.text!=="")if(L=!0,M=r.fixedWidth?this.maxColumnWidth:v+p+(r.maximumLabelWidth?r.maximumLabelWidth:a.textSize.width)+(!this.isVertical||r.layout==="Horizontal"?R===0||y===1&&b>0&&r.layout==="Horizontal"?l:this.itemPadding:l),this.getLegendHeight(a,r,i,m,this.maxItemHeight,l),this.isVertical&&r.layout==="Auto"&&!N)D+=Math.max(a.textSize.height,r.shapeHeight)+(R===0?l:this.itemPadding),D+this.itemPadding+d/this.pageButtonSize>i.height&&(m=m+f,x=this.getPageWidth(C),this.totalPages=Math.max(b,this.totalPages||1),m-x+M>i.width?(C.push(m-x),b=this.rowHeights.length,I=b):b=I,S.push(f),f=0,D=Math.max(a.textSize.height,r.shapeHeight)+l,y++),this.columnHeights[y]=(this.columnHeights[y]?this.columnHeights[y]:0)+Math.max(a.textSize.height,r.shapeHeight)+(R===0?l:this.itemPadding),f=Math.max(M,f),this.rowHeights[b]=Math.max(this.rowHeights[b]?this.rowHeights[b]:0,Math.max(a.textSize.height,r.shapeHeight)),b++;else{r.enablePages||(c=this.isTitle&&h!=="Top"?this.legendTitleSize.width+this.fivePixel:0,c+=u),m=m+M,(N?r.maximumColumns===y:i.width<l+m+c||this.legend.layout==="Vertical"&&y===1)&&(f=Math.max(f,m+l+c-M),b===0&&M!==m&&(b=1),m=M,b++,y=0);var k=b&&b-1;this.rowHeights[k]=Math.max(this.rowHeights[k]?this.rowHeights[k]:0,Math.max(a.textSize.height,r.shapeHeight)),this.columnHeights[y]=(this.columnHeights[y]?this.columnHeights[y]:0)+Math.max(a.textSize.height,r.shapeHeight)+l,N&&this.columnHeights[y]>i.height&&(this.columnHeights[y]-=Math.max(a.textSize.height,r.shapeHeight)+l),y++}E=h==="Top"?this.legendTitleSize.height:0,this.isVertical&&r.layout==="Auto"&&!N?(m=m+f,this.isPaging=i.width<m+l,D=Math.max.apply(null,this.columnHeights)+l+d+E,D=Math.max(D,(this.totalPages||1)*(this.maxItemHeight+l)+l+d),this.isPaging=this.isPaging&&this.totalPages>1,S.push(f)):(this.totalPages=this.totalRowCount=b,D=Math.max.apply(null,this.columnHeights)+l+d+E,this.isPaging=(i.height<D||r.layout==="Horizontal"&&this.rowHeights.length>1)&&!N,D=!r.enablePages&&this.isPaging&&r.layout!=="Vertical"?this.maxItemHeight+l+l+E:D,D=Math.max(D,this.maxItemHeight+l+l+E),r.layout==="Horizontal"&&(D=this.maxItemHeight+l*2+E+this.pageButtonSize+r.border.width),this.isPaging||(m+=this.isTitle&&h!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;var B;N&&this.maxColumnWidth&&r.fixedWidth?(B=this.maxColumnWidth*r.maximumColumns+l,this.isPaging=!1):B=this.isVertical&&r.layout==="Auto"&&!N?this.getMaxColumn(S,i.width,l,m+l):Math.max(m+l,f),L?this.setBounds(B,D,r,i):this.setBounds(0,0,r,i)},t.prototype.getPageWidth=function(e){for(var i=0,r=0;r<e.length;r++)i+=e[r];return i},t.prototype.getLegendHeight=function(e,i,r,n,s,a){var l=e.textSize.width,h=i.shapePadding+a*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":l>i.maximumLabelWidth||l+n>r.width?e.textCollection=El(e.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-h):r.width-h,i.textStyle,this.chart.enableRtl,i.textWrap==="AnyWhere",null,this.chart.themeStyle.legendLabelFont):e.textCollection.push(e.text),e.textSize.height=s*e.textCollection.length;break}},t.prototype.convertHtmlEntities=function(e){var i=e.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","\xA2").replace("&pound;","\xA3").replace("&yen;","\xA5").replace("&euro;","\u20AC").replace("&copy;","\xA9").replace("&reg;","\xAE");return i=i.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","\xA2").replace("&#163;","\xA3").replace("&#165;","\xA5").replace("&#8364;","\u20AC").replace("&#169;","\xA9").replace("&#174;","\xAE"),i},t.prototype.getMaxColumn=function(e,i,r,n){var s=r;this.maxColumnWidth=Math.max.apply(null,e);for(var a=0,l=e;a<l.length;a++){var h=l[a];if(s+=this.maxColumnWidth,this.maxColumns++,s+r>i){s-=this.maxColumnWidth,this.maxColumns--;break}}this.isPaging=s<n&&this.totalPages>1,s===r&&(s=i),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=s;var c=this.maxColumnWidth+r,u=0,d=this.columnHeights.length;if(this.isPaging&&this.isVertical){for(var p=1;p<d;p++)c+=this.maxColumnWidth+r,c>i&&(this.pageHeights.push(u!==p-1?Math.max.apply(null,this.columnHeights.slice(u,p-1)):this.columnHeights[u]),c=this.maxColumnWidth+r,u=p);this.pageHeights.push(u!==d-1?Math.max.apply(null,this.columnHeights.slice(u,d-1)):this.columnHeights[u]),this.totalPages=this.pageHeights.length}return s},t.prototype.getAvailWidth=function(e,i){if(this.isVertical&&this.legend.layout==="Auto"&&!(this.legend.maximumColumns>0))i=this.maxWidth;else if(!this.isVertical&&this.legend.layout!=="Vertical"&&!(this.legend.maximumColumns>0)&&this.isPaging&&!this.legend.enablePages)return i-e-this.fivePixel;return i-(this.legend.padding*2+this.legend.shapeWidth+this.legend.shapePadding)},t.prototype.getRenderPoint=function(e,i,r,n,s,a,l){var h=this.legend.padding,c=n.location.y+this.maxItemHeight/4+(n.textCollection.length>0?(n.textCollection.length-1)*this.maxItemHeight:0);if(this.isVertical&&this.legend.layout==="Auto"&&!(this.legend.maximumColumns>0))if(a===l||c+Math.max(e.textSize.height,this.legend.shapeHeight)+h>s.y+s.height){e.location.x=n.location.x+(a===l?0:this.isRtlEnable?-this.maxColumnWidth:this.maxColumnWidth),e.location.y=i.y;var u=this.legend.shapeWidth/2+h;this.pageXCollections.push(e.location.x+(this.isRtlEnable?u:-u))}else e.location.x=n.location.x,e.location.y=n.location.y+Math.max(n.textSize.height,this.legend.shapeHeight)+this.itemPadding;else{var d=this.legend.fixedWidth?this.maxColumnWidth:r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),p=n.location.x+(this.isRtlEnable?-d:d);(this.legend.layout==="Auto"&&this.legend.maximumColumns>0?a%this.legend.maximumColumns===0:this.isWithinBounds(p,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:e.textSize.width)+r-this.itemPadding,s,this.legend.shapeWidth/2)||this.legend.layout==="Vertical")?(a!==l&&this.chartRowCount++,e.location.y=a===l?n.location.y:n.location.y+this.rowHeights[this.chartRowCount-2]+h,e.location.x=i.x):(e.location.y=n.location.y,e.location.x=a===l?n.location.x:p)}var f=this.getAvailWidth(e.location.x,this.legendBounds.width);f=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,f):f,this.legend.textOverflow==="Ellipsis"&&this.legend.textWrap==="Normal"&&(e.text=Js(+f.toFixed(4),e.text,this.legend.textStyle,this.chart.enableRtl,this.chart.themeStyle.legendLabelFont))},t.prototype.isWithinBounds=function(e,i,r,n){return this.isRtlEnable?e-i<r.x-n:e+i>r.x+r.width+n},t.prototype.getSmartLegendLocation=function(e,i,r){var n;switch(this.position){case"Left":n=(e.x-i.width-r.left)/2,i.x=e.x-i.width<r.left?i.x:e.x-i.width-n;break;case"Right":n=(this.chart.availableSize.width-r.right-(e.x+e.width+i.width))/2,i.x=e.x+e.width+i.width>this.chart.availableSize.width-r.right?i.x:e.x+e.width+n;break;case"Top":this.getTitleRect(this.chart),n=(e.y-i.height-(this.titleRect.y+this.titleRect.height))/2,i.y=e.y-i.height<r.top?i.y:e.y-i.height-n;break;case"Bottom":n=(this.chart.availableSize.height-r.bottom-(e.y+e.height+i.height))/2,i.y=e.y+e.height+i.height>this.chart.availableSize.height-r.bottom?i.y:e.y+e.height+n;break}},t.prototype.getTitleRect=function(e){if(!e.title)return null;var i=Xe(e.title,e.titleStyle,this.chart.themeStyle.legendTitleFont);this.titleRect=new Le(e.availableSize.width/2-i.width/2,e.margin.top,i.width,i.height)},t.prototype.legendByIndex=function(e,i){for(var r=0,n=i;r<n.length;r++){var s=n[r];if(s.pointIndex===e)return s}return null},t.prototype.click=function(e){var i=e.target.id.indexOf("_chart_legend_g_")>-1?e.target.firstChild.id:e.target.id,r=this.chart,n=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];this.chart.animateSeries=!1;for(var s=0,a=n;s<a.length;s++){var l=a[s];if(i.indexOf(l)>-1){var h=parseInt(i.split(l)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(h)){var c=this.chart.visibleSeries[0],u=XO(h,c.points),d=this.legendByIndex(h,this.legendCollections),p={legendText:d.text,legendShape:d.shape,chart:r,series:c,point:u,name:Mh,cancel:!1};if(this.chart.trigger(Mh,p),!p.cancel){u.visible=!u.visible,d.visible=u.visible,c.sumOfPoints+=u.visible?u.y:-u.y,r.redraw=r.enableAnimation,this.sliceVisibility(h,u.visible),r.removeSvg(),this.chart.refreshPoints(c.points),this.chart.calculateBounds();var f=document.getElementById(this.chart.element.id+"PointHover_Border");f&&this.chart.pieSeriesModule.removeBorder(f,0),this.chart.accumulationTooltipModule&&this.chart.accumulationTooltipModule.removeTooltip(0),this.chart.renderElements()}}else this.chart.accumulationSelectionModule&&!isNaN(h)?this.chart.accumulationSelectionModule.legendSelection(this.chart,0,h,e.target,e.type):this.chart.accumulationHighlightModule&&!isNaN(h)&&this.chart.accumulationHighlightModule.legendSelection(this.chart,0,h,e.target,e.type)}}i.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):i.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),r.redraw=!1},t.prototype.sliceVisibility=function(e,i){var r=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(r=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(fe(r+"g_"+e),i))},t.prototype.sliceAnimate=function(e,i){if(!e)return null;new Mt({}).animate(e,{duration:300,delay:0,name:i?"FadeIn":"FadeOut",end:function(r){r.element.style.visibility=i?"visible":"hidden"}})},t.prototype.getModuleName=function(){return"AccumulationLegend"},t.prototype.destroy=function(){this.removeEventListener()},t})(LO),gY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),$O=(function(o){gY(t,o);function t(e){var i=o.call(this,e)||this;return i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=e.element.id+"_datalabel_Series_",i}return t.prototype.getDataLabelPosition=function(e,i,r,n){var s=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(e,i);if(this.accumulation.title){var a=Xe(this.accumulation.title,this.accumulation.titleStyle,this.accumulation.themeStyle.datalabelFont);this.titleRect=new Le(this.accumulation.availableSize.width/2-a.width/2,this.accumulation.margin.top,a.width,a.height)}this.getLabelRegion(e,i.position,r,s,this.marginValue),e.labelAngle=e.midAngle,e.labelPosition=i.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(e,i,r,n)},t.prototype.getLabelRegion=function(e,i,r,n,s,a){a===void 0&&(a=0);var l=a||e.midAngle,h=20,c=Tn(l,n,this.isCircular()?this.center:this.getLabelLocation(e,i));c.y=i==="Inside"?c.y-r.height/2:c.y,c.x=i==="Inside"?c.x-r.width/2:c.x,e.labelRegion=new Le(c.x,c.y,r.width+s*2,r.height+s*2),i==="Outside"&&(e.labelRegion.y-=e.labelRegion.height/2,l>=90&&l<=270?e.labelRegion.x-=e.labelRegion.width+h:e.labelRegion.x+=h)},t.prototype.calculateLabelCollection=function(e,i){if(e.argsData.template!==null)return null;var r=e.labelPosition||i.position,n=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(e,i),s=this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.radius-this.accumulation.pieSeriesModule.innerRadius,a=Tn(e.midAngle,n,this.isCircular()?this.center:this.getLabelLocation(e,r)),l=20,h=i.maxWidth;h||(r==="Outside"?h=this.isCircular()?a.x>=this.center.x?this.areaRect.x+this.areaRect.width-a.x:a.x-this.areaRect.x:a.x>=e.region.x?this.areaRect.x+this.areaRect.width-a.x:a.x-this.areaRect.x:h=this.isCircular()?s-l:e.region.width),e.label.indexOf("<br>")!==-1?e.labelCollection=e.label.split("<br>"):i.textWrap==="Normal"&&i.textOverflow==="Ellipsis"?e.labelCollection[0]=Js(h,e.label,e.argsData.font,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):i.textWrap==="Wrap"||i.textWrap==="AnyWhere"?e.labelCollection=El(e.label,h,e.argsData.font,this.accumulation.enableRtl,i.textWrap==="AnyWhere",i.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont):e.labelCollection[0]=e.label},t.prototype.getTextSize=function(e,i){for(var r=0,n=i.font,s=i.maxWidth?i.maxWidth:0,a,l=0;l<e.length;l++)a=Xe(e[l],n,this.accumulation.themeStyle.datalabelFont),s=Math.max(a.width,s),r+=a.height;return i.textOverflow==="Clip"&&i.textWrap!=="Normal"&&i.maxWidth&&(s=i.maxWidth),new Wt(s,r)},t.prototype.getSmartLabel=function(e,i,r,n){var s=this.isCircular(),a=s?this.radius:this.getLabelDistance(e,i),l=s?i.connectorStyle.length||"4%":"0px";a+=zi(l,a);var h=this.findPreviousPoint(n,e.index,e.labelPosition);if(i.position==="Inside"?(e.labelRegion.height-=4,e.labelRegion.width-=4,(h&&h.labelRegion&&!i.enableRotation&&(ns(e.labelRegion,h.labelRegion)||this.isOverlapping(e,n))||!s&&!d6(e.region,e.labelRegion))&&(e.labelPosition="Outside",s||(a=this.getLabelDistance(e,i)),this.calculateLabelCollection(e,i),r=this.getTextSize(e.labelCollection,i),r.height+=4,r.width+=4,e.textSize=r,this.getLabelRegion(e,e.labelPosition,r,a,this.marginValue),h=this.findPreviousPoint(n,e.index,e.labelPosition),h&&(ns(e.labelRegion,h.labelRegion)||this.isConnectorLineOverlapping(e,h))&&this.setOuterSmartLabel(h,e,i.border.width,a,r,this.marginValue))):h&&h.labelRegion&&(ns(e.labelRegion,h.labelRegion)||this.isOverlapping(e,n)||this.isConnectorLineOverlapping(e,h))&&this.setOuterSmartLabel(h,e,i.border.width,a,r,this.marginValue),this.isOverlapping(e,n)&&(this.accumulation.type==="Pyramid"||this.accumulation.type==="Funnel")){var c="OutsideLeft",u=20,d=e.midAngle||0,p=s?this.radius:this.getLabelDistance(e,i),f=Tn(d,-p,this.isCircular()?this.center:this.getLabelLocation(e,c));e.labelRegion=new Le(f.x,f.y,r.width+this.marginValue*2,r.height+this.marginValue*2),e.labelRegion.y-=e.labelRegion.height/2,e.labelRegion.x=e.labelRegion.x-u-e.labelRegion.width,h&&h.labelRegion&&(ns(e.labelRegion,h.labelRegion)||this.isOverlapping(e,n)||this.isConnectorLineOverlapping(e,h))&&this.setOuterSmartLabel(h,e,i.border.width,p,r,this.marginValue)}},t.prototype.move=function(e,i,r,n){var s=this;if(e.target.textContent.indexOf("...")>-1){var a=e.target.id.split(this.id);if(a.length===2){var l=parseInt(a[1].split("_text_")[0],10),h=parseInt(a[1].split("_text_")[1],10);if(!isNaN(l)&&!isNaN(h)){n&&zt(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");var c=hY(l,this.accumulation.visibleSeries).points[h];pd(c.text||c.y.toString(),i,r,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",fe(this.accumulation.element.id+"_Secondary_Element"),null,null,this.accumulation.initialClipRect)}}}else zt(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");n&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){zt(s.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))},t.prototype.findPreviousPoint=function(e,i,r){for(var n=e[0],s=i-1;s>=0;s--)if(n=e[s],n.visible&&n.labelVisible&&n.labelRegion&&n.labelPosition===r)return n;return null},t.prototype.isOverlapping=function(e,i){for(var r=e.index-1;r>=0;r--)if(i[r].visible&&i[r].labelVisible&&i[r].labelRegion&&e.labelRegion&&e.labelVisible&&ns(e.labelRegion,i[r].labelRegion))return!0;return!1},t.prototype.textTrimming=function(e,i,r,n,s){if(ns(e.labelRegion,i)){var a=e.labelRegion.width;if(n==="Right"?a=i.x-e.labelRegion.x:n==="Left"?(a=e.labelRegion.x-(i.x+i.width),a<0&&(a+=e.labelRegion.width,e.labelRegion.x=i.x+i.width)):n==="InsideRight"?a=i.x+i.width-e.labelRegion.x:n==="InsideLeft"?(a=e.labelRegion.x+e.labelRegion.width-i.x,a<e.labelRegion.width&&(e.labelRegion.x=i.x)):this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(e),e.labelVisible&&e.labelRegion){e.label.indexOf("<br>")!==-1?e.labelCollection=e.label.split("<br>"):a<e.labelRegion.width&&(s.textWrap==="Normal"&&s.textOverflow==="Ellipsis"?e.labelCollection[0]=Js(a-this.marginValue*2,e.label,r,this.accumulation.enableRtl,this.accumulation.themeStyle.datalabelFont):(s.textWrap==="Wrap"||s.textWrap==="AnyWhere")&&(e.labelCollection=El(e.label,a-this.marginValue*2,r,this.accumulation.enableRtl,s.textWrap==="AnyWhere",s.textOverflow==="Clip",this.accumulation.themeStyle.datalabelFont)),e.labelRegion.width=a);for(var l=0;l<e.labelCollection.length;l++)if(e.labelCollection[l].length===3&&e.labelCollection[l].indexOf("...")>-1){this.setPointVisibileFalse(e);break}}}},t.prototype.setPointVisibileFalse=function(e){e.labelVisible=!1,e.labelRegion=null},t.prototype.setPointVisibleTrue=function(e){e.labelVisible=!0},t.prototype.setOuterSmartLabel=function(e,i,r,n,s,a){if(!this.isCircular())this.setSmartLabelForSegments(i,e);else{var l=this.getOverlappedAngle(e.labelRegion,i.labelRegion,i.midAngle,r*2);for(this.getLabelRegion(i,"Outside",s,n,a,l),l>i.endAngle&&(l=i.midAngle),i.labelAngle=l;i.labelVisible&&(ns(e.labelRegion,i.labelRegion)||l<=e.labelAngle||l<=i.midAngle*.9||this.isConnectorLineOverlapping(i,e))&&!(l>i.endAngle);)i.labelAngle=l,this.getLabelRegion(i,"Outside",s,n,a,l),l+=.1}},t.prototype.setSmartLabelForSegments=function(e,i){var r=e.labelRegion,n=this.accumulation.type==="Funnel"?i.labelRegion.y-(r.y+r.height):e.labelRegion.y-(i.labelRegion.y+i.labelRegion.height);n<0&&(e.labelRegion.y+=this.accumulation.type==="Funnel"?n:-n)},t.prototype.isConnectorLineOverlapping=function(e,i){var r;!this.isCircular()&&e.labelRegion.x<e.region.x&&(r="outsideLeft");var n=this.getLabelLocation(e,r),s=new at(0,0);this.getEdgeOfLabel(e.labelRegion,e.labelAngle,s,0,e);var a=this.getLabelLocation(i),l=new at(0,0);return this.getEdgeOfLabel(i.labelRegion,i.labelAngle,l,0,e),this.isLineRectangleIntersect(n,s,e.labelRegion)||this.isLineRectangleIntersect(n,s,i.labelRegion)||this.isLineRectangleIntersect(a,l,e.labelRegion)},t.prototype.isLineRectangleIntersect=function(e,i,r){var n=[new at(Math.round(r.x),Math.round(r.y)),new at(Math.round(r.x+r.width),Math.round(r.y)),new at(Math.round(r.x+r.width),Math.round(r.y+r.height)),new at(Math.round(r.x),Math.round(r.y+r.height))];e.x=Math.round(e.x),e.y=Math.round(e.y),i.x=Math.round(i.x),i.y=Math.round(i.y);for(var s=0;s<n.length;s++)if(this.isLinesIntersect(e,i,n[s],n[(s+1)%n.length]))return!0;return!1},t.prototype.isLinesIntersect=function(e,i,r,n){var s=i.y-e.y,a=e.x-i.x,l=s*e.x+a*e.y,h=n.y-r.y,c=r.x-n.x,u=h*r.x+c*r.y,d=s*c-h*a;if(d!==0){var p=(c*l-a*u)/d,f=(s*u-h*l)/d,v=Math.min(e.x,i.x)<=p&&p<=Math.max(e.x,i.x);return v=v&&Math.min(e.y,i.y)<=f&&f<=Math.max(e.y,i.y),v=v&&Math.min(r.x,n.x)<=p&&p<=Math.max(r.x,n.x),v=v&&Math.min(r.y,n.y)<=f&&f<=Math.max(r.y,n.y),v}return!1},t.prototype.getOverlappedAngle=function(e,i,r,n){var s=e.x;return r>=90&&r<=270?(i.y=e.y-(n+i.height/2),s=e.x+e.width):i.y=e.y+e.height+n,i6(this.center,new at(s,i.y))},t.prototype.getConnectorPath=function(e,i,r,n){n===void 0&&(n=0);var s=r.connectorStyle,a=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],i):this.labelRadius:this.getLabelDistance(i,r),l=this.getConnectorStartPoint(i,s),h=this.accumulation.enableSmartLabels?i.midAngle:n||i.midAngle,c=new at(0,0),u=this.getEdgeOfLabel(e,h,c,s.width,i);if(s.type==="Curve")if(this.isCircular()){var d=a-(this.isVariousRadius()?zi(i.sliceRadius,this.accumulation.pieSeriesModule.size/2):this.radius);return i.isLabelUpdated?c=this.getPerpendicularDistance(l,i):(c=Tn(h,a-d/2,this.center),i.labelPosition==="Outside"&&r.position==="Inside"&&(c=Tn(h,a-d*1.25,this.center))),"M "+l.x+" "+l.y+" Q "+c.x+" "+c.y+" "+u.x+" "+u.y}else return this.getPolyLinePath(l,u);else return"M "+l.x+" "+l.y+" L "+c.x+" "+c.y+" L "+u.x+" "+u.y},t.prototype.getPolyLinePath=function(e,i){var r=[e,i];if(e.y===i.y)return"M "+e.x+" "+e.y+" L "+i.x+" "+i.y;for(var n="M",s=0;s<=16;s++){var a=s/16,l=this.getBezierPoint(a,r,0,2);n+=l.x+","+l.y,s!==16&&(n+=" L")}return n},t.prototype.getBezierPoint=function(e,i,r,n){if(n===1)return i[r];var s=this.getBezierPoint(e,i,r,n-1),a=this.getBezierPoint(e,i,r+1,n-1),l=(s.x,s.x),h=(s.y,s.y),c=(a.x,a.x),u=(a.y,a.y),d=(1-e)*l+e*c,p=(1-e)*h+e*u;return s.x?{x:d,y:p}:{x:d,y:p}},t.prototype.getEdgeOfLabel=function(e,i,r,n,s){n===void 0&&(n=1);var a=new at(e.x,e.y),l=10;return i>=90&&i<=270?(a.x+=e.width+n/2+l,a.y+=e.height/2,r.x=a.x+10,r.y=a.y):s&&s.region&&s.region.x>s.labelRegion.x?(a.x+=n*2+e.width+l,a.y+=e.height/2,r.x=a.x+10,r.y=a.y):(a.x-=l-n/2,a.y+=e.height/2,r.x=a.x-10,r.y=a.y),a},t.prototype.getLabelDistance=function(e,i){if(e.labelPosition&&i.position!==e.labelPosition||i.connectorStyle.length&&i.position==="Outside"){var r=zi(i.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(r<this.accumulation.initialClipRect.width)return r}var n=e.labelPosition||i.position,s=this.accumulation.visibleSeries[0],a=(this.accumulation.initialClipRect.width-s.triangleSize.width)/2,l;switch(n){case"Inside":return 0;case"Outside":return l=e.symbolLocation.x+e.labelOffset.x,this.accumulation.initialClipRect.width-l-a}},t.prototype.getLabelLocation=function(e,i){if(i===void 0&&(i="Outside"),this.accumulation.type!=="Pie"&&this.accumulation.series[0].funnelMode!=="Trapezoidal"){i=i==="OutsideLeft"?"OutsideLeft":e.labelPosition||i;var r={x:e.symbolLocation.x,y:e.symbolLocation.y-e.labelOffset.y};switch(i){case"Inside":r.y=e.region.y+e.region.height/2;break;case"Outside":r.x+=e.labelOffset.x;break;case"OutsideLeft":r.x-=e.labelOffset.x}return r}else if(this.accumulation.series[0].funnelMode==="Trapezoidal"&&this.accumulation.type==="Funnel"){var n={x:e.symbolLocation.x,y:e.symbolLocation.y};return i==="Outside"&&(n.x=e.labelOffset.x),n}else return Tn(e.midAngle,this.isVariousRadius()?zi(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},t.prototype.getConnectorStartPoint=function(e,i){var r;return!this.isCircular()&&e.region.x>e.labelRegion.x&&(r="OutsideLeft"),this.isCircular()?Tn(e.midAngle,(this.isVariousRadius()?zi(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-i.width,this.center):this.getLabelLocation(e,r)},t.prototype.findAreaRect=function(){this.areaRect=new Le(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var e=this.accumulation.margin;zo(this.areaRect,new Po(e.left,e.right,e.top,e.bottom))},t.prototype.renderDataLabel=function(e,i,r,n,s,a,l){var h=this.accumulation.element.id+"_datalabel_Series_"+s+"_",c=this.accumulation.renderer.createGroup({id:h+"g_"+e.index}),u={width:i.border.width,color:i.border.color},d=pe({},V("properties",i.font),null,!0);e.label=this.getDatalabelText(i.format,this.accumulation,e.originalText||e.y.toString());var p={cancel:!1,name:hd,series:this.accumulation.visibleSeries[0],point:e,text:e.label,border:u,color:i.fill,template:this.accumulation.enableHtmlSanitizer?this.accumulation.sanitize(i.template):i.template,font:d};this.accumulation.trigger(hd,p),e.argsData=p;var f=p.template!==null;e.labelVisible=!p.cancel,e.text=e.label=p.text,e.labelCollection=[],this.marginValue=p.border.width?5+p.border.width:1;var v=et("div",{id:this.accumulation.element.id+"_Series_0_DataLabel_"+e.index,styles:"position: absolute;background-color:"+p.color+";"+bO(i.font,this.accumulation.themeStyle.datalabelFont)+";border:"+p.border.width+"px solid "+p.border.color+";"});this.calculateLabelSize(f,v,e,n,p,c,h,i,l)},t.prototype.getDatalabelText=function(e,i,r){if(Number(r)){var n=e.match("{value}")!==null,s=i.intl.getNumberFormat({format:n?"":e,useGrouping:i.useGroupingSeparator});r=n?e.replace("{value}",s(parseFloat(r))):s(parseFloat(r))}return r},t.prototype.calculateLabelSize=function(e,i,r,n,s,a,l,h,c,u,d){this.calculateLabelCollection(r,h);var p=e?d?{width:u.width,height:u.height}:this.getTemplateSize(i,r,s,c,e,n,a,l,h):this.getTextSize(r.labelCollection,h);p.height+=4,p.width+=4,r.textSize=p,r.templateElement=i,this.getDataLabelPosition(r,h,p,n),r.labelRegion&&this.correctLabelRegion(r.labelRegion,r.textSize)},t.prototype.drawDataLabels=function(e,i,r,n,s){var a,l,h=e.leftSidePoints.concat(e.rightSidePoints);h.sort(function(L,N){return L.index-N.index}),e.type==="Pie"&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(var c=0,u=h;c<u.length;c++){var d=u[c];if(!g(d.argsData)&&!g(d.y)){this.finalizeDatalabels(d,h,i);var p=document.getElementById(this.accumulation.element.id+"_Series_0_Point_"+d.index),f=this.accumulation.element.id+"_datalabel_Series_0_",v=this.accumulation.renderer.createGroup({id:f+"g_"+d.index});v.setAttribute("aria-hidden","true");var m=void 0,y=void 0,b=void 0;if(d.visible&&d.labelVisible){if(a=l=i.angle,d.argsData.template)this.setTemplateStyle(d.templateElement,d,n,i.font.color,d.color,s);else{y=new at(d.labelRegion.x+this.marginValue,d.labelRegion.y+d.textSize.height*3/(d.labelCollection.length*4)+this.marginValue),b=fe(f+"shape_"+d.index);var S=b?new at(+b.getAttribute("x"),+b.getAttribute("y")):null,C=d.textSize.width;i.enableRotation?a===0?d.labelPosition==="Outside"?l=0:d.midAngle>=90&&d.midAngle<=260?l=d.midAngle+180:l=d.midAngle:l=a>360?a-360:a<-360?a+360:a:l=0;var x="rotate("+l+","+(y.x+C/2)+","+y.y+")";d.transform=x,m=this.accumulation.renderer.drawRectangle(new ys(f+"shape_"+d.index,d.argsData.color,d.argsData.border,1,d.labelRegion,i.rx,i.ry,x,e.dataLabel.border.dashArray)),gt(!1,v,m,s,!0,"x","y",S,null,!1,!1,null,this.accumulation.duration),vn(this.accumulation.renderer,new bn(f+"text_"+d.index,y.x,y.y,this.accumulation.enableRtl?"end":"start",d.labelCollection,x,"auto",l),d.argsData.font,d.argsData.font.color||this.getSaturatedColor(d,d.argsData.color),v,!1,s,!0,!1,this.accumulation.duration,null,null,null,null,!0,this.accumulation.themeStyle.datalabelFont),b=null}if(p&&this.accumulation.highlightMode!=="None"){v.setAttribute("class",p.getAttribute("class")?p.getAttribute("class"):"");for(var I=0;I<v.children.length;I++){var D=document.getElementById(v.children[I].id);D&&(v.children[I].style.opacity=D.style.opacity)}}if(this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&!this.accumulation.redraw&&(i.position==="Outside"||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,d.labelRegion),d.labelPosition==="Outside"){var M=fe(f+"connector_"+d.index),E=M?M.getAttribute("d"):"",A=this.accumulation.renderer.drawPath(new Rr(f+"connector_"+d.index,"transparent",i.connectorStyle.width,i.connectorStyle.color||d.color,1,i.connectorStyle.dashArray,this.getConnectorPath(pe({},d.labelRegion,null,!0),d,i,d.labelAngle)));gt(!1,v,A,s,!0,null,null,null,E,!1,!1,null,this.accumulation.duration)}gt(!1,r,v,s)}else fe(v.id)&&fe(v.id).parentNode.removeChild(fe(v.id))}}this.accumulation.type==="Pie"&&i.textWrap==="Normal"&&i.textOverflow==="Clip"&&this.dataLabelClipPath(i,r)},t.prototype.dataLabelClipPath=function(e,i){var r=this.accumulation.element.id+"_datalabel_Series_0_",n=this.accumulation.renderer.createClipPath({id:r+"clipPath"}),s,a=this.accumulation.pieSeriesModule.pieBaseRadius;if(e.position==="Inside")s=this.accumulation.renderer.drawCircle(new vb(r+"clipPath_rect","transparent",{width:0},0,this.center.x,this.center.y,a));else if(e.maxWidth){var l=this.center.x-a-zi(e.connectorStyle.length||"4%",a)-e.maxWidth,h=this.center.y-a-zi(e.connectorStyle.length||"4%",a)-e.maxWidth,c=(a+zi(e.connectorStyle.length||"4%",a)+e.maxWidth)*2,u=c;if(this.accumulation.legendSettings.visible){var d=this.accumulation.accumulationLegendModule;d.position==="Left"?(u=d.legendBounds.x+d.legendBounds.width-l>0?u-(d.legendBounds.width-l):u,l=d.legendBounds.x+d.legendBounds.width<l?l:d.legendBounds.x+d.legendBounds.width):d.position==="Right"&&(u=l+u-d.legendBounds.x>0?u-(l+u-d.legendBounds.x):u)}s=this.accumulation.renderer.drawRectangle(new ys(r+"clipPath_rect","transparent",{width:0},0,new Le(l,h,c,u),0,0))}(e.position==="Inside"||e.maxWidth)&&(n.appendChild(s),gt(!1,this.accumulation.svgObject,n),i.style.cssText="clip-path:url(#"+n.id+")")},t.prototype.finalizeDatalabels=function(e,i,r){if((this.isOverlapping(e,i)||this.titleRect&&e.labelRegion&&ns(e.labelRegion,this.titleRect))&&this.isCircular()&&e.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&this.setPointVisibileFalse(e),this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&e.labelVisible&&e.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var n=this.accumulation.accumulationLegendModule.legendBounds;this.accumulation.visibleSeries[0].type!=="Pie"&&this.accumulation.legendSettings.position==="Left"&&r.position==="Outside"&&(e.labelRegion.x=e.labelRegion.x+n.width);var s=this.accumulation.legendSettings.border.width/2;this.textTrimming(e,new Le(n.x-s,n.y-s,n.width+2*s,n.height+2*s),r.font,this.accumulation.accumulationLegendModule.position,r)}if(e.labelVisible&&e.labelRegion&&(!r.maxWidth&&(r.textOverflow!=="Clip"||r.textWrap!=="Normal"))){var a=this.isCircular()?e.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":e.labelRegion.x>=e.region.x?"InsideRight":"InsideLeft";this.textTrimming(e,this.areaRect,r.font,a,r)}e.labelVisible&&e.labelRegion&&!r.maxWidth&&r.textOverflow!=="Clip"&&this.accumulation.enableSmartLabels&&(e.labelRegion.y+e.labelRegion.height/2>this.areaRect.y+this.areaRect.height||e.labelRegion.y<this.areaRect.y||e.labelRegion.x<this.areaRect.x||e.labelRegion.x+e.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(e)},t.prototype.getTemplateSize=function(e,i,r,n,s,a,l,h,c){e=gb(e,i.index,r.template,this.accumulation,i,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,r,s,a,l,h,c,n);var u=SO(e,n);return{width:u.width,height:u.height}},t.prototype.setTemplateStyle=function(e,i,r,n,s,a){e.style.left=i.labelRegion.x+"px",e.style.top=i.labelRegion.y+"px",e.style.color=n||this.getSaturatedColor(i,i.labelPosition==="Inside"?s:this.getLabelBackground(i)),e.childElementCount&&(gt(!1,r,e,a,!0,"left","top"),this.doTemplateAnimation(this.accumulation,e))},t.prototype.getSaturatedColor=function(e,i){var r;this.marginValue>=1?r=i==="transparent"?this.getLabelBackground(e):i:r=this.getLabelBackground(e),r=r==="transparent"?this.accumulation.theme.indexOf("Dark")>-1||this.accumulation.theme.indexOf("HighContrast")>-1?"black":"white":r;var n=eg(_n(r)),s=Math.round((n.r*299+n.g*587+n.b*114)/1e3);return this.accumulation.theme==="Bootstrap5"?"#212529":this.accumulation.theme==="Bootstrap5Dark"?"#DEE2E6":s>=128?this.accumulation.theme.indexOf("Tailwind3")>-1?"#111827":"black":this.accumulation.theme.indexOf("Tailwind3")>-1?"#FFFFFF":"white"},t.prototype.doTemplateAnimation=function(e,i){var r=e.visibleSeries[0],n=r.animation.delay+r.animation.duration;(r.animation.enable&&Yt!=="Disable"||Yt==="Enable")&&e.animateSeries&&(i.style.visibility="hidden",rM(i,n,200,"ZoomIn"))},t.prototype.getLabelBackground=function(e){return e.labelPosition==="Outside"?this.accumulation.background||this.accumulation.themeStyle.background:e.y?e.color:this.accumulation.theme.indexOf("dark")?"white":"black"},t.prototype.correctLabelRegion=function(e,i,r){r===void 0&&(r=4),e.height-=r,e.width-=r,e.x+=r/2,e.y+=r/2,i.height-=r,i.width-=r},t.prototype.getModuleName=function(){return"AccumulationDataLabel"},t.prototype.destroy=function(){},t.prototype.extendedLabelsCalculation=function(){var e=this,i=this.accumulation.series[0];i.rightSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,e.skipPoints(r,s,n)}),i.leftSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,e.skipPoints(r,s,n)}),this.arrangeLeftSidePoints(i),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(i)},t.prototype.arrangeRightSidePoints=function(e){var i,r,n=e.rightSidePoints.filter(function(d){return d.labelVisible&&d.labelPosition==="Outside"});this.rightSideRenderingPoints=n;var s,a,l=n[n.length-1],h;l&&l.labelAngle>90&&l.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(l,89));for(var c=n.length-1;c>=0;c--)if(a=n[c],h=n[c+1],this.isOverlapWithNext(a,n,c)&&a.labelVisible||!(a.labelAngle<=90||a.labelAngle>=270))if(s=l.labelAngle+10,r=!0,i?this.isIncreaseAngle=!1:s>90&&s<270&&h.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(var u=c+1;u>0;u--)this.decreaseAngle(n[u],n[u-1],e,!0);else for(var u=c+1;u<n.length;u++)this.increaseAngle(n[u-1],n[u],e,!0);else r&&h&&!h.isLabelUpdated&&(i=!0)},t.prototype.arrangeLeftSidePoints=function(e){var i=this,r=e.leftSidePoints.filter(function(u){return u.labelVisible&&u.labelPosition==="Outside"});this.leftSideRenderingPoints=r;for(var n,s,a,l,h=0;h<r.length;h++)if(s=r[h],n=r[h-1],this.isOverlapWithPrevious(s,r,h)&&s.labelVisible||!(s.labelAngle<270))if(a=!0,l&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(var c=h;c<r.length;c++)this.increaseAngle(r[c-1],r[c],e,!1);else for(var c=h;c>0;c--)this.decreaseAngle(r[c],r[c-1],e,!1),r.filter(function(u,d){u.isLabelUpdated&&r[d].labelAngle-10<100&&(i.isIncreaseAngle=!0)});else a&&n&&n.isLabelUpdated&&(l=!0)},t.prototype.decreaseAngle=function(e,i,r,n){if(g(e)||g(i))return null;var s=1;if(n)for(;ns(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(i.labelRegion.height+i.labelRegion.y<e.labelRegion.y);){var a=i.midAngle-s;if(a<0&&(a=360+a),a<=270&&a>=90){a=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(i,a),s++}else for(e.labelAngle>270&&(this.changeLabelAngle(e,270),i.labelAngle=270);ns(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y+e.labelRegion.height>i.labelRegion.y;){var a=i.midAngle-s;if(!(a<=270&&a>=90)){a=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,a),ns(e.labelRegion,i.labelRegion)&&!r.leftSidePoints.indexOf(i)&&a-1<90&&a-1>270){this.changeLabelAngle(e,e.labelAngle+1),this.arrangeLeftSidePoints(r);break}s++}},t.prototype.increaseAngle=function(e,i,r,n){if(g(e)||g(i))return null;var s=1;if(n)for(;ns(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(e.labelRegion.y+e.labelRegion.height<i.labelRegion.y);){var a=i.midAngle+s;if(a<270&&a>90){a=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,a),ns(e.labelRegion,i.labelRegion)&&a+1>90&&a+1<270&&this.rightSideRenderingPoints.indexOf(i)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(e,e.labelAngle-1),i.labelRegion=i.initialLabelRegion,this.arrangeRightSidePoints(r);break}if(s>360)break;s++}else for(;ns(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y<i.labelRegion.y+i.labelRegion.height;){var a=i.midAngle+s;if(!(a<270&&a>90)){a=270,this.isIncreaseAngle=!1;break}if(this.changeLabelAngle(i,a),s>360)break;s++}},t.prototype.changeLabelAngle=function(e,i){var r=this.accumulation.series[0].dataLabel,n;this.isVariousRadius()&&(n=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e));var s=e.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&r.position==="Inside"?this.radius+zi(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?n:this.accumulation.pieSeriesModule.labelRadius+10,a=this.isVariousRadius()?n:s;this.getLabelRegion(e,"Outside",e.textSize,a,this.marginValue,i),e.isLabelUpdated=1,e.labelAngle=i},t.prototype.isOverlapWithPrevious=function(e,i,r){for(var n=0;n<r;n++)if(n!==i.indexOf(e)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&e.labelRegion&&e.labelVisible&&ns(e.labelRegion,i[n].labelRegion))return!0;return!1},t.prototype.isOverlapWithNext=function(e,i,r){for(var n=r;n<i.length;n++)if(n!==i.indexOf(e)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&e.labelRegion&&e.labelVisible&&ns(e.labelRegion,i[n].labelRegion))return!0;return!1},t.prototype.skipPoints=function(e,i,r){if(r>0&&(e.midAngle<285&&e.midAngle>255||e.midAngle<105&&e.midAngle>75)){var n=i[r-1],s=e.endAngle%360-e.startAngle%360,a=n.endAngle%360-n.startAngle%360;a<=s&&s<5&&n.labelVisible&&this.setPointVisibleTrue(e)}else if(r>1&&(e.midAngle<300&&e.midAngle>240||e.midAngle<120&&e.midAngle>60)){var l=i[r-1],h=i[r-2],s=e.endAngle%360-e.startAngle%360,a=l.endAngle%360-l.startAngle%360,c=h.endAngle%360-h.startAngle%360;s<3&&a<3&&c<3&&l.labelVisible&&e.labelVisible&&this.setPointVisibleTrue(e)}},t.prototype.getPerpendicularDistance=function(e,i){var r,n=10,s=n+10*Math.sin(i.midAngle*Math.PI/360);return i.midAngle>270&&i.midAngle<360?r=new at(e.x+s*Math.cos((360-i.midAngle)*Math.PI/180),e.y-s*Math.sin((360-i.midAngle)*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new at(e.x+s*Math.cos(i.midAngle*Math.PI/180),e.y+s*Math.sin(i.midAngle*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new at(e.x-s*Math.cos((i.midAngle-90)*Math.PI/180),e.y+s*Math.sin((i.midAngle-90)*Math.PI/180)):r=new at(e.x-s*Math.cos((i.midAngle-180)*Math.PI/180),e.y-s*Math.sin((i.midAngle-180)*Math.PI/180)),r},t})(aM),vY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ZO=(function(o){vY(t,o);function t(e){var i=o.call(this,e)||this;return i.accumulation=e,i.addEventListener(),i.template=i.accumulation.tooltip.template,i}return t.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(j.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(j.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(j.touchEndEvent,this.mouseUpHandler,this))},t.prototype.mouseLeaveHandler=function(){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},t.prototype.mouseUpHandler=function(e){var i=this.accumulation;i.tooltip.enable&&i.isTouch&&Pi(i.mouseX,i.mouseY,i.initialClipRect)&&(this.tooltip(e),this.removeTooltip(2e3))},t.prototype.mouseMoveHandler=function(e){var i=this.accumulation;i.tooltip.enable&&Pi(i.mouseX,i.mouseY,i.initialClipRect)&&this.tooltip(e)},t.prototype.tooltip=function(e){this.renderSeriesTooltip(this.accumulation,this.getPieData(e,this.accumulation))},t.prototype.renderSeriesTooltip=function(e,i){var r=this.getElement(this.element.id+"_tooltip_svg"),n=r&&parseInt(r.getAttribute("opacity"),10)>0,s=this.getTooltipElement(n),a=!n;if(this.currentPoints=[],i.point&&(!this.previousPoints[0]||this.previousPoints[0].point!==i.point)){if(this.previousPoints[0]&&i.point.index===this.previousPoints[0].point.index&&i.series.index===this.previousPoints[0].series.index)return null;this.pushData(i,a,s,!1)&&this.triggerTooltipRender(i,a,this.getTooltipText(i,e.tooltip),this.findHeader(i))}else!i.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1)},t.prototype.triggerTooltipRender=function(e,i,r,n){var s=this,a=this.chart.tooltip,l={cancel:!1,name:ab,text:r,point:e.point,textStyle:this.textStyle,series:e.series,headerText:n,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,pointIndex:e.point.index,pointText:e.point.text,seriesName:e.series.name}},h=function(c){c.cancel?(s.removeHighlight(),Qe(s.getElement(s.element.id+"_tooltip"))):(s.formattedText=s.formattedText.concat(c.text),s.text=s.formattedText,s.headerText=c.headerText,s.createTooltip(s.chart,i,{x:a.location.x!==null?a.location.x:e.point.symbolLocation.x,y:a.location.y!==null?a.location.y:e.point.symbolLocation.y},e.series.clipRect,e.point,a.enableMarker?["Circle"]:[],0,s.chart.initialClipRect,!1,null,e.point,s.template?s.accumulation.enableHtmlSanitizer?s.accumulation.sanitize(s.template):c.template:"")),s.isRemove=!0};h.bind(this,e),this.chart.trigger(ab,l,h)},t.prototype.getPieData=function(e,i){var r=e.target,n=Fc(r.id,!0);if(!isNaN(n.series)){var s=n.series,a=n.point;if(!g(s)&&!isNaN(s)&&!g(a)&&!isNaN(a)){var l=this.getSeriesFromIndex(s,i.visibleSeries);if(l.enableTooltip)return new Jf(l.points[a],l)}}return new Jf(null,null)},t.prototype.getSeriesFromIndex=function(e,i){return i[0]},t.prototype.getTooltipText=function(e,i){var r=e.series,n=i.format?i.format:this.accumulation.theme.indexOf("Tailwind3")>-1?"${point.x} : ${point.y}":"${point.x} : <b>${point.y}</b>";return n=this.accumulation.useGroupingSeparator?n.replace("${point.y}","${point.separatorY}"):n,this.parseTemplate(e.point,r,n)},t.prototype.findHeader=function(e){return this.header===""?"":(this.header=this.parseTemplate(e.point,e.series,this.header),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},t.prototype.parseTemplate=function(e,i,r){for(var n,s,a=RegExp,l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];n=new a("${point."+c+"}","gm");var u=c==="x"&&this.accumulation.useGroupingSeparator&&typeof e[c]=="number"?this.accumulation.intl.formatNumber(e.x,{useGrouping:!0}):e[c];r=r.replace(n.source,u)}for(var d=0,p=Object.keys(Object.getPrototypeOf(i));d<p.length;d++){var c=p[d];n=new a("${series."+c+"}","gm"),s=i[c],r=r.replace(n.source,s)}return r},t.prototype.getModuleName=function(){return"AccumulationTooltip"},t.prototype.destroy=function(){},t})(qO);var db=function(){return db=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},db.apply(this,arguments)},mY=(function(){function o(){this.transform=null}return o})(),hr=new mY,wb=(function(){function o(t,e,i){this.x=0,this.y=0,this.z=0,this.epsilon=1e-5,this.x=t,this.y=e||0,this.z=i||0}return o.prototype.isValid=function(t){return!isNaN(t.x)&&!isNaN(t.y)&&!isNaN(t.z)},o.prototype.vector3D=function(t,e,i){return this.x=t,this.y=e,this.z=i,{x:this.x,y:this.y,z:this.z}},o.prototype.vector3DMinus=function(t,e){return this.vector3D(t.x-e.x,t.y-e.y,t.z-e.z)},o.prototype.vector3DPlus=function(t,e){return this.vector3D(t.x+e.x,t.y+e.y,t.z+e.z)},o.prototype.vector3DMultiply=function(t,e){var i=t.y*e.z-e.y*t.z,r=t.z*e.x-e.z*t.x,n=t.x*e.y-e.x*t.y;return this.vector3D(i,r,n)},o.prototype.vector3DAdd=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o.prototype.vector3DStarMultiply=function(t,e){var i=t.x*e,r=t.y*e,n=t.z*e;return this.vector3D(i,r,n)},o.prototype.getLength=function(t){var e=this.vector3DAdd(t,t);return Math.sqrt(e)},o.prototype.normalize=function(){var t=this.getLength(this);this.x/=t,this.y/=t,this.z/=t},o.prototype.getNormal=function(t,e,i){var r=this.vector3DMinus(t,e),n=this.vector3DMinus(i,e),s=this.vector3DMultiply(r,n),a=this.getLength(s);return a<this.epsilon?this.vector3D(0,0,0):this.vector3D(s.x/a,s.y/a,s.z/a)},o})(),JO=(function(){function o(){this.matrixSize=4}return o.prototype.matrix3D=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.createArray(t);return e},o.prototype.isAffine=function(t){return t[0][3]===0&&t[1][3]===0&&t[2][3]===0&&t[3][3]===1},o.prototype.createArray=function(t){for(var e=[],i=0;i<t;++i)e[i]=0;return e},o.prototype.getIdentity=function(){for(var t=this.matrix3D(this.matrixSize),e=0;e<this.matrixSize;e++)t[e][e]=1;return t},o.prototype.getInterval=function(t){for(var e=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)e[i][r]=this.getMinor(t,i,r);return e=this.transposed(e),e=this.getMatrixMultiple(1/this.getDeterminant(t),e),e},o.prototype.getMatrixMultiple=function(t,e){for(var i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)e[i][r]=e[i][r]*t;return e},o.prototype.getMatrixVectorMultiple=function(t,e){var i=t[0][0]*e.x+t[1][0]*e.y+t[2][0]*e.z+t[3][0],r=t[0][1]*e.x+t[1][1]*e.y+t[2][1]*e.z+t[3][1],n=t[0][2]*e.x+t[1][2]*e.y+t[2][2]*e.z+t[3][2];if(!this.isAffine(t)){var s=1/(t[0][3]*e.x+t[1][3]*e.y+t[2][3]*e.z+t[3][3]);i*=s,r*=s,n*=s}return{x:i,y:r,z:n}},o.prototype.getMatrixVectorAnd=function(t,e){var i=t[0][0]*e.x+t[1][0]*e.y+t[2][0]*e.z,r=t[0][1]*e.x+t[1][1]*e.y+t[2][1]*e.z,n=t[0][2]*e.x+t[1][2]*e.y+t[2][2]*e.z;return new wb(i,r,n)},o.prototype.getMatrixMultiplication=function(t,e){for(var i=this.getIdentity(),r=0;r<this.matrixSize;r++)for(var n=0;n<this.matrixSize;n++){for(var s=0,a=0;a<this.matrixSize;a++)s+=t[a][n]*e[r][a];i[r][n]=s}return i},o.prototype.getMinor=function(t,e,i){return((e+i)%2===0?1:-1)*this.getDeterminant(this.getMatrix(t,e,i))},o.prototype.getMatrix=function(t,e,i){for(var r=t.length-1,n=this.createArray(r),s=0;s<r;s++){var a=s>=e?s+1:s;n[s]=this.createArray(r);for(var l=0;l<r;l++){var h=l>=i?l+1:l;n[s][l]=t[a][h]}}return n},o.prototype.getDeterminant=function(t){var e=t.length,i=0;if(e<2)i=t[0][0];else for(var r=1,n=0;n<e;n++){var s=this.getMatrix(t,n,0);i+=r*t[n][0]*this.getDeterminant(s),r=r>0?-1:1}return i},o.prototype.transform=function(t,e,i){var r=this.getIdentity();return r[3][0]=t,r[3][1]=e,r[3][2]=i,r},o.prototype.turn=function(t){var e=this.getIdentity();return e[0][0]=Math.cos(t),e[2][0]=-Math.sin(t),e[0][2]=Math.sin(t),e[2][2]=Math.cos(t),e},o.prototype.tilt=function(t){var e=this.getIdentity();return e[1][1]=Math.cos(t),e[2][1]=Math.sin(t),e[1][2]=-Math.sin(t),e[2][2]=Math.cos(t),e},o.prototype.transposed=function(t){for(var e=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)e[i][r]=t[r][i];return e},o})();var yY=(function(){function o(){this.vector=new wb(0,0,0)}return o.prototype.addVisual=function(t,e){return t==null||Dh.test()?-1:QR.add(t,e)},o.prototype.prepareView=function(t,e,i,r,n,s){hr.transform==null?hr.transform=s.transform3D.transform3D(n):hr.transform.viewingArea=n,hr.tree||(hr.tree=[]),hr.transform.rotation=i,hr.transform.tilt=r,hr.transform.depth=e,hr.transform.perspectiveAngle=t,s.transform3D.transform(hr.transform),hr.tree[s.chart3D.id]=QR.build()},o.prototype.view=function(t,e,i,r,n,s,a){var l=32767;if(arguments.length===2){if(t==null)return;var h=this.vector.vector3D(0,0,l);this.drawNode3D(hr.tree[e.chart3D.id],h,t,e)}else{if(t==null)return;hr.transform==null?hr.transform=e.transform3D.transform3D(n):hr.transform.viewingArea=n,hr.transform.rotation=i,hr.transform.tilt=r,hr.transform.depth=a,hr.transform.perspectiveAngle=s,e.transform3D.transform(hr.transform);var c=this.vector.vector3D(0,0,l);this.drawNode3D(hr.tree[e.chart3D.id],c,t,e)}},o.prototype.draw3DElement=function(t,e){t.plane.element?t.plane.element.tag==="text"||t.plane.element.tag==="dataLabel"?Dh.drawText(t.plane,e):t.plane.element.tag==="template"?Dh.drawTemplate(t.plane,e):Dh.drawLine(t.plane,e):Dh.draw(t.plane,e)},o.prototype.drawNode3D=function(t,e,i,r){if(!(t===null||hr.transform==null))for(var n=!0;n;){var s=Oo.vector3DAdd(Dh.getNormal(r.transform3D.result(hr.transform),t.plane.vectorPoints),e);if(s>t.plane.d){if(t.front!=null&&this.drawNode3D(t.front,e,i,r),this.draw3DElement(t,r),t.back!=null){t=t.back;continue}}else if(t.back!=null&&this.drawNode3D(t.back,e,i,r),this.draw3DElement(t,r),t.front!=null){t=t.front;continue}break}},o})(),bY=(function(){function o(t){this.epsilon=5e-4,this.chart=t}return o.prototype.add=function(t,e){return this.chart=e,e.polygons.push(t),e.polygons.length-1},o.prototype.getNext=function(t,e){return t>=e?t-e:t<0?t+e:t},o.prototype.vector3DIndexClassification=function(t,e,i){return{index:e,result:i,vector:t,isCuttingBackPoint:!1,cuttingBackPairIndex:null,alreadyCutBack:!1,isCuttingFrontPoint:!1,cuttingFrontPairIndex:null,alreadyCutFront:!1}},o.prototype.classifyPoint=function(t,e){var i="OnPlane",r=-e.d-Oo.vector3DAdd(t,e.normal);return r>this.epsilon?i="OnBack":r<-this.epsilon&&(i="OnFront"),i},o.prototype.classifyPolygon=function(t,e){var i="Unknown",r=e.points;if(r==null)return i;for(var n=0,s=0,a=0,l=t.normal,h=t.d,c=0,u=r.length;c<u;c++){var d=-h-Oo.vector3DAdd(r[c],l);if(d>this.epsilon?n++:d<-this.epsilon?s++:a++,n>0&&s>0)break}return a===r.length?i="OnPlane":s+a===r.length?i="ToRight":n+a===r.length?i="ToLeft":i="Unknown",i},o.prototype.splitPolygon=function(t,e){var i=[],r=[];if(t.points!=null){for(var n=[],s=[],a=[],l=void 0,h=void 0,c=t.points.length,u=0;u<c;u++){var d=t.points[u],p=t.points[this.getNext(u+1,c)],f=this.classifyPoint(d,e),v=this.classifyPoint(p,e),m=this.vector3DIndexClassification(d,n.length,f);if(n.push(m),f!==v&&f!=="OnPlane"&&v!=="OnPlane"){var y=Oo.vector3DMinus(d,p),b=Oo.vector3DMinus(Oo.vector3DStarMultiply(e.normal,-e.d),p),S=Oo.vector3DAdd(b,e.normal),C=S/Oo.vector3DAdd(e.normal,y),x=Oo.vector3DPlus(p,Oo.vector3DStarMultiply(y,C)),I=this.vector3DIndexClassification(x,n.length,"OnPlane");n.push(I),s.push(I),a.push(I)}else if(f==="OnPlane"){var D=t.points[this.getNext(u-1,c)],M=this.classifyPoint(D,e);if(M===v)continue;if(M!=="OnPlane"&&v!=="OnPlane")s.push(m),a.push(m);else if(M==="OnPlane")switch(v){case"OnBack":s.push(m);break;case"OnFront":a.push(m);break}else if(v==="OnPlane")switch(M){case"OnBack":s.push(m);break;case"OnFront":a.push(m);break}}}if(a.length!==0||s.length!==0){for(var u=0;u<s.length-1;u+=2){var E=s[u],A=s[u+1];E.cuttingBackPoint=!0,A.cuttingBackPoint=!0,E.alterCuttingBackPairIndex=A.index,A.alterCuttingBackPairIndex=E.index}for(var u=0;u<a.length-1;u+=2){var L=a[u],N=a[u+1];L.cuttingFrontPoint=!0,N.cuttingFrontPoint=!0,L.alterCuttingFrontPairIndex=N.index,N.alterCuttingFrontPairIndex=L.index}for(var u=0;u<s.length-1;u++){var E=s[u];if(!E.alreadyCutBack&&(l=this.cutOutBackPolygon(n,E),l.length>2)){var R=Dh.polygon3D(l,t);i.push(db({},R))}}for(var u=0;u<a.length-1;u++){var A=a[u];if(!A.alreadyCutFront&&(h=this.cutOutFrontPolygon(n,A),h.length>2)){var P=Dh.polygon3D(h,t);r.push(db({},P))}}}}else i.push(t),r.push(t);return{backPolygon:i,frontPolygon:r}},o.prototype.cutOutFrontPolygon=function(t,e){for(var i=[],r=e,n=!0;n;){r.alreadyCutFront=!0,i.push(r.vector);var s=t[r.alterCuttingFrontPairIndex];if(r.cuttingFrontPoint)if(!s.alreadyCutFront)r=s;else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result==="OnFront"&&!a.alreadyCutFront)r=a;else if(l.result==="OnFront"&&!l.alreadyCutFront)r=l;else return i}else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result!=="OnBack"&&!a.alreadyCutFront)r=a;else if(l.result!=="OnBack"&&!l.alreadyCutFront)r=l;else return i}}return null},o.prototype.cutOutBackPolygon=function(t,e){for(var i=[],r=e,n=!0;n;){r.alreadyCutBack=!0,i.push(r.vector);var s=t[r.alterCuttingBackPairIndex];if(r.cuttingBackPoint)if(!s.alreadyCutBack)r=s;else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result==="OnBack"&&!a.alreadyCutBack)r=a;else if(l.result==="OnBack"&&!l.alreadyCutBack)r=l;else return i}else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result!=="OnFront"&&!a.alreadyCutBack)r=a;else if(l.result!=="OnFront"&&!l.alreadyCutBack)r=l;else return i}}return null},o.prototype.build=function(t){if(t){var e=t;if(e.length<1)return null;var i={back:null,front:null,plane:null},r=e[0];i.plane=r;for(var n=[],s=[],a=1,l=e.length;a<l;a++){var h=e[a];if(h!==r){var c=this.classifyPolygon(r,h);switch(c){case"OnPlane":case"ToRight":s.push(h);break;case"ToLeft":n.push(h);break;case"Unknown":if(h.element&&(h.element.tag==="line"||h.element.tag==="text"))n.push(h);else{for(var u=this.splitPolygon(h,r),d=0;d<u.backPolygon.length;d++)u.backPolygon[d].name=u.backPolygon[d].name+"-back",n.push(u.backPolygon[d]);for(var p=0;p<u.frontPolygon.length;p++)u.frontPolygon[p].name=u.frontPolygon[p].name+"-front",s.push(u.frontPolygon[p])}break}}}return n.length>0&&(i.back=this.build(n)),s.length>0&&(i.front=this.build(s)),i}else return this.build(this.chart.polygons)},o})();var SY=(function(){function o(){this.epsilon=1e-5,this.normal={x:0,y:0,z:0},this.vector=new wb(0,0,0),this.vectorPoints=[],this.matrixObj=new JO,this.tabIndex=!0}return o.prototype.polygon3D=function(t,e,i,r,n,s,a,l,h,c){if(arguments.length===3)return this.calculateNormal(t,e,i),null;if(arguments.length===2){this.calculateNormal(t[0],t[1],t[2]),this.vectorPoints=t,this.calculateNormal(this.vectorPoints);var u=e;return u.normal=this.normal,u.points=t,u.vectorPoints=this.vectorPoints,u.isSplit=!0,u.d=this.d,u}else{this.calculateNormal(t[0],t[1],t[2]),this.vectorPoints=t,this.calculateNormal(this.vectorPoints);var d={tag:"path",parent:h},u={normal:this.normal,points:t,vectorPoints:this.vectorPoints,index:i,tag:e,name:l||null,strokeThickness:n,opacity:s,fill:a,d:this.d,text:c||"",polygonElement:d};return arguments.length!==1&&(u.polygonElement=d),u}},o.prototype.createLine=function(t,e,i,r,n,s){var a=t.width,l=[];return l[0]=this.vector.vector3D(e,i,s),l[1]=this.vector.vector3D(e+a,n+a,s),l[2]=this.vector.vector3D(r,n,s),this.line3D(t,l)},o.prototype.line3D=function(t,e){var i=this.polygon3D(e);return i.element=t,i},o.prototype.text3D=function(t,e){var i=this.polygon3D(e);return i.element=t,i},o.prototype.createCylinder=function(t,e,i,r,n,s,a,l,h,c,u){var d=0,p,f,v,m,y=24,b=360/y,S=Math.PI/180,C=(t.z+e.z)/2,x=[],I=[],D=[],M=[],E=e.y-t.y<e.z-t.z?(e.y-t.y)/2:(e.z-t.z)/2,A=e.x-t.x<e.z-t.z?(e.x-t.x)/2:(e.z-t.z)/2,L=(t.x+e.x)/2,N=(t.y+e.y)/2;switch(n){case"Bar":case"StackingBar":case"StackingBar100":for(y++;y--;)f=N+E*Math.cos(d*b*S),v=C+E*Math.sin(d*b*S),I[d]={Y:f,Z:v},D.push(this.vector.vector3D(t.x,I[d].Y,I[d].Z)),M.push(this.vector.vector3D(e.x,I[d].Y,I[d].Z)),d>0&&(m=[this.vector.vector3D(t.x,I[d-1].Y,I[d-1].Z),this.vector.vector3D(e.x,I[d-1].Y,I[d-1].Z),this.vector.vector3D(e.x,I[d].Y,I[d].Z),this.vector.vector3D(t.x,I[d].Y,I[d].Z)],x[d+1]=this.polygon3D(m,i,r,a,0,h,a,"-"+(d+1).toString()+"-"+c,u),ss.addVisual(x[d+1],i)),d++;break;case"Column":case"StackingColumn":case"StackingColumn100":for(y++;y--;)p=L+A*Math.cos(d*b*S),v=C+A*Math.sin(d*b*S),I[d]={Y:p,Z:v},D.push(this.vector.vector3D(I[d].Y,t.y,I[d].Z)),M.push(this.vector.vector3D(I[d].Y,e.y,I[d].Z)),d>0&&(m=[this.vector.vector3D(I[d-1].Y,t.y,I[d-1].Z),this.vector.vector3D(I[d-1].Y,e.y,I[d-1].Z),this.vector.vector3D(I[d].Y,e.y,I[d].Z),this.vector.vector3D(I[d].Y,t.y,I[d].Z)],x[d+1]=this.polygon3D(m,i,r,a,0,h,a,"-"+(d+1).toString()+"-"+c,u),ss.addVisual(x[d+1],i)),d++;break}return x[0]=this.polygon3D(M,i,r,s,0,h,a,"-0-"+c,u),x[1]=this.polygon3D(D,i,r,s,l,h,a,"-1-"+c,u),ss.addVisual(x[0],i),ss.addVisual(x[1],i),x},o.prototype.createBox=function(t,e,i,r,n,s,a,l,h,c,u,d){var p=[],f=[this.vector.vector3D(t.x,t.y,t.z),this.vector.vector3D(e.x,t.y,t.z),this.vector.vector3D(e.x,e.y,t.z),this.vector.vector3D(t.x,e.y,t.z)],v=[this.vector.vector3D(t.x,t.y,e.z),this.vector.vector3D(e.x,t.y,e.z),this.vector.vector3D(e.x,e.y,e.z),this.vector.vector3D(t.x,e.y,e.z)],m=[this.vector.vector3D(t.x,t.y,e.z),this.vector.vector3D(e.x,t.y,e.z),this.vector.vector3D(e.x,t.y,t.z),this.vector.vector3D(t.x,t.y,t.z)],y=[this.vector.vector3D(t.x,e.y,e.z),this.vector.vector3D(e.x,e.y,e.z),this.vector.vector3D(e.x,e.y,t.z),this.vector.vector3D(t.x,e.y,t.z)],b=[this.vector.vector3D(t.x,t.y,t.z),this.vector.vector3D(t.x,t.y,e.z),this.vector.vector3D(t.x,e.y,e.z),this.vector.vector3D(t.x,e.y,t.z)],S=[this.vector.vector3D(e.x,t.y,t.z),this.vector.vector3D(e.x,t.y,e.z),this.vector.vector3D(e.x,e.y,e.z),this.vector.vector3D(e.x,e.y,t.z)];return c?(p[0]=this.polygon3D(f,i,r,n,a,l,s,"-0-"+c,u,d),p[1]=this.polygon3D(v,i,r,n,a,l,s,"-1-"+c,u,d),p[2]=this.polygon3D(m,i,r,n,a,l,s,"-2-"+c,u,d),p[3]=this.polygon3D(y,i,r,n,a,l,s,"-3-"+c,u,d),p[4]=this.polygon3D(b,i,r,n,a,l,s,"-4-"+c,u,d),p[5]=this.polygon3D(S,i,r,n,a,l,s,"-5-"+c,u,d)):(p[0]=this.polygon3D(f,i,r,n,a,l,s,"-0-"+r,u,d),p[1]=this.polygon3D(v,i,r,n,a,l,s,"-1-"+r,u,d),p[2]=this.polygon3D(m,i,r,n,a,l,s,"-2-"+r,u,d),p[3]=this.polygon3D(y,i,r,n,a,l,s,"-3-"+r,u,d),p[4]=this.polygon3D(b,i,r,n,a,l,s,"-4-"+r,u,d),p[5]=this.polygon3D(S,i,r,n,a,l,s,"-5-"+r,u,d)),h?(ss.addVisual(p[0],i),ss.addVisual(p[1],i),ss.addVisual(p[2],i),ss.addVisual(p[3],i),ss.addVisual(p[4],i),ss.addVisual(p[5],i)):(ss.addVisual(p[5],i),ss.addVisual(p[4],i),ss.addVisual(p[0],i),ss.addVisual(p[1],i),ss.addVisual(p[2],i),ss.addVisual(p[3],i)),p},o.prototype.calculateNormal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length>=3){var i=t[0],r=t[1],n=t[2],s=this.vector.vector3DMinus(i,r),a=this.vector.vector3DMinus(n,r),l=this.vector.vector3DMultiply(s,a),h=this.vector.getLength(l);h<this.epsilon&&(h=1),this.normal=this.vector.vector3D(l.x/h,l.y/h,l.z/h),this.d=-(this.normal.x*i.x+this.normal.y*i.y+this.normal.z*i.z),t[3]&&(t[3].normal=this.normal,t[3].d=this.d)}else{var c=t[0];this.calculateNormal(c[0],c[1],c[2],t[1]);for(var u=3;u<c.length&&this.test();u++)this.calculateNormal(c[u],c[0],c[u/2])}},o.prototype.test=function(){return!this.vector.isValid(this.normal)},o.prototype.transform=function(t,e){if(e.points!=null){for(var i=0;i<e.points.length;i++)e.vectorPoints[i]=e.points[i]=od.getMatrixVectorMultiple(t,e.points[i]);this.calculateNormal(e.vectorPoints,e)}},o.prototype.getNormal=function(t,e){var i;if(e!=null){i=this.vector.getNormal(this.matrixObj.getMatrixVectorMultiple(t,e[0]),od.getMatrixVectorMultiple(t,e[1]),this.matrixObj.getMatrixVectorMultiple(t,e[2]));for(var r=3;r<e.length&&!this.vector.isValid(i)&&e[r/2];r++){var n=od.getMatrixVectorMultiple(t,e[r]),s=od.getMatrixVectorMultiple(t,e[0]),a=od.getMatrixVectorMultiple(t,e[r/2]);i=this.vector.getNormal(n,s,a)}}else i=od.getMatrixVectorAnd(t),this.vector.normalize();return i},o.prototype.createTextElement=function(t,e,i,r){var n=[],s=t.x,a=t.y,l=e.width,h=e.height;return n[0]=this.vector.vector3D(s,a,t.z),n[1]=this.vector.vector3D(s+l,a+h+r,t.z),n[2]=this.vector.vector3D(s+l+i,a+h+r,t.z),this.text3D(e,n)},o.prototype.drawLine=function(t,e){var i=hr.transform;if(i!=null){var r=e.transform3D.toScreen(t.vectorPoints[0],i),n=e.transform3D.toScreen(t.vectorPoints[2],i),s={id:t.element.id,x1:r.x,y1:r.y,x2:n.x,y2:n.y,"stroke-dasharray":"","stroke-width":t.element.width,stroke:t.element.stroke,opacity:t.element.opacity};if(e.chart3D.appendChild(e.svgRenderer.drawLine(s)),e.previousID&&e.isTouch){var a=document.getElementById(e.previousID),l=document.getElementById(s.id);a&&l&&l.parentNode.insertBefore(l,a.nextSibling)}e.previousID=s.id}},o.prototype.drawTemplate=function(t,e){var i=t.element,r=hr.transform;if(r!=null){var n=i.label,s=e.transform3D.toScreen(t.vectorPoints[0],r);e.dataLabel3DModule.createDataLabelTemplate(n.series.dataLabelElement,n.series,n.series.dataLabel,n.series.visiblePoints[n.pointIndex],i.argsData,n.pointIndex,!1,s)}},o.prototype.drawText=function(t,e){var i=t.element,r=hr.transform;if(r!=null){var n=e.transform3D.toScreen(t.vectorPoints[0],r),s=n.x,a=n.y;if(i.tag==="text"){var l={id:i.id,x:s,y:a,fill:i.font.color||i.fill,"font-size":i.font.size,"font-family":i.font.fontFamily,"font-style":i.font.fontStyle,"font-weight":i.font.fontWeight,opacity:i.font.opacity,"text-anchor":i.textAnchor,cursor:"default",transform:i.angle?"rotate("+i.angle+","+s+","+a+")":""},h=e.svg3DRenderer.drawText(l,i.label.text,t.element.font,e);i.id.indexOf("-axis-title")>-1&&h.setAttribute("aria-hidden","true"),e.chart3D.append(h)}else{var c=i.series,u=c.yAxis&&c.yAxis.labelFormat?c.yAxis.labelFormat:"",d=i.point.text?i.point.text:i.point.y+u.substring(u.indexOf("}")+1),p=Xe(d,c.dataLabel.font,e.themeStyle.datalabelFont),f=c.dataLabel.margin,v=p.width+f.left+f.right,m=p.height+f.top+f.bottom,y={x:n.x,y:n.y},b=y.x-f.left/2+f.right/2,S=y.y-f.top/2-m/f.top+f.bottom/2,C=c.index;this.dataLabelSymbol(C,c,i.pointIndex,b,S,v,m,e)}}},o.prototype.dataLabelSymbol=function(t,e,i,r,n,s,a,l){var h="M "+(r+-s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+-a/2)+" z",c={id:l.element.id+"-svg-data-label-series-"+t+"-point-"+i,fill:e.dataLabel.fill,"stroke-width":e.dataLabel.border.width,"stroke-dasharray":e.dataLabel.border.dashArray,stroke:e.dataLabel.border.color,opacity:e.dataLabel.opacity,visibility:"",d:h},u=l.svgRenderer.drawPath(c);l.chart3D.append(u)},o.prototype.draw=function(t,e){if(!(t.vectorPoints==null||t.vectorPoints.length<=0)){var i=hr.transform,r=e.svg3DRenderer.getStringBuilder(),n=t.fill,s=e.svg3DRenderer.checkColorFormat(n);s||n!=="transparent"&&(n=_n(n));var a={StartPoint:null};if(i!=null){a.StartPoint=e.transform3D.toScreen(t.vectorPoints[0],i),r.append("M "+a.StartPoint.x+" "+a.StartPoint.y+" ");for(var l=0;l<t.vectorPoints.length;l++){var h=e.transform3D.toScreen(t.vectorPoints[l],i);r.append("L "+h.x+" "+h.y+" ")}}var c=r.toString(),u="Light",d=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(0,0,1)))-1),p=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(0,1,0)))-1),f=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(1,0,0)))-1);t.name&&!(t.name.indexOf("-wall-brush")>-1)&&(d===f?(u="ZLight",n=this.applyZLight(n,e)):p===d||d!==0&&p<d?(u="XLight",n=this.applyXLight(n,e)):d<0?(u="ZLight",n=this.applyZLight(n,e)):u="Light");var v={id:e.element.id+"-svg"+t.name,name:u,fill:n,stroke:"","stroke-width":t.strokeThickness,opacity:t.opacity,d:c},m=e.svgRenderer.drawPath(v);if(t.text&&(m.setAttribute("aria-label",t.text),m.setAttribute("role","img")),t.name&&t.name.indexOf("-wall-brush")>-1&&m.setAttribute("aria-hidden","true"),m.id.indexOf("0-region-series-0-point-0")>-1){if(this.tabIndex)m.setAttribute("tabindex","0");else{var y=t.polygonElement.parent.querySelectorAll('[id*="0-region-series-0-point-0"]');y.length>0&&y[y.length-1].removeAttribute("tabindex"),m.setAttribute("tabindex","0")}this.tabIndex=!1}if(gt(!1,t.polygonElement.parent,m,e.redraw,!0,"x","y",null,c),e.previousID&&e.isTouch){var b=document.getElementById(e.previousID),S=document.getElementById(v.id);b&&S&&S.parentNode.insertBefore(S,b.nextSibling)}e.previousID=v.id}},o.prototype.applyXLight=function(t,e){var i=e.svg3DRenderer.hexToValue(t);return i.red=parseInt((i.red*.7).toString(),10),i.green=parseInt((i.green*.7).toString(),10),i.blue=parseInt((i.blue*.7).toString(),10),e.svg3DRenderer.hexColor(i)},o.prototype.applyZLight=function(t,e){var i=e.svg3DRenderer.hexToValue(t);return i.red=parseInt((i.red*.9).toString(),10),i.green=parseInt((i.green*.9).toString(),10),i.blue=parseInt((i.blue*.9).toString(),10),e.svg3DRenderer.hexColor(i)},o})(),Oo=new wb(0,0,0),od=new JO,QR=new bY,Dh=new SY,ss=new yY;var pb=function(){return pb=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},pb.apply(this,arguments)},CY=(function(){function o(){this.transform=null}return o})(),ib=new CY,ez=(function(){function o(t,e,i){this.x=0,this.y=0,this.z=0,this.epsilon=1e-5,this.x=t,this.y=e||0,this.z=i||0}return o.prototype.isValid=function(t){return!isNaN(t.x)&&!isNaN(t.y)&&!isNaN(t.z)},o.prototype.vector3D=function(t,e,i){return this.x=t,this.y=e,this.z=i,{x:this.x,y:this.y,z:this.z}},o.prototype.vector3DMinus=function(t,e){return this.vector3D(t.x-e.x,t.y-e.y,t.z-e.z)},o.prototype.vector3DPlus=function(t,e){return this.vector3D(t.x+e.x,t.y+e.y,t.z+e.z)},o.prototype.vector3DMultiply=function(t,e){var i=t.y*e.z-e.y*t.z,r=t.z*e.x-e.z*t.x,n=t.x*e.y-e.x*t.y;return this.vector3D(i,r,n)},o.prototype.vector3DAdd=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},o.prototype.vector3DStarMultiply=function(t,e){var i=t.x*e,r=t.y*e,n=t.z*e;return this.vector3D(i,r,n)},o.prototype.getLength=function(t){var e=this.vector3DAdd(t,t);return Math.sqrt(e)},o.prototype.getNormal=function(t,e,i){var r=this.vector3DMinus(t,e),n=this.vector3DMinus(i,e),s=this.vector3DMultiply(r,n),a=this.getLength(s);return a<this.epsilon?this.vector3D(0,0,0):this.vector3D(s.x/a,s.y/a,s.z/a)},o})(),tz=(function(){function o(){this.matrixSize=4}return o.prototype.matrix3D=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.createArray(t);return e},o.prototype.isAffine=function(t){return t[0][3]===0&&t[1][3]===0&&t[2][3]===0&&t[3][3]===1},o.prototype.createArray=function(t){for(var e=[],i=0;i<t;++i)e[i]=0;return e},o.prototype.getIdentity=function(){for(var t=this.matrix3D(this.matrixSize),e=0;e<this.matrixSize;e++)t[e][e]=1;return t},o.prototype.getInterval=function(t){for(var e=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)e[i][r]=this.getMinor(t,i,r);return e=this.transposed(e),e=this.getMatrixMultiple(1/this.getDeterminant(t),e),e},o.prototype.getMatrixMultiple=function(t,e){for(var i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)e[i][r]=e[i][r]*t;return e},o.prototype.getMatrixVectorMultiple=function(t,e){var i=t[0][0]*e.x+t[1][0]*e.y+t[2][0]*e.z+t[3][0],r=t[0][1]*e.x+t[1][1]*e.y+t[2][1]*e.z+t[3][1],n=t[0][2]*e.x+t[1][2]*e.y+t[2][2]*e.z+t[3][2];if(!this.isAffine(t)){var s=1/(t[0][3]*e.x+t[1][3]*e.y+t[2][3]*e.z+t[3][3]);i*=s,r*=s,n*=s}return{x:i,y:r,z:n}},o.prototype.getMatrixMultiplication=function(t,e){for(var i=this.getIdentity(),r=0;r<this.matrixSize;r++)for(var n=0;n<this.matrixSize;n++){for(var s=0,a=0;a<this.matrixSize;a++)s+=t[a][n]*e[r][a];i[r][n]=s}return i},o.prototype.getMinor=function(t,e,i){return((e+i)%2===0?1:-1)*this.getDeterminant(this.getMatrix(t,e,i))},o.prototype.getMatrix=function(t,e,i){for(var r=t.length-1,n=this.createArray(r),s=0;s<r;s++){var a=s>=e?s+1:s;n[s]=this.createArray(r);for(var l=0;l<r;l++){var h=l>=i?l+1:l;n[s][l]=t[a][h]}}return n},o.prototype.getDeterminant=function(t){var e=t.length,i=0;if(e<2)i=t[0][0];else for(var r=1,n=0;n<e;n++){var s=this.getMatrix(t,n,0);i+=r*t[n][0]*this.getDeterminant(s),r=r>0?-1:1}return i},o.prototype.transform=function(t,e,i){var r=this.getIdentity();return r[3][0]=t,r[3][1]=e,r[3][2]=i,r},o.prototype.turn=function(t){var e=this.getIdentity();return e[0][0]=Math.cos(t),e[2][0]=-Math.sin(t),e[0][2]=Math.sin(t),e[2][2]=Math.cos(t),e},o.prototype.tilt=function(t){var e=this.getIdentity();return e[1][1]=Math.cos(t),e[2][1]=Math.sin(t),e[1][2]=-Math.sin(t),e[2][2]=Math.cos(t),e},o.prototype.transposed=function(t){for(var e=this.getIdentity(),i=0;i<this.matrixSize;i++)for(var r=0;r<this.matrixSize;r++)e[i][r]=t[r][i];return e},o})();var wY=(function(){function o(t){this.epsilon=5e-4,this.chart=t}return o.prototype.getNext=function(t,e){return t>=e?t-e:t<0?t+e:t},o.prototype.vector3DIndexClassification=function(t,e,i){return{index:e,result:i,vector:t,isCuttingBackPoint:!1,cuttingBackPairIndex:null,alreadyCutBack:!1,isCuttingFrontPoint:!1,cuttingFrontPairIndex:null,alreadyCutFront:!1}},o.prototype.classifyPoint=function(t,e){var i="OnPlane",r=-e.d-Dl.vector3DAdd(t,e.normal);return r>this.epsilon?i="OnBack":r<-this.epsilon&&(i="OnFront"),i},o.prototype.classifyPolygon=function(t,e){var i="Unknown",r=e.points;if(r==null)return i;for(var n=0,s=0,a=0,l=t.normal,h=t.d,c=0,u=r.length;c<u;c++){var d=-h-Dl.vector3DAdd(r[c],l);if(d>this.epsilon?n++:d<-this.epsilon?s++:a++,n>0&&s>0)break}return a===r.length?i="OnPlane":s+a===r.length?i="ToRight":n+a===r.length?i="ToLeft":i="Unknown",i},o.prototype.splitPolygon=function(t,e){var i=[],r=[];if(t.points!=null){for(var n=[],s=[],a=[],l=void 0,h=void 0,c=t.points.length,u=0;u<c;u++){var d=t.points[u],p=t.points[this.getNext(u+1,c)],f=this.classifyPoint(d,e),v=this.classifyPoint(p,e),m=this.vector3DIndexClassification(d,n.length,f);if(n.push(m),f!==v&&f!=="OnPlane"&&v!=="OnPlane"){var y=Dl.vector3DMinus(d,p),b=Dl.vector3DMinus(Dl.vector3DStarMultiply(e.normal,-e.d),p),S=Dl.vector3DAdd(b,e.normal),C=S/Dl.vector3DAdd(e.normal,y),x=Dl.vector3DPlus(p,Dl.vector3DStarMultiply(y,C)),I=this.vector3DIndexClassification(x,n.length,"OnPlane");n.push(I),s.push(I),a.push(I)}}if(a.length!==0||s.length!==0){for(var u=0;u<s.length-1;u+=2){var D=s[u],M=s[u+1];D.cuttingBackPoint=!0,M.cuttingBackPoint=!0,D.alterCuttingBackPairIndex=M.index,M.alterCuttingBackPairIndex=D.index}for(var u=0;u<a.length-1;u+=2){var E=a[u],A=a[u+1];E.cuttingFrontPoint=!0,A.cuttingFrontPoint=!0,E.alterCuttingFrontPairIndex=A.index,A.alterCuttingFrontPairIndex=E.index}for(var u=0;u<s.length-1;u++){var D=s[u];if(!D.alreadyCutBack&&(l=this.cutOutBackPolygon(n,D),l.length>2)){var L=XR.polygon3D(l,t);i.push(pb({},L))}}for(var u=0;u<a.length-1;u++){var M=a[u];if(!M.alreadyCutFront&&(h=this.cutOutFrontPolygon(n,M),h.length>2)){var N=XR.polygon3D(h,t);r.push(pb({},N))}}}}else i.push(t),r.push(t);return{backPolygon:i,frontPolygon:r}},o.prototype.cutOutFrontPolygon=function(t,e){for(var i=[],r=e,n=!0;n;){r.alreadyCutFront=!0,i.push(r.vector);var s=t[r.alterCuttingFrontPairIndex];if(r.cuttingFrontPoint)if(!s.alreadyCutFront)r=s;else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result==="OnFront"&&!a.alreadyCutFront)r=a;else if(l.result==="OnFront"&&!l.alreadyCutFront)r=l;else return i}else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result!=="OnBack"&&!a.alreadyCutFront)r=a;else if(l.result!=="OnBack"&&!l.alreadyCutFront)r=l;else return i}}return null},o.prototype.cutOutBackPolygon=function(t,e){for(var i=[],r=e,n=!0;n;){r.alreadyCutBack=!0,i.push(r.vector);var s=t[r.alterCuttingBackPairIndex];if(r.cuttingBackPoint)if(!s.alreadyCutBack)r=s;else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result==="OnBack"&&!a.alreadyCutBack)r=a;else if(l.result==="OnBack"&&!l.alreadyCutBack)r=l;else return i}else{var a=t[this.getNext(r.index-1,t.length)],l=t[this.getNext(r.index+1,t.length)];if(a.result!=="OnFront"&&!a.alreadyCutBack)r=a;else if(l.result!=="OnFront"&&!l.alreadyCutBack)r=l;else return i}}return null},o.prototype.build=function(t,e){if(t){var i=t;if(i.length<1)return null;var r={back:null,front:null,plane:null},n=i[0];r.plane=n;for(var s=[],a=[],l=1,h=i.length;l<h;l++){var c=i[l];if(c!==n){var u=this.classifyPolygon(n,c);switch(u){case"OnPlane":case"ToRight":a.push(c);break;case"ToLeft":s.push(c);break;case"Unknown":if(c.element)s.push(c);else{for(var d=this.splitPolygon(c,n),p=0;p<d.backPolygon.length;p++)d.backPolygon[p].name=d.backPolygon[p].name+"-back",s.push(d.backPolygon[p]);for(var f=0;f<d.frontPolygon.length;f++)d.frontPolygon[f].name=d.frontPolygon[f].name+"-front",a.push(d.frontPolygon[f])}break}}}return s.length>0&&(r.back=this.build(s)),a.length>0&&(r.front=this.build(a)),r}else return this.build(e.circular3DPolygon)},o})();var xY=(function(){function o(){this.epsilon=1e-5,this.normal={x:0,y:0,z:0},this.vector=new ez(0,0,0),this.vectorPoints=[],this.matrixObj=new tz}return o.prototype.polygon3D=function(t,e,i,r,n,s,a,l,h,c){if(arguments.length===2){this.calculateNormal(t[0],t[1],t[2]),this.vectorPoints=t,this.calculateNormal(this.vectorPoints);var u=e;return u.normal=this.normal,u.points=t,u.vectorPoints=this.vectorPoints,u.isSplit=!0,u.d=this.d,u}else{this.calculateNormal(t[0],t[1],t[2]),this.vectorPoints=t,this.calculateNormal(this.vectorPoints);var d={tag:"path",parent:h},u={normal:this.normal,points:t,vectorPoints:this.vectorPoints,index:i,tag:e,name:l||null,strokeThickness:n,opacity:s,fill:a,d:this.d,text:c||"",polygonElement:d};return arguments.length!==1&&(u.polygonElement=d),u}},o.prototype.calculateNormal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length>=3){var i=t[0],r=t[1],n=t[2],s=this.vector.vector3DMinus(i,r),a=this.vector.vector3DMinus(n,r),l=this.vector.vector3DMultiply(s,a),h=this.vector.getLength(l);h<this.epsilon&&(h=1),this.normal=this.vector.vector3D(l.x/h,l.y/h,l.z/h),this.d=-(this.normal.x*i.x+this.normal.y*i.y+this.normal.z*i.z),t[3]&&(t[3].normal=this.normal,t[3].d=this.d)}else{var c=t[0];this.calculateNormal(c[0],c[1],c[2],t[1]);for(var u=3;u<c.length&&this.test();u++)this.calculateNormal(c[u],c[0],c[u/2])}},o.prototype.test=function(){return!this.vector.isValid(this.normal)},o.prototype.getNormal=function(t,e){var i;if(e!=null){i=this.vector.getNormal(this.matrixObj.getMatrixVectorMultiple(t,e[0]),rb.getMatrixVectorMultiple(t,e[1]),this.matrixObj.getMatrixVectorMultiple(t,e[2]));for(var r=3;r<e.length&&!this.vector.isValid(i)&&e[r/2];r++){var n=rb.getMatrixVectorMultiple(t,e[r]),s=rb.getMatrixVectorMultiple(t,e[0]),a=rb.getMatrixVectorMultiple(t,e[r/2]);i=this.vector.getNormal(n,s,a)}}return i},o.prototype.createTextElement=function(t,e,i,r){var n=[],s=t.x,a=t.y,l=e.width,h=e.height;return n[0]=this.vector.vector3D(s,a,t.z),n[1]=this.vector.vector3D(s+l,a+h+r,t.z),n[2]=this.vector.vector3D(s+l+i,a+h+r,t.z),this.text3D(e,n)},o.prototype.createPolyline=function(t,e){if(t.length===2){var i=t[1];t.push({x:i.x,y:i.y,z:i.z})}return this.polyLine3D(e,t)},o.prototype.polyLine3D=function(t,e){var i=this.polygon3D(e);return i.element=t,i},o.prototype.text3D=function(t,e){var i=this.polygon3D(e);return i.element=t,i},o.prototype.drawPolyLine=function(t,e){var i=ib.transform,r=e.svg3DRenderer.getStringBuilder(),n=e.transform3D.toScreen(t.vectorPoints[0],i);r.append("M "+n.x+" "+n.y+" ");var s=e.transform3D.toScreen(t.vectorPoints[1],i);r.append("L "+s.x+" "+s.y+" "),r.append("M "+s.x+" "+s.y+" ");var a=e.transform3D.toScreen(t.vectorPoints[2],i);r.append("L "+a.x+" "+a.y+" ");var l=r.toString(),h={id:t.element.id,"stroke-dasharray":t.element.dashArray,"stroke-width":t.element.width,stroke:t.element.stroke,d:l},c=e.renderer.drawPath(h);gt(!1,e.groupElement,c,e.redraw,!0,"x","y",null,l)},o.prototype.drawText=function(t,e){var i=t.element,r=ib.transform;if(r!=null){var n=e.transform3D.toScreen(t.vectorPoints[0],r),s=n.x,a=n.y;if(i.tag==="text"){var l={id:i.id,x:s,y:a,fill:i.font.color||i.fill,"font-size":i.font.size,"font-family":i.font.fontFamily||e.themeStyle.datalabelFont.fontFamily,"font-style":i.font.fontStyle,"font-weight":i.font.fontWeight,opacity:i.font.opacity,"text-anchor":i.textAnchor,cursor:"default",transform:i.angle?"rotate("+i.angle+","+s+","+a+")":""},h=e.svg3DRenderer.drawText(l,i.label.text,t.element.font,e);if(i.id.indexOf("text")>-1&&h.setAttribute("aria-hidden","true"),e.groupElement.append(h),e.previousID&&e.isTouch){var c=document.getElementById(e.previousID),u=document.getElementById(l.id);c&&u&&u.parentNode.insertBefore(u,c.nextSibling)}e.previousID=l.id}else{var d=i.series,p=i.point.argsData.text,f=Xe(p,i.point.argsData.font,e.themeStyle.datalabelFont),v=10,m=f.width+v+v,y=f.height+v+v,b={x:n.x,y:n.y},S=b.x-v/2+v/2,C=b.y-v/2-y/v+v/2,x=d.index;this.dataLabelSymbol(x,d,i,S,C,m,y,e)}}},o.prototype.dataLabelSymbol=function(t,e,i,r,n,s,a,l){var h="M "+(r+-s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+-a/2)+" L "+(r+s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+a/2)+" L "+(r+-s/2)+" "+(n+-a/2)+" z",c="";if(e.dataLabel.enableRotation){var u=void 0,d=u=e.dataLabel.angle;if(d===0){var p=function(S){return S*(180/Math.PI)},f=p(i.point.symbolLocation.angle);e.dataLabel.position==="Outside"?u=0:f>=90&&f<=260?u=f+180:u=f}else u=d>360?d-360:d<-360?d+360:d;c="rotate("+u+","+r+","+n+")"}var v={id:l.element.id+"-svg-data-label-series-"+t+"-shape-"+i.pointIndex,fill:i.point.argsData.color,"stroke-width":i.point.argsData.border.width,stroke:i.point.argsData.border.color,"stroke-dasharray":i.point.argsData.border.dashArray,opacity:1,visibility:"",transform:c,d:h},m=l.renderer.drawPath(v);if(l.groupElement.append(m),l.previousID&&l.isTouch){var y=document.getElementById(l.previousID),b=document.getElementById(v.id);y&&b&&b.parentNode.insertBefore(b,y.nextSibling)}l.previousID=v.id},o.prototype.draw=function(t,e){if(!(t.vectorPoints==null||t.vectorPoints.length<=0)){var i=ib.transform,r=e.svg3DRenderer.getStringBuilder(),n=t.fill,s=e.svg3DRenderer.checkColorFormat(n);s||(n=_n(n));var a={StartPoint:null};if(i!=null){a.StartPoint=e.transform3D.toScreen(t.vectorPoints[0],i),r.append("M "+a.StartPoint.x+" "+a.StartPoint.y+" ");for(var l=0;l<t.vectorPoints.length;l++){var h=e.transform3D.toScreen(t.vectorPoints[l],i);r.append("L "+h.x+" "+h.y+" ")}}var c=r.toString(),u="Light",d=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(0,0,1)))-1),p=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(0,1,0)))-1),f=2*(Math.abs(this.vector.vector3DAdd(t.normal,this.vector.vector3D(1,0,0)))-1);t.name&&!(t.name.indexOf("-wall-brush")>-1)&&(d===f?(u="ZLight",n=this.applyZLight(n,e)):p===d||d!==0&&p<d?(u="XLight",n=this.applyXLight(n,e)):d<0?(u="ZLight",n=this.applyZLight(n,e)):u="Light");var v={id:e.element.id+"-svg-"+t.name,name:u,fill:n,stroke:"","stroke-width":t.strokeThickness,opacity:t.opacity,d:c},m=e.renderer.drawPath(v);if(t.text&&(m.setAttribute("aria-label",t.text),m.setAttribute("role","img")),gt(!1,t.polygonElement.parent,m,e.redraw,!0,"x","y",null,c),e.previousID&&e.isTouch){var y=document.getElementById(e.previousID),b=document.getElementById(v.id);y&&b&&b.parentNode.insertBefore(b,y.nextSibling)}e.previousID=v.id}},o.prototype.drawTemplate=function(t,e){var i=t.element,r=ib.transform;if(r!=null){var n=i.label,s=e.transform3D.toScreen(t.vectorPoints[0],r);e.circularChartDataLabel3DModule.createDataLabelTemplate(n.series.dataLabelElement,n.series,n.series.dataLabel,n.series.points[n.pointIndex],n.series.points[n.pointIndex].argsData,n.pointIndex,!1,s,e)}},o.prototype.applyXLight=function(t,e){var i=e.svg3DRenderer.hexToValue(t);return i.red=parseInt((i.red*.7).toString(),10),i.green=parseInt((i.green*.7).toString(),10),i.blue=parseInt((i.blue*.7).toString(),10),e.svg3DRenderer.hexColor(i)},o.prototype.applyZLight=function(t,e){var i=e.svg3DRenderer.hexToValue(t);return i.red=parseInt((i.red*.9).toString(),10),i.green=parseInt((i.green*.9).toString(),10),i.blue=parseInt((i.blue*.9).toString(),10),e.svg3DRenderer.hexColor(i)},o})(),Dl=new ez(0,0,0),rb=new tz,toe=new wY,XR=new xY;function ie(o,t,e){var i,r=[];if(o){var n=void 0;t&&!g(e)&&(n=ke(t,e)),o=o.lastIndexOf("!")>-1?o.substring(o.lastIndexOf("!")+1):o,o=o.indexOf(":")===-1?o+":"+o:o;var s=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g);if(!s.test(o)){var a=o.split(":");o=g(o.match(/[0-9]/))?a[0]+"1:"+a[1]+(n?n.rowCount-1:"1"):"A"+a[0]+":"+(n?ji(n.colCount):"A")+a[1]}o.split(":").forEach(function(l){i=xe(l),r.push(i[0]),r.push(i[1])})}return r}function xe(o){return[parseInt(o.match(/\d+/)[0],10)-1,Sn(o.match(/[A-Z]+/i)[0].toUpperCase())]}function Sn(o){var t=0;o=o.split("").reverse().join("");for(var e=o.length-1;e>=0;e--)t+=(o[e].charCodeAt(0)-64)*Math.pow(26,e);return t-1}function st(o,t){return ji(t+1)+(o+1)}function Ve(o){return st(o[0],o[1])+":"+(g(o[2])?st(o[0],o[1]):st(o[2],o[3]))}function ji(o){var t="Z";return o/26>1?ji(o%26===0?o/26-1:Math.floor(o/26))+String.fromCharCode(o%26===0?t.charCodeAt(0):64+o%26):String.fromCharCode(64+o)}function Ji(o,t,e){return ie(Gc(o),t,e)}function Gc(o){var t=o.lastIndexOf("!");return t>-1?o.substring(t+1):o}function IY(o){return o.name+"!"+o.selectedRange}function yM(o,t){var e=js(o,t);return{sheetIndex:e,indices:Ji(t,o,e)}}function js(o,t){var e;return t.indexOf("!")>-1?e=Ct(o,na(t)):e=o.activeSheetIndex,e}function tt(o){var t=o.slice();return o[0]>o[2]&&iz(t,0,2),o[1]>o[3]&&iz(t,1,3),t}function iz(o,t,e){var i=o[t];o[t]=o[e],o[e]=i}function ug(o){return o[0]===o[2]&&o[1]===o[3]}function lM(o,t,e,i,r,n){return new MY(o,t,e,i,r,n)}var MY=(function(){function o(t,e,i,r,n,s){this.preventCallback=!1,this.context=t,this.workerTask=e,this.defaultListener=i,this.workerData=r,this.parent=s,n&&(this.preventCallback=!0),this.initWorker()}return o.prototype.terminate=function(){this.worker.terminate(),URL.revokeObjectURL(this.workerUrl)},o.prototype.initWorker=function(){var t=new Blob([this.getFnCode()],{type:"text/javascript"});if(this.workerUrl=URL.createObjectURL(t),this.worker=new Worker(this.workerUrl),this.worker.onmessage=this.messageFromWorker.bind(this),this.worker.onerror=this.onError.bind(this),!this.parent.isVue)this.worker.postMessage(this.workerData);else{var e=JSON.parse(JSON.stringify(this.workerData));this.worker.postMessage(e)}},o.prototype.messageFromWorker=function(t){this.terminate(),this.defaultListener.apply(this.context,[t.data])},o.prototype.onError=function(t){if(this.terminate(),t.message&&t.message.includes("FormData"))this.defaultListener.apply(this.context,[{isFormDataError:!0}]);else throw t.message||t},o.prototype.getFnCode=function(){var t="",e,i,r="",n=!1;if(typeof this.workerTask=="function")this.workerTask.toString().indexOf("function")<0?r="function "+this.workerTask.toString():(r=this.workerTask.toString(),n=!0),t+="self.workerTask = "+r+`; 
`;else if(typeof this.workerTask=="object")for(i=Object.keys(this.workerTask),e=0;e<i.length;e++)this.workerTask[i[e]].toString().indexOf("function")<0?r="function "+this.workerTask[i[e]].toString():(r=this.workerTask[i[e]].toString(),n=!0),t+=(e===0?"self.workerTask":i[e])+"= "+r+`; 
`;return t+="self.onmessage = "+(n?"":" function ")+(this.preventCallback?this.getMessageFn.toString():this.getCallbackMessageFn.toString())+`; 
`,t},o.prototype.getCallbackMessageFn=function(t){postMessage(this.workerTask.apply(this,t.data))},o.prototype.getMessageFn=function(t){this.workerTask.apply(this,t.data)},o})();function wz(o,t){return t===void 0&&(t=[]),t.push({member:"dataBind",args:[o]}),t.push({member:"workbookProtectSheet",args:[o]}),o.allowSave&&t.push({member:"workbookSave",args:[o]}),o.allowPrint&&t.push({member:"print",args:[o]}),o.allowOpen&&t.push({member:"workbookOpen",args:[o]}),o.allowEditing&&(t.push({member:"workbookEdit",args:[o]}),t.push({member:"workbookFormula",args:[o]})),o.allowNumberFormatting&&t.push({member:"workbookNumberFormat",args:[o]}),o.allowCellFormatting&&t.push({member:"workbookcellformat",args:[o]}),o.allowSorting&&t.push({member:"workbookSort",args:[o]}),o.allowHyperlink&&t.push({member:"workbookHyperlink",args:[o]}),o.allowFiltering&&t.push({member:"workbookFilter",args:[o]}),o.allowFindAndReplace&&t.push({member:"workbookfindAndReplace",args:[o]}),o.allowInsert&&t.push({member:"workbookinsert",args:[o]}),o.allowDelete&&t.push({member:"workbookdelete",args:[o]}),o.allowDataValidation&&t.push({member:"workbookDataValidation",args:[o]}),o.allowMerge&&t.push({member:"workbookmerge",args:[o]}),o.allowCellFormatting&&t.push({member:"workbookConditionalFormatting",args:[o]}),o.allowImage&&t.push({member:"workbookImage",args:[o]}),o.allowChart&&t.push({member:"workbookChart",args:[o]}),o.allowAutoFill&&t.push({member:"workbookautofill",args:[o]}),t}var rp=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),yi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},xz=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w("Calibri")],t.prototype,"fontFamily",void 0),yi([w("bottom")],t.prototype,"verticalAlign",void 0),yi([w("left")],t.prototype,"textAlign",void 0),yi([w("0pt")],t.prototype,"textIndent",void 0),yi([w("#000000")],t.prototype,"color",void 0),yi([w("#ffffff")],t.prototype,"backgroundColor",void 0),yi([w("normal")],t.prototype,"fontWeight",void 0),yi([w("normal")],t.prototype,"fontStyle",void 0),yi([w("11pt")],t.prototype,"fontSize",void 0),yi([w("none")],t.prototype,"textDecoration",void 0),yi([w("")],t.prototype,"border",void 0),yi([w("")],t.prototype,"borderTop",void 0),yi([w("")],t.prototype,"borderBottom",void 0),yi([w("")],t.prototype,"borderLeft",void 0),yi([w("")],t.prototype,"borderRight",void 0),t})(Oe);var Iz=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w("")],t.prototype,"name",void 0),yi([w("")],t.prototype,"scope",void 0),yi([w("")],t.prototype,"comment",void 0),yi([w("")],t.prototype,"refersTo",void 0),t})(Oe),DY=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w(!1)],t.prototype,"selectCells",void 0),yi([w(!1)],t.prototype,"selectUnLockedCells",void 0),yi([w(!1)],t.prototype,"formatCells",void 0),yi([w(!1)],t.prototype,"formatRows",void 0),yi([w(!1)],t.prototype,"formatColumns",void 0),yi([w(!1)],t.prototype,"insertLink",void 0),t})(Oe);var EY=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w("General")],t.prototype,"format",void 0),yi([Ce({},xz)],t.prototype,"style",void 0),yi([w(!0)],t.prototype,"isLocked",void 0),t})(Oe),TY=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w("GreaterThan")],t.prototype,"type",void 0),yi([Ce({},EY)],t.prototype,"format",void 0),yi([w("RedFT")],t.prototype,"cFColor",void 0),yi([w("")],t.prototype,"value",void 0),yi([w("")],t.prototype,"range",void 0),yi([w("")],t.prototype,"action",void 0),t})(Oe);var AY=(function(o){rp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return yi([w("FillSeries")],t.prototype,"fillType",void 0),yi([w(!0)],t.prototype,"showFillOptions",void 0),t})(Oe),LY="workbookDestroyed",Bh="updateSheetFromDataSource",Ab="dataSourceChanged",Ib="dataChanged",dg="triggerDataChange",Lb="workbookOpen",pg="beginSave",hi="actionBegin",Nb="sortImport",Qc="findToolDlg",fg="exportDialog",kb="setFilteredCollection",gg="saveCompleted",vg="applyNumber",yr="getFormattedCell",zl="calculateFormula",bM="refreshCellElem",ur="setCellFormat",SM="findAllValues",Rd="textDecorationUpdate",Mr="applyCellFormat";var Od="updateRowColCount",At="workbookFormulaOperation",Xc="workbookEditOperation",Jr="checkDateFormat",mg="checkNumberFormat",CM="parseDecimalNumber",Fb="getFormattedBarText",vo="activeCellChanged",Rb="openSuccess",wM="openFailure",yg="sheetCreated",ka="sheetsDestroyed",ag="aggregateComputation",xM="getUniqueRange",zd="removeUniquecol",Kc="checkUniqueRange",Ob="reApplyFormula",$c="clearFormulaDependentCells",zb="formulaInValidation",NY="beforeSort",bg="initiateSort",IM="updateSortedDataOnCell",og="sortComplete";var kY="beforeHyperlinkCreate",FY="afterHyperlinkCreate",RY="beforeHyperlinkClick",OY="afterHyperlinkClick";var Pd="setLinkModel";var Pb="initiateFilter";var rz="filterRangeAlert";var sa="wrapText",MM="onSave",DM="insert",EM="delete",Fa="insertModel",Sg="deleteModel",Bb="isValidation",Qo="cellValidation",jb="addHighlight";var TM="find",Vc="gotoHandler";var Cg="replace",Bd="replaceAll",Hb="showFindAlert",AM="findKeyUp",Vb="removeHighlight",zY="queryCellInfo",_b="count";var nz="protectSheet",sz="updateToggleItem",Dd="protectsheetHandler",Ub="replaceAllDialog",Mz="unprotectsheetHandler",PY="editAlert",Sd="readonlyAlert",Wb="setLockCells";var Nn="setMerge",LM="applyMerge",uo="mergedRange",pr="activeCellMergedRange",qb="insertMerge",kn="hideShow",jd="setCFRule",Gi="applyCF",po="clearCFRule",Hd="clear",NM="clearCF",Yb="setImage",jh="setChart",Gb="initiateChart",Hs="refreshRibbonIcons",Xo="refreshChart",kh="refreshChartSize",Qb="deleteChartColl";var Xb="focusChartBorder",kM="saveError",Rh="updateHighlight",Ed="beforeInsert",wg="beforeDelete",Mb="deleteHyperlink",Kb="moveOrDuplicateSheet",Vd="setAutoFill",az="refreshCell",FM="getFillInfo",$b="getautofillDDB",xg="rowFillHandler",Zb="getTextSpace",Jb="refreshClipboard",_d="updateView",Ta="selectionComplete",Ss="refreshInsertDelete",e0="getUpdatedFormulaOnInsertDelete",BY="beforeCellUpdate",RM="duplicateSheetFilterHandler",oz="unMerge",OM="checkFormulaRef",t0="parseFormulaArgument",zM="getCellRefValue",zc="commputeFormulaValue",Ud="getChartRowIdxFromClientY",Wd="getChartColIdxFromClientX",Ig="refreshChartCellOnInit",qd="localizedFormatAction",PM="moveSheetHandler",Yd="addListValidationDropdown",Mg="sheetRenameUpdate",Zc="updateSortCollection",aa="importModelUpdate";function Da(o,t,e,i,r,n,s){var a=o.value;if(a&&typeof a=="string"){if(a.includes(`
`))return{isNumber:!1,value:a};if(De(a))return{isNumber:!0,value:a};if(r&&a.includes(r)&&(s||o.format.includes(r)||o.format.includes("$"))&&(a=a.replace(r,"").trim()),e&&a.includes(e)&&Gd(a,t,e,i)&&(a=a.split(e).join("").trim()),i||(i=Ki(t).decimal),i!=="."&&a.includes(i)&&(a=a.replace(i,".").trim()),De(a))return{isNumber:!0,value:a};if(n&&a.split("/").length===2)try{var l=a.split(" ");if(l.length===2&&l[0].split("/").length===1){var h=hM(l[0]),c=hM(l[1]);a=h+c}else a=hM(a);return{isNumber:!0,value:a}}catch{return{isNumber:!1,value:a}}}else if(De(a))return{isNumber:!0,value:a};return{isNumber:!1,value:a}}function Gd(o,t,e,i){for(var r=!1,n=123456,s=n.toLocaleString(t),a=s.split(e).reverse(),l=o.split(i)[0].split(e),h=0;h<l.length&&(h===l.length-1?r=l[h].length===a[0].length:r=!Te(a[1])&&(h===0?l[h].length<=a[1].length:l[h].length===a[1].length),!!r);h++);return r}function pt(o,t){return o&&o[0]==="="&&(o.length>1||t)}function Or(o){var t=o;if(t=t.split("$").join(""),t.indexOf(":")>-1){var e=t.split(":");if(Db(e[0])&&Db(e[1]))return!0}else if(t.indexOf(":")<0&&Db(t))return!0;return!1}function Dz(o){return o.charCodeAt(0)>=65&&o.charCodeAt(0)<=90||o.charCodeAt(0)>=97&&o.charCodeAt(0)<=122}function KD(o,t){return t[1]===0&&t[3]===o.colCount-1}function Ez(o,t){return t[0]===0&&t[2]===o.rowCount-1}function Vo(o,t,e){return o&&t>=o[0]&&t<=o[2]&&e>=o[1]&&e<=o[3]}function Tz(o,t,e){for(var i,r,n=o.split(" "),s=0,a=n.length;s<a&&(i=ie(n[s]),r=Vo(i,t,e),!r);s++);return r}function Dg(o,t,e){var i=o[0]<=t[0]&&o[2]>=t[2]&&o[1]<=t[1]&&o[3]>=t[3];if(i)return!0;if(e){if(t[0]<o[0]&&t[2]<o[0]||t[0]>o[2]&&t[2]>o[2]||(t[0]<o[0]&&t[2]>o[0]&&(t[0]=o[0],i=!0),t[2]>o[2]&&(t[2]=o[2],i=!0),t[1]<o[1]&&t[3]<o[1]||t[1]>o[3]&&t[3]>o[3]))return!1;t[1]<o[1]&&t[3]>o[1]&&(t[1]=o[1],i=!0),t[3]>o[3]&&(t[3]=o[3],i=!0)}return i}function jY(o,t,e){var i=ji(e+1);return o?o.split(" ").forEach(function(r){var n=ie(r);if(Dg(n,t))o=o.split(r).join(i+(n[0]+1)+":"+i+t[0]+" "+i+(t[2]+2)+":"+i+(n[2]+1));else if(Dg(n,t,!0)){var s=void 0;t[0]>n[0]?s=i+(n[0]+1)+":"+i+t[0]:s=i+(t[2]+2)+":"+i+(n[2]+1),o=o.split(r).join(s)}}):o=i+"1:"+i+t[0]+" "+i+(t[2]+2)+":"+i+"1048576",o}function mn(o,t){return o||(o={}),o.isLocked?!0:o.isLocked===!1?!1:t&&t.isLocked?!0:!!(!o.isLocked&&t&&t.isLocked!==!1)}function Db(o){for(var t=o,e=0,i=t.length,r=0;r<i;r++)Dz(t[r])&&e++;var n=t.substring(0,e),s=n.length;if(s!==i&&s<4&&i!==1&&isNaN(parseInt(t,10))){var a=HY(n);if(a<1||a>16384)return!1;var l=t.substring(e,i);if(l.length>0){for(var h=!0,c=0;c<l.length;c++){var u=l.charCodeAt(c);if(u<48||u>57){h=!1;break}}if(h){var d=parseFloat(l);if(d>0&&d<1048577)return!0}}}return!1}function HY(o){var t=0,e=0;if(o=o.toUpperCase(),t<o.length&&o[t]==="!"){for(t++;t<o.length&&o[t]!=="!";)t++;t++}for(;t<o.length&&Dz(o[t]);){var i=o[t].charCodeAt(0);e=e*26+i-64,t++}return e===0?-1:e}function ce(o,t,e,i,r){i===void 0&&(i="rows");var n;if(o)if(e)for(var s=t;s<1/0;s++)if(n=o[""+i],n[t]&&n[t].hidden)t++;else if(r)r--,t++;else break;else for(var s=t;s>-1&&(n=o[""+i],n[t]&&n[t].hidden);s--)t--;return t}function Qd(o,t){var e=Object.keys(o);return(t?e.indexOf("fontSize")>-1:e.indexOf("fontSize")>-1&&Number(o.fontSize.split("pt")[0])>12)||e.indexOf("fontFamily")>-1||e.indexOf("borderTop")>-1||e.indexOf("borderBottom")>-1}function lz(o){return o>1048575?o-1048576:o<0?o+1048576:o}function hz(o){return o>16383?o-16384:o<0?o+16384:o}function ln(o,t,e,i,r,n,s){var a,l;if(t&&(l=r||Q(t[0],t[1],e,!1,!0),a=l.formula||""),a){n&&i.notify($c,{cellRef:st(t[0],t[1])}),a.indexOf("=")===0&&(a=a.slice(1)),a=a.split("(").join(i.listSeparator).split(")").join(i.listSeparator);for(var h=["+","-","*","/",">=","<=","<>",">","<","=","%","&","^"],c=void 0,u=a,d=0;d<h.length;d++)c=u.split(h[d]),u=c.join(i.listSeparator);c=u.split(i.listSeparator);for(var p=[],f=void 0,v=void 0,m=void 0,y=void 0,b=void 0,S=0;S<c.length;S++){if(m=c[S].includes("!"),m){var C=c[S].lastIndexOf("!");y=c[S].substring(0,C),b=c[S].substring(C+1).toUpperCase()}else b=c[S].toUpperCase();if(Or(b.trim())&&!b.includes("$")&&(!n||!m)){var x=VY(b),I=_Y(b),D=ie(b),M=void 0;s?M=[lz(o[0]-(t[0]-D[0])),hz(o[1]-(t[1]-D[1])),lz(o[0]-(t[0]-D[2])),hz(o[1]-(t[1]-D[3]))]:M=[o[0]-(t[0]-D[0]),o[1]-(t[1]-D[1]),o[0]-(t[0]-D[2]),o[1]-(t[1]-D[3])],M[1]<0||M[2]<0||M[3]<0||!n&&M[0]<0?f="#REF!":(n&&M[0]<0&&(M[0]=M[2]),f=st(M[0],M[1]),b.includes(":")&&(f+=":"+st(M[2],M[3])),f=Or(f)?f:"#REF!"),v={},m&&(f=y+"!"+f),v[c[S]]=""+x+f+I,c[S].includes(":")?p.splice(0,0,v):p.push(v)}}var E=void 0,A=void 0;a=l.formula;for(var L=a,S=0;S<p.length;S++){E=Object.keys(p[S])[0],A=p[S][""+E];for(var N=E.length,R=L.indexOf(E),P="",k=0;k<A.length;k++)P+=" ";a=a.slice(0,R)+A+a.slice(R+N),L=L.slice(0,R)+P+L.slice(R+N)}return a}else return null}function VY(o){for(var t="",e=0;e<o.length&&o[e]===" ";e++)t+=" ";return t}function _Y(o){for(var t="",e=o.length-1;e>=0&&o[e]===" ";e--)t=" "+t;return t}function gr(o,t,e,i,r){var n={cell:e.cell,rowIndex:e.rowIdx,colIndex:e.colIdx,cancel:!1,sheet:t.name};if(e.preventEvt||o.trigger(BY,n),!e.eventOnly&&!n.cancel){if(e.valChange){var s=Q(n.rowIndex,n.colIndex,t),a=!e.preventEvt&&o.getDisplayText(s),l=!!(s&&s.formula);Zt(n.rowIndex,n.colIndex,t,n.cell,!e.pvtExtend);var h=Q(n.rowIndex,n.colIndex,t,!1,!0);e.mergedCells&&(delete h.value,delete h.formula),h.formattedText&&delete h.formattedText,n.cell&&n.cell.style&&cz(h.style);var c={action:"updateCellValue",address:[n.rowIndex,n.colIndex],sheetIndex:Ct(o,t.name),value:l&&!h.formula?h.value||(h.value===0?"0":""):h.formula||h.value||(h.value===0?"0":""),skipFormatCheck:e.skipFormatCheck,isRandomFormula:e.isRandomFormula,isDelete:e.isDelete,deletedRange:e.deletedRange,fillType:e.fillType,cellInformation:i,isRedo:!r,actionName:e.fillType,isPaste:e.requestType==="paste"};if(o.notify(Xc,c),e.isFormulaDependent=c.isFormulaDependent,e.requestType&&n.cell===null&&Zt(n.rowIndex,n.colIndex,t,n.cell,!e.pvtExtend),e.cellDelete&&(delete h.value,delete h.formula,delete h.hyperlink),e.uiRefresh&&o.serviceLocator.getService("cell").refresh(n.rowIndex,n.colIndex,e.lastCell,e.td,e.checkCF,e.checkWrap,e.skipFormatCheck,e.isRandomFormula,e.fillType),!e.preventEvt){var u=o.getDisplayText(h);if(u!==a){var d=Q(n.rowIndex,n.colIndex,t,!1,!0).value;d=d||(d===0?"0":"");var p={value:d,oldValue:a,formula:h.formula||"",address:t.name+"!"+st(n.rowIndex,n.colIndex),displayText:u};e.requestType&&(p.requestType=e.requestType),o.trigger("cellSave",p)}}}else if(Zt(n.rowIndex,n.colIndex,t,n.cell,!e.pvtExtend),n.cell&&n.cell.style){var h=Q(n.rowIndex,n.colIndex,t,!1,!0);cz(h.style)}}return n.cancel}function cz(o){o.border===""?(delete o.border,delete o.borderTop,delete o.borderBottom,delete o.borderLeft,delete o.borderRight):(o.borderTop===""&&delete o.borderTop,o.borderBottom===""&&delete o.borderBottom,o.borderLeft===""&&delete o.borderLeft,o.borderRight===""&&delete o.borderRight)}function U0(o,t,e){for(var i=o,r=o,n=t,s=t,a=e.usedRange.rowIndex,l=e.usedRange.colIndex,h=function(d){for(var p=0;p<=l;p++)if(!Te(Q(d,p,e,null,!0).value))return!1;return!0},c=function(d){for(var p=i;p<=r;p++)if(!Te(Q(p,d,e,null,!0).value))return!1;return!0},u=i;u<=a&&!(Te(Q(u,t,e,null,!0).value)&&h(u));u++)r=u;for(var u=i;u>=0&&!(Te(Q(u,t,e,null,!0).value)&&h(u));u--)i=u;for(var u=n;u<=l&&!(Te(Q(o,u,e,null,!0).value)&&c(u));u++)s=u;for(var u=n;u>=0&&!(Te(Q(o,u,e,null,!0).value)&&c(u));u--)n=u;return[i,n,r,s]}function UY(o,t,e){var i=ie(o.model.selectedRange),r=0,n=0;if(o.modelType==="Column"){if((e||o.insertType==="before"&&o.isUndoRedo)&&(i=[0,o.start,0,o.end]),o.insertType==="before")t[1]<=i[1]&&t[3]>=i[1]?(r=0,n=i[3]-i[1]+1):i[1]<t[1]&&(r=n=i[3]-i[1]+1);else{if(o.isUndoRedo){var s=o.end-o.start+1;i=[0,o.start-s,0,o.end-s]}t[1]<=i[3]&&t[3]>=i[3]?(r=0,n=i[3]-i[1]+1):i[3]<t[3]&&(r=n=i[3]-i[1]+1)}return[t[0],t[1]+r,t[2],t[3]+n]}else{if((e||o.insertType==="above"&&o.isUndoRedo)&&(i=[o.start,0,o.end,0]),o.insertType==="above")t[0]<=i[0]&&t[2]>=i[0]?(r=0,n=i[2]-i[0]+1):i[0]<t[0]&&(r=n=i[2]-i[0]+1);else{if(o.isUndoRedo){var s=o.end-o.start+1;i=[o.start-s,0,o.end-s,0]}t[0]<=i[2]&&t[2]>=i[2]?(r=0,n=i[2]-i[0]+1):i[2]<t[2]&&(r=n=i[2]-i[0]+1)}return[t[0]+r,t[1],t[2]+n,t[3]]}}function WY(o,t){var e,i=0,r=0;return o.modelType==="Column"?(e=[0,o.start,o.model.usedRange.rowIndex,o.end],e[3]<t[1]?i=r=e[3]-e[1]+1:e[1]>=t[1]&&e[3]<=t[3]?r=e[3]-e[1]+1:e[1]>=t[1]&&e[1]<=t[3]?r=t[3]-e[1]+1:e[1]<t[1]&&e[3]>=t[1]?(i=t[1]-e[1],r=e[3]-e[1]+1):e[1]<t[1]&&e[3]<t[3]&&(i=e[3]-t[1]+(e[3]-e[1])+1,r=e[3]-e[1]+1),[t[0],t[1]-i,t[2],t[3]-r]):(e=[o.start,0,o.end,o.model.usedRange.colIndex],e[2]<t[0]?i=r=e[2]-e[0]+1:e[0]>=t[0]&&e[2]<=t[2]?r=e[2]-e[0]+1:e[0]>=t[0]&&e[0]<=t[2]?r=t[2]-e[0]+1:e[0]<t[0]&&e[2]>=t[0]?(i=t[0]-e[0],r=e[2]-e[0]+1):e[0]<t[0]&&e[2]<t[2]&&(i=e[2]-t[0]+(e[2]-e[0])+1,r=e[2]-e[0]+1),[t[0]-i,t[1],t[2]-r,t[3]])}function Eg(o,t,e,i,r,n,s){for(var a,l,h=o.length-1;h>=0;h--){a=o[h].range.trim().split(",");for(var c=0;c<a.length;c++)if(l=ie(a[c].includes(":")?a[c]:a[c]+":"+a[c]),e>=l[0]&&i>=l[1]&&e<=l[2]&&i<=l[3]){t.push(o[h]),o.splice(h,1);break}else if(r&&r[0]>=l[0]&&r[1]>=l[1]&&r[0]<=l[2]&&r[1]<=l[3]){var u={action:"autofillWithCF",cFColor:o[h].cFColor,range:Ve(n),type:o[h].type,value:o[h].value};o.splice(h,1);for(var d=0,p=s.conditionalFormats;d<p.length&&!(p[d].action==="autofillWithCF"&&p[d].range===u.range);d++)d===p.length-1&&(t.push(u),s.conditionalFormats.push(u));break}}}function i0(o,t){for(var e=t.trim().split(","),i,r,n,s,a,l=function(c){for(var u=0;u<e.length;u++){if(a=ie(e[u].includes(":")?e[u]:e[u]+":"+e[u]),c[0]<=a[0]&&c[1]<=a[1]&&c[2]>=a[2]&&c[3]>=a[3])return!0;if(n=c[0]>=a[0]&&c[0]<=a[2],s=c[2]>=a[0]&&c[2]<=a[2],i=c[1]>=a[1]&&c[1]<=a[3],r=c[3]>=a[1]&&c[3]<=a[3],n&&s){if((i||r||c[1]<a[1]&&c[3]>a[3])&&(c[0]-a[0]>0||a[2]-c[2]>0)||i&&c[1]!==a[1]||r&&c[3]!==a[3])return!0}else if(i&&r){if((n||s||c[0]<a[0]&&c[2]>a[2])&&(c[1]-a[1]>0||a[3]-c[3]>0))return!0;if(n){if(c[0]!==a[0])return!0}else if(s&&c[2]!==a[2])return!0}else if(n||s){if(i){if(c[1]!==a[1]||c[0]-a[0]>0)return!0;if(a[2]-c[2]>0)return!0}else if(r){if(c[3]!==a[3]||c[0]-a[0]>0)return!0;if(a[2]-c[2]>0)return!0}else if(c[1]<a[1]&&c[3]>a[3])return!0}else if((i||r)&&c[0]<a[0]&&c[2]>a[2])return!0}return!1},h=0;h<o.length;h++)if(l(o[h]))return!0;return!1}function Td(o,t,e){var i;e||(e=Ki(t.locale));for(var r=0;r<o.length;r++)De(o[r])?e.group==="."&&(o[r]=o[r].toString(),o[r].indexOf(".")&&Gd(o[r],t.locale,e.group,e.decimal)&&(o[r]=o[r].split(e.group).join(""))):(i={formattedText:o[r],value:o[r],format:"General",cell:{value:o[r],format:"General"},isEdit:!0},t.notify(yr,i),De(i.value)&&(o[r]=i.value.toString()));return o}function Az(o,t){var e=o.getActiveSheet(),i=[[t.topIndex+o.frozenRowCount(e),t.leftIndex+o.frozenColCount(e),t.bottomIndex,t.rightIndex]];if(e.frozenRows||e.frozenColumns){var r=o.frozenRowCount(e),n=o.frozenColCount(e),s=xe(e.topLeftCell);if(r&&n){i.push([s[0],s[1],r-1,n-1]);var a=xe(e.paneTopLeftCell);i.push([a[0],s[1],t.bottomIndex,n-1])}r&&i.push([s[0],t.leftIndex+n,r-1,t.rightIndex]),n&&i.push([t.topIndex+r,s[1],t.bottomIndex,n-1])}return i}function W0(o){if(lt(o.sheet,o.rowIdx)){var t=ce(o.sheet,o.rowIdx,!0);t<o.rowIdx+o.cell.rowSpan&&(o.rowIdx=t,o.isMergedHiddenCell=!0)}if(Ft(o.sheet,o.colIdx)){var t=ce(o.sheet,o.colIdx,!0,"columns");t<o.colIdx+o.cell.colSpan&&(o.colIdx=t,o.isMergedHiddenCell=!0)}}function xs(o){return o.workbookOpenModule&&o.workbookOpenModule.preventFormatCheck}function Xd(o){var t=new Nt,e={intl:t,updateValue:!0,value:"",curSymbol:nh(o.locale,Ws)},i={args:e,intl:t},r=Ki(o.locale);return function(n){if(!n.format&&n.value&&!De(n.value)&&(e.cell=n,e.value=n.value,o.notify(Jr,e),!n.format)){var s=n.value.toString();s.includes(i.args.curSymbol)||s.includes(r.group)||s.includes("%")?(i.fResult=s,o.notify(mg,i)):r.decimal!=="."&&!De(s)&&s.includes(r.decimal)&&(s=s.replace(r.decimal,"."),De(s)&&(n.value=s))}}}function BM(o,t,e){var i=new Pe;t.length&&i.where(xt.and(t));var r=o.executeLocal(i);if(e)for(var n=0,s=e.length;n<s&&r.length;n++)i=new Pe,e[n].length&&i.where(xt.or(e[n])),r=new oe(r).executeLocal(i);return r}function Pl(o,t,e){return o&&o.isReadOnly||e&&e.isReadOnly||t&&t.isReadOnly}function Hi(o,t,e){for(var i=o.getActiveSheet(),r=g(t)?tt(ie(i.selectedRange)):t,n=r[0];n<=r[2];n++)for(var s=r[1];s<=r[3];s++){var a=Q(n,s,i);if(Pl(a,Ht(i,s),Yr(i,n)))return e&&o.notify(Sd,null),!0}return!1}function jM(o,t){var e=t||o.selectedRange,i=ie(e),r=o.colCount,n=o.rowCount;return i[2]===n-1&&i[0]===0?e=e.replace(/[0-9]/g,""):i[3]===r-1&&i[2]===0&&(e=e.replace(/\D/g,"")),e}function os(o){if(window.devicePixelRatio%1>0){var t=o*window.devicePixelRatio%1;return o+(t?(t>.5?1-t:-1*t)/window.devicePixelRatio:0)}return o}function md(o,t,e){if(t.length){var i=o.getActiveSheet(),r,n=o,s=o.frozenColCount(i),a=e&&e[0]||(s?xe(i.topLeftCell)[1]:n.viewport.leftIndex),l=e&&e[1]||n.viewport.rightIndex;t.forEach(function(h){for(var c=a;c<=l;c++){c===s&&(c+=n.viewport.leftIndex);var u=Q(h-1,c,i,!1,!0);if((!u.rowSpan||u.rowSpan===1||!u.colSpan||u.colSpan===1)&&(!u.style||!u.style.borderBottom||u.style.borderBottom==="none")&&(r=Q(h,c,i,!1,!0).style,r&&r.borderTop)){var d=o.getCell(h-1,c);if(d&&d.style.borderBottom){var p=o.getCell(h,c);p&&(d.style.borderBottom="",p.style.borderTop=r.borderTop)}}}})}}function qY(o){var t=o.toString();if(o===parseInt(t,10))return parseInt(t,10)+"  ";var e=t.indexOf(".")>-1?t.split(".")[1]:0,i=Math.pow(10,e.toString().replace("-","").length),r=Math.abs($D(e,i));return e/r+"/"+i/r}function $D(o,t){return o=Number(o),t=Number(t),t?$D(t,o%t):o}function Yn(o){o=Number(o),o=o>0&&o<1?1+o:o===0?1:o,o>60&&(o-=1);var t=new Date("01/01/1900"),e=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());return new Date(new Date((o-1)*(1e3*3600*24)+e).toUTCString().replace(" GMT",""))}function ls(o,t,e){var i=new Date("01/01/1900"),r=_o(o)?o:new Date(o),n=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),s=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),a=(s-n)/(1e3*3600*24);return(t?a:parseInt(a.toString(),10))+(e?0:a>60?2:1)}function _o(o){return Object.prototype.toString.call(o)==="[object Date]"&&!isNaN(o.valueOf())}function De(o){return o-parseFloat(o)>=0}function hM(o){return Function('"use strict";return ('+o+")")()}function cM(o,t,e,i,r,n){var s=ut.getDependables(Br,e,null).dateObject,a=s.dateTimeFormats.availableFormats,l={dateObj:null,isCustom:!1,type:""},h,c=function(){l.type==="time"&&(l.dateObj=new Date((h?h.toDateString():"01/01/1900")+" "+l.dateObj.toLocaleTimeString()))};if(i&&(l.dateObj=t.parseDate(o,{format:i}),l.dateObj&&(l.type=o.toString().indexOf(":")>-1?"time":"datetime",c(),l.isCustom=!0)),g(l.dateObj)){if(o=o.toString(),o&&o.indexOf("/")>-1||o.indexOf("-")>0){var u=r&&r.format||i;if(u){var d=u.toLowerCase().includes("dd-mm-yy");if((d||u.toLowerCase().includes("dd/mm/yy"))&&(u=d?"d-M-y":"d/M/y",l.dateObj=t.parseDate(o,{format:u,skeleton:"yMd"}),l.dateObj))return l.type="date",l}}var p=function(v){if(v.indexOf(":")<0)for(var m=0,y=Object.keys(s.dateFormats);m<y.length;m++){var b=y[m];if(l.dateObj=t.parseDate(v,{format:s.dateFormats[""+b],skeleton:b}),l.dateObj){l.type="date",l.isCustom=!1;break}}if(g(l.dateObj))for(var S=void 0,C=0,x=Object.keys(a);C<x.length;C++){var b=x[C];if(S=a[""+b],l.dateObj=t.parseDate(v,{format:S,skeleton:b}),!l.dateObj&&v.indexOf(":")>-1&&S.indexOf(":")>-1&&(l.dateObj=t.parseDate(v,{format:S.split(" ")[0]})),l.dateObj){l.type=v.toString().indexOf(":")>-1?"time":"datetime",c(),l.isCustom=!0;break}}if(g(l.dateObj))for(var I=0,D=Object.keys(s.timeFormats);I<D.length;I++){var b=D[I];if(l.dateObj=t.parseDate(v,{format:s.timeFormats[""+b],skeleton:b}),l.dateObj){l.type="time",c(),l.isCustom=!1;break}}};if(n){var f=o.split(" ");f.length>=2&&(p(f.shift()),l.dateObj&&(h=l.dateObj,l.dateObj=null,p(f.join(" ")),l.dateObj&&(l.type="datetime")))}else p(o)}return o!=="#DIV/0!"&&!l.dateObj&&new Date(o).toString()!=="Invalid Date"&&(l.dateObj=new Date(o),l.type="date"),l}function Ad(o,t,e){if(o&&o!=="."&&o!=="-"){var i=o.toString(),r=Number.MAX_SAFE_INTEGER.toString().length;if(i.startsWith("-")&&(i=i.slice(1),i=i.includes("-")?o:i),/^\d*\.?\d*$/.test(i))return t&&(i.length>r||e&&(i.startsWith("0")||i.endsWith("0")))?o:parseFloat(o)}return o}var r0="spreadsheetLocale",YY={SortOutOfRangeError:"Select a cell or range inside the used range and try again."};function Aa(o,t,e,i,r,n,s,a,l,h,c,u){return l===void 0&&(l=!0),new Promise(function(d){d((function(){var p,f=t.lastIndexOf("!");f>-1?(p=Ct(o,t.substring(0,f)),t=t.substring(f+1)):p=o.activeSheetIndex;var v=ke(o,p),m=Ji(h||t),y={sheet:v,indexes:m,formulaCellRef:s,sheetIndex:a,promise:new Promise(function(b){b((function(){})())})};return o.notify(Bh,y),y.promise.then(function(){var b,S,C,x=m[0],I=o.frozenRowCount(v),D=o.frozenColCount(v),M=!!u;if(e){C=[];var E,A,L,N,R,P,k,B;i?(P=Ki(o.locale),k=new Nt(o.locale)):B=Xd(o),t.split(",").forEach(function(he,ue){for(m=ie(he),E=0,x=m[0];x<=m[2];){for(A=C[E]||{},S=Yr(v,x),b=m[1];b<=m[3];){if(l&&lt(v,x)&&!(n&&as(v,x))){x++;continue}N=ji(b+1);var ne=S?Q(x,b,v):null;if(i){if(ne&&(ne.value||ne.value===0||ne.formula))ne.formattedText&&ne.format&&!ne.format.includes("*")?Bs(ne.format,!1)?A[N]=Yn(ne.value):A[N]=ne.formattedText.toString().trim():A[N]=n0(o,ne,x,b,p,!1,k),R=ne.value,typeof R=="string"&&(P.decimal!=="."&&R.includes(P.decimal)?(L=R.replace(P.decimal,"."),De(L)&&(R=parseFloat(L))):De(R)&&(R=parseFloat(R)));else if(ne&&ne.hyperlink){var le=ne.hyperlink;typeof le=="string"?(A[N]=le,R=le):le.address?(A[N]=le.address,R=le.address):(A[N]="",R="")}else A[N]="",R=null;A[N+"_value"]=R}else if((ne&&(ne.formula||!g(ne.value)||ne.hyperlink)||Object.keys(A).length)&&(b===c?(R={value:n0(o,ne,x,b,p,!0)},R.value&&typeof R.value=="string"&&(De(R.value)&&!ne.value.toString().includes(`
`)?(!ne.format||ne.format!=="@")&&(R.value=parseFloat(R.value)):ne.format||(B(ne),De(ne.value)&&!ne.value.toString().includes(`
`)&&(R.value=parseFloat(ne.value)))),A[N]=pe({},ne,R)):A[N]=ne),ne&&(ne.rowSpan&&ne.rowSpan!==1||ne.colSpan&&ne.colSpan!==1)){C=[{throwMergeAlert:!0}];return}b===m[3]&&Object.keys(A).length&&(A.__rowIndex=(x+1).toString(),C[E]=A,M&&ue===0&&!as(v,x)&&u.push(A),E++),b++}x++}})}else{C=new Map;for(var F=!!(!i&&r&&r.length);x<=m[2];){if(F&&x>=I&&x<r[0]){x=r[0];continue}if(!i&&lt(v,x)){x++;continue}for(S=Yr(v,x),b=m[1];b<=m[3];){var O={cell:Q(x,b,v),address:st(x,b),rowIndex:x,colIndex:b};o.trigger(zY,O);var z=Q(x,b,v,!1,!0);if(z.formula&&z.formula.toUpperCase().includes("UNIQUE")&&o.notify(zl,{cell:z,rowIdx:x,colIdx:b,sheetIndex:o.activeSheetIndex,address:O.address}),z.colSpan>1&&z.rowSpan>1)for(var Y=void 0,K=x,U=x+z.rowSpan;K<U;K++)for(var q=b,ae=b+z.colSpan;q<ae;q++)K===x&&q===b||(Y=new Object,K!==x&&(Y.rowSpan=x-K),q!==b&&(Y.colSpan=b-q),v.rows[K]&&v.rows[K].cells&&v.rows[K].cells[q]&&(delete v.rows[K].cells[q].value,delete v.rows[K].cells[q].formula),Zt(K,q,v,Y,!0));else if(z.colSpan>1)for(var K=b+1,U=b+z.colSpan;K<U;K++)Zt(x,K,v,{colSpan:b-K},!0),v.rows[x]&&v.rows[x].cells&&v.rows[x].cells[K]&&(delete v.rows[x].cells[K].value,delete v.rows[x].cells[K].formula);else if(z.rowSpan>1)for(var K=x+1,U=x+z.rowSpan;K<U;K++)Zt(K,b,v,{rowSpan:x-K},!0),v.rows[K]&&v.rows[K].cells&&v.rows[K].cells[b]&&(delete v.rows[K].cells[b].value,delete v.rows[K].cells[b].formula);if(!i&&Ft(v,b)){b++;continue}if(F&&b>=D&&b<r[1]){b=r[1];continue}if(z.style){var te={};Object.assign(te,z.style),z.style=te}C.set(O.address,z),b++}x++}}return C})})())})}function n0(o,t,e,i,r,n,s){if(t){if(t.formula&&g(t.value)&&o.notify(zl,{cell:t,rowIdx:e,colIdx:i,sheetIndex:r}),g(t.value))return"";if(t.format){var a={value:t.value,formattedText:t.value,cell:t,format:t.format,checkDate:!n,rowIndex:e,colIndex:i,dataUpdate:!0};return o.notify(yr,a),a.dateObj&&a.dateObj.toString()!=="Invalid Date"?a.dateObj:n?a.value:a.formattedText.toString().trim()}else{if(n)return t.value;var l=t.value;if(De(l)&&(l=Number(t.value).toString(),l.includes(".")||l.length>11)){var h={args:{value:l,updateValue:!0},fResult:l,cellVal:l,intl:s};o.notify(CM,h),l=h.fResult}return l}}else return""}function s0(o,t,e,i){var r,n=0,s,a=o.length;i&&o.length>0&&o.sort(function(u,d){return!g(u)&&!Te(u.index)&&!g(d)&&!Te(d.index)?u.index-d.index:0});for(var l=function(u){if(!g(o[u])&&!Te(o[u].index)&&(s=n=o[u].index-u,delete o[u].index),n>0){for(r=0;n--;)t?(e.createSheet(u+r),r++):o.splice(u,0,null);u+=s,a+=s}if(t){o[u].id<1&&(o[u].id=Lz(e.sheets),o[u].properties&&(o[u].properties.id=o[u].id)),o[u].name||e.setSheetPropertyOnMute(o[u],"name","Sheet"+KY(e));var d=0;o[u].rows.forEach(function(p){d=Math.max(d,p&&p.cells&&p.cells.length-1||0)}),e.setSheetPropertyOnMute(o[u],"usedRange",{rowIndex:o[u].rows.length?o[u].rows.length-1:0,colIndex:d})}h=u},h,c=0;c<a;c++)l(c),c=h}var ZD=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),ki=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},GY=(function(o){ZD(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.setProperties=function(e,i){var r=this;if(this.parentObj.isComplexArraySetter&&this.controlParent&&this.controlParent.isAngular){if(Object.keys(e).length){this.parentObj.currRangeIdx===void 0?this.parentObj.currRangeIdx=0:this.parentObj.currRangeIdx+=1;var n=this.parentObj.ranges[this.parentObj.currRangeIdx];n&&n.info&&(this.info=n.info),setTimeout(function(){r.parentObj.currRangeIdx!==void 0&&delete r.parentObj.currRangeIdx})}else if(this.controlParent.tagObjects[0].instance&&this.controlParent.tagObjects[0].instance.hasChanges&&!this.controlParent.tagObjects[0].instance.isInitChanges){var s=this.controlParent.sheets.indexOf(this.parentObj);if(this.parentObj.changedRangeIdx===void 0){for(var a,l=this.controlParent.tagObjects[0].instance.list[s].tagObjects,h=0;h<l.length;h++)if(l[h].name==="ranges"){l[h].instance.list.forEach(function(c,u){c.hasChanges&&(a=u)});break}this.parentObj.changedRangeIdx=a}}}o.prototype.setProperties.call(this,e,i)},ki([w(null)],t.prototype,"dataSource",void 0),ki([w("A1")],t.prototype,"startCell",void 0),ki([w(null)],t.prototype,"query",void 0),ki([w(null)],t.prototype,"fieldsOrder",void 0),ki([w(!0)],t.prototype,"showFieldAsHeader",void 0),ki([w("")],t.prototype,"template",void 0),ki([w("A1")],t.prototype,"address",void 0),t})(Oe),QY=(function(o){ZD(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ki([w(0)],t.prototype,"rowIndex",void 0),ki([w(0)],t.prototype,"colIndex",void 0),t})(Oe),XY=(function(o){ZD(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ki([w(null)],t.prototype,"rows",void 0),ki([w(null)],t.prototype,"columns",void 0),ki([Ce({},DY)],t.prototype,"protectSettings",void 0),ki([Gt([],GY)],t.prototype,"ranges",void 0),ki([Gt([],TY)],t.prototype,"conditionalFormats",void 0),ki([w(0)],t.prototype,"index",void 0),ki([w("")],t.prototype,"name",void 0),ki([w(100)],t.prototype,"rowCount",void 0),ki([w(100)],t.prototype,"colCount",void 0),ki([w("A1:A1")],t.prototype,"selectedRange",void 0),ki([w("A1")],t.prototype,"activeCell",void 0),ki([Ce({},QY)],t.prototype,"usedRange",void 0),ki([w("A1")],t.prototype,"topLeftCell",void 0),ki([w(!0)],t.prototype,"showHeaders",void 0),ki([w(!0)],t.prototype,"showGridLines",void 0),ki([w(!1)],t.prototype,"isProtected",void 0),ki([w("Visible")],t.prototype,"state",void 0),ki([w(0)],t.prototype,"frozenRows",void 0),ki([w(0)],t.prototype,"frozenColumns",void 0),ki([w("A1")],t.prototype,"paneTopLeftCell",void 0),ki([w("")],t.prototype,"password",void 0),ki([w(null)],t.prototype,"standardHeight",void 0),ki([w(!1)],t.prototype,"isSheetCalculated",void 0),t})(Oe);function Ct(o,t){var e;t.startsWith("'")&&t.endsWith("'")&&(t=t.replace(/''/g,"'").replace(/^'|'$/g,""));for(var i=0;i<o.sheets.length;i++)if(o.sheets[i].name.toLowerCase()===t.toLowerCase()){e=i;break}return e}function Cn(o,t){for(var e,i=0;i<o.sheets.length;i++)if(o.sheets[i].id===t){e=i;break}return e}function na(o){var t=o.lastIndexOf("!");return t>-1?o.substring(0,t).replace(/'/gi,""):o.replace(/'/gi,"")}function uM(o,t,e){for(var i=e.length,r=0;r<i;r++)if(e[r].sheet.toUpperCase()===t.toUpperCase())return e[r].index;return-1}function lg(o,t,e,i){e===void 0&&(e={}),o.setSheetPropertyOnMute(e,"selectedRange",i?e.selectedRange+" "+t:t)}function uz(o){return o&&o.selectedRange||"A1"}function ke(o,t){return o.sheets[t]}function KY(o){var t=[];o.sheets.forEach(function(i){t.push(i.name.toLowerCase())});for(var e=0;e<t.length;e++)if(t.indexOf("sheet"+o.sheetNameCount)>-1)o.sheetNameCount++;else return o.sheetNameCount++;return o.sheetNameCount++}function Lz(o){var t=0;return o.forEach(function(e){t=Math.max(e.id,t)}),t+1}function ng(o,t,e){var i=t||o.sheets;i.forEach(function(r){if(r.id=r.id||0,r.name=r.name||"",o.setSheetPropertyOnMute(r,"rowCount",r.rowCount||100),o.setSheetPropertyOnMute(r,"colCount",r.colCount||100),o.setSheetPropertyOnMute(r,"topLeftCell",r.topLeftCell||"A1"),o.setSheetPropertyOnMute(r,"activeCell",r.activeCell||"A1"),o.setSheetPropertyOnMute(r,"selectedRange",r.selectedRange||r.activeCell+":"+r.activeCell),o.setSheetPropertyOnMute(r,"usedRange",r.usedRange||{rowIndex:0,colIndex:0}),o.setSheetPropertyOnMute(r,"ranges",r.ranges?r.ranges:[]),o.setSheetPropertyOnMute(r,"rows",r.rows&&pe([],r.rows,null,!0)||[]),o.setSheetPropertyOnMute(r,"columns",r.columns||[]),o.setSheetPropertyOnMute(r,"showHeaders",Te(r.showHeaders)?!0:r.showHeaders),o.setSheetPropertyOnMute(r,"showGridLines",Te(r.showGridLines)?!0:r.showGridLines),o.setSheetPropertyOnMute(r,"state",r.state||"Visible"),r.maxHgts=r.maxHgts||[],r.isImportProtected=r.isProtected&&e,r.protectSettings=r.protectSettings||{selectCells:!1,formatCells:!1,formatRows:!1,formatColumns:!1,insertLink:!1},r.isProtected=r.isProtected||!1,!r.paneTopLeftCell||r.paneTopLeftCell==="A1"){r.frozenRows=r.frozenRows?r.frozenRows:0,r.frozenColumns=r.frozenColumns?r.frozenColumns:0;var n=xe(r.topLeftCell);o.setSheetPropertyOnMute(r,"paneTopLeftCell",st(r.frozenRows?n[0]+r.frozenRows:n[0],r.frozenColumns?n[1]+r.frozenColumns:n[1]))}s0(r.columns),$Y(r.rows,e)}),s0(i,!0,o)}function $Y(o,t){o.forEach(function(e){e&&e.cells&&s0(e.cells,null,void 0,t)}),s0(o,null,void 0,t)}function Gn(o,t){return t===void 0&&(t=o.activeSheetIndex),ke(o,t).name}function a0(o,t,e,i,r){var n=!!e;e=e||[o.activeSheetIndex];var s=Gn(o);t=ZY(o.sheets,t,o.activeSheetIndex>t);var a={action:"moveSheet",eventArgs:{position:t,sheetIndexes:e,cancel:!1}};i&&o.trigger("actionBegin",a),a.eventArgs.cancel||(o.notify(PM,{prevIndex:o.activeSheetIndex,currentIndex:t}),e.forEach(function(l,h){o.sheets.splice(t+h,0,o.sheets.splice(l+(t>l?-1*h:0),1)[0])}),o.setProperties({activeSheetIndex:r?Ct(o,s):t>e[0]?t-(e.length-1):t},!0),o.notify(Kb,{refresh:n}),i&&(delete a.eventArgs.cancel,o.trigger("actionComplete",a)))}function JD(o,t,e,i){t=Te(t)?o.activeSheetIndex:t;var r={action:"duplicateSheet",eventArgs:{sheetIndex:t,cancel:!1}};if(e&&o.trigger("actionBegin",r),!r.eventArgs.cancel){var n=ke(o,t),s=n.name,a=pe({},n.properties?n.properties:n,{},!0);a.id=Lz(o.sheets);var l=a.name;/^\(\d+\)$/.test("("+l.split(" (")[1])&&(l=l.split(" (")[0]);var h=[];o.sheets.forEach(function(d){h.push(d.name)});for(var c=2;;c++){var u=" ("+c+")";if((l+u).length>31&&(l=l.slice(0,31-u.length)),h.indexOf(l+u)===-1){a.name=l+u;break}}o.notify(RM,{sheetIndex:t,newSheetIndex:t+1}),o.notify(Zc,{isDuplicate:!0,curSheetIndex:t,newSheetIndex:t+1}),a.rows.forEach(function(d){!d||!d.cells||d.cells.forEach(function(p){if(p){if(p.image){var f=p.image;f.forEach(function(m){m.id=Lt(o.element.id+"_overlay_picture_")})}var v=p.chart;v&&v.forEach(function(m){var y=m.range.lastIndexOf("!"),b=m.range.substring(0,y),S=a.name;b.startsWith("'")&&b.endsWith("'")&&(b=b.slice(1,-1),S="'"+S+"'"),b===s&&(m.range=S+m.range.substring(y),m.id=Lt(m.id||"e_spreadsheet_chart"))})}})}),o.createSheet(t+1,[a]),o.notify(At,{action:"addSheet",sheetName:"Sheet"+a.id,visibleName:a.name,sheetId:a.id}),i||o.setProperties({activeSheetIndex:t+1},!0),o.notify(Kb,{refresh:!0,isDuplicate:!0}),e&&(delete r.eventArgs.cancel,o.trigger("actionComplete",r))}}function ZY(o,t,e){for(var i=t;e?i>=0:i<o.length;e?i--:i++)if(!(o[i].state==="Hidden"||o[i].state==="VeryHidden")){t=i;break}return t}var JY=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),dM=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};function Q(o,t,e,i,r){var n=Yr(e,o);if(!n||!n.cells)if(i)n?e.rows[o].cells=[]:e.rows[o]={cells:[]};else return r?{}:null;return e.rows[o].cells[t]||(r?{}:null)}function Zt(o,t,e,i,r){e.rows[o]?e.rows[o].cells||(e.rows[o].cells=[]):e.rows[o]={cells:[]},r&&e.rows[o].cells[t]?pe(e.rows[o].cells[t],i,null,!0):e.rows[o].cells[t]=i}function eE(o,t){var e={fontFamily:"Calibri",verticalAlign:"bottom",textIndent:"0pt",backgroundColor:"#ffffff",color:"#000000",textAlign:"left",fontSize:"11pt",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",border:"",borderLeft:"",borderTop:"",borderRight:"",borderBottom:""},i={},r;return Object.keys(t?e:o).forEach(function(n){r=o[""+n],r!==e[""+n]&&(i[""+n]=r)}),i}function _c(o,t,e,i,r){if(t===void 0&&(t=!0),e.allowWrap){for(var n=e.getAddressInfo(o),s=n.indices,a=ke(e,n.sheetIndex),l=n.sheetIndex===e.activeSheetIndex,h=!i,c=s[0];c<=s[2];c++)for(var u=s[1];u<=s[3];u++)h=gr(e,a,{cell:{wrap:t},rowIdx:c,colIdx:u,preventEvt:i}),!h&&l&&e.notify(sa,{range:[c,u,c,u],wrap:t,sheet:a,initial:!0,isPublic:r});e.setProperties({sheets:e.sheets},!0)}}function Ho(o){var t;if(o.indexOf("[")>-1){var e=o.split("[")[1].split("]")[0],i=HM();i.indexOf(e)>-1&&(t=e)}return t}function HM(){return["Black","Blue","Cyan","Green","Magenta","Red","White","Yellow"]}function Bs(o,t,e,i){var r;if(o.includes('"')){var n=o.split(";"),s,a;n.forEach(function(l,h){for(var c=0;c<l.length;c++)if(l[c]==='"'&&l[c-1]!=="\\"){s=c;do s=l.indexOf('"',s+1),a=l[s-1];while(a==="\\"||a==="_"||a==="*");if(s===-1)break;l=l.substring(0,c)+l.substring(s+1),c--}n[h]=l}),o=n.join(";")}return(o.includes("d")||o.includes("y"))&&!o.includes("#")&&!Ho(o)&&(e&&(e.type="date"),i&&o.includes(" ")&&o.split(" ").length===2?o=o.split(" ")[1]:t=!1,r=!0),t&&(o.includes("h")||o.includes("m")||o.includes("s"))&&!o.includes("#")&&!Ho(o)&&(e&&(e.type=e.type||"",e.type+="time"),r=!0),r}var e9=(function(o){JY(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return dM([w(0)],t.prototype,"chunkSize",void 0),dM([w(3)],t.prototype,"retryCount",void 0),dM([w(500)],t.prototype,"retryAfterDelay",void 0),t})(Oe),q0=(function(){function o(t){this.parent=t,this.requestedInfo=[],this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Bh,this.updateSheetFromDataSourceHandler,this),this.parent.on(Ab,this.dataSourceChangedHandler,this),this.parent.on(Ib,this.dataChangedHandler,this),this.parent.on(dg,this.triggerDataChangeHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Bh,this.updateSheetFromDataSourceHandler),this.parent.off(Ab,this.dataSourceChangedHandler),this.parent.off(Ib,this.dataChangedHandler),this.parent.off(dg,this.triggerDataChangeHandler))},o.prototype.updateSheetFromDataSourceHandler=function(t){var e=this,i,r,n,s,a,l,h=[],c=[],u,d,p=new zn,f,v,m;t.promise=p.promise;var y,b=t.autoDetectFormat,S=b&&Xd(this.parent);if(t.sheet&&t.sheet.ranges.length)for(var C,x=function(M){var E=t.sheet.ranges[M];y=ie(E.startCell),t.loadFromStartCell&&(t.indexes=y);var A=t.indexes[0],L=t.indexes[2];f=y[0],l=E.dataSource instanceof oe?E.dataSource:E.dataSource?new oe(E.dataSource):new oe,a=a||l.dataSource.url,t.sheet.isLocalData=!l.dataSource.url,f<=A?A=A-f:f<=L?(L=L-f,A=0):A=-1,E.showFieldAsHeader&&A!==0&&(A-=1);var N=!1,R=0;I.initRangeInfo(E);var P=I.getMaxCount(E);if(m=I.getLoadedInfo(A,L,E),A=m.unloadedRange[0],L=m.unloadedRange[1],E.info.insertRowRange&&(E.info.insertRowRange.forEach(function(F){R+=F[1]-F[0]+1}),A-=R,L-=R),A>=P?N=!0:L>P&&(L=P),t.loadComplete||I.requestedInfo.push({deferred:p,indexes:t.indexes,isNotLoaded:m.isNotLoaded}),A>=0&&m.isNotLoaded&&!N){c[M]=A,h[M]=!1;var k;E.fieldsOrder&&(k=[].slice.call(E.fieldsOrder));var B=(E.query?E.query:new Pe).clone();t.loadFullData||(B=B.range(A,L>=P?L:L+1)),l.executeQuery(B.requiresCount()).then(function(F){if(!(!e.parent||e.parent.isDestroyed)){if(s=F.result&&F.result.result?F.result.result:F.result,n=ie(E.startCell),f=n[0],v=n[1],s&&s.length){if(E.info.count||(P=F.count,E.info.count=F.count),r=E.info.flds||k||Object.keys(s[0]),E.info.fldLen||(E.info.fldLen=r.length,E.info.flds=r),E.info.insertColumnRange){var O=0;E.info.insertColumnRange.forEach(function(ae){for(var te=ae[0];te<=ae[1];te++)te<=v?r.splice(0,0,"emptyCell"+O):r.splice(te-v,0,"emptyCell"+O),O++})}c[M]===0&&E.showFieldAsHeader&&(u=f+c[M]+R,r.forEach(function(ae,te){i=Q(u,v+te,t.sheet,!0),i?ae.includes("emptyCell")||(i.value=ae):t.sheet.rows[f+c[M]].cells[v+te]=ae.includes("emptyCell")?{}:{value:ae}})),s.forEach(function(ae,te){u=f+c[M]+te+(E.showFieldAsHeader?1:0)+R,r.forEach(function(he,ue){d=v+ue,i=Q(u,d,t.sheet,!0),i?(C=i.value,he.includes("emptyCell")||Zt(u,d,t.sheet,e.getCellDataFromProp(ae[he]),!0)):(C=void 0,i=t.sheet.rows[u].cells[d]=he.includes("emptyCell")?{}:e.getCellDataFromProp(ae[he])),b&&S(i),t.updateDependentCellsCallback&&C!==i.value&&t.updateDependentCellsCallback(u,d)})})}else r=[];var z;f+(P||F.count)>0?z=f+(P||F.count)+(E.showFieldAsHeader?1:0)+R-1:z=t.sheet.usedRange.rowIndex;var Y=v+r.length-1<0?t.sheet.usedRange.colIndex:v+r.length-1;t.loadFullData&&(L=z);var K={rowIndex:z,colIndex:Y};if(e.parent.scrollSettings&&e.parent.scrollSettings.isFinite&&(K.rowIndex=z<t.sheet.rowCount?z:t.sheet.rowCount-1,K.colIndex=Y<t.sheet.colCount?Y:t.sheet.colCount-1),t.sheet.usedRange.rowIndex<K.rowIndex&&e.parent.setSheetPropertyOnMute(t.sheet,"usedRange",{rowIndex:K.rowIndex,colIndex:t.sheet.usedRange.colIndex}),t.sheet.usedRange.colIndex<K.colIndex&&e.parent.setSheetPropertyOnMute(t.sheet,"usedRange",{rowIndex:t.sheet.usedRange.rowIndex,colIndex:K.colIndex}),R?(m=e.getLoadedInfo(A,L,E),A=m.unloadedRange[0],L=m.unloadedRange[1],A>P&&(m.isNotLoaded=!1),m.isNotLoaded&&(L>P&&(L=P),E.info.loadedRange.push([A,L]))):E.info.loadedRange.push([A,L]),h[M]=!0,h.indexOf(!1)===-1){var U=void 0;if(L+f<f+E.info.count){t.rangeSettingCount||(t.rangeSettingCount=[]),t.rangeSettingCount.push(M),U=!0;var q={sheet:t.sheet,indexes:[0,0,z,Y],promise:new Promise(function(ae){ae((function(){})())}),rangeSettingCount:t.rangeSettingCount,loadComplete:t.loadComplete,autoDetectFormat:t.autoDetectFormat,resolveAfterFullDataLoaded:t.resolveAfterFullDataLoaded};e.updateSheetFromDataSourceHandler(q),q.promise.then(function(){e.parent.getModuleName()!=="workbook"&&(t.rangeSettingCount.pop(),t.rangeSettingCount.length||e.parent.notify("created",null),t.formulaCellRef?e.notfyFormulaCellRefresh(t.formulaCellRef,t.sheetIndex):t.loadComplete&&t.loadComplete())})}else t.formulaCellRef?e.notfyFormulaCellRefresh(t.formulaCellRef,t.sheetIndex):t.loadComplete&&t.loadComplete();U&&t.resolveAfterFullDataLoaded||(e.checkResolve(t.indexes),t.resolveAfterFullDataLoaded&&e.checkResolve([0,0,0,0]))}}})}else M===0&&h.indexOf(!1)===-1&&(t.loadComplete&&t.loadComplete(),I.checkResolve(t.indexes))},I=this,D=t.sheet.ranges.length-1;D>=0;D--)x(D);else p.resolve()},o.prototype.notfyFormulaCellRefresh=function(t,e){this.parent.formulaRefCell=null,this.parent.notify(_d,{indexes:ie(t),sheetIndex:e,refreshing:!0})},o.prototype.checkResolve=function(t){var e,i,r=0;this.requestedInfo.forEach(function(n,s){i=JSON.stringify(n.indexes)===JSON.stringify(t),(i||e)&&(s===0?(n.deferred.resolve(),r++,e=!0):e&&(n.isLoaded||!n.isNotLoaded)||i&&e?(n.deferred.resolve(),r++):i?n.isLoaded=!0:e=!1)}),this.requestedInfo.splice(0,r)},o.prototype.getCellDataFromProp=function(t){var e={};return Object.prototype.toString.call(t)==="[object Object]"?t.formula?e.formula=t.formula:g(t.value)||(typeof t.value=="string"&&(t.value.indexOf("http://")===0||t.value.indexOf("https://")===0||t.value.indexOf("ftp://")===0||t.value.indexOf("www.")===0)?(e.hyperlink=t.value,e.style={textDecoration:"underline",color:"#00e"}):e.value=t.value):pt(t)?e.formula=t:typeof t=="string"&&(t.indexOf("http://")===0||t.indexOf("https://")===0||t.indexOf("ftp://")===0||t.indexOf("www.")===0)?(e.hyperlink=t,e.style={textDecoration:"underline",color:"#00e"}):e.value=t,e},o.prototype.getLoadedInfo=function(t,e,i){var r=!0;return i.info.loadedRange.forEach(function(n){n[0]<=t&&t<=n[1]?n[0]<=e&&e<=n[1]?r=!1:t=n[1]+1:n[0]<=e&&e<=n[1]&&(e=n[0]-1)}),{isNotLoaded:r,unloadedRange:[t,e]}},o.prototype.getMaxCount=function(t){if(t.query){for(var e=t.query.queries,i=0;i<e.length;i++)if(e[i].fn==="onTake")return Math.min(e[i].e.nos,t.info.count||e[i].e.nos)}return t.info.count},o.prototype.initRangeInfo=function(t){t.info||(t.info={loadedRange:[]})},o.prototype.dataSourceChangedHandler=function(t){var e=this,i,r=this.parent.sheets[t.sheetIdx],n=r.ranges[t.rangeIdx];if(n&&(this.checkRangeHasChanges(r,t.rangeIdx)||!n.info)){var s=n.showFieldAsHeader,a=xe(n.startCell);n.info&&(n.info.loadedRange.forEach(function(h){for(var c=h[0];c<=h[1]&&c<n.info.count+(s?1:0);c++)if(i=r.rows[c+a[0]],i)for(var u=a[1];u<a[1]+n.info.fldLen;u++)i.cells&&i.cells[u]&&delete i.cells[u]}),n.info=null);var l={sheet:r,indexes:[0,0,r.rowCount-1,r.colCount-1],loadFullData:!0,promise:new Promise(function(h){h((function(){})())})};this.updateSheetFromDataSourceHandler(l),l.promise.then(function(){e.parent.trigger("dataSourceChanged",{data:t.changedData,action:"dataSourceChanged",rangeIndex:t.rangeIdx,sheetIndex:t.sheetIdx}),e.parent.notify(_d,{sheetIndex:t.sheetIdx,checkWrap:!0,checkCF:!0})})}},o.prototype.checkRangeHasChanges=function(t,e){return this.parent.isAngular?t.changedRangeIdx===e?(delete t.changedRangeIdx,!0):!1:!0},o.prototype.dataChangedHandler=function(t){var e=this,i=[{}],r,n,s,a,l,h,c,u=t.sheetIdx===void 0?this.parent.activeSheetIndex:t.sheetIdx,d=this.parent.sheets[u],p,f;d.ranges.forEach(function(v,m){if(v.dataSource){var y=void 0;if(a=xe(v.startCell),s=a.concat([a[0]+v.info.count+(v.showFieldAsHeader?0:-1),a[1]+v.info.fldLen-1]),t.modelType==="Row"||t.modelType==="Column")if(t.modelType==="Column"){if(t.insertType)l=s[1]<t.index&&s[3]>=t.index,p=[t.index],l?(t.model.forEach(function(){v.info.flds.splice(t.index-a[1],0,"")}),v.info.fldLen+=t.model.length):s[3]+1===t.index&&t.insertType==="after"?(t.model.forEach(function(){v.info.flds.splice(t.index-a[1],0,"")}),v.info.fldLen+=t.model.length):s[1]>=t.index&&(v.startCell=st(a[0],a[1]+t.model.length));else if(l=s[1]<=t.startIndex&&s[3]>=t.startIndex,l)for(var b=t.startIndex;b<=t.endIndex;b++)b<=s[3]&&(v.info.flds.splice(t.startIndex,1),v.info.fldLen-=1);return}else if(t.insertType){if(l=(!v.showFieldAsHeader&&(t.insertType==="above"||t.isMethod)?s[0]<=t.index:s[0]<t.index)&&s[2]>=t.index,p=[t.index],l||s[2]+1===t.index&&t.insertType==="below"?(y=!0,v.info.count+=t.model.length):s[0]>=t.index&&(v.startCell=st(a[0]+t.model.length,a[1])),t.isMethod)return}else l=s[0]<=t.startIndex&&s[2]>=t.startIndex,t.isDataRequest?p=[t.startIndex,s[1],t.startIndex,s[1]]:r="delete";else{var S=t.address||t.range||t.fillRange;p=ie(t.requestType&&t.requestType.toLowerCase().includes("paste")?t.pastedRange.substring(t.pastedRange.lastIndexOf("!")+1):t.sheetIdx>-1?t.address:S.substring(S.lastIndexOf("!")+1));var C=[v.showFieldAsHeader?s[0]+1:s[0]].concat(s.slice(1,4));if(v.showFieldAsHeader&&p[0]===a[0])for(var b=p[1];b<=p[3];b++)b>=C[1]&&b<=C[3]&&(v.info.flds[b-a[1]]=Q(a[0],b,d,!1,!0).value||"");if(l=Dg(C,p,!0),t.requestType==="paste"&&t.copiedInfo.isCut){if(f=[].slice.call(t.copiedInfo.range),v.showFieldAsHeader&&f[0]===a[0]){for(var b=f[1];b<=f[3];b++)b>=C[1]&&b<=C[3]&&(v.info.flds[b-a[1]]="");l=!1}h=Dg(C,f,!0)}}if(l||y||h){if(t.modelType==="Row"&&!t.insertType&&!t.isDataRequest){if(t.deletedModel.forEach(function(L,N){i[N]={},v.info.flds.forEach(function(R,P){L.cells?(n=L.cells[a[1]+P],i[N][""+R]=e.getFormattedValue(n)):i[N][""+R]=null}),v.info.count-=1}),t.isMethod)return;c={count:t.deletedModel.length,index:t.endIndex}}else{r=y?"add":"edit";var x=0;if(h){x=f[2]-f[0]+1;for(var I=function(L){i[L]={},v.info.flds.forEach(function(N,R){N&&(n=Q(f[0]+L,a[1]+R,d),i[L][""+N]=e.getFormattedValue(n))})},b=0;b<x;b++)I(b)}if(l||y)for(var D=!t.isDataRequest&&!h&&!y&&!t.skipFilterCheck,M=function(L,N){if(D&&as(d,p[0]+L))return E=N,"continue";i[N+x]={},v.info.flds.forEach(function(R,P){R&&(n=Q(p[0]+L,a[1]+P,d),i[N+x][""+R]=e.getFormattedValue(n))}),N++,E=N},E,b=0,A=0;b<(y?t.model.length:p[2]-p[0]+1||1);b++)M(b,A),A=E}t.isDataRequest?t.data=i:e.parent.trigger("dataSourceChanged",{data:i,action:r,rangeIndex:m,sheetIndex:u})}else c&&c.count&&s[0]>c.index&&(v.startCell=st(a[0]-c.count,a[1]))}})},o.prototype.getFormattedValue=function(t){var e=this.parent.getDisplayText(t);return e===""?null:t&&!t.format&&typeof t.value=="number"?t.value:e},o.prototype.triggerDataChangeHandler=function(t){var e=["insert","delete","edit","cellDelete","cellSave","autofill","clipboard","clear"],i=!0;if(((t.action==="delete"||t.action==="insert")&&["Sheet"].indexOf(t.eventArgs.modelType)>-1||t.action==="clear"&&["Clear Formats","Clear Hyperlinks"].indexOf(t.eventArgs.type)>-1||t.action==="clipboard"&&t.eventArgs.requestType==="Formats")&&(i=!1),i&&e.indexOf(t.action)>-1){var r=void 0;t.isUndo&&(t.action==="delete"||t.action==="insert")?(r=pe({},t.eventArgs),t.action==="delete"?(r.index=r.startIndex,r.model=r.deletedModel,r.insertType="below"):(r.startIndex=r.index,r.endIndex=t.eventArgs.index+t.eventArgs.model.length-1,r.deletedModel=r.model,delete r.insertType)):r=t.eventArgs,this.parent.notify(Ib,r)}},o.prototype.getModuleName=function(){return"dataBind"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.requestedInfo=[]},o})(),Fl="ribbon",Tg="formulaBar",o0="sheetTabs",Oh="refreshSheetTabs",Kd="isFormulaBarEdit",Ln="contentLoaded",Bl="mouseDown",Xn="spreadsheetDestroyed",ui="editOperation",Ol="formulaOperation",ho="formulaBarOperation",Jc="click",Ds="keyUp",mo="keyDown";var VM="verticalScroll",_M="horizontalScroll",l0="focusRenameInput",UM="beforeContentLoaded",WM="beforeVirtualContentLoaded",co="virtualContentLoaded";var Pc="cellNavigate",qM="mouseUpAfterSelection",eu="contextmenuBeforeOpen",YM="insertSheetTab",h0="removeSheetTab",GM="renameSheetTab",Ag="ribboClick";var Ea="enableToolbarItems",QM="tabSwitch",tu="selectRange",XM="rangeSelectionByKeydown",iu="cut",ru="copy",fo="paste",$d="clearCopy",t9="dataBound",i9="beforeDataBound",KM="addContextMenuItems",$M="removeContextMenuItems",ZM="enableContextMenuItems",JM="enableFileMenuItems",eD="hideFileMenuItems",tD="addFileMenuItems",iD="hideRibbonTabs",rD="enableRibbonTabs",nD="addRibbonTabs",sD="addToolbarItems",aD="hideToolbarItems",oD="beforeRibbonCreate",Fn="rowHeightChanged",Qn="colWidthChanged",lD="onContentScroll",nu="deInitProperties",su="activeSheetChanged",c0="initiateCustomSort",au="applySort";var hD="autoFitRowsColumns",u0="refreshFilterCellsOnResize",Bc="updateToggleItem",Lg="initiateHyperlink",Ng="editHyperlink",cD="openHyperlink",d0="addNote",p0="editNote",kg="deleteNote",Ld="showNote",Zd="createNoteIndicator",uD="updateNoteContainer",jc="removeNoteContainer",Fg="removeHyperlink",f0="createHyperlinkElement",g0="sheetNameUpdate",v0="hideSheet",yo="performUndoRedo",m0="updateUndoRedoCollection",Hh="setActionData",pM="getBeforeActionData",Vh="clearUndoRedoCollection",Yo="initiateFilterUI",Cd="renderFilterCell",y0="refreshFilterRange",b0="reapplyFilter",dD="filterByCellValue",Rg="clearFilter",S0="getFilteredColumn",wt="actionComplete",C0="filterCellKeyDown",ou="getFilterRange",pD="setAutoFit",fD="refreshFormulaDatasource",gD="initiatedatavalidation";var Og="invalidData";var Hc="protectSheet",sg="applyProtect";var vD="protectCellFormat",mD="renderGotoDlgt",w0="renderFindDlg",tg="findHandler",fM="created",yD="spreadsheetCreated",Ra="editAlert",fr="readonlyAlert",x0="finiteAlert",bD="setUndoRedo",SD="enableFormulaInput",I0="protectSelection",M0="hiddenMerge",CD="checkPrevMerge",D0="checkMerge",zg="removeDataValidation",jl="showAggregate",wD="goToSheet",xD="showSheet",ID="renderCFDlg",Pg="clearViewer",kl="initiateFormulaReference",E0="initiateCur",MD="clearCellRef",T0="editValue",Rl="addressHandle",DD="initiateEdit",wd="forRefSelRender",ED="insertImage",Nd="refreshOverlayElem",Jd="refreshImgCellObj",Is="getRowIdxFromClientY",Ms="getColIdxFromClientX",go="createImageElement",La="deleteImage",lu="deleteChart",Uc="refreshChartCellObj",A0="refreshChartCellModel",L0="refreshImagePosition",TD="updateTableWidth",xd="focusBorder",N0="clearChartBorder",AD="insertChart",Id="chartRangeSelection",ep="insertDesignChart",Go="removeDesignChart",Wc="chartDesignTab",LD="undoRedoForChartDesign",k0="protectWorkbook",F0="unProtectWorkbook",ND="setProtectWorkbook",kD="removeWorkbookProtection",FD="importProtectWorkbook",Bg="selectionStatus",hg="freeze",RD="overlayEleSize",R0="updateScroll",Oa="positionAutoFillElement",O0="hideAutoFillOptions",z0="performAutoFill",OD="selectAutoFillRange";var zh="hideAutoFillElement",zD="unProtectSheetPassword",qc="updateTranslate",PD="getUpdatedScrollPosition",P0="updateScrollValue",dz="beforeCheckboxfilterRenderer",pz="refreshCheckbox",BD="renderInsertDlg",B0="toggleProtect",jD="propertyChange",HD="updateWrapCell",Nz=(function(){function o(t){this.loopIndex=0,this.processedLoopIndex=0,this.retryCount=0,this.currentDocumentId=null,this.parent=t,this.addEventListener()}return o.prototype.open=function(t){this.load(t)},o.prototype.load=function(t,e){var i=this;if(this.parent.allowOpen){if(t.jsonObject){this.fetchSuccess(t.jsonObject,t,null,!0,!0);return}var r=new FormData;if(t.file)r.append("file",t.file);else if(t.sheetIndex>=0)r.append("sheetPassword",t.sheetPassword),r.append("sheetIndex",t.sheetIndex.toString());else{this.parent.isOpen=!1;return}var n={passWord:""};t.password&&t.password.length&&(n.passWord=t.password),n.passWord&&n.passWord.length&&(t.password=n.passWord),t.password&&r.append("password",t.password),r.append("IsManualCalculationEnabled",(this.parent.calculationMode==="Manual").toString());var s={file:t.file||null,cancel:!1,requestData:{method:"POST",body:r},password:n.passWord},a=t.guid;if(g(t.sheetPassword)&&!a&&g(e)?(this.parent.trigger("beforeOpen",s),this.parent.notify(hi,{eventArgs:s,action:"beforeOpen"})):a&&r.append("guid",a),s.cancel){this.parent.isOpen=!1;return}var l={chunkSize:null,documentId:null};this.parent.openSettings.chunkSize>0&&g(t.sheetPassword)&&(this.setToDefaults(e),!g(this.parent.openSettings.chunkSize)&&this.parent.openSettings.chunkSize!==0&&(l.chunkSize=this.parent.openSettings.chunkSize.toString()),g(this.currentDocumentId)||(l.documentId=this.currentDocumentId),g(l)||r.append("chunkPayload",JSON.stringify(l))),s.parseOptions&&r.append("parseOptions",JSON.stringify(s.parseOptions)),fetch(this.parent.openUrl,s.requestData).then(function(h){return h.ok?h.json():Promise.reject({status:h.status,statusText:h.statusText,url:h.url})}).then(function(h){return i.fetchSuccess(h,s,t.orginalFile,void 0,!0)}).catch(function(h){h.toString().indexOf("Unexpected end of JSON input")===-1&&i.parent.openSettings.chunkSize>0&&i.retryCount<i.parent.openSettings.retryCount?setTimeout(function(){i.retryCount++,i.load(t,!0)},i.parent.openSettings.retryAfterDelay):(i.retryCount>=i.parent.openSettings.retryCount&&(i.retryCount=0),i.fetchFailure(h))})}},o.prototype.fetchFailure=function(t){Te(t.status)&&Te(t.statusText)&&(t.statusText="Improper response"),this.parent.notify(wM,t),this.parent.isOpen=!1},o.prototype.fetchSuccess=function(t,e,i,r,n){var s=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],a=typeof t=="string"?JSON.parse(t):t,l=a.Workbook;if(g(l)){var h=a.chunkTotalCount;this.currentDocumentId=a.documentId,this.chunkList=new Array(h);var c=0,u=h>this.parent.openSettings.chunkSize?this.parent.openSettings.chunkSize:h,d=0;this.processedLoopIndex=0;var p="",f=this;if(!g(h))for(;c<h;)f.processChunk(c,u,d,p,e,i,r,n),c+=f.parent.openSettings.chunkSize,u=c+f.parent.openSettings.chunkSize<h?f.parent.openSettings.chunkSize:h-c,d++,f.processedLoopIndex++}else{if(s.indexOf(l)>-1){i&&(e.file=i),this.parent.notify(Rb,{context:this,data:l,guid:a.Guid,eventArgs:e,isOpenFromJson:r}),l===s[0]&&(this.parent.isOpen=!1);return}this.updateModel(l,r,n),this.parent.notify(Rb,{context:this,data:l,isOpenFromJson:r,eventArgs:e}),this.parent.isOpen=!1,e&&e.password&&e.password.length>0&&(this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.parent.password="")}},o.prototype.processChunk=function(t,e,i,r,n,s,a,l){var h=this,c={currentChunk:t.toString(),chunkSize:e.toString(),loopIndex:i.toString(),documentId:this.currentDocumentId},u=new FormData;u.append("chunkPayload",JSON.stringify(c));var d={file:s||null,cancel:!1,requestData:{method:"POST",body:u},password:n.password};fetch(this.parent.openUrl,d.requestData).then(function(p){return p.ok?p.json():Promise.reject({status:p.status,statusText:p.statusText,url:p.url})}).then(function(p){if(p!==""){for(var f=atob(p.chunk),v=new Uint8Array(f.length),m=0;m<f.length;m++)v[m]=f.charCodeAt(m);if(f=new TextDecoder("utf-8").decode(v),h.chunkList[p.loopIndex]=f,h.loopIndex++,h.loopIndex===h.processedLoopIndex){for(var y=h.chunkList.splice(0,h.loopIndex),b=0;b<y.length;b++)r+=y.slice(b,b+1).join("");p=JSON.parse(r),h.setToDefaults(),h.fetchSuccess(p,n,s,a,l)}}}).catch(function(p){if(g(h.currentFailedChunkIndex)||h.currentFailedChunkIndex===t)if(h.currentFailedChunkIndex=t,h.retryCount<h.parent.openSettings.retryCount)setTimeout(function(){h.processedLoopIndex=i,h.processChunk(t,e,i,r,n,s,a,l),h.retryCount++},h.parent.openSettings.retryAfterDelay);else return h.retryCount=0,h.fetchFailure(p)})},o.prototype.setToDefaults=function(t){this.currentFailedChunkIndex=null,t||(this.retryCount=0),this.loopIndex=0,this.processedLoopIndex=0,this.chunkList=[]},o.prototype.updateModel=function(t,e,i){this.parent.notify(At,{action:"unRegisterSheet"}),this.setSelectAllRange(t.sheets,e),this.parent.sheetNameCount=1,this.parent.sheets=[],this.parent.notify(ka,{}),this.parent.notify(Vh,null),t.activeSheetIndex=t.activeSheetIndex||t.sheets.findIndex(function(r){return r.state!=="Hidden"}),this.parent.setProperties({isProtected:t.isProtected||!1,password:t.password||"",sheets:t.sheets,activeSheetIndex:t.activeSheetIndex,definedNames:t.definedNames||[],filterCollection:t.filterCollection||[],sortCollection:t.sortCollection||[],listSeparator:t.listSeparator||this.parent.listSeparator},!0),g(t.showSheetTabs)||(this.parent.showSheetTabs=t.showSheetTabs),ng(this.parent,void 0,i),this.parent.notify(yg,null),this.parent.notify(aa,null)},o.prototype.setSelectAllRange=function(t,e){var i=this,r,n;t.forEach(function(s){if(s.selectedRange){var a=ie(s.selectedRange),l=(Te(s.rowCount)?100:s.rowCount)-1,h=(Te(s.colCount)?100:s.colCount)-1;a[2]===65535&&(a[2]=l),a[3]===255&&(a[3]=h),a[0]===65535&&(a[0]=l),a[1]===255&&(a[1]=h),s.selectedRange=Ve(a)}if(e&&i.parent.isAngular){for(var c=0;c<i.parent.sheets.length;c++)if(r=ke(i.parent,c),s.name===r.name){s.ranges&&s.ranges.forEach(function(u,d){n=r.ranges[d],n&&n.template&&(u.template=n.template)});break}}})},o.prototype.sheetsDestroyHandler=function(t){g(t.sheetIndex)&&(this.preventFormatCheck=null)},o.prototype.addEventListener=function(){this.parent.on(Lb,this.open.bind(this)),this.parent.on(ka,this.sheetsDestroyHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Lb,this.open.bind(this)),this.parent.off(ka,this.sheetsDestroyHandler))},o.prototype.destroy=function(){this.removeEventListener(),this.parent.refreshing||(this.preventFormatCheck=null),this.parent=null},o.prototype.getModuleName=function(){return"workbookOpen"},o})(),r9=(function(){function o(t){this.parent=t}return o.prototype.processSheet=function(t,e){var i=JSON.parse(t,function(r,n){if(!((Array.isArray(n)||typeof n=="string")&&!n.length))return n});return[e,i]},o.prototype.processSave=function(t,e,i,r,n){var s=this,a=new FormData,l,h=Object.keys(e);for(a.append("JSONData",JSON.stringify(t)),l=0;l<h.length;l++)a.append(h[l],e[h[l]]);for(h=Object.keys(i),l=0;l<h.length;l++)a.append(h[l],i[h[l]]);a.append("pdfLayoutSettings",JSON.stringify(r)),fetch(e.url,{method:"POST",body:a}).then(function(c){return c.ok?c.blob():Promise.reject({message:c.statusText})}).then(function(c){new Promise(function(u){var d=new FileReader;d.onload=function(){var p=d.result.toString(),f=i.customParams&&typeof i.customParams=="string"&&i.customParams.toLowerCase()==="saveashtml";if(p.indexOf("data:text/plain;base64,")>-1||!f&&p.indexOf("data:text/html;base64,")>-1||p.indexOf("data:application/json;base64,")>-1){var v=void 0;if(p=p.replace("data:text/plain;base64,",""),p=p.replace("data:text/html;base64,",""),p.indexOf("data:application/json;base64,")>-1?(p=p.replace("data:application/json;base64,",""),v=atob(p).split(".")):v=atob(p).split(/(\r\n|\n|\r)/gm),v.length){var m=v[0].length>1&&v[0][0]==='"'?v[0].split('"')[1]+".":v[0];n?n.apply(s,[{dialog:m}]):postMessage({dialog:m})}}else n?n.apply(s,[c]):postMessage(c);u(d.result)},d.readAsDataURL(c)})}).catch(function(c){n?n.apply(s,[{error:c.message}]):postMessage({error:c.message})})},o})(),n9=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),VD=function(){return VD=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},VD.apply(this,arguments)},kz=(function(o){n9(t,o);function t(e){var i=o.call(this,e)||this;return i.isProcessCompleted=!1,i.saveJSON={},i.isFullPost=!1,i.needBlobData=!1,i.customParams=null,i.pdfLayoutSettings={fitSheetOnOnePage:!1},i.addEventListener(),i}return t.prototype.getModuleName=function(){return"workbookSave"},t.prototype.destroy=function(){this.removeEventListener(),this.parent=null},t.prototype.addEventListener=function(){this.parent.on(pg,this.initiateSave,this),this.parent.on("getStringifyObject",this.performStringifyAction,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pg,this.initiateSave),this.parent.off("getStringifyObject",this.performStringifyAction))},t.prototype.initiateSave=function(e){var i=e.saveSettings;this.saveSettings={saveType:i.saveType,url:i.url,fileName:i.fileName||"Sample"},this.saveSettings.skipWorkerPipeline=e.skipWorkerPipeline,this.isFullPost=e.isFullPost,this.needBlobData=e.needBlobData,this.needBlobData&&(this.isFullPost=!1),this.customParams=e.customParams,this.pdfLayoutSettings=e.pdfLayoutSettings,this.updateBasicSettings(),this.processSheets(i.autoDetectFormat,e.jsonConfig,e.skipWorkerPipeline)},t.prototype.updateBasicSettings=function(){var e=this.getStringifyObject(this.parent,["sheets","_isScalar","observers","closed","isStopped","hasError","__isAsync","beforeCellFormat","beforeCellRender","beforeDataBound","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEdited","cellEditing","cellSave","beforeCellSave","contextMenuItemSelect","contextMenuBeforeClose","contextMenuBeforeOpen","created","dataBound","fileMenuItemSelect","fileMenuBeforeClose","fileMenuBeforeOpen","saveComplete","sortComplete","select","actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeHyperlinkClick","beforeHyperlinkCreate","openComplete","openFailure","queryCellInfo","dialogBeforeOpen","dataSourceChanged","beforeConditionalFormat","beforeCellUpdate"]),i=JSON.parse(e),r=this.parent.sheets.length;r&&(i.sheets=[]),this.saveJSON=i,this.saveJSON.filterCollection=[]},t.prototype.processSheets=function(e,i,r){var n=this,s=["dataSource","startCell","query","showFieldAsHeader","result","preservePos"];if(this.parent.isAngular&&s.push("template"),i)if(i.onlyValues)s.push.apply(s,["style","formula","format","conditionalFormats","validation","hyperlink","wrap","chart","image","notes"]);else{var a={style:i.ignoreStyle,formula:i.ignoreFormula,format:i.ignoreFormat,conditionalFormats:i.ignoreConditionalFormat,validation:i.ignoreValidation,wrap:i.ignoreWrap,chart:i.ignoreChart,image:i.ignoreImage,notes:i.ignoreNote};i.ignoreFreezePane&&s.push.apply(s,["frozenColumns","frozenRows"]);for(var l in a)a[l]&&s.push(l)}for(var h,c,u,d,p=function(y,b){u=f.parent.sheets[y],h=!1,c=!1;for(var S=0,C=u.ranges.length;S<C;S++)if(d=u.ranges[S],d.dataSource&&(c=!0,!d.info||!d.info.loadedRange||!d.info.loadedRange.length)){h=!0;break}if(h){var x=function(D){if(r){var M=n.getStringifyObject(n.parent.sheets[D],s,D,!1,!0);n.updateSheet(n.processSheet(M,y))}else lM(n,n.processSheet,n.updateSheet,[n.getStringifyObject(n.parent.sheets[D],s,D,!1,!0),D],null,n.parent)};f.parent.notify(Bh,{sheet:u,sheetIndex:y,loadComplete:x.bind(f,y),loadFromStartCell:!0,autoDetectFormat:e})}else if(r){var I=f.getStringifyObject(u,s,y,e&&c,!0);f.updateSheet(f.processSheet(I,y))}else lM(f,f.processSheet,f.updateSheet,[f.getStringifyObject(u,s,y,e&&c,!0),y],null,f.parent)},f=this,v=0,m=this.parent.sheets.length;v<m;v++)p(v)},t.prototype.updateSheet=function(e){this.saveJSON.sheets[e[0]]=e[1],this.isProcessCompleted=this.getSheetLength(this.saveJSON.sheets)===this.parent.sheets.length,this.isProcessCompleted&&this.save(this.saveSettings)},t.prototype.getSheetLength=function(e){var i=0;return e.forEach(function(r){r&&i++}),i},t.prototype.save=function(e){var i={cancel:!1,jsonObject:this.saveJSON};this.parent.notify(MM,i),i.cancel||(this.isFullPost?(this.initiateFullPostSave(),this.saveJSON={}):e.skipWorkerPipeline?this.processSave(this.saveJSON,e,this.customParams,this.pdfLayoutSettings,this.updateSaveResult):lM(this,{workerTask:this.processSave},this.updateSaveResult,[this.saveJSON,e,this.customParams,this.pdfLayoutSettings],!0,this.parent))},t.prototype.updateSaveResult=function(e){if(e.isFormDataError){this.processSave(this.saveJSON,this.saveSettings,this.customParams,this.pdfLayoutSettings,this.updateSaveResult);return}this.saveJSON={};var i={status:"Success",message:"",url:this.saveSettings.url,fileName:this.saveSettings.fileName,saveType:this.saveSettings.saveType,blobData:null};typeof e=="object"&&e.error?(i.status="Failure",i.message=e.error.toString()):typeof e=="object"&&e.dialog?this.parent.notify(kM,{content:e.dialog}):this.needBlobData?i.blobData=e:this.ClientFileDownload(e),this.parent.trigger("saveComplete",i),this.parent.notify(gg,i)},t.prototype.ClientFileDownload=function(e){var i=this.parent.createElement("a",{attrs:{download:this.getFileNameWithExtension()}}),r=URL.createObjectURL(e);i.href=r,document.body.appendChild(i),i.click(),URL.revokeObjectURL(r),document.body.removeChild(i)},t.prototype.initiateFullPostSave=function(){var e=Object.keys(this.saveSettings),i,r=this.parent.createElement("form",{attrs:{method:"POST",action:this.saveSettings.url}}),n=this.parent.createElement("input",{attrs:{type:"hidden",name:"JSONData"}});for(n.value=JSON.stringify(this.saveJSON),r.appendChild(n),i=0;i<e.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:e[i]}}),n.value=this.saveSettings[e[i]],r.appendChild(n);for(e=Object.keys(this.customParams),i=0;i<e.length;i++)n=this.parent.createElement("input",{attrs:{type:"hidden",name:e[i]}}),n.value=this.customParams[e[i]],r.appendChild(n);n=this.parent.createElement("input",{attrs:{type:"hidden",name:"pdfLayoutSettings"}}),n.value=JSON.stringify(this.pdfLayoutSettings),r.appendChild(n),document.body.appendChild(r),r.submit(),se(r),this.parent.notify(gg,{})},t.prototype.performStringifyAction=function(e){e.model='{"jsonObject":{"Workbook":{"sheets":[';for(var i=0,r=this.parent.sheets.length-1;i<=r;i++)e.model+=this.getStringifyObject(this.parent.sheets[i],e.skipProps,i)+(i<r?",":"]}}}")},t.prototype.getStringifyObject=function(e,i,r,n,s){var a=this;i===void 0&&(i=[]),r===0&&this.parent.notify(zd,{clearAll:!0}),s&&this.parent.notify(kb,{sheetIdx:r,isSaveAction:!0,saveJson:this.saveJSON});var l=[],h,c=n&&Xd(this.parent),u=JSON.stringify(e,function(p,f){if(!(i.indexOf(p)>-1)){if(p==="cellStyle")return a.parent.commonCellStyle;if(f&&f.cells)for(var v=0,m=f.cells.length;v<m;v++){var y=f.cells[v],b=[Number(p),v];if(y&&(y.value?n&&!y.formula&&c(y):y.formula&&y.formula.indexOf("=UNIQUE(")<0&&(a.parent.calculationMode==="Automatic"&&a.parent.notify(At,{action:"refreshCalculate",value:y.formula,rowIndex:b[0],colIndex:v,isFormula:pt(y.formula),sheetIndex:r,isRefreshing:!0}),y.value=Q(b[0],v,e).value),y.chart)){l.push({index:b,chart:y.chart}),h=[];for(var S=0,C=y.chart.length;S<C;S++){var x=Object.assign({},y.chart[S]);delete x.id,h.push(x)}y.chart=h}}if(p==="validation"&&f&&typeof f.type=="string"&&f.type==="Time"&&["value1","value2"].forEach(function(M){var E=f[M]&&f[M].toString();E&&!De(Number(E))&&(f[M]=a.getDateAsNumber({range:[],cell:{value:E}},E))}),f&&f.properties&&f.maxHgts&&(f.properties=VD({},f.properties,{maxHgts:f.maxHgts})),f&&typeof f=="object"&&f.hasOwnProperty("properties")){if(f.propName&&f.propName.toString()==="conditionalFormats"){var I=f.properties;if(I.format&&I.format.style){var D=I.format.style;D&&D.backgroundColor==="#ffffff"&&D.color==="#000000"&&D.fontWeight!=="bold"&&D.fontStyle!=="italic"&&D.textDecoration!=="underline"&&delete I.format}}return f.properties}else return f!==null?f:void 0}}),d=ke(this.parent,r);return l.forEach(function(p){Zt(p.index[0],p.index[1],d,{chart:p.chart},!0)}),u},t.prototype.getDateAsNumber=function(e,i){var r={value:i,rowIndex:e.range[0],cell:e.cell,colIndex:e.range[1],sheetIndex:e.sheetIdx,updatedVal:""};return this.parent.notify(Jr,r),r.updatedVal||i},t.prototype.getFileNameWithExtension=function(e){e||(e=this.saveSettings.fileName);var i=this.getFileExtension(),r=e.lastIndexOf(".");return r>-1&&(e=e.substr(0,r)),e+i},t.prototype.getFileExtension=function(){return"."+this.saveSettings.saveType.toLowerCase()},t})(r9),W=(function(o){return o[o.NA=0]="NA",o[o.Value=1]="Value",o[o.Ref=2]="Ref",o[o.DivZero=3]="DivZero",o[o.Num=4]="Num",o[o.Name=5]="Name",o[o.Null=6]="Null",o[o.Calc=7]="Calc",o})(W||{}),me=(function(o){return o[o.OperatorsCannotStartWithExpression=0]="OperatorsCannotStartWithExpression",o[o.ReservedWordAND=1]="ReservedWordAND",o[o.ReservedWordXOR=2]="ReservedWordXOR",o[o.ReservedWordIf=3]="ReservedWordIf",o[o.NumberContains2DecimalPoints=4]="NumberContains2DecimalPoints",o[o.ReservedWordElse=5]="ReservedWordElse",o[o.ReservedWordNOT=6]="ReservedWordNOT",o[o.InvalidCharInNumber=7]="InvalidCharInNumber",o[o.InvalidCharactersFollowingWithOperator=6]="InvalidCharactersFollowingWithOperator",o[o.MismatchedParentheses=8]="MismatchedParentheses",o[o.UnknownFormulaName=9]="UnknownFormulaName",o[o.RequiresASingleArgument=10]="RequiresASingleArgument",o[o.Requires3Args=11]="Requires3Args",o[o.InvalidMathArgument=12]="InvalidMathArgument",o[o.Requires2Args=13]="Requires2Args",o[o.BadIndex=14]="BadIndex",o[o.TooComplex=15]="TooComplex",o[o.CircularReference=16]="CircularReference",o[o.MissingFormula=17]="MissingFormula",o[o.ImproperFormula=18]="ImproperFormula",o[o.InvalidExpression=19]="InvalidExpression",o[o.CellEmpty=20]="CellEmpty",o[o.BadFormula=21]="BadFormula",o[o.EmptyExpression=22]="EmptyExpression",o[o.VirtualModeRequired=23]="VirtualModeRequired",o[o.MismatchedTics=24]="MismatchedTics",o[o.WrongNumberArguments=25]="WrongNumberArguments",o[o.InvalidArguments=26]="InvalidArguments",o[o.IterationsDoNotConverge=27]="IterationsDoNotConverge",o[o.CalculationOverflow=29]="CalculationOverflow",o[o.AlreadyRegistered=28]="AlreadyRegistered",o[o.MissingSheet=30]="MissingSheet",o[o.CannotParse=31]="CannotParse",o[o.ExpressionCannotEndWithAnOperator=32]="ExpressionCannotEndWithAnOperator",o[o.Spill=33]="Spill",o[o.Div=34]="Div",o})(me||{}),Fz=(function(o){return o.xlsx="xlsx",o.xlsm="xlsm",o.xlsb="xlsb",o.xltx="xltx",o.xltm="xltm",o.xls="xls",o.xml="xml",o.xlam="xlam",o.xla="xla",o.xlw="xlw",o.xlr="xlr",o.prn="prn",o.txt="txt",o.csv="csv",o.dif="dif",o.slk="slk",o})(Fz||{});function s9(o){switch(o){case"dd-MMM-yyyy":case"dd MMM yyyy":o="medium";break;case"MMM yyyy":o="yMMM";break;case"MM/dd/yyyy":case"dd/MM/yyyy":case"dd/MM/yy":o="short";break;case"dddd MMMM dd yyyy":case"dd MMMM yyyy":o="long";break;case"d MMMM yyyy":o="yMMMd";break;case"yyyy":o="y";break;case"h:mm":o="Hm";break;case"h:mm tt":o="hm";break;case"h":o="H";break;case"h tt":o="h";break;case"dddd":o="E";break;case"h:mm:ss tt":o="hms";break;case"h:mm:ss":o="Hms";break;case"d":o="d";break;case"d dddd":o="Ed";break;case"M":o="M";break;case"Md":o="Md";break;case"MMM":o="MMM";break;case"ddd MMM d":o="MMMEd";break;case"MMM d":o="MMMd";break;case"M/yyyy":o="yM";break;case"ddd":o="E";break;default:o="";break}return o}function a9(o){var t=!1;for(var e in Fz)if(o.indexOf("."+e+"]")>-1){t=!0;break}return t}var o9=(function(){function o(t){this.formulas=[{formulaName:"SUM",category:"Math & Trig",description:"Sums individual values, cell references or ranges."},{formulaName:"SUMIFS",category:"Math & Trig",description:"Sums the cells specified by a given set of conditionsor criteria."},{formulaName:"SUMPRODUCT",category:"Math & Trig",description:"Returns sum of the product of given ranges of arrays."},{formulaName:"ABS",category:"Math & Trig",description:"Returns the absolute value of a number."},{formulaName:"RAND",category:"Math & Trig",description:"Return a random number between 0 and 1."},{formulaName:"FLOOR",category:"Math & Trig",description:"Returns the round a number down to the nearest integer."},{formulaName:"CEILING",category:"Math & Trig",description:"Returns a number rounded up to a multiple of another number."},{formulaName:"SUMIF",category:"Math & Trig",description:"It will sum up cells that meet the given criteria."},{formulaName:"PRODUCT",category:"Math & Trig",description:"Multiplies all the numbers given as arguments and returns the product."},{formulaName:"AVERAGE",category:"Statistical",description:"The sum of the numbers divided by how many numbers are being averaged."},{formulaName:"AVERAGEIF",category:"Statistical",description:"Computes the average of the numbers in a range that meet the supplied criteria."},{formulaName:"COUNT",category:"Statistical",description:"Counts the numbers in the list of arguments, exclude text entries."},{formulaName:"COUNTA",category:"Statistical",description:"Counts the non-empty values in the list of arguments."},{formulaName:"COUNTIF",category:"Statistical",description:"Counts the number of cells in a range that meet a specified condition."},{formulaName:"COUNTIFS",category:"Statistical",description:"Counts the number of times each cells in all the ranges that meet the specific conditions."},{formulaName:"AVERAGEA",category:"Statistical",description:"Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references."},{formulaName:"AVERAGEIFS",category:"Statistical",description:"Conditionally returns the average of the contents of cells for the set of ranges."},{formulaName:"MIN",category:"Statistical",description:"Returns the smaller number in set of arguments."},{formulaName:"MAX",category:"Statistical",description:"Returns the largest number in set of arguments."},{formulaName:"DATE",category:"Date",description:"Returns the date, given the year, month and day of the month."},{formulaName:"DAY",category:"Date",description:"Returns the day of a given date."},{formulaName:"TODAY",category:"Date",description:"Returns the current date as date value."},{formulaName:"DAYS",category:"Date",description:"Returns the number of days between two dates."},{formulaName:"WEEKDAY",category:"Date",description:"Returns the day of the week corresponding to a date."},{formulaName:"IF",category:"Logical",description:"Returns one value if a logical expression is TRUE and another if it is FALSE"},{formulaName:"AND",category:"Logical",description:"Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise."},{formulaName:"IFS",category:"Logical",description:"Checks multiple conditions and returns a value corresponding to the first TRUE result."},{formulaName:"IFERROR",category:"Logical",description:"Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula."},{formulaName:"CHOOSE",category:"Lookup & Reference",description:"Returns a value from a list, given an index number."},{formulaName:"INDEX",category:"Lookup & Reference",description:"Returns a value from a table, given a row and column number."},{formulaName:"FIND",category:"Text",description:"Returns the position of a string of text within another string."},{formulaName:"CONCATENATE",category:"Text",description:" Used to join two or more strings together."},{formulaName:"CONCAT",category:"Text",description:"Concatenates a list or range of text strings."},{formulaName:"SUBTOTAL",category:"Lookup & Reference",description:"Returns a subtotal in a list or database."},{formulaName:"RADIANS",category:"Math & Trig",description:"Converts degrees to radians."},{formulaName:"OR",category:"Logical",description:"Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE."},{formulaName:"NOT",category:"Logical",description:"Returns the inverse of a given logical expression."},{formulaName:"MATCH",category:"Lookup & Reference",description:"Returns the relative position of an checked item in range that matches a specified value in a specified order"},{formulaName:"RANDBETWEEN",category:"Math & Trig",description:"Returns an integer random number in a specified range."},{formulaName:"SLOPE",category:"Statistical",description:"Returns the slope of the line from linear regression of the data points."},{formulaName:"INTERCEPT",category:"Statistical",description:"Calculates the point of the Y-intercept line via linear regression."},{formulaName:"RSQ",category:"Statistical",description:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_ys and known_xs"},{formulaName:"UNIQUE",category:"Lookup & Reference",description:"Returns a unique values from a range or array."},{formulaName:"ROUNDUP",category:"Math & Trig",description:"Rounds a number away from zero."},{formulaName:"ROUNDDOWN",category:"Math & Trig",description:"Rounds a number down, toward zero."},{formulaName:"INT",category:"Math & Trig",description:"Returns a number to the nearest integer."},{formulaName:"LN",category:"Math & Trig",description:"Returns the natural logarithm of a number."},{formulaName:"ISNUMBER",category:"Information",description:"Returns TRUE, if the argument is number and FALSE otherwise."},{formulaName:"ROUND",category:"Math & Trig",description:"Rounds a number to a specified number of digits."},{formulaName:"LOG",category:"Math & Trig",description:"Returns the logarithm of a number to the base that you specify."},{formulaName:"POWER",category:"Math & Trig",description:"Returns the result of a number raised to power."},{formulaName:"SQRT",category:"Math & Trig",description:"Returns the square root of a positive number."},{formulaName:"TRUNC",category:"Math & Trig",description:"Returns the truncated value of a number to a specified number of decimal places."},{formulaName:"EXP",category:"Math & Trig",description:"Returns e raised to the power of the given number."},{formulaName:"GEOMEAN",category:"Statistical",description:"Returns the geometric mean of an array or range of positive data."},{formulaName:"TEXT",category:"Lookup & Reference",description:"Converts a value to text in specified number format."},{formulaName:"SORT",category:"Lookup & Reference",description:"Sorts a range of an array."},{formulaName:"LOOKUP",category:"Lookup & Reference",description:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range."},{formulaName:"VLOOKUP",category:"Lookup & Reference",description:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row."},{formulaName:"HLOOKUP",category:"Lookup & Reference",description:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify."},{formulaName:"T",category:"Text",description:"Checks whether a value is text or not and returns the text."},{formulaName:"EXACT",category:"Text",description:"Checks whether a two text strings are exactly same and returns TRUE or FALSE."},{formulaName:"LEN",category:"Text",description:"Returns a number of characters in a given string."},{formulaName:"MOD",category:"Math & Trig",description:"Returns a remainder after a number is divided by divisor."},{formulaName:"ODD",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest odd integer."},{formulaName:"PI",category:"Math & Trig",description:"Returns the value of pi."},{formulaName:"COUNTBLANK",category:"Statistical",description:"Returns the number of empty cells in a specified range of cells."},{formulaName:"EVEN",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest even integer."},{formulaName:"FACT",category:"Math & Trig",description:"Returns the factorial of a number."},{formulaName:"DECIMAL",category:"Math & Trig",description:"Converts a text representation of a number in a given base into a decimal number."},{formulaName:"DEGREES",category:"Math & Trig",description:"Converts radians to degrees."},{formulaName:"ADDRESS",category:"Lookup & Reference",description:"Returns a cell reference as text, given specified row and column numbers."},{formulaName:"TIME",category:"Date & Time",description:"Converts hours, minutes, seconds to the time formatted text."},{formulaName:"CHAR",category:"Text",description:"Returns the character from the specified number."},{formulaName:"CODE",category:"Text",description:"Returns the numeric code for the first character in a given string."},{formulaName:"DOLLAR",category:"Text",description:"Converts the number to currency formatted text."},{formulaName:"SMALL",category:"Statistical",description:"Returns the k-th smallest value in a given array."},{formulaName:"LARGE",category:"Statistical",description:"Returns the k-th largest value in a given array."},{formulaName:"MEDIAN",category:"Statistical",description:"Returns the median of the given set of numbers."},{formulaName:"EDATE",category:"Date & Time",description:"Returns a date with given number of months before or after the specified date."},{formulaName:"EOMONTH",category:"Date & Time",description:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date."},{formulaName:"DATEVALUE",category:"Date & Time",description:"Converts a date string into date value."},{formulaName:"HOUR",category:"Date & Time",description:"Returns the number of hours in a specified time string."},{formulaName:"MINUTE",category:"Date & Time",description:"Returns the number of minutes in a specified time string."},{formulaName:"SECOND",category:"Date & Time",description:"Returns the number of seconds in a specified time string."},{formulaName:"NOW",category:"Date & Time",description:"Returns the current date and time."},{formulaName:"MONTH",category:"Date & Time",description:"Returns the number of months in a specified date string."},{formulaName:"PROPER",category:"Text",description:"Converts a text to proper case; first letter to uppercase and other letters to lowercase."}],this.isConcat=!1,this.parent=t,this.init()}return o.prototype.init=function(){for(var t,e=0;e<this.formulas.length;e++)t=V("Compute"+this.formulas[e].formulaName,this).bind(this),this.addFormulaCollection(this.formulas[e].formulaName.toUpperCase(),t,this.formulas[e].category,this.formulas[e].description)},o.prototype.addFormulaCollection=function(t,e,i,r){this.parent.libraryFormulas={fName:t,handler:e,category:i,description:r}},o.prototype.ComputeSUM=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;if(t.length){var r=t[t.length-1];r==="isSubtotal"&&(i=!0,t.pop())}if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var n=0,s,a,l=0;if(!g(t))for(var h=t,c=function(v){v.toString().indexOf(".")>-1&&(l=Math.max(l,v.split(".")[1].length))},u=0;u<h.length;u++){var d=h[u].toString();if(d.indexOf(":")>-1&&this.parent.isCellReference(d)){for(var p=this.parent.getCellCollection(d.split(this.parent.tic).join("")),f=0;f<p.length;f++)if(s=i?this.parent.getValueFromArg(p[f],null,null,!0):this.parent.getValueFromArg(p[f]),!(i&&s.includes("SUBTOTAL("))){if(this.parent.getErrorStrings().indexOf(s)>-1)return s;g(s[0])||isNaN(this.parent.parseFloat(s))||(c(s),n=n+this.parent.parseFloat(s))}}else{if(h[u].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(h[u].split(this.parent.tic).join("")))||h[u].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.Value];if(h[u].split(this.parent.tic).join("")===this.parent.trueValue&&(h[u]="1"),h[u].split(this.parent.tic).join("")===this.parent.falseValue&&(h[u]="0"),a=i?this.parent.getValueFromArg(h[u].split(this.parent.tic).join(""),null,null,!0):this.parent.getValueFromArg(h[u].split(this.parent.tic).join("")),i&&a.includes("SUBTOTAL("))continue;if(this.parent.getErrorStrings().indexOf(a)>-1)return a;if(g(a)||isNaN(this.parent.parseFloat(a)))continue;a.length>0&&(c(a),n=n+this.parent.parseFloat(a+""))}}return n.toString().indexOf(".")>-1?n.toFixed(l):n},o.prototype.ComputeINT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();return t[0]===""&&t.length===1?this.parent.formulaErrorStrings[me.InvalidArguments]:t.length>1?this.parent.formulaErrorStrings[me.WrongNumberArguments]:(i=this.parent.getValueFromArg(t[0]),r.indexOf(i)>-1?i:(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue&&(i="0"),!this.parent.isCellReference(t[0])&&(t[0].indexOf(this.parent.tic+this.parent.tic)===-1&&(i=i.split(this.parent.tic).join("")),i.trim()==="")||(i.indexOf("%")>-1&&(i=(Number(i.split("%")[0])*.01).toString()),isNaN(this.parent.parseFloat(i)))?r[W.Value]:(i=this.parent.parseFloat(i),i=Math.floor(i),i)))},o.prototype.ComputeTODAY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;if(t.length!==1||t[0]!=="")i=this.parent.formulaErrorStrings[me.InvalidArguments];else{var r=new Date(Date.now());this.parent.parentObject.getModuleName()==="spreadsheet"?(i=this.parent.parentObject.dateToInt(r),this.parent.parser.storedStringText.toUpperCase().indexOf("TODAY")===0&&this.parent.cell!==""&&this.parent.parentObject.setDateFormat(this.parent.getSheetId(this.parent.grid),this.parent.rowIndex(this.parent.cell)-1,this.parent.colIndex(this.parent.cell)-1)):i=r.getFullYear()+"/"+this.parent.calculateDate((r.getMonth()+1).toString())+"/"+this.parent.calculateDate(r.getDate().toString())}return i},o.prototype.ComputeWEEKDAY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0]===""&&g(t[1])||t.length>2)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0]===""&&t[1]===""||t[1]==="")return this.parent.getErrorStrings()[W.Num].toString();if(t.length===1&&t.push("1"),t[0].indexOf(this.parent.tic)>-1&&t[0].split(this.parent.tic).join("").trim()===""||t[1].split(this.parent.tic).join("").trim()===""||t[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r,n;if(this.parent.isCellReference(t[0])){if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else t[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[0].split(this.parent.tic).join("")))?i=this.parent.getValueFromArg(t[0]):i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0";if(this.parent.isCellReference(t[1])?r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""))||"0":r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=this.parent.parseFloat(i),r=this.parent.parseFloat(r),isNaN(r)||isNaN(n))return this.parent.getErrorStrings()[W.Value];if(n<0||n>2958465)return this.parent.getErrorStrings()[W.Num].toString();switch(r=parseInt(r.toString(),10),n=n<1?0:Math.floor(n)%7,r){case 1:case 17:n=n<=0?n+7:n;break;case 2:case 11:n=n-1,n=n<=0?n+7:n;break;case 3:n=n-2,n=n<0?n+7:n;break;case 12:n=n+5,n=n>7?n-7:n;break;case 13:n=n+4,n=n>7?n-7:n;break;case 14:n=n+3,n=n>7?n-7:n;break;case 15:n=n+2,n=n>7?n-7:n;break;case 16:n=n+1,n=n>7?n-7:n;break;default:n=this.parent.getErrorStrings()[W.Num].toString();break}return n},o.prototype.ComputePROPER=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n=this.parent.getErrorStrings();return t.length&&t[t.length-1]==="nestedFormulaTrue"&&(r=!0,t.pop()),g(t)||t[0].trim()===""&&t.length===1?this.parent.formulaErrorStrings[me.InvalidArguments]:t.length>1?this.parent.formulaErrorStrings[me.WrongNumberArguments]:(i=this.parent.getValueFromArg(t[0]).trim(),n.indexOf(i)>-1||(t[0].indexOf(this.parent.tic)>-1?t[0]!==i&&t[0].startsWith("n")?i=this.parent.removeTics(i.trim()):(i=this.parent.removeTics(t[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic))):!t[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=i.toLowerCase().replace(/\b\w/g,function(s){return s.toUpperCase()}).replace(/(\d)([a-z])/g,function(s,a,l){return a+l.toUpperCase()}),r&&(i=this.parent.tic+i+this.parent.tic)),i)},o.prototype.ComputeSUMPRODUCT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r;if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];for(var n=0,s=0,a,l=null,h=t,c=[],u=0;u<h.length;u++){var d=this.parent.getCellCollection(h[u]);if(d[0]==="#REF!")return this.parent.getErrorStrings()[W.Name];c.push(d.length)}for(var p=0;p<c.length;p++)if(c[p]&&c[p+1]&&c[p]!==c[p+1])return this.parent.getErrorStrings()[W.Value];for(var f=0;f<h.length;++f){var v=h[f];if(!v.startsWith(this.parent.tic)&&this.parent.isCellReference(v)){var u=v.indexOf(":"),m=this.parent.rowIndex(v.substr(0,u)),y=this.parent.rowIndex(v.substr(u+1));if(!(m!==-1||y===-1)==(m===-1||y!==-1))return this.parent.getErrorStrings()[W.Name];m>y&&(i=[y,m],m=i[0],y=i[1]);var b=this.parent.colIndex(v.substr(0,u)),S=this.parent.colIndex(v.substr(u+1));if(b>S&&(r=[S,b],b=r[0],S=r[1]),l===null)for(s=(y-m+1)*(S-b+1),l=[],u=0;u<s;++u)l[u]=1;u=0;for(var C=m;C<=y;++C)for(var x=b;x<=S;++x){var I=this.getSheetReference(v)+this.parent.convertAlpha(x)+C,D=this.parent.getValueFromArg(I);if(this.parent.getErrorStrings().indexOf(D)>-1)return D;if(isNaN(this.parent.parseFloat(D)))l[u]=0;else{if(isNaN(l[u]))return this.parent.getErrorStrings()[W.Name];l[u]=l[u]*this.parent.parseFloat(D)}u++}}else{var M=this.parent.getValueFromArg(v);return a=M.indexOf('"'),this.parent.getErrorStrings().indexOf(M)>-1?M:a>-1?0:this.parent.getErrorStrings()[W.Value]}}for(var u=0;u<s;++u)n+=l[u];return n},o.prototype.ComputeROUNDUP=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n,s,a,l=t.length;if(!g(t)&&l>2&&(i=this.parent.formulaErrorStrings[me.InvalidArguments]),l===1&&t[0]!=="")s=t[0].indexOf('"'),r=t[0].indexOf('"')>-1?t[0].replace('"',""):t[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),a=this.parent.parseFloat(r),a>0?a+=.4999999999:a<0&&(a-=.4999999999),a=this.parent.parseFloat(a.toFixed(0)),i=a.toString();else if(l===2){if(s=t[0].indexOf('"')>-1?t[0].indexOf('"'):t[1].indexOf('"')>-1?t[1].indexOf('"'):-1,this.parent.isCellReference(t[0]))r=this.parent.getValueFromArg(t[0])||"0";else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(t[1]))n=this.parent.getValueFromArg(t[1])||"0";else{if(t[1].indexOf(this.parent.tic)>-1&&(t[1].split(this.parent.tic).join("")===this.parent.trueValue||t[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",c=isNaN(Number(n))||n.trim()==="";if((t[0].indexOf('"')>-1||this.parent.isCellReference(t[0]))&&h||(t[1].indexOf('"')>-1||this.parent.isCellReference(t[1]))&&c)return this.parent.getErrorStrings()[W.Value];var u=Math.ceil(this.parent.parseFloat(n));if(a=this.parent.parseFloat(r),u>0){var d=r.split("."),p=d.length===2?d[1].length>=u?u:d[1].length:0;a=this.parent.parseFloat(this.preciseRound(a,p,"ROUNDUP")),i=a.toString(),isNaN(a)&&(u.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else a>0?a=a/Math.pow(10,-u)+.49999:a<0&&(a=a/Math.pow(10,-u)-.49999),a>0&&u<-9?a=1*Math.pow(10,-u):a=this.parent.parseFloat(a.toFixed(0))*Math.pow(10,-u),i=a.toString(),isNaN(a)&&(i=u.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else i=s>-1?this.parent.getErrorStrings()[W.Value]:this.parent.formulaErrorStrings[me.InvalidArguments];return i},o.prototype.ComputeROUNDDOWN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n,s,a,l=t.length;if(!g(t)&&l>2&&(i=this.parent.formulaErrorStrings[me.InvalidArguments]),l===1&&t[0]!=="")s=t[0].indexOf('"'),r=t[0].indexOf('"')>-1?t[0].replace('"',""):t[0],r=r.indexOf('"')>-1?r.replace('"',""):r,r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,r=this.parent.getValueFromArg(r),a=this.parent.parseFloat(r),a>0?a-=.4999999999:a<0&&(a+=.4999999999),a=this.parent.parseFloat(a.toFixed(0)),i=a.toString();else if(l===2){if(s=t[0].indexOf('"')>-1?t[0].indexOf('"'):t[1].indexOf('"')>-1?t[1].indexOf('"'):-1,this.parent.isCellReference(t[0]))r=this.parent.getValueFromArg(t[0])||"0";else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(this.parent.isCellReference(t[1]))n=this.parent.getValueFromArg(t[1])||"0";else{if(t[1].indexOf(this.parent.tic)>-1&&(t[1].split(this.parent.tic).join("")===this.parent.trueValue||t[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;r=r.toUpperCase()==="TRUE"?"1":r==="FALSE"?"0":r,n=n.toUpperCase()==="TRUE"?"1":n==="FALSE"?"0":n;var h=isNaN(Number(r))||r.trim()==="",c=isNaN(Number(n))||n.trim()==="";if((t[0].indexOf('"')>-1||this.parent.isCellReference(t[0]))&&h||(t[1].indexOf('"')>-1||this.parent.isCellReference(t[1]))&&c)return this.parent.getErrorStrings()[W.Value];var u=Math.ceil(this.parent.parseFloat(n));if(a=this.parent.parseFloat(r),u>0){var d=r.indexOf("."),p=0;d!==-1&&(p=r.length-d-1,p=p>=u?u:p),a=this.parent.parseFloat(this.preciseRound(a,p,"ROUNDDOWN")),i=a.toString(),isNaN(a)&&(u.toString().indexOf('"')>-1?i=this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else a>0?a=a/Math.pow(10,-u)-.49999:a<0&&(a=a/Math.pow(10,-u)+.49999),a>0&&u<-9?a=1*Math.pow(10,-u):a=this.parent.parseFloat(a.toFixed(0))*Math.pow(10,-u),i=a.toString(),isNaN(a)&&(i=u.toString().indexOf('"')>-1?this.parent.getErrorStrings()[W.Value]:i=this.parent.getErrorStrings()[W.Name])}else i=s>-1?this.parent.getErrorStrings()[W.Value]:this.parent.formulaErrorStrings[me.InvalidArguments];return i},o.prototype.ComputeCOUNT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;if(t.length&&t[t.length-1]==="isSubtotal"&&(i=!0,t.pop()),g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.WrongNumberArguments];for(var r=t,n,s,a=0,l,h,c=0;c<r.length;c++)if(n=r[c],this.parent.isCellReference(n))if(n.indexOf(":")>-1){s=this.parent.getCellCollection(n.split(this.parent.tic).join(""));for(var u=0;u<s.length;u++)l=i?this.parent.getValueFromArg(s[u],null,null,!0):this.parent.getValueFromArg(s[u]),!(i&&l.includes("SUBTOTAL("))&&(isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&a++)}else{if(l=i?this.parent.getValueFromArg(n,null,null,!0):this.parent.getValueFromArg(n),i&&l.includes("SUBTOTAL("))continue;isNaN(this.parent.parseFloat(l))||n.length>0&&l.trim()!==""&&a++}else h=this.parent.getValueFromArg(n).split(this.parent.tic).join(""),(n.length===0&&h.trim()===""||(!isNaN(this.parent.parseFloat(h))||n===this.parent.trueValue||n===this.parent.falseValue)&&n.length>0&&n.trim()!==""&&h.trim()!=="")&&a++;return a},o.prototype.ComputeDATE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;if(t.length&&t[t.length-1]==="nestedFormulaTrue"&&(i=!0,t.pop()),g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(t.length!==3)return this.parent.formulaErrorStrings[me.WrongNumberArguments];for(var r=[],n=0;n<t.length;++n)r[n]=this.parent.getValueFromArg(t[n]);r[0]=r[0]===this.parent.trueValue?"1":r[0]===this.parent.falseValue?"0":r[0],r[1]=r[1]===this.parent.trueValue?"1":r[1]===this.parent.falseValue?"0":r[1],r[2]=r[2]===this.parent.trueValue?"1":r[2]===this.parent.falseValue?"0":r[2];for(var s=0;s<r.length;s++){var a=r[s];if(this.parent.getErrorStrings().indexOf(a)>-1)return a;if(a==='""'||a==='"0"'&&t[s]!=='"0"'||a==='"TRUE"'||a==='"FALSE"')return this.parent.getErrorStrings()[W.Value].toString()}var l=Math.floor(this.parent.parseFloat(r[0].split(this.parent.tic).join(""))),h=Math.floor(this.parent.parseFloat(r[1].split(this.parent.tic).join(""))),c=Math.floor(this.parent.parseFloat(r[2].split(this.parent.tic).join(""))),u=0;if(!isNaN(l)&&!isNaN(h)&&!isNaN(c)){if(l<0&&h<=12||l>=1e4&&h>0)return this.parent.getErrorStrings()[W.Num].toString();for(;h>12;)h-=12,l++;u=this.parent.getSerialDateFromDate(l,h,c)}else return this.parent.getErrorStrings()[W.Value].toString();if(u===0)return this.parent.getErrorStrings()[W.Num].toString();var d=this.parent.fromOADate(u);if(d.toString()!=="Invalid Date"){if(d.getFullYear()<1900||1e4<=d.getFullYear())return this.parent.getErrorStrings()[W.Num].toString();if(!i)return new Nt(this.parent.parentObject.locale||"en-US").formatDate(d,{type:"date",skeleton:"yMd"})}return u.toString()},o.prototype.ComputeFLOOR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=t,r=i.length,n;if(r!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var s=0;s<i.length;s++){var a=i[s].split(this.parent.tic).join("").trim();if(a===""||i[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.Value];if(Or(i[s])){if(n=this.parent.getValueFromArg(i[s])||"0",n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value]}else if(n=this.parent.getValueFromArg(i[s].split(this.parent.tic).join("")),n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value];i[s]=n}var l=this.parent.parseFloat(i[0]),h=this.parent.parseFloat(i[1]);return l>0&&h<0?this.parent.getErrorStrings()[W.Num]:(l>0||l<0)&&h===0?this.parent.getErrorStrings()[W.DivZero]:isNaN(l)?this.parent.getErrorStrings()[W.Name]:l===0&&h===0?0:Math.floor(l/h)*h},o.prototype.ComputeCEILING=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=t,r=i.length,n;if(r!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i[0]===""&&i[1]===""||i[0]===""&&!i[1].includes('"'))return 0;i[1]===""&&!i[0].includes('"')&&(i[1]="0");for(var s=0;s<i.length;s++){var a=i[s].split(this.parent.tic).join("").trim();if(a===""||i[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(a)))return this.parent.getErrorStrings()[W.Value];if(Or(i[s])){if(n=this.parent.getValueFromArg(i[s])||"0",n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value]}else if(n=this.parent.getValueFromArg(i[s].split(this.parent.tic).join("")),n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,n.toUpperCase().match(/[A-Z]/)||n.includes('"')||!this.parent.isNumber(n))return this.parent.getErrorStrings()[W.Value];i[s]=n}var l=this.parent.parseFloat(i[0]),h=this.parent.parseFloat(i[1]);return l>0&&h<0?this.parent.getErrorStrings()[W.Num]:isNaN(l)?this.parent.getErrorStrings()[W.Name]:(l>0||l===0)&&h===0?0:Math.ceil(l/h)*h},o.prototype.ComputeDAY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(t[0].startsWith(this.parent.tic)){if(r=t[0].split(this.parent.tic).join(""),r===""||r===this.parent.trueValue||r===this.parent.falseValue)return n[W.Value]}else if(r=this.parent.getValueFromArg(t[0].split(this.parent.tic).join("")),this.parent.isCellReference(t[0])&&r.indexOf(this.parent.tic)>-1)return n[W.Value];return n.indexOf(r)>-1?r:Number(r)<0?n[W.Num]:Math.floor(Number(r))===0||r===this.parent.falseValue?0:r===this.parent.trueValue?1:(i=this.parent.isNaN(Number(r))?this.parent.parseDate(r):this.parent.intToDate(r),Object.prototype.toString.call(i)==="[object Date]"&&(i=new Date(i).getFullYear()<1900||new Date(i).getFullYear()>9999?this.parent.isNumber(r)?"Num":"NaN":i.getDate()),i.toString()==="NaN"?n[W.Value]:i.toString()==="Num"?n[W.Num]:i)},o.prototype.ComputeIF=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;if(t.length&&t[t.length-1]==="nestedFormulaTrue"&&(i=!0,t.pop()),g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(this.parent.getErrorStrings().indexOf(t[0])>0)return t[0];var r=t,n;r.length===4&&r[3]==="nestedFormulaTrue"&&(n=!0,r.pop());var s,a;if(r.length>3||r.length===1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(r.length<=3){var l=void 0,h=void 0,c="";if(s=this.parent.getValueFromArg(r[0]),this.parent.getErrorStrings().indexOf(s)>-1)return s;var u=s.toUpperCase(),d=this.parent.parseFloat(s);if(u===this.parent.trueValue||d<0||d>0){if(i&&r[1].includes(":")){l=this.parent.getCellCollection(r[1]);for(var p=0;p<l.length;p++)h=this.parent.getValueFromArg(l[p]),isNaN(this.parent.parseFloat(h))||(c+=h+",");return c.slice(0,c.length-1)}a=r[1]===""?"0":this.parent.getValueFromArg(r[1],void 0,void 0,void 0,!0)}else if(u===this.parent.falseValue||d===0){if(g(r[2]))return this.parent.falseValue;if(i&&r[2].includes(":")){l=this.parent.getCellCollection(r[2]);for(var p=0;p<l.length;p++)h=this.parent.getValueFromArg(l[p]),isNaN(this.parent.parseFloat(h))||(c+=h+",");return c.slice(0,c.length-1)}a=r[2]===""?"0":this.parent.getValueFromArg(r[2],void 0,void 0,void 0,!0)}else return this.parent.formulaErrorStrings[me.Requires3Args]}var f=a.indexOf(this.parent.tic);return!n&&f>-1?a.split(this.parent.tic).join(""):n&&!De(a)&&f===-1&&a!==this.parent.trueValue&&a!==this.parent.falseValue&&!this.parent.isCellReference(a)?'"'+a+'"':a===""?"0":a},o.prototype.ComputeIFERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=t,r;if(i.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0])||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r}else if(r=this.parent.getValueFromArg(i[0],null,!0)||"0",this.parent.getErrorStrings().indexOf(r)===-1&&r!=="NaN")return r=r.split(this.parent.tic).join("").trim(),r;return this.parent.isCellReference(i[1])?r=this.parent.getValueFromArg(i[1])||"0":(r=this.parent.getValueFromArg(i[1])||"0",r=r.split(this.parent.tic).join("").trim()),r},o.prototype.ComputePRODUCT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;if(t.length&&t[t.length-1]==="isSubtotal"&&(i=!0,t.pop()),g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var r=1,n,s,a=!0,l;if(!g(t))for(var h=t,c=0;c<h.length;c++){var u=h[c];if(u.indexOf(":")>-1&&this.parent.isCellReference(u)){for(var d=this.parent.getCellCollection(u),p=0;p<d.length;p++)if(n=i?this.parent.getValueFromArg(d[p],null,null,!0):this.parent.getValueFromArg(d[p]),!(i&&n.includes("SUBTOTAL("))&&De(n)){if(this.parent.getErrorStrings().indexOf(n)>-1)return n;l=this.parent.parseFloat(n),isNaN(l)||n.length>0&&(r=r*l,a=!1)}}else if(u.indexOf(":")===-1&&this.parent.isCellReference(u)){if(s=i?this.parent.getValueFromArg(h[c],null,null,!0):this.parent.getValueFromArg(h[c]),i&&s.includes("SUBTOTAL(")||!De(s))continue;if(this.parent.getErrorStrings().indexOf(s)>-1)return s}else{s=h[c];var f=s.indexOf(this.parent.tic)>-1&&s.split(this.parent.tic).join("").trim()==="";if(f||h[c].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(s.split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];if(s=this.parent.getValueFromArg(h[c].split(this.parent.tic).join("")),s=s===this.parent.trueValue?"1":s===this.parent.falseValue?"0":s.split(this.parent.tic).join(""),this.parent.getErrorStrings().indexOf(s)>-1)return s}l=this.parent.parseFloat(s),isNaN(l)||s.length>0&&(r=r*l,a=!1)}return a?"0":r.toString()},o.prototype.ComputeDAYS=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(e)&&e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=function(h){var c=t.parent.getValueFromArg(h).trim();if(c.indexOf(t.parent.tic)>-1&&(c=c.split(t.parent.tic).join("").trim(),c===""||t.parent.isCellReference(h)||c.toUpperCase()===t.parent.trueValue||c.toUpperCase()===t.parent.falseValue))return r[W.Value];if(c=c.split(t.parent.tic).join(""),c.toUpperCase()===t.parent.trueValue)c="1";else if(c===""||c.toUpperCase()===t.parent.falseValue)c="0";else if(Number(c)<0)return r[W.Num];var u={value:c.toString()};return t.parent.parentObject.notify(Jr,u),(u.isDate||u.isTime)&&(c=(t.parent.parseDate(c).getTime()/(1e3*3600*24)).toString()),c},s=n(e[0]);if(r.indexOf(s)>-1)return s;var a=n(e[1]);if(r.indexOf(a)>-1)return a;var l=Math.floor(Number(s))-Math.floor(Number(a));return isNaN(l)?r[W.Value]:l},o.prototype.ComputeUNIQUE=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(e[e.length-1]==="isComputeExp"&&(n=!0,e.pop()),g(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length>3)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var a=function(qe){if(g(qe))return t.parent.falseValue;var we=t.parent.getValueFromArg(qe);return s.indexOf(we)>-1?we:Number(we)===0?t.parent.falseValue:Number(we)<0||Number(we)>0?t.parent.trueValue:(t.parent.isCellReference(qe)||(we=t.parent.removeTics(we)),we.toUpperCase()===t.parent.trueValue||we.toUpperCase()===t.parent.falseValue?we.toUpperCase():we.indexOf(t.parent.tic)>-1||qe.indexOf(t.parent.tic)>-1?s[W.Value]:s[W.Name])},l=a(e[1]);if(s.indexOf(l)>-1)return l;var h=a(e[2]);if(s.indexOf(h)>-1)return h;var c=[];if(e[0].indexOf(":")>-1){if(g(e[0].match(/[0-9]/))){var u=e[0].split(":");e[0]=u[0]+"1:"+u[1]+(this.parent.spreadSheetUsedRange[0]+1)}else if(g(e[0].toUpperCase().match(/[A-Z]/))){var u=e[0].split(":");e[0]="A"+u[0]+":"+li(this.parent.spreadSheetUsedRange[1]+1)+u[1]}var d=e[0].split(":");if(this.parent.isCellReference(d[0])&&this.parent.isCellReference(d[1])){for(var p=this.parent.dependencyCollection,f=0;f<p.length&&!n;f++)p[f].split(":")[0]===e[0].split(":")[0]&&this.clearDependency(p[f]);this.parent.dependencyCollection.indexOf(e[0])===-1?n||this.parent.dependencyCollection.push(e[0]):this.clearDependency(e[0]);var v=e[0].indexOf(":"),m=void 0,y=this.parent.rowIndex(this.parent.substring(e[0],0,v)),b=this.parent.colIndex(this.parent.substring(e[0],0,v)),S=this.parent.rowIndex(this.parent.substring(e[0],v+1,v+e[0].length-v-1)),C=this.parent.colIndex(this.parent.substring(e[0],v+1,v+e[0].length-v-1));y>S&&(m=S,S=y,y=m),b>C&&(m=C,C=b,b=m);var x="";e[0].indexOf("!")===0&&(x=e[0].substring(0,e[0].replace("!","").indexOf("!")+2)),e[0]=x+li(b)+y+":"+li(C)+S;var I=C-b,D=this.parent.getCellCollection(e[0]),M=void 0,E=void 0;if(M=E=this.parent.actCell,l===this.parent.falseValue)if(I===0)for(var f=0;f<D.length;f++){var A=this.parent.getValueFromArg(D[f]);A=A===""?"0":A,c.push(A)}else for(var L="",N=I,f=0;f<D.length;f++){if(f===D.length-1){var A=this.parent.getValueFromArg(D[f]);A=A===""?"0":A,L=L+A+"++",c.push(L.substring(0,L.length-2))}if(f<=N){var A=this.parent.getValueFromArg(D[f]);A=A===""?"0":A,L=L+A+"++"}else{c.push(L.substring(0,L.length-2)),N=I+f;var A=this.parent.getValueFromArg(D[f]);A=A===""?"0":A,L=A+"++"}}else for(var L="",N=I+1,R=S-y,f=0;f<N;f++){for(var P=0;P<=R;P++){var A=this.parent.getValueFromArg(D[P*N+f]);A=A===""?"0":A,L=L+A+"++"}c.push(L.substring(0,L.length-2)),L=""}for(var k=[],B=[],F=[],O=[],f=0;f<c.length;f++)k.indexOf(c[f].toLowerCase())===-1?(k.push(c[f].toLowerCase()),F.push(c[f])):(B.indexOf(c[f].toLowerCase())===-1&&B.push(c[f].toLowerCase()),O.push(c[f]));if(h===this.parent.trueValue){for(var z=[],f=0;f<F.length;f++)B.indexOf(F[f].toLowerCase())===-1&&z.push(F[f]);if(F=z,F.length===0)return s[W.Calc]}if(n){var Y;return I!==0?(Y=[],F.forEach(function(qe){Y=Y.concat(qe.split("++"))})):Y=l===this.parent.falseValue?F:F[0].split("++"),Y}M.indexOf("!")>-1&&(M=M.substring(M.lastIndexOf("!")+1));var K=this.parent.rowIndex(M),U=this.parent.colIndex(M);if(this.parent.dependencyLevel===0){var q=!1;if(l===this.parent.falseValue)for(var f=K,N=F.length+K;f<N;f++)for(var ae=F[0].split("++"),te=U,he=ae.length+U;te<he;te++)f===N-1&&te===he-1&&this.parent.uniqueRange.indexOf(E+":"+li(te)+f)===-1&&this.parent.uniqueRange.push(E+":"+li(te)+f),this.checkSpill(te,f)&&(q=!0);else for(var f=U,N=F.length+U;f<N;f++)for(var ae=F[0].split("++"),ue=K,he=ae.length+K;ue<he;ue++)f===N-1&&ue===he-1&&this.parent.uniqueRange.indexOf(this.parent.actCell+":"+li(f)+ue)===-1&&this.parent.uniqueRange.push(this.parent.actCell+":"+li(f)+ue),this.checkSpill(f,ue)&&(q=!0);if(q)return this.parent.formulaErrorStrings[me.Spill]}else if(this.parent.dependencyLevel>0&&this.parent.getValueFromArg(li(U)+K,!0).indexOf("#SPILL!")>-1)return this.parent.formulaErrorStrings[me.Spill];if(l===this.parent.falseValue){var ne=this.parent.getSheetFamilyItem(this.parent.grid),le="",$=void 0;ne.sheetNameToParentObject!==null&&ne.sheetNameToParentObject.size>0&&(le=ne.parentObjectToToken.get(this.parent.grid),$=le+M);for(var f=0;f<F.length;f++){var ae=F[f].split("++");f>0&&(K++,U=this.parent.colIndex(M));for(var ee=0;ee<ae.length;ee++)this.setValueRefresh(ae[ee],K,U),(f>0||ee>0)&&this.parent.refresh(le+li(U)+K.toString(),$),ae[ee+1]&&U++}r=F[0].split("++")[0]}else{for(var f=0;f<F.length;f++)for(var ae=F[f].split("++"),He=0;He<ae.length;He++)this.setValueRefresh(ae[He],K,U),ae[He+1]?K++:(U++,K=this.parent.rowIndex(M));r=F[0].split("++")[0]}}}else if(this.parent.isCellReference(e[0]))this.parent.dependencyCollection.indexOf(e[0])===-1?n||this.parent.dependencyCollection.push(e[0]):this.clearDependency(e[0]),r=this.parent.getValueFromArg(e[0]);else{if(r=this.parent.getValueFromArg(e[0].trim()),s.indexOf(r)>-1)return r;r=this.parent.removeTics(r)}return r},o.prototype.setValueRefresh=function(t,e,i){this.parent.parentObject.setValueRowCol(this.parent.getSheetId(this.parent.grid),t,e,i)},o.prototype.checkSpill=function(t,e){var i=!1,r=this.parent.getValueFromArg(li(t)+e,!0),n="!"+this.parent.getSheetID(this.parent.grid)+"!"+li(t)+e,s;return this.parent.getFormulaInfoTable().get(n)&&(s=this.parent.getFormulaInfoTable().get(n).formulaText),r&&(r.toUpperCase().indexOf("UNIQUE")<0||s&&!s.toUpperCase().includes("UNIQUE"))&&r!==this.parent.formulaErrorStrings[me.WrongNumberArguments]&&(i=!0),i},o.prototype.clearDependency=function(t){var e=this.parent.actCell,i="";if(e.lastIndexOf("!")>-1){var r=e;e=r.substring(r.lastIndexOf("!")+1),i=r.substring(0,r.lastIndexOf("!"))+"!"}for(var n=this.parent.rowIndex(e),s=this.parent.colIndex(e),a=t.indexOf(":"),l=this.parent.rowIndex(this.parent.substring(t,0,a)),h=this.parent.colIndex(this.parent.substring(t,0,a)),c=this.parent.rowIndex(this.parent.substring(t,a+1,a+t.length-a-1)),u=this.parent.colIndex(this.parent.substring(t,a+1,a+t.length-a-1)),d=c-l+n,p=u-h+s,f=this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+e)?this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+e).getFormulaText():"",v=n;v<=d;v++)for(var m=s;m<=p;m++)if(this.parent.dependencyLevel>0||f.indexOf("UNIQUE")>-1){if(this.parent.getValueFromArg("!"+this.parent.getSheetID(this.parent.grid)+"!"+li(s)+n,!0).indexOf("#SPILL!")>-1)return;this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,"",v,m),this.parent.refresh("!"+this.parent.getSheetID(this.parent.grid)+"!"+li(m)+v,e),this.parent.actCell=i+e}},o.prototype.ComputeT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n=this.parent.getErrorStrings();if(t.length&&t[t.length-1]==="nestedFormulaTrue"&&(r=!0,t.pop()),g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i=this.parent.getValueFromArg(t[0]).trim(),n.indexOf(i)>-1)return i;if(t[0].indexOf(this.parent.tic)>-1)i=this.parent.removeTics(t[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic));else if(i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),this.parent.isNumber(i)||i.toUpperCase()===this.parent.trueValue||i.toUpperCase()===this.parent.falseValue)return"";return r&&(i=this.parent.tic+i+this.parent.tic),i},o.prototype.ComputeHOUR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==1||g(t)||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(t[0])){if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getHours()},o.prototype.ComputeMINUTE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==1||g(t)||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(t[0])){if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getMinutes()},o.prototype.ComputeSECOND=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==1||g(t)||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var i;if(this.parent.isCellReference(t[0])){if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i;var r;if(this.parent.isNumber(i)){if(this.parent.parseFloat(i)<0||this.parent.parseFloat(i)>2958465)return this.parent.getErrorStrings()[W.Num];r=this.parent.intToTime(i)}else{var n={value:i.toString()};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)r=n.dateObj;else return this.parent.getErrorStrings()[W.Value]}if(r.toString()==="Invalid Date"&&(r=new Date(Date.parse(i))),r.toString()==="Invalid Date"){var s=new Date(Date.now()).toLocaleDateString()+" "+i;r=new Date(Date.parse(s))}return r.toString()==="Invalid Date"&&(r=this.parent.fromOADate(this.parent.parseFloat(i))),r.toString()==="Invalid Date"?this.parent.getErrorStrings()[W.Value]:r.getFullYear()<1900||r.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:r.getSeconds()},o.prototype.ComputeMONTH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.parent.getErrorStrings();if(t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var r=this.parent.getValueFromArg(t[0]).trim();if(i.indexOf(r)>-1)return r;if(this.parent.isCellReference(t[0])){if(r.indexOf(this.parent.tic)>-1)return i[W.Value];if(r==="")return 1}else{if(r.toUpperCase()==='"TRUE"'||r.toUpperCase()==='"FALSE"')return i[W.Value];r=r.split(this.parent.tic).join("")}if(r==="")return i[W.Value];if(r===this.parent.trueValue||r===this.parent.falseValue||Number(r)>-1&&Number(r)<32)return 1;if(Number(r)<0)return i[W.Num];r.indexOf("%")>-1&&(r=(Number(r.split("%")[0])*.01).toString()),this.parent.isNumber(r)&&(r=parseInt(Math.floor(Number(r)).toString(),10));var n=this.parent.parseDate(r);return n.toString()==="Invalid Date"?this.parent.isNumber(r)?i[W.Num]:i[W.Value]:n.getFullYear()<1900||1e4<=n.getFullYear()?i[W.Num]:(n.getMonth()+1).toString()},o.prototype.ComputeNOW=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==1||t[0]!=="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=new Date(Date.now()),r=new Nt,n=r.getDateFormat({format:"M/d/yyyy h:mm:ss a"}),s=this.parent.parentObject.dateToInt(n(i),!0);return s.toString()},o.prototype.ComputeEXACT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1,r=t.length&&t[t.length-1]==="nestedFormulaTrue",n=this.parent.getErrorStrings();if(r&&t.pop(),!t||!t[0]&&t.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var s,a,l;if(t[0]){if(s=this.parent.getValueFromArg(t[0]),n.indexOf(s)>-1)return s;s.indexOf(this.parent.tic)===-1&&s.includes("%")&&(s=(Number(s.split("%")[0])/100).toString()),this.parent.isCellReference(t[0])?l=!0:s=s.split(this.parent.tic).join("")}if(t[1]){if(a=this.parent.getValueFromArg(t[1]),n.indexOf(a)>-1)return a;a.indexOf(this.parent.tic)===-1&&a.includes("%")&&(a=(Number(a.split("%")[0])/100).toString()),this.parent.isCellReference(t[1])?!l&&s.trim().length===0&&a.trim().length===0&&(i=!1):(a=a.split(this.parent.tic).join(""),l&&s.trim().length===0&&a.trim().length===0&&(i=!1))}return s===a&&(i=!0,r&&(i=this.parent.tic+i+this.parent.tic)),i},o.prototype.ComputeLEN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();return g(t)||t[0].trim()===""&&t.length===1?this.parent.formulaErrorStrings[me.InvalidArguments]:t.length>1?this.parent.formulaErrorStrings[me.WrongNumberArguments]:(i=this.parent.getValueFromArg(t[0]).trim(),r.indexOf(i)>-1?i:(t[0].indexOf(this.parent.tic)>-1?t[0]!==i&&t[0].startsWith("n")?i=this.parent.removeTics(i.trim()):(i=this.parent.removeTics(t[0].trim()),i.indexOf(this.parent.tic+this.parent.tic)>-1&&(i=i.replace(/""/g,this.parent.tic))):!t[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i.length))},o.prototype.ComputeMOD=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;if(g(t)||t.length!==2)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[1]===""&&!t[0].includes('"'))return this.parent.formulaErrorStrings[me.Div];if(t[0]===""&&!t[1].includes('"'))return 0;for(var r=0;r<t.length;r++){var n=t[r].split(this.parent.tic).join("").trim();if(n===""||t[r].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(n)))return this.parent.getErrorStrings()[W.Value];if(Or(t[r])){if(i=this.parent.getValueFromArg(t[r])||"0",i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,i.toUpperCase().match(/[A-Z]/)||i.includes('"')||!this.parent.isNumber(i))return this.parent.getErrorStrings()[W.Value]}else if(i=this.parent.getValueFromArg(t[r].split(this.parent.tic).join("")),i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.getErrorStrings().indexOf(i)>-1)return i;t[r]=i}var s=t[0],a=t[1];if(a==="0"||a==="")return this.parent.formulaErrorStrings[me.Div];if(s==="0"||s==="")return 0;s=parseFloat(s),a=parseFloat(a);var l=(s%a+a)%a;return isNaN(l)?this.parent.getErrorStrings()[W.Name]:l},o.prototype.ComputeODD=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length!==1||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=t[0].split(this.parent.tic).join("").trim();if(i===""||t[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.Value];var r;if(Or(t[0])){if(r=this.parent.getValueFromArg(t[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(t[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}var n=Math.ceil(parseInt(r,10)),s=n===0;return n=n%2===0?n>0?n+1:n-1:n,Math.ceil(parseInt(r,10))%2!==0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.Name]:s?1:n},o.prototype.ComputeEVEN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length!==1||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var i=t[0].split(this.parent.tic).join("").trim();if(i===""||t[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(i)))return this.parent.getErrorStrings()[W.Value];var r;if(Or(t[0])){if(r=this.parent.getValueFromArg(t[0]),r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||r.includes('"')||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(t[0].split(this.parent.tic).join("")),r==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(r===this.parent.trueValue)r="1";else if(r===""||r===this.parent.falseValue)r="0";else if(r.toUpperCase().match(/[A-Z]/)||!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}var n=Math.ceil(parseInt(r,10));return n=n%2===0?n:n>0?n+1:n-1,Math.ceil(parseInt(r,10))%2===0&&(parseInt(r,10)>0&&parseFloat(r)>parseInt(r,10)?n=n+2:parseInt(r,10)<0&&parseFloat(r)<parseInt(r,10)&&(n=n-2)),isNaN(n)?this.parent.getErrorStrings()[W.Name]:n},o.prototype.ComputePI=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;return t&&t[0]!==""?i=this.parent.formulaErrorStrings[me.InvalidArguments]:i=Math.PI,i},o.prototype.ComputeMEDIAN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=[];if(g(t)||t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];for(var n=0;n<t.length;n++)if(this.parent.isCellReference(t[n]))if(t[n].indexOf(":")>-1)for(var s=this.parent.getCellCollection(t[n]),a=0;a<s.length;a++){var l=this.parent.getValueFromArg(s[a]);if(this.parent.getErrorStrings().indexOf(l)>-1)return l;l.trim()!==""&&r.push(this.parent.parseFloat(l))}else{var h=this.parent.getValueFromArg(t[n]);if(this.parent.getErrorStrings().indexOf(h)>-1)return h;h.trim()!==""&&r.push(this.parent.parseFloat(h))}else if(t[n]===""||t[n]===this.parent.falseValue&&!this.parent.isCellReference(t[n]))r.push(0);else if(t[n]===this.parent.trueValue&&!this.parent.isCellReference(t[n]))r.push(1);else{if(t[n].indexOf(this.parent.tic)>-1&&isNaN(parseFloat(t[n].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var c=this.parent.getValueFromArg(t[n]).split(this.parent.tic).join("");if(this.parent.getErrorStrings().indexOf(c)>-1)return c;r.push(this.parent.parseFloat(c))}r=r.sort(function(p,f){return p-f});for(var u=r.length,d=0;d<u&&!(isNaN(r[d])&&(r.splice(d,1),u=r.length,d--,r.length===0));d++);if(r.length%2!==0&&!isNaN(r[parseInt((r.length/2).toString(),10)]))i=r[parseInt((r.length/2).toString(),10)];else if(!isNaN(r[r.length/2])&&!isNaN(r[r.length/2-1]))i=(r[r.length/2]+r[r.length/2-1])/2;else return this.parent.getErrorStrings()[W.Num];return i},o.prototype.ComputeEDATE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==2||g(t))return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0]===""||t[1]==="")return this.parent.getErrorStrings()[W.NA];if(t[0].split(this.parent.tic).join("")===""||t[1].split(this.parent.tic).join("")===""||t[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r;if(this.parent.isCellReference(t[0])){if(t[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""));if(this.parent.isCellReference(t[1])){if(t[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.Num];n=this.parent.fromOADate(i)}else n=this.parent.checkDateFormat(i);if(isNaN(r)||g(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.Value];var s=n.getDate();n.setMonth(n.getMonth()+r),s!==n.getDate()&&n.setDate(0);var a=this.parent.parentObject.dateToInt(n);return i.toString()==="0"&&(a-=1),a<0||a>2958465?this.parent.getErrorStrings()[W.Num]:a.toString()},o.prototype.ComputeEOMONTH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t.length!==2||g(t))return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0]===""||t[1]==="")return this.parent.getErrorStrings()[W.NA];if(t[0].split(this.parent.tic).join("")===""||t[1].split(this.parent.tic).join("")===""||t[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var i,r;if(this.parent.isCellReference(t[0])){if(t[0].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];if(i=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else i=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("");if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(this.parent.isCellReference(t[1])){if(t[1].indexOf(":")>-1)return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""))||"0"}else r=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""));if(this.parent.getErrorStrings().indexOf(r)>-1)return r;r=parseInt(r,10);var n;if(this.parent.isNumber(i)){if(i=parseInt(i,10),i<0||i>2958465)return this.parent.getErrorStrings()[W.Num];n=this.parent.fromOADate(i)}else n=this.parent.checkDateFormat(i);if(isNaN(r)||g(this.parent.isDate(n))||n.getFullYear()>9999)return this.parent.getErrorStrings()[W.Value];n=new Date(n.getFullYear(),n.getMonth()+(r+1),0);var s=this.parent.parentObject.dateToInt(n);return s<0||s>2958465||n.getFullYear()<1900?this.parent.getErrorStrings()[W.Num]:s.toString()},o.prototype.ComputeDATEVALUE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n=this.parent.getErrorStrings();if(t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i=r=this.parent.getValueFromArg(t[0])||"0",n.indexOf(i)>-1)return i;if(this.parent.isCellReference(t[0])){if(t[0].indexOf(":")>-1||i.startsWith(this.parent.tic))return n[W.Value]}else i=t[0].split(this.parent.tic).join("")||"0";if(!(!this.parent.isNumber(i)&&!g(this.parent.isDate(i))))if(!this.parent.isNumber(r)&&this.parent.isDate(r))i=r;else return n[W.Value];var s=this.parent.parseDate(i);return n.indexOf(i)>-1?i:g(s)||s.toString()==="Invalid Date"||s.getFullYear()<1900||s.getFullYear()>9999?this.parent.getErrorStrings()[W.Value]:(i=this.parent.toOADate(s).toString(),parseFloat(i).toFixed(0).toString())},o.prototype.ComputeCOUNTBLANK=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0;if(t.length!==1||g(t)||!this.parent.isCellReference(t[0]))return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0]==="")return this.parent.getErrorStrings()[W.Value];for(var r=this.parent.getCellCollection(t[0]),n=0;n<r.length;n++)this.parent.getValueFromArg(r[n])===""&&i++;return i},o.prototype.ComputeFACT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=1,r=this.parent.getErrorStrings();if(t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=t[0];if(this.parent.isCellReference(t[0])||isNaN(Number(n.split(this.parent.tic).join("")))){if(n=this.parent.getValueFromArg(t[0]),r.indexOf(n)>-1)return n;if(n.startsWith(this.parent.tic)||n.match(/^(\d*\.\d+|\d+)\s*[+\-*/]\s*(\d*\.\d+|\d+)$/))return r[W.Value];if(n==="")return 1}if(n=n.split(this.parent.tic).join("").trim(),r.indexOf(n)>-1)return n;if(n.toUpperCase()===this.parent.trueValue||n.toUpperCase()===this.parent.falseValue)return 1;n.indexOf("%")>-1&&(n=(Number(n.split("%")[0])/100).toString());var s=parseInt(n,10);if(s<0||s>170)return r[W.Num];if(n.toUpperCase().match(/[A-Z]/)||n==="")return r[W.Value];if(n.indexOf(":")>-1)return 0;for(var a=1;a<=s;a++)i=i*a;return i},o.prototype.ComputeDECIMAL=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=/[@#$%^&*()?:{}|<>+-]/g;if(g(t)||t.length!==2)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0].match(r))return this.parent.getErrorStrings()[W.Num];if(t[1].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[1].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[W.Value];var n=void 0,s=void 0;this.parent.isCellReference(t[0].toString())?n=this.parent.getValueFromArg(t[0]):n=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join(""),this.parent.isCellReference(t[1].toString())?s=this.parent.getValueFromArg(t[1]):s=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("");var a=parseInt(n,10),l=parseInt(s,10);return this.parent.getErrorStrings().indexOf(n)>-1?n:this.parent.getErrorStrings().indexOf(s)>-1?s:n===""&&s!==""?0:n===""||a<0||!isNaN(a)&&!Number.isInteger(parseFloat(n))?this.parent.getErrorStrings()[W.Num]:s===""||l<2||l>36||isNaN(l)?this.parent.getErrorStrings()[W.Num]:isNaN(this.parent.parseFloat(n))&&this.parent.parseFloat(s)<=10?this.parent.getErrorStrings()[W.Num]:(i=parseInt(n,parseInt(s,10)),isNaN(i)?this.parent.getErrorStrings()[W.Num]:i)},o.prototype.ComputeDEGREES=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.parent.getErrorStrings();if(g(t)||t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var r=this.parent.getValueFromArg(t[0]).trim();if(i.indexOf(r)>-1)return r;if(this.parent.isCellReference(t[0])){if(r===""||r.indexOf(":")>-1)return 0;if(r.indexOf(this.parent.tic)>-1||isNaN(Number(r))&&!isNaN(parseInt(r,10)))return i[W.Value]}else if(r.indexOf('"TRUE"')>-1)return i[W.Value];if(r=r.split(this.parent.tic).join(""),r.toUpperCase()===this.parent.trueValue)r="1";else if(r.toUpperCase()===this.parent.falseValue)r="0";else if(r.indexOf("%")>-1)r=(Number(r.split("%")[0])/100).toString();else if(r.toUpperCase().match(/[A-Z]/)||isNaN(parseInt(r,10)))return i[W.Value];return parseFloat(r)*(180/Math.PI)},o.prototype.ComputeADDRESS=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length<2||e.length>5)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(e[0].split(this.parent.tic).join("").trim()===""||e[1].split(this.parent.tic).join("").trim()==="")return n[W.Value];var s=function(d){var p=t.parent.getValueFromArg(d).trim();return n.indexOf(p)>0?p:(p.toUpperCase()===t.parent.trueValue?p="1":p.toUpperCase()===t.parent.falseValue&&(p="0"),t.parent.isCellReference(d)&&p.indexOf(t.parent.tic)>-1?n[W.Value]:(p=t.parent.removeTics(p),p.split("%").length===2&&t.parent.isNumber(p.split("%")[0])&&(p=(Number(p.split("%")[0])/100).toString()),p))},a=s(e[0]);if(n.indexOf(a)>0)return a;if(a=Number(a),isNaN(a)||a<1)return n[W.Value];a=a.toString();var l=s(e[1]);if(n.indexOf(l)>0)return l;if(l=Number(l),isNaN(l)||l<1)return n[W.Value];l=l.toString();var h,c;if(g(e[2])||e[2].trim()==="")h="1";else{if(h=s(e[2]),n.indexOf(h)>0)return h;if(h=Number(h),isNaN(h)||h<1||h>4)return n[W.Value];h=h.toString()}if(g(e[3])||e[3].trim()==="")c="1";else{if(c=s(e[3]),n.indexOf(c)>0)return c;c.toUpperCase()===this.parent.trueValue||Number(c)>1?c="1":(c===""||c.toUpperCase()===this.parent.falseValue)&&(c="0")}if(c==="1")h==="1"?r="$"+li(parseInt(l,10))+"$"+parseInt(a,10):h==="2"?r=li(parseInt(l,10))+"$"+parseInt(a,10):h==="3"?r="$"+li(parseInt(l,10))+parseInt(a,10):h==="4"&&(r=li(parseInt(l,10))+parseInt(a,10));else if(c==="0")h==="1"?r="R"+parseInt(a,10)+"C"+parseInt(l,10):h==="2"?r="R"+parseInt(a,10)+"C["+parseInt(l,10)+"]":h==="3"?r="R["+parseInt(a,10)+"]C"+parseInt(l,10):h==="4"&&(r="R["+parseInt(a,10)+"]C["+parseInt(l,10)+"]");else return n[W.Name];var u;return!g(e[4])&&e[4]!==""&&(u=this.parent.getValueFromArg(e[4]).split(this.parent.tic).join(""),n.indexOf(u)>0)?u:(g(u)||(r=u+"!"+r),r)},o.prototype.ComputeTIME=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;if(g(t)||t.length!==3)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t[0].indexOf(this.parent.tic)>-1&&t[0].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(t[1].indexOf(this.parent.tic)>-1&&t[1].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(t[2].indexOf(this.parent.tic)>-1&&t[2].split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];var r,n,s;if(this.parent.isCellReference(t[0])){if(r=this.parent.getValueFromArg(t[0].split(this.parent.tic).join(""))||"0",r.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[0].indexOf(this.parent.tic)>-1&&(t[0].split(this.parent.tic).join("")===this.parent.trueValue||t[0].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];r=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(isNaN(this.parent.parseFloat(r))&&!(r===this.parent.trueValue||r===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(t[1])){if(n=this.parent.getValueFromArg(t[1].split(this.parent.tic).join(""))||"0",n.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[1].indexOf(this.parent.tic)>-1&&(t[1].split(this.parent.tic).join("")===this.parent.trueValue||t[1].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];n=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(n)>-1)return n;if(isNaN(this.parent.parseFloat(n))&&!(n===this.parent.trueValue||n===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(t[2])){if(s=this.parent.getValueFromArg(t[2].split(this.parent.tic).join(""))||"0",s.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(t[2].indexOf(this.parent.tic)>-1&&(t[2].split(this.parent.tic).join("")===this.parent.trueValue||t[2].split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];s=this.parent.getValueFromArg(t[2]).split(this.parent.tic).join("")||"0"}if(this.parent.getErrorStrings().indexOf(s)>-1)return s;if(isNaN(this.parent.parseFloat(s))&&!(s===this.parent.trueValue||s===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];if(r=r===this.parent.trueValue?"1":r===this.parent.falseValue?"0":r,n=n===this.parent.trueValue?"1":n===this.parent.falseValue?"0":n,s=s===this.parent.trueValue?"1":s===this.parent.falseValue?"0":s,r=parseInt(this.parent.parseFloat(r).toString(),10),n=parseInt(this.parent.parseFloat(n).toString(),10),s=parseInt(this.parent.parseFloat(s).toString(),10),isNaN(r)||isNaN(n)||isNaN(s))return this.parent.getErrorStrings()[W.Value];if(r>32767||n>32767||s>32767)return this.parent.getErrorStrings()[W.Num];var a=new Date(1900,0,1,r,n,s);if(a.getFullYear()<1900)return this.parent.getErrorStrings()[W.Num];var l=a.getHours(),h=a.getMinutes(),c=a.getSeconds(),u="AM",d=l;d>=12&&(d=l-12,u="PM"),d===0&&(d=12),h=h<10?"0"+h:h,c=c<10?"0"+c:c,d=d<10?"0"+d:d,i=d+":"+h+":"+c+" "+u;var p={value:i.toString()};return this.parent.parentObject.notify(Jr,p),p.isTime&&(i=p.updatedVal),i},o.prototype.ComputeCHAR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=this.parent.getValueFromArg(t[0]).trim();if(r.indexOf(n)>-1)return n;if(n.indexOf('"TRUE"')>-1||this.parent.isCellReference(t[0])&&n.startsWith(this.parent.tic))return r[W.Value];if(n=n.split(this.parent.tic).join(""),this.parent.isNumber(n)?n=Math.floor(Number(n)).toString():n.indexOf("%")>-1?n=Math.floor(Number(n.split("%")[0])/100).toString():n===this.parent.trueValue&&(n="1"),n.toUpperCase().match(/^[0-9]+$/)){var s=parseInt(n,10);if(s>255||s<=0)return r[W.Value];i=String.fromCharCode(s)}else return r[W.Value];return i},o.prototype.ComputeCODE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i=this.parent.getValueFromArg(t[0]).trim(),r.indexOf(i)>-1)return i;if(t[0].indexOf(this.parent.tic)>-1?t[0]!==i&&t[0].startsWith("n")?i=this.parent.removeTics(i.trim()):i=this.parent.removeTics(t[0].trim()):!t[0].startsWith("n")&&i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i!=="")i=i.charCodeAt(0);else return r[W.Value];return i},o.prototype.ComputeDOLLAR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r,n;if(t.length&&t[t.length-1]==="nestedFormulaTrue"&&(n=!0,t.pop()),t.length===1&&(t[0]===""&&(r=!0),t.push("2")),g(t)||t.length!==2||r)return this.parent.formulaErrorStrings[me.InvalidArguments];for(var s=0;s<t.length;s++)if(t[s].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(t[s])))return this.parent.getErrorStrings()[W.Value];var a=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join(""),l=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("");if(a=a===""||a===this.parent.falseValue?"0":a===this.parent.trueValue?"1":a,l=l===""||l===this.parent.falseValue?"0":l===this.parent.trueValue?"1":l,a==="#NAME?"||l==="#NAME?")return this.parent.getErrorStrings()[W.Name];if(a.toUpperCase().match(/^[-]?[0-9.]+$/)&&l.toUpperCase().match(/^[-]?[0-9.]+$/)){for(var h=new Nt,c=parseInt(l,10),u=Math.pow(10,-1*c),d="",p=1;p<=c;p++)d+="0";var f=Math.round(this.parent.parseFloat(a)/u)*u;isNaN(f)?i=this.parent.getErrorStrings()[W.Value]:i=h.formatNumber(f,{format:"$#,##0."+d+";($#,##0."+d+");$0."+d})}else return this.parent.getErrorStrings()[W.Value];return n&&(i=this.parent.tic+i+this.parent.tic),i},o.prototype.ComputeSMALL=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t.length===1||t[0]==="")return t[0]===""&&t[1]===""?r[W.Num]:this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=[],s=[],a=[];if(!g(t[0])){var l=void 0;if(this.parent.isCellReference(t[0])){n=this.parent.getCellCollection(t[0]);for(var h=0;h<n.length;h++){if(l=this.parent.getValueFromArg(n[h]),r.indexOf(l)>-1)return l;s.push(l)}}else{if(l=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join(""),r.indexOf(l)>-1)return l;s.push(l)}for(var h=0;h<s.length;h++)s[h]!==""&&!isNaN(this.parent.parseFloat(s[h]))&&a.push(this.parent.parseFloat(s[h]));if(a.length===0&&(g(s[0])||t[0].indexOf(this.parent.tic)>-1))return r[W.Value]}a=a.sort(function(d,p){return d-p});var c;if(!g(t[1])){if(this.parent.isCellReference(t[1])){if(c=this.parent.getValueFromArg(t[1]),c==="")return r[W.Num];if(c.trim()==="")return r[W.Value];c.toUpperCase()===this.parent.trueValue?c="1":c.toUpperCase()===this.parent.falseValue&&(c="0")}else c=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("");if(r.indexOf(c)>-1)return c;if(c.trim()==="")return t[1].length>0?r[W.Value]:r[W.Num];if(isNaN(this.parent.parseFloat(c)))if(t[1].toUpperCase()===this.parent.trueValue)c="1";else if(t[1].toUpperCase()===this.parent.falseValue)c="0";else return r[W.Value]}var u=Number(c)<1?0:Math.floor(Number(c));return g(a[u-1])&&!isNaN(Number(u))?r[W.Num]:(i=a[u-1],i)},o.prototype.ComputeLARGE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t.length===1||t[0]==="")return t[0]===""&&t[1]===""?r[W.Num]:this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=[],s=[],a=[];if(!g(t[0])){var l=void 0;if(this.parent.isCellReference(t[0])){n=this.parent.getCellCollection(t[0]);for(var h=0;h<n.length;h++){if(l=this.parent.getValueFromArg(n[h]),r.indexOf(l)>-1)return l;s.push(l)}}else{if(l=this.parent.getValueFromArg(t[0]).split(this.parent.tic).join(""),r.indexOf(l)>-1)return l;s.push(l)}for(var h=0;h<s.length;h++)s[h]!==""&&!isNaN(this.parent.parseFloat(s[h]))&&a.push(this.parent.parseFloat(s[h]));if(a.length===0&&(g(s[0])||t[0].indexOf(this.parent.tic)>-1))return r[W.Value]}a=a.sort(function(d,p){return p-d});var c;if(!g(t[1])){if(this.parent.isCellReference(t[1])){if(c=this.parent.getValueFromArg(t[1]),c==="")return r[W.Num];if(c.trim()==="")return r[W.Value];c.toUpperCase()===this.parent.trueValue?c="1":c.toUpperCase()===this.parent.falseValue&&(c="0")}else c=this.parent.getValueFromArg(t[1]).split(this.parent.tic).join("");if(r.indexOf(c)>-1)return c;if(c.trim()==="")return t[1].length>0?r[W.Value]:r[W.Num];if(isNaN(this.parent.parseFloat(c)))if(t[1].toUpperCase()===this.parent.trueValue)c="1";else if(t[1].toUpperCase()===this.parent.falseValue)c="0";else return r[W.Value]}var u=Number(c)<1?0:Math.ceil(Number(c));return g(a[u-1])&&!isNaN(Number(u))?r[W.Num]:(i=a[u-1],i)},o.prototype.ComputeCHOOSE=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(g(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length<2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var r=this.parent.getErrorStrings(),n=function(a){return a=t.parent.getValueFromArg(a),a.toUpperCase()===t.parent.trueValue?a="1":a.toUpperCase()===t.parent.falseValue&&(a="0"),a},s;if(s=n(e[0]),r.indexOf(s)>-1)return s;if(this.parent.isCellReference(e[0])){if(e[0].indexOf(":")>-1)return r[W.Value]}else s=this.parent.removeTics(s),s.split("%").length===2&&this.parent.isNumber(s.split("%")[0])&&(s=(Number(s.split("%")[0])*.01).toString());return s=Math.floor(this.parent.parseFloat(s)),s<1||isNaN(s)||g(e[s])?r[W.Value]:(s=e[s],s===""&&(s="0"),this.parent.isCellReference(s)?s.indexOf(":")>-1?r[W.Value]:this.parent.getValueFromArg(s):(s.indexOf(this.parent.tic)>-1&&(r.indexOf(s.split(this.parent.tic).join(""))>-1||this.parent.removeTics(s).match(/^(\d*\.\d+|\d+)\s*[-*/]\s*(\d*\.\d+|\d+)$/))&&(s=this.parent.removeTics(s)),s=this.parent.removeTics(this.parent.getValueFromArg(s)),s.indexOf(this.parent.tic+this.parent.tic)>-1?s.replace(/""/g,this.parent.tic):(s.split("%").length===2&&this.parent.isNumber(s.split("%")[0])&&(s=(Number(s.split("%")[0])*.01).toString()),s)))},o.prototype.ComputeSUMIF=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0])||i[2]&&i[2].indexOf(":")<0&&!this.parent.isCellReference(i[2]))return this.parent.formulaErrorStrings[me.ImproperFormula];if(i.length>3||i.length<2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var r=this.parent.computeSumIfAndAvgIf(t,!1);return typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:r[0]},o.prototype.ComputeABS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t,r="",n;if(t.length===0||t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];var s=i[0].split(this.parent.tic).join("").trim();if(s===""||i[0].indexOf(this.parent.tic)>-1&&isNaN(this.parent.parseFloat(s)))return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(i[0])){if(r=this.parent.getValueFromArg(i[0]),this.parent.getErrorStrings().indexOf(r)>-1)return this.parent.getErrorStrings()[W.Value];if(r===this.parent.trueValue&&(r="1"),(r===""||r===this.parent.falseValue)&&(r="0"),n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}else{if(r=this.parent.getValueFromArg(i[0]).split(this.parent.tic).join(),r===this.parent.trueValue&&(r="1"),r===this.parent.falseValue&&(r="0"),this.parent.getErrorStrings().indexOf(r)>-1)return r;if(n=this.parent.parseFloat(r),isNaN(n)&&!this.parent.isNumber(r))return this.parent.getErrorStrings()[W.Value]}return Math.abs(n)},o.prototype.ComputeAVERAGE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;if(t.length){var r=t[t.length-1];r==="isSubtotal"&&(i=!0,t.pop())}if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];for(var n=t,s=0;s<n.length;s++)if(n[s].indexOf(":")>-1&&n[s].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value];return this.parent.calculateAvg(n,i)},o.prototype.ComputeAVERAGEIF=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.formulaErrorStrings[me.ImproperFormula];var r=this.parent.computeSumIfAndAvgIf(t,!0);return r[1]===0||r[0].toString()==="NaN"?this.parent.formulaErrorStrings[me.Div]:typeof r=="string"&&(this.parent.formulaErrorStrings.indexOf(r)||this.parent.getErrorStrings().indexOf(r))?r:this.parent.parseFloat(r[0])/this.parent.parseFloat(r[1])},o.prototype.ComputeCONCATENATE=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];for(var r=t,n="",s="",a=0;a<r.length;a++){var l=r[a];if(this.parent.isCellReference(l)){if(l.indexOf(":")>-1)if(this.isConcat)for(var h=this.parent.getCellCollection(l),c=0;c<h.length;c++){var u=this.parent.getValueFromArg(h[c]);n=n+u}else return i[W.Value];else{if(r.length===1&&r[0].indexOf(this.parent.tic)<0&&!Db(r[0]))return i[W.Name];s=this.parent.getValueFromArg(l)}if(i.indexOf(s)>-1)return s}else if(l.startsWith(this.parent.tic)&&l.endsWith(this.parent.tic)&&l.indexOf('""')>-1?(s=l.substring(1,l.length-1),s=s.replace(/""/g,'"')):(s=l.split(this.parent.tic).join(""),(!(!this.parent.isNumber(s)&&!g(this.parent.isDate(s)))||l.startsWith(" n"))&&(s=this.parent.getValueFromArg(l).split(this.parent.tic).join(""))),i.indexOf(s)>-1)return s;n+=s}return this.isConcat=!1,n},o.prototype.ComputeCONCAT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.isConcat=!0,this.ComputeCONCATENATE.apply(this,t)},o.prototype.ComputeMAX=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parent.computeMinMax(t,"max")},o.prototype.ComputeMIN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.parent.computeMinMax(t,"min")},o.prototype.ComputeRAND=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length===1&&t[0]===""&&(t.length=0),t.length>0?this.parent.formulaErrorStrings[me.WrongNumberArguments]:Math.random().toString()},o.prototype.ComputeAND=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return g(t)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[me.InvalidArguments]:this.parent.computeAndOrNot(i,"and")},o.prototype.ComputeOR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return g(t)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[me.InvalidArguments]:this.parent.computeAndOrNot(i,"or")},o.prototype.ComputeNOT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return g(t)||t.length>1||t[0]===""?this.parent.formulaErrorStrings[me.WrongNumberArguments]:this.parent.computeAndOrNot(i,"not")},o.prototype.ComputeFIND=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(e)||e.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length>3)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var n=function(h){var c=t.parent.getValueFromArg(h);return r.indexOf(c)>-1||t.parent.isCellReference(h)||(c.split("%").length===2&&t.parent.isNumber(c.split("%")[0])?c=(Number(c.split("%")[0])*.01).toString():h.indexOf(t.parent.tic)>-1&&(t.parent.removeTics(h).match(/^(\d*\.\d+|\d+)\s*[-*/]\s*(\d*\.\d+|\d+)$/)?c=t.parent.getValueFromArg(t.parent.removeTics(h)):c.indexOf(t.parent.tic+t.parent.tic)>-1&&(c=c.replace(/""/g,t.parent.tic)))),c},s;if(!g(e[0])){if(s=n(e[0]),r.indexOf(s)>-1)return s;this.parent.isCellReference(e[0])||(s=this.parent.removeTics(s))}var a;if(!g(e[1])){if(a=n(e[1]),r.indexOf(a)>-1)return a;this.parent.isCellReference(e[1])||(a=this.parent.removeTics(a))}var l=1;if(!g(e[2])){if(l=n(e[2]),r.indexOf(l)>-1)return l;if(l.toUpperCase()===this.parent.trueValue?l="1":l.toUpperCase()===this.parent.falseValue&&(l="0"),this.parent.isCellReference(e[2])||(l=this.parent.removeTics(l)),l=this.parent.parseFloat(l),isNaN(l)||l<=0)return r[W.Value]}return l=a.indexOf(s,l-1),l<0?r[W.Value]:(Number(l)+1).toString()},o.prototype.ComputeINDEX=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop()),g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length<2||e.length>4)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(e[0]==="")return s[W.Value];if(e[0].indexOf(":")===-1)return s[W.Ref];if(e[3]&&e[3]==="0")return s[W.Value];var a,l,h,c=function(y){if(g(y)||y==="")return 1;var b=t.parent.getValueFromArg(y);return s.indexOf(b)>-1?b:(b.toUpperCase()===t.parent.trueValue?b="1":b.toUpperCase()===t.parent.falseValue&&(b="0"),b.indexOf(t.parent.tic)>-1&&(b=t.parent.removeTics(b),y.indexOf(t.parent.tic)===-1||b.trim()==="")||(b.split("%").length===2&&t.parent.isNumber(b.split("%")[0])&&(b=(Number(b.split("%")[0])/100).toString()),b=parseInt(Number(b).toString(),10),isNaN(b)||b<0)?s[W.Value]:(b===0&&(b=1),b))};if(e[3]&&(h=c(e[3]),s.indexOf(h.toString())>-1))return h.toString();e[0].startsWith(this.parent.tic)&&e[0].endsWith(this.parent.tic)&&(e[0]=e[0].substring(1,e[0].length-1));var u=e[0].split(this.parent.getParseArgumentSeparator());if(e[0]=u[h?h-1:0],!e[0])return s[W.Ref];if(n=e[0],a=c(e[1]),s.indexOf(a.toString())>-1)return a.toString();if(l=c(e[2]),s.indexOf(l.toString())>-1)return l.toString();var d=n.indexOf(":"),p=this.parent.rowIndex(n.substring(0,d)),f=this.parent.rowIndex(n.substring(d+1)),v=this.parent.colIndex(n.substring(0,d)),m=this.parent.colIndex(n.substring(d+1));return a>f-p+1||l>m-v+1?s[W.Ref]:(a=p+a-1,l=v+l-1,n=this.parent.getValueFromArg(this.getSheetReference(n)+this.parent.convertAlpha(l)+a),n===""?0:r&&s.indexOf(n)===-1&&!this.parent.isNumber(n)&&n!==this.parent.trueValue&&n!==this.parent.falseValue?this.parent.tic+n+this.parent.tic:n)},o.prototype.getSheetReference=function(t){return t.indexOf(this.parent.sheetToken)===0&&t.lastIndexOf(this.parent.sheetToken)>t.indexOf(this.parent.sheetToken)?t.substring(0,t.lastIndexOf(this.parent.sheetToken)+1):""},o.prototype.ComputeIFS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;if(g(t)||i.length===1&&i[0]===""||i.length%2!==0)return this.parent.formulaErrorStrings[me.WrongNumberArguments];for(var r="",n="",s=0;s<i.length;s++){if(r=this.parent.getValueFromArg(i[s]),i[s]==="")return this.parent.getErrorStrings()[W.NA];if(this.parent.getErrorStrings().indexOf(r)>-1)return r;if(r!==this.parent.trueValue&&r!==this.parent.falseValue)return this.parent.getErrorStrings()[W.Value];if(r===this.parent.trueValue)return this.parent.isCellReference(i[s+1].split(this.parent.tic).join(""))||i[s+1].includes(this.parent.arithMarker)?(n=this.parent.getValueFromArg(i[s+1]),n=n===""?"0":n):(n=i[s+1]===""?"0":this.parent.getValueFromArg(i[s+1]),n.indexOf(this.parent.tic)>-1&&(n=n.split(this.parent.tic).join(""))),s=s+1,n;r===this.parent.falseValue&&(s=s+1)}return this.parent.getErrorStrings()[W.NA]},o.prototype.ComputeCOUNTA=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1;if(t.length){var r=t[t.length-1];r==="isSubtotal"&&(i=!0,t.pop())}if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.WrongNumberArguments];for(var n=t,s,a=0,l,h,c=0;c<n.length;c++)if(this.parent.isCellReference(n[c]))if(n[c].indexOf(":")>-1){s=this.parent.getCellCollection(n[c].split(this.parent.tic).join(""));for(var u=0;u<s.length;u++)l=i?this.parent.getValueFromArg(s[u],null,null,!0):this.parent.getValueFromArg(s[u]),!(i&&l.includes("SUBTOTAL("))&&l.length>0&&a++}else{if(l=i?this.parent.getValueFromArg(n[c],null,null,!0):this.parent.getValueFromArg(n[c]),i&&l.includes("SUBTOTAL("))continue;l.length>0&&a++}else h=this.parent.getValueFromArg(n[c]).split(this.parent.tic).join(""),(h.length>0||h.length===0&&h.trim()==="")&&a++;return a},o.prototype.ComputeAVERAGEA=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.WrongNumberArguments];for(var i=t,r,n=0,s,a,l=0,h,c=0;c<i.length;c++)if(this.parent.isCellReference(i[c]))if(i[c].indexOf(":")>-1){r=this.parent.getCellCollection(i[c].split(this.parent.tic).join(""));for(var u=0;u<r.length;u++){if(s=this.parent.getValueFromArg(r[u]),s=this.processLogicalCellValue(s),this.parent.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||s==="")continue;h=this.parent.parseFloat(s),s=isNaN(h)?0:h,n+=s,l=l+1}}else{if(s=this.parent.getValueFromArg(i[c]),s=this.processLogicalCellValue(s),this.parent.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||s==="")continue;h=this.parent.parseFloat(s),s=isNaN(h)?0:h,n+=s,l=l+1}else{if(i[c].indexOf(this.parent.tic)>-1&&(isNaN(this.parent.parseFloat(i[c].split(this.parent.tic).join("")))||i[c].split(this.parent.tic).join("").trim()===""))return this.parent.getErrorStrings()[W.Value];if(i[c]=this.processLogicalCellValue(i[c]),a=this.parent.getValueFromArg(i[c].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(a)>-1)return a;n+=this.parent.parseFloat(a),l=l+1}return l===0?this.parent.getErrorStrings()[W.DivZero]:n/l},o.prototype.processLogicalCellValue=function(t){var e=t;return e.toUpperCase()===this.parent.trueValue?e="1":e.toUpperCase()===this.parent.falseValue&&(e="0"),e},o.prototype.ComputeSORT=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n;e.length&&e[e.length-1]==="nestedFormulaTrue"&&(r=!0,e.pop());var s=e,a,l=[];if(g(e)||e[0]===""||s.length>4)return this.parent.formulaErrorStrings[me.WrongNumberArguments];s[1]=s[1]?s[1]:"1",s[2]=s[2]?s[2]:"1",s[3]=s[3]?s[3]:"FALSE",s[0]=s[0].split("$").join("");var h,c=[];if(s[0].indexOf(":")>-1){var u=s[0].split(":");if(this.parent.isCellReference(u[0])&&this.parent.isCellReference(u[1])){var d=s[0].indexOf(":"),p=void 0,f=this.parent.rowIndex(this.parent.substring(s[0],0,d)),v=this.parent.colIndex(this.parent.substring(s[0],0,d)),m=this.parent.rowIndex(this.parent.substring(s[0],d+1,d+s[0].length-d-1)),y=this.parent.colIndex(this.parent.substring(s[0],d+1,d+s[0].length-d-1));if(f>m&&(p=m,m=f,f=p),v>y&&(p=y,y=v,v=p),this.parent.isCellReference(s[3])){if(s[3]=this.parent.getValueFromArg(s[3]).toUpperCase(),s[3]!==this.parent.trueValue&&s[3]!==this.parent.falseValue)if(De(s[3]))s[3]=Number(s[3])===0?this.parent.falseValue:this.parent.trueValue;else if(s[3]==="")s[3]=this.parent.falseValue;else return this.parent.getErrorStrings()[W.Value]}else if(n=s[3].startsWith(this.parent.tic)&&s[3].endsWith(this.parent.tic),s[3]=this.parent.getValueFromArg(s[3]),s[3]=De(s[3])?Number(s[3])===0?this.parent.falseValue:this.parent.trueValue:s[3].split(this.parent.tic).join("").toUpperCase(),s[3]!==this.parent.trueValue&&s[3]!==this.parent.falseValue)return this.parent.getErrorStrings()[n?W.Value:W.Name];if(this.parent.isCellReference(s[2])?(s[2]=this.parent.getValueFromArg(s[2]),s[2]=s[2]===this.parent.trueValue?"1":s[2]):(s[2]=this.parent.getValueFromArg(s[2]),s[2]=s[2]===this.parent.trueValue?"1":s[2].split(this.parent.tic).join("")),s[2]=De(s[2])?Math.floor(Number(s[2])).toString():s[2],s[2]!=="1"&&s[2]!=="-1")return this.parent.getErrorStrings().indexOf(s[2])>-1?this.parent.getErrorStrings()[W.Name]:this.parent.getErrorStrings()[W.Value];var b=s[2]==="1"?"Ascending":"Descending";if(this.parent.isCellReference(s[1])){if(s[1]=this.parent.getValueFromArg(s[1]),s[1]=De(s[1])?Math.floor(Number(s[1])).toString():s[1]===this.parent.trueValue?"1":s[1]===this.parent.falseValue?"0":s[1],isNaN(this.parseDouble(s[1]))||this.parseDouble(s[1])<1||(s[3]===this.parent.trueValue?m-f+1<this.parseDouble(s[1]):y-v+1<this.parseDouble(s[1])))return this.parent.getErrorStrings()[W.Value]}else if(n=s[1].startsWith(this.parent.tic)&&s[1].endsWith(this.parent.tic),s[1]=this.parent.getValueFromArg(s[1]),s[1]=De(s[1])?Math.floor(Number(s[1])).toString():s[1]===this.parent.trueValue?"1":s[1]===this.parent.falseValue?"0":s[1].split(this.parent.tic).join(""),isNaN(this.parseDouble(s[1]))?n:this.parseDouble(s[1])<1||(s[3]===this.parent.trueValue?m-f+1<this.parseDouble(s[1]):y-v+1<this.parseDouble(s[1])))return this.parent.getErrorStrings()[W.Value];var S="";s[0].indexOf("!")===0&&(S=s[0],S=S.replace("!",""),S=S.indexOf("!"),S=s[0].substring(0,S+2)),s[0]=S+li(v)+f+":"+li(y)+m,h=this.parent.getCellCollection(s[0]);for(var C=0;C<h.length;C++)c.push(this.parent.getValueFromArg(h[C]));var x=[],I=[],D=[],M=[],E=[],A=y-v+1,L=function(ne){ne?ne.toUpperCase()==="TRUE"||ne.toUpperCase()==="FALSE"?(M.push(ne),x.push(ne)):isNaN(t.parseDouble(ne))?(D.push(ne),x.push(ne)):(I.push(t.parseDouble(ne)),x.push(t.parseDouble(ne))):ne===""&&(E.push(t.parseDouble(ne).toString()),x.push(t.parseDouble(ne).toString()))};if(s[3]==="TRUE")for(var C=0;C<A;C++)L(c[C+(this.parseDouble(s[1])-1)*A]);if(s[3]==="FALSE")for(var C=0;C<c.length;C++)L(c[C*A+this.parseDouble(s[1])-1]);for(var N=I.length>0?ge.sort(I,null,ge.fnSort(b)):[],R=D.length>0?ge.sort(D,null,ge.fnSort(b)):[],P=M.length>0?ge.sort(M,null,ge.fnSort(b)):[],k=b==="Ascending"?N.concat(R,P,E):P.concat(R,N,E),B=[],F=0;F<k.length;F++)for(var O=0;O<x.length;O++)JSON.stringify(k[F])===JSON.stringify(x[O])&&B.indexOf(O)===-1&&B.push(O);if(s[3]==="TRUE"){for(var z=f,Y=0;z<=m;z++,Y++)for(var F=0,K=0;F<B.length;F++,K++){var U=this.parent.getValueFromArg(S+li(B[F]+v)+z);if(r&&U!==""){l.push(U);continue}U=U===""?"0":U;var q=this.parent.cell;if(q){q=q.indexOf("!")>-1?q.substring(q.lastIndexOf("!")+1):q;var ae=this.parent.rowIndex(q),te=this.parent.colIndex(q);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,U,ae+Y,te+K)}}a=this.parent.getValueFromArg(S+li(B[0]+v)+f)}if(s[3]==="FALSE"){for(var F=0,Y=0;F<B.length;F++,Y++)for(var he=v,K=0;he<=y;he++,K++){var ue=this.parent.getValueFromArg(S+li(he)+(B[F]+f));if(r&&ue!==""){l.push(ue);continue}ue=ue===""?"0":ue;var q=this.parent.cell;if(q){q=q.indexOf("!")>-1?q.substring(q.lastIndexOf("!")+1):q;var te=this.parent.colIndex(q),ae=this.parent.rowIndex(q);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,ue,ae+Y,te+K)}}a=this.parent.getValueFromArg(S+li(v)+(B[0]+f))}}}return r?l.join(","):a===""?"0":a},o.prototype.ComputeCOUNTIF=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;if(g(t)||t[0]===""||i.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i[0].indexOf(":")<0&&!this.parent.isCellReference(i[0]))return this.parent.getErrorStrings()[W.Name];var r,n=0,s,a=[],l="equal";if(i[1]==="")return 0;var h=i[1].startsWith(this.parent.tic)&&i[1].endsWith(this.parent.tic),c=this.parent.getANDComputedValue(i[1]),u=c.includes("*"),d=c==="*"||c==="<>*",p=u&&!d?c.replace(/\*/g,"").trim():c,f=!1;if(!h&&this.parent.isCellReference(p)&&(p=this.parent.getValueFromArg(p),f=!0),u&&!d){var v=c.indexOf("*");c[0]==="*"&&(p="*"+p),c[c.length-1]==="*"&&(p+="*"),v>0&&v<c.length-1&&(p=c.substring(0,v)+"*"+c.substring(v+1))}c=p,c.startsWith("<=")?(l="lessEq",c=c.substring(2)):c.startsWith(">=")?(l="greaterEq",c=c.substring(2)):c.startsWith("<>")?(l="notEq",c=c.substring(2)):c.startsWith("<")?(l="less",c=c.substring(1)):c.startsWith(">")?(l="greater",c=c.substring(1)):c.startsWith("=")&&(l="equal",c=c.substring(1));var m=c.indexOf("*")>-1||c.indexOf("?")>-1;if((!h&&this.parent.isCellReference(c)&&!f||c.includes(this.parent.arithMarker)||c.includes(this.parent.getParseDecimalSeparator())&&!m)&&(c=this.parent.getValueFromArg(c)),i[0].indexOf(":")>-1&&this.parent.isCellReference(i[0])){r=this.parent.getCellCollection(i[0].split(this.parent.tic).join(""));for(var y=0;y<r.length;y++)s=this.parent.getValueFromArg(r[y]),m&&(s=this.parent.findWildCardValue(c.toLowerCase(),s.toLowerCase())),a.push(s),a.push(c),this.parent.processLogical(a,l)===this.parent.trueValue&&n++}return n},o.prototype.ComputeSUMIFS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.calculateIFS(t);return i},o.prototype.calculateIFS=function(t,e){var i=this;if(g(t)||t[0]===""||t.length<2||t.length>127)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(t.length===3&&t[2].includes(this.parent.tic+this.parent.tic)){var r="",n,s=this.parent.getParseArgumentSeparator(),a=t[2].split(this.parent.tic+this.parent.tic);return a.forEach(function(l){l=l.trim().split(i.parent.tic).join(""),l&&(n=i.parent.computeIfsFormulas([t[0],t[1],l],i.parent.falseValue,e).toString(),r+=(r?s:"")+n)}),r}return this.parent.computeIfsFormulas(t,this.parent.falseValue,e)},o.prototype.ComputeTEXT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i;t.length&&t[t.length-1]==="nestedFormulaTrue"&&(i=!0,t.pop());var r=t.length,n=t[0],s=t[1];if(r!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var a=n,l=s;if(s==="")return this.parent.getValueFromArg(a);var h=new Date(1900,0,1,0,0,0),c=a+","+l,u=new Nt;if(this.parent.getErrorStrings().indexOf(c)>-1)return c;if(a=this.parent.getValueFromArg(a),De(a.split(this.parent.tic).join(""))&&(a=a.split(this.parent.tic).join("")),s.startsWith('"')&&s.endsWith('"')?l=l.split(this.parent.tic).join(""):l=this.parent.getValueFromArg(l),l==="")return"";a===""&&(l.length>0&&(l.toUpperCase().indexOf("M")>-1||l.toUpperCase().indexOf("D")>-1||l.toUpperCase().indexOf("Y")>-1||l.toUpperCase().indexOf("S")>-1||l.toUpperCase().indexOf("T")>-1)||l.toUpperCase().indexOf("H")>-1)&&(a=h.toString());var d=this.parseDouble(a);if(isNaN(d)&&this.parent.isDate(new Date(a))!==null&&(d=this.parent.toOADate(new Date(a))),h=Date.parse(a.split(this.parent.tic).join("")),!isNaN(d)||!isNaN(h))if(l.length>0&&l.indexOf("#")===-1&&(l.toUpperCase().indexOf("M")>-1||l.toUpperCase().indexOf("D")>-1||l.toUpperCase().indexOf("Y")>-1||l.toUpperCase().indexOf("S")>-1||l.toUpperCase().indexOf("T")>-1)||l.toUpperCase().indexOf("H")>-1){l=l.split("Y").join("y").split("D").join("d").split("H").join("h"),l=l.split("S").join("s").split("m").join("M").split("AM/PM").join("tt");var p=l.split(""),f=!1,v=!1,m=0,y=0;for(m=0;m<p.length;){var b=p[m];b==="s"&&p[y]==="M"&&(p[y]="m",p[y-1]==="M"&&(p[y-1]="m")),this.parent.isChar(b)&&(y=m),b==="M"&&f&&(p[m]="m",v=!0),b==="h"?f=!0:this.parent.isChar(b)&&b!=="M"&&b!=="h"&&!v&&(f=!1,v=!1),m++}l=String(p),l=l.split(",").join("").split(`
`).join(" ");var S=this.parent.fromOADate(d);d===0&&(S=h);var C=s9(l);if(C===""){var x=ls(S),I=this.parent.parentObject.getDisplayText({format:l,value:x});return I}var D=u.getDateFormat({skeleton:C,type:"date"}),M=D(new Date(S.toString()));a=M}else a=this.parent.parentObject.getDisplayText({format:l,value:d});return i?this.parent.tic+a+this.parent.tic:a},o.prototype.ComputeCOUNTIFS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.parent.computeCountIfsFormulas(t);return i},o.prototype.ComputeAVERAGEIFS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.calculateIFS(t,this.parent.trueValue);return i},o.prototype.ComputeMATCH=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=e.slice(),n=this.parent.getErrorStrings();if(g(r)||r.length===1&&r[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(r.length<2||r.length>3)return this.parent.formulaErrorStrings[me.WrongNumberArguments];r[0]=this.parent.getValueFromArg(e[0]);var s=r[0].indexOf(this.parent.tic)>-1;if(r[0]=r[0].split(this.parent.tic).join(""),n.indexOf(r[0])>-1)return r[0];if(r[0]==="")return n[W.NA];isNaN(Number(r[0]))&&(s=!0);var a;if(g(e[2]))r[2]="1";else{if(r[2]=this.parent.getValueFromArg(r[2]),r[2].indexOf(this.parent.tic)>-1&&isNaN(Number(r[2].split(this.parent.tic).join(""))))return n[W.Value];r[2].toUpperCase()===this.parent.trueValue?r[2]="1":r[2].toUpperCase()===this.parent.falseValue&&(r[2]="0")}a=parseFloat(r[2]),[-1,0,1].indexOf(a)===-1&&(a=0);var l=[],h,c=!1;if(r[1].indexOf(":")>-1||this.parent.isCellReference(r[1])){if(h=this.parent.getCellCollection(r[1]),h[0]==="#REF!")return this.parent.getErrorStrings()[W.Name];for(var u=0;u<h.length;u++){var d=this.parent.getValueFromArg(h[u]);(d.indexOf(this.parent.tic)>-1||isNaN(Number(d)))&&(c=!0),l[u]=d.split(this.parent.tic).join("")}if(s&&!c||!s&&c)return n[W.NA]}else if(!g(r[1])&&r[1].includes(this.parent.tic+this.parent.tic)){var p=r[1].split(this.parent.tic+this.parent.tic);p.forEach(function(C){C=C.trim().split(t.parent.tic).join(""),C&&l.push(C)})}for(var f=0,v="",m=!1,y=isNaN(Number(r[0]))?r[0]:Number(r[0]),b=0;b<l.length;b++){if(l[b]===""){b===l.length-1&&l.pop();continue}else if(a===-1&&(s||c))break;var S=isNaN(Number(l[b]))?l[b]:Number(l[b]);if(a===1)y===S?(f=b+1,m=!0,isNaN(Number(r[0]))&&(s=!1)):y>S&&!s&&!m&&(!v||S>(isNaN(Number(v))?v:Number(v)))&&(f=b+1,v=l[b]);else if(a===0){if((r[0].indexOf("*")>-1||r[0].indexOf("?")>-1)&&(l[b]=this.parent.findWildCardValue(r[0],l[b])),r[0]===l[b])return b+1}else if(a===-1)if(Number(l[b])>Number(l[b+1])||b===l.length-1)y===S?(f=b+1,y=void 0):y<S&&(!v||S<(isNaN(Number(v))?v:Number(v)))&&(f=b+1,v=l[b]);else return n[W.NA]}return s&&c&&a===1?l.length:f||n[W.NA]},o.prototype.ComputeLOOKUP=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return g(i)||i.length===1&&i[0]===""?this.parent.formulaErrorStrings[me.WrongNumberArguments]:this.parent.computeLookup(i)},o.prototype.ComputeVLOOKUP=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return this.parent.computeVHLookup(i,!0)},o.prototype.ComputeHLOOKUP=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;return this.parent.computeVHLookup(i)},o.prototype.ComputeSUBTOTAL=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length<2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i=this.parent.getValueFromArg(t[0]).trim(),r.indexOf(i)>-1)return i;if(i.split(this.parent.tic).join("").trim()===""||(this.parent.isCellReference(t[0])||(i=this.parent.removeTics(i)),i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue?i="0":i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=this.parent.parseFloat(i),isNaN(i)||(1>i||i>11)&&(101>i||i>111)))return r[W.Value];var n=t.slice(1,t.length);switch(i){case 1:case 101:i=this.ComputeAVERAGE.apply(this,n.concat(["isSubtotal"]));break;case 2:case 102:i=this.ComputeCOUNT.apply(this,n.concat(["isSubtotal"]));break;case 3:case 103:i=this.ComputeCOUNTA.apply(this,n.concat(["isSubtotal"]));break;case 4:case 104:i=this.ComputeMAX.apply(this,n.concat(["isSubtotal"]));break;case 5:case 105:i=this.ComputeMIN.apply(this,n.concat(["isSubtotal"]));break;case 6:case 106:i=this.ComputePRODUCT.apply(this,n.concat(["isSubtotal"]));break;case 7:case 107:i=this.ComputeDAY.apply(this,n);break;case 8:case 108:i=this.ComputeCONCAT.apply(this,n);break;case 9:case 109:i=this.ComputeSUM.apply(this,n.concat(["isSubtotal"]));break;case 10:case 110:i=this.ComputeAVERAGEA.apply(this,n);break;case 11:case 111:i=this.ComputeABS.apply(this,n);break;default:i=r[W.Value];break}return i},o.prototype.ComputeRADIANS=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(g(t)||t[0]===""&&t.length===1||t[0].split("!").length===2&&t[0].indexOf(this.parent.tic)===-1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length>1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(t[0].indexOf(":")>-1||t[0].split(this.parent.tic).join("").trim()===""||t[0].split(this.parent.tic).join("").trim()==="!"||t[0].split("!").length===2)return r[W.Value];if(i=this.parent.getValueFromArg(t[0]).trim(),r.indexOf(i)>-1)return i;if(i.indexOf(this.parent.tic)>-1&&t[0].indexOf(this.parent.tic)===-1||i.split(this.parent.tic).length>3)return r[W.Value];if(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue?i="0":i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])/100).toString()),i=this.parent.parseFloat(i.split(this.parent.tic).join("")),!isNaN(i))i=Math.PI*i/180;else return this.parent.isCellReference(t[0])||t[0].indexOf(this.parent.tic)>-1?r[W.Value]:r[W.Name];return i},o.prototype.ComputeRANDBETWEEN=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n;if(e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var s=this.parent.getErrorStrings(),a=function(l){var h;if(h=t.parent.getValueFromArg(l),s.indexOf(h)>-1)return h;if(t.parent.isCellReference(l)){if(h==="")h="0";else if(l.indexOf(":")>-1||h.match(/^(\d*\.\d+|\d+)\s*[+\-*/]\s*(\d*\.\d+|\d+)$/))return s[W.Value]}else{if(h==="")return s[W.NA];if(l.indexOf(t.parent.tic)>-1&&t.parent.removeTics(l).match(/^(\d*\.\d+|\d+)\s*[+*]\s*(\d*\.\d+|\d+)$/))return s[W.Value];if(h.indexOf(t.parent.tic)>-1&&(h=t.parent.removeTics(h),h.indexOf(":")>-1)){var c=h.split(":");if(c.length<=3){if(!t.parent.isNumber(c[0])||!t.parent.isNumber(c[1]))return s[W.Value];var u=Number(c[0])+Number(Number(c[1])/60);if(c.length===3){if(!t.parent.isNumber(c[2]))return s[W.Value];u+=Number(Number(c[2])/3600)}h=(u/24).toString()}else return s[W.Value]}h.split("%").length===2&&t.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h=parseFloat(h),isNaN(h)?s[W.Value]:h};return n=a(e[1]),s.indexOf(n)>-1?n:(r=a(e[0]),s.indexOf(r)>-1?r:r===0&&n===0?"0":n<r?s[W.Num]:(r=Math.ceil(r),n=Math.floor(n),Math.floor(Math.random()*(n-r+1)+r)))},o.prototype.ComputeSLOPE=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(e[0]===""||e[1]==="")return r[W.Value];var n=function(y){return y.indexOf(t.parent.tic)===-1?y=t.parent.getCellCollection(y.split(t.parent.tic).join("")):y=void 0,y},s=n(e[0].trim()),a=n(e[1].trim());if(g(s)||g(a)||s.length<2&&a.length<2)return r[W.DivZero];if(s.length!==a.length)return r[W.NA];var l=function(y){y=t.getDataCollection(y);for(var b=0;b<y.length;b++)if(r.indexOf(y[b])>-1)return y[b].toString();return y};if(s=l(s),r.indexOf(s.toString())>-1)return s.toString();if(a=l(a),r.indexOf(a.toString())>-1)return a.toString();for(var h=0,c=0,u=0,d=0,p=0,f=0,v=a.length;f<v;++f)a[f]!==""&&Number(a[f]).toString()!=="NaN"&&s[f]!==""&&Number(s[f]).toString()!=="NaN"&&(h+=Number(a[f])*Number(s[f]),u+=Number(a[f]),d+=Number(s[f]),c+=Number(a[f])*Number(a[f]),p++);var m=((h-u*d/p)/(c-u*u/p)).toString();return m==="NaN"?r[W.DivZero]:m},o.prototype.ComputeINTERCEPT=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(e[0]===""||e[1]==="")return r[W.Value];var n=function(y){return y.indexOf(t.parent.tic)===-1?y=t.parent.getCellCollection(y.split(t.parent.tic).join("")):y=void 0,y},s=n(e[0].trim()),a=n(e[1].trim());if(g(s)||g(a)||s.length<2&&a.length<2)return r[W.DivZero];if(s.length!==a.length)return r[W.NA];var l=function(y){y=t.getDataCollection(y);for(var b=0;b<y.length;b++)if(r.indexOf(y[b])>-1)return y[b];return y};if(s=l(s),r.indexOf(s.toString())>-1)return s.toString();if(a=l(a),r.indexOf(a.toString())>-1)return a.toString();var h=0,c=0,u=0,d=0,p=0,f,v=function(y){for(var b=0,S=a.length;b<S;++b)s[b]!==""&&Number(s[b]).toString()!=="NaN"&&a[b]!==""&&Number(a[b]).toString()!=="NaN"&&(y?(h+=Number(s[b]),c+=Number(a[b]),u++):(f=Number(a[b])-c,d+=f*(Number(s[b])-h),p+=f*f))};v(!0),h=h/u,c=c/u,v(!1);var m=(h-d/p*c).toString();return m==="NaN"?r[W.DivZero]:m},o.prototype.ComputeLN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();return g(t)||t[0]===""&&t.length===1?this.parent.formulaErrorStrings[me.InvalidArguments]:t.length===0||t.length>1?this.parent.formulaErrorStrings[me.WrongNumberArguments]:(i=this.parent.getValueFromArg(t[0]),r.indexOf(i)>-1?i:(i.toUpperCase()===this.parent.trueValue?i="1":i.toUpperCase()===this.parent.falseValue&&(i="0"),!this.parent.isCellReference(t[0])&&(i=this.parent.removeTics(i),i.trim()==="")?r[W.Value]:(i.split("%").length===2&&this.parent.isNumber(i.split("%")[0])&&(i=(Number(i.split("%")[0])*.01).toString()),i=this.parent.parseFloat(i),i<=0?r[W.Num]:isNaN(i)?r[W.Value]:Math.log(i))))},o.prototype.ComputeISNUMBER=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t;if(t.length===1&&t[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var r=this.parent.isCellReference(i[0])?this.parent.getValueFromArg(i[0]):this.parent.getValueFromArg(i[0].split(this.parent.tic).join(""));if(r.toString()===""||t.toString().startsWith(this.parent.tic))return!1;var n=this.parent.parseFloat(r);return!isNaN(n)},o.prototype.ComputeROUND=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!t.length||t.length===1||t.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var i=t;if(t.length===1){var r=i[0].split(this.parent.tic).join("")==="TRUE"?"1":i[0].split(this.parent.tic).join("")==="FALSE"?"0":i[0];return isNaN(this.parent.parseFloat(r))?this.parent.formulaErrorStrings[me.InvalidArguments]:Math.round(this.parent.parseFloat(r)).toString()}var n=this.parent.getValueFromArg(i[0]);if(this.parent.getErrorStrings().indexOf(n)>-1)return n;var s=this.parent.getValueFromArg(i[1]);if(this.parent.getErrorStrings().indexOf(s)>-1)return s;n=n==="TRUE"?"1":n==="FALSE"?"0":n,s=s==="TRUE"?"1":s==="FALSE"?"0":s,n=n.split(this.parent.tic).join(""),s=s.split(this.parent.tic).join("");var a=isNaN(Number(n))||n.trim()==="",l=isNaN(Number(s))||s.trim()==="";if((i[0].indexOf('"')>-1||this.parent.isCellReference(i[0]))&&a||(i[1].indexOf('"')>-1||this.parent.isCellReference(i[1]))&&l)return this.parent.getErrorStrings()[W.Value];if(n===""&&s===""||n==="")return 0;var h=this.parent.parseFloat(n),c=this.parent.parseFloat(s),u;if(!isNaN(c)&&!isNaN(h)&&c>0)u=this.parent.parseFloat(this.preciseRound(h,c,"ROUND"));else{var d=Math.pow(10,-c);u=Math.round(h/d)*d}return u.toString()},o.prototype.preciseRound=function(t,e,i){var r=Math.pow(10,e),n=Math.abs(t)*r,s=t>=0?1:-1,a=i==="ROUND"?Math.round(n):i==="ROUNDDOWN"?Math.floor(n):Math.ceil(n);return(s*(a/r)).toFixed(e)},o.prototype.ComputePOWER=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0].trim()==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(e[0].trim()===""&&e[1].trim()==="")return n[W.Num];var s=function(h){var c=t.parent.getValueFromArg(h);if(n.indexOf(c)>-1)return c;if(c.toUpperCase()===t.parent.trueValue?c="1":c.toUpperCase()===t.parent.falseValue&&(c="0"),c.indexOf(t.parent.tic)>-1&&(c=t.parent.removeTics(c),h.indexOf(t.parent.tic)===-1||c.trim()===""))return n[W.Value];if(c.split("%").length===2&&t.parent.isNumber(c.split("%")[0]))c=(Number(c.split("%")[0])/100).toString();else if(c.indexOf("/")>-1&&t.parent.isNumber(c.split("/").join("")))return n[W.Num];return c=t.parent.parseFloat(c),isNaN(c)?n[W.Value]:c},a=s(e[0]);if(n.indexOf(a)>-1)return a;var l=s(e[1]);if(n.indexOf(l)>-1)return l;if(!isNaN(a)&&!isNaN(l)){if(a===0&&l<0)return n[W.DivZero];if(a===0&&l===0||(r=Math.pow(a,l),isNaN(r)||r===1/0))return n[W.Num]}else return n[W.Value];return r.toString()},o.prototype.ComputeSQRT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=t[0];if(t.length===0||t.length>1||r==="")return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(r.split(this.parent.tic).join("").trim()==="")return this.parent.getErrorStrings()[W.Value];if(this.parent.isCellReference(r)){if(i=this.parent.getValueFromArg(r)||"0",i.indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[W.Value]}else{if(r.indexOf(this.parent.tic)>-1&&(r.split(this.parent.tic).join("")===this.parent.trueValue||r.split(this.parent.tic).join("")===this.parent.falseValue))return this.parent.getErrorStrings()[W.Value];i=this.parent.getValueFromArg(r).split(this.parent.tic).join("")}if(this.parent.getErrorStrings().indexOf(i)>-1)return i;if(i=i===this.parent.trueValue?"1":i===this.parent.falseValue?"0":i,this.parent.parseFloat(i)<0)return this.parent.getErrorStrings()[W.Num];if(isNaN(this.parent.parseFloat(i))){var n={value:i};if(this.parent.parentObject.notify(Jr,n),n.isDate||n.isTime)i=n.updatedVal;else return this.parent.getErrorStrings()[W.Value]}return Math.sqrt(this.parent.parseFloat(i))},o.prototype.ComputeLOG=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n,s=this.parent.getErrorStrings();if(g(e)||e.length===1&&e[0]==="")return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var a=function(l){var h=t.parent.getValueFromArg(l);if(h===t.parent.trueValue?h="1":h===t.parent.falseValue&&(h="0"),!t.parent.isCellReference(l)&&h!==""){if(h.indexOf(t.parent.tic)>-1&&s.indexOf(h.split(t.parent.tic).join(""))===-1){if(h=t.parent.removeTics(h),h.trim()==="")return s[W.Value];if(h.indexOf(":")>-1){var c=h.split(":");if(c.length<=3){if(!t.parent.isNumber(c[0])||!t.parent.isNumber(c[1]))return s[W.Value];var u=Number(c[0])+Number(Number(c[1])/60);if(c.length===3){if(!t.parent.isNumber(c[2]))return s[W.Value];u+=Number(Number(c[2])/3600)}h=(u/24).toString()}else return s[W.Value]}}h.split("%").length===2&&t.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h};if(!g(e[0])){if(r=a(e[0]),s.indexOf(r)>-1)return r;r=this.parent.parseFloat(r)}if(n=10,!g(e[1])){if(n=a(e[1]),s.indexOf(n)>-1)return n;n=this.parent.parseFloat(n)}return r=Number(r),isNaN(r)||isNaN(n)?s[W.Value]:r<=0||n<=0?s[W.Num]:n===1?s[W.DivZero]:(Math.log(r)/Math.LN10/(Math.log(n)/Math.LN10)).toString()},o.prototype.ComputeTRUNC=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r,n=0,s=this.parent.getErrorStrings();if(g(e)||e[0]===""&&e.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(e.length===0||e.length>2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];var a=function(l){var h=t.parent.getValueFromArg(l);if(s.indexOf(h)>-1)return h;if(h===t.parent.trueValue)h="1";else if(h===t.parent.falseValue)h="0";else if(!t.parent.isCellReference(l)){if(l.indexOf(t.parent.tic)>-1&&t.parent.removeTics(l).match(/^(\d*\.\d+|\d+)\s*[*]\s*(\d*\.\d+|\d+)$/))h=t.parent.getValueFromArg(t.parent.removeTics(l));else if(h.indexOf(t.parent.tic)>-1){if(h=t.parent.removeTics(h),h.trim()==="")return s[W.Value];if(h.indexOf(":")>-1){var c=h.split(":");if(c.length<=3){if(!t.parent.isNumber(c[0])||!t.parent.isNumber(c[1]))return s[W.Value];var u=Number(c[0])+Number(Number(c[1])/60);if(c.length===3){if(!t.parent.isNumber(c[2]))return s[W.Value];u+=Number(Number(c[2])/3600)}h=(u/24).toString()}else return s[W.Value]}}h.split("%").length===2&&t.parent.isNumber(h.split("%")[0])&&(h=(Number(h.split("%")[0])*.01).toString())}return h};if(!g(e[0])){if(r=a(e[0]),s.indexOf(r)>-1)return r;if(r=this.parent.parseFloat(r),isNaN(r))return s[W.Value]}if(!g(e[1])){if(n=a(e[1]),s.indexOf(n)>-1)return n;if(n=this.parent.parseFloat(n),isNaN(n))return s[W.Value]}return n=Math.pow(10,Math.floor(n)),r=Number(r),((r<0?-1:1)*Math.floor(n*Math.abs(r))/n).toString()},o.prototype.ComputeEXP=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=this.parent.getErrorStrings();if(t[0]===""&&t.length===1)return this.parent.formulaErrorStrings[me.InvalidArguments];if(t.length!==1)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(t[0].split(this.parent.tic).join("").trim()==="")return r[W.Value];if(i=this.parent.getValueFromArg(t[0]),r.indexOf(i)>-1)return i;if(i.indexOf(this.parent.tic)>-1&&(this.parent.isCellReference(t[0])||isNaN(Number(i.split(this.parent.tic).join("")))))return r[W.Value];if(i=i.split(this.parent.tic).join(""),i===this.parent.trueValue)i="1";else if(i===this.parent.falseValue||i==="")i="0";else if(i.indexOf("%")>-1)i=(Number(i.split("%")[0])/100).toString();else if(i.indexOf(":")>-1)return"0";var n=this.parent.parseFloat(i);return isNaN(n)?r[W.Value]:n>709?r[W.Num]:Math.exp(n).toString()},o.prototype.ComputeGEOMEAN=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t,r=1,n=0,s=0,a=0,l,h,c,u;if(t.length===0)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(i.length===1&&i[0]==="")return r.toString();var d;for(h=0;h<i.length;h++)if(i[h].indexOf(":")>-1){if(i[0]===this.parent.tic)return this.parent.getErrorStrings()[W.Value];for(u=this.parent.getCellCollection(i[h].split(this.parent.tic).join("")),c=0;c<u.length;c++){if(s=this.parent.getValueFromArg(u[c]),a=s.split(this.parent.tic).join(""),d=a===this.parent.trueValue||a===this.parent.falseValue,l=this.parent.parseFloat(s),l<=0)return this.parent.getErrorStrings()[W.Num];d||this.parent.getErrorStrings().indexOf(s)>-1||isNaN(l)||(n++,r=r*l)}}else{if(s=this.parent.getValueFromArg(i[h]),this.parent.getErrorStrings().indexOf(s)>-1)return s;var p=s.split(this.parent.tic).join("");if(s.indexOf('"')>-1&&isNaN(this.parent.parseFloat(p)))return this.parent.getErrorStrings()[W.Value];if(i[h]=i[h].startsWith("n")?i[h].slice(1):i[h],s===""&&i[h]==="")return this.parent.getErrorStrings()[W.Num];if((p==="TRUE"||p==="FALSE")&&this.parent.isCellReference(i[h]))continue;if(s.length>0){if(s=s.indexOf('"')>-1?p:s,s=s.split(this.parent.tic).join("")==="TRUE"?"1":s.split(this.parent.tic).join("")==="FALSE"?"0":s,!this.parent.isCellReference(i[h])&&isNaN(this.parent.parseFloat(s)))return this.parent.getErrorStrings()[W.Value];if(l=this.parent.parseFloat(s),l<=0)return this.parent.getErrorStrings()[W.Num];isNaN(l)||(n++,r=r*l)}}return n>0&&(r=Math.pow(r,1/n)),r.toString()},o.prototype.ComputeRSQ=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0,r=t;if(r.length!==2)return this.parent.formulaErrorStrings[me.WrongNumberArguments];if(r[0]===""||r[1]==="")return this.parent.getErrorStrings()[W.Value];if(r[0].includes('"')||r[1].includes('"'))return this.parent.getErrorStrings()[W.NA];if(r[0].indexOf(":")===-1&&Or(r[0])&&r[1].indexOf(":")===-1&&Or(r[1]))return this.parent.getErrorStrings()[W.DivZero];var n=this.parent.getCellCollection(r[0]),s=this.parent.getCellCollection(r[1]);if(n.length!==s.length)return this.parent.getErrorStrings()[W.NA];for(var a=this.getDataCollection(s),l=0;l<a.length;l++)if(this.parent.getErrorStrings().indexOf(a[l])>-1)return a[l];for(var h=this.getDataCollection(n),c=0;c<h.length;c++)if(this.parent.getErrorStrings().indexOf(h[c])>-1)return h[c];for(var u,d,p=0;p<a.length;p++)u=Number(a[p]),d=Number(h[p]),De(u)&&De(d)&&i++;if(i<=1)return this.parent.getErrorStrings()[W.DivZero];if(i===2)return 1;var f=this.getMeanArray(a,h),v=f[0],m=f[1],y=this.getCorrelation(a,h,v,m);return Math.pow(y,2)},o.prototype.getCorrelation=function(t,e,i,r){for(var n=0,s=0,a=0,l,h,c=0;c<t.length;c++)De(t[c])&&De(e[c])&&(h=Number(t[c])-i,l=Number(e[c])-r,n+=h*l,s+=Math.pow(h,2),a+=Math.pow(l,2));var u=n/Math.sqrt(s*a);return u},o.prototype.getMeanArray=function(t,e){for(var i=0,r=0,n=0,s=0,a=0,l=0;l<t.length;l++)De(t[l])&&De(e[l])&&(r+=Number(t[l]),n+=Number(e[l]),i++);return s=r/i,a=n/i,[s,a]},o.prototype.getDataCollection=function(t){for(var e=[],i=0,r=t.length;i<r;i++)e.push(this.parent.getValueFromArg(t[i]));return e},o.prototype.parseDouble=function(t){var e=this.parent.parseFloat(t.toString());return isNaN(e)?NaN:e},o.prototype.spreadsheetDisplayText=function(t){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(t)){var e=this.parent.parentObject.getIndexes(t);t=this.parent.parentObject.getDisplayText(this.parent.parentObject.getActiveSheet().rows[e.startIdx].cells[e.endIdx])}return t},o.prototype.spreadsheetFormat=function(t){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(t)){var e=this.parent.parentObject.getIndexes(t);t=this.parent.parentObject.getActiveSheet().rows[e.startIdx].cells[e.endIdx].format}return t},o})(),l9=(function(){function o(t){this.emptyStr="",this.storedStringText=this.emptyStr,this.sheetToken="!",this.tokenAdd="a",this.tokenSubtract="s",this.tokenMultiply="m",this.tokenDivide="d",this.tokenLess="l",this.charEm="r",this.charEp="x",this.tokenGreater="g",this.tokenEqual="e",this.tokenLessEq="k",this.tokenGreaterEq="j",this.tokenNotEqual="o",this.tokenAnd="c",this.tokenEm="v",this.tokenEp="t",this.tokenOr="~",this.charAnd="i",this.charLess="<",this.charGreater=">",this.charEqual="=",this.charLessEq="f",this.charGreaterEq="h",this.charNoEqual="z",this.stringGreaterEq=">=",this.stringLessEq="<=",this.stringNoEqual="<>",this.stringAnd="&",this.stringOr="^",this.charOr="w",this.charAdd="+",this.charSubtract="-",this.charMultiply="*",this.charDivide="/",this.fixedReference="$",this.spaceString=" ",this.ignoreBracet=!1,this.isError=!1,this.isFormulaParsed=!1,this.findNamedRange=!1,this.stringsColl=new Map,this.tokens=[this.tokenAdd,this.tokenSubtract,this.tokenMultiply,this.tokenDivide,this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual,this.tokenAnd,this.tokenOr],this.charNOTop="\xA7",this.specialSym=["~","@","#","?"],this.isFailureTriggered=!1,this.parent=t}return o.prototype.parse=function(t,e){var i=this;if(this.parent.isTextEmpty(t))return t;if(a9(t))return this.parent.getErrorStrings()[W.Ref];this.parent.getFormulaCharacter()!=="\0"&&this.parent.getFormulaCharacter()===t[0]&&(t=t.substring(1)),(this.parent.namedRanges.size>0||this.parent.storedData.size>0)&&(t=this.checkForNamedRangeAndKeyValue(t),this.findNamedRange=!1),t=t.replace(/[-+*/&^]+/g,function(p){for(var f="";1<p.length;)switch(p.substring(0,2)){case"++":p="+"+p.substring(2);break;case"--":p="+"+p.substring(2);break;case"+-":p="-"+p.substring(2);break;case"-+":p="-"+p.substring(2);break;case"*+":p="*"+p.substring(2);break;case"/+":p="/"+p.substring(2);break;case"^+":p="^"+p.substring(2);break;case"&+":p="&"+p.substring(2);break;case"*-":case"/-":case"^-":case"&-":f=p.substring(0,1),p=p.substring(1);break;default:throw new bs(i.parent.formulaErrorStrings[me.InvalidExpression],!0)}return f+p}),t=t.split("-(-").join("(");var r=this.storeStrings(t);t=this.storedStringText;var n=0;if(g(r)&&(t=t.split(" ").join("")),t=t.split("=>").join(">="),t=t.split("=<").join("<="),(t[t.length-1]!==this.parent.arithMarker||this.indexOfAny(t,this.tokens)!==t.length-2)&&(t=t.toUpperCase()),t.indexOf(this.sheetToken)>-1){var s=this.parent.getSheetFamilyItem(this.parent.grid);if(s.sheetNameToParentObject!=null&&s.sheetNameToParentObject.size>0){t[0]!==this.sheetToken.toString()&&(t=this.parent.setTokensForSheets(t));var a=this.parent.getSheetToken(t.split(this.parent.tic).join(this.emptyStr)),l=this.checkScopedRange(t.split('"').join(this.emptyStr).split(this.sheetToken).join(""));g(a)&&a!==""&&this.parent.namedRanges.size>0&&l!==""&&(t=l)}}t=this.processIndexArg(t),t=this.markLibraryFormulas(t);try{t=this.formulaAutoCorrection(t)}catch(p){var h={message:p.message,exception:p,isForceCalculable:p.formulaCorrection,computeForceCalculate:!1};if(!h.isForceCalculable)throw this.parent.formulaErrorStrings[me.InvalidExpression];if(this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0),h.isForceCalculable&&h.computeForceCalculate)t=this.formulaAutoCorrection(t,h),this.parent.storedData.get(e).formulaText="="+t;else throw this.parent.formulaErrorStrings[me.InvalidExpression]}if(!this.ignoreBracet)for(n=t.indexOf(")");n>-1;){var c=t.substring(0,n).lastIndexOf("(");if(c===-1)throw new bs(this.parent.formulaErrorStrings[me.MismatchedParentheses]);if(c===n-1)throw new bs(this.parent.formulaErrorStrings[me.EmptyExpression]);var u=this.emptyStr;this.ignoreBracet?u=this.parent.substring(t,c,n-c+1):u=this.parent.substring(t,c+1,n-c-1);try{t=t.substring(0,c)+this.parseSimple(u)+t.substring(n+1)}catch(p){if(p===this.parent.formulaErrorStrings[me.CircularReference])throw p;var h=this.exceptionArgs(p);this.isFailureTriggered||(this.parent.trigger("onFailure",h),this.isFailureTriggered=!0);var d=typeof h.exception=="string"?h.exception:h.message;return(this.parent.getErrorLine(p)?"":"#"+this.parent.getErrorLine(p)+": ")+d}n=t.indexOf(")")}if(!this.ignoreBracet&&t.indexOf("(")>-1)throw new bs(this.parent.formulaErrorStrings[me.MismatchedParentheses]);return t=this.parseSimple(t),r!==null&&r.size>0&&(t=this.setStrings(t,r)),t},o.prototype.exceptionArgs=function(t){return{message:t.message,exception:t,isForceCalculable:t.formulaCorrection,computeForceCalculate:!1}},o.prototype.formulaAutoCorrection=function(t,e,i){var r=["*","+","-","/","^","&"],n=[">","=","<"],s=0,a="",l="",h="",c="",u="",d="",p="",f=0;if(this.parent.formulaErrorStrings.indexOf(t)>-1)return t;if(this.indexOfAny(t,this.specialSym)>-1)throw new bs(this.parent.formulaErrorStrings[me.InvalidExpression],!1);for(;s<t.length;)if(t=t.split("-*").join("-").split("/*").join("/").split("*/").join("*").split("-/").join("-").split("*+").join("*").split("+*").join("+"),this.parent.isDigit(t[s])&&t.length>s+1&&this.indexOfAny(t[s+1],r)>-1&&t.length>s+2&&!g(t[s+2])&&this.indexOfAny(t[s+2],r)>-1&&(t[s+2]!=="-"||t[s+1]!=="*"&&t[s+1]!=="/"&&t[s+1]!=="^"&&t[s+1]!=="&"))if(e&&e.computeForceCalculate)this.parent.isDigit(t[s])?(f<1?(d=t[s],h=t[s+1],g(h)&&(h=this.emptyStr),h=h==="&"?"":h,f=f+1,a=a+d+h):f<2&&(p=t[s],c=t[s-1],u=t[s+1],f=0,c==="-"?(u=g(u)?this.emptyStr:u,u=u==="&"?"":u,a=a+c+p+u):(u=g(u)?this.emptyStr:u,a=a+p+u)),s=s+2):(a=t[s]==="-"?a+t[s]:a,s=s+1);else throw this.parent.formulaErrorStrings[me.ImproperFormula];else if((this.parent.isDigit(t[s])||t[s]===this.parent.rightBracket||this.parent.storedData.has(t[s].toUpperCase()))&&(g(t[s+1])||this.indexOfAny(t[s+1],r)>-1&&t[s+1]!=="&"))l=g(t[s+1])?this.emptyStr:t[s+1],l=l==="&"&&t[s+2]!=="-"?"":l,a=t[s-1]==="-"?a+t[s-1]+t[s]+l:a+t[s]+l,s=s+2;else if(this.indexOfAny(t[s],n)>-1&&!g(t[s-1])&&!g(t[s+1]))a=a+t[s],s=s+1;else if(t[s]==="q")for(;t[s]!==this.parent.leftBracket;)a=a+t[s],s=s+1;else t[s]===this.parent.leftBracket||t[s]===this.parent.rightBracket||t[s]==="{"||t[s]==="}"||t[s]==="("||t[s]===")"||this.parent.isUpperChar(t[s])||t[s].indexOf(":")>-1||t[s]===this.parent.getParseArgumentSeparator()||t[s]==="%"&&this.parent.isDigit(t[s-1])||t[s]===this.parent.tic||t[s]===" "||t[s]===this.parent.getParseDecimalSeparator()||t[s]===this.sheetToken||t[s]==="$"||t[s]==="_"?(a=a+t[s],s=s+1):(this.parent.isDigit(t[s])&&(a=t[s-1]==="-"?a+t[s-1]+t[s]:a+t[s]),(t[s]==="-"||t[s]==="+")&&(a=a+t[s],a=a.split("++").join("+").split("+-").join("-").split("-+").join("-")),(t[s]==="/"||t[s]==="*"||t[s]==="^")&&(a=a+t[s]),t[s]==="&"&&(i||t.substring(s+1).trim()[0]!=="q")&&(a=a+t[s]),s=s+1);return a=a===this.emptyStr?t:a,this.indexOfAny(a[a.length-1],r)>-1&&(a=a.substring(0,a.length-1)),a=a.split("--").join("-").split("-+").join("-").split("+-").join("-"),a},o.prototype.checkScopedRange=function(t){var e=this,i=this.emptyStr,r="NaN",n=this.parent.getSheetID(this.parent.grid),s=this.parent.getSheetFamilyItem(this.parent.grid);if(t[0]===this.sheetToken.toString()){var a=t.indexOf(this.sheetToken,1),l=parseInt(t.substr(1,a-1),10);a>1&&!this.parent.isNaN(l)&&(t=t.substring(a+1),n=l)}var h="!"+n.toString();return s===null||s.sheetNameToToken==null||s.sheetNameToToken.forEach(function(c,u){if(s.sheetNameToToken.get(u).toString()===h+"!"){var d=e.emptyStr;e.parent.namedRanges.forEach(function(p,f){g(e.parent.parentObject)?d=s.sheetNameToToken.get(f).toUpperCase():d=e.parent.parentObject.getActiveSheet().name+e.sheetToken+t.toUpperCase(),e.parent.getNamedRanges().has(d)&&(i=e.parent.getNamedRanges().get(d).toUpperCase(),r=i)})}}),r},o.prototype.storeStrings=function(t){var e=0,i=0,r=0,n="",s=null,a,l=t.indexOf(this.parent.tic);if(l>-1)for(e=t.indexOf(this.parent.tic);e>-1&&t.length>0;){if(s===null&&(s=this.stringsColl),i=e+1<t.length?t.indexOf(this.parent.tic,e+1):-1,i===-1)throw new bs(this.parent.formulaErrorStrings[me.MismatchedTics]);a=this.parent.substring(t,e,i-e+1),n=this.parent.tic+this.spaceString+r.toString()+this.parent.tic,s=s.set(n,a),t=t.substring(0,e)+n+t.substring(i+1),e=e+n.length,e<=t.length&&(e=t.indexOf(this.parent.tic,e)),r++}return this.storedStringText=t,s},o.prototype.setStrings=function(t,e){for(var i=0;i<e.size;i++)e.forEach(function(r,n){t=t.split(n).join(r)});return t},o.prototype.parseSimple=function(t){var e=!0,i=t;if(i.length>0&&i[0]==="+"&&(i=i.substring(1)),i==="#DIV/0!")return"#DIV/0!";if(i==="#NAME?")return"#NAME?";if(i===""||this.parent.formulaErrorStrings.indexOf(i)>-1)return i;i=i.split(this.stringLessEq).join(this.charLessEq),i=i.split(this.stringGreaterEq).join(this.charGreaterEq),i=i.split(this.stringNoEqual).join(this.charNoEqual),i=i.split(this.stringAnd).join(this.charAnd),i=i.split(this.stringOr).join(this.charOr),i=i.split(this.fixedReference).join(this.emptyStr),e=!0;var r=[this.tokenEp,this.tokenEm],n=[this.tokenMultiply,this.tokenDivide],s=[this.tokenAdd,this.tokenSubtract],a=[this.charMultiply,this.charDivide],l=[this.charAdd,this.charSubtract],h=[this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual],c=[this.charLess,this.charGreater,this.charEqual,this.charLessEq,this.charGreaterEq,this.charNoEqual],u=[this.charEp,this.charEm],d=[this.tokenAnd],p=[this.charAnd],f=[this.charOr],v=[this.tokenOr];return i=this.parseSimpleOperators(i,r,u),i=this.parseSimpleOperators(i,v,f),e&&(i=this.parseSimpleOperators(i,n,a)),e&&(i=this.parseSimpleOperators(i,s,l)),e&&(i=this.parseSimpleOperators(i,h,c)),e&&(i=this.parseSimpleOperators(i,d,p)),i},o.prototype.parseSimpleOperators=function(t,e,i){if(this.parent.getErrorStrings().indexOf(t)>-1)return t;for(var r=t,n=0,s="",a=0;a<i.length;a++)s=s+i[a];if(r=r.split("---").join("-").split("--").join("+").split(this.parent.getParseArgumentSeparator()+"-").join(this.parent.getParseArgumentSeparator()+"u").split(this.parent.leftBracket+"-").join(this.parent.leftBracket+"u").split("=-").join("=u"),r=r.split(",+").join(",").split(this.parent.leftBracket+"+").join(this.parent.leftBracket).split("=+").join("=").split(">+").join(">").split("<+").join("<").split("/+").join("/").split("*+").join("*").split("++").join("+").split("*-").join("*u").split("/-").join("/u").split("w-").join("wu").split("i-").join("iu").toString(),r=r.split(">-").join(">u").split("<-").join("<u").split("h-").join("hu").split("f-").join("fu").split("z-").join("zu"),r.length>0&&r[0]==="-"){var l="\x84";r=r.substring(1).split("-").join(l),r="0-"+r,r=this.parseSimpleOperators(r,[this.tokenSubtract],[this.charSubtract]),r=r.split(l).join("-")}else r.length>0&&r[0]==="+"?r=r.substring(1):r.length>0&&r[r.length-1]==="+"&&(r=r.substring(0,r.length-1));try{if(this.indexOfAny(r,i)>-1){if(r.includes(" ")){for(var h="",c=0;c<r.length;c++){var u=r[c];if(i.indexOf(u)>=0)h=h.trim()+u;else{if(u===" "&&i.indexOf(h[h.length-1])>=0)continue;h+=u}}r=h}n=this.indexOfAny(r,i);for(var d=this.parent.getParseDecimalSeparator();n>-1;){var p="",f="",v=0,m=0,y=!1,b=["*","+","-","/","w","=","<",">"],S=r[n]===this.charNOTop,C=0;if(S)v=n;else if(C=n-1,r[C]===this.parent.arithMarker){var x=this.findLeftMarker(r.substring(0,C-1));if(x<0)throw new bs(this.parent.formulaErrorStrings[me.CannotParse]);p=this.parent.substring(r,x+1,C-x-1),v=x+1}else if(r[C]===this.parent.rightBracket){for(var I=0,x=C-1;x>0&&(r[x]!=="q"||I!==0);)r[x]==="q"?I--:r[x]===this.parent.rightBracket&&I++,x--;if(x<0)throw new bs(this.parent.formulaErrorStrings[me.CannotParse]);p=this.parent.substring(r,x,C-x+1),v=x}else if(r[C]===this.parent.tic[0]){var D=r.substring(0,C-1).lastIndexOf(this.parent.tic);if(D<0)throw new bs(this.parent.formulaErrorStrings[me.CannotParse]);p=this.parent.substring(r,D,C-D+1),v=D}else{for(var M=!1;C>-1&&(this.parent.isDigit(r[C])||!M&&(r[C]===d||r[C]==="%"));)!this.parent.isDigit(r[C])&&r[C]!=="%"&&(M=!0),C=C-1;if(C>-1&&M&&r[C]===d)throw new bs(this.parent.formulaErrorStrings[me.NumberContains2DecimalPoints]);if(C=C+1,C===0||C>0&&!this.parent.isUpperChar(r[C-1]))p="n"+this.parent.substring(r,C,n-C),v=C;else if(C>0&&r[C-1]==="E"&&(r.substring(C-4,C)==="TRUE"&&(g(r[C-5])||b.indexOf(r[C-5])>-1)||r.substring(C-5,C)==="FALSE"&&(g(r[C-6])||b.indexOf(r[C-6])>-1))&&(r.substring(C+1,C+5)==="TRUE"||r.substring(C+1,C+6)==="FALSE"))C=r.substring(C-4,C)==="TRUE"?C-4:C-5,p=r.substring(C,n)==="TRUE"?"n1":r.substring(C,n)==="FALSE"?"n0":p,v=C,y=!0;else{for(C=C-1;C>-1&&(this.parent.isUpperChar(r[C])||this.parent.isDigit(r[C])||r[C]==="_");)C=C-1;if(C>-1&&r[C]===this.sheetToken){for(C=C-1;C>-1&&r[C]!==this.sheetToken;)C=C-1;C>-1&&r[C]===this.sheetToken&&(C=C-1)}if(C>-1&&r[C]===":"){for(C=C-1;C>-1&&this.parent.isDigit(r[C]);)C=C-1;for(;C>-1&&this.parent.isUpperChar(r[C]);)C=C-1;if(C>-1&&r[C]===this.sheetToken){for(C--;C>-1&&r[C]!==this.sheetToken;)C--;C>-1&&r[C]===this.sheetToken&&C--}C=C+1,p=this.parent.substring(r,C,n-C),p=this.parent.getCellFrom(p)}else{var E=!1;C>0&&!this.parent.isUpperChar(r[C])&&(E=r[C]==="u"&&r[C-1]===this.parent.getParseArgumentSeparator()),E||(C=C+1),p=this.parent.substring(r,C,n-C)}this.parent.updateDependentCell(p),v=C}(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(p.toUpperCase())||this.parent.storedData.has(p.toUpperCase()))&&(p="n"+this.checkForNamedRangeAndKeyValue(p))}if(n===r.length-1)throw new bs(this.parent.formulaErrorStrings[me.ExpressionCannotEndWithAnOperator]);C=n+1;var E=r[C]==="u";if(E&&(C=C+1),r[C]===this.parent.tic[0]){var x=r.substring(C+1).indexOf(this.parent.tic);if(x<0)throw this.parent.formulaErrorStrings[me.CannotParse];f=this.parent.substring(r,C,x+2),m=x+C+2}else if(r[C]===this.parent.arithMarker){var x=this.findRightMarker(r.substring(C+1));if(x<0)throw new bs(this.parent.formulaErrorStrings[me.CannotParse]);f=this.parent.substring(r,C+1,x),m=x+C+2}else if(r[C]==="q"){for(var I=0,x=C+1;x<r.length&&(r[x]!==this.parent.rightBracket||I!==0);)r[x]===this.parent.rightBracket?I++:r[x]==="q"&&I--,x++;if(x===r.length)throw this.parent.formulaErrorStrings[me.CannotParse];f=this.parent.substring(r,C,x-C+1),E&&(f="u"+f),m=x+1}else if(this.parent.isDigit(r[C])||r[C]===d){var M=r[C]===d;for(C=C+1;C<r.length&&(this.parent.isDigit(r[C])||!M&&r[C]===d);)r[C]===d&&(M=!0),C=C+1;if(C<r.length&&r[C]==="%"&&(C+=1),M&&C<r.length&&r[C]===d)throw this.parent.formulaErrorStrings[me.NumberContains2DecimalPoints];f="n"+this.parent.substring(r,n+1,C-n-1),m=C}else if(this.parent.isUpperChar(r[C])||r[C]===this.sheetToken||r[C]==="u"){if(r[C]===this.sheetToken)for(C=C+1;C<r.length&&r[C]!==this.sheetToken;)C=C+1;C=C+1;for(var A=0,L=!1;C<r.length&&(this.parent.isUpperChar(r[C])||r[C]==="_"||r[C]===d||r[C]==="["||r[C]==="]"||r[C]==="#"||r[C]===" "||r[C]==="%"||r[C]===d&&L);)C!==r.length-1&&r[C]==="["&&r[C+1]==="["&&(L=!0),C!==r.length-1&&r[C]==="]"&&r[C+1]==="]"&&(L=!1),C++,A++;var N=C===r.length||!this.parent.isDigit(r[C]);if(A>1){for(;C<r.length&&(this.parent.isUpperChar(r[C])||this.parent.isDigit(r[C])||r[C]===" "||r[C]==="_");)C++;N=!0}for(;C<r.length&&this.parent.isDigit(r[C]);)C=C+1;if(C<r.length&&r[C]===":"){if(C=C+1,C<r.length&&r[C]===this.sheetToken){for(C++;C<r.length&&r[C]!==this.sheetToken;)C=C+1;C<r.length&&r[C]===this.sheetToken&&C++}for(;C<r.length&&this.parent.isUpperChar(r[C]);)C=C+1;for(;C<r.length&&this.parent.isDigit(r[C]);)C=C+1;C=C-1,f=this.parent.substring(r,n+1,C-n),f=this.parent.getCellFrom(f)}else C=C-1,f=this.parent.substring(r,n+1,C-n),E=r[C]==="u",E&&(f="u"+f);N&&f.startsWith(this.sheetToken)&&(N=!this.parent.isCellReference(f)),N||this.parent.updateDependentCell(f),(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(f.toUpperCase())||this.parent.storedData.has(f.toUpperCase()))&&(f="n"+this.checkForNamedRangeAndKeyValue(f));var R=["*","+","-","/","w"].indexOf(r[C-f.length])>-1;f=f==="TRUE"&&(y||R)?"n1":f==="FALSE"&&(y||R)?"n0":f,m=C+1}var P=s.indexOf(r[n]),k=this.parent.arithMarker+p+f+e[P]+this.parent.arithMarker;v>0&&(k=r.substring(0,v)+k),m<r.length&&(k=k+r.substring(m)),k=k.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString()),r=k,n=this.indexOfAny(r,i)}}else if(r.length>0&&(this.parent.isUpperChar(r[0])||r[0]===this.sheetToken)){for(var B=!0,F=!0,O=!1,z=r.length,x=0;x<z;++x)if(r[x]===this.sheetToken){if(x>0&&!O)throw this.parent.getErrorStrings()[W.Ref];for(O=!0,x++;x<z&&this.parent.isDigit(r[x]);)x++;if(x===z||r[x]!==this.sheetToken){B=!1;break}}else{if(!F&&this.parent.isChar(r[x])){B=!1;break}if(this.parent.isChar(r[x])||this.parent.isDigit(r[x])||r[x]===this.sheetToken)F=this.parent.isUpperChar(r[x]);else{B=!1;break}}B&&this.parent.updateDependentCell(r)}return r}catch(Y){if(Y===this.parent.formulaErrorStrings[me.CircularReference])throw Y;return Y}},o.prototype.indexOfAny=function(t,e){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return i;return-1},o.prototype.findLeftMarker=function(t){var e=-1;if(t.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=t.length-1;r>=0;--r)if(t[r]===this.parent.rightBracket)i--;else if(t[r]===this.parent.leftBracket)i++;else if(t[r]===this.parent.arithMarker&&i===0){e=r;break}}return e},o.prototype.findRightMarker=function(t){var e=-1;if(t.indexOf(this.parent.arithMarker)>-1){for(var i=0,r=0;r<t.length;++r)if(t[r]===this.parent.rightBracket)i--;else if(t[r]===this.parent.leftBracket)i++;else if(t[r]===this.parent.arithMarker&&i===0){e=r;break}}return e},o.prototype.parseFormula=function(t,e){if(t.length>0&&t[0]===this.parent.getFormulaCharacter()&&(t=t.substring(1)),t.indexOf("#REF!")>-1)return this.parent.getErrorStrings()[W.Ref];t.length>0&&t[0]==="+"&&(t=t.substring(1));try{this.isFailureTriggered=!1,this.isError=!1,t=this.parse(t.trim(),e),this.isFormulaParsed=!0}catch(n){var i=this.exceptionArgs(n);this.isFailureTriggered||(this.parent.trigger("onFailure",i),this.isFailureTriggered=!0);var r=typeof i.exception=="string"?i.exception:i.message;t=(g(this.parent.getErrorLine(n))?"":"#"+this.parent.getErrorLine(n)+": ")+r,this.isError=!0}return t},o.prototype.markLibraryFormulas=function(t){var e=0,i=t.indexOf(")");if(i===-1)t=this.markNamedRanges(t);else for(var r=function(){for(var a=0,l=i-1;l>-1&&(t[l]!=="("||a!==0);)t[l]===")"&&a++,l--;if(l===-1)throw new bs(n.parent.formulaErrorStrings[me.MismatchedParentheses]);for(var h=l-1;h>-1&&(n.parent.isChar(t[h])||t[h]===".");)h--;var c=l-h-1,u=n.parent.substring(t,h+1,c);if(c>0&&!g(n.parent.getFunction(u))&&(!u.includes(".")||n.isValidDotFormulaName(u))){var d=n.parent.substring(t,l,i-l+1),p=n.parent.getParseArgumentSeparator();if(u==="AREAS")n.ignoreBracet=!0;else if(n.ignoreBracet=!1,(u.includes("IFS")&&u!=="COUNTIFS"||u==="MATCH")&&d.includes("{")){var f=d.indexOf("{"),v=n.parent.substring(d,f,d.indexOf("}")-f+1);d=d.split(v).join(v.split(p).join(n.parent.tic+n.parent.tic))}try{var m=void 0;d=d.split("(").join("").split(")").join(""),d="("+n.formulaAutoCorrection(d,m,!0)+")"}catch(C){var m={message:C.message,exception:C,isForceCalculable:C.formulaCorrection,computeForceCalculate:!1};if(!m.isForceCalculable)throw n.parent.formulaErrorStrings[me.ImproperFormula];if(n.isFailureTriggered||(n.parent.trigger("onFailure",m),n.isFailureTriggered=!0,e=e+1),m.computeForceCalculate=e>0?!0:m.computeForceCalculate,m.isForceCalculable)if(m.computeForceCalculate)d=d.split("(").join("").split(")").join(""),d="("+n.formulaAutoCorrection(d,m)+")";else throw n.parent.formulaErrorStrings[me.ImproperFormula];else throw n.parent.formulaErrorStrings[me.ImproperFormula]}d=n.markNamedRanges(d),d=n.swapInnerParens(d),d=n.addParensToArgs(d);var y=d.lastIndexOf(p);y===-1&&d.length>2&&d[0]==="("&&d[d.length-1]===")"&&d[1]!=="{"&&d[1]!=="("&&(d=d.substring(0,d.length-1)+"}"+d.substring(d.length-1),d=d[0]+"{"+d.substring(1)),t=t.substring(0,h+1)+"q"+n.parent.substring(t,h+1,c)+d.split("(").join(n.parent.leftBracket).split(")").join(n.parent.rightBracket)+t.substring(i+1)}else{var b=function(C){if(C.includes("IFERROR(")){var x=C.lastIndexOf("(");return C.substring(x-7,x)==="IFERROR"||b(C.substring(0,x))}return!1};if(c>0&&!b(t.substring(0,h+1)))return{value:n.parent.getErrorStrings()[W.Name]};var S=n.emptyStr;l>0&&(S=t.substring(0,l)),S=S+"{"+n.parent.substring(t,l+1,i-l-1)+"}",i<t.length&&(S=S+t.substring(i+1)),S=n.markNamedRanges(S),t=S}i=t.indexOf(")")},n=this;i>-1;){var s=r();if(typeof s=="object")return s.value}return t=t.split("{").join("(").split("}").join(")"),t},o.prototype.swapInnerParens=function(t){return t.length>2&&(t=t[0]+t.substr(1,t.length-2).split("(").join("{").split(")").join("}")+t[t.length-1]),t},o.prototype.addParensToArgs=function(t){if(t.length===0)return this.emptyStr;var e=[];e.push(this.parent.getParseArgumentSeparator()),e.push(this.parent.rightBracket);var i=t.lastIndexOf(this.parent.getParseArgumentSeparator()),r=0;if(i===-1){if(t.length>2&&t[0]==="("&&t[t.length-1]===")")if(t[1]!=="{"&&t[1]!=="(")t=t.substring(0,t.length-1)+"}"+t.substring(t.length-1),t=t[0]+"{"+t.substring(1);else{var n=["+","-","*","/"];i=this.lastIndexOfAny(t,n),r===0&&t[t.length-1]===")"&&(r=t.length-1),r>0&&t[i+1]!=="{"&&t[i-1]==="}"&&(t=t.substr(0,r)+"}"+t.substr(r),t=t.substr(0,i+1)+"{"+t.substr(i+1))}}else for(var s=!0;i>-1;){var a=this.indexOfAny(t.substring(i+1,t.length),e);a>=0?a=i+a+1:a===-1&&t[t.length-1]===")"&&(a=t.length-1),a>0&&t[i+1]!=="{"&&t[a-1]!=="}"&&t[a-1]!=="\xA2"&&(t=t.substr(0,a).trim()+"}"+t.substr(a),t=t.substr(0,i+1)+"{"+t.substr(i+1).trim()),i=t.substr(0,i).lastIndexOf(this.parent.getParseArgumentSeparator()),s&&i===-1&&t[0]==="("&&(i=0,s=!1)}return t=t.split("{}").join(this.emptyStr),t},o.prototype.lastIndexOfAny=function(t,e){for(var i=t.length-1;i>-1;i--)if(e.indexOf(t[i])>-1)return i;return-1},o.prototype.markNamedRanges=function(t){var e=[")",this.parent.getParseArgumentSeparator(),"}","+","-","*","/","<",">","=","&",":"],i=t.length>0&&(t[0]==="("||t[0]==="{")?1:0;t.indexOf("#N/A")>-1&&(t=t.split("#N/A").join("#N~A")),t.indexOf("#DIV/0!")>-1&&(t=t.split("#DIV/0!").join("#DIV~0!"));for(var r=this.indexOfAny(t.substring(i),e);r>-1&&r+i<t.length;){var n=this.emptyStr,s=null;if(this.parent.substring(t,i,r).indexOf("[")>-1?s=this.getTableRange(this.parent.substring(t,i,r)):this.parent.storedData.has(this.parent.substring(t,i,r))?s=this.checkForNamedRangeAndKeyValue(this.parent.substring(t,i,r)):this.parent.namedRanges.has(this.parent.substring(t,i,r))&&(s=this.checkForNamedRangeAndKeyValue(this.parent.substring(t,i,r))),g(s)&&(n=this.checkScopedRange(this.parent.substring(t,i,r)),n!=="NaN"?(this.findNamedRange=!0,s=n):this.parent.substring(t,i,r).startsWith(this.sheetToken.toString()),!g(s)&&this.findNamedRange&&s.indexOf(this.fixedReference)>-1&&(s=s.split(this.fixedReference).join(this.emptyStr))),g(s)||(s=s.toUpperCase(),s=this.parent.setTokensForSheets(s),s=this.markLibraryFormulas(s)),!g(s)&&s!==this.emptyStr)t=t.substring(0,i)+s+t.substring(i+r),i+=s.length+1;else for(i+=r+1;i<t.length&&!this.parent.isUpperChar(t[i])&&t[i]!==this.sheetToken;)i++;for(r=i,i<t.length-1&&t[i]==="{"&&(i=i+1),r=this.indexOfAny(t.substring(i),e);r===0&&i<t.length-1;)i++,r=this.indexOfAny(t.substring(i),e);if((r===-1||t.substring(i).indexOf("[")>-1)&&i<t.length){if(t.substring(i).indexOf("[")>-1?s=this.getTableRange(t.substring(i)):this.parent.storedData.has(t.substring(i))?s=this.parent.storedData.size>0?this.checkForNamedRangeAndKeyValue(t.substring(i)):s:s=this.parent.namedRanges.size>0?this.checkForNamedRangeAndKeyValue(t.substring(i)):s,g(s)&&(n=this.checkScopedRange(t.substring(i)),n!=="NaN"&&(s=n)),!g(s)&&s!==this.emptyStr&&(s=s.toUpperCase(),s=this.parent.setTokensForSheets(s),s=this.markLibraryFormulas(s),s!=null)){var a=t.substring(i);a[a.length-1]===")"?t=t.substring(0,i)+s+")":t=t.substring(0,i)+s,i+=s.toString().length+1}r=i<t.length?this.indexOfAny(t.substring(i),e):-1}}return t.indexOf("#N~A")>-1&&(t=t.split("#N~A").join("#N/A")),t.indexOf("#DIV~0!")>-1&&(t=t.split("#DIV~0!").join("#DIV/0!")),t},o.prototype.checkForNamedRangeAndKeyValue=function(t){var e=this.emptyStr;if(t.indexOf("[")>-1){var i=this.getTableRange(t);g(i)||(this.findNamedRange=!0,t=i)}if(e=this.checkScopedRange(t),e!=="NaN")this.findNamedRange=!0,t=e;else{if(t.indexOf(this.sheetToken)>-1){var r=this.parent.getSheetFamilyItem(this.parent.grid),n=t.split('"').join(this.emptyStr);if(n=n.substr(0,n.indexOf(this.sheetToken)),r.sheetNameToToken.has(n.toUpperCase()))var s=parseInt(r.sheetNameToToken.get(n.toUpperCase()).split(this.sheetToken).join(this.emptyStr))}this.parent.storedData.size>0&&this.parent.storedData.has(t)&&(t="A"+this.parent.colIndex(t)),this.parent.namedRanges.size>0&&this.parent.namedRanges.has(t.toUpperCase())&&(g(this.parent.parentObject)?(t=this.parse(this.parent.namedRanges.get(t.toUpperCase())),t=this.parent.setTokensForSheets(t),t.indexOf(this.fixedReference)>-1&&t.split(this.fixedReference).join(this.emptyStr),this.findNamedRange=!0):t=this.parse(this.parent.namedRanges.get(t.toUpperCase()))),this.findNamedRange&&t[0]!=="!"&&t[0]!=="q"&&t[0]!=="bq"&&(t=this.parent.setTokensForSheets(t),t.indexOf(this.fixedReference)>-1&&(t=t.split(this.fixedReference).join(this.emptyStr)))}return t},o.prototype.getTableRange=function(t){t=t.replace(" ",this.emptyStr).toUpperCase();var e=t.replace("]",this.emptyStr).replace("#DATA",this.emptyStr),i=e;e.indexOf(this.parent.getParseArgumentSeparator())>-1&&(i=e.substring(0,e.indexOf(this.parent.getParseArgumentSeparator())).replace("[",this.emptyStr),e=e.replace("[",this.emptyStr).replace(this.parent.getParseArgumentSeparator(),"_"));var r=this.emptyStr;return e.toUpperCase()},o.prototype.findNextEndIndex=function(t,e){for(var i=0,r=e,n=!1;!n&&e<t.length;)t[r]==="["?i++:t[r]==="]"&&(i--,i===0&&(n=!0)),e++;return e=e-r,e},o.prototype.processIndexArg=function(t){var e="INDEX((",i=t.indexOf(e);if(i!==-1){var r=i+(e.length-1);if(r!==-1){for(var n=0,s=-1,a=r;a<t.length;a++)if(t[a]==="("?n++:t[a]===")"&&n--,n===0){s=a;break}s>r&&(t=t.slice(0,r)+this.parent.tic+t.slice(r+1,s)+this.parent.tic+t.slice(s+1))}}return t},o.prototype.isValidDotFormulaName=function(t){t=t.toUpperCase();var e=["STDEV.P","STDEV.S","VAR.S","VAR.P","T.TEST","F.TEST","Z.TEST","CHISQ.TEST","COVARIANCE.S","COVARIANCE.P","CHISQ.DIST","F.DIST","T.DIST"];return e.some(function(i){return t===i})},o})(),h9=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),fz=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ig=1048576,rg=16384,c9=(function(o){h9(t,o);function t(e){var i=o.call(this,null,null)||this;return i.lFormulas=new Map,i.storedData=new Map,i.keyToRowsMap=new Map,i.rowsToKeyMap=new Map,i.rightBracket="\xA1",i.leftBracket="\xA2",i.sheetToken="!",i.emptyString="",i.leftBrace="{",i.rightBrace="}",i.cell=i.emptyString,i.cellPrefix="!0!A",i.treatEmptyStringAsZero=!1,i.tic='"',i.singleTic="'",i.trueValue="TRUE",i.falseValue="FALSE",i.parseDecimalSeparator=".",i.arithMarker="\xB4",i.arithMarker2=i.arithMarker+i.arithMarker,i.dependentCells=null,i.dependentFormulaCells=null,i.minValue=Number.MIN_SAFE_INTEGER,i.maxValue=Number.MAX_SAFE_INTEGER,i.categoryCollection=["All"],i.dependencyLevel=0,i.randomValues=new Map,i.isRandomVal=!1,i.randCollection=[],i.dependencyCollection=[],i.uniqueRange=[],i.formulaErrorStrings=["binary operators cannot start an expression","cannot parse","bad library","invalid char in front of","number contains 2 decimal points","expression cannot end with an operator","invalid characters following an operator","invalid character in number","mismatched parentheses","unknown formula name","requires a single argument","requires 3 arguments","invalid Math argument","requires 2 arguments","#NAME?","too complex","#CIRCULARREF!","missing formula","improper formula","invalid expression","cell empty","bad formula","empty expression","","mismatched string quotes","wrong number of arguments","invalid arguments","iterations do not converge","Control is already registered","Calculation overflow","Missing sheet","cannot_parse","expression_cannot_end_with_an_operator","#SPILL!","#DIV/0!"],i.errorStrings=null,i.parseArgumentSeparator=",",i.dateTime1900=new Date(1900,0,1,0,0,0),i.isParseDecimalSeparatorChanged=!1,i.isArgumentSeparatorChanged=!1,i.sheetFamilyID=0,i.defaultFamilyItem=null,i.sheetFamiliesList=null,i.modelToSheetID=null,i.tokenCount=0,i.sortedSheetNames=null,i.tempSheetPlaceHolder="\x85",i.namedRanges=new Map,i.formulaInfoTable=null,i.millisecondsOfaDay=1440*60*1e3,i.parseDateTimeSeparator="/",new o9(i),i.parentObject=g(e)?i:e,i.grid=i.parentObject,i.parser=new l9(i),i}return Object.defineProperty(t.prototype,"libraryFormulas",{get:function(){return this.lFormulas},set:function(e){this.lFormulas.set(e.fName,{handler:e.handler,category:e.category,description:e.description})},enumerable:!0,configurable:!0}),t.prototype.getParseArgumentSeparator=function(){var e=",";return!this.isArgumentSeparatorChanged&&e!==this.parseArgumentSeparator&&(this.parseArgumentSeparator=e),this.parseArgumentSeparator},t.prototype.setParseArgumentSeparator=function(e){this.parseArgumentSeparator=e,this.isArgumentSeparatorChanged=!0},t.prototype.getParseDateTimeSeparator=function(){return this.parseDateTimeSeparator},t.prototype.setTreatEmptyStringAsZero=function(e){this.treatEmptyStringAsZero=e},t.prototype.getTreatEmptyStringAsZero=function(){return this.treatEmptyStringAsZero},t.prototype.setParseDateTimeSeparator=function(e){this.parseDateTimeSeparator=e},t.prototype.onPropertyChanged=function(e,i){},t.prototype.getModuleName=function(){return"calculate"},t.prototype.getFormulaCharacter=function(){return"="},t.prototype.isUpperChar=function(e){var i=e.charCodeAt(0);return i>64&&i<91},t.prototype.resetKeys=function(){this.storedData.clear(),this.keyToRowsMap.clear(),this.rowsToKeyMap.clear()},t.prototype.updateDependentCell=function(e){var i=this,r=this.cell;if(r!==this.emptyString){var n=this.getSheetFamilyItem(this.grid);if(n.sheetNameToParentObject&&(r.includes(this.sheetToken)||(r=n.parentObjectToToken.get(this.grid)+r),e.includes(this.sheetToken)||(e=n.parentObjectToToken.get(this.grid)+e)),r!==e){var s=this.getDependentCells();s.has(e)||s.set(e,[]);var a=s.get(e);if(a.indexOf(r)===-1){var l=this.getDependentFormulaCells(),h={},c=function(u){if(l.has(u)){var d=l.get(u);if(d.has(r))throw i.formulaErrorStrings[me.CircularReference];h[u]||(h[u]=!0,d.forEach(function(p){c(p)}))}};c(e),a.push(r),l.has(r)?l.get(r).has(e)||l.get(r).set(e,e):(l.set(r,new Map),l.get(r).set(e,e))}}}},t.prototype.getDependentCells=function(){return this.dependentCells==null&&(this.dependentCells=new Map),this.dependentCells},t.prototype.getDependentFormulaCells=function(){if(this.isSheetMember()){var e=this.getSheetFamilyItem(this.grid);return e.sheetDependentFormulaCells==null&&(e.sheetDependentFormulaCells=new Map),e.sheetDependentFormulaCells}else return this.dependentFormulaCells==null&&(this.dependentFormulaCells=new Map),this.dependentFormulaCells},t.prototype.getLibraryFormulas=function(){return this.lFormulas},t.prototype.getFunction=function(e){return this.getLibraryFormulas().has(e.toUpperCase())?this.getLibraryFormulas().get(e.toUpperCase()).handler:null},t.prototype.intToDate=function(e){var i=Number(e);i=i>0&&i<1?1+i:i===0?1:i,i>60&&(i-=1);var r=new Date("01/01/1900"),n=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds());return new Date(new Date((i-1)*(1e3*3600*24)+n).toUTCString().replace(" GMT",""))},t.prototype.getFormulaInfoTable=function(){if(this.isSheetMember()){var e=this.getSheetFamilyItem(this.grid);return e.sheetFormulaInfotable===null&&(e.sheetFormulaInfotable=new Map),e.sheetFormulaInfotable}else return this.formulaInfoTable===null&&(this.formulaInfoTable=new Map),this.formulaInfoTable},t.prototype.getParseDecimalSeparator=function(){var e=".";return!this.isParseDecimalSeparatorChanged&&e!==this.parseDecimalSeparator&&(this.parseDecimalSeparator=e),this.parseDecimalSeparator},t.prototype.setParseDecimalSeparator=function(e){this.parseDecimalSeparator=e,this.isParseDecimalSeparatorChanged=!0},t.prototype.getSheetToken=function(e){var i=0,r=this.emptyString;if(i<e.length&&e[i]===this.sheetToken){for(i++;i<e.length&&e[i]!==this.sheetToken;)i++;r=e.substring(0,i+1)}if(i<e.length)return r;throw this.formulaErrorStrings[me.BadIndex]},t.prototype.getSheetID=function(e){var i=this.getSheetFamilyItem(e);if(i.sheetNameToParentObject!=null&&i.sheetNameToParentObject.size>0){var r=i.parentObjectToToken.get(e);if(r){r=r.split(this.sheetToken).join(this.emptyString);var n=this.parseFloat(r);if(!this.isNaN(n))return n}}return-1},t.prototype.parseFloat=function(e){var i=Number(e);return isNaN(i)&&typeof e=="string"&&e.includes(",")&&(i=Number(e.split(",").join(""))),i},t.prototype.rowIndex=function(e){var i=0,r=!1;if(i<e.length&&e[i]===this.sheetToken){for(i++;i<e.length&&e[i]!==this.sheetToken;)i++;i++}for(;i<e.length&&this.isChar(e[i]);)r=!0,i++;var n=parseInt(e.substring(i),10);if(i<e.length&&!this.isNaN(n))return n;if(r)return-1;throw this.formulaErrorStrings[me.BadIndex]},t.prototype.colIndex=function(e){var i=0,r=0;if(e=e.toUpperCase(),i<e.length&&e[i]===this.sheetToken){for(i++;i<e.length&&e[i]!==this.sheetToken;)i++;i++}for(;i<e.length&&this.isChar(e[i]);){var n=e[i].charCodeAt(0);r=r*26+n-64,i++}return r===0?-1:r},t.prototype.getErrorStrings=function(){return this.errorStrings===null&&(this.errorStrings=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!","#CALC!"]),this.errorStrings},t.prototype.substring=function(e,i,r){return e.substring(i,r+i)},t.prototype.isChar=function(e){return e.charCodeAt(0)>=65&&e.charCodeAt(0)<=90||e.charCodeAt(0)>=97&&e.charCodeAt(0)<=122},t.prototype.getSheetFamilyItem=function(e,i){return this.sheetFamilyID===0?(this.defaultFamilyItem==null&&(this.defaultFamilyItem=new vz),this.defaultFamilyItem):(this.sheetFamiliesList==null&&(this.sheetFamiliesList=new Map),i===void 0&&(i=this.modelToSheetID.get(e)),this.sheetFamiliesList.has(i)||this.sheetFamiliesList.set(i,new vz),this.sheetFamiliesList.get(i))},t.prototype.setKeyValue=function(e,i){e=e.toUpperCase();var r=i.toString().trim();(!this.storedData.get(e)||r.indexOf(this.leftBrace)===0)&&(this.storedData.set(e,new gz),this.keyToRowsMap.set(e,this.keyToRowsMap.size+1),this.rowsToKeyMap.set(this.rowsToKeyMap.size+1,e));var n=this.storedData.get(e);if(n.getFormulaText()!=null&&n.getFormulaText().length>0&&n.getFormulaText()!==r){var s=this.cellPrefix+this.keyToRowsMap.get(e).toString(),a=this.getDependentFormulaCells().get(s);a!=null&&this.clearFormulaDependentCells(s)}r.length>0&&r[0]===this.getFormulaCharacter()?n.setFormulaText(r):n.getFormulaValue()!==r&&(n.setFormulaText(""),n.setParsedFormula(""),n.setFormulaValue(r))},t.prototype.clearFormulaDependentCells=function(e){var i=this,r=this.getDependentFormulaCells().get(e);r&&(r.forEach(function(n,s){var a=s,l=i.getDependentCells().get(a);i.arrayRemove(l,e),l.length===0&&i.getDependentCells().delete(a)}),this.getDependentFormulaCells().delete(e))},t.prototype.arrayRemove=function(e,i){var r=e.indexOf(i);return r!==-1&&e.splice(r,1),e},t.prototype.getKeyValue=function(e){if(e=e.toUpperCase(),this.storedData.has(e)!==null){var i=this.storedData.get(e),r=i.getFormulaText();if(r.length>0&&r[0]===this.getFormulaCharacter()){this.cell=this.cellPrefix+this.keyToRowsMap.get(e).toString(),r=r.substring(1);try{i.setParsedFormula(this.parser.parseFormula(r,e))}catch(a){var n={message:a.message,exception:a,isForceCalculable:!1,computeForceCalculate:!1};return this.trigger("onFailure",n),i.setFormulaValue(n.message),this.storedData.get(e).getFormulaValue()}try{i.setFormulaValue(this.computeFormula(i.getParsedFormula()))}catch(a){var n={message:a.message,exception:a,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",n);var s=typeof n.exception=="string"?n.exception:n.message;return(g(this.getErrorLine(a))?"":"#"+this.getErrorLine(a)+": ")+s}}return this.storedData.get(e).getFormulaValue()}else return this.emptyString},t.prototype.getNamedRanges=function(){return this.namedRanges},t.prototype.addNamedRange=function(e,i){var r=e.split(this.sheetToken);if(r.length>1){var n=this.getSheetId(this.grid).toString(),s=this.getSheetFamilyItem(n);if(!s.parentObjectToToken.get(n))return!1;e=r[0]+this.sheetToken+r[1].toUpperCase()}else e=e.toUpperCase();return this.namedRanges.set(e,i),!0},t.prototype.updateNamedRange=function(e,i){var r=new Map;this.namedRanges.forEach(function(n,s){var a=s;if(s.includes(e)){var l=s.split("!");l[0]=i,a=l.join("!")}r.set(a,n)}),this.namedRanges=r},t.prototype.removeNamedRange=function(e){return e=e.toUpperCase(),this.namedRanges.get(e)!=null?(this.namedRanges.delete(e),!0):!1},t.prototype.convertAlpha=function(e){for(var i=[],r=0,n="A";e>0;){e--;var s=n.charCodeAt(0);i[r]=String.fromCharCode(e%26+s),e=parseInt((e/26).toString(),10),r++}for(var a=[],l=0;l<r;l++)a[r-l-1]=i[l];return a.join("")},t.prototype.getCellCollection=function(e){if(e.indexOf(":")<0)if(this.isCellReference(e))e=e+":"+e;else return e.split(this.getParseArgumentSeparator());var i=this.emptyString,r=e.indexOf(this.sheetToken);if(r>-1)for(var n=r,s=n+1;s<e.length;){if(e[s]===this.sheetToken){i=e.substr(0,s+1);break}s++}var a=e.indexOf(":"),l,h,c,u;if(a>0&&this.isChar(e[a-1]))for(var d=a-2;d>=0&&this.isDigit(e[d]);)d--;if(l=this.rowIndex(this.substring(e,0,a)),h=this.rowIndex(this.substring(e,a+1,a+e.length-a-1)),c=this.colIndex(this.substring(e,0,a)),u=this.colIndex(this.substring(e,a+1,a+e.length-a-1)),l>=ig||h>=ig||c>=rg||u>=rg)return[this.getErrorStrings()[W.Ref]];l>h&&(a=h,h=l,l=a),c>u&&(a=u,u=c,c=a);var p=[],f,v=0;for(a=l;a<=h;a++)for(f=c;f<=u;f++)p[v]=i+this.emptyString+this.convertAlpha(f)+a.toString(),v++;return p},t.prototype.computeFormula=function(e,i){return this.calculateFormula(e,!1,i)},t.prototype.calculateFormula=function(e,i,r){var n=this,s,a,l,h=!1,c;if(this.parser.isError)return e;this.parser.isFormulaParsed?s=e:s=this.parser.parseFormula(e),this.parser.isFormulaParsed=!1;try{if(a=this.findLastIndexOfq(s),a>0&&(h=!0),s!==this.emptyString&&a>-1)for(var u=a+1,d=function(){if(s[u]!==p.rightBracket)return u++,"continue";var y=s.substring(a,u+1),b=y.split(p.leftBracket)[0].split("q").join(p.emptyString),S=void 0;if(p.getLibraryFormulas().get(b.toUpperCase()).isCustom){S=y.substring(y.indexOf(p.leftBracket)+1,y.indexOf(p.rightBracket)).split(p.getParseArgumentSeparator());var C=0,x=[],I=void 0;for(C=0;C<S.length;C++)S[C].includes(":")&&p.isCellReference(S[C])?(I=p.getCellCollection(S[C]),I.length>1?(x.push(S[C]),I.forEach(function(k){n.updateDependentCell(k)})):x.push(p.getValueFromArg(S[C]))):x.push(p.getValueFromArg(S[C]));S=x}else{var D=y.substring(y.indexOf(p.leftBracket)+1,y.indexOf(p.rightBracket));S=[];for(var M=p.getParseArgumentSeparator(),E="",A=void 0,L=0,N=D.length-1;L<=N;L++)D[L]==='"'&&(A=!A),D[L]===M&&!A?(S.push(E),E="",L===N&&S.push(E)):(E+=D[L],L===N&&S.push(E));if(S.length||(S=[""]),h&&b){var R=["IF","INDEX","SORT","T","EXACT","PROPER","DOLLAR","DATE","TEXT"];R.some(function(k){return k===b})&&S.push("nestedFormulaTrue"),b==="IF"&&S.push("nestedFormulaTrue")}r&&b==="UNIQUE"&&S.push("isComputeExp")}if(l=g(p.getFunction(b))?p.getErrorStrings()[W.Name]:p.getFunction(b).apply(void 0,S),h){c=p.processNestedFormula(s,y,l);var P=p.findLastIndexOfq(c);return P===0&&(h=!1),P===-1&&(l=p.computeValue(c,i)),a=u=P,s=c,"continue"}return"break"},p=this;u>-1;){var f=d();if(f==="break")break}else this.formulaErrorStrings.indexOf(s)>-1?l=s:s!==this.emptyString&&a===-1&&(l=this.computeValue(s,i))}catch(y){var v={message:y.message,exception:y,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",v);var m=typeof v.exception=="string"?v.exception:v.message;l=(g(this.getErrorLine(y))?"":"#"+this.getErrorLine(y)+": ")+m}return l},t.prototype.computeSumIfAndAvgIf=function(e,i){if(g(e)||e[0]===this.emptyString||e.length===0)return this.formulaErrorStrings[me.WrongNumberArguments];for(var r=e,n=0;n<r.length;n++)if(this.isCellReference(r[n])&&g(r[n].match(/[0-9]/))&&r[n].indexOf("!")<0){var s=r[n].split(":");r[n]=s[0]+"1:"+s[1]+this.spreadSheetUsedRange[0]}var a=r.length;if(a!==2&&a!==3&&a===0)return this.formulaErrorStrings[me.WrongNumberArguments];if(r[1]==="")return i?this.getErrorStrings()[W.DivZero]:"0";var l=r[0],h=r[1].startsWith(this.tic)&&r[1].endsWith(this.tic),c=this.getANDComputedValue(r[1]);if(c.length>255)return this.getErrorStrings()[W.Value];var u=c.includes("*"),d=c.includes("?"),p=u?c.replace(/\*/g,"").trim():c,f=!1;if(!h&&this.isCellReference(p)&&(p=this.getValueFromArg(p),f=!0),u){var v=c.indexOf("*");c[0]==="*"&&(p="*"+p),c[c.length-1]==="*"&&(p+="*"),v>0&&v<c.length-1&&(p=c.substring(0,v)+"*"+c.substring(v+1))}c=p;var m=this.parser.tokenEqual;c.startsWith("<=")?(m=this.parser.tokenLessEq,c=c.substring(2)):c.startsWith(">=")?(m=this.parser.tokenGreaterEq,c=c.substring(2)):c.startsWith("<>")?(m=this.parser.tokenNotEqual,c=c.substring(2)):c.startsWith("<")?(m=this.parser.tokenLess,c=c.substring(1)):c.startsWith(">")?(m=this.parser.tokenGreater,c=c.substring(1)):c.startsWith("=")&&(m=this.parser.tokenEqual,c=c.substring(1)),(!h&&this.isCellReference(c)&&!f||c.includes(this.arithMarker)||c.includes(this.getParseDecimalSeparator())&&!u&&!d)&&(c=this.getValueFromArg(c));var y=this.parseFloat(c),b=r[0],S=this.getCellCollection(a>2?r[2]:l),C=this.getCellCollection(b);if(S[0]==="#REF!"||C[0]==="#REF!")return this.getErrorStrings()[W.Name];if(C.length>S.length){var x=this.colIndex(S[S.length-1])+this.colIndex(C[C.length-1])-this.colIndex(C[0]),I=r[2].split(":");if(I[1]=(this.convertAlpha(x)+this.rowIndex(C[C.length-1])).toString(),S=this.getCellCollection(I.join(":")),S[0]==="#REF!")return this.getErrorStrings()[W.Name]}var D=this.getComputeSumIfValue(C,S,c.toLowerCase(),y,m,u,d);return[D[0],D[1]]},t.prototype.computeLookup=function(e){var i,r,n,s,a=[],l=[],h=[],c=[],u,d,p=[],f=e,v=f.length;if(v===1||v>3)return this.formulaErrorStrings[me.WrongNumberArguments];if(f[1]===""||f[2]==="")return this.getErrorStrings()[W.Value];if(u=this.getValueFromArg(f[0]),f[0].indexOf(this.tic)>-1&&f[0].toUpperCase().split(this.tic).join("")!==this.trueValue&&f[0].toUpperCase().split(this.tic).join("")!==this.falseValue&&this.isNaN(this.parseFloat(f[0].split(this.tic).join("")))&&(u=u.split(this.tic).join("")),this.getErrorStrings().indexOf(u)>-1)return u;var m=f[1].split(":");if(m.length===2&&this.isCellReference(m[0])&&this.isCellReference(m[1])&&v===2){var y=f[1].indexOf(":"),b=this.rowIndex(this.substring(f[1],0,y)),S=this.colIndex(this.substring(f[1],0,y)),C=this.rowIndex(this.substring(f[1],y+1,y+f[1].length-y-1)),x=this.colIndex(this.substring(f[1],y+1,y+f[1].length-y-1));b>C&&(i=[C,b],b=i[0],C=i[1]),S>x&&(r=[x,S],S=r[0],x=r[1]);var I="";f[1].indexOf("!")===0&&(I=f[1],I=I.replace("!",""),I=I.indexOf("!"),I=f[1].substring(0,I+2));var D=x-S+1,M=C-b+1;M>D||M===D?(n=I+li(S)+b+":"+li(S)+C,s=I+li(x)+b+":"+li(x)+C):M<D&&(n=I+li(S)+b+":"+li(x)+b,s=I+li(S)+C+":"+li(x)+C),(b!==C||S!==x)&&(d=!0)}if(d){if(a=this.getCellCollection(n),l=this.getCellCollection(s),a[0]==="#REF!"||l[0]==="#REF!")return this.getErrorStrings()[W.Name]}else{a=this.getCellCollection(f[1]);var E=v===2?f[1]:f[2];if(l=this.getCellCollection(E),a[0]==="#REF!"||l[0]==="#REF!")return this.getErrorStrings()[W.Name];var A=ie(f[1]),L=ie(E),N=A[1]===A[3]?!0:A[0]===A[2],R=L[1]===L[3]?!0:L[0]===L[2];if(!N||!R)return this.getErrorStrings()[W.NA]}for(var P=0;P<a.length;P++)c.push(this.getValueFromArg(a[P]).split(this.tic).join(""));var k=c.map(function(ne){return ne===""?NaN:Number(ne)}).sort(function(ne,le){return ne-le}),B=k[k.length-1],F=k[0],O=this.parseFloat(u);if(this.isNaN(O)){for(var Y=0;Y<a.length;Y++)if(h[Y]=this.getValueFromArg(a[Y]).split(this.tic).join(""),!g(l[Y])&&u!==""&&h[Y]!==""){if(u.toUpperCase()===h[Y].toUpperCase())p.push(this.getValueFromArg(l[Y]).split(this.tic).join("")||"0");else if(u.indexOf("*")>-1||u.indexOf("?")>-1){var K=u;if(u.indexOf("*")>-1){K=K.replace(/\*/g,"").trim(),this.isCellReference(K)&&(K=this.getValueFromArg(K));var U=u.indexOf("*");u[0]==="*"&&(K="*"+K),u[u.length-1]==="*"&&(K+="*"),U>0&&U<u.length-1&&(K=u.substring(0,U)+"*"+u.substring(U+1))}var q=[],ae=this.findWildCardValue(K.toLowerCase(),h[Y].toLowerCase());q.push(ae),q.push(u),this.processLogical(q,"equal")===this.trueValue&&p.push(this.getValueFromArg(l[Y]).split(this.tic).join("")||"0")}}}else for(var z=0;z<k.length;z++)h[z]=k[z].toString().split(this.tic).join(""),!g(l[z])&&h[z]!==""&&O===this.parseFloat(h[z])&&p.push(this.getValueFromArg(l[z]).split(this.tic).join("")||"0");if(p.length>0)return p[p.length-1];if(O>B&&!g(l[a.length-1]))return this.getValueFromArg(l[a.length-1]).split(this.tic).join("")||"0";if(O<F)return this.getErrorStrings()[W.NA];if(c.indexOf(u.split(this.tic).join(""))<0&&u!==this.trueValue&&u!==this.falseValue){if(!this.isNaN(O)&&!this.isNaN(B)&&!this.isNaN(F)){for(var te=[],he=0;he<k.length;he++)O>k[he]&&te.push(k[he]);var y=te.length-1;if(!g(l[y])&&y>=0)return this.getValueFromArg(l[y]).split(this.tic).join("")||"0"}else if(this.isNaN(O)&&u!==""&&/^[a-zA-Z!@#$%^&*()_+{}[\]:;<>,.?~\\/-]/.test(u)){var ue=c.sort(),y=this.findClosestMatch(u.split(this.tic).join(""),ue);if(!g(l[y])&&y>=0)return this.getValueFromArg(l[y]).split(this.tic).join("")||"0"}}return this.getErrorStrings()[W.NA]},t.prototype.computeVHLookup=function(e,i){var r=this,n,s,a=e;if(g(a)||a.length<3||a.length>4)return this.formulaErrorStrings[me.WrongNumberArguments];if(a[1]==="")return this.getErrorStrings()[W.NA];var l=this.getValueFromArg(a[0]);if(l){if(l.includes(this.tic)){var h=l.split(this.tic).join("");if(h&&!this.isNumber(h)){var c=h.toUpperCase();c!==this.trueValue&&c!==this.falseValue&&(l=h)}}}else l="0";var u=this.getErrorStrings();if(u.indexOf(l)>-1)return l;var d=(this.getValueFromArg(a[2])||"0").split(this.tic).join("").toUpperCase(),p=this.parseFloat(d===this.trueValue?"1":d);if(p<1)return u[W.Value];var f;if(a[3]){if(a[3]=this.getValueFromArg(a[3]).split(this.tic).join(""),u.indexOf(a[3])>-1)return a[3];var v=a[3].toUpperCase();if(v===this.falseValue||a[3]==="0")f=!0;else if(!(v===this.trueValue||a[3]==="1"))return u[W.Value]}var m=a[1].split(":"),y,b,S,C,x,I;if(this.isCellReference(m[0])&&this.isCellReference(m[1])){var D=this.rowIndex(m[0]),M=this.colIndex(m[0]),E=this.rowIndex(m[1]),A=this.colIndex(m[1]);if(D>E&&(n=[E,D],D=n[0],E=n[1]),M>A&&(s=[A,M],M=s[0],A=s[1]),!(D>0&&E<=ig&&M>0&&A<=rg))return this.getErrorStrings()[W.Name];C=this.grid;var L="",N=this.getSheetFamilyItem(C);a[1].startsWith("!")?(L=a[1].substring(0,a[1].replace("!","").indexOf("!")+2),N.tokenToParentObject!==null&&(this.grid=N.tokenToParentObject.get(L))):N.parentObjectToToken!==null&&(L=N.parentObjectToToken.get(C));var R=this.getSheetId(this.grid),P={action:"getSheetInfo",sheetInfo:[]};if(this.parentObject.notify(At,P),uM(this.parentObject,"Sheet"+R,P.sheetInfo)===-1)return this.grid=C,u[W.Ref];var k=this.getCellValueFn(C,this.cell,R,!0);if(i){var B=M+p-1;if(B>A)return u[W.Ref];y=D,b=E;var F=L+li(M);x=function(je){return k(je,M,F+je)};var O=L+li(B);I=function(){return k(S,B,O+S)||"0"}}else{var z=D+p-1;if(z>E)return u[W.Ref];y=M,b=A;var Y;x=function(je){return Y=L+li(je),k(D,je,Y+D)},I=function(){return k(z,S,Y+z)||"0"}}}else return u[W.Value];var K,U,q=[];if(f){var ae=void 0;if(this.isNumber(l)){var te=this.parseFloat(l);ae=function(){return te===r.parseFloat(U)}}else if(l.includes("*")||l.includes("?")){var he=l,ue=l.indexOf("*");ue>-1&&(he=he.replace(/\*/g,"").trim(),this.isCellReference(he)&&(he=this.getValueFromArg(he)),ue===0?he="*"+he:ue===l.length-1?he+="*":he=l.substring(0,ue)+"*"+l.substring(ue+1)),he=he.toLowerCase(),ae=function(){return r.processLogical([r.findWildCardValue(he,U.toLowerCase()),l],"equal")===r.trueValue}}else{var ne=l.toUpperCase();ae=function(){return ne===U.toUpperCase()}}for(S=y;S<=b;S++)U=x(S),U&&ae()&&q.push(I());K=q.length?q[0]:u[W.NA]}else if(l.indexOf("*")>-1||l.indexOf("?")>-1)K=u[W.NA];else{var le,$=void 0;if(this.isNumber(l)){var ee=this.parseFloat(l),He=ge.fnSort("");$=function(){le=He(r.isNumber(U)?r.parseFloat(U):U||null,ee)}}else{var qe=new Intl.Collator(this.parentObject.locale||"en-US",{sensitivity:"base"});$=function(){le=!U||r.isNumber(U)?null:qe.compare(U,l)}}var we=void 0;for(S=y;S<=b;S++)U=x(S),we||($(),le===0||le<0?q.push(I()):le>0&&q.length&&(we=!0));K=q.length?q[q.length-1]:u[W.NA]}return this.grid=C,K},t.prototype.findClosestMatch=function(e,i){for(var r=0,n=i.length-1;r<=n;){var s=Math.floor((r+n)/2),a=i[s],l=this.compareStrings(e.toLowerCase(),a.toLowerCase());if(l===0)return s;l===1?r=s+1:n=s-1}for(var h=r-1;h>=0;h--)if(this.compareStrings(e.toLowerCase(),i[h].toLowerCase())!==-1)return h;return-1},t.prototype.compareStrings=function(e,i){for(var r=Math.min(e.length,i.length),n=0;n<r;n++){var s=e.charCodeAt(n),a=i.charCodeAt(n);if(s<a)return-1;if(s>a)return 1}return e.length<i.length?-1:e.length>i.length?1:0},t.prototype.findWildCardValue=function(e,i){var r="";if(e.indexOf("?")>-1){var n=RegExp(e.replace(/\?/g,"[\\s\\S]"));i.length===e.length&&this.isNaN(this.parseFloat(i))&&i.match(n)?r=e:r=i}else if(e.indexOf("*")>-1){for(var s=e.indexOf("*"),a="",l="",h=this.falseValue,c=this.falseValue,u=s-1;u>=0;u--)a=a+e[u],c=this.trueValue;for(var u=s+1;u<e.length;u++)l=l+e[u],h=this.trueValue;var d=a===""?-1:i.indexOf(a.split("").reverse().join("")),p=l===""?-1:i.indexOf(l);if(d>-1||p>-1){var f=a.split("").reverse().join("")===i.substr(0,a.length),v=l===i.substring(i.length-l.length,i.length);c===this.trueValue&&h===this.trueValue&&this.isNaN(this.parseFloat(a))&&this.isNaN(this.parseFloat(l))?r=f&&v?e:i:c===this.trueValue&&this.isNaN(this.parseFloat(a))?r=f?e:i:h===this.trueValue&&this.isNaN(this.parseFloat(l))&&(r=v?e:i)}else{if(e.startsWith("*")&&e.endsWith("*")){var m=e.slice(1,-1);m!==""&&i.includes(m)&&this.isNaN(this.parseFloat(m))&&(i=e)}r=i}}return r},t.prototype.getComputeSumIfValue=function(e,i,r,n,s,a,l){var h=0,c=0;switch(s){case this.parser.tokenEqual:for(var u=a?r.replace(/\*/g,""):r,d=0;d<e.length;d++){var p=this.getValueFromRange(i,d),f=this.getValueFromArg(e[d].split(this.tic).join("")).toLowerCase(),v=this.parseFloat(f);if(f===r&&v===n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}else if(f===r)this.isNaN(p)||(h=h+p,c=c+1);else if(a&&u&&f&&this.isNaN(this.parseFloat(f))){var b=r.indexOf("*");r[0]==="*"&&u.length<=f.length&&u===f.slice(f.length-u.length,f.length)?this.isNaN(p)||(h=h+p,c=c+1):r[r.length-1]==="*"&&u.length<=f.length&&u===f.slice(0,u.length)?this.isNaN(p)||(h=h+p,c=c+1):b>-1&&f.startsWith(r.substr(0,b))&&f.endsWith(r.substr(b+1))&&(this.isNaN(p)||(h=h+p,c=c+1))}else if(a&&!u&&f&&this.isNaN(this.parseFloat(f)))this.isNaN(p)||(h=h+p,c=c+1);else if(l&&u&&f&&this.isNaN(this.parseFloat(f))){var S=RegExp(u.replace(/\?/g,"[\\s\\S]"));f.length===r.length&&f.match(S)&&(this.isNaN(p)||(h=h+p,c=c+1))}}break;case this.parser.tokenLess:for(var d=0;d<e.length;d++){var f=this.getValueFromArg(e[d].split(this.tic).join("")),v=this.parseFloat(f);if(v<n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}}break;case this.parser.tokenGreater:for(var d=0;d<e.length;d++){var f=this.getValueFromArg(e[d].split(this.tic).join("")),v=this.parseFloat(f);if(v>n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}}break;case this.parser.tokenLessEq:for(var d=0;d<e.length;d++){var f=this.getValueFromArg(e[d].split(this.tic).join("")),v=this.parseFloat(f);if(v<=n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}}break;case this.parser.tokenGreaterEq:for(var d=0;d<e.length;d++){var f=this.getValueFromArg(e[d].split(this.tic).join("")),v=this.parseFloat(f);if(v>=n){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}}break;case this.parser.tokenNotEqual:for(var u=a?r.replace(/\*/g,""):r,d=0;d<e.length;d++){var p=this.getValueFromRange(i,d),f=this.getValueFromArg(e[d].split(this.tic).join("")).toLowerCase(),v=this.parseFloat(f);if(f!==r&&v!==n&&!a&&!l){var m=this.getValueFromArg(i[d].split(this.tic).join("")),y=this.parseFloat(m);this.isNaN(y)||(h=h+y,c=c+1)}else if(a&&u&&f&&this.isNaN(this.parseFloat(f))){var b=r.indexOf("*");r[0]==="*"&&u.length<=f.length&&u!==f.slice(f.length-u.length,f.length)?this.isNaN(p)||(h=h+p,c=c+1):r[r.length-1]==="*"&&u.length<=f.length&&u!==f.slice(0,u.length)?this.isNaN(p)||(h=h+p,c=c+1):(b>-1&&!f.startsWith(r.substr(0,b))||!f.endsWith(r.substr(b+1)))&&(this.isNaN(p)||(h=h+p,c=c+1))}else if(a&&!u&&!this.isNaN(this.parseFloat(f)))this.isNaN(p)||(h=h+p,c=c+1);else if(l&&u&&f&&this.isNaN(this.parseFloat(f))){var S=RegExp(u.replace(/\?/g,"[\\s\\S]"));(f.length!==r.length||!f.match(S))&&(this.isNaN(p)||(h=h+p,c=c+1))}}break}return[h,c]},t.prototype.getValueFromRange=function(e,i){var r=e[i];return r=this.getValueFromArg(r),this.parseFloat(r.toString())},t.prototype.computeAndOrNot=function(e,i){for(var r=this,n=i==="and",s=i==="or",a=i==="not",l=!!(n||a),h,c,u=[],d=e,p=0;p<d.length;p++){if(d[p]===this.tic)return this.getErrorStrings()[W.Value];if(this.isCellReference(d[p]))for(var f=this.getCellCollection(d[p]),v=0;v<f.length;v++){if(this.getErrorStrings().indexOf(f[v])>-1)return f[v];if(f[v][0]===this.tic)return this.getErrorStrings()[W.Name];if(h=this.getValueFromArg(f[v]),this.getErrorStrings().indexOf(h)>-1)return h;c=this.parseFloat(h),h===this.falseValue||h!==""&&c===0||a&&h===""?u.push(this.falseValue):h===this.trueValue||!isNaN(c)&&h!==""?u.push(this.trueValue):(h===""||isNaN(c))&&u.push(this.getErrorStrings()[W.Value])}else{if(h=this.getValueFromArg(d[p]).split(this.tic).join("").toUpperCase(),this.getErrorStrings().indexOf(h)>-1)return h;c=this.parseFloat(h),h===this.falseValue||d[p]===""||h!==""&&c===0?u.push(this.falseValue):h===this.trueValue||!isNaN(c)&&h!==""?u.push(this.trueValue):(h===""||isNaN(c))&&u.push(this.getErrorStrings()[W.Value])}}var m=u.every(function(y){return y===r.getErrorStrings()[W.Value]});if(m)return this.getErrorStrings()[W.Value];for(var v=0;v<u.length;v++){if((n||a)&&u[v]===this.falseValue){l=!1;break}if(s&&u[v]===this.trueValue){l=!0;break}}return l=a?!l:l,l?this.trueValue:this.falseValue},t.prototype.removeTics=function(e){return e.length>1&&e[0]===this.tic[0]&&e[e.length-1]===this.tic[0]&&(e=this.substring(e,1,e.length-2)),e},t.prototype.getCellFrom=function(e){var i="",r=e.indexOf(":")>-1?e.split(":"):[e],n=r.length-1,s=this.rowIndex(r[0]),a;if(s===this.rowIndex(r[n])){var l=this.colIndex(r[0]),h=this.colIndex(r[n]),c=this.colIndex(this.cell);c>=l&&c<=h&&(i=li(c).toString()+s.toString())}else if(this.colIndex(r[0])===this.colIndex(r[n])){a=this.colIndex(r[0]);var u=this.rowIndex(r[n]),d=this.rowIndex(this.cell);d>=s&&d<=u&&(i=li(a).toString()+d.toString())}return i},t.prototype.computeValue=function(e,i,r){try{var n=[],s=0,a="";n.length=0;for(var l=this.getParseDecimalSeparator();s<e.length;){var h=e[s]==="u";if(h&&(s=s+1),e[s]===this.arithMarker){s=s+1;continue}else if(this.isDigit(e[s])){for(var c=this.emptyString;s<e.length&&(this.isDigit(e[s])||e[s]===l);)c+=e[s]===l?".":e[s],s=s+1;if(n.push(c),!e[s])return n.toString()}if(e[s]===this.sheetToken){for(a=e[s],s=s+1;s<e.length&&e[s]!==this.sheetToken;)a=a+e[s],s=s+1;s<e.length&&(a=a+e[s],s=s+1)}else if(this.isUpperChar(e[s])){for(var c=this.emptyString,u="";s<e.length&&this.isUpperChar(e[s]);){var d=e[s];c=c+d,s=s+1}for(;s<e.length&&this.isDigit(e[s]);){var p=e[s];c=c+p,s=s+1}if(s<e.length&&e[s]===":"){if(c=c+e[s],s=s+1,s<e.length&&e[s]===this.sheetToken)for(c=c+e[s],s=s+1;s<e.length&&e[s]!==this.sheetToken;)c=c+e[s],s=s+1;for(;s<e.length&&this.isUpperChar(e[s]);)c=c+e[s],s=s+1;for(;s<e.length&&this.isDigit(e[s]);)c=c+e[s],s=s+1;c=a+this.getCellFrom(c)}else c=a+c;if(u=this.getParentObjectCellValue(c,i).toString(),a="",typeof u=="string"&&this.getErrorStrings().indexOf(u)>-1)return u;h&&(this.isNaN(this.parseFloat(u))?u="-"+u:u=(-this.parseFloat(u)).toString()),n.push(u)}else if(e[s]==="q"){var f=e.substring(s+1).indexOf(this.leftBracket),v=e.substring(s+f+1).indexOf(this.rightBracket);e=this.substring(e,s+f+2,v-1)}else if(e[s]===this.tic[0]){var c=e[s].toString();for(s=s+1;s<e.length&&e[s]!==this.tic[0];)c=c+e[s],s=s+1;var u=c.split(this.tic).join(this.emptyString);u===this.trueValue||u===this.falseValue||!this.isNaN(this.parseFloat(u))&&u!==""?n.push(this.tic+u+this.tic):n.push(u),s=s+1}else if(e[s]==="%"&&n.length>0){var m=n[0],y=this.parseFloat(m);this.isNaN(y)||(n.pop(),n.push((y/100).toString())),s=s+1}else if(e.substring(s).indexOf(this.trueValue)===0)n.push(this.trueValue),s+=this.trueValue.length;else if(e.substring(s).indexOf(this.falseValue)===0)n.push(this.falseValue),s+=this.falseValue.length;else if(e[s]===this.tic[0]||e[s]==="|"){var c=e[s].toString();for(s++;s<e.length&&e[s]!==this.tic[0];)c=c+e[s],s=s+1;n.push(c+this.tic),s+=1}else{if(e[s]===" "&&s<e.length-1){s+=1;continue}switch(e[s]){case"#":{var b=0;this.getErrorStrings().indexOf(e.substring(s))>-1?(e.indexOf("!")===-1||e.substring(s).indexOf("!")===-1?b=e.indexOf("#N/A")>-1?e.indexOf("#N/A")+4+s:e.indexOf("?")+1+s:b=e.indexOf("!")+1+s,n.push(this.substring(e,s,b-s))):(b=s+1,n.push(this.substring(e,s,b-s))),s=b}break;case"n":{s=s+1;var c="";if(e[s]==="n")continue;if(e.substring(s).indexOf("Infinity")===0)c="Infinity",s+=c.length;else{for((e[s]==="u"||h||e[s]==="-")&&(c="-",h?h=!1:s=s+1);s<e.length&&(this.isDigit(e[s])||e[s]===l||e[s]===".");)c+=e[s]===l?".":e[s],s=s+1;if(s<e.length&&e[s]==="%")if(s=s+1,c===""){if(n.length>0){var m=n[0],y=this.parseFloat(m);this.isNaN(y)||(n.pop(),n.push((y/100).toString()))}}else c=(this.parseFloat(c)/100).toString()}c&&n.push(c)}break;case this.parser.tokenAdd:this.getValArithmetic(n,"add",r),s=s+1;break;case this.parser.tokenSubtract:this.getValArithmetic(n,"sub",r),s=s+1;break;case this.parser.tokenMultiply:this.getValArithmetic(n,"mul",r),s=s+1;break;case this.parser.tokenDivide:this.getValArithmetic(n,"div",r),s=s+1;break;case this.parser.tokenLess:this.processLogical(n,"less"),s=s+1;break;case this.parser.tokenGreater:this.processLogical(n,"greater"),s=s+1;break;case this.parser.tokenGreaterEq:this.processLogical(n,"greaterEq"),s=s+1;break;case this.parser.tokenLessEq:this.processLogical(n,"lessEq"),s=s+1;break;case this.parser.tokenNotEqual:this.processLogical(n,"notEq"),s=s+1;break;case this.parser.tokenOr:this.processLogical(n,"or"),s=s+1;break;case this.parser.tokenAnd:this.processLogical(n,"and"),s=s+1;break;case this.parser.tokenEqual:this.processLogical(n,"equal"),s=s+1;break;default:return this.getErrorStrings()[W.Value]}}}if(n.length===0)return this.emptyString;for(var c=this.emptyString,S=n.length;S>0;){var C=n.pop();if(this.getErrorStrings().indexOf(C)>-1)return C;if(c=C+c,c===this.emptyString&&this.isCellReference(e)&&this.getTreatEmptyStringAsZero())return"0";S--}return c}catch(x){throw this.getErrorStrings().indexOf(x)>-1||this.formulaErrorStrings.indexOf(x)>-1?x:new bs(this.formulaErrorStrings[me.InvalidExpression])}},t.prototype.getValArithmetic=function(e,i,r){var n=!1,s=e.pop(),a=s.indexOf(".")!==-1?s.split(".")[1].length:0,l=Math.pow(10,a),h=e.pop(),c=h.indexOf(".")!==-1?h.split(".")[1].length:0,u=Math.pow(10,c),d=l>=u?l:u,p=l*u;s=s===this.trueValue?"1":s===this.falseValue?"0":s,s=s===this.emptyString?"0":this.getErrorStrings().indexOf(s.toString())<0?this.parseFloat(s+"").toString():s;var f=Number(s);isNaN(f)&&!r&&(n=!0,s===this.getErrorStrings()[W.DivZero]?e.push(this.getErrorStrings()[W.DivZero]):e.push(this.getErrorStrings()[W.Value])),h=h===this.trueValue?"1":h===this.falseValue?"0":h,h=h===this.emptyString?"0":this.getErrorStrings().indexOf(h.toString())<0?this.parseFloat(h+"").toString():h,f=Number(h),isNaN(f)&&!r&&(n=!0,h===this.getErrorStrings()[W.DivZero]?e.push(this.getErrorStrings()[W.DivZero]):e.push(this.getErrorStrings()[W.Value])),i==="add"&&!n&&e.push(((Number(h)*d+Number(s)*d)/d).toString()),i==="sub"&&!n&&e.push(((Number(h)*d-Number(s)*d)/d).toString()),i==="mul"&&!n&&e.push((Number(h)*u*(Number(s)*l)/p).toString()),i==="div"&&!n&&(this.isNaN(this.parseFloat(s))||this.isNaN(this.parseFloat(h))?e.push(this.getErrorStrings()[W.Value]):this.parseFloat(s)===0?e.push(this.getErrorStrings()[W.DivZero]):e.push((Number(h)*p/(Number(s)*p)).toString()))},t.prototype.processLogical=function(e,i){var r,n,s,a,l,h,c=!1;return i!=="and"&&i!=="equal"&&(r=e.pop(),n=e.pop(),this.getErrorStrings().indexOf(r)>-1?(h=r,c=!0):this.getErrorStrings().indexOf(n)>-1&&(h=n,c=!0),this.isNaN(this.parseFloat(r))&&this.isNaN(this.parseFloat(n))&&(r=r.toString().toLowerCase(),n=n.toString().toLowerCase()),g(r)||(s=r.indexOf(this.tic)>-1?r:this.parseFloat(r)),g(n)||(a=n.indexOf(this.tic)>-1?n:this.parseFloat(n)),r==="*"&&this.isNaN(this.parseFloat(n))&&n!==""&&(l=!0)),i==="less"&&!c&&(!this.isNaN(s)&&!this.isNaN(a)?h=a<s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))<0?this.trueValue:this.falseValue),i==="greater"&&!c&&(!this.isNaN(s)&&!this.isNaN(a)?h=a>s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))>0?this.trueValue:this.falseValue),i==="lessEq"&&!c&&(!this.isNaN(s)&&!this.isNaN(a)?h=a<=s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))<=0?this.trueValue:this.falseValue),i==="greaterEq"&&!c&&(!this.isNaN(s)&&!this.isNaN(a)?h=a>=s?this.trueValue:this.falseValue:h=n.toUpperCase().split(this.tic).join("").localeCompare(r.toUpperCase().split(this.tic).join(""))>=0?this.trueValue:this.falseValue),i==="notEq"&&!c&&(h=n!==r?this.trueValue:this.falseValue,l&&(h=this.falseValue)),i==="and"&&!c&&(r=e.pop().toString(),n="",e.length>0&&(n=e.pop().toString()),this.getErrorStrings().indexOf(r)>-1?h=r:this.getErrorStrings().indexOf(n)>-1?h=n:(h=this.emptyString+n+r+this.emptyString,h=h.split(this.tic).join(""))),i==="equal"&&!c&&(r=e.pop(),n=e.pop(),this.getErrorStrings().indexOf(r)>-1?h=r:this.getErrorStrings().indexOf(n)>-1?h=n:(this.isNaN(this.parseFloat(r))&&this.isNaN(this.parseFloat(n))&&(r=r.toString().toLowerCase(),n=n.toString().toLowerCase()),r==="*"&&this.isNaN(this.parseFloat(n))&&n!==""&&(l=!0),h=r===n||l?this.trueValue:this.falseValue)),i==="or"&&!c&&(h=Math.pow(this.parseFloat(a),this.parseFloat(s)).toString(),h=this.isNaN(this.parseFloat(h))?this.getErrorStrings()[W.Value]:h),e.push(h),h},t.prototype.computeStoreCells=function(e){for(var i=e.cellValue,r=e.cellRange,n=e.criteria,s=e.argArray,a=e.isCriteria,l=e.storedCells,h=e.isCountIfS===this.trueValue,c=e.countVal||0,u=a===this.trueValue?l:i,d=[],p,f=0;f<u.length;f++){var v=[],m=this.getValueFromArg(i[f]),y=s[h?1+c*2:2+c],b=y.startsWith(this.tic)&&y.endsWith(this.tic);p=this.getANDComputedValue(y.trim());var S=p.includes("*"),C=p==="*"||p==="<>*",x=S&&!C?p.replace(/\*/g,"").trim():p,I=!1;if(!b&&this.isCellReference(x)&&(x=this.getValueFromArg(x),I=!0),S&&!C){var D=p.indexOf("*");p[0]==="*"&&(x="*"+x),p[p.length-1]==="*"&&(x+="*"),D>0&&D<p.length-1&&(x=p.substring(0,D)+"*"+p.substring(D+1))}p=x;var M="";if(a=h?this.trueValue:a,a===this.trueValue){var E="",A=0,L=0,N=void 0,R=void 0,P=void 0,k=void 0;l[f]=h&&!c?i[f]:l[f],E=l[f],c&&(N=r[c-1],R=N.indexOf("!")>-1?ie(N.substring(N.lastIndexOf("!")+1)):ie(N),P=E.indexOf("!")>-1?xe(E.substring(E.lastIndexOf("!")+1)):xe(E),k=r[c].indexOf("!")>-1?ie(r[c].substring(r[c].lastIndexOf("!")+1)):ie(r[c]));var B=E.indexOf("!")>-1,F=void 0,O="",z="";for(B&&(z=E.substring(0,E.lastIndexOf("!")+1),E=E.substring(E.lastIndexOf("!")+1));!this.isDigit(E[A]);)A=A+1;if(this.isCellReference(r[c])&&r[c].indexOf(":")>-1)for(M=h&&!c?u[f].indexOf("!")>-1?u[f].substring(u[f].lastIndexOf("!")+1):u[f]:st(k[0]+(P[0]-R[0]),k[1]+(P[1]-R[1])),F=r[c].indexOf("!")>-1,F&&(O=r[c].substring(0,r[c].lastIndexOf("!")+1));!this.isDigit(M[L]);)L=L+1;var Y=this.substring(E,A),K=this.substring(M,L),U=this.substring(E,A,E.length-A),q=this.substring(M,L,M.length-A);B&&(Y=z+Y,K=z+K),U!==q&&(l[f]=this.substring(l[f],B?z.length+A:A)+q),M=l[f].split(Y).join(K),F?(M.indexOf("!")>-1&&(M=M.substring(M.lastIndexOf("!")+1)),M=O+M):M=M.substring(M.lastIndexOf("!")+1),m=this.getValueFromArg(M),p=h?p:this.getANDComputedValue(n[c-1])}var ae="equal",te=this.getOperatorAndCriteria(p,ae);ae=te.op,p=te.criteria,(!b&&this.isCellReference(p)&&(!I||M!==""&&!h)||p.includes(this.arithMarker))&&(p=this.getValueFromArg(p)),(p.indexOf("*")>-1||p.indexOf("?")>-1)&&(m=this.findWildCardValue(p.toLowerCase(),m.toLowerCase())),v.push(m.toLowerCase()),v.push(p.toLowerCase()),this.processLogical(v,ae)===this.trueValue&&(a===this.falseValue?d.push(i[f]):d.push(M))}return l=d,d=[],l},t.prototype.computeIfsFormulas=function(e,i,r){if(i===this.trueValue&&(g(e)||e[0]===""||e.length<2||e.length>127||e.length%2!==0))return this.formulaErrorStrings[me.WrongNumberArguments];for(var n=e,s=[],a=[],l=[],h=0,c=0,u=0;u<n.length;u++)n[u].indexOf(":")>-1&&this.isCellReference(n[u])?s.push(n[u].trim()):a.push(n[u].trim());for(var d=[],u=0;u<s.length;u++)d.push(this.getCellCollection(s[u]).length);for(var p=0;p<d.length;p++)if(d[p]&&d[p+1]&&d[p]!==d[p+1])return this.getErrorStrings()[W.Value];for(var f=0;f<a.length;f++)if(a[f]==="")return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0;var v,m;if(i===this.falseValue){m=this.falseValue,v=this.getCellCollection(s[1]);var y={cellValue:v,cellRange:s,criteria:a,argArray:n,isCriteria:m,storedCells:l,isCountIfS:i};if(l=this.computeStoreCells(y),h=l.length,h===0)return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0}for(var b=i===this.trueValue?0:2,u=b;u<s.length;u++){m=this.trueValue,m=i===this.trueValue&&u===0?this.falseValue:this.trueValue,v=this.getCellCollection(s[u]);var y={cellValue:v,cellRange:s,criteria:a,argArray:n,isCriteria:m,storedCells:l,isCountIfS:i,countVal:u};if(l=this.computeStoreCells(y),h=l.length,h===0)return r===this.trueValue?this.getErrorStrings()[W.DivZero]:0}for(var S=0,C=s[0].indexOf("!")>-1?ie(s[0].substring(s[0].lastIndexOf("!")+1)):ie(s[0]),x=s[s.length-1],I=x.indexOf("!")>-1?ie(x.substring(x.lastIndexOf("!")+1)):ie(x),p=0;p<l.length;p++){var D="",M="",E=0,A=0;D=l[p];var L=D.indexOf("!")>-1,N=void 0,R="",P="";for(L&&(P=D.substring(0,D.lastIndexOf("!")+1),D=D.substring(D.lastIndexOf("!")+1));!this.isDigit(D[E]);)E=E+1;if(this.isCellReference(s[0])&&s[0].indexOf(":")>-1)for(M=st(C[0]+(xe(D)[0]-I[0]),C[1]+(xe(D)[1]-I[1])),N=s[0].indexOf("!")>-1,N&&(R=s[0].substring(0,s[0].lastIndexOf("!")+1));!this.isDigit(M[A]);)A=A+1;var k=this.substring(D,E),B=this.substring(M,A),F=this.substring(D,E,D.length-E),O=this.substring(M,A,M.length-E);if(L&&(k=P+k,B=P+B),F!==O&&(l[p]=this.substring(l[p],L?P.length+E:E)+O),v=l[p].split(k).join(B),N?(v.indexOf("!")>-1&&(v=v.substring(v.lastIndexOf("!")+1)),v=R+v):v=v.substring(v.lastIndexOf("!")+1),i===this.trueValue)c=c+1;else{var z=this.getValueFromArg(v),Y=parseFloat(z===""&&r!==this.trueValue?"0":z);this.isNumber(Y)&&(S++,c=c+Y)}}return r===this.trueValue&&(c=c/S),c},t.prototype.computeCountIfsFormulas=function(e){if(g(e)||e[0]===""||e.length<2||e.length>127||e.length%2!==0)return this.formulaErrorStrings[me.WrongNumberArguments];for(var i=e,r=[],n=[],s=0;s<i.length;s++)i[s].indexOf(":")>-1&&this.isCellReference(i[s])?r.push(i[s].trim()):n.push(i[s].trim());if(r.length!==n.length)return this.getErrorStrings()[W.Value];for(var a=[],l=this.grid,s=0;s<r.length;s++){var h=ie(r[s]),c=h[0],u=h[1],d=h[2],p=h[3],f="",v=this.getSheetFamilyItem(l);r[s].startsWith("!")?(f=r[s].substring(0,r[s].replace("!","").indexOf("!")+2),v.tokenToParentObject!==null&&(l=v.tokenToParentObject.get(f))):v.parentObjectToToken!==null&&(f=v.parentObjectToToken.get(l));var m=this.getSheetId(l),y={action:"getSheetInfo",sheetInfo:[]};if(this.parentObject.notify(At,y),uM(this.parentObject,"Sheet"+m,y.sheetInfo)===-1)return this.getErrorStrings()[W.Ref];var b=this.getCellValueFn(l,this.cell,m,!0);if(a.length>0){var S=a[a.length-1],C=S.endRow-S.startRow+1,x=S.endCol-S.startCol+1;if(d-c+1!==C||p-u+1!==x)return this.getErrorStrings()[W.Value]}a.push({startRow:c,startCol:u,endRow:d,endCol:p,getCellValue:b})}for(var I=0;I<n.length;I++)if(n[I]==="")return 0;for(var D=[],s=0;s<a.length;s++){var M=n[s],E=M.startsWith(this.tic)&&M.endsWith(this.tic);M=this.getANDComputedValue(M.trim());var A=M.includes("*"),L=M==="*"||M==="<>*",N=A&&!L?M.replace(/\*/g,"").trim():M,R=!1;if(!E&&this.isCellReference(N)&&(N=this.getValueFromArg(N),R=!0),A&&!L){var P=M.indexOf("*");M[0]==="*"&&(N="*"+N),M[M.length-1]==="*"&&(N+="*"),P>0&&P<M.length-1&&(N=M.substring(0,P)+"*"+M.substring(P+1))}M=N;var k="equal",B=this.getOperatorAndCriteria(M,k);k=B.op,M=B.criteria,(!E&&this.isCellReference(M)&&!R||M.includes(this.arithMarker))&&(M=this.getValueFromArg(M));var F=M.indexOf("*")>-1||M.indexOf("?")>-1,O=a[s],c=O.startRow,u=O.startCol,d=O.endRow,p=O.endCol,b=O.getCellValue,z=void 0;if(s===0)for(var Y=c;Y<=d;Y++)for(var K=u;K<=p;K++)z=b(Y+1,K+1,st(Y,K)),F&&(z=this.findWildCardValue(M.toLowerCase(),z.toLowerCase())),this.processLogical([z.toLowerCase(),M.toLowerCase()],k)===this.trueValue&&D.push({rowIdx:Y,colIdx:K});else{var U=D,q=a[s-1];D=[];for(var ae=0;ae<U.length;ae++){var te=U[ae];te.rowIdx=c+(te.rowIdx-q.startRow),te.colIdx=u+(te.colIdx-q.startCol),z=b(te.rowIdx+1,te.colIdx+1,st(te.rowIdx,te.colIdx)),F&&(z=this.findWildCardValue(M.toLowerCase(),z.toLowerCase())),this.processLogical([z.toLowerCase(),M.toLowerCase()],k)===this.trueValue&&D.push({rowIdx:te.rowIdx,colIdx:te.colIdx})}}if(D.length===0)return 0}return D.length},t.prototype.getOperatorAndCriteria=function(e,i){var r=e;return r.startsWith("<=")?(i="lessEq",r=r.substring(2)):r.startsWith(">=")?(i="greaterEq",r=r.substring(2)):r.startsWith("<>")?(i="notEq",r=r.substring(2)):r.startsWith("<")?(i="less",r=r.substring(1)):r.startsWith(">")?(i="greater",r=r.substring(1)):r.startsWith("=")&&(i="equal",r=r.substring(1)),{op:i,criteria:r}},t.prototype.processNestedFormula=function(e,i,r){if(r&&!r.toString().includes('"')){var n=e.indexOf(i)+i.length;if(e[n]==='"'&&this.getErrorStrings().indexOf(r.toString())<0&&!this.isNumber(r)&&r!==this.trueValue&&r!==this.falseValue)return e.split(i).join('"'+r+'"')}return e.split(i).join("n"+r)},t.prototype.isNaN=function(e){return e.toString()==="NaN"||typeof e=="string"},t.prototype.isNumber=function(e){return e-parseFloat(e)>=0},t.prototype.fromOADate=function(e){e=e>0&&e<1?1+e:e===0?1:e,e>60&&(e-=1);var i=new Date("01/01/1900"),r=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds());return new Date(new Date((e-1)*this.millisecondsOfaDay+r).toUTCString().replace(" GMT",""))},t.prototype.getSerialDateFromDate=function(e,i,r){var n=0;e<1900&&(e+=1900);for(var s=!1;!s;){for(;i>12;)e++,i-=12;for(;i<1;)i+=12,e--;s=!0;for(var a=new Date(e,i,1,-1).getDate();r>a;)a=new Date(e,i,1,-1).getDate(),i++,r-=a,s=!1;r<1&&(i--,i<1&&(i=12,e--),a=new Date(e,i,1,-1).getDate(),r=a+r,s=!1)}var l=Date.parse(e+"/"+i+"/"+r);return this.isNaN(l)||(n=this.toOADate(new Date(l))),n},t.prototype.intToTime=function(e){var i=e.toString().split(".");return g(i[1])||(e=parseFloat(i[0]+1+"."+i[1])||e),this.intToDate(e.toString())},t.prototype.toOADate=function(e,i,r){var n=new Date("01/01/1900"),s=_o(e)?e:new Date(e),a=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),l=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),h=(l-a)/(1e3*3600*24);return(i?h:parseInt(h.toString(),10))+(r?0:h>60?2:1)},t.prototype.calculateDate=function(e){return this.parseFloat(e)<10?"0"+e:e},t.prototype.isTextEmpty=function(e){return e===null||e===""},t.prototype.isDigit=function(e){var i=e.charCodeAt(0);return i>47&&i<58},t.prototype.getANDComputedValue=function(e){return e.startsWith(this.arithMarker)&&e.includes("c")&&(e=this.getValueFromArg(e)),e.split(this.tic).join(this.emptyString)},t.prototype.findLastIndexOfq=function(e){for(var i=e.lastIndexOf("q"),r=e.lastIndexOf(this.leftBracket);r<i;)i=e.substring(0,i).lastIndexOf("q");return i},t.prototype.getValueFromArg=function(e,i,r,n,s){if(e=e.trim(),!e||this.getErrorStrings().indexOf(e)>-1)return e;var a=e[0];if(a===this.tic||a===this.singleTic){var l=e.split(this.tic).join("");if(this.isNaN(this.parseFloat(l))&&!(s&&a===this.tic&&e.endsWith(this.tic))){var h=this.isDate(l);if(h&&!this.isNaN(h.getDate()))return this.toOADate(h,!0).toString()}if(e.endsWith(this.tic)){var c=this.getParseDecimalSeparator();c!=="."&&l.includes(c)&&(l=l.replace(c,"."),this.isNumber(l)&&(e=l))}return e}else if(a==="u"&&e.includes(this.arithMarker))e=this.parser.parseSimpleOperators(e.split("u").join("0-"),[this.parser.tokenSubtract],["-"]);else{var u=this.isUpperChar(a);if(!u){var c=this.getParseDecimalSeparator();if(this.isDigit(a)||a===c||a==="-"||a==="n"){if(a==="n"&&(e=e.substring(1),e.indexOf('"n')>-1&&(e=e.replace('"n','"'))),c!=="."&&e.includes(c)){var l=e.replace(c,".");this.isNumber(l)&&(e=l)}return e}}}var d=a===this.sheetToken;if(d||this.isUpperChar(a)&&!["+","-","/","*",")",")","{"].some(function(y){return e.includes(y)})){var p=this.isCellReference(e);if(p&&!d){var f=this.getSheetFamilyItem(this.grid);f.sheetNameToParentObject!==null&&f.parentObjectToToken.has(this.grid)&&(e=f.parentObjectToToken.get(this.grid)+e)}if(e===this.cell){var v=this.getDependentCells().get(e);if(v!=null&&v.indexOf(e)>-1&&this.arrayRemove(v,e),this.getDependentFormulaCells().has(this.cell)||this.clearFormulaDependentCells(this.cell),!i)throw new bs(this.formulaErrorStrings[me.CircularReference])}var m=this.getParentObjectCellValue(e,!1,i,n).toString();return p&&this.updateDependentCell(e),m}else return this.computeValue(e,!1,r)},t.prototype.isDate=function(e){if(typeof e=="object"||Date.parse(e)!==null){var i=void 0;return typeof e=="string"?i=this.checkDateFormat(e):i=new Date(Date.parse(e)),i>=this.dateTime1900?i:null}else return null},t.prototype.isValidCellReference=function(e){var i=0,r=0,n=0,s=[89,71,69],a=this.emptyString;if(this.namedRanges.has(e))return!1;for(var l=0;l<e.length;l++)this.isChar(e[l])&&r++;if(a=e.substring(i,r),a.length<4){for(;n<a.length;)if(!g(a[n])&&a[n].charCodeAt(0)<s[n]){n++;continue}else{if(g(a[n])&&n>0)break;return!1}var h=this.parseFloat(e.substring(r,e.length));if(h<1048576)return!0}return!1},t.prototype.parseDate=function(e){if(!this.isNaN(e)){if(e instanceof Date)return new Date(e);var i=parseInt(e,10);return i<0?this.getErrorStrings()[W.Num]:i<=60?new Date(this.dateTime1900.getTime()+(i-1)*864e5):new Date(this.dateTime1900.getTime()+(i-2)*864e5)}return typeof e=="string"&&(e=this.checkDateFormat(e,!0),!this.isNaN(e))?e:this.getErrorStrings()[W.Value]},t.prototype.checkDateFormat=function(e,i){if(this.parentObject.getModuleName()==="spreadsheet"&&this.parentObject.locale!=="en-US"){var r={value:e,cell:{value:e}};if(this.parentObject.notify("checkDateFormat",r),r.isDate)return r.dateObj}return i?new Date(e):new Date(Date.parse(e))},t.prototype.isCellReference=function(e){if(e=e.trim(),e===this.emptyString)return!1;e=this.setTokensForSheets(e);var i=this.getSheetToken(e),r=!1;i!==""&&(e=e.split(i).join(this.emptyString));var n=!1,s=!1;if(e.indexOf(":")!==e.lastIndexOf(":"))return!1;for(var a=e.split("").join(this.getParseArgumentSeparator()).split(this.getParseArgumentSeparator()),l=0;l<a.length;l++)if(this.isChar(a[l]))n=!0;else if(this.isDigit(a[l]))s=!0;else if(a[l]===":")n&&s&&(r=!0),n=!1,s=!1;else return!1;return e.indexOf(":")>-1&&e.indexOf(this.tic)===-1?!!(r&&n&&s||(n&&!s||!n&&s)&&!r):!!(n&&s&&e.indexOf(this.tic)===-1&&this.isValidCell(e))},t.prototype.setTokensForSheets=function(e){var i=this.getSheetFamilyItem(this.grid),r=this.getSortedSheetNames();if(r!=null)for(var n=0;n<r.length;n++){var s=i.sheetNameToToken.get(r[n]);s=s.split(this.sheetToken).join(this.tempSheetPlaceHolder);var a=this.singleTic+"SHEET"+r[n]+this.singleTic+this.sheetToken;e.indexOf(a)===-1&&(a="SHEET"+r[n]+this.sheetToken),e=e.split(a).join(s),a=r[n]+this.sheetToken,e=e.split(a).join(s)}if(e=e.split(this.tempSheetPlaceHolder).join(this.sheetToken),e.indexOf("!!")>-1){e=e.replace("!!","!");var l=e.split("!");l[1]=(parseInt(l[1],10)+1).toString(),e=l.join("!")}return e},t.prototype.getParentObjectCellValue=function(e,i,r,n){if(e===this.trueValue||e===this.falseValue)return e;var s=e.lastIndexOf(this.sheetToken),a=this.grid,l;if(s>-1){var h=this.getSheetFamilyItem(a);if(h.tokenToParentObject!==null)this.grid=h.tokenToParentObject.get(e.substring(0,s+1)),l=e.substring(s+1);else return this.getErrorStrings()[W.Value]}else{for(var c=0;c<e.length&&this.isChar(e[c]);)c++;if(c===e.length)return e===""?this.getErrorStrings()[W.Value]:this.getErrorStrings()[W.Name];l=e;var h=this.getSheetFamilyItem(a);h.isSheetMember&&h.parentObjectToToken!=null&&(e=h.parentObjectToToken.get(this.grid)+e)}if(this.isDigit(l[0])){var u=l.search(/[a-zA-Z]/);u>0&&(l=l.substring(u,l.length)+l.substring(0,u))}var d=this.rowIndex(l),p=this.colIndex(l),f;if(!(d>0&&d<=ig&&p>0&&p<=rg))f=this.getErrorStrings()[W.Name];else{var v=this.getSheetId(this.grid);if(this.parentObject.notify){var m={action:"getSheetInfo",sheetInfo:[]};if(this.parentObject.notify(At,m),uM(this.parentObject,"Sheet"+v,m.sheetInfo)===-1)return this.grid=a,this.getErrorStrings()[W.Ref]}f=this.getCellValueFn(a,this.cell,v,!1,i,r,n)(d,p,e)}return this.grid=a,f},t.prototype.getCellValueFn=function(e,i,r,n,s,a,l){var h=this,c=i;c&&(c=e===this.grid?"":c+","+(typeof e=="string"&&Number(e)>-1?e:this.getSheetID(e)));var u=this.parentObject.getValueRowCol.bind(this.parentObject)||this.getValueRowCol.bind(this);return function(d,p,f){if(i===f&&!a)throw h.formulaErrorStrings[me.CircularReference];h.cell=f;var v=u(r,d,p,c,s,a,l);if(g(v))v=h.emptyString;else{v=v.toString();var m=h.getParseDecimalSeparator();if(m!=="."&&v.includes(m)){var y=v.replace(m,".");h.isNumber(y)&&(v=y)}}return h.cell=i,n&&h.updateDependentCell(f),v}},t.prototype.isValidCell=function(e){var i=e.search(/\d/);if(i===0){var r=e.search(/[a-zA-Z]/);e=e.substring(r,e.length)+e.substring(0,r)}var n=this.rowIndex(e),s=this.colIndex(e);return n>0&&n<=ig&&s>0&&s<=rg},t.prototype.getSheetId=function(e){return e&&typeof e=="string"&&Number(e)>-1?Number(e):this.getSheetID(e)+1},t.prototype.getValueRowCol=function(e,i,r){var n=this.rowsToKeyMap.get(i).toString(),s=this.getKeyValue(n).toString();if(s!=null&&s[s.length-1]==="%"&&s.length>1){var a=this.parseFloat(s.substring(0,s.length-1));this.isNaN(a)&&(s=(Number(a)/100).toString())}return s},t.prototype.defineFunction=function(e,i,r){typeof i=="string"&&(i=V(i,window)),e=e.toUpperCase(),this.libraryFormulas.set(e,{handler:i,isCustom:!0,description:r})},t.prototype.valueChanged=function(e,i,r,n,s,a,l,h,c,u,d,p){var f=e;this.spreadSheetUsedRange=n,this.grid=e;var v=!0,m=!0,y=this.getSheetFamilyItem(f),b=li(i.getColIndex())+i.getRowIndex().toString();if(this.actCell=a+"!"+b,y.sheetNameToParentObject!==null&&y.sheetNameToParentObject.size>0){var S=y.parentObjectToToken.get(f);b=S+b}var C=i.getFormulaValue().toUpperCase();if(C.indexOf("=RAND()")>-1||C.indexOf("=NOW()")>-1||C.indexOf("NOW()")>-1||C.indexOf("RAND()")>-1||C.indexOf("=RANDBETWEEN(")>-1||C.indexOf("RANDBETWEEN(")>-1||this.randomValues.has(b)){var x=this.randCollection.toString();this.randomValues.has(b)?this.randomValues.has(b)&&(C.indexOf("=RAND()")>-1||C.indexOf("=NOW()")>-1||C.indexOf("NOW()")>-1||C.indexOf("RAND()")>-1||C.indexOf("=RANDBETWEEN(")>-1||C.indexOf("RANDBETWEEN(")>-1?this.randomValues.set(b,i.getFormulaValue()):i.getFormulaValue().toUpperCase()!==this.randomValues.get(b.toUpperCase())&&(this.randomValues.delete(b),x=x.split(b+this.parseArgumentSeparator).join("").split(this.parseArgumentSeparator+b).join("").split(b).join(""),this.randCollection=x.split(this.parseArgumentSeparator)),this.randomValues.size===0&&this.randCollection.length&&(this.isRandomVal=!1,this.randomValues.clear(),this.randCollection=[])):(this.randomValues.set(b,i.getFormulaValue()),this.randCollection.push(b),this.isRandomVal=!0)}if(i.getFormulaValue()&&i.getFormulaValue()[0]===this.getFormulaCharacter()){this.cell=b;var I=void 0;if(g(m)||(m=r),this.getFormulaInfoTable().has(b)){if(I=this.getFormulaInfoTable().get(b),i.getFormulaValue()!==I.getFormulaText()||I.getParsedFormula()==null){I.setFormulaText(i.getFormulaValue()),this.getDependentFormulaCells().has(this.cell)&&this.clearFormulaDependentCells(this.cell);try{I.setParsedFormula(this.parser.parseFormula(i.getFormulaValue()))}catch(M){I.setFormulaValue(M),m=!1}}else this.parser.isError=!1;if(m){this.parser.isFormulaParsed=!0;var D=this.calculateFormula(I.getParsedFormula(),s);v=D!==I.getFormulaValue()&&(!this.parentObject.isEdit||D!==this.formulaErrorStrings[me.CircularReference]),I.setFormulaValue(D)}}else{I=new gz,I.setFormulaText(i.getFormulaValue()),this.getDependentFormulaCells().has(b)||this.getDependentFormulaCells().set(b,new Map),this.getFormulaInfoTable().set(b,I);try{I.setParsedFormula(this.parser.parseFormula(i.getFormulaValue()))}catch(M){I.setFormulaValue(M),m=!1}if(m){var D=this.calculateFormula(I.getParsedFormula(),s);v=D!==this.formulaErrorStrings[me.CircularReference],I.setFormulaValue(D)}}m&&(this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(f)+1,I.getFormulaValue(),i.getRowIndex(),i.getColIndex()):this.parentObject.setValueRowCol(this.getSheetId(f),I.getFormulaValue(),i.getRowIndex(),i.getColIndex(),I.getFormulaText(),l))}else this.getFormulaInfoTable().has(b)&&(this.getFormulaInfoTable().delete(b),this.getDependentFormulaCells().has(b)&&this.clearFormulaDependentCells(b));m&&v&&this.getDependentCells().has(b)&&(this.parentObject.calculationMode==="Automatic"||!this.parentObject.isEdit||d)&&this.getDependentCells().get(b).toString()!==b&&this.refresh(b,void 0,void 0,h,c,u,d,p)},t.prototype.setValueRowCol=function(e,i,r,n){},t.prototype.getSortedSheetNames=function(){var e=this.getSheetFamilyItem(this.grid);if(e!=null&&e.sheetNameToToken!=null){var i=[];e.sheetNameToToken.forEach(function(r,n){i.push(n),i.sort()}),this.sortedSheetNames=i,this.sortedSheetNames.sort(function(r,n){return n.length-r.length})}return this.sortedSheetNames},t.prototype.getErrorLine=function(e){var i=e.stack?e.stack.split(`
`)[1].split(":"):null;return i?i[i.length-2]:null},t.prototype.createSheetFamilyID=function(){return this.sheetFamilyID===Number.MAX_SAFE_INTEGER&&(this.sheetFamilyID=Number.MIN_SAFE_INTEGER),this.sheetFamilyID++},t.prototype.computeMinMax=function(e,i){var r,n,s=!1;if(e.length){var a=e[e.length-1];a==="isSubtotal"&&(s=!0,e.pop())}if(g(e)||e.length===0)return this.formulaErrorStrings[me.WrongNumberArguments];r=i==="max"?this.minValue:this.maxValue;for(var l=0,h=e.length;l<h;l++)e[l].split(this.tic).join("").trim()===this.emptyString&&(r=0);var c=e;if(c.length>255)return this.getErrorStrings()[W.Value];for(var u=0;u<c.length;u++)if(c[u].indexOf(":")>-1&&this.isCellReference(c[u])){for(var d=this.getCellCollection(c[u]),p=0;p<d.length;p++)if(n=s?this.getValueFromArg(d[p],null,null,!0):this.getValueFromArg(d[p]),!(s&&n.includes("SUBTOTAL("))){var f=this.parseFloat(n);n===""||this.isNaN(this.parseFloat(f))||this.getErrorStrings().indexOf(n)>-1||(r=i==="max"?Math.max(r,f):Math.min(r,f))}}else{var v=s?this.getValueFromArg(c[u],null,null,!0):this.getValueFromArg(c[u]);if(s&&v.includes("SUBTOTAL("))continue;var f=0,m=this.isCellReference(c[u]),y=v===""&&m,b=this.isNaN(this.parseFloat(v))&&m,S=v===(this.trueValue||this.falseValue)&&m;if(c[u]=c[u].startsWith("n")?c[u].slice(1):c[u],this.getErrorStrings().indexOf(v)>-1)return v;if(v===this.trueValue&&c[u]===this.trueValue)v="1";else if(v===this.falseValue&&c[u]===this.falseValue)v="0";else if(y||b||S)continue;if(v.indexOf('"')>-1&&(v=v.split(this.tic).join("")),this.isNaN(this.parseFloat(v)))return this.getErrorStrings()[W.Value];f=this.parseFloat(v),r=i==="max"?Math.max(r,f):Math.min(r,f)}return(r===this.minValue||r===this.maxValue)&&(r=0),r.toString()},t.prototype.calculateAvg=function(e,i){for(var r=e,n=[],s,a,l=0,h=0,c=0;c<r.length;c++)if(this.isCellReference(r[c]))if(r[c].indexOf(":")>-1){n=this.getCellCollection(r[c]);for(var u=0;u<n.length;u++)if(s=i?this.getValueFromArg(n[u],null,null,!0):this.getValueFromArg(n[u]),!(i&&s.includes("SUBTOTAL("))){if(this.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||isNaN(this.parseFloat(s))||s==="")continue;l=l+this.parseFloat(s),h=h+1}}else{if(s=i?this.getValueFromArg(r[c],null,null,!0):this.getValueFromArg(r[c]),i&&s.includes("SUBTOTAL("))continue;if(this.getErrorStrings().indexOf(s)>-1)return s;if(g(s)||isNaN(this.parseFloat(s))||s==="")continue;l=l+this.parseFloat(s),h=h+1}else{if(r[c].indexOf(this.tic)>-1&&(isNaN(this.parseFloat(r[c].split(this.tic).join("")))||r[c].split(this.tic).join("").trim()===""))return this.getErrorStrings()[W.Value];if((r[c].length===0||e[c]===this.falseValue)&&(r[c]="0"),e[c]===this.trueValue&&(r[c]="1"),a=this.getValueFromArg(r[c].split(this.tic).join("")),this.getErrorStrings().indexOf(a)>-1)return a;l=l+this.parseFloat(a),h=h+1}return h===0?this.getErrorStrings()[W.DivZero]:(l/h).toString()},t.prototype.registerGridAsSheet=function(e,i,r){g(this.modelToSheetID)&&(this.modelToSheetID=new Map),g(this.modelToSheetID.get(i))&&this.modelToSheetID.set(i,r);var n=this.getSheetFamilyItem(i);n.isSheetMember=!0;var s=e.toUpperCase();if(n.parentObjectToToken.size===0&&(n.parentObjectToToken=new Map),n.sheetNameToParentObject.size===0&&(n.sheetNameToParentObject=new Map),n.sheetNameToToken.size===0&&(n.sheetNameToToken=new Map),n.tokenToParentObject.size===0&&(n.tokenToParentObject=new Map),Te(n.sheetNameToParentObject.get(s))){var a=this.sheetToken+this.tokenCount.toString()+this.sheetToken;this.tokenCount++,n.tokenToParentObject.set(a,i),n.parentObjectToToken.set(i,a),n.sheetNameToToken.set(s,a),n.sheetNameToParentObject.set(s,i)}else{var a=n.sheetNameToToken.get(s);n.tokenToParentObject.set(a,i),n.parentObjectToToken.set(i,a)}return e},t.prototype.unregisterGridAsSheet=function(e,i,r){var n=this,s=[i];r&&(s=[],g(this.modelToSheetID)||this.modelToSheetID.forEach(function(a,l){s.push(l)})),s.forEach(function(a){var l=n.getSheetFamilyItem(a),h=(r?a:e).toUpperCase();if(l.sheetNameToParentObject!=null&&l.sheetNameToParentObject.has(h)){l.sheetNameToParentObject.delete(h);var c=l.sheetNameToToken.get(h);l.sheetNameToToken.delete(h),l.tokenToParentObject.delete(c),l.parentObjectToToken.delete(a)}})},t.prototype.computeExpression=function(e,i){var r=this.parser.parseFormula(e),n=this.computeFormula(r,i);return n},t.prototype.isSheetMember=function(){var e=this.getSheetFamilyItem(this.grid);return g(e)?!1:e.isSheetMember},t.prototype.dispose=function(){this.resetKeys(),this.namedRanges.clear(),this.lFormulas.clear()},t.prototype.refreshRandValues=function(e){var i,r,n,s="",a;if(this.randomValues.has(e)){this.randomValues.delete(e);var l=this.randCollection.indexOf(e);l>-1&&this.randCollection.splice(l,1),this.randomValues.size===0&&!this.randCollection.length&&(this.randomValues.clear(),this.randCollection=[])}for(var h=0;h<this.randomValues.size;h++)i=this.rowIndex(this.randCollection[h]),r=this.colIndex(this.randCollection[h]),s=(parseFloat(this.getSheetToken(this.randCollection[h]).split(this.sheetToken).join(""))+1).toString(),a=this.getSheetFamilyItem(s),this.grid=a.sheetNameToParentObject.get(s),n=this.randomValues.get(this.randCollection[h]),n=this.computeFormula(n),this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(this.grid)+1,n,i,r):this.parentObject.setValueRowCol(this.getSheetId(this.grid),n,i,r)},t.prototype.refresh=function(e,i,r,n,s,a,l,h){var c=this,u;r||(u=!0,r=[]);var d=this.getSheetFamilyItem(this.grid);try{var p=this.getDependentCells().get(e);if(p&&p.length!==0&&(this.parentObject.calculationMode==="Automatic"||l||h==="calculate")){var f=void 0;for(f=0;f<p.length;f++){var v=p[f];if(!(i&&v.indexOf(i)>-1||v===e||r.indexOf(v)>-1)){var m=this.getSheetToken(v),y=this.parentObject.sheets,b=this.parentObject.activeSheetIndex;if(m.length){this.grid=d.tokenToParentObject.get(m);var S=Number(this.grid),C="";if(!this.isNaN(S)&&y)for(var x=0;x<y.length;x++)y[x].id===S&&(C=y[x].name,b=x);this.actCell=C+"!"+v.split(m)[1]}else this.actCell=v.split(m)[1];try{var I=function(z,Y){Y&&(c.cell=z,c.parser.isFormulaParsed=!0,Y.setFormulaValue(c.calculateFormula(Y.getParsedFormula(),!0)))},D=this.rowIndex(v),M=this.colIndex(v),E=this.getFormulaInfoTable().get(v);if(this.parentObject.setValueRowCol===void 0)I(v,E),this.setValueRowCol(this.getSheetID(this.grid)+1,E.getFormulaValue(),D,M);else{var A=y&&y[b].rows&&y[b].rows[D-1]&&y[b].rows[D-1].cells&&y[b].rows[D-1].cells[M-1],L=void 0;if(A&&A.formula&&A.formula.toLowerCase().includes("unique"))if(!this.uniqueCells||this.uniqueCells.indexOf(v)===-1)this.uniqueCells||(this.uniqueCells=[]),this.uniqueCells.push(v),I(v,E),L=E.getFormulaValue(),this.uniqueCells.splice(this.uniqueCells.indexOf(v),1),this.uniqueCells.length||(this.uniqueCells=null);else continue;else r.indexOf(v)===-1&&r.push(v),L=null;this.parentObject.setValueRowCol(this.getSheetId(this.grid),L,D,M,E.getFormulaText())}this.refresh(v,null,r,null,s)}catch{continue}}}}if(u){if(!s&&a&&a.length===4){for(var m=this.getSheetToken(e),N=[],R=a[0],P=a[2];R<=P;R++)for(var k=a[1],B=a[3];k<=B&&!(R===P&&k===B);k++){var A=m+st(R,k);this.refresh(A,null,r,null,s),N.push(A)}var F=new Set(N);r&&(r=r.filter(function(Y){return!F.has(Y)}))}var O=this.parentObject.sheets;O||(r=[]),r.forEach(function(z){for(var Y,K=c.getSheetId(d.tokenToParentObject.get(c.getSheetToken(z))),U=0;U<O.length;U++)if(O[U].id===K){Y=U;break}var q=c.rowIndex(z)-1,ae=c.colIndex(z)-1,te=O[Y].rows[q]&&O[Y].rows[q].cells[ae];te&&c.parentObject.notify("calculateFormula",{cell:te,rowIdx:q,colIdx:ae,sheetIndex:Y,isDependentRefresh:!0,isRandomFormula:n,action:h})})}}finally{this.getDependentCells().has(e)&&(this.grid=d.tokenToParentObject.get(this.getSheetToken(e)))}},fz([G()],t.prototype,"onFailure",void 0),t=fz([It],t),t})(pa),bs=(function(){function o(t,e){this.formulaCorrection=!1,this.message=t,this.formulaCorrection=e}return o})(),gz=(function(){function o(){this.calcID=Number.MIN_VALUE+1,this.calcID1=Number.MIN_VALUE+1}return o.prototype.getFormulaText=function(){return this.formulaText},o.prototype.setFormulaText=function(t){this.formulaText=t},o.prototype.getFormulaValue=function(){return this.formulaValue},o.prototype.setFormulaValue=function(t){this.formulaValue=t},o.prototype.getParsedFormula=function(){return this.parsedFormula},o.prototype.setParsedFormula=function(t){this.parsedFormula=t},o})(),vz=(function(){function o(){this.isSheetMember=!1,this.parentObjectToToken=new Map,this.sheetDependentFormulaCells=new Map,this.sheetNameToParentObject=new Map,this.sheetNameToToken=new Map,this.tokenToParentObject=new Map,this.sheetFormulaInfotable=new Map}return o})();function li(o){for(var t=[],e=0,i="A";o>0&&e<9;){o--;var r=i.charCodeAt(0);t[e]=String.fromCharCode(o%26+r),o=parseInt((o/26).toString(),10),e++}for(var n=[],s=0;s<e;s++)n[e-s-1]=t[s];return n.join("")}var mz=(function(){function o(t,e,i){return this.row=t,this.col=e,this.value=i,this.getRowIndex=function(){return t},this.setRowIndex=function(r){t=r},this.getColIndex=function(){return e},this.setColIndex=function(r){e=r},this.getFormulaValue=function(){return i},this}return o})();var yz="e-wraptext",ve="spreadsheetLocale",jt="dialog",u9="actionEvents",j0="shape",d9={Custom:["#ffffff","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},p9={Custom:["#ffffff","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},ia={UP:38,DOWN:40,LEFT:37,RIGHT:39,FIRSTALPHABET:65,LASTALPHABET:90,SPACE:32,BACKSPACE:8,TAB:9,DELETE:46,ENTER:13,ESC:27},f9={FindValue:"Find value",ReplaceValue:"Replace value",FindReplaceTooltip:"Find & Replace",InsertingEmptyValue:"Reference value is not valid.",ReplaceAllEnd:" matches replaced with ",ByRow:"By Rows",ByColumn:"By Columns",MatchCase:"Match case",MatchExactCellElements:"Match entire cell contents",EnterCellAddress:"Enter cell address",FindAndReplace:"Find and Replace",FindNextBtn:"Find Next",FindPreviousBtn:"Find Previous",ReplaceBtn:"Replace",ReplaceAllBtn:"Replace All",GotoHeader:"Go To",Sheet:"Sheet",Workbook:"Workbook",NoElements:"We couldn't find what you were looking for.",FindWhat:"Find what",ReplaceWith:"Replace with",Cut:"Cut",Copy:"Copy",Paste:"Paste",PasteSpecial:"Paste Special",Link:"Link",Spreadsheet:"Spreadsheet",AddNote:"Add Note",EditNote:"Edit Note",DeleteNote:"Delete Note",Hyperlink:"Hyperlink",EditHyperlink:"Edit Hyperlink",OpenHyperlink:"Open Hyperlink",RemoveHyperlink:"Remove Hyperlink",InvalidHyperlinkAlert:"The address of this site is not valid. Check the address and try again.",InsertLink:"Insert Link",EditLink:"Edit Link",All:"All",MathTrig:"Math & Trig",Statistical:"Statistical",Logical:"Logical",LookupReference:"Lookup & Reference",Information:"Information",DateTime:"Date & Time",Values:"Values",Formats:"Formats",Bold:"Bold",Font:"Font",FontSize:"Font Size",Italic:"Italic",Underline:"Underline",Strikethrough:"Strikethrough",TextColor:"Text Color",FillColor:"Fill Color",HorizontalAlignment:"Horizontal Alignment",AlignLeft:"Align Left",AlignCenter:"Center",AlignRight:"Align Right",VerticalAlignment:"Vertical Alignment",AlignTop:"Align Top",AlignMiddle:"Align Middle",AlignBottom:"Align Bottom",WrapText:"Wrap Text",MergeCells:"Merge Cells",MergeAll:"Merge All",MergeHorizontally:"Merge Horizontally",MergeVertically:"Merge Vertically",Unmerge:"Unmerge",UnmergeCells:"Unmerge Cells",SelectMergeType:"Select Merge Type",MergeCellsAlert:"Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?",Borders:"Borders",TopBorders:"Top Borders",LeftBorders:"Left Borders",RightBorders:"Right Borders",BottomBorders:"Bottom Borders",AllBorders:"All Borders",HorizontalBorders:"Horizontal Borders",VerticalBorders:"Vertical Borders",OutsideBorders:"Outside Borders",InsideBorders:"Inside Borders",NoBorders:"No Borders",BorderColor:"Border Color",BorderStyle:"Border Style",InsertFunction:"Insert Function",CalcOptions:"Calculation Options",CalcOptionsTip:"Choose to calculate formulas either automatically or manually",CalcActiveSheet:"Calculate Sheet",CalcWorkbook:"Calculate Workbook",Automatic:"Automatic",Manual:"Manual",CalcSheetTip:"Calculate the active sheet",CalcWorkbookTip:"Calculate the entire workbook",Insert:"Insert",Delete:"Delete",DuplicateSheet:"Duplicate",MoveRight:"Move Right",MoveLeft:"Move Left",Rename:"Rename",Hide:"Hide",FileName:"File Name",PROPER:"Converts a text to proper case; first letter to uppercase and other letters to lowercase.",NameBox:"Name Box",ShowHeaders:"Show Headers",HideHeaders:"Hide Headers",ShowGridLines:"Show Gridlines",ExtendValidation:"The selection contains some cells without data validation. Do you want to extend validation to these cells?",Yes:"Yes",No:"No",HideGridLines:"Hide Gridlines",FreezePanes:"Freeze Panes",FreezeRows:"Freeze Rows",FreezeColumns:"Freeze Columns",UnfreezePanes:"Unfreeze Panes",UnfreezeRows:"Unfreeze Rows",UnfreezeColumns:"Unfreeze Columns",AddSheet:"Add Sheet",ListAllSheets:"List All Sheets",CollapseToolbar:"Collapse Toolbar",ExpandToolbar:"Expand Toolbar",CollapseFormulaBar:"Collapse Formula Bar",ExpandFormulaBar:"Expand Formula Bar",File:"File",Home:"Home",Formulas:"Formulas",View:"View",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",Update:"Update",ExcelXlsx:"Microsoft Excel",ExcelXls:"Microsoft Excel 97-2003",CSV:"Comma-separated values",FormulaBar:"Formula Bar",Sort:"Sort",SortAscending:"Ascending",SortDescending:"Descending",CustomSort:"Custom Sort",AddColumn:"Add Column",ContainsHeader:"Data contains header",CaseSensitive:"Case sensitive",SortBy:"Sort by",ThenBy:"Then by",SelectAColumn:"Select a column",SortEmptyFieldError:"All sort criteria must have a column specified. Check the selected sort criteria and try again.",SortDuplicateFieldError:"  is being sorted by values more than once. Delete the duplicate sort criteria and try again.",SortOutOfRangeError:"Select a cell or range inside the used range and try again.",MultiRangeSortError:"This can't be done on a multiple range selection. Select a single range and try again.",SortAndFilter:"Sort & Filter",Filter:"Filter",ClearAllFilter:"Clear",ClearFilterFrom:"Clear Filter From ",ReapplyFilter:"Reapply",FilterCellValue:"Filter by Value of Selected Cell",FilterOutOfRangeError:"Select a cell or range inside the used range and try again.",HideRow:"Hide Row",HideRows:"Hide Rows",UnhideRows:"Unhide Rows",HideColumn:"Hide Column",HideColumns:"Hide Columns",UnhideColumns:"Unhide Columns",InsertRow:"Insert Row",InsertRows:"Insert Rows",Above:"Above",Below:"Below",InsertColumn:"Insert Column",InsertColumns:"Insert Columns",Before:"Before",After:"After",DeleteRow:"Delete Row",DeleteRows:"Delete Rows",DeleteColumn:"Delete Column",DeleteColumns:"Delete Columns",Ok:"OK",Close:"Close",MoreOptions:"More Options",Cancel:"Cancel",Apply:"Apply",MoreColors:"More Colors",StandardColors:"Standard Colors",General:"General",Number:"Number",Currency:"Currency",Accounting:"Accounting",ShortDate:"Short Date",LongDate:"Long Date",Time:"Time",Percentage:"Percentage",Fraction:"Fraction",Scientific:"Scientific",Text:"Text",Custom:"Custom",MobileFormulaBarPlaceHolder:"Enter value or Formula",NumberFormat:"Number Format",PasteAlert:"You can't paste this here, because the copy area and paste area aren't in the same size. Please try pasting in a different range.",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",SheetRenameInvalidAlert:"Sheet name contains invalid character.",SheetRenameEmptyAlert:"Sheet name cannot be empty.",SheetRenameAlreadyExistsAlert:"Sheet name already exists. Please enter another name.",DeleteSheetAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",DeleteSingleLastSheetAlert:"A Workbook must contain at least one visible worksheet.",PickACategory:"Pick a category",Description:"Description",UnsupportedFile:"Unsupported File",DataLimitExceeded:"File data is too large and it takes more time to process, do you want to continue?",FileSizeLimitExceeded:"File size is too large and it takes more time to process, do you want to continue?",InvalidUrl:"Invalid URL",SUM:"Adds a series of numbers and/or cells.",SUMIF:"Adds the cells based on specified condition.",SUMIFS:"Adds the cells based on specified conditions.",ABS:"Returns the value of a number without its sign.",RAND:"Returns a random number between 0 and 1.",RANDBETWEEN:"Returns a random integer based on specified values.",FLOOR:"Rounds a number down to the nearest multiple of a given factor.",CEILING:"Rounds a number up to the nearest multiple of a given factor.",PRODUCT:"Multiplies a series of numbers and/or cells.",INT:"Returns a number to the nearest integer.",ROUNDUP:"Rounds a number away from zero.",SUMPRODUCT:"Returns sum of the product of given ranges of arrays.",SORT:"Sorts a range of an array",T:"Checks whether a value is text or not and returns the text.",EXACT:"Checks whether a two text strings are exactly same and returns TRUE or FALSE.",LEN:"Returns a number of characters in a given string.",MOD:"Returns a remainder after a number is divided by divisor.",ODD:"Rounds a positive number up and negative number down to the nearest odd integer.",PI:"Returns the value of pi.",COUNTBLANK:"Returns the number of empty cells in a specified range of cells.",EVEN:"Rounds a positive number up and negative number down to the nearest even integer.",DECIMAL:"Converts a text representation of a number in a given base into a decimal number.",DEGREES:"Converts radians to degrees.",ADDRESS:"Returns a cell reference as text, given specified row and column numbers.",TIME:"Converts hours, minutes, seconds to the time formatted text.",CHAR:"Returns the character from the specified number.",CODE:"Returns the numeric code for the first character in a given string.",DOLLAR:"Converts the number to currency formatted text.",SMALL:"Returns the k-th smallest value in a given array.",LARGE:"Returns the k-th largest value in a given array.",FACT:"Returns the factorial of a number.",MEDIAN:"Returns the median of the given set of numbers.",EDATE:"Returns a date with given number of months before or after the specified date.",DATEVALUE:"Converts a date string into date value.",HOUR:"Returns the number of hours in a specified time string.",SECOND:"Returns the number of seconds in a specified time string.",MINUTE:"Returns the number of minutes in a specified time string.",NOW:"Returns the current date and time.",MONTH:"Returns the number of months in a specified date string.",TODAY:"Returns the current date as date value.",WEEKDAY:"Returns the day of the week corresponding to a date.",AVERAGE:"Calculates average for the series of numbers and/or cells excluding text.",AVERAGEIF:"Calculates average for the cells based on specified criterion.",AVERAGEIFS:"Calculates average for the cells based on specified conditions.",AVERAGEA:"Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.",COUNT:"Counts the cells that contain numeric values in a range.",COUNTIF:"Counts the cells based on specified condition.",COUNTIFS:"Counts the cells based on specified conditions.",COUNTA:"Counts the cells that contains values in a range.",MIN:"Returns the smallest number of the given arguments.",MAX:"Returns the largest number of the given arguments.",DATE:"Returns the date based on given year, month, and day.",DAY:"Returns the day from the given date.",DAYS:"Returns the number of days between two dates.",IF:"Returns value based on the given expression.",IFS:"Returns value based on the given multiple expressions.",CalculateAND:"Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.",CalculateOR:"Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.",IFERROR:"Returns value if no error found else it will return specified value.",CHOOSE:"Returns a value from list of values, based on index number.",INDEX:"Returns a value of the cell in a given range based on row and column number.",FIND:"Returns the position of a string within another string, which is case sensitive.",TEXT:"Converts a value to text in specified number format.",CONCATENATE:"Combines two or more strings together.",CONCAT:"Concatenates a list or a range of text strings.",SUBTOTAL:"Returns subtotal for a range using the given function number.",RADIANS:"Converts degrees into radians.",MATCH:"Returns the relative position of a specified value in given range.",LN:"Returns the natural logarithm of a number.",INTERCEPT:"Calculates the point of the Y-intercept line via linear regression.",UNIQUE:"Returns a unique values from a range or array",SLOPE:"Returns the slope of the line from linear regression of the data points.",LOOKUP:"Looks for a value in a one-row or one-column range, then returns a value from the same position in a second one-row or one-column range.",HLOOKUP:"Looks for a value in the top row of the array of values and then returns a value in the same column from a row in the array that you specify.",VLOOKUP:"Looks for a specific value in the first column of a lookup range and returns a corresponding value from a different column within the same row.",NOT:"Returns the inverse of a given logical expression.",EOMONTH:"Returns the last day of the month that is a specified number of months before or after an initially supplied start date.",SQRT:"Returns the square root of a positive number.",ROUNDDOWN:"Rounds a number down, toward zero.",RSQ:"Returns the square of the Pearson product moment correlation coefficient based on data points in known_y's and known_x's.",DefineNameExists:"This name already exists, try different name.",DefineNameInValid:"The name that you entered is not valid.",CircularReference:"When a formula refers to one or more circular references, this may result in an incorrect calculation.",OR:"OR",AND:"AND",CustomFilterDatePlaceHolder:"Choose a date",CustomFilterPlaceHolder:"Enter the value",CustomFilter:"Custom Filter",Between:"Between",DateTimeFilter:"DateTime Filters",Undo:"Undo",Redo:"Redo",DateFilter:"Date Filters",TextFilter:"Text Filters",NumberFilter:"Number Filters",ClearFilter:"Clear Filter",NoResult:"No Matches Found",FilterFalse:"False",FilterTrue:"True",Blanks:"Blanks",SelectAll:"Select All",GreaterThanOrEqual:"Greater Than Or Equal",GreaterThan:"Greater Than",LessThanOrEqual:"Less Than Or Equal",LessThan:"Less Than",NotEqual:"Not Equal",Equal:"Equal",Contains:"Contains",NotContains:"Does Not Contains",EndsWith:"Ends With",NotEndsWith:"Does Not End With",StartsWith:"Starts With",NotStartsWith:"Does Not Start With",IsEmpty:"Empty",IsNotEmpty:"Not Empty",ClearButton:"Clear",FilterButton:"Filter",CancelButton:"Cancel",OKButton:"OK",Search:"Search",ProtectSheet:"Protect Sheet",UnprotectSheet:"Unprotect Sheet",SelectCells:"Select locked cells",SelectUnlockedCells:"Select unlocked cells",FormatCells:"Format cells",FormatRows:"Format rows",FormatColumns:"Format columns",InsertLinks:"Insert links",ProtectContent:"Protect the contents of locked cells",ProtectAllowUser:" Allow all users of this worksheet to:",EditAlert:"The cell you're trying to change is protected. To make change, unprotect the sheet.",ReadonlyAlert:"You are trying to modify a cell that is in read-only mode. To make changes, please disable the read-only status.",FiniteAlert:"Finite mode is active: Cannot access the specified cell range outside the defined limits.",Alert:"Alert",SearchWithin:"Search within",SearchBy:"Search by",Reference:"Reference",DataValidation:"Data Validation",CellRange:"Cell Range",Allow:"Allow",Data:"Data",Minimum:"Minimum",Maximum:"Maximum",IgnoreBlank:"Ignore blank",WholeNumber:"Whole Number",Decimal:"Decimal",Date:"Date",TextLength:"Text Length",List:"List",NotBetween:"Not Between",EqualTo:"Equal To",NotEqualTo:"Not Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThanOrEqualTo:"Less Than Or Equal To",InCellDropDown:"In-cell-dropdown",Sources:"Sources",Value:"Value",Formula:"Formula",Retry:"Retry",DialogError:"The list source must be a reference to single row or column.",NamedRangeError:"A named range you specified cannot be found.",MinMaxError:"The Maximum must be greater than or equal to the Minimum.",InvalidNumberError:"Please enter a valid number.",InvalidFormula:"Please enter a valid formula.",MoreValidation:`This selection contains more than one validation. 
 Erase current settings and continue?`,FileNameError:`A file name can't contain characters like \\ / : * ? " < > [ ] |`,ListLengthError:"The list values allows only upto 256 characters",ValidationError:"This value doesn't match the data validation restrictions defined for the cell.",EmptyError:"You must enter a value",ClearHighlight:"Clear Highlight",HighlightInvalidData:"Highlight Invalid Data",ClearValidation:"Clear Validation",HighlightCellsRules:"Highlight Cells Rules",CFEqualTo:"Equal To",TextThatContains:"Text that Contains",Save:"Save",EmptyFileName:"File name cannot be empty.",LargeName:"The name is too long.",ADateOccuring:"A Date Occuring",DuplicateValues:"Duplicate Values",TopBottomRules:"Top/Bottom Rules",Directional:"Directional",Shapes:"Shapes",Indicators:"Indicators",Ratings:"Ratings",Top10Items:"Top 10 Items",Top10:"Top 10",Bottom10Items:"Bottom 10 Items",Bottom10:"Bottom 10",AboveAverage:"Above Average",BelowAverage:"Below Average",FormatCellsGreaterThan:"Format cells that are GREATER THAN:",FormatCellsLessThan:"Format cells that are LESS THAN:",FormatCellsBetween:"Format cells that are BETWEEN:",FormatCellsEqualTo:"Format cells that are EQUAL TO:",FormatCellsThatContainTheText:"Format cells that contain the text:",FormatCellsThatContainADateOccurring:"Format cells that contain a date occurring:",FormatCellsDuplicate:"Format cells that contain:",FormatCellsTop:"Format cells that rank in the TOP:",FormatCellsBottom:"Format cells that rank in the BOTTOM:",FormatCellsAbove:"Format cells that are ABOVE AVERAGE:",FormatCellsBelow:"Format cells that are BELOW AVERAGE:",With:"with",DataBars:"Data Bars",ColorScales:"Color Scales",IconSets:"Icon Sets",ClearRules:"Clear Rules",SelectedCells:"Clear Rules from Selected Cells",EntireSheet:"Clear Rules from Entire Sheet",ISNUMBER:"Returns true when the value parses as a numeric value.",ROUND:"Rounds a number to a specified number of digits.",GEOMEAN:"Returns the geometric mean of an array or range of positive data.",POWER:"Returns the result of a number raised to power",LOG:"Returns the logarithm of a number to the base that you specify.",TRUNC:"Returns the truncated value of a number to a specified number of decimal places.",EXP:"Returns e raised to the power of the given number.",Clear:"Clear",ClearContents:"Clear Contents",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearHyperlinks:"Clear Hyperlinks",LightRedFillWithDarkRedText:"Light Red Fill with Dark Red Text",YellowFillWithDarkYellowText:"Yellow Fill with Dark Yellow Text",GreenFillWithDarkGreenText:"Green Fill with Dark Green Text",RedFill:"Red Fill",RedText:"Red Text",Duplicate:"Duplicate",Unique:"Unique",And:"and",WebPage:"Web Page",ThisDocument:"This Document",DisplayText:"Display Text",Url:"URL",CellReference:"Cell Reference",DefinedNames:"Defined Names",EnterTheTextToDisplay:"Enter the text to display",EnterTheUrl:"Enter the URL",Image:"Image",ConditionalFormatting:"Conditional Formatting",BlueDataBar:"Blue Data Bar",GreenDataBar:"Green Data Bar",RedDataBar:"Red Data Bar",OrangeDataBar:"Orange Data Bar",LightBlueDataBar:"Light blue Data Bar",PurpleDataBar:"Purple Data Bar",GYRColorScale:"Green - Yellow - Red Color Scale",RYGColorScale:"Red - Yellow - Green Color Scale",GWRColorScale:"Green - White - Red Color Scale",RWGColorScale:"Red - White - Green Color Scale",BWRColorScale:"Blue - White - Red Color Scale",RWBColorScale:"Red - White - Blue Color Scale",WRColorScale:"White - Red Color Scale",RWColorScale:"Red - White Color Scale",GWColorScale:"Green - White Color Scale",WGColorScale:"White - Green Color Scale",GYColorScale:"Green - Yellow Color Scale",YGColorScale:"Yellow - Green Color Scale",ThreeArrowsColor:"3 Arrows (Colored)",ThreeArrowsGray:"3 Arrows (Gray)",ThreeTriangles:"3 Triangles",FourArrowsColor:"4 Arrows (Gray)",FourArrowsGray:"4 Arrows (Colored)",FiveArrowsColor:"5 Arrows (Gray)",FiveArrowsGray:"5 Arrows (Colored)",ThreeTrafficLights1:"3 Traffic Lights (Unrimmed)",ThreeTrafficLights2:"3 Traffic Lights (Rimmed)",ThreeSigns:"3 Signs",FourTrafficLights:"4 Traffic Lights",RedToBlack:"Red To Black",ThreeSymbols1:"3 Symbols (Circled)",ThreeSymbols2:"3 Symbols (Uncircled)",ThreeFlags:"3 Flags",ThreeStars:"3 Stars",FourRatings:"4 Ratings",FiveQuarters:"5 Quarters",FiveRatings:"5 Ratings",FiveBoxes:"5 Boxes",Chart:"Chart",Column:"Column",Bar:"Bar",Area:"Area",Pie:"Pie",Doughnut:"Doughnut",PieAndDoughnut:"Pie/Doughnut",Line:"Line",LineMarker:"Line with Markers",Radar:"Radar",Scatter:"Scatter",ChartDesign:"Chart Design",ClusteredColumn:"Clustered Column",StackedColumn:"Stacked Column",StackedColumn100:"100% Stacked Column",ClusteredBar:"Clustered Bar",StackedBar:"Stacked Bar",StackedBar100:"100% Stacked Bar",StackedArea:"Stacked Area",StackedArea100:"100% Stacked Area",StackedLine:"Stacked Line",StackedLineMarker:"Stacked Line with Markers",StackedLine100:"100% Stacked Line",StackedLine100Marker:"100% Stacked Line with Markers",AddChartElement:"Add Chart Element",Axes:"Axes",AxisTitle:"Axis Title",ChartTitle:"Chart Title",DataLabels:"Data Labels",Gridlines:"Gridlines",Legends:"Legends",PrimaryHorizontal:"Primary Horizontal",PrimaryVertical:"Primary Vertical",None:"None",AboveChart:"Above Chart",Center:"Center",InsideEnd:"Inside End",InsideBase:"Inside Base",OutsideEnd:"OutSide End",PrimaryMajorHorizontal:"Primary Major Horizontal",PrimaryMajorVertical:"Primary Major Vertical",PrimaryMinorHorizontal:"Primary Minor Horizontal",PrimaryMinorVertical:"Primary Minor Vertical",Right:"Right",Left:"Left",Bottom:"Bottom",Top:"Top",SwitchRowColumn:"Switch Row/Column",ChartTheme:"Chart Theme",ChartType:"Chart Type",Material:"Material",Fabric:"Fabric",Bootstrap:"Bootstrap",HighContrastLight:"HighContrast Light",MaterialDark:"Material Dark",FabricDark:"Fabric Dark",HighContrast:"HighContrast",BootstrapDark:"Bootstrap Dark",Bootstrap4:"Bootstrap4",Bootstrap5Dark:"Bootstrap5 Dark",Bootstrap5:"Bootstrap5",Tailwind:"Tailwind",TailwindDark:"Tailwind Dark",Tailwind3:"Tailwind 3",Tailwind3Dark:"Tailwind 3 Dark",VerticalAxisTitle:"Vertical Axis Title",HorizontalAxisTitle:"Horizontal Axis Title",EnterTitle:"Enter Title",ProtectWorkbook:"Protect Workbook",Password:"Password (optional):",EnterThePassword:"Enter the password",ConfirmPassword:"Confirm Password",EnterTheConfirmPassword:"Re-enter your password",PasswordAlert:"Confirmation password is not identical",UnprotectWorkbook:"Unprotect Workbook",UnprotectPasswordAlert:"The password you supplied is not correct.",IncorrectPassword:"Unable to open the file or worksheet with the given password",PasswordAlertMsg:"Please enter the password",ConfirmPasswordAlertMsg:"Please enter the confirm password",IsProtected:"is protected",PDF:"PDF Document",AutoFillMergeAlertMsg:"To do this, all the merged cells need to be the same size.",FillSeries:"Fill Series",CopyCells:"Copy Cells",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",CustomFormat:"Custom Number Formats",CustomFormatPlaceholder:"Type or Select a custom format",CustomFormatTypeList:"Type",UnprotectWorksheet:"Unprotect Sheet",ReEnterPassword:"Re-enter password to proceed",SheetPassword:"Password to unprotect sheet:",Fluent:"Fluent",FluentDark:"Fluent Dark",Fluent2:"Fluent 2",Fluent2Dark:"Fluent 2 Dark",Fluent2HighContrast:"Fluent 2 HighContrast",Material3:"Material 3",Material3Dark:"Material 3 Dark",CellReferenceTypoError:"We found a typo in your cell reference. Do you want to correct this reference as follows?",InvalidFormulaError:"We found that you typed a formula which is invalid.",InvalidArguments:"We found that you typed a formula with an invalid arguments.",EmptyExpression:"We found that you typed a formula with an empty expression.",MismatchedParenthesis:"We found that you typed a formula with one or more missing opening or closing parenthesis.",ImproperFormula:"We found that you typed a formula which is improper.",WrongNumberOfArguments:"We found that you typed a formula with a wrong number of arguments.",Requires3Arguments:"We found that you typed a formula which requires 3 arguments.",MismatchedStringQuotes:"We found that you typed a formula with a mismatched quotes.",FormulaCircularRef:"We found that you typed a formula with a circular reference.",AddCurrentSelection:"Add current selection to filter",ExternalWorkbook:"An imported excel file contains an external workbook reference. Do you want to import that file?"},Rz=(function(){function o(t){this.uniqueOBracket="\x81",this.uniqueCBracket="\x82",this.uniqueCSeparator="\x83",this.uniqueCOperator="\x84",this.uniquePOperator="\x85",this.uniqueSOperator="\x86",this.uniqueMOperator="\x87",this.uniqueDOperator="\x88",this.uniqueModOperator="\x89",this.uniqueConcateOperator="\x8A",this.uniqueEqualOperator="\x8B",this.uniqueExpOperator="\x8C",this.uniqueGTOperator="\x8D",this.uniqueLTOperator="\x8E",this.sheetInfo=[],this.parent=t,this.init()}return o.prototype.init=function(){var t=this;this.addEventListener(),this.initCalculate(),this.registerSheet(),this.parent.customFormulaCollection.forEach(function(e,i){t.addCustomFunction(e.handler,i,e.description)})},o.prototype.destroy=function(){var t=this;if(this.removeEventListener(),this.parent.refreshing){this.clearAllUniqueFormulaValue();var e=this.calculateInstance.getLibraryFormulas();e.forEach(function(i,r){i.isCustom&&t.parent.customFormulaCollection.set(r,{handler:i.handler,description:i.description})})}this.calculateInstance.dispose(),this.calculateInstance=null,this.sheetInfo&&(this.sheetInfo=[]),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(At,this.performFormulaOperation,this),this.parent.on(ag,this.aggregateComputation,this),this.parent.on(xM,this.getUniqueRange,this),this.parent.on(zd,this.removeUniquecol,this),this.parent.on($c,this.clearFormulaDependentCells,this),this.parent.on(zb,this.formulaInValidation,this),this.parent.on(Ss,this.refreshInsertDelete,this),this.parent.on(e0,this.getUpdatedFormulaOnInsertDelete,this),this.parent.on(OM,this.autoCorrectCellRef,this),this.parent.on(t0,this.parseFormulaArgument,this),this.parent.on(zM,this.getCellRefValue,this),this.parent.on(zc,this.commputeFormulaValue,this),this.parent.on(Mg,this.renameUpdation,this),this.parent.on(aa,this.initFormulaOnImport,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(At,this.performFormulaOperation),this.parent.off(ag,this.aggregateComputation),this.parent.off(xM,this.getUniqueRange),this.parent.off(zd,this.removeUniquecol),this.parent.off($c,this.clearFormulaDependentCells),this.parent.off(zb,this.formulaInValidation),this.parent.off(Ss,this.refreshInsertDelete),this.parent.off(e0,this.getUpdatedFormulaOnInsertDelete),this.parent.off(OM,this.autoCorrectCellRef),this.parent.off(t0,this.parseFormulaArgument),this.parent.off(zM,this.getCellRefValue),this.parent.off(zc,this.commputeFormulaValue),this.parent.off(Mg,this.renameUpdation),this.parent.off(aa,this.initFormulaOnImport))},o.prototype.getModuleName=function(){return"workbookFormula"},o.prototype.initCalculate=function(){this.calculateInstance=new c9(this.parent),this.calcID=this.calculateInstance.createSheetFamilyID(),this.calculateInstance.setTreatEmptyStringAsZero(!0),this.calculateInstance.grid=this.parent.getActiveSheet().id.toString(),this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator);var t=Ki(this.parent.locale).decimal;t!=="."&&this.parent.listSeparator!==t&&this.calculateInstance.setParseDecimalSeparator(t)},o.prototype.clearFormulaDependentCells=function(t){if(t.isOpen){this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.calculateInstance.getDependentFormulaCells().clear();return}var e=t.cellRef.split(":")[0],i=this.parent.getActiveSheet().id.toString(),r=this.calculateInstance.getSheetFamilyItem(i);r.isSheetMember&&!g(r.parentObjectToToken)&&(e=r.parentObjectToToken.get(i)+e),t.clearFormulaInfo&&this.calculateInstance.getFormulaInfoTable().has(e)&&this.calculateInstance.getFormulaInfoTable().delete(e),this.calculateInstance.clearFormulaDependentCells(e)},o.prototype.formulaInValidation=function(t){var e=this.calculateInstance.getLibraryFormulas().get(t.value);t.skip=g(e)},o.prototype.performFormulaOperation=function(t){var e=t.action,i,r;e!=="refreshCalculate"&&(i=this.calculateInstance.getLibraryFormulas(),r=Array.from(i.values()));var n,s=this.calculateInstance.getSheetFamilyItem(t.sheetId),a;switch(e){case"getLibraryFormulas":t.formulaCollection=Array.from(i.keys());break;case"getFormulaCategory":n=["All"];for(var l=1;l<Array.from(i.values()).length;l++)n.indexOf(r[l].category)<0&&n.push(r[l].category);t.categoryCollection=n;break;case"dropDownSelectFormulas":a=this.parent.serviceLocator.getService(ve);for(var l=0;l<Array.from(i.values()).length;l++){var h=r[l].category&&a.getConstant(r[l].category.split(" ").join("").replace("&",""));t.selectCategory===h&&(t.formulaCollection[l]=Array.from(i.keys())[l])}break;case"getFormulaDescription":for(var l=0;l<Array.from(i.values()).length;l++)t.selectedList===Array.from(i.keys())[l]&&(t.description=r[l].description,t.isCustom=r[l].isCustom);break;case"registerSheet":this.registerSheet(t.sheetIndex,t.sheetCount);break;case"unRegisterSheet":this.unRegisterSheet(t.sheetIndex,t.sheetCount,t.propertyChange,t.isNewWorkBook);break;case"initSheetInfo":this.updateSheetInfo();break;case"refreshCalculate":this.refreshCalculate(t);break;case"refreshRandomFormula":this.refreshRandomFormula(),this.calculateInstance.cell="";break;case"setArgumentSeparator":this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator);break;case"addDefinedName":t.isAdded=this.addDefinedName(t.definedName,!1,t.index,t.isEventTrigger);break;case"removeDefinedName":t.isRemoved=this.removeDefinedName(t.definedName,t.scope,t.isEventTrigger);break;case"initiateDefinedNames":this.initiateDefinedNames();break;case"addSheet":this.sheetInfo.push({visibleName:t.visibleName,sheet:t.sheetName,index:t.sheetId});break;case"getSheetInfo":t.sheetInfo=this.sheetInfo;break;case"deleteSheetTab":for(var l=0;l<this.sheetInfo.length;l++)if(this.sheetInfo[l].index===t.sheetId){var c=this.sheetInfo[l].visibleName,u=this.sheetInfo[l].sheet;this.sheetInfo.splice(l,1);var d=t.sheetId.toString();this.sheetDeletion(u,d),this.calculateInstance.unregisterGridAsSheet(d,d),this.definedNamesDeletion(c);break}break;case"getReferenceError":t.refError=this.referenceError();break;case"getAlpha":t.col=li(t.col);break;case"addCustomFunction":this.addCustomFunction(t.functionHandler,t.functionName,t.formulaDescription);break;case"computeExpression":t.calcValue=this.calculateInstance.computeExpression(t.formula,t.isFromComputeExpression);break;case"registerGridInCalc":this.calculateInstance.grid=t.sheetID;break;case"dependentCellsAvailable":case"checkFormulaAdded":s.isSheetMember&&!g(s.parentObjectToToken)&&(t.address=s.parentObjectToToken.get(t.sheetId)+t.address),e==="checkFormulaAdded"?t.added=this.calculateInstance.getFormulaInfoTable().has(t.address):t.isAvailable=this.calculateInstance.getDependentCells().has(t.address);break;case"calculateNow":this.calculateNow(t);break;case"ClearDependentCellCollection":this.calculateInstance.getDependentFormulaCells().clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear();break}},o.prototype.initFormulaOnImport=function(){this.registerSheet(),this.calculateInstance.setParseArgumentSeparator(this.parent.listSeparator),this.updateSheetInfo(),this.initiateDefinedNames()},o.prototype.definedNamesDeletion=function(t){var e=this.parent.definedNames;if(e&&e.length>0)for(var i=e.length-1;i>=0;i--)e[i].refersTo.substring(1,e[i].refersTo.lastIndexOf("!")).split("'").join("")===t&&this.removeDefinedName(e[i].name,e[i].scope)},o.prototype.referenceError=function(){return this.calculateInstance.getErrorStrings()[W.Ref]},o.prototype.getSheetInfo=function(){return this.sheetInfo},o.prototype.addCustomFunction=function(t,e,i){this.calculateInstance.defineFunction(e,t,i)},o.prototype.updateSheetInfo=function(){var t=this;this.sheetInfo=[],this.parent.sheets.forEach(function(e){t.sheetInfo.push({visibleName:e.name,sheet:"Sheet"+e.id,index:e.id})})},o.prototype.getSheetRefUpdateOnDelete=function(){var t=this,e=this.calculateInstance.namedRanges,i,r,n;return e&&e.size&&(n=!0,i=Array.from(e.keys()),r=Array.from(e.values())),function(s,a){var l;n&&!a.includes(s)&&(a=a.replace(/\w+/g,function(u){var d=i.indexOf(u);return d!==-1?(l=!0,r[d]):u}));var h=s.toUpperCase();a=a.toUpperCase();for(var c=a.indexOf(h);c>-1;)a=a.split((a[c-1]==="'"&&a[c+h.length]==="'"?"'"+h+"'":h)+t.calculateInstance.sheetToken).join(t.referenceError()),c=a.indexOf(h);return{value:a,isNamedRange:l}}},o.prototype.sheetDeletion=function(t,e){var i=this,r=this.calculateInstance.getDependentCells(),n,s,a=this.calculateInstance.getSheetFamilyItem(e),l=this.getSheetRefUpdateOnDelete(),h;r.forEach(function(c,u){c.forEach(function(d){n=i.calculateInstance.getFormulaInfoTable().get(d),g(n)||(h=l(t,n.formulaText),h.value!==n.formulaText&&(s=d.slice(0,d.lastIndexOf(i.calculateInstance.sheetToken)+1),h.sheetId=a.tokenToParentObject.has(s)?Number(a.tokenToParentObject.get(s)):parseInt(d.split("!")[1],10)+1,i.updateDataContainer([i.calculateInstance.rowIndex(d)-1,i.calculateInstance.colIndex(d)-1],h),i.calculateInstance.refresh(n.getParsedFormula()))),s=u.slice(0,u.lastIndexOf(i.calculateInstance.sheetToken)+1),e===(a.tokenToParentObject.has(s)?a.tokenToParentObject.get(s):u.split("!")[1])&&(i.calculateInstance.getFormulaInfoTable().delete(u),i.calculateInstance.clearFormulaDependentCells(u))})})},o.prototype.renameUpdation=function(t){var e=this,i=t.value,r=t.pName,n,s,a=t.pName.toUpperCase(),l=new RegExp(`[!@#$%^&()+=';,.{}|\\":<>~_-]`,"g"),h=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,c=RegExp,u=new c(r.replace(l,"\\$&")+h,"gi"),d=function(p){pt(p.value1)&&p.value1.toUpperCase().includes(a)&&p.value1.match(u)&&(p.value1=p.value1.replace(u,i)),pt(p.value2)&&p.value2.toUpperCase().includes(a)&&p.value2.match(u)&&(p.value2=p.value2.replace(u,i))};this.sheetInfo.forEach(function(p,f){if(n=ke(e.parent,f),n&&n.rows&&n.rows.length){for(var v=0,m=n.rows.length;v<m;v++)if(n.rows[v]&&n.rows[v].cells)for(var y=0,b=n.rows[v].cells.length;y<b;y++)s=Q(v,y,n,!1,!0),s.formula&&pt(s.formula)&&s.formula.toUpperCase().includes(a)&&s.formula.match(u)&&(s.formula=s.formula.replace(u,i)),s.validation&&d(s.validation),s.chart&&s.chart.length&&s.chart.forEach(function(I){if(I.range.includes("!")){var D=I.range.lastIndexOf("!"),M=I.range.substring(0,D).toUpperCase();M.startsWith("'")&&M.endsWith("'")&&(M=M.slice(1,-1)),M===a&&(I.range=i+I.range.substring(D))}})}if(n&&n.columns&&n.columns.length)for(var S=void 0,v=0,C=n.columns.length;v<C;v++)S=n.columns[v],S&&S.validation&&d(S.validation);for(var x=e.parent.definedNames,v=0;v<x.length;v++)pt(x[v].refersTo)&&x[v].refersTo.includes(r)&&x[v].refersTo.match(u)&&(x[v].refersTo=x[v].refersTo.replace(u,i),x[v].scope.includes(r)&&(x[v].scope=i));e.calculateInstance.updateNamedRange(r,i),p.visibleName===r&&(p.visibleName=i)})},o.prototype.updateDataContainer=function(t,e){for(var i,r,n,s=0,a=this.parent.sheets.length;s<a;s++)if(i=ke(this.parent,s),i.id===e.sheetId){t[0]in i.rows?(r=i.rows[t[0]],t[1]in r.cells?(n=r.cells[t[1]],n.formula=e.isNamedRange?n.formula:e.value,e.visible?s===this.parent.activeSheetIndex&&i.activeCell===st(t[0],t[1])&&this.parent.notify(Ta,{}):this.parent.calculationMode==="Automatic"&&(n.value=this.referenceError())):r.cells[t[1]]=n={}):(r=i.rows[t[0]]={},r[t[1]]=n={});break}},o.prototype.parseSheetRef=function(t,e){var i,r=new RegExp(`[!@#$%^&()+=';,.{}|":<>~_-]`,"g"),n=0,s=this.getSheetInfo(),a=s.length,l=[];l.length=0;var h,c,u,d,p,f=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,v=RegExp;for(n=0;n<a;n++)if(s[n].sheet!==s[n].visibleName&&(i=new v(s[n].visibleName.replace(r,"\\$&")+f,"gi"),u=n,t.match(i))){for(var m=n+1;m<a;m++)s[m].visibleName.includes(s[n].visibleName)&&(h=new v(s[m].visibleName.replace(r,"\\$&")+f,"gi"),c=t.search(h),d=t.search(i),c>-1&&(c<d||c===d&&s[m].visibleName.length>s[n].visibleName.length)&&(p=new RegExp("Sheet","gi"),s[m].visibleName.search(p)!==0&&(i=h,u=m)));t=t.replace(i,u+"/"),l.push(u)}n=0;for(var y;n<l.length;)i=new v(l[n]+"/"+f,"gi"),y=e?"`"+s[l[n]].sheet+"`":s[l[n]].sheet,t=t.replace(i,y),n++;return t},o.prototype.registerSheet=function(t,e){t===void 0&&(t=0),e===void 0&&(e=this.parent.sheets.length);for(var i;t<e;)i=ke(this.parent,t).id+"",this.calculateInstance.registerGridAsSheet(i,i,this.calcID),t++},o.prototype.unRegisterSheet=function(t,e,i,r){t===void 0&&(t=0),e===void 0&&(e=this.parent.sheets.length);var n;if(this.calculateInstance.tokenCount=0,i)this.calculateInstance.unregisterGridAsSheet(n,n,i);else if(r){for(var s=this.sheetInfo.length-1;s>=0;s--){var a=this.sheetInfo[s].visibleName;n=this.sheetInfo[s].index.toString(),this.calculateInstance.unregisterGridAsSheet(n,n),this.definedNamesDeletion(a)}this.clearFormulaDependentCells({isOpen:!0})}else for(;t<e;)n=ke(this.parent,t).id+"",this.calculateInstance.unregisterGridAsSheet(n,n),t++},o.prototype.getUniqueRange=function(t){t.range=this.calculateInstance.uniqueRange},o.prototype.removeUniquecol=function(t){if(t&&t.clearAll){this.clearAllUniqueFormulaValue();return}for(var e=this.parent.getActiveSheet(),i=0;i<this.calculateInstance.uniqueRange.length;i++){var r=this.calculateInstance.uniqueRange[i].split(":")[0].split("!");if(r[0]===e.name&&r[1]===e.activeCell){var n=ie(this.calculateInstance.uniqueRange[i]);this.calculateInstance.uniqueRange.splice(i,1);for(var s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++){var l=Q(s,a,this.parent.getActiveSheet());l.formula="",this.parent.updateCellDetails({value:"",formula:""},Ve([s,a]),void 0,void 0,!0)}}}},o.prototype.refreshCalculate=function(t){t.sheet=g(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex);var e=t.sheet.id+"",i=this.calculateInstance.getSheetFamilyItem(e),r=ji(t.colIndex+1)+(t.rowIndex+1);i.isSheetMember&&!g(i.parentObjectToToken)&&(r=i.parentObjectToToken.get(e)+r),t.isFormula?this.calculateFormula(t,r):(this.calculateInstance.getFormulaInfoTable().has(r)&&(this.calculateInstance.getFormulaInfoTable().delete(r),this.calculateInstance.clearFormulaDependentCells(r)),this.calculateInstance.refresh(r,null,null,null,t.isDelete,t.deletedRange),this.parent.calculationMode==="Automatic"&&this.calculateInstance.refreshRandValues(r)),this.calculateInstance.cell="",t.isFormulaDependent=this.calculateInstance.getDependentCells().has(r),t.value&&(t.value=t.value.toString().split("^+").join("^").split("&+").join("&"))},o.prototype.calculateFormula=function(t,e){var i=this,r=t.sheet;this.autoCorrectFormula(t,r);var n=t.value;t.isClipboard&&n.toUpperCase().includes("UNIQUE")&&Zt(t.rowIndex,t.colIndex,r,{value:""},!0);var s=n;n=this.parseSheetRef(n);var a=new mz(t.rowIndex+1,t.colIndex+1,n),l=[r.usedRange.rowIndex,r.usedRange.colIndex];this.calculateInstance.valueChanged(r.id.toString(),a,!0,l,t.isRefreshing,r.name,t.isRandomFormula,null,t.isDelete,t.deletedRange,t.isDependentRefresh,t.action),this.calculateInstance.isRandomVal===!0&&!t.isRandomFormula&&this.parent.calculationMode==="Automatic"&&this.refreshRandomFormula();var h=Q(t.rowIndex,t.colIndex,r);if(h&&s&&!t.isDependentRefresh){s=s.toUpperCase();var c=void 0;if(s.indexOf("=SUM(")===0?c="=SUM(":s.indexOf("=AVERAGE(")===0?c="=AVERAGE(":s.indexOf("=ROUNDDOWN(")===0?c="=ROUNDDOWN(":s.indexOf("=ROUNDUP(")===0?c="=ROUNDUP(":s.indexOf("=MOD(")===0&&(c="=MOD("),c){if(s=s.replace(c,""),s.includes(")")){s=s.slice(0,s.lastIndexOf(")"));for(var u=void 0,d=void 0;s.includes("(")&&s.includes(")");)d=s.indexOf("("),u=s.slice(d+1),s=s.slice(0,d)+(u.includes(")")?u.slice(u.indexOf(")")+1):u)}for(var p=s.split(this.calculateInstance.getParseArgumentSeparator()),f,v=void 0,m=void 0,y=void 0,b=void 0,S=void 0,C=function(k){if(f=p[k].split(":")[0],f.includes("!")?(b=f.substring(0,f.lastIndexOf("!")).split("'").join(""),f=f.substring(f.lastIndexOf("!")+1)):b="",Or(f)){b?(y=Ct(x.parent,b),m=y!==void 0?ke(x.parent,y):r):m=r,S=ie(f),v=Q(S[0],S[1],m);var B=en(h.format),F=["Number","Currency","LongDate","Time"];if(v&&v.format&&(!h.format||!t.fillType&&F.every(function(O){return B!==O})&&en(v.format)!=="Number"))return h.format=v.format,"break"}},x=this,d=0;d<p.length;d++){var I=C(d);if(I==="break")break}}else{var D=this.calculateInstance.getDependentFormulaCells().get(e);if(D&&D.size&&this.calculateInstance.getFormulaInfoTable().has(e)&&this.calculateInstance.getFormulaInfoTable().get(e).getParsedFormula().lastIndexOf("q")===-1&&!h.format){var M,E,A,L,N,R,P=this.calculateInstance.getSheetFamilyItem(null,this.calcID);D.forEach(function(k){M||(A=k.slice(0,k.lastIndexOf("!")+1),k=k.replace(A,""),Or(k)&&(R=ie(k),P.tokenToParentObject.has(A)?(N=Cn(i.parent,Number(P.tokenToParentObject.get(A))),L=N!==void 0?ke(i.parent,N):r):L=r,E=Q(R[0],R[1],L),E&&E.format&&(M=E.format)))}),M&&(h.format=M)}}}},o.prototype.refreshRandomFormula=function(){var t,e,i="",r=this.calculateInstance.randCollection;if(this.calculateInstance.randomValues.size>1&&this.calculateInstance.randomValues.size===r.length)for(var n=0;n<this.calculateInstance.randomValues.size;n++){t=this.calculateInstance.rowIndex(r[n]),e=this.calculateInstance.colIndex(r[n]),i=this.calculateInstance.randomValues.get(r[n]);var s=(parseFloat(this.calculateInstance.getSheetToken(r[n]).split(this.calculateInstance.sheetToken).join(""))+1).toString(),a=ke(this.parent,Cn(this.parent,Number(s)));if(a&&Q(t-1,e-1,a).formula){var l=new mz(t,e,i);this.calculateInstance.valueChanged(s,l,!0,void 0,void 0,void 0,!1,!0)}}},o.prototype.autoCorrectFormula=function(t,e){if(!g(t.value)){var i=t.value;i=this.autoCorrectCellRef({formula:t.value}),i=i.toString(),i.split("(").length===2&&i.indexOf(")")<0&&(i+=")");var r=void 0;i.indexOf("=")===0&&(i=i.slice(1),r=!0);var n=i.match(/</g),s=i.match(/>/g),a=i.match(/=/g);if(n){for(var l="",h=0;h<n.length;h++)l=l+n[h];i=i.replace(l,"<")}if(s){for(var c="",u=0;u<s.length;u++)c=c+s[u];i=i.replace(c,">")}if(a){for(var d="",p=0;p<a.length;p++)d=d+a[p];i=i.split(d).join("=")}i=r?"="+i:i,(n||s||a)&&(Q(t.rowIndex,t.colIndex,e).formula=i),t.value=i}},o.prototype.correctCellReference=function(t){var e=this,i=t.split(":"),r,n,s,a,l;return i.forEach(function(h,c){if(n=h.split("!"),t=n[1]||h,l=null,t.includes("&"))r=t.split("&"),e.calculateInstance.isCellReference(r[1].split("$").join(""))&&(r[1]=e.getUpdatedCellRef(r[1]),l=r.join("&"));else if(e.calculateInstance.isCellReference(t.split("$").join("")))l=e.getUpdatedCellRef(t),n.length>1&&(l=n[0]+"!"+l);else if(s=h.match(/[/+\-*^><>=<=<>]+/g),s){r=h.split(s[0]);for(var u=0;u<r.length;u++)n=r[u].split("!"),t=n[1]||n[0],e.calculateInstance.isCellReference(t.split("$").join(""))&&(r[u]=e.getUpdatedCellRef(t),n.length>1&&(r[u]=n[0]+"!"+r[u]));l=r.join(s[0])}l&&l!==h&&(a=!0,i[c]=l)}),{isInvalid:a,ref:i.join(":")}},o.prototype.autoCorrectCellRef=function(t){var e=t.formula.lastIndexOf(")"),i;if(e>-1&&t.formula.split(")").length===2){for(var r=e-1;r>-1&&t.formula[r]!=="(";){if(t.formula[r]===")")return t.formula;r--}if(r>-1){for(var n=t.formula.substring(r+1,e),s=this.calculateInstance.getParseArgumentSeparator(),a=n.split(s),l=void 0,h=0;h<a.length;h++)i=this.correctCellReference(a[h]),i.isInvalid&&(l=!0,a[h]=i.ref);l&&(t.formula=t.formula.split(n).join(a.join(s)),t.isInvalid=!0)}}else t.formula.startsWith("=")&&!t.formula.includes(")")&&(i=this.correctCellReference(t.formula.substring(1,t.formula.length)),i.isInvalid&&(t.formula="="+i.ref,t.isInvalid=!0));return t.formula},o.prototype.getUpdatedCellRef=function(t){var e=t;t=t.trim();var i=t.indexOf("$")===0,r=t.search(/[a-zA-Z]/),n=t.search(/\d/);return r=i?r-1:r,(i?n>1:n>0)&&De(t.substring(n,t.length))?e:t.substring(r,t.length)+t.substring(0,r)},o.prototype.initiateDefinedNames=function(){for(var t=this.parent.definedNames,e=0;e<t.length;){var i=t[e],r=this.parseSheetRef(i.refersTo),n=Gc(r),s=!1,a=r.indexOf("http:")>-1?!0:r.indexOf("https:")>-1;if(n=n.split("$").join(""),n=n.split("=").join(""),n.indexOf(":")>-1){var l=n.split(":");(Or(l[0])&&Or(l[1])||l[0].match(/[0-9]/)&&l[1].match(/[0-9]/)||l[0].toUpperCase().match(/[A-Z]/)&&l[1].toUpperCase().match(/[A-Z]/))&&(s=!0)}else n.indexOf(":")<0&&Or(n)&&(s=!0);a&&(s=!1),s?this.addDefinedName(i,!0,void 0,!0):(this.removeDefinedName(i.name,i.scope,!0),e--),e++}},o.prototype.addDefinedName=function(t,e,i,r){(i===void 0||i<-1)&&(i=this.parent.definedNames.length);var n=!0,s,a=t.name;if(t.refersTo.indexOf("!")<0){var l=Gn(this.parent);l=l.indexOf(" ")!==-1?"'"+l+"'":l,t.refersTo=l+"!"+(t.refersTo.indexOf("=")<0?t.refersTo:t.refersTo.split("=")[1])}var h=t.refersTo,c=this.parseSheetRef(t.refersTo);t.scope?(s=Ct(this.parent,t.scope),s>-1&&(a=Gn(this.parent,s)+"!"+a)):t.scope="Workbook",t.comment||(t.comment=""),!e&&this.checkIsNameExist(t.name,t.scope)?n=!1:(this.calculateInstance.addNamedRange(a,c[0]==="="?c.substr(1):c),c[0]!=="="&&(t.refersTo="="+h),this.parent.definedNames.indexOf(t)<0&&(this.parent.definedNames.splice(i,0,t),this.parent.notify(ho,{action:"setNameBoxValue",definedName:t})));var u={name:t.name,scope:t.scope,comment:t.comment,refersTo:t.refersTo,cancel:!1};return r||this.parent.notify("actionComplete",{eventArgs:u,action:"addDefinedName"}),n},o.prototype.removeDefinedName=function(t,e,i){var r=!1,n=e||"Workbook",s=this.getIndexFromNameColl(t,n);if(s>-1){var a=t;if(e){var l=Ct(this.parent,e);l>-1&&(a=Gn(this.parent,l)+"!"+t)}this.calculateInstance.removeNamedRange(a);var h=this.parent.definedNames.splice(s,1);if(this.parent.notify(ho,{action:"setNameBoxValue",definedName:h[0],isRemove:!0}),!i){var c={name:t,scope:n,cancel:!1};this.parent.notify("actionComplete",{eventArgs:c,action:"removeDefinedName"})}r=!0}return r},o.prototype.checkIsNameExist=function(t,e){var i=this.parent.definedNames.some(function(r){return r.name===t&&(e?r.scope===e:r.scope==="")});return i},o.prototype.getIndexFromNameColl=function(t,e){e===void 0&&(e="");var i=-1;return this.parent.definedNames.filter(function(r,n){r.name===t&&r.scope===e&&(i=n)}),i},o.prototype.calculateNow=function(t){var e=this,i=new zn;t.promise=i.promise;var r,n=function(){var h,c,u,d,p={isRefreshing:!0,action:"calculate"},f=e.calculateInstance.getFormulaInfoTable();t.sheets.forEach(function(v){u=v.id.toString(),h=e.calculateInstance.getSheetFamilyItem(u),c=h.isSheetMember?h.parentObjectToToken.get(u):"",e.parent.setSheetPropertyOnMute(v,"isSheetCalculated",!0),p.sheet=v,v.rows.forEach(function(m,y){p.rowIndex=y,m&&m.cells&&m.cells.forEach(function(b,S){b&&pt(b.formula)&&(d=c+ji(S+1)+(y+1),(b.value===void 0||b.value===null||!f.has(d)||r&&r[d])&&(p.colIndex=S,p.value=b.formula,e.calculateFormula(p,d)))})})}),i.resolve(),e.calculateInstance.cell=""},s=t.sheets.length,a=function(){if(s--,!s){n(),e.parent.calculationMode==="Automatic"&&t.scope==="CalculateWorkbook"&&e.parent.setProperties({calculationMode:"Manual"},!0);var h=e.parent.getActiveSheet();h.conditionalFormats&&h.conditionalFormats.length&&e.parent.notify(Gi,{indexes:[],isAction:!0,refreshAll:!0,isEdit:!0})}},l=function(h){var c=h.id.toString(),u=e.calculateInstance.getSheetFamilyItem(c),d=u.isSheetMember?u.parentObjectToToken.get(c):"";r={};var p=e.calculateInstance.getDependentCells();return function(f,v){var m=d+st(f,v);p.has(m)&&p.get(m).forEach(function(y){r[y]||(r[y]=!0)})}};t.sheets.forEach(function(h){h.ranges.some(function(c){return c.dataSource&&(!c.info||!c.info.loadedRange||!c.info.loadedRange.length)})?e.parent.notify(Bh,{sheet:h,autoDetectFormat:!0,loadFromStartCell:!0,updateDependentCellsCallback:l(h),loadComplete:a}):a()})},o.prototype.toFixed=function(t){var e=Number(t);return Math.round(e)!==e&&(t=e.toFixed(2)),t},o.prototype.commputeFormulaValue=function(t){var e=this.parseSheetRef(t.value);t.value=this.calculateInstance.computeExpression(e).toString()},o.prototype.getCellRefValue=function(t){var e,i=this.getSheetInfo(),r=i.length,n=this.calculateInstance.sheetToken,s=t.value,a=s.lastIndexOf(n);if(a!==-1){var l=s.substring(0,a);l.length>0&&l[0]===this.calculateInstance.getFormulaCharacter()&&(l=l.substring(1,t.value.length));for(var h=0;h<r;h++)if(l.toUpperCase()===i[h].visibleName.toUpperCase()){e=h;break}t.value=this.calculateInstance.getValueFromArg(n+e+n+s.substring(a+1).toUpperCase())}else s.length>0&&s[0]===this.calculateInstance.getFormulaCharacter()&&(t.value=this.calculateInstance.getValueFromArg(s.substring(1,t.value.length).toUpperCase()))},o.prototype.aggregateComputation=function(t){var e=this,i=this.parent.getActiveSheet(),r=0,n=0,s=0,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,h,c,u,d=Xd(this.parent),p=function(){if(u=Q(h,c,i),!(!u||Ft(i,c))&&(u.formula&&g(u.value)&&e.parent.notify(zl,{cell:u,rowIdx:h,colIdx:c,sheetIndex:e.parent.activeSheetIndex}),d(u),(u.value||u.value===0)&&(r++,De(u.value)))){t.countOnly=!1;var x=Number(u.value);n+=x,s++,a=Math.min(a,x),l=Math.max(l,x)}},f,v=i.selectedRange.split(" "),m=new Set;if(v.length>1?f=function(){var x=""+h+c;m.has(x)||(m.add(x),p())}:f=function(){return p()},v.forEach(function(x){var I=tt(ie(x));for(I[2]>i.usedRange.rowIndex&&(I[2]=i.usedRange.rowIndex),I[3]>i.usedRange.colIndex&&(I[3]=i.usedRange.colIndex),h=I[0];h<=I[2];h++)if(!lt(i,h))for(c=I[1];c<=I[3];c++)f()}),t.Count=r,!(!t.Count||t.countOnly)){var y=s>0?n/s:0,b=[n,y,a,l],S=[],C=ie(i.activeCell);u=Q(C[0],C[1],i,!1,!0),b.forEach(function(x){var I=x.toString();if(u.format&&u.format!=="General"){var D={formattedText:I,value:I,format:u.format,cell:{value:I,format:u.format}};e.parent.notify(yr,D),I=D.formattedText}else I=e.toFixed(I);S.push(I)}),t.Sum=S[0],t.Avg=S[1],t.Min=S[2],t.Max=S[3]}},o.prototype.refreshInsertDelete=function(t){var e=this;if(t.modelType!=="Sheet"){var i=this.calculateInstance.getDependentFormulaCells(),r,n=Cn(this.parent,t.sheet.id);this.parent.sheets.forEach(function(s,a){for(var l=0,h=s.usedRange.rowIndex;l<=h;l++)for(var c=0,u=s.usedRange.colIndex;c<=u;c++)r=Q(l,c,s,!1,!0),r.formula&&pt(r.formula)&&(a===n?(t.isInsert||!(t.modelType==="Row"?l>=t.startIndex&&l<=t.endIndex:c>=t.startIndex&&c<=t.endIndex))&&e.updateFormula(t,r,l,c,n):r.formula.includes(t.sheet.name)&&e.updateFormula(t,r,l,c,n,!0,s))}),i.clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.refreshNamedRange(t)}},o.prototype.getUpdatedFormulaOnInsertDelete=function(t){if(t.sheetNames){t.updateSheetRef||(t.updateSheetRef=this.getSheetRefUpdateOnDelete());var e=this.parseSheetRef(t.cell.formula,!1),i=e;t.sheetNames.forEach(function(r){i=t.updateSheetRef(r,i).value}),i!==e&&(t.cell.formula=i)}else this.updateFormula(t.insertDeleteArgs,t.cell,t.row,t.col,t.sheetIdx,t.otherSheet,t.formulaSheet)},o.prototype.updateFormula=function(t,e,i,r,n,s,a){var l,h,c,u,d,p=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),f,v;e.formula&&e.formula.includes("UNIQUE")&&e.value!=="#SPILL!"&&i!==void 0&&this.clearUniqueRange(i,r,a||t.sheet);for(var m=function(){var L=(x?"$":"")+ji(c[1]+1)+(x?"$":"")+(c[0]+1);return(c[0]!==c[2]||c[1]!==c[3])&&(L+=":"+(x?"$":"")+ji(c[3]+1)+(x?"$":"")+(c[2]+1)),L},y=this.parseFormulaArgument({formula:this.parseSheetRef(e.formula,!0),rangeRef:!0}),b=this.getSheetInfo(),S,C,x,I=!e.formula.includes(this.parent.listSeparator),D=0;D<y.length;D++)if(l=y[D].trim(),x=l.includes("$"),x&&(l=l.replace(/[$]/g,"")),f=!0,this.calculateInstance.isCellReference(l)){if(d=l.includes(":"),h=D&&y[D-1].trim(),h&&h[h.length-1]==="!"){if(h=h.replace(/['!]/g,""),S=b[n].sheet===b[n].visibleName?t.sheet.name:"`"+b[n].sheet+"`",h!==S)continue}else if(s)continue;!p.test(l)&&l.indexOf(":")>-1&&(f=!1,v=!!g(l.match(/[0-9]/))),c=tt(ie(l)),u=this.parent.updateRangeOnInsertDelete(t,c,d,i,r,x,I),u&&(y[D]=c[2]<c[0]||c[3]<c[1]?this.calculateInstance.getErrorStrings()[W.Ref]:f?m():v?Ve(c).replace(/\d/g,""):Ve(c).replace(/[a-zA-Z]/g,""),C=!0)}var M="="+y.join("");if(C){var E,A=RegExp;b.forEach(function(L){M.includes("`"+L.sheet+"`")&&(E=new A("`"+L.sheet+"`","gi"),M=M.replace(E,L.visibleName))}),e.formula!==M&&(e.formula=M,!(this.parent.calculationMode==="Manual"&&(t.isInsert||t.isDelete))&&!(e.formula.includes("UNIQUE")&&e.value==="#SPILL!")&&(e.value=null))}},o.prototype.clearUniqueRange=function(t,e,i){var r={cellIdx:[t,e,t,e],isUnique:!1,uniqueRange:"",sheetName:i.name};this.parent.notify(Kc,r);for(var n=ie(r.uniqueRange),s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++)delete Q(s,a,i,!1,!0).value},o.prototype.clearAllUniqueFormulaValue=function(){for(var t=this.calculateInstance.uniqueRange,e,i,r,n=0;n<t.length;n++){var s=t[n].lastIndexOf("!");if(i=ke(this.parent,Ct(this.parent,t[n].substring(0,s))),r=ie(t[n].substring(s+1)),e=Q(r[0],r[1],i),!(e&&e.value==="#SPILL!"))for(var a=r[0];a<=r[2];a++)for(var l=r[1];l<=r[3];l++)e=Q(a,l,i),e&&e.value&&delete e.value}},o.prototype.parseFormulaArgument=function(t){var e,i,r=0,n=[],s=this.markSpecialChar(t.formula.replace("=",""),t.rangeRef),a=RegExp,l=new a(t.rangeRef?/\(|\)|=|\^|>|<|\+|-|\*|\/|%|&/g:/\(|\)|=|\^|>|<|:|\+|-|\*|\/|%|&/g),h=new a(this.parent.listSeparator,"g");s=s.split(new a(l.source+"|"+h.source,"g"));for(var c=s.length;r<c;){if(e=s[r],!e){r++;continue}e.length===1?n.push(this.isUniqueChar(e)?this.getUniqueCharVal(e):e):(i=e[0],e.indexOf("!")>0?(this.isUniqueChar(i)&&(n.push(this.getUniqueCharVal(i)),e=e.substr(1)),i=e.indexOf("!")+1,n.push(e.substring(0,i)),e=e.substring(i),i=e.indexOf(":"),i>-1&&e.indexOf("!")>i?(n.push(e.substring(0,i)),n.push(":"),e=e.substring(i+1),i=e.indexOf("!")+1,n.push(e.substring(0,i)),n.push(e.substring(i))):n.push(e)):this.isUniqueChar(i)?(n.push(this.getUniqueCharVal(i)),n.push(e.substr(1))):n.push(e)),r++}return t.formulaArr=n,n},o.prototype.getUniqueCharVal=function(t){switch(t){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return this.parent.listSeparator;case this.uniqueCOperator:return":";case this.uniquePOperator:return"+";case this.uniqueSOperator:return"-";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<"}return""},o.prototype.isUniqueChar=function(t){var e=t.charCodeAt(t);return e>=129&&e<=142},o.prototype.markSpecialChar=function(t,e){t=t.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket);var i=RegExp;return e?t=t.replace(new i(this.parent.listSeparator,"g"),this.parent.listSeparator+this.uniqueCSeparator):t=t.replace(new i(this.parent.listSeparator,"g"),this.parent.listSeparator+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),t=t.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),t=t.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),t=t.replace(/&/g,"&"+this.uniqueConcateOperator),t=t.replace(/=/g,"="+this.uniqueEqualOperator),t=t.replace(/\^/g,"^"+this.uniqueExpOperator),t=t.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),t.replace(/%/g,"%"+this.uniqueModOperator)},o.prototype.refreshNamedRange=function(t){var e=this;if(t.definedNames&&t.definedNames.length){t.definedNames.forEach(function(y){e.parent.removeDefinedName(y.name,y.scope),e.parent.addDefinedName(y)});return}var i=this.parent.definedNames.length;if(i)for(var r=Object.assign({},this.parent.definedNames),n,s,a,l,h,c,u,d=new RegExp(/^(?=.*[a-zA-Z])(?=.*\d)/g),p,f,v=0;v<i;v++){p=!0,l=r[v];var m=l.refersTo.lastIndexOf("!");a=l.refersTo.substring(m+1),s=l.refersTo.substring(1,m),c=s,c.match(/'/g)&&(c=c.slice(1,-1)),c===t.sheet.name&&(!d.test(a)&&a.indexOf(":")>-1&&(p=!1,f=!!g(a.match(/[0-9]/))),n=ie(a),h=this.parent.updateRangeOnInsertDelete(t,n),p?u=Ve(n):u=f?Ve(n).replace(/\d/g,""):Ve(n).replace(/[a-zA-Z]/g,""),t.isInsert?this.updateDefinedNames(l,s,u,h):t.modelType==="Row"?this.updateDefinedNames(l,s,u,h,[n[0],n[2]],t):t.modelType==="Column"&&this.updateDefinedNames(l,s,u,h,[n[1],n[3]],t))}},o.prototype.updateDefinedNames=function(t,e,i,r,n,s){if(r){var a=this.parent.definedNames.indexOf(t),l={action:"removeDefinedName",isRemoved:!1,definedName:t.name,scope:t.scope,isEventTrigger:!0};if(this.parent.notify(At,l),n){var h={name:t.name,comment:t.comment,refersTo:t.refersTo,scope:t.scope};if(h=new Iz(this.parent,"definedNames",h,!0),s.definedNames?s.definedNames.push(h):s.definedNames=[h],n[1]<n[0])return}t.refersTo=e+"!"+i,this.parent.notify(At,{action:"addDefinedName",definedName:t,isAdded:!1,index:a,isEventTrigger:!0});var c={name:t.name,scope:t.scope,comment:t.comment,refersTo:t.refersTo,cancel:!1};this.parent.notify("actionComplete",{eventArgs:c,action:"refreshNamedRange"})}},o})(),Oz=(function(){function o(t){this.parent=t,this.localeObj=Ki(this.parent.locale);var e=ut.getDependables(Br,this.parent.locale,null).dateObject;e.dayPeriods&&e.dayPeriods&&e.dayPeriods.format&&e.dayPeriods.format.wide?(this.localeObj.am=e.dayPeriods.format.wide.am||"AM",this.localeObj.pm=e.dayPeriods.format.wide.pm||"PM"):(this.localeObj.am="AM",this.localeObj.pm="PM"),this.updateLocalizedFormats(e),this.addEventListener()}return o.prototype.numberFormatting=function(t){var e=this.parent.activeSheetIndex,i=!0;t.range&&t.range.indexOf("!")>-1&&(e=Ct(this.parent,t.range.substring(0,t.range.lastIndexOf("!"))),i=e===this.parent.activeSheetIndex);var r=ke(this.parent,e),n=t.range?t.range.lastIndexOf("!")>-1?t.range.substring(t.range.lastIndexOf("!")+1):t.range:r.selectedRange,s=tt(ie(n));t.curSym=nh(this.parent.locale,Ws);for(var a,l,h,c,u,d=s[0];d<=s[2];d++){c=Yr(r,d),u=i&&!lt(r,d);for(var p=s[1];p<=s[3];p++)l=Q(d,p,r,!1,!0),h=l.format,!Pl(l,r.columns[p],c)&&!gr(this.parent,r,{cell:{format:t.format},rowIdx:d,colIdx:p})&&(l=Q(d,p,r),l.rowSpan<0||l.colSpan<0||(a={value:l.value||l.value===0?l.value:l.hyperlink?typeof l.hyperlink=="string"?l.hyperlink:l.hyperlink.address:"",format:l.format,rowIndex:d,colIndex:p,sheetIndex:e,cell:l,refresh:i,curSymbol:t.curSym},this.getFormattedCell(a),u&&(this.setCell(a),a.td&&(this.parent.notify(bM,a),l.wrap&&(!c||!c.customHeight)&&h!==t.format&&this.parent.notify(sa,{range:[d,p,d,p],wrap:!0,sheet:r,initial:!0,td:a.td,isOtherAction:!0})),h&&h!==t.format&&h.includes("[")&&HM().indexOf(Ho(t.format))===-1&&this.removeFormatColor(a,{format:h,style:l.style}))),this.parent.setUsedRange(d,p))}r.conditionalFormats&&r.conditionalFormats.length&&this.parent.notify(Gi,{indexes:s,isAction:!0,isEdit:!0}),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(Xo,{range:s})},o.prototype.isDigitPlaceHolder=function(t){return t==="#"||t==="0"||t==="?"||t==="."},o.prototype.parseToLocalizedFormat=function(t){if(t.decimalGroupSepsChanged&&(t.format.includes(".")||t.format.includes(","))){for(var e=void 0,i=void 0,r,n=t.format.split(""),s=0;s<n.length;s++)e=n[s],e==='"'?(i=t.format.indexOf('"',s+1),i>-1&&(s=i)):e==="_"||e==="*"||e==="\\"?s++:e==="["?(i=t.format.indexOf("]",s+1),i>-1&&(s=i)):e===","?this.isDigitPlaceHolder(n[s-1])&&(n[s]=this.localeObj.group):e==="."&&(n[s-1]?(r=n[s-1].toLowerCase(),["d","m","y","h"].some(function(a){return r===a})||(n[s]=this.localeObj.decimal)):n[s]=this.localeObj.decimal);t.format=n.join("")}t.curChanged&&t.format.includes('"'+t.curSym+'"')&&(t.format=t.format.split('"'+t.curSym+'"').join(t.curSym))},o.prototype.updateLocalizedFormats=function(t,e){var i=this,r;Yi={currency:["$#,##0.00","$#,##0","$#,##0_);($#,##0)","$#,##0_);[Red]($#,##0)","$#,##0.00_);($#,##0.00)","$#,##0.00_);[Red]($#,##0.00)"],accounting:['_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)','_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)','_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)','_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'],time:t.timeFormats&&t.timeFormats.medium==="HH:mm:ss"?"HH:mm:ss":"h:mm:ss AM/PM"};var n=nh(this.parent.locale,Ws),s={curChanged:n!=="$",curSym:n,decimalGroupSepsChanged:this.localeObj.decimal!=="."&&this.localeObj.group!==","};if(s.curChanged){var a=new Nt(this.parent.locale),l=a.getNumberPattern({currency:"$",useGrouping:!0,format:"c0"},!0);if(l&&l.endsWith("$")){var h=l[l.indexOf("$")-1].trim().length?"":" ";Yi.currency.forEach(function(b,S){if(b.includes("$#,##0")){var C="",x=b.split("$#,##0.")[1];if(x)for(var I=0;x[I]==="0";)C+="0",I++;C&&(C="."+C),Yi.currency[S]=b.split("$#,##0"+C).join("#,##0"+C+h+'"'+n+'"')}}),Yi.accounting.forEach(function(b,S){if(b.slice(0,b.indexOf("#")).includes("$")){var C=b.split(";"),x;C.forEach(function(I,D){I.includes("$")&&(I=I.replace("$",""),I.includes("0)")?x=I.indexOf("0)")+2:x=I.lastIndexOf(I.includes("0")?"0":I.includes("?")?"?":I.includes('"-"')?'"':"#")+1,x>0&&(C[D]=I.slice(0,x)+h+('"'+n+'"')+I.slice(x)))}),Yi.accounting[S]=C.join(";")}})}else{var c=function(b,S,C){return C[S]=b.split("$").join('"'+n+'"')};Yi.currency.forEach(c),Yi.accounting.forEach(c)}}var u=["General","0","0.00","#,##0","#,##0.00","#,##0_);(#,##0)","#,##0_);[Red](#,##0)","#,##0.00_);(#,##0.00)","#,##0.00_);[Red](#,##0.00)",Yi.currency[2],Yi.currency[3],Yi.currency[4],Yi.currency[5],"0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yyyy h:mm","mm:ss","mm:ss.0","@","[h]:mm:ss"].concat(Yi.accounting);e?(r=this.customFormats).splice.apply(r,[0,u.length].concat(u)):(this.customFormats=u,this.localizedFormats=[]);var d=[0,1,2,3,4,37,38,39,40,5,6,7,8,9,10,11,48,12,13,14,15,16,17,18,19,20,21,22,45,47,49,46,42,41,44,43],p;d.forEach(function(b,S){$t&&$t.has(b)&&(i.customFormats[S]=$t.get(b),p=[5,6,7,8].indexOf(b),p>-1?Yi.currency[p+2]=i.customFormats[S]:(p=[42,41,44,43].indexOf(b),p>-1&&(Yi.accounting[p]=i.customFormats[S]))),s.format=i.customFormats[S],i.parseToLocalizedFormat(s),i.localizedFormats[S]=s.format});for(var f=function(b){var S=v.localizedFormats.findIndex(function(C,x){return C===i.localizedFormats[b]&&x<d.length});S>-1&&(v.localizedFormats.splice(b,1),v.customFormats.splice(b,1),b--),m=b},v=this,m,y=d.length;y<this.localizedFormats.length;y++)f(y),y=m},o.prototype.localizedFormatAction=function(t){t.action==="getLocalizedFormats"?(t.defaultFormats=this.customFormats,t.localizedFormats=this.localizedFormats):t.action==="mapNumberFormatId"?this.updateLocalizedFormats(ut.getDependables(Br,this.parent.locale,null).dateObject,!0):(t.curSym=nh(this.parent.locale,Ws),t.action==="parseToDefaultFormat"?this.parseToDefaultFormat(t):(t.decimalGroupSepsChanged=this.localeObj.decimal!=="."&&this.localeObj.group!==",",t.curChanged=t.curSym!=="$",t.defaultFormat||(t.defaultFormat=t.format,this.parseToLocalizedFormat(t)),this.localizedFormats.indexOf(t.format)===-1&&(this.localizedFormats.push(t.format),this.customFormats.push(t.defaultFormat))))},o.prototype.parseToDefaultFormat=function(t){var e=this,i=this.localeObj.decimal!=="."&&t.format.includes(this.localeObj.decimal),r=this.localeObj.group!==","&&t.format.includes(this.localeObj.group),n=t.curSym!=="$"&&t.format.includes(t.curSym);if(i||r||n){var s,a,l,h=t.format.split(";");h.forEach(function(c,u){for(var d=c.split(""),p=0;p<d.length;p++)l=d[p],l==='"'?p=c.indexOf('"',p+1):l==="_"||l==="*"||l==="\\"?p++:l==="["?(s=c.indexOf("]",p+1),s>-1&&(p=s)):i&&l===e.localeObj.decimal?(a=d[p-1],a?(a=a.toLowerCase(),["d","m","y","h"].some(function(f){return a===f})||(d[p]=".")):d[p]="."):r&&l===e.localeObj.group?e.isDigitPlaceHolder(d[p-1])&&(d[p]=","):n&&(l===t.curSym?d[p]='"'+t.curSym+'"':t.curSym.startsWith(l)&&c.substring(p,p+t.curSym.length)===t.curSym&&d.splice(p,t.curSym.length,'"'+t.curSym+'"'));h[u]=d.join("")}),t.format=h.join(";")}},o.prototype.getFormattedCell=function(t){var e=t.value===void 0||t.value===null?"":t.value;t.sheetIndex=t.sheetIndex===void 0?this.parent.activeSheetIndex:t.sheetIndex;var i=ke(this.parent,t.sheetIndex),r=t.cell||Q(t.rowIndex,t.colIndex,i,!1,!0),n=!1,s=new Nt;if(t.curSymbol||(t.curSymbol=nh(this.parent.locale,Ws)),(!t.format||t.format==="General")&&!t.skipFormatCheck&&(!r.formula||!r.formula.toLowerCase().startsWith("=text("))){if(t.type=t.format="General",!r.formula||r.formula&&r.formula.indexOf("&-")===-1){var a={value:e,updatedVal:e,cell:r,isEdit:t.isEdit,intl:s};this.checkDateFormat(a),(a.isDate||a.isTime)&&(n=!0,r.value=t.value=a.updatedVal,r.format&&r.format!=="General"?(t.format=r.format,t.type=en(t.format)):r.format=t.format=cr(a.isDate?"ShortDate":"Time"))}}else t.type=en(t.format),t.skipFormatCheck&&!t.format&&t.type==="General"&&(t.format="General");if(r.format&&this.isCustomType(r)){t.type="Custom";var l=r.format.indexOf("@")>-1;e!==""&&!l&&this.isPercentageValue(e.toString(),t,r)&&(e=t.value.toString());var h=void 0,c={};$t&&xs(this.parent)&&(r.format=t.format=this.getMatchingCustomFormat(r.format));var u=r.format;r.format=r.format.split("\\").join("");var d=r.format.split(";");if(Bs(d[0],!0,c,!0))e!==""&&(t.result=this.processCustomDateTime(t,r,c.type!=="time",d),h=!t.formatApplied),t.result=t.result||r.value;else if(d.length>1){if(r.format.indexOf("<")>-1||r.format.indexOf(">")>-1)t.result=this.processCustomConditions(r,t);else{var p=Da(r,this.parent.locale,this.localeObj.group,this.localeObj.decimal,t.curSymbol);p.isNumber?(r.value=p.value,this.processCustomAccounting(r,t,d,d[0]),h=!1):(t.result=this.processCustomText(r,t,d),h=!0)}r.format=u}else if(l)h=!0,t.result=this.processCustomText(r,t);else{var p=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(p.isNumber)if(r.value=t.value=p.value,r.format.includes("E+0")){t.format!==r.format&&(t.format=r.format),this.checkAndSetColor(t);var f=t.format.split("E")[0],v=f.split(".");this.localeObj.decimal!=="."&&v.length===1&&(v=f.split(this.localeObj.decimal)),t.result=v[0].length>1?this.scientificHashFormat(t,v):this.scientificFormat(t)}else t.result=this.processCustomNumberFormat(r,t),h=!De(r.value);else r.format&&r.format.includes("[")&&this.removeFormatColor(t,{format:r.format,style:r.style}),h=t.dataUpdate=!0}t.dataUpdate?t.formattedText=t.result||(g(t.value)?"":t.value.toString()):(t.value=t.result,t.formattedText=g(t.value)?"":t.value.toString()),h?t.isRightAlign=!1:t.isRightAlign=!g(t.value)}else{var m=this.processFormats(t,e,n,r,s,i);t.formattedText=m.fResult||(t.value===void 0||t.value===null?"":t.value.toString()),t.isRightAlign=m.rightAlign}return t.rowIndex!==void 0&&(r.format&&t.formattedText&&t.formattedText!==r.value&&r.format!=="General"?r.formattedText=t.formattedText:r.formattedText&&delete r.formattedText),t.formattedText},o.prototype.isCustomType=function(t){var e=en(t.format);return e==="General"&&t.format!=="General"||e==="Time"&&this.parent.isEdit},o.prototype.processCustomFill=function(t,e,i,r){var n=t[t.indexOf("*")+1],s=t.split("*"+n);if(i.rowIndex===void 0||i.dataUpdate)r=r||this.processCustomNumberFormat({format:s.join(""),value:e.value},i);else{var a=void 0;if(s[1]){var l=parseFloat(e.value);l<0?(a=this.processCustomNumberFormat({format:s[1],value:Math.abs(l).toString()},i),r="-"+s[0].split("'").join("")):(a=this.processCustomNumberFormat({format:s[1],value:e.value},i),r=s[0].split("'").join("")),l===0&&(a=a.split("0").join(""))}else r=r||this.processCustomNumberFormat({format:s[0],value:e.value},i);i.isRowFill=!0,this.setCell(i),this.parent.notify(xg,{cell:e,cellEle:i.td,rowIdx:i.rowIndex,colIdx:i.colIndex,beforeFillText:r,repeatChar:n,afterFillText:a}),r=this.parent.isPrintingProcessing?r+a:r}return r},o.prototype.processCustomDateTime=function(t,e,i,r){var n=this;if(this.localeObj.decimal!=="."&&e.value&&e.value.toString().includes(this.localeObj.decimal)){var s=e.value.replace(this.localeObj.decimal,".");De(s)&&(e.value=t.value=s)}var a,l=function(){var D=e.value.toString();if(D.includes(n.localeObj.dateSeparator)||D.indexOf("-")>0||D.includes(n.localeObj.timeSeparator))return!0;var M=ut.getDependables(Br,n.parent.locale,null).dateObject,E=M.months["stand-alone"]&&M.months["stand-alone"].abbreviated;return E&&!!Object.keys(E).find(function(A){return D.includes(E[""+A])})};if(De(e.value)){if(r.length>1&&parseFloat(e.value)<=0&&(t.formatApplied=this.processCustomAccounting(e,t,r),t.formatApplied))return t.result}else if(a=l(),!a)return this.processCustomText(e,t,r);var h,c=r[0],u=new Nt,d=function(D){var M,E;if(a){var A=void 0;if(e.format.includes("[h]")){var L=e.value.toString().split(":");L.length>1&&Number(L[0])>=24&&(A=Number(L[0])/24,L[0]="24",e.value=L.join(":"))}if(E=cM(e.value,new Nt,n.parent.locale,c,e),M=E.dateObj&&E.dateObj.toString()!=="Invalid Date",M){if(E.dateObj.getFullYear()<1900)return"";var N=ls(E.dateObj,e.value.toString().includes(":"),E.type==="time");A>=1&&(N+=A,E.dateObj=Yn(N)),e.value=N.toString()}}else{if(n.checkAndProcessNegativeValue(t,e.value))return t.formatApplied=!0,t.formattedText;E={dateObj:Yn(parseFloat(e.value))},M=E.dateObj&&E.dateObj.toString()!=="Invalid Date"}if(M){D&&i&&(t.dateObj=E.dateObj),t.formatApplied=!0;var R=void 0;if(c.startsWith("M/d/yyyy ")){if(c=c.split(" ").splice(1).join(" "),R=u.formatDate(E.dateObj,{type:"date",skeleton:"yMd"}),c){var P=e.value.toString().split("."),k=P.length===2?Yn(parseFloat(P[0]+1+"."+P[1])):E.dateObj;R+=" "+u.formatDate(k,{type:h,format:c})}}else{if(c.includes(":")&&e.value.toString().includes("."))if(i)if(c.includes(" ")){for(var B=c.trim(),F=B.indexOf(":")-1;F>0&&B[F]!==" ";)F--;if(F<=0){F=B.lastIndexOf(":")+1;for(var O=B.includes(" a");F<B.length;){if(B[F]===" ")if(O&&B[F+1]==="a")F++,O=!1;else break;F++}if(F<B.length){var z=B.substring(0,F),Y=B.substring(F+1);if(Y&&z){Y.includes("m")&&(Y=Y.split("m").join("M"));var P=e.value.toString().split(".");R=u.formatDate(Yn(parseFloat(P[0]+1+"."+P[1])),{type:"time",format:z})+" "+u.formatDate(E.dateObj,{type:"date",format:Y})}else R=u.formatDate(E.dateObj,{type:h,format:c})}else R=u.formatDate(E.dateObj,{type:h,format:c})}else{var Y=B.substring(0,F),z=B.substring(F+1);if(Y&&z){Y.includes("m")&&(Y=Y.split("m").join("M"));var P=e.value.toString().split(".");R=u.formatDate(E.dateObj,{type:"date",format:Y})+" "+u.formatDate(Yn(parseFloat(P[0]+1+"."+P[1])),{type:"time",format:z})}else R=u.formatDate(E.dateObj,{type:h,format:c})}}else R=u.formatDate(E.dateObj,{type:h,format:c});else{var K=c.indexOf(":");if((c.endsWith(" a")||c.endsWith("ss")||c.startsWith("H"))&&(K===1||K===2)){var P=e.value.toString().split(".");R=u.formatDate(Yn(parseFloat(P[0]+1+"."+P[1])),{type:"time",format:c})}else R=u.formatDate(E.dateObj,{type:h,format:c})}else R=u.formatDate(E.dateObj,{type:h,format:c});if(c=c.toLowerCase(),c.startsWith("[h]")){var U=Number(e.value.toString().split(".")[0])*24+E.dateObj.getHours();R=U.toString()+R.slice(R.indexOf("]")+1)}else if(c.startsWith("[m")){var q=Number(e.value.toString().split(".")[0])*1440+E.dateObj.getHours()*60+E.dateObj.getMinutes();R=q.toString()+R.slice(R.indexOf("]")+1)}else c.startsWith("[s")&&(R=(Number(e.value.toString().split(".")[0])*86400+(E.dateObj.getHours()*60+E.dateObj.getMinutes())*60+E.dateObj.getSeconds()).toString())}return p?R.replace(n.localeObj.am,"A").replace(n.localeObj.pm,"P"):R}return""};c=c.split("_(").join(" ").split("_)").join(" "),e.format.indexOf("h")>-1&&(c=c.split("h").join("H"),h="time"),e.format.indexOf("s")>-1&&(h="time");var p=e.format.indexOf("A/P")>-1;if((e.format.indexOf("AM/PM")>-1||p)&&(c=c.split("H").join("h"),c=c.split("A/P").join("AM/PM").split("AM/PM").join("a"),h="time"),e.format.indexOf("d")>-1){h="date";for(var f=c.split(" "),v=void 0,m=void 0,y=void 0,b=void 0,S=0;S<f.length;S++){b=f[S].includes(this.localeObj.dateSeparator)?this.localeObj.dateSeparator:"-",m=f[S].split(b);for(var C=0;C<m.length;C++)y=m[C],v=y.match(/d/g),v&&v.length>2&&(m[C]=y.split("d").join("E"));f[S]=m.join(b)}c=f.join(" ")}if(e.format.indexOf("m")>-1){if(e.format.indexOf("s")>-1||e.format.indexOf("h")>-1){if(h="time",e.format.includes(" ")){var f=c.split(" ");(f[0].includes("d")||f[0].includes("y"))&&(f[0]=f[0].split("m").join("M"),c=f.join(" "))}}else if(h="date",c=c.split("m").join("M"),c.includes("MMMMM")){var x=c;c="MMMM";var I=d()[0];return c=x.split("MMMMM").join("p"),d(t.checkDate).split("p").join(I)}}return d(t.checkDate)},o.prototype.processCustomConditions=function(t,e){if(De(t.value)){for(var i=t.format.split(";"),r=Number(t.value),n=void 0,s=void 0,a=void 0,l=0;l<i.length;l++)if(t.format=i[l],a=Ho(t.format),a&&(t.format=t.format.split("["+a+"]").join("")),t.format.includes("[")){n=t.format.split("[")[1].split("]")[0];var h=n.split("<="),c=n.split(">="),u=n.split("<"),d=n.split(">");if(h.length===2&&r<=Number(h[1])||c.length===2&&r>=Number(c[1])||u.length===2&&r<Number(u[1])||d.length===2&&r>Number(d[1])){t.format=i[l].split("["+n+"]").join(""),s=!1;break}s=n.split(/<=|>=|<|>/).length===2}else{t.format=i[l],s=!1;break}return s?(this.removeFormatColor(e,{format:i.join(""),style:t.style}),this.processCustomFill("*#",t,e,"#####")):this.processCustomNumberFormat(t,e)}else return t.value},o.prototype.processCustomAccounting=function(t,e,i,r){var n=parseFloat(t.value);return n<0?i[1].includes("@")||(r=i[1]):n===0&&i[2]&&!i[2].includes("@")&&(r=i[2].includes(e.curSymbol+"0")?i[2].split("0").join("#"):i[2]),r?(e.result=this.processCustomNumberFormat({format:t.format,value:n<0?Math.abs(n).toString():t.value,style:t.style},e,r),!0):!1},o.prototype.processCustomText=function(t,e,i){var r=t.value||t.value?t.value.toString():"",n;if(i)if(i[3])n=i[3];else if(i[1]&&i[1].includes("@"))n=i[1];else return r;else n=t.format;var s=this.processCustomNumberFormat({format:n.split("@").join("#"),value:r.split(r).join("1")},e);return s&&(s=s.split("1").join(r),this.localeObj.decimal!=="."&&De(s)&&s.includes(".")&&(s=s.replace(".",this.localeObj.decimal))),s},o.prototype.thousandSeparator=function(t,e){for(;t;)e=e/1e3,t--;return e},o.prototype.getSeparatorCount=function(t){for(var e=0,i=["#","0"],r=0;r<t.format.length;r++)t.format[r]==='"'&&t.format[r-1]!=="\\"?r=t.format.indexOf('"',r+1):t.format[r]===","&&!(i.indexOf(t.format[r+1])>-1)&&e++;return e},o.prototype.processDigits=function(t,e){e=e.split("?").join("0");var i=t.value.toString();if(i=this.getFormattedNumber(e,parseFloat(i)),i&&i.includes(this.localeObj.decimal)){var r=i.split(this.localeObj.decimal);i=r[0]+this.localeObj.decimal+r[1].split("0").join("  ")}return i||t.value},o.prototype.processFormatWithSpace=function(t,e,i){var r=" ",n={cell:e,char:r,width:0};this.parent.notify(Zb,n);for(var s=n.width,a,l={format:t,formattedText:""},h=0;h<t.length;h++)if(t[h]==="_"){n.char=t[h+1],this.parent.notify(Zb,n);var c=n.width;a=Math.round(c/s),t=t.replace(t[h]+t[h+1],r.repeat(a))}var u=t.length-t.trim().length;if(u>0){if(l.formattedText=this.getFormattedNumber(t.trim(),i),t[0]===" "){for(var d=1,p=1;t[p]===" ";)d++,p++;u-=d,l.formattedText=r.repeat(d)+l.formattedText}l.formattedText+=r.repeat(u)}else l.formattedText=this.getFormattedNumber(t,i);return l.format=t,l},o.prototype.removeFormatColor=function(t,e){HM().indexOf(Ho(e.format))>-1&&(t.color=e.style&&e.style.color?e.style.color:"",this.applyColor(t))},o.prototype.processCustomNumberFormat=function(t,e,i){if(!t.format)return"";var r=t.value,n=Da(t,this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(n.isNumber){var s=void 0,a=void 0;t.value=n.value;var l=parseFloat(t.value.toString()),h=i||t.format;if(t.format.indexOf("[")>-1){var c=Ho(h);c?(h=h.split("["+c+"]").join(""),e.color=c.toLowerCase(),this.applyColor(e)):this.removeFormatColor(e,t)}(h.indexOf('"')>-1||h.indexOf("\\")>-1)&&(h=this.processText(h),a=l===0&&!h.includes("#")&&!h.includes("0"),a&&(h+="#"));var u=this.getSeparatorCount(t);if(u){s=!0;var d=this.thousandSeparator(u,l);h.indexOf(".")===-1&&(d=Math.round(d)),r=this.getFormattedNumber(h.split(",").join(""),d),d===0&&(r=r.replace("0",""))}if(h.indexOf("?")>-1&&(s=!0,r=this.processDigits(t,h),h=h.split("?").join("")),h.indexOf("_")>-1){s=!0;var d=this.processFormatWithSpace(h,t,l);h=d.format,r=d.formattedText}if(r&&h.indexOf("?")>-1&&(r=r.replace("?"," ")),h.indexOf("*")>-1&&(s=!0,r=this.processCustomFill(h,t,e)),h==="General"&&(s=!0,r=l.toString()),s||(r=this.getFormattedNumber(h,l)),a&&r&&(r=r.replace("0","")),h[0]==="#"&&l>=0&&l<1){var p=h.split("#").join("").split(".");if(!p[0].includes("0")){l===0&&h.includes(".")&&(!p[1]||!p[1].includes("0"))&&(r=this.getFormattedNumber(h,.1),r=r.replace("1",""));var f=r.split(this.localeObj.decimal);f[0]=f[0].toString().replace(/^0+/,""),r=f.join(this.localeObj.decimal)}}r==="-0"&&(r="0")}return r},o.prototype.processText=function(t){var e=t;return e.indexOf('"')>-1?e=e.split('"').join("'"):e.indexOf("\\")>-1&&(e=e.split("\\").join("")),e},o.prototype.processFormats=function(t,e,i,r,n,s){var a;if(this.parent.isEdit&&t.type==="Scientific"&&!De(t.value)&&(t.type="General"),e!==""){var l=void 0;switch(t.type!=="General"&&t.type!=="Text"&&this.isPercentageValue(e.toString(),t,r)&&(e=t.value.toString()),t.type){case"General":a={args:t,fResult:e,intl:n,isRightAlign:i,cell:r,rowIdx:Number(t.rowIndex),colIdx:Number(t.colIndex),sheet:s},a.fResult.toString().startsWith(`
`)||a.fResult.toString().endsWith(`
 `)||this.autoDetectGeneralFormat(a),e=a.fResult,i=a.isRightAlign;break;case"Number":l=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal,t.curSymbol,!0,!0),l.isNumber&&(r.value=t.value=l.value,e=this.applyNumberFormat(t,n),i=!0);break;case"Currency":l=Da({value:e,format:t.format},this.parent.locale,this.localeObj.group,this.localeObj.decimal,t.curSymbol),l.isNumber&&(r.value=t.value=l.value,e=this.currencyFormat(t,n,r),i=!0);break;case"Percentage":l=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal,t.curSymbol,!0,!0),l.isNumber&&(r.value=t.value=l.value,e=this.percentageFormat(t,n),i=!0);break;case"Accounting":e=this.accountingFormat(t,e,r),i=t.formatApplied;break;case"ShortDate":e=this.checkAndProcessNegativeValue(t,t.value)?t.formattedText:this.shortDateFormat(t,n,r),i=!!e;break;case"LongDate":e=this.checkAndProcessNegativeValue(t,t.value)?t.formattedText:this.longDateFormat(t,n),i=!!e;break;case"Time":e=this.checkAndProcessNegativeValue(t,t.value)?t.formattedText:this.timeFormat(t,n,r),i=!!e;break;case"Fraction":l=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal,null,!0),l.isNumber&&(r.value=t.value=l.value,e=this.fractionFormat(t),i=!0);break;case"Scientific":l=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal),l.isNumber&&(r.value=t.value=l.value,e=this.scientificFormat(t),i=!0);break;case"Text":this.localeObj.decimal!=="."&&De(e)&&e.toString().includes(".")&&(e=e.toString().replace(".",this.localeObj.decimal)),i=!1;break}}return{fResult:e,rightAlign:i}},o.prototype.autoDetectGeneralFormat=function(t){var e=t.fResult,i,r=t.args.cell&&t.args.cell.formula&&t.args.cell.formula.indexOf("ADDRESS(")>0,n=t.args.cell&&t.args.cell.formula&&t.args.cell.formula.indexOf("DOLLAR(")>0,s=t.args.cell&&t.args.cell.formula&&t.args.cell.formula.indexOf("TEXT(")>0;if(!(n&&t.fResult&&t.fResult.toString().includes(t.args.curSymbol)||s)){if(t.fResult&&this.localeObj.decimal!=="."){var a=t.fResult.toString();i=a,a.includes(this.localeObj.decimal)&&(a=a.replace(this.localeObj.decimal,"."),De(a)&&(a.includes("E")?t.fResult=a:(t.fResult=t.args.value=a=Number(a).toString(),Zt(t.rowIdx,t.colIdx,t.sheet,{value:a},!0)),i=a.replace(".",this.localeObj.decimal)))}if(De(t.fResult)){var a=Number(t.fResult).toString();if(t.fResult.toString().includes("E")?(t.args.format=cr("Scientific"),Zt(t.rowIdx,t.colIdx,t.sheet,{value:a,format:t.args.format},!0),t.args.value=a,t.fResult=this.scientificFormat(t.args)):t.args.format&&(t.args.format.indexOf("%")>-1?t.fResult=this.percentageFormat(t.args,t.intl):t.args.format.indexOf(t.args.curSymbol)>-1?t.fResult=this.currencyFormat(t.args,t.intl,t.args.cell):t.fResult=this.applyNumberFormat(t.args,t.intl)),t.args.format==="General"){if(t.args.cell&&t.args.cell.formula&&a.includes(".")&&a.length>11){var l=a.indexOf(".")+1;i=null,t.args.cell.formula.includes("RANDBETWEEN")&&(t.fResult=a=l<7?a:parseFloat(a).toFixed(0))}t.cellVal=a,t.prevVal=i,this.parseDecimalNumber(t),g(t.fResult)&&!g(t.cellVal)&&(t.fResult=t.cellVal)}t.isRightAlign=!0}t.fResult&&this.updateAutoDetectNumberFormat(t),r&&(t.isRightAlign=!1,t.fResult=e)}},o.prototype.parseDecimalNumber=function(t){var e=t.cellVal.split(".");if(e[0].length>11){t.cellVal=Math.abs(Number(e[0])).toString().substring(0,6).replace(/0+$/,"");var i=t.cellVal.length-1;i>-1&&(t.fResult=this.scientificFormat(t.args,i>5?5:i))}else if(e[1])if(t.cellVal.length>11){var r=10-(e[0].length-(Math.sign(Number(t.cellVal))<0?1:0));t.fResult=Number(Number(t.cellVal).toFixed(r>0?r:0)).toString()}else if(t.cellVal.includes("e-")){var n=t.cellVal.split("e-"),i=Number(n[1])+(n[0].includes(".")?n[0].split(".")[1].length:0);n[0]=n[0].replace(".",this.localeObj.decimal),n[1].length===1&&(n[1]="0"+n[1]),t.args.updateValue||Zt(t.rowIdx,t.colIdx,t.sheet,{value:Number(t.cellVal).toFixed(i)},!0),t.fResult=n.join("E-")}else t.prevVal?t.fResult=t.prevVal:t.args.updateValue&&this.localeObj.decimal!=="."&&(t.fResult=t.cellVal.replace(".",this.localeObj.decimal))},o.prototype.updateAutoDetectNumberFormat=function(t){var e=t.fResult.toString(),i=t.args.cell||t.cell;if(this.isPercentageValue(e,t.args,i))i.format=e.includes(this.localeObj.decimal)?cr("Percentage"):"0%",t.args.updateValue||(t.args.format=i.format,t.fResult=this.percentageFormat(t.args,t.intl),t.isRightAlign=!0);else if(!e.includes(`
`)){var r=e?e.toString().split("/"):[],n=this.parent.isEdit&&en(i.format)==="Scientific"&&r.length===2&&De(r[0])&&De(r[1]);if(e.includes(" ")||n){var s=n?r:e.split(" ");if(n||s[1].includes("/")&&De(s[0])&&Number(s[0])%1===0){var a=n?r:s[1].split("/");if(De(a[0])&&Number(a[0])%1===0&&De(a[1])&&Number(a[1])%1===0){i.format="# "+(a[0].length>1||a[1].length>1?"??/??":"?/?"),i.value=n?(Number(a[0])/Number(a[1])).toString():(Number(s[0])+Number(a[0])/Number(a[1])).toString(),t.args.updateValue||(t.args.value=i.value,t.args.format=i.format,t.fResult=this.fractionFormat(t.args),t.isRightAlign=!0);return}}}var l="";e.includes(t.args.curSymbol)&&(l=e.includes(this.localeObj.decimal)?Yi.currency[0]:Yi.currency[1],e=e.replace(t.args.curSymbol,""));var h=void 0,c=this.localeObj.decimal==="."||t.args.isEdit&&!i.formula;if(c){if(e.trim().startsWith("(")&&e.trim().endsWith(")")){var u=cr("CurrencyWithColorCode");u.endsWith(")")&&(e="-"+e.trim().slice(1,-1),l&&(l=u),h=!0)}e.includes(this.localeObj.group)&&Gd(e,this.parent.locale,this.localeObj.group,this.localeObj.decimal)&&(e=e.split(this.localeObj.group).join(""),l||(l=e.includes(this.localeObj.decimal)?"#,##0.00":"#,##0"))}l?(e=e.replace(this.localeObj.decimal,"."),De(e)&&(t.args.value=Number(e).toString(),t.args.updateValue?(t.args.cell.value=t.args.value,t.args.cell.format=l):(t.args.format=l,Zt(t.rowIdx,t.colIdx,t.sheet,{value:t.args.value,format:l},!0),l.includes('"')&&(l=this.processText(l)),t.fResult=this.getFormattedNumber(l,Number(t.args.value)),t.isRightAlign=!0))):(h&&(e=e.replace(this.localeObj.decimal,"."),De(e)&&(t.args.value=Number(e).toString(),t.args.updateValue?t.args.cell.value=t.args.value:(Zt(t.rowIdx,t.colIdx,t.sheet,{value:t.args.value},!0),t.fResult=t.args.value,t.isRightAlign=!0))),this.localeObj.decimal!=="."&&t.args.format==="General"&&De(e)&&e.includes(".")&&(t.fResult=Number(e).toString().replace(".",this.localeObj.decimal)))}},o.prototype.isPercentageValue=function(t,e,i){if(t.includes("%")){var r=t.split("%");if(r[0]!==""&&r[1].trim()===""){var n=Da({value:r[0]},this.parent.locale,this.localeObj.group,this.localeObj.decimal);if(n.isNumber)return e.value=Number(n.value)/100,i.value=e.value.toString(),!0}}return!1},o.prototype.findSuffix=function(t,e){var i=t.length,r=i-e.length;return t.substr(0,r<0?0:r)+e},o.prototype.applyNumberFormat=function(t,e){t.format=this.isCustomFormat(t.format);var i=t.format.split(";");if(Number(t.value)>0)t.format=i[0];else if(Number(t.value)===0){if(t.format=i[2]?i[2]:i[0],t.format.indexOf('"')>-1&&t.format.indexOf("#")===-1)return t.format=t.format.split("_").join(" ").split("*").join(" ").split("?").join(" ").split('"').join(""),t.format}else if(Number(t.value)<0)t.format=g(i[1])?i[0]:i[1].split("*").join(" "),t.format.indexOf("-")>-1&&(t.value=t.value.toString().split("-").join(""));else if(t.format=i[3]?i[3]:i[0],t.format=t.format.split("_").join(" ").split("*").join(" ").split("?").join(" "),t.format.indexOf("@")>-1)return t.format.split("@").join(t.value.toString());if(t.format=t.format.split("_").join(" ").split("*").join(" ").split('"').join(""),t.format.indexOf("?")>-1&&t.format.indexOf(this.localeObj.decimal)>-1){var r=t.format.split(this.localeObj.decimal)[1].length,n="";if(Number(t.value)%1){var s=t.value.toString().split(".")[1].length;r>s?n=" ":n="0"}t.format=t.format.split("?").join(n)}else t.format=t.format.split("?").join(" ");return Number(t.value)<0&&t.cell&&t.cell.format&&(t.format=t.cell.format),e.formatNumber(Number(t.value),{format:t.format})},o.prototype.isCustomFormat=function(t){return(t==='_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-'||t==='_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-')&&(t=""),t=t===""?cr("Number"):t,t=t.toString().split("_)").join(" ").split("_(").join(" ").split("[Red]").join(""),t},o.prototype.currencyFormat=function(t,e,i){t.format=t.format||cr("Currency"),t.format=t.format.split("_(").join(" ").split("_)").join(" ");var r=t.format.split(";"),n=Ho(t.format),s=Number(t.value);return s>=0||g(r[1])?(n&&(t.color=i.style&&i.style.color?i.style.color:"",this.applyColor(t)),t.format=r[0]):(s=Math.abs(s),t.format=r[1].split("["+n+"]").join("").split("*").join(" "),n&&(t.color=n.toLowerCase(),this.applyColor(t))),t.format=this.getFormatForOtherCurrency(t.format),t.format.includes('"')&&(t.format=this.processText(t.format)),e.formatNumber(s,{format:t.format,currency:Ws})},o.prototype.applyColor=function(t){t.refresh&&(this.setCell(t),t.td&&t.td.style.color!==t.color&&this.parent.notify(Mr,{style:{color:t.color},rowIdx:t.rowIndex,colIdx:t.colIndex,td:t.td}))},o.prototype.setCell=function(t){if(!t.td){var e={sheet:ke(this.parent,t.sheetIndex),cell:t.cell,rowIdx:t.rowIndex,colIdx:t.colIndex};(t.cell.rowSpan>1||t.cell.colSpan>1)&&W0(e),t.td=this.parent.getCell(e.rowIdx,e.colIdx)}},o.prototype.percentageFormat=function(t,e){return t.format=t.format===""?cr("Percentage"):t.format,e.formatNumber(Number(t.value),{format:t.format})},o.prototype.accountingFormat=function(t,e,i){t.format=t.format||cr("Accounting");var r=t.format.split(";"),n=Da({value:e},this.parent.locale,this.localeObj.group,this.localeObj.decimal,t.curSymbol,!1,!0);if(n.isNumber){if(i.value=t.value=n.value,this.processCustomAccounting(i,t,r,r[0]))return t.formatApplied=!0,t.result}else if(r[3])return this.processCustomText(i,t,r);return e},o.prototype.getFormatForOtherCurrency=function(t){if(t.indexOf("[$")>-1){var e=t.split("]")[0].split("[$")[1].split("-")[0];t.indexOf("0")>t.indexOf("[$")?t=e+t.slice(t.indexOf("]")+1,t.length):t=t.slice(0,t.indexOf("[$"))+e}return t},o.prototype.checkAndProcessNegativeValue=function(t,e){if(e&&De(e)&&Number(e)<0){if(t.rowIndex===void 0||t.dataUpdate)return t.formattedText="#".repeat(t.dataUpdate?7:10),!0;t.isRowFill=!0,this.setCell(t);var i={cell:t.cell,cellEle:t.td,rowIdx:t.rowIndex,colIdx:t.colIndex,repeatChar:"#"};return this.parent.notify(xg,i),t.formattedText=i.formattedText,!0}return!1},o.prototype.shortDateFormat=function(t,e,i){var r;$t&&xs(this.parent)&&i&&i.format==="m/d/yyyy"&&$t.has(14)&&(i.format=t.format=$t.get(14));var n;t.format===""||t.format==="General"||t.format==="m/d/yyyy"?(n="MM-dd-yyyy",r={type:"date",skeleton:"yMd"}):(n=t.format,t.format===cr("ShortDate")?r={type:"date",skeleton:"yMd"}:r={type:"date",format:t.format});var s;t.value=t.value.toString();var a=this.checkForDateFormat(t,i);if(t.value&&i&&(!De(t.value)||a)){var l={value:t.value,updatedVal:t.value,cell:i,isEdit:t.isEdit,intl:e,skipCellFormat:!0,format:n};if(this.checkDateFormat(l),l.isDate||l.isTime)i.value=t.value=l.updatedVal,s=l.dateObj;else if(a)s=Yn(t.value);else return""}else s=Yn(t.value);return!s||s.toString()==="Invalid Date"?"":s.getFullYear()<1900||s.getFullYear()>9999?De(t.value)?t.value.toString():"":(t.checkDate&&(t.dateObj=s),e.formatDate(s,r))},o.prototype.longDateFormat=function(t,e){t.value=t.value.toString();var i,r=this.checkForDateFormat(t,t.cell);if((t.value.includes(this.localeObj.dateSeparator)||t.value.indexOf("-")>0)&&(!De(t.value)||r))if(r){var n={value:t.value,updatedVal:t.value,cell:t.cell,isEdit:t.isEdit,intl:e};this.checkDateFormat(n),n.isDate||n.isTime?(i=n.dateObj,t.cell.value=t.value=ls(i).toString()):i=Yn(t.value)}else if(i=cM(t.value,e,this.parent.locale,"",t.cell).dateObj,i&&i.toString()!=="Invalid Date"&&i.getFullYear()>=1900)t.cell.value=t.value=ls(i).toString();else return De(t.value)?t.value:"";else i=Yn(t.value);return!i||i.toString()==="Invalid Date"?"":i.getFullYear()<1900||i.getFullYear()>9999?De(t.value)?t.value.toString():"":(t.checkDate&&(t.dateObj=i),e.formatDate(i,{type:"date",skeleton:"full"}))},o.prototype.checkForDateFormat=function(t,e){var i,r=t.value;if(this.localeObj.decimal==="."||t.isEdit&&!e.formula){if(r.includes(this.localeObj.group)&&Gd(r,this.parent.locale,this.localeObj.group,this.localeObj.decimal))return r=r.replace(this.localeObj.group,""),this.localeObj.decimal!=="."&&r.includes(this.localeObj.decimal)&&(r=r.replace(this.localeObj.decimal,".")),De(r)&&e&&(e.value=t.value=r),!1;i=this.localeObj.dateSeparator==="."&&r.includes("."),this.localeObj.decimal!=="."&&!De(r)&&r.includes(this.localeObj.decimal)&&(r=r.replace(this.localeObj.decimal,"."),De(r)&&e&&(e.value=t.value=r))}return i},o.prototype.timeFormat=function(t,e,i){if(g(t.value))return"";var r=cr("Time"),n;(t.format===""||t.format==="General")&&(n=r),t.format==="h:mm:ss AM/PM"?n="h:mm:ss a":n=t.format;var s=t.value.toString();if(!De(s)&&i){var a={value:s,updatedVal:s,cell:i,isEdit:t.isEdit,intl:e,skipCellFormat:!0};if(this.checkDateFormat(a),a.isDate||a.isTime)i.value=s=a.updatedVal;else return""}var l=s.split(".");return g(l[1])||(s=parseFloat(l[0]+1+"."+l[1])||s),e.formatDate(Yn(s),{type:"time",skeleton:"medium",format:n})},o.prototype.scientificHashFormat=function(t,e){var i=this.findDecimalPlaces(t.format),r=e[0].split("0").length-1+(e[0].split("#").length-1),n=Number(t.value).toExponential(i+r),s;if(n.includes("e+"))s="e+";else if(n.includes("e-"))s="e-";else return n;var a=n.split(s),l=a[0].split("."),h=Number(a[1]),c;if(s==="e-"){var u=h+Math.abs(h-r*(h>r?2:1));c=u-h,a[1]=u.toString()}else c=h%r,a[1]=(h-c).toString();c>0&&(l[0]+=l[1].substring(0,c),l[1]=l[1].slice(c),a[0]=l.join("."));var d=+("1"+"0".repeat(i));return this.getFormattedNumber(e.join("."),Number((Math.round(Number(a[0])*d)/d).toFixed(i)))+s.toUpperCase()+this.findSuffix(t.format.split("+")[1],a[1])},o.prototype.scientificFormat=function(t,e){t.format||(t.format=cr("Scientific"));var i=t.format.split("+")[1]||"00";e===void 0&&(e=this.findDecimalPlaces(t.format));var r=Number(t.value).toExponential(e);return r.indexOf("e+")>-1?r=r.split("e+")[0]+"E+"+this.findSuffix(i,r.split("e+")[1]):r.indexOf("e-")>-1&&(r=r.split("e-")[0]+"E-"+this.findSuffix(i,r.split("e-")[1])),r.replace(".",this.localeObj.decimal)},o.prototype.fractionFormat=function(t){var e,i,r;t.format=t.format||cr("Fraction"),this.checkAndSetColor(t);var n=t.value.toString().split("."),s=t.format.split("?").length/2,a=t.format.split(" "),l=a[1]?a[1].split("/"):[];if(/^\?{1,3}\/\?{1,3}$|^\?\/[248]$|^\?\?\/16$/.test(a[1])){if(n.length===2&&!n[1].startsWith("0".repeat(l[1].trim().length||0))){for(var h=[0,1,Number.MAX_VALUE],c=h[0],u=h[1],d=h[2],p=l[1].includes("?")?Number("9".repeat(l[1].split("?").length-1)):Number(l[1]),f=parseFloat("0."+n[1]),v=1;v<=p;v++){var m=Math.round(f*v),y=Math.abs(f-m/v);y<d&&(e=[m,v,y],c=e[0],u=e[1],d=e[2])}var b=$D(c,u);i=[c/b,u/b],c=i[0],u=i[1],c===u?n[0]=""+(parseInt(n[0],10)+1):c!==0&&(r=c+"/"+u)}}else n.length===2&&!n[1].startsWith("0".repeat(s))&&(r=qY(Number(t.value)));var S=this.getFormattedNumber(a[0],Math.abs(Number(n[0])));return r?(S=S==="0"?"":S,(Number(t.value)<0?"-":"")+S+" "+r):(Number(t.value)<0?"-":"")+S+" "+"  ".repeat(s*2)},o.prototype.checkAndSetColor=function(t){var e=Ho(t.format);e&&(t.format=t.format.split("["+e+"]").join(""),t.color=e.toLowerCase(),this.applyColor(t))},o.prototype.findDecimalPlaces=function(t){var e=t.toUpperCase().indexOf("E");if(e>-1){var i=t.indexOf(this.localeObj.decimal);return i===-1&&this.localeObj.decimal!=="."&&(i=t.indexOf(".")),i>0?t.substring(i+1,e).length:0}return 2},o.prototype.checkDateFormat=function(t){if(!g(t.value)){var e=t.cell||Q(t.rowIndex,t.colIndex,ke(this.parent,g(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex),!1,!0),i=e.format;this.parent.isEdit&&en(e.format)==="Scientific"&&(e.format="");var r=this.checkCustomDateFormat(t.value.toString(),e,t.isEdit);if(r.val!=="Invalid"){var n=void 0;if(r.format.startsWith("[h]")){var s=r.val.split(":");s.length>1&&Number(s[0])>=24&&(n=Number(s[0])/24,s[0]="24",r.val=s.join(":"))}var a=cM(r.val,t.intl||new Nt(this.parent.locale),this.parent.locale,r.format||t.format,t.skipCellFormat&&e,r.isDateTime);if(a.dateObj&&a.dateObj.toString()!=="Invalid Date"){var l=a.dateObj.getFullYear();if(l>=1900&&l<=9999){t.isTime=a.type==="time";var h=ls(a.dateObj,r.val.includes(":"),t.isTime);if(n>=1&&(h+=n,a.dateObj=Yn(h)),r.val=h.toString(),(!e.format||e.format==="General")&&(t.isTime?e.format=cr("Time"):e.format=cr("ShortDate"),t.updateValue)){e.value=r.val;return}t.isDate=a.type==="date"||a.type==="datetime",t.dateObj=a.dateObj}t.updatedVal=r.val}}else i&&(e.format=i)}},o.prototype.checkCustomTimeFormat=function(t,e){var i=this,r=[],n=" "+this.localeObj.am,s=" "+this.localeObj.pm,a=t.includes(n)||t.includes(s);a||(t.includes(n.toLowerCase())||t.includes(s.toLowerCase()))&&(t=t.replace(n.toLowerCase(),n).replace(s.toLowerCase(),s),a=!0);var l=t.split(this.localeObj.timeSeparator),h=l.length===3&&a,c;if(l.length<=3){var u,d,p=a?12:23;l.forEach(function(v,m){v=v.trim(),l[m]=v,v.includes(n)||v.includes(s)?(c=" AM/PM",v=v.replace(n,"").replace(s,"")):c="",u=Number(v),De(u)&&u>=0?u>=24&&m===0&&l.length>1?r.push("[h]"):u<=p&&m===0?(r.push("h"+c),l.length===1&&(c?(d=t.split(" "),d[0]+=i.localeObj.timeSeparator+"00",l[0]=d.join(" ")):(r=[],t="Invalid"))):u<=60&&(r.length===1||r.length===2)?(r.length===1?(r.push("mm"+c),l.length===2&&r[0]==="[h]"&&r.push("ss")):r.push("ss"),v.length===1&&(l[m]="0"+l[m])):(r=[],t="Invalid"):(r=[],t="Invalid")})}else t="Invalid";if(r.length){t=l.join(this.localeObj.timeSeparator);var f=void 0;if(h?f=this.customFormats[24]:(f=r.join(":"),$t&&(f=this.getMatchingCustomFormat(f))),!e.format||e.format==="General")return e.format=f,{val:t,format:f}}return{val:t,format:""}},o.prototype.checkCustomDateFormat=function(t,e,i){var r=this,n,s=e.format,a;if(t.includes(this.localeObj.dateSeparator)&&(!t.includes(" "+this.localeObj.am)&&!t.includes(" "+this.localeObj.pm)||t.replace(" "+this.localeObj.am,"").replace(" "+this.localeObj.pm,"").includes(this.localeObj.dateSeparator))){if(t.trim().startsWith("-"))return{val:"Invalid",format:""};n=this.localeObj.dateSeparator}else if(t.indexOf("-")>0){if(t.trim().startsWith("-"))return{val:"Invalid",format:""};n="-"}else if(t.indexOf(",")>0){var l=new Nt(this.parent.locale),h=l.parseDate(t,{skeleton:"full"});return h&&!isNaN(h.getTime())?{val:t,format:"",isDateTime:!1}:{val:"Invalid",format:""}}else return t.includes(this.localeObj.timeSeparator)||t.includes(" "+this.localeObj.am)||t.includes(" "+this.localeObj.pm)?this.checkCustomTimeFormat(t,e):{val:"Invalid",format:""};if(t.includes(this.localeObj.timeSeparator)&&t.includes(" ")){var c=t.split(" ");if(t=c.shift(),a=this.checkCustomTimeFormat(c.join(" "),e),a.val==="Invalid")return{val:"Invalid",format:""}}var u=t.split(n),d="",p=[],f=function(A){d=p.join(n),(!s||s==="General")&&(e.format=A)},v,m=ut.getDependables(Br,this.parent.locale,null).dateObject,y=m.months["stand-alone"]?m.months["stand-alone"].wide:{},b=m.months["stand-alone"]?m.months["stand-alone"].abbreviated:{1:""},S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],C=function(A,L,N,R){if(b[""+L]&&b[""+L].toLowerCase()===N){v=S[Number(L)-1];return}var P=A.substring(0,R);P===N&&(v=S[Number(L)-1])};if(u.length===2){var x=function(A){t=v,p[0]="MMM",Number(A)<=31&&Number(A)>0?(t=A+n+t,r.localeObj.dateSeparator!=="/"&&n!=="-"&&(t+=n+new Date().getFullYear()),p.splice(0,0,"dd"),f(r.customFormats[21])):(A.length===2&&De(A)&&Number(A)>-1&&(A=(Number(A)<30?new Date().getFullYear().toString().slice(0,2):"19")+A),Number(A)>=1900&&Number(A)<=9999?(t="1"+n+t+n+A,p[1]="yyyy",f(r.customFormats[22])):t="Invalid")};u[0]=u[0].toLowerCase().trim(),u[1]=u[1].toLowerCase().trim(),!Number(u[0])&&u[0].length>=b[1].length?(Object.keys(y).find(function(A){return C(y[""+A].toLowerCase(),A,u[0],u[0].length)}),!g(v)&&!u[0].includes(",")&&x(u[1])):!Number(u[1])&&u[1].length>=b[1].length?(Object.keys(y).find(function(A){return C(y[""+A].toLowerCase(),A,u[1],u[1].length)}),g(v)||x(u[0])):Number(u[0])&&Number(u[0])<=12&&Number(u[1])&&(this.localeObj.dateSeparator==="/"||n==="-"||i&&!e.formula)&&(v=S[Number(u[0])-1],x(u[1])),p.length||(t="Invalid")}else if(u.length>2)for(var I=function(A){De(u[A])?u[A].length!==4&&u[A].length!==2&&u[A].length!==1&&(t="Invalid"):(u[A]=u[A].trim(),Object.keys(y).find(function(L){return C(y[""+L].toLowerCase(),L,u[A].trim().toLowerCase(),u[A].length)}),g(v)?t="Invalid":A===1&&(p[1]="MMM",u[2]=u[2].trim(),u[2].length===2&&De(u[2])&&Number(u[2])>-1&&(u[2]=(Number(u[2])<30?new Date().getFullYear().toString().slice(0,2):"19")+u[2]),Number(u[0])<=31&&Number(u[2])>=1900&&Number(u[2])<=9999&&(t=u[0]+n+v,t+=n+u[2],p[0]="d",p[2]="yy",f(D.customFormats[20]),p[2]="yyyy",d=p.join(n))))},D=this,M=0;M<u.length;M++)I(M);var E;return a&&t!=="Invalid"&&((!s||s==="General")&&(e.format=this.customFormats[27]),d&&a.format&&(d+=" "+a.format),t+=" "+a.val,E=!0),{val:t,format:d,isDateTime:E}},o.prototype.formattedBarText=function(t){var e=this;if(!(t.value===""||g(t.value))){var i={},r=t.cell&&t.cell.format||"",n=t.type||(r&&Bs(r,!0,i,!0)?i.type:""),s=new Nt,a=t.value,l=t.showFormattedText&&(r==="dd-MM-yyyy"||r==="dd/MM/yyyy")?r:cr("ShortDate"),h=cr("Time");h==="h:mm:ss AM/PM"&&(h="h:mm:ss a");var c=r.toLowerCase(),u=function(){e.localeObj.decimal!=="."&&t.value&&(t.value=t.value.toString(),De(t.value)&&t.value.includes(".")&&(t.value=t.value.replace(".",e.localeObj.decimal)))};if(n==="time"&&c.includes("m")&&!c.includes(":m")&&!c.includes("m:")&&!c.includes("[m")&&!c.includes("am")&&(n="date"),n==="date"){var d=t.value.toString();t.value=this.shortDateFormat({type:n,value:t.value,format:l},s,t.cell),t.value&&d.includes(".")&&(t.value+=" "+this.timeFormat({type:n,value:d,format:h},s))}else n.includes("time")?a&&Number(a)>=1||n==="datetime"?t.value=this.shortDateFormat({type:n,value:t.value,format:l},s)+" "+this.timeFormat({type:n,value:t.value,format:h},s):t.value=this.timeFormat({type:n,value:t.value,format:h},s):t.cell.format&&t.cell.format.includes("%")&&De(t.cell.value)?(t.value=this.parent.getDisplayText(t.cell),t.value.includes("%")||(t.value=a,u())):u();(!t.value||t.value&&t.value.toString().indexOf("null")>-1)&&(t.value=a)}},o.prototype.getFormattedNumber=function(t,e){return new Nt().formatNumber(Number(e),{format:t})||""},o.prototype.getMatchingCustomFormat=function(t){return t==="#,##0_);(#,##0)"&&$t.has(37)?$t.get(37):t==="#,##0_);[Red](#,##0)"&&$t.has(38)?$t.get(38):t==="#,##0.00_);(#,##0.00)"&&$t.has(39)?$t.get(39):t==="#,##0.00_);[Red](#,##0.00)"&&$t.has(40)?$t.get(40):t==="d-mmm-yy"&&$t.has(15)?$t.get(15):t==="d-mmm"&&$t.has(16)?$t.get(16):t==="mmm-yy"&&$t.has(17)?$t.get(17):t==="h:mm AM/PM"&&$t.has(18)?$t.get(18):t==="h:mm:ss AM/PM"&&$t.has(19)?$t.get(19):t==="h:mm"&&$t.has(20)?$t.get(20):t==="h:mm:ss"&&$t.has(21)?$t.get(21):t==="m/d/yyyy h:mm"&&$t.has(22)?$t.get(22):t==="mm:ss"&&$t.has(45)?$t.get(45):t},o.prototype.addEventListener=function(){this.parent.on(vg,this.numberFormatting,this),this.parent.on(yr,this.getFormattedCell,this),this.parent.on(Jr,this.checkDateFormat,this),this.parent.on(Fb,this.formattedBarText,this),this.parent.on(mg,this.updateAutoDetectNumberFormat,this),this.parent.on(CM,this.parseDecimalNumber,this),this.parent.on(qd,this.localizedFormatAction,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vg,this.numberFormatting),this.parent.off(yr,this.getFormattedCell),this.parent.off(Jr,this.checkDateFormat),this.parent.off(Fb,this.formattedBarText),this.parent.off(mg,this.updateAutoDetectNumberFormat),this.parent.off(CM,this.parseDecimalNumber),this.parent.off(qd,this.localizedFormatAction))},o.prototype.destroy=function(){this.removeEventListener(),$t&&!this.parent.refreshing&&($t.clear(),$t=null),Yi=this.parent=this.localeObj=this.customFormats=this.localizedFormats=null},o.prototype.getModuleName=function(){return"workbookNumberFormat"},o})(),$t,Yi;function cr(o){var t=o.split(" ").join("");if(!Yi)switch(t){case"Currency":return"$#,##0.00";case"Accounting":return'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)';case"Time":return"h:mm:ss AM/PM";default:return"General"}var e=function(r,n){return $t&&$t.has(n)?$t.get(n):r},i="General";switch(t){case"Number":i=e("0.00",2);break;case"Currency":i=Yi.currency[0];break;case"Accounting":i=Yi.accounting[2];break;case"ShortDate":i=e("m/d/yyyy",14);break;case"LongDate":i="dddd, mmmm dd, yyyy";break;case"Time":i=Yi.time;break;case"Percentage":i=e("0.00%",10);break;case"Fraction":i=e("# ?/?",12);break;case"Scientific":i=e("0.00E+00",11);break;case"Text":i=e("@",49);break;case"CurrencyWithColorCode":i=Yi.currency[5];break}return i}function en(o,t){var e="General";switch(o){case"0":case"0.00":case"#,##0":case"#,##0.00":e="Number";break;case"$#,##0.00":case"$#,##0":case"$#,##0_);[Red]($#,##0)":case"$#,##0.00_);($#,##0.00)":case"$#,##0_);($#,##0)":case"$#,##0.00_);[Red]($#,##0.00)":e="Currency";break;case'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)':case'_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * "-"??_ ;_ @_ ':case'_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)':e="Accounting";break;case"m/d/yyyy":case"dd/MM/yyyy":e="ShortDate";break;case"dddd, mmmm dd, yyyy":e="LongDate";break;case"h:mm:ss AM/PM":e="Time";break;case"0.00%":case"0%":e="Percentage";break;case"0.00E+00":e="Scientific";break;case"@":e="Text";break;default:if(o){if(!Yi)break;if(o===Yi.time?e="Time":Yi.currency.indexOf(o)>-1?e="Currency":Yi.accounting.indexOf(o)>-1?t&&(e="Accounting"):(o.includes("?/?")||["2","4","8","16"].indexOf(o.split("?/")[1])>-1)&&(e="Fraction"),$t&&e==="General"&&t){var i=function(r){return r.some(function(n){return $t.has(n)&&$t.get(n)===o})};i([1,2,3,4])?e="Number":i([14])?e="ShortDate":i([9,10])?e="Percentage":i([11])?e="Scientific":i([49])&&(e="Text")}t=!1}break}return t&&Yi&&(e==="Currency"&&Yi.currency[0]!=="$#,##0.00"||e==="Accounting"&&Yi.accounting[2]!=='_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)')&&(e="General"),e}function g9(o,t){var e={action:"parseToDefaultFormat",format:t};return o.notify(qd,e),e.format}var zz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(bg,this.initiateSortHandler,this),this.parent.on(IM,this.updateSortedDataOnCell,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(bg,this.initiateSortHandler),this.parent.off(IM,this.updateSortedDataOnCell))},o.prototype.initiateSortHandler=function(t){var e=this,i=t.args,r=new zn,n=this.parent.getAddressInfo(i.range),s=ke(this.parent,n.sheetIndex),a=tt(n.indices),l=i.sortOptions||{sortDescriptors:{},containsHeader:!0},h=!1;if(t.promise=r.promise,a[0]>s.usedRange.rowIndex||a[1]>s.usedRange.colIndex){r.reject(this.parent.serviceLocator.getService(r0).getConstant("SortOutOfRangeError"));return}var c=l.containsHeader,u=i.checkForHeader;if((a[0]===a[2]||u)&&(u||(a=U0(a[0],a[1],s)),h=!0,g(l.containsHeader)&&(typeof Q(a[0],a[1],s,null,!0).value==typeof Q(a[0]+1,a[1],s,null,!0).value?c=this.isSameStyle(Q(a[0],a[1],s,null,!0).style,Q(a[0]+1,a[1],s,null,!0).style)?this.isHeaderRow(s,a):!0:c=!0)),(g(i.sortOptions)||g(i.sortOptions.containsHeader))&&!h){var d=Q(a[0],a[1],s),p=Q(a[0]+1,a[1],s);d&&p&&(typeof d.value==typeof p.value?c=!this.isSameStyle(d.style,p.style)||this.isHeaderRow(s,a):c=!0)}a[0]=c?a[0]+1:a[0];var f=xe(s.activeCell),v=ji(f[1]+1);delete l.containsHeader;var m=l.sortDescriptors,y=new Pe;if(Array.isArray(m)){(!m||m.length===0)&&(m=[{field:v}]);for(var b=m.length,S=b-1;S>-1;S--)if(m[b-1].field||(m[b-1].field=v),!!m[S].field){var C=m[S].sortComparer||this.sortComparer.bind(this,m[S],l.caseSensitive);y.sortBy(m[S].field,C),v=m[S].field}}else{m||(m={field:v}),m.field||(m.field=v);var C=m.sortComparer||this.sortComparer.bind(this,m,l.caseSensitive);y.sortBy(m.field,C),v=m.field}var x=Ve(a);Aa(this.parent,s.name+"!"+x,!0,null,null,null,null,null,void 0,null,Sn(v)).then(function(I){var D=new oe(I);if(I.length===1&&I[0].throwMergeAlert){var M=e.parent.sortCollection&&e.parent.sortCollection[e.parent.sortCollection.length-1];if(M){var E=void 0;if(t.previousSort&&t.previousSort.length)for(var A=0;A<t.previousSort.length;A++){var L=t.previousSort[A];M.sheetIndex===L.sheetIndex&&(E=L)}E?(M.columnIndex=E.columnIndex,M.order=E.order,M.sortRange=E.sortRange):e.parent.sortCollection.pop(),e.parent.notify(y0,null)}r.reject(e.parent.serviceLocator.getService(r0).getConstant("AutoFillMergeAlertMsg"));return}D.executeQuery(y).then(function(N){e.parent.notify("setActionData",{args:{action:"beforeSort",eventArgs:{range:x,cellDetails:I,sortedCellDetails:N.result}}}),e.updateSortedDataOnCell({result:N.result,range:a,sheet:s,jsonData:I});var R={range:s.name+"!"+x,sortOptions:i.sortOptions};t.previousSort&&(R.previousSort=t.previousSort),r.resolve(R)})})},o.prototype.isHeaderRow=function(t,e){return!t.ranges||!t.ranges.length?!1:t.ranges.some(function(i){if(!i.dataSource||!i.showFieldAsHeader)return!1;var r=xe(i.startCell);return r[0]===e[0]&&r[1]>=e[1]&&r[1]<=e[3]})},o.prototype.updateSortedDataOnCell=function(t){for(var e=this,i=[],r,n=function(u,d){for(var p=t.range[1],f=0;p<=t.range[3];p++,f++){if(i[f]||(i[f]=ji(p+1)),d[i[f]])r=pe({},d[i[f]],null,!0);else{if(!Q(u,p,t.sheet))continue;r=null}r=e.skipBorderOnSorting(u,p,t.sheet,r),r&&r.validation&&delete r.validation;var v=Q(u,p,t.sheet);v&&(v.validation&&(r=Object.assign({},r,{validation:v.validation})),v.wrap&&_c(st(u,p),!1,e.parent)),r&&r.formula&&(r.formula=ln([u,p],[parseInt(d.__rowIndex,10)-1,p],t.sheet,e.parent,r,!0)),Zt(u,p,t.sheet,r)}},s=t.isUndo&&{},a,l,h=t.range[0],c=0;h<=t.range[2];h++,c++){if(lt(t.sheet,h)){c--;continue}if(l=t.result[c],t.isUndo){if(l&&(a=parseInt(l.__rowIndex,10)-1,s[a]=!0,n(a,l),h===a))continue;!s[h]&&t.sheet.rows[h]&&n(h,{})}else n(h,l||{})}},o.prototype.skipBorderOnSorting=function(t,e,i,r){var n=Q(t,e,i),s=["borderBottom","borderTop","borderRight","borderLeft","border"];if(r&&r.style)for(var a=0,l=s;a<l.length;a++){var h=l[a];delete r.style[""+h]}if(n&&n.style)for(var c=0,u=s;c<u.length;c++){var h=u[c];n.style[""+h]&&(r||(r={}),r.style||(r.style={}),r.style[""+h]=n.style[""+h])}return r},o.prototype.isSameStyle=function(t,e){t||(t={}),e||(e={});for(var i=!0,r=Object.keys(t),n=0;n<r.length;n++)if(t[r[n]]===e[r[n]]||this.parent.cellStyle[r[n]]===t[r[n]])i=!0;else{i=!1;break}return i},o.prototype.sortComparer=function(t,e,i,r){var n=t.order||"",s=ge.fnSort(n),a=i&&(i.hyperlink&&!i.value&&i.value!==0?typeof i.hyperlink=="object"?i.hyperlink.address:i.hyperlink:i.value),l=r&&(r.hyperlink&&!r.value&&r.value!==0?typeof r.hyperlink=="object"?r.hyperlink.address:r.hyperlink:r.value);if(i&&r&&(typeof a=="string"||typeof l=="string")&&a!==""&&l!==""){var h=void 0,c=void 0;if(De(i.value)&&(a=Ad(i.value),i.format!=="@"&&(i.value=a),h=!0),De(r.value)&&(l=Ad(r.value),r.format!=="@"&&(r.value=l),c=!0),!h&&!c){var u={sensitivity:e?"case":"base"},d=new Intl.Collator(this.parent.locale,u);return!n||n.toLowerCase()==="ascending"?d.compare(a,l):d.compare(a,l)*-1}}return g(l)||l===""?-1:g(a)||a===""?1:s(a,l)},o.prototype.getModuleName=function(){return"workbookSort"},o})(),Pz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Pb,this.initiateFilterHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Pb,this.initiateFilterHandler)},o.prototype.initiateFilterHandler=function(t){var e=this,i=t.args,r=new zn,n=ke(this.parent,js(this.parent,i.range)),s=i.filterOptions||{};if(t.promise=r.promise,s.datasource){this.setFilter(s.datasource,s.predicates,i.range,t.refresh,s.equalOrPredicates);var a={range:i.range,filterOptions:s};r.resolve(a)}else{var l=tt(Ji(i.range));if(l[0]>n.usedRange.rowIndex||l[1]>n.usedRange.colIndex){r.reject("Select a cell or range inside the used range and try again.");return}l[0]===l[2]&&l[2]-l[0]===0&&(l[0]=0,l[1]=0,l[3]=n.usedRange.colIndex),l[2]=n.usedRange.rowIndex,l[0]=l[0]+1;var h=Ve(l);Aa(this.parent,n.name+"!"+h,!0,!0,null,null,null,null,!1).then(function(c){var u=new oe(c);e.setFilter(u,s.predicates,i.range,t.refresh);var d={range:h,filterOptions:s};r.resolve(d)})}},o.prototype.setFilter=function(t,e,i,r,n){var s=this;if(t&&e){var a=t.dataSource.json,l=BM(t,e,n),h="__rowIndex",c,u;if(i.indexOf("!")>-1?(u=Ct(this.parent,i.substring(0,i.lastIndexOf("!"))),c=ke(this.parent,u)):(c=this.parent.getActiveSheet(),u=Ct(this.parent,c.name)),this.parent.getModuleName()==="spreadsheet"){var d=this.parent,p,f;if(d.scrollSettings.enableVirtualization&&(c.rows||a).length>d.viewport.rowCount+d.getThreshold("row")*2||c.frozenRows||c.frozenColumns||r){a.forEach(function(y){p=l.indexOf(y)<0,Cs(c,Number(y[""+h])-1,{hidden:p,isFiltered:p})}),f=u===d.activeSheetIndex;var v=ie(c.paneTopLeftCell);this.parent.updateTopLeftCell(ce(c,v[0],!0)-this.parent.frozenRowCount(c),null,"col")}else a.forEach(function(y){if(p=l.indexOf(y)<0,f)Cs(c,Number(y[""+h])-1,{hidden:p,isFiltered:p});else{var b={startIndex:Number(y[""+h])-1,hide:p,isFiltering:!0,sheetIndex:u};b.endIndex=b.startIndex,s.parent.notify(kn,b),f=b.refreshUI}});f&&d.renderModule.refreshSheet(!1,!1,document.activeElement.id!==this.parent.element.id+"_SearchBox")}else{var m;a.forEach(function(y){m=l.indexOf(y)<0,Cs(c,Number(y[""+h])-1,{hidden:m,isFiltered:m})})}}},o.prototype.getModuleName=function(){return"workbookFilter"},o})(),Bz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.setImage=function(t){var e=t.range?t.range.lastIndexOf("!"):-1,i=t.range?e>-1?t.range.substring(e+1):t.range:this.parent.getActiveSheet().selectedRange,r=t.range&&e>-1?Ct(this.parent,t.range.substring(0,e)):this.parent.activeSheetIndex,n=ie(i),s=Te(r)?this.parent.getActiveSheet():ke(this.parent,r),a=Q(n[0],n[1],s),l,h=t.options;if(a&&a.image)if(l=a.image,t.isPositionChanged)for(var c=0;c<l.length;c++)for(var u=0;u<h.length;u++)l[c]=h[u],document.getElementById(h[u].id)&&(t.isElementRemoved=!0,document.getElementById(h[u].id).remove());else{l=a.image;for(var c=0;c<h.length;c++)l.push(h[c])}return Zt(n[0],n[1],s,{image:a&&a.image?l:h},!0),t.isElementRemoved},o.prototype.updateImagesFromSheet=function(){this.parent.sheets.forEach(function(t){t.imageColl&&(t.imageColl.forEach(function(e){var i=e,r=i.address;delete i.address;var n=Q(r[0],r[1],t);n&&n.image?n.image.push(i):Zt(r[0],r[1],t,{image:[i]},!0)}),delete t.imageColl)})},o.prototype.addEventListener=function(){this.parent.on(Yb,this.setImage,this),this.parent.on(aa,this.updateImagesFromSheet,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Yb,this.setImage),this.parent.off(aa,this.updateImagesFromSheet))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookImage"},o})(),jz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(jh,this.setChartHandler,this),this.parent.on(Qb,this.deleteChartColl,this),this.parent.on(kh,this.refreshChartSize,this),this.parent.on(Xb,this.focusChartBorder,this),this.parent.on(aa,this.updateChartsFromSheet,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(jh,this.setChartHandler),this.parent.off(Qb,this.deleteChartColl),this.parent.off(kh,this.refreshChartSize),this.parent.off(Xb,this.focusChartBorder),this.parent.off(aa,this.updateChartsFromSheet))},o.prototype.setChartHandler=function(t){var e=0,i=[];t.isInitCell=g(t.isInitCell)?!1:t.isInitCell,t.isUndoRedo=g(t.isUndoRedo)?!0:t.isUndoRedo,t.isPaste=g(t.isPaste)?!1:t.isPaste;var r=t.chart,n,s;if(r.length>0)for(;e<r.length;){if(t.isCut===!1&&(r[e]={range:r[e].range,id:Lt("e_spreadsheet_chart"),theme:r[e].theme,isSeriesInRows:r[e].isSeriesInRows,type:r[e].type,markerSettings:r[e].markerSettings,title:r[e].title,legendSettings:r[e].legendSettings,primaryXAxis:r[e].primaryXAxis,primaryYAxis:r[e].primaryYAxis,dataLabelSettings:r[e].dataLabelSettings,height:r[e].height,width:r[e].width}),document.getElementById(t.chart[e].id))return;if(n=r[e],n.theme=n.theme||"Material",n.type=n.type||"Line",n.isSeriesInRows=n.isSeriesInRows||!1,g(n.range)){var a=this.parent.getActiveSheet();n.range=a.selectedRange,i=tt(ie(n.range)),i[0]===0&&i[2]===a.rowCount-1&&i[2]>a.usedRange.rowIndex&&(i[2]=a.usedRange.rowIndex),i[1]===0&&i[3]===a.colCount-1&&i[3]>a.usedRange.colIndex&&(i[3]=a.usedRange.colIndex)}else i=tt(ie(n.range));var l=Ve(i);if(n.range.indexOf("!")>0?n.range=n.range.substring(0,n.range.lastIndexOf("!"))+"!"+l:n.range!==""&&(n.range=this.parent.getActiveSheet().name+"!"+l),g(n.id)&&(n.id=Lt("e_spreadsheet_chart")),n.markerSettings&&n.markerSettings.visible&&(n.markerSettings.isFilled===void 0&&(n.markerSettings.isFilled=!0),n.markerSettings.shape===void 0&&(n.markerSettings.shape="Circle")),n.height=n.height||290,n.width=n.width||480,this.parent.notify(Gb,{option:n,isInitCell:t.isInitCell,triggerEvent:t.isUndoRedo,dataSheetIdx:t.dataSheetIdx,range:t.range,isPaste:t.isPaste}),this.parent.chartColl.every(function(b){return b.id!==n.id})&&this.parent.chartColl.push(n),!t.isInitCell||t.isPaste||t.isUndo||t.isRedo){var h=void 0,c=void 0,u=void 0;if(t.range&&(t.isUndo||t.isRedo)){h=Ct(this.parent,t.range.substring(0,t.range.lastIndexOf("!")));var d=tt(ie(t.range));c=d[0],u=d[1]}else{h=t.sheetId===void 0?n.range&&n.range.lastIndexOf("!")>0?Ct(this.parent,n.range.substring(0,n.range.lastIndexOf("!"))):this.parent.activeSheetIndex:Cn(this.parent,t.sheetId);var p={clientY:Number(os(n.top).toFixed(2)),isImage:!0},f={clientX:Number(os(n.left).toFixed(2)),isImage:!0};this.parent.notify(Ud,p),this.parent.notify(Wd,f),c=p.clientY,u=f.clientX}var a=Te(h)?this.parent.getActiveSheet():this.parent.sheets[h],v=Q(c,u,a);this.parent.isPrintingProcessing||(n.address=[c,u],v&&v.chart?v.chart.push(n):Zt(c,u,a,{chart:[n]},!0))}else{var m=ie(t.range),p={clientY:Number(os(n.top).toFixed(2)),isImage:!0},f={clientX:Number(os(n.left).toFixed(2)),isImage:!0};this.parent.notify(Ud,p),this.parent.notify(Wd,f);var y={prevTop:n.top,prevLeft:n.left,prevRowIdx:m[0],prevColIdx:m[1],prevHeight:n.height,prevWidth:n.width,currentTop:n.top,currentLeft:n.left,currentRowIdx:p.clientY,currentColIdx:f.clientX,currentHeight:n.height,currentWidth:n.width,id:n.id,requestType:"chartRefreshOnInit"};(m[0]!==p.clientY||m[1]!==f.clientX)&&(s=r.length,this.parent.notify(Ig,y),e-=s-r.length)}e++}},o.prototype.refreshChartSize=function(t){for(var e,i=1,r=this.parent.sheets.length+1;i<r;){var n=this.parent.chartColl;if(e=n?n.length:0,e)for(;e--;){var s=this.parent.chartColl[e];if(t.overlayEle&&!g(t.overlayEle.querySelector("#"+s.id))){var a=this.parent.element.querySelector("."+s.id),l=ot(a,"chart")||ot(a,"accumulationchart");l&&(l.height=t.height,l.width=t.width)}}i++}},o.prototype.focusChartBorder=function(t){for(var e=0;e<this.parent.chartColl.length;e++){var i=document.getElementById(t.id),r=document.getElementById(this.parent.chartColl[e].id);i&&r&&H(r,"."+i.classList[1])===i&&this.parent.notify(Gb,{option:this.parent.chartColl[e],isRefresh:!0})}},o.prototype.deleteChartColl=function(t){for(var e=0;e<this.parent.chartColl.length;e++)this.parent.chartColl[e].id+"_overlay"===t.id&&this.parent.chartColl.splice(e,1)},o.prototype.updateChartsFromSheet=function(){var t=this;this.parent.sheets.forEach(function(e){e.chartColl&&e.chartColl.forEach(function(i){g(i.id)&&(i.id=Lt("e_spreadsheet_chart"));var r=i.address,n=Q(r[0],r[1],e,!0);n?(n.chart||(n.chart=[]),n.chart.push(i)):Zt(r[0],r[1],e,{chart:[i]}),t.parent.chartColl.every(function(s){return s.id!==i.id})&&t.parent.chartColl.push(i)})})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookChart"},o})(),Hz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.format=function(t){var e=this,i=[],r,n=t.range,s;if(n&&typeof n=="string"){if(n.indexOf("!")>-1){var a=n.lastIndexOf("!");n=n.substring(a+1),r=this.parent.sheets[Ct(this.parent,t.range.substring(0,a))]}else r=this.parent.getActiveSheet();i=n.split(" "),s=t.onActionUpdate&&!t.isUndoRedo}else r=this.parent.getActiveSheet(),n===void 0?(n=r.selectedRange,i=n.split(" "),s=t.onActionUpdate&&!t.isUndoRedo):i=[n];if(!i.some(function(b){return Hi(e.parent,typeof b=="string"?tt(ie(b)):b,t.onActionUpdate)})){var l={range:n,style:Object.assign({},t.style),requestType:"CellFormat"};if(t.borderType&&(l.borderType=t.borderType),s){if(this.parent.trigger("beforeCellFormat",l),this.parent.notify("actionBegin",{eventArgs:l,action:"format"}),l.cancel){t.cancel=!0;return}l.range!==n&&(n=l.range,i=n.split(" "))}var h,c,u,d,p={cell:null,rowIdx:0,colIdx:0,eventOnly:!0,preventEvt:!s},f=function(b){return p.cell={style:b},p.rowIdx=u,p.colIdx=d,gr(e.parent,r,p)},v=function(){var b,S,C=Object.keys(l.style);if(C.length){var x,I,D,M=e.parent,E=M.viewport&&e.parent.getActiveSheet().id===r.id,A=e.parent.frozenRowCount(r),L=e.parent.frozenColCount(r),N=[A+M.viewport.topIndex,L+M.viewport.leftIndex,M.viewport.bottomIndex,M.viewport.rightIndex],R,P,k,B,F=C.indexOf("color")>-1,O=F||C.indexOf("backgroundColor")>-1;return function(){for(u=h[0];u<=h[2];u++)if(P=Yr(r,u)||{},!P.isFiltered){for(R=u>=N[0]&&u<=N[2]||u<A,k=!1,d=h[1];d<=h[3];d++)if(!f(l.style)){if(S===void 0&&l.style.border!==void 0&&(b=l.style.border,delete l.style.border,S=!0),x=Q(u,d,r,!1,!0),D=r.columns[d],x.rowSpan>1||x.colSpan>1)for(var z=u,Y=x.rowSpan>1?u+(x.rowSpan-1):u;z<=Y;z++)for(var K=d,U=x.colSpan>1?d+(x.colSpan-1):d;K<=U;K++)S&&e.setFullBorder(r,b,h,z,K,t.onActionUpdate,!0),e.setCellStyle(r,z,K,l.style);if(S&&e.setFullBorder(r,b,h,u,d,t.onActionUpdate,void 0,c),e.setCellStyle(r,u,d,l.style),!!E)if(R&&(d>=N[1]&&d<=N[3]||d<L)){if(B=null,F&&x.format&&x.format.includes("[")){var q=Ho(x.format);q&&(B=q.toLowerCase())}e.parent.notify(Mr,{style:l.style,rowIdx:u,colIdx:d,lastCell:d===h[3],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:t.onActionUpdate,formatColor:B}),O&&(I=x.validation||hs(D,u,d)&&D.validation,I&&I.isHighlighted&&e.parent.notify(Rh,{rowIdx:u,colIdx:d,cell:x,validation:I,col:x.validation&&D}))}else P.customHeight||(k=k||Qd(l.style,t.onActionUpdate),k&&e.parent.notify(Mr,{rowIdx:u,colIdx:d,lastCell:d===h[3],checkHeight:!0,outsideViewport:!R,onActionUpdate:t.onActionUpdate}))}}}}else return function(){}},m={};Object.assign(m,l.style,null,!0);var y;i.forEach(function(b,S){if(h=typeof b=="string"?tt(ie(b)):b,Object.assign(l.style,m),c=[],t.borderType&&(e.setTypedBorder(r,t.style.border,h,t.borderType,t.onActionUpdate,c),S===i.length-1&&delete t.style.border,delete l.style.border),l.style.borderTop!==void 0){for(d=h[1];d<=h[3];d++)u=h[0],f({borderTop:l.style.borderTop})||(t.isUndoRedo||(e.checkAdjacentBorder(r,"borderBottom",u-1,d),e.checkFullBorder(r,"borderBottom",u-1,d)),e.checkFullBorder(r,"borderTop",u,d),e.setCellBorder(r,p.cell.style,u,d,t.onActionUpdate,d===h[3],null,null,t.isUndoRedo,c));delete l.style.borderTop}if(l.style.borderBottom!==void 0){var C=void 0,x=void 0;for(d=h[1];d<=h[3];d++){u=h[0],C=Q(u,d,r,!1,!0),C.rowSpan>0?x=Q(h[2],h[1],r,!1,!0):x=Q(h[2],h[3],r,!1,!0),C.rowSpan>1&&x.rowSpan<0||(u=h[2]);var I={range:[u,d,u,d]};e.parent.notify(pr,I),u=I.range[0],f({borderBottom:l.style.borderBottom})||(t.isUndoRedo||(e.checkAdjacentBorder(r,"borderTop",h[2]+1,d),e.checkFullBorder(r,"borderTop",h[2]+1,d)),e.checkFullBorder(r,"borderBottom",h[2],d),e.setCellBorder(r,p.cell.style,u,d,t.onActionUpdate,d===h[3],null,null,t.isUndoRedo),e.setBottomBorderPriority(r,h[2],d))}delete l.style.borderBottom}if(l.style.borderLeft!==void 0){for(var D=h[0];D<=h[2];D++){var M=void 0;e.parent.enableRtl?(d=h[3],M=d+1):(d=h[1],M=d-1),f({borderLeft:l.style.borderLeft})||(t.isUndoRedo||(e.checkAdjacentBorder(r,"borderRight",D,M),e.checkFullBorder(r,"borderRight",D,M)),e.checkFullBorder(r,"borderLeft",D,d),e.setCellBorder(r,p.cell.style,D,d,t.onActionUpdate,null,null,null,t.isUndoRedo))}delete l.style.borderLeft}if(l.style.borderRight!==void 0){for(var E=h[0];E<=h[2];E++){var M=void 0;e.parent.enableRtl?(d=h[1],M=d-1):(d=h[3],M=d+1);var I={range:[E,d,E,d]};e.parent.notify(pr,I),d=I.range[1],f({borderRight:l.style.borderRight})||(t.isUndoRedo||(e.checkAdjacentBorder(r,"borderLeft",E,M),e.checkFullBorder(r,"borderLeft",E,M)),e.checkFullBorder(r,"borderRight",E,d),e.setCellBorder(r,p.cell.style,E,d,t.onActionUpdate,null,null,null,t.isUndoRedo))}delete l.style.borderRight}S===0&&(y=v()),y(),md(e.parent,c,[h[1],h[3]]),e.parent.setUsedRange(h[2],h[3]),r.conditionalFormats&&r.conditionalFormats.length&&e.parent.notify(Gi,{indexes:h})}),t.refreshRibbon&&this.parent.notify(vo,null),s&&(l.style=m,l.range=r.name+"!"+n,this.parent.notify("actionComplete",{eventArgs:l,action:"format"}))}},o.prototype.setBottomBorderPriority=function(t,e,i){if(lt(t,e+1)){var r=this.skipHiddenRows(t,e+1),n=this.parent.getCellStyleValue(["borderTop"],[r,i]).borderTop;n!==""&&(t.rows[e].cells[i].style.bottomPriority=!0)}},o.prototype.setFullBorder=function(t,e,i,r,n,s,a,l){var h={};r===i[0]&&(this.checkAdjacentBorder(t,"borderBottom",r-1,n),this.checkFullBorder(t,"borderBottom",r-1,n)),n===i[1]&&(this.checkAdjacentBorder(t,"borderRight",r,n-1),this.checkFullBorder(t,"borderRight",r,n-1)),n===i[3]?(this.checkAdjacentBorder(t,"borderLeft",r,n+1),this.checkFullBorder(t,"borderLeft",r,n+1)):this.checkAdjacentBorder(t,"border",r,n+1),h.borderRight=e,h.borderTop=e,h.borderLeft=e,h.borderBottom=e,this.setCellBorder(t,h,r,n,s,n===i[3],null,a,void 0,l),r===i[2]?(this.checkAdjacentBorder(t,"borderTop",r+1,n),this.checkFullBorder(t,"borderTop",r+1,n),this.setBottomBorderPriority(t,r,n)):this.checkAdjacentBorder(t,"border",r+1,n)},o.prototype.checkAdjacentBorder=function(t,e,i,r){var n={};this.parent.getCellStyleValue([e],[i,r])[""+e]!==""&&(n[""+e]=void 0,this.setCellStyle(t,i,r,n))},o.prototype.checkFullBorder=function(t,e,i,r){var n=this.parent.getCellStyleValue(["border"],[i,r]).border;if(n!==""){var s={border:void 0};["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(a){a!==e&&(s[""+a]=n)}),this.setCellStyle(t,i,r,s)}},o.prototype.textDecorationActionUpdate=function(t){var e=this,i=this.parent.getActiveSheet(),r=i.selectedRange,n=r.split(" ");if(!n.some(function(f){return Hi(e.parent,tt(ie(f)),!0)})){var s={range:r,style:t.style,requestType:"CellFormat"};if(this.parent.trigger("beforeCellFormat",s),this.parent.notify("actionBegin",{eventArgs:s,action:"format"}),s.cancel){t.cancel=!0;return}s.range!==r&&(n=s.range.split(" "));var a=s.style.textDecoration.toLowerCase(),l=a,h=ie(i.activeCell),c=this.parent.getCellStyleValue(["textDecoration"],h).textDecoration.toLowerCase(),u=!1;c==="underline"?l=a==="underline"?"none":"underline line-through":c==="line-through"?l=a==="line-through"?"none":"underline line-through":c==="underline line-through"&&(l=a==="underline"?"line-through":"underline",u=!0),l==="none"&&(u=!0);var d={textDecoration:l},p;this.format({style:d,range:h,refreshRibbon:t.refreshRibbon,onActionUpdate:!0}),n.forEach(function(f){p=tt(ie(f));for(var v=p[0];v<=p[2];v++)for(var m=p[1];m<=p[3];m++)if(!(v===h[0]&&m===h[1])){if(d={},c=e.parent.getCellStyleValue(["textDecoration"],[v,m]).textDecoration.toLowerCase(),c==="none"){if(u)continue;d.textDecoration=a}else if(c==="underline"||c==="line-through")if(u)if(a===c)d.textDecoration="none";else continue;else d.textDecoration=a!==c?"underline line-through":a;else if(c==="underline line-through")if(u)d.textDecoration=a==="underline"?"line-through":"underline";else continue;e.format({style:d,range:[v,m,v,m],refreshRibbon:t.refreshRibbon,onActionUpdate:!0})}}),s.range=i.name+"!"+s.range,s.style.textDecoration=l,this.parent.notify("actionComplete",{eventArgs:s,action:"format"})}},o.prototype.setTypedBorder=function(t,e,i,r,n,s){var a;if(r==="Outer"){for(var l=i[1];l<=i[3];l++)this.checkAdjacentBorder(t,"borderBottom",i[0]-1,l),this.checkFullBorder(t,"borderBottom",i[0]-1,l),this.setCellBorder(t,{borderTop:e},i[0],l,n,l===i[3],void 0,void 0,void 0,s),this.checkAdjacentBorder(t,"borderTop",i[2]+1,l),this.checkFullBorder(t,"borderTop",i[2]+1,l),this.setCellBorder(t,{borderBottom:e},i[2],l,n,l===i[3],r),this.setBottomBorderPriority(t,i[2],l);for(var h=i[0];h<=i[2];h++)this.parent.enableRtl?(this.checkAdjacentBorder(t,"borderLeft",h,i[1]+1),this.checkFullBorder(t,"borderLeft",h,i[1]+1),this.setCellBorder(t,{borderRight:e},h,i[1],n),this.checkAdjacentBorder(t,"borderRight",h,i[3]-1),this.checkFullBorder(t,"borderRight",h,i[3]-1),this.setCellBorder(t,{borderLeft:e},h,i[3],n,null,r)):(this.checkAdjacentBorder(t,"borderRight",h,i[1]-1),this.checkFullBorder(t,"borderRight",h,i[1]-1),this.setCellBorder(t,{borderLeft:e},h,i[1],n),this.checkAdjacentBorder(t,"borderLeft",h,i[3]+1),this.checkFullBorder(t,"borderLeft",h,i[3]+1),this.setCellBorder(t,{borderRight:e},h,i[3],n,null,r))}else if(r==="Inner"){var c={range:[i[0],i[1],i[0],i[1]]};if(this.parent.notify(uo,c),c.range[0]===i[0]&&c.range[1]===i[1]&&c.range[2]===i[2]&&c.range[3]===i[3])return;for(var u=i[0];u<=i[2];u++)for(var d=i[1];d<=i[3];d++){var p={};a=this.parent.getCellStyleValue(["border"],[u,d]).border,a!==""&&(p.border=void 0,(d===i[3]||d===i[1]||u===i[0]||u===i[2])&&(u===i[0]&&(p.borderTop=a),u===i[2]&&(p.borderBottom=a),d===i[3]&&(p.borderRight=a),d===i[1]&&(p.borderLeft=a))),d!==i[3]&&(p.borderRight=e),u!==i[0]&&(p.borderTop=e),u!==i[2]&&(p.borderBottom=e),d!==i[1]&&(p.borderLeft=e),this.setCellBorder(t,p,u,d,n,d===i[3],void 0,void 0,void 0,s)}}else if(r==="Vertical")for(var u=i[0];u<=i[2];u++)for(var d=i[1];d<=i[3];d++){var p={borderRight:e,borderLeft:e};d===i[1]&&(this.checkAdjacentBorder(t,"borderRight",u,d-1),this.checkFullBorder(t,"borderRight",u,d-1)),d===i[3]&&(this.checkAdjacentBorder(t,"borderLeft",u,d+1),this.checkFullBorder(t,"borderLeft",u,d+1)),this.setCellBorder(t,p,u,d,n)}else for(var u=i[0];u<=i[2];u++)for(var d=i[1];d<=i[3];d++){var p={borderTop:e,borderBottom:e};u===i[0]&&(this.checkAdjacentBorder(t,"borderBottom",u-1,d),this.checkFullBorder(t,"borderBottom",u-1,d)),this.setCellBorder(t,p,u,d,n,d===i[3]),u===i[2]&&(this.checkAdjacentBorder(t,"borderTop",u+1,d),this.checkFullBorder(t,"borderTop",u+1,d),this.setBottomBorderPriority(t,u,d))}},o.prototype.setCellBorder=function(t,e,i,r,n,s,a,l,h,c){var u=Q(i,r,t),d=Ht(t,r),p=Yr(t,i);if(!(u&&u.isReadOnly||d&&d.isReadOnly||p&&p.isReadOnly)&&(this.setCellStyle(t,i,r,e),!l&&this.parent.getActiveSheet().id===t.id)){if(a==="Outer"&&(e.borderBottom||e.borderRight)){var f={range:[i,r,i,r]};this.parent.notify(pr,f),i=f.range[0],r=f.range[1]}h&&(e.borderTop===""&&this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom!==""&&(e.borderTop=this.parent.getCellStyleValue(["borderBottom"],[i-1,r]).borderBottom),e.borderLeft===""&&this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight!==""&&(e.borderLeft=this.parent.getCellStyleValue(["borderRight"],[i,r-1]).borderRight),e.borderRight===""&&this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft!==""&&(e.borderRight=this.parent.getCellStyleValue(["borderLeft"],[i,r+1]).borderLeft)),this.parent.notify(Mr,{style:e,rowIdx:i,colIdx:r,onActionUpdate:n,first:"",lastCell:s,isHeightCheckNeeded:!0,manualUpdate:!0,mergeBorderRows:c})}},o.prototype.setCellStyle=function(t,e,i,r){t.rows[e]?t.rows[e].cells||(t.rows[e].cells=[]):t.rows[e]={cells:[]},t.rows[e].cells[i]||(t.rows[e].cells[i]={}),t.rows[e].cells[i].style||(t.rows[e].cells[i].style={}),Object.assign(t.rows[e].cells[i].style,r,null,!0)},o.prototype.skipHiddenRows=function(t,e){return e++,lt(t,e)&&(e=this.skipHiddenRows(t,e)),e},o.prototype.addEventListener=function(){this.parent.on(ur,this.format,this),this.parent.on(Rd,this.textDecorationActionUpdate,this),this.parent.on(Hd,this.clearCellObj,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ur,this.format),this.parent.off(Rd,this.textDecorationActionUpdate),this.parent.off(Hd,this.clearCellObj))},o.prototype.clearCellObj=function(t){var e=t.range?t.range.lastIndexOf("!"):0,i=t.range?e>0?t.range.substring(e+1):t.range:this.parent.getActiveSheet().selectedRange,r=t.range&&e>0?Ct(this.parent,t.range.substring(0,e)):this.parent.activeSheetIndex,n=ke(this.parent,r),s=tt(Ji(i)),a=s[0],l=s[2],h=n.conditionalFormats&&n.conditionalFormats.length&&[].slice.call(n.conditionalFormats),c=[],u,d,p,f,v;for(a;a<=l;a++)for(p=s[1],f=s[3],p;p<=f;p++){var m=Q(a,p,n),y=Pl(m,Ht(n,p),Yr(n,a));if(m&&(t.type==="Clear All"||t.type==="Clear Formats")){if(m.rowSpan>1||m.colSpan>1){var b={range:[a,p,a,p]};this.parent.notify(uo,b);var S=b.range;s[0]<=S[0]&&s[1]<=S[1]&&s[2]>=S[2]&&s[3]>=S[3]&&this.parent.notify(Nn,{merge:!1,range:S,type:"All",sheetIndex:r,preventRefresh:r!==this.parent.activeSheetIndex})}if(m.rowSpan&&m.rowSpan!==1||m.colSpan&&m.colSpan!==1)continue}if(m&&!y)switch(t.type){case"Clear Formats":delete m.format,delete m.rowSpan,delete m.style,delete m.wrap,delete m.colSpan,delete m.formattedText,m.hyperlink&&(m.style={textDecoration:"none",color:"inherit"});break;case"Clear Contents":m.hyperlink&&(this.parent.notify(Mb,{sheet:n,rowIdx:a,colIdx:p,preventRefresh:!0}),m.style={textDecoration:"underline",color:"#00e"}),v=!!(m.value||m.formula),delete m.value,delete m.formula,delete m.formattedText,v&&(d={action:"refreshCalculate",rowIndex:a,colIndex:p,sheetIndex:r},this.parent.notify(At,d),h&&!u&&(u=d.isFormulaDependent,u||Eg(h,c,a,p)));break;case"Clear Hyperlinks":delete m.hyperlink;break;case"Clear All":v=!!(m.value||m.formula),Zt(a,p,n,{},!1),v&&(d={action:"refreshCalculate",rowIndex:a,colIndex:p,sheetIndex:r},this.parent.notify(At,d),h&&!u&&(u=d.isFormulaDependent));break}}(c.length||u)&&r===this.parent.activeSheetIndex&&this.parent.notify(Gi,{cfModel:!u&&c,refreshAll:u,isAction:!0})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"workbookcellformat"},o})(),Vz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Xc,this.performEditOperation,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Xc,this.performEditOperation)},o.prototype.getModuleName=function(){return"workbookEdit"},o.prototype.performEditOperation=function(t){var e=t.action;switch(e){case"updateCellValue":t.isFormulaDependent=this.updateCellValue(t.address,t.value,t.sheetIndex,t.isValueOnly,t.skipFormatCheck,t.isRandomFormula,t.skipCellFormat,t.isDelete,t.deletedRange,t.fillType,t.cellInformation,t.isRedo,t.isDependentUpdate,t.actionName,t.isPaste);break}},o.prototype.updateCellValue=function(t,e,i,r,n,s,a,l,h,c,u,d,p,f,v){i===void 0&&(i=this.parent.activeSheetIndex);var m,y;typeof t=="string"?m=ie(t):m=t;var b=ke(this.parent,i),S=Q(m[0],m[1],b,!0);if(S||(S=b.rows[m[0]].cells[m[1]]={}),r)S.value=e,S.formattedText&&delete S.formattedText;else{var C=pt(e);C=e==="#SPILL!"?!0:C;var x=!1;S.formula&&S.formula.indexOf("UNIQUE")>-1&&e===""&&(x=!0);var I=en(S.format)!=="Text"&&(!C||!e.toLowerCase().startsWith("=text("));C=en(S.format)==="Text"?!1:C,!C&&!x&&(S.formula&&(S.formula=""),S.value=I?Ad(e,v):e);var D={action:"refreshCalculate",value:e,rowIndex:m[0],colIndex:m[1],sheetIndex:i,isFormula:C,isRandomFormula:s,isDelete:l,deletedRange:h,fillType:c,isDependentRefresh:p};if(I&&!n){var M={value:e,rowIndex:m[0],colIndex:m[1],sheetIndex:i,updatedVal:"",skipCellFormat:a};if(C)!g(e)&&e.toLowerCase().includes("unique(")&&e.length>0&&(S.value=e);else{var E=en(S.format),A=e?e.toString().split("/"):[];if((E!=="Number"&&E!=="Percentage"&&E!=="Fraction"&&!(E==="Scientific"&&A.length===2)||E==="Fraction"&&A.length!==2)&&this.parent.notify(Jr,M),!g(M.updatedVal)&&M.updatedVal.length>0)S.value=M.updatedVal;else if(this.parent.isEdit&&e&&!De(e)){var L=nh(this.parent.locale,Ws);if(S.format)if((e.includes("%")||e.includes(L))&&Bs(S.format)){var N={formattedText:e,value:e,format:"General",cell:{value:e,format:"General"},isEdit:!0};this.parent.notify(yr,N),N.format!=="General"&&["Currency","Percentage"].indexOf(en(N.format))>-1&&(S.format=N.format,S.value=N.value)}else{var R={value:S.value,format:S.format,formattedText:S.value,type:"General",cell:S,rowIndex:m[0],colIndex:m[1]};this.parent.notify(yr,R)}else if(e.includes(L)||e.includes("%")||e.includes(Ki(this.parent.locale).group)){var P=new Nt,k={intl:P,updateValue:!0,value:"",curSymbol:L,cell:S};this.parent.notify(mg,{args:k,intl:P,fResult:e,cell:S})}}}}if(e==="#SPILL!")S.value=e;else{var B={cellIdx:m,isUnique:!1};if(this.parent.notify(Kc,B),this.parent.calculationMode==="Manual"&&C&&g(p)&&(f!=="autofill"||S.formula!=="")&&!this.parent.isEdit&&g(this.parent.element.querySelector(".e-text-replaceInp"))&&(x=!0,!d&&S.value===void 0&&(x=!1)),!x&&!l?(this.parent.notify(At,D),y=D.isFormulaDependent):e=S.value,C){if(S.formula=D.value,this.parent.calculationMode==="Manual"&&x&&d&&!this.parent.isEdit&&u&&u.cellDetails&&u.cellDetails.length>0&&u.cutCellDetails.length===0&&(!g(u.cellDetails[0].autoFillText)||!g(u.cellDetails[0].copyCellValue))){for(var F=0;F<u.cellDetails.length;F++)if(u.cellDetails[F].rowIndex===t[0]&&u.cellDetails[F].colIndex===t[1]){u.cellDetails[F].copyCellValue?e=S.value=u.cellDetails[F].copyCellValue:e=S.value=u.cellDetails[F].autoFillText;break}}else e=S.value,this.parent.calculationMode==="Manual"&&u&&d&&u.displayText&&(e=S.value=u.displayText);var O=S.formula.toLowerCase(),z=en(S.format)==="Scientific"&&!n&&this.parent.isEdit;O==="=now()"&&(!S.format||S.format==="General"||z)?S.format=cr("ShortDate")+" h:mm":O.includes("=time(")&&(!S.format||z)?S.format="h:mm AM/PM":O.includes("=date(")&&z&&(S.format=cr("ShortDate"))}else S.value&&typeof S.value=="string"&&(S.value.indexOf("www.")===0||S.value.indexOf("https://")===0||S.value.indexOf("http://")===0||S.value.indexOf("ftp://")===0)&&this.parent.notify(Pd,{hyperlink:S.value,cell:b.name+"!"+st(m[0],m[1])})}}return this.parent.setUsedRange(m[0],m[1],b),this.parent.chartColl.length&&!this.parent.isEdit&&!s&&this.parent.notify(Xo,{cell:S,rIdx:m[0],cIdx:m[1],sheetIdx:i,isRefreshChart:!0}),y},o})(),_z=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Pd,this.setLinkHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Pd,this.setLinkHandler)},o.prototype.setLinkHandler=function(t){var e=t.hyperlink,i=t.cell,r;if(i&&i.indexOf("!")!==-1){var n=i.lastIndexOf("!");if(r=ke(this.parent,Ct(this.parent,i.substring(0,n))),i=i.substring(n+1),!r)return}else r=this.parent.getActiveSheet(),i=i||r.selectedRange;var s=!t.triggerEvt&&r.isProtected;if(!(s&&!r.protectSettings.insertLink)){var a=tt(ie(i));typeof e=="string"?e.toLowerCase().indexOf("www.")===0&&(e="http://"+e):e.address.toLowerCase().indexOf("www.")===0&&(e.address="http://"+e.address);for(var l,h=ie(r.activeCell),c=a[0];c<=a[2];c++)for(var u=a[1];u<=a[3];u++)if(!(s&&mn(Q(c,u,r),Ht(r,u)))){var d=Q(c,u,r,null,!0);d.rowSpan<1||d.colSpan<1||(l={hyperlink:typeof e=="object"?Object.assign({},e):e},g(t.displayText)||(t.triggerEvt||t.isUndoRedo?c===h[0]&&u===h[1]&&(l.value=t.displayText,delete l.formattedText):(l.value=t.displayText,delete l.formattedText)),l.style={textDecoration:"underline",color:"#00e"},gr(this.parent,r,{cell:l,rowIdx:c,colIdx:u,preventEvt:!t.triggerEvt}),g(t.triggerEvt)||this.parent.setUsedRange(c,u,r))}this.parent.setUsedRange(a[2],a[3])}},o.prototype.getModuleName=function(){return"workbookHyperlink"},o})(),Uz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.insertModel=function(t){var e=this,i,r,n,s;if(t.model){var a,l=[],h,c,u;if(typeof t.start=="number"){a=t.start,t.end=t.end||a,a>t.end&&(a=t.end,t.end=t.start),t.modelType==="Row"&&a<t.model.maxHgts.length&&(u=[]);for(var d=a;d<=t.end;d++)l.push({}),u&&u.push(null)}else t.start?(a=t.start[0].index||0,l=t.start,c=!0):(a=0,l.push({})),t.modelType==="Row"&&a<t.model.maxHgts.length&&(u=[],l.forEach(function(){u.push(null)}));var p={model:l,index:a,modelType:t.modelType,insertType:t.insertType,cancel:!1,isUndoRedo:t.isUndoRedo},f={eventArgs:p,action:"insert"};if(t.isAction){if(this.parent.notify(hi,f),p.cancel)return;delete p.cancel,p.isAction=t.isAction}var v={startIndex:a,endIndex:a+l.length-1,modelType:t.modelType,sheet:t.model,isInsert:!0};if(t.modelType==="Row"){if(t.checkCount!==void 0&&t.model.rows&&t.checkCount===t.model.rows.length)return;if(this.parent.notify(Ss,v),t.model=t.model,t.model.rows||(t.model.rows=[]),c&&t.model.usedRange.rowIndex>-1&&a>t.model.usedRange.rowIndex)for(var d=t.model.usedRange.rowIndex;d<a-1;d++)l.splice(0,0,{});var m=this.parent.frozenRowCount(t.model);if(a<m||a<=m&&t.freezePane){var y=t.model.frozenRows+l.length-(a===m&&m>0?1:0);this.parent.setSheetPropertyOnMute(t.model,"frozenRows",y),p.freezePane=!0}(i=t.model.rows).splice.apply(i,[a,0].concat(l)),u&&(r=t.model.maxHgts).splice.apply(r,[a,0].concat(u)),this.setRowColCount(v.startIndex,v.endIndex,t.model,"row"),a>t.model.usedRange.rowIndex?this.parent.setUsedRange(a+(l.length-1),t.model.usedRange.colIndex,t.model,!0):this.parent.setUsedRange(t.model.usedRange.rowIndex+l.length,t.model.usedRange.colIndex,t.model,!0);for(var b=a+l.length,S,C=void 0,x,I,D=void 0,M=function(q){t.model.rows[b]&&t.model.rows[b].cells&&t.model.rows[b].cells[q]&&(C=t.model.rows[b].cells[q],C.rowSpan!==void 0&&C.rowSpan<0&&C.colSpan===void 0&&(D={range:[b,q,b,q],insertCount:l.length,insertModel:"Row"},E.parent.notify(qb,D),!p.freezePane&&D.range[0]<m&&D.range[2]>m&&(p.freezePane=!0))),I=Q(a-1,q,t.model,!1,!0),S=I.style,C=Q(a+1,q,t.model,!1,!0),(S||I.wrap||I.format)&&(S&&(x={},Object.keys(S).forEach(function(ae){ae==="borderLeft"||ae==="borderRight"||ae==="borderTop"||ae==="borderBottom"||(x[ae]=S[ae])}),C.style&&E.checkBorder(C.style,t.model.rows[a-1].cells[q].style,x)),(!t.isUndoRedo||t.isRedo)&&l.forEach(function(ae){ae.cells||(ae.cells=[]),ae.cells[q]||(ae.cells[q]={}),S&&(ae.cells[q].style||(ae.cells[q].style={}),Object.assign(ae.cells[q].style,x)),I.wrap&&(ae.cells[q].wrap=!0),I.format&&(ae.cells[q].format=I.format)}))},E=this,d=0;d<=t.model.usedRange.colIndex;d++)M(d);p.sheetCount=t.model.rows.length}else if(t.modelType==="Column"){if(t.checkCount!==void 0&&t.model.columns&&t.checkCount===t.model.columns.length)return;this.parent.notify(Ss,v),t.model=t.model,t.model.columns||(t.model.columns=[]),a&&!t.model.columns[a-1]&&(t.model.columns[a-1]={}),(n=t.model.columns).splice.apply(n,[a,0].concat(l));var A=this.parent.frozenColCount(t.model);if(a<A||a<=A&&t.freezePane){var L=t.model.frozenColumns+l.length-(a===A&&A>0?1:0);this.parent.setSheetPropertyOnMute(t.model,"frozenColumns",L),p.freezePane=!0}this.setRowColCount(v.startIndex,v.endIndex,t.model,"col"),a>t.model.usedRange.colIndex?this.parent.setUsedRange(t.model.usedRange.rowIndex,a+(l.length-1),t.model,!0):this.parent.setUsedRange(t.model.usedRange.rowIndex,t.model.usedRange.colIndex+l.length,t.model,!0),t.model.rows||(t.model.rows=[]);var N=[];t.columnCellsModel||(t.columnCellsModel=[]);for(var d=0;d<l.length;d++)N.push(null);h=[];for(var C=void 0,R,P,k=void 0,d=0;d<=t.model.usedRange.rowIndex;d++){t.model.rows[d]?t.model.rows[d].cells||(t.model.rows[d].cells=[]):t.model.rows[d]={cells:[]},a&&!t.model.rows[d].cells[a-1]&&(t.model.rows[d].cells[a-1]={}),(s=t.model.rows[d].cells).splice.apply(s,[a,0].concat(t.columnCellsModel[d]&&t.columnCellsModel[d].cells?t.columnCellsModel[d].cells:N));var b=a+l.length;if(C=t.model.rows[d].cells[b],C&&C.colSpan!==void 0&&C.colSpan<0&&C.rowSpan===void 0)h.push({range:[d,b,d,b],insertCount:N.length,insertModel:"Column"});else if(t.isUndoRedo&&!t.isRedo){for(var B=void 0,F=a;F<b&&(C=t.model.rows[d].cells[F],C&&C.colSpan!==void 0&&C.colSpan<0&&C.rowSpan===void 0);F++)B=F;B&&h.push({range:[d,B,d,B],insertCount:0,insertModel:"Column"})}if(k=Q(d,a-1,t.model,!1,!0),R=k.style,C=Q(d,a+1,t.model,!1,!0),(R||k.wrap||k.format)&&(R&&(P={},Object.keys(R).forEach(function(he){he==="borderLeft"||he==="borderRight"||he==="borderTop"||he==="borderBottom"||(P[he]=R[he])}),C.style&&this.checkBorder(C.style,t.model.rows[d].cells[a-1].style,P)),!t.isUndoRedo||t.isRedo))for(var O=a;O<b;O++)t.model.rows[d].cells[O]||(t.model.rows[d].cells[O]={}),R&&(t.model.rows[d].cells[O].style||(t.model.rows[d].cells[O].style={}),Object.assign(t.model.rows[d].cells[O].style,P)),k.wrap&&(t.model.rows[d].cells[O].wrap=!0),k.format&&(t.model.rows[d].cells[O].format=k.format)}h.forEach(function(ae){e.parent.notify(qb,ae),!p.freezePane&&ae.range[1]<A&&ae.range[3]>A&&(p.freezePane=!0)}),p.sheetCount=t.model.columns.length}else{if(t.checkCount!==void 0&&t.checkCount===this.parent.sheets.length)return;for(var z=l,Y=Gn(this.parent),K=t.isFromUpdateAction,d=0;d<z.length;d++)if(z[d].name){for(var O=0;O<this.parent.sheets.length;O++)if(z[d].name===this.parent.sheets[O].name){z.splice(d,1),d--;break}}if(!z.length)return;delete l[0].index,this.parent.createSheet(a,l);var U;t.activeSheetIndex?(p.activeSheetIndex=t.activeSheetIndex,this.parent.setProperties({activeSheetIndex:t.activeSheetIndex},!0)):!t.isAction&&t.start<this.parent.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),K&&this.parent.setProperties({activeSheetIndex:Ct(this.parent,Y)},!0),l.forEach(function(q){c&&e.updateRangeModel(q.ranges);var ae=e.parent.viewport,te=[ae.topIndex,ae.leftIndex,ae.bottomIndex,ae.rightIndex],he={sheet:q,resolveAfterFullDataLoaded:!0,indexes:te,promise:new Promise(function(ue){ue((function(){})())})};e.parent.notify(Bh,he),U=q.id,e.parent.notify(At,{action:"addSheet",visibleName:q.name,sheetName:"Sheet"+U,sheetId:U})}),p.activeSheetIndex=t.activeSheetIndex,p.sheetCount=this.parent.sheets.length}t.modelType!=="Sheet"&&(this.insertConditionalFormats(t),this.parent.notify(Jb,{start:a,end:a+l.length-1,modelType:t.modelType,model:t.model,isInsert:!0}),p.activeSheetIndex=Ct(this.parent,t.model.name),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(Xo,{range:ie(t.model.selectedRange)})),this.parent.notify(DM,f)}},o.prototype.setRowColCount=function(t,e,i,r){var n=r+"Count";this.parent.setSheetPropertyOnMute(i,n,i[""+n]+(e-t+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(Od,{index:i[""+n]-1,update:r,isInsert:!0,start:t,end:e})},o.prototype.updateRangeModel=function(t){t.forEach(function(e){e.dataSource&&(e.startCell=e.startCell||"A1",e.showFieldAsHeader=e.showFieldAsHeader===void 0||e.showFieldAsHeader,e.template=e.template||"",e.address=e.address||"A1")})},o.prototype.checkBorder=function(t,e,i){t.borderLeft&&t.borderLeft===e.borderLeft&&(i.borderLeft=t.borderLeft),t.borderRight&&t.borderRight===e.borderRight&&(i.borderRight=t.borderRight),t.borderTop&&t.borderTop===e.borderTop&&(i.borderTop=t.borderTop),t.borderBottom&&t.borderBottom===e.borderBottom&&(i.borderBottom=t.borderBottom)},o.prototype.setInsertInfo=function(t,e,i,r,n){n===void 0&&(n="Row");var s=i=e+(i-1);t.ranges.forEach(function(a){a.info&&e<a.info[""+r]&&(a.info["insert"+n+"Range"]?a.info["insert"+n+"Range"].push([e,s]):a.info["insert"+n+"Range"]=[[e,s]],a.info[""+r]+=s-e+1)})},o.prototype.insertConditionalFormats=function(t){var e=t.model.conditionalFormats;if(t.prevAction==="delete")this.parent.setSheetPropertyOnMute(t.model,"conditionalFormats",t.conditionalFormats);else if(e)for(var i=0,r=e.length;i<r;i++)e[i].range=Ve(UY(t,ie(e[i].range),!t.isAction&&!t.isUndoRedo))},o.prototype.addEventListener=function(){this.parent.on(Fa,this.insertModel,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Fa,this.insertModel)},o.prototype.getModuleName=function(){return"workbookinsert"},o})(),v9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.deleteModel=function(t){var e=this,i=this.parent.sheets.length;if(!(t.modelType==="Sheet"&&i===1)){var r=t.modelType.toLowerCase()+"s";if(t.start=t.start,t.start>t.end){var n=t.start;t.start=t.end,t.end=n}var s={startIndex:t.start,endIndex:t.end,modelType:t.modelType,cancel:!1,isUndoRedo:t.isUndoRedo},a={eventArgs:s,action:"delete"};if(!(t.isAction&&(this.parent.notify(hi,a),s.cancel))){var l,h,c=[],u=t.end-t.start+1,d={startIndex:t.start,endIndex:t.end,modelType:t.modelType,sheet:t.model,isDelete:!0},p=this.parent.scrollSettings.isFinite;if(t.modelType==="Row"){if(t.checkCount!==void 0&&t.checkCount===t.model.usedRange.rowIndex)return;if(this.parent.notify(Ss,d),t.model=t.model,p){if(t.start>=t.model.rowCount)return;t.end>=t.model.rowCount&&(t.end=t.model.rowCount-1)}else{if(t.start>t.model.usedRange.rowIndex)return;t.end>t.model.usedRange.rowIndex&&(t.end-=t.end-t.model.usedRange.rowIndex)}this.setRowColCount(t.start,t.end,t.model,"row"),t.start<=t.model.usedRange.rowIndex&&(this.parent.setSheetPropertyOnMute(t.model,"usedRange",{rowIndex:t.model.usedRange.rowIndex-(t.end-t.start+1),colIndex:t.model.usedRange.colIndex}),t.model.usedRange.rowIndex<0&&this.parent.setSheetPropertyOnMute(t.model,"usedRange",{rowIndex:0,colIndex:t.model.usedRange.colIndex}));var f=this.parent.frozenRowCount(t.model);t.start<f&&(f=t.end<f?t.end-t.start+1:f-t.start,f=t.model.frozenRows-f,this.parent.setSheetPropertyOnMute(t.model,"frozenRows",f),s.freezePane=!0);var v=t.end+1,m=void 0,y=void 0;if(t.model.rows[t.start]&&t.model.rows[t.start].cells)for(var b=0;b<=t.model.usedRange.colIndex;b++){if(t.model.rows[t.start].cells[b]&&t.model.rows[t.start].cells[b].rowSpan!==void 0&&t.model.rows[t.start].cells[b].rowSpan<0&&t.model.rows[t.start].cells[b].colSpan===void 0&&(y={range:[t.start,b,t.start,b]},this.parent.notify(pr,y),y.range=y.range,y.range[2]<=t.end&&(h=Q(y.range[0],b,t.model),h&&h.rowSpan>1&&(h.rowSpan-(y.range[2]-t.start+1)>1?Zt(y.range[0],b,t.model,{colSpan:h.rowSpan-(y.range[2]-t.start+1)},!0):delete t.model.rows[y.range[0]].cells[b].rowSpan),y=null)),t.model.rows[v]&&t.model.rows[v].cells&&t.model.rows[v].cells[b]&&t.model.rows[v].cells[b].rowSpan!==void 0&&t.model.rows[v].cells[b].rowSpan<0&&t.model.rows[v].cells[b].colSpan===void 0&&(y||(y={range:[v,b,v,b]},this.parent.notify(pr,y)),m=new Object,y.range=y.range,Object.assign(m,Q(y.range[0],y.range[1],t.model)),m&&m.rowSpan&&(m.rowSpan>1||m.colSpan>1))){var S=[];S[1]=b,S[3]=m.colSpan>1?b+(m.colSpan-1):b,y.range=y.range,y.range[0]<t.start?(S[0]=S[2]=y.range[0],m.rowSpan-u>1&&(S[2]+=m.rowSpan-u-1)):(S[0]=S[2]=t.start,m.rowSpan-(t.end-y.range[0]+1)>1&&(S[2]+=m.rowSpan-(t.end-y.range[0]+1)-1)),c.push({range:S,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}y=null}s.sheetCount=t.model.usedRange.rowIndex}else if(t.modelType==="Column"){if(t.checkCount!==void 0&&t.checkCount===t.model.usedRange.colIndex)return;if(this.parent.notify(Ss,d),t.model=t.model,p){if(t.start>=t.model.colCount)return;t.end>=t.model.colCount&&(t.end=t.model.colCount-1)}else{if(t.start>t.model.usedRange.colIndex)return;t.end>t.model.usedRange.colIndex&&(t.end-=t.end-t.model.usedRange.colIndex)}this.setRowColCount(t.start,t.end,t.model,"col"),t.start<=t.model.usedRange.colIndex&&(this.parent.setSheetPropertyOnMute(t.model,"usedRange",{rowIndex:t.model.usedRange.rowIndex,colIndex:t.model.usedRange.colIndex-u}),t.model.usedRange.colIndex<0&&this.parent.setSheetPropertyOnMute(t.model,"usedRange",{rowIndex:t.model.usedRange.rowIndex,colIndex:0}));var C=this.parent.frozenColCount(t.model);t.start<C&&(C=t.end<C?t.end-t.start+1:C-t.start,C=t.model.frozenColumns-C,this.parent.setSheetPropertyOnMute(t.model,"frozenColumns",C),this.parent.updateTopLeftCell(),s.freezePane=!0),l=[];for(var v=t.end+1,m=void 0,y=void 0,b=0;b<=t.model.usedRange.rowIndex;b++)if(l.push({}),t.model.rows[b]&&t.model.rows[b].cells){if(t.model.rows[b].cells[t.start]&&t.model.rows[b].cells[t.start].colSpan!==void 0&&t.model.rows[b].cells[t.start].colSpan<0&&t.model.rows[b].cells[t.start].rowSpan===void 0&&(y={range:[b,t.start,b,t.start]},this.parent.notify(pr,y),y.range=y.range,y.range[3]<=t.end)){var x=Q(b,y.range[1],t.model);x&&x.colSpan>1&&(x.colSpan-(y.range[3]-t.start+1)>1?Zt(b,y.range[1],t.model,{colSpan:x.colSpan-(y.range[3]-t.start+1)},!0):delete t.model.rows[b].cells[y.range[1]].colSpan),y=null}if(t.model.rows[b].cells[v]&&t.model.rows[b].cells[v].colSpan!==void 0&&t.model.rows[b].cells[v].colSpan<0&&t.model.rows[b].cells[v].rowSpan===void 0&&(y||(y={range:[b,v,b,v]},this.parent.notify(pr,y)),m=new Object,y.range=y.range,Object.assign(m,Q(y.range[0],y.range[1],t.model)),m&&m.colSpan&&(m.colSpan>1||m.rowSpan>1))){var S=[];S[0]=b,S[2]=m.rowSpan>1?b+(m.rowSpan-1):b,y.range=y.range,y.range[1]<t.start?(S[1]=S[3]=y.range[1],m.colSpan-u>1&&(S[3]+=m.colSpan-u-1)):(S[1]=S[3]=t.start,m.colSpan-(t.end-y.range[1]+1)>1&&(S[3]+=m.colSpan-(t.end-y.range[1]+1)-1)),c.push({range:S,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}l[b].cells=t.model.rows[b].cells.splice(t.start,u),y=null}s.sheetCount=t.model.usedRange.colIndex,s.deletedCellsModel=l}else{if(t.end-t.start===this.parent.sheets.length-1||t.checkCount!==void 0&&t.checkCount===this.parent.sheets.length)return;this.parent.notify(Ss,d),s.sheetCount=this.parent.sheets.length,s.activeSheetIndex=this.parent.activeSheetIndex}for(var I=[],D=t.modelType==="Row"&&t.start<t.model.maxHgts.length,M=t.model[""+r],b=t.start;b<=t.end;b++)t.modelType==="Sheet"&&M[b]&&this.parent.notify(At,{action:"deleteSheetTab",sheetId:M[b].id}),M[t.start]||t.start<M.length?(I.push(M[t.start]||{}),M.splice(t.start,1)):I.push({}),b===t.start&&(I[0].index=t.start),D&&t.model.maxHgts.splice(t.start,1);c.forEach(function(E){return e.parent.notify(Nn,E)}),this.parent.notify(wg,t),t.modelType!=="Sheet"&&(this.parent.notify(Jb,t),s.refreshSheet=t.refreshSheet,s.activeSheetIndex=Ct(this.parent,t.model.name),s.conditionalFormats=[],this.deleteConditionalFormats(t,s)),s.definedNames=d.definedNames,s.isAction=t.isAction,s.deletedModel=I,delete s.cancel,t.modelType!=="Sheet"&&this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(Xo,{range:ie(t.model.selectedRange)}),this.parent.notify(EM,a)}}},o.prototype.setRowColCount=function(t,e,i,r){var n=r+"Count",s=i[""+n];e>=s&&(e=s-1),!(e<t)&&(this.parent.setSheetPropertyOnMute(i,n,s-(e-t+1)),i.id===this.parent.getActiveSheet().id&&this.parent.notify(Od,{index:s-1,update:r,isDelete:!0,start:t,end:e}))},o.prototype.deleteConditionalFormats=function(t,e){var i=t.model.conditionalFormats;if(i)for(var r=0;r<i.length;r++){e.conditionalFormats.push(pe({},i[r],null,!0));var n=ie(i[r].range),s=ie(t.model.selectedRange);t.modelType==="Column"&&s[1]<=n[1]&&s[3]>=n[3]||t.modelType==="Row"&&s[0]<=n[0]&&s[2]>=n[2]?(i.splice(i.indexOf(i[r]),1),r--):i[r].range=Ve(WY(t,n))}},o.prototype.addEventListener=function(){this.parent.on(Sg,this.deleteModel,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Sg,this.deleteModel)},o.prototype.getModuleName=function(){return"workbookdelete"},o})(),Wz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.highlightInvalidData=null,this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Qo,this.updateValidationHandler,this),this.parent.on(jb,this.addHighlightHandler,this),this.parent.on(Vb,this.removeHighlightHandler,this),this.parent.on(Ed,this.beforeInsertDeleteHandler,this),this.parent.on(wg,this.beforeInsertDeleteHandler,this),this.parent.on(Ss,this.beforeInsertDeleteHandler,this),this.parent.on(aa,this.updataSheetValidation,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Qo,this.updateValidationHandler),this.parent.off(jb,this.addHighlightHandler),this.parent.off(Vb,this.removeHighlightHandler),this.parent.off(Ed,this.beforeInsertDeleteHandler),this.parent.off(wg,this.beforeInsertDeleteHandler),this.parent.off(Ss,this.beforeInsertDeleteHandler),this.parent.off(aa,this.updataSheetValidation))},o.prototype.updateValidationHandler=function(t){var e=this,i,r=t.range.lastIndexOf("!"),n,s;if(r>-1){i=t.range.substring(0,r),t.range=t.range.substring(r+1);var a=Ct(this.parent,i);n=ke(this.parent,a),s=a===this.parent.activeSheetIndex}else n=this.parent.getActiveSheet(),s=!0;var l=this.getRangeWhenColumnSelected(t.range,n);i&&(t.range=i+"!"+l.range);var h=tt(ie(l.range)),c,u,d,p,f,v,m,y={colIdx:h[1]};if(s){d=this.parent.frozenRowCount(n);var b=this.parent.frozenColCount(n),S=this.parent,C=S.viewport||{};if(f=S.scrollSettings&&S.scrollSettings.enableVirtualization?[d+C.topIndex,b+C.leftIndex,C.bottomIndex,C.rightIndex]:[0,0,n.rowCount-1,n.colCount-1],l.isFullCol){var x=[[f[0],f[2]]];d&&x.push([ie(n.topLeftCell)[0],d-1]),m=function(R){R.isHighlighted&&(y.colIdx>=f[1]&&y.colIdx<=f[3]||y.colIdx<b)&&!Ft(n,y.colIdx)&&x.forEach(function(P){for(y.rowIdx=P[0];y.rowIdx<=P[1];y.rowIdx++)lt(n,y.rowIdx)||(y.cell=Q(y.rowIdx,y.colIdx,n,!1,!0),y.validation=y.cell.validation?y.cell.validation:R,e.parent.notify(Rh,y))})}}v=function(R){R.isHighlighted&&p&&(y.colIdx>=f[1]&&y.colIdx<=f[3]||y.colIdx<b)&&!Ft(n,y.colIdx)&&e.parent.notify(Rh,y)}}var I,D,M,E;if(t.isRemoveValidation){if(s){if(M=ie(n.activeCell),M[0]>=h[0]&&M[1]>=h[1]&&M[0]<=h[2]&&M[1]<=h[3]){var A=Q(M[0],M[1],n,!1,!0).validation||hs(n.columns[h[1]],M[0],M[1])&&n.columns[M[1]].validation;D=A&&A.type==="List"}y.isRemoveValidation=!0,y.isRemoveHighlightedData=!0}}else{t.isAction&&this.highlightInvalidData&&(I={isHighlighted:this.highlightInvalidData}),t.rules.type==="List"?(M=ie(n.activeCell),D=s&&M[0]>=h[0]&&M[1]>=h[1]&&M[0]<=h[2]&&M[1]<=h[3],t.rules.value1&&(t.rules.value1=t.rules.value1.trim(),t.rules.value1[t.rules.value1.length-1]===this.parent.listSeparator&&(t.rules.value1=t.rules.value1.substring(0,t.rules.value1.length-1)))):t.rules.type==="Custom"&&!g(t.rules.value2)&&delete t.rules.value2,s&&(y.removeOnValidData=!0);var L=pt(t.rules.value1),N=pt(t.rules.value2);E=function(R){L&&(y.validation.value1=ln([R,y.colIdx,R,y.colIdx],h,n,e.parent,{formula:t.rules.value1},null,!0)),N&&(y.validation.value2=ln([R,y.colIdx,R,y.colIdx],h,n,e.parent,{formula:t.rules.value2},null,!0))}}for(y.colIdx;y.colIdx<=h[3];y.colIdx++){if(l.isFullCol)if(t.isRemoveValidation)c=n.columns[y.colIdx],c&&c.validation&&(s&&m(c.validation),delete c.validation);else{y.validation=Object.assign({},t.rules,I),E(0),n.columns[y.colIdx]||(n.columns[y.colIdx]={}),n.columns[y.colIdx].validation=y.validation,s&&m(y.validation);continue}for(y.rowIdx=h[0];y.rowIdx<=h[2];y.rowIdx++)p=s&&(y.rowIdx>=f[0]&&y.rowIdx<=f[2]||y.rowIdx<d)&&!lt(n,y.rowIdx),t.isRemoveValidation?(c=n.columns[y.colIdx],c&&c.validation&&(y.rowIdx===h[2]&&(c.validation.address=jY(c.validation.address,[h[0],y.colIdx,h[2],y.colIdx],y.colIdx)),s&&v(c.validation)),u=Q(y.rowIdx,y.colIdx,n),u&&u.validation&&!gr(this.parent,n,{cell:{validation:{}},rowIdx:y.rowIdx,colIdx:y.colIdx})&&(s&&v(u.validation),delete u.validation)):(y.validation=Object.assign({},t.rules,I),E(y.rowIdx),gr(this.parent,n,{cell:{validation:y.validation},rowIdx:y.rowIdx,colIdx:y.colIdx})||s&&(y.cell=Q(y.rowIdx,y.colIdx,n),v(y.validation)))}if(D){u=Q(M[0],M[1],n,!1,!0);var A=u.validation;A||(A=hs(n.columns[M[1]],M[0],M[1])?n.columns[M[1]].validation:{}),this.parent.notify(Yd,{validation:A,cell:u,rowIdx:M[0],colIdx:M[1],isRefresh:!0})}},o.prototype.addHighlightHandler=function(t){t.isAction&&(this.highlightInvalidData=!0),this.invalidDataHandler(t.range)},o.prototype.removeHighlightHandler=function(t){t.isAction&&(this.highlightInvalidData=null),this.invalidDataHandler(t.range,!0)},o.prototype.invalidDataHandler=function(t,e){var i=this,r,n,s,a,l,h,c,u,d,p,f=this.parent,v=this.parent.getActiveSheet(),m=this.parent.frozenRowCount(v),y=this.parent.frozenColCount(v),b=f.scrollSettings&&f.scrollSettings.enableVirtualization?f.viewport?[m+f.viewport.topIndex,y+f.viewport.leftIndex,f.viewport.bottomIndex,f.viewport.rightIndex]:[]:[0,0,v.rowCount-1,v.colCount-1],S=function(D,M){h&&(a>=b[1]&&a<=b[3]||a<y)&&!Ft(v,a)&&i.parent.notify(Rh,{isRemoveHighlightedData:e,rowIdx:s,colIdx:a,cell:r,validation:D,removeOnValidData:!0,col:M})},C;e?C=function(D,M){D.isHighlighted&&(M&&delete D.isHighlighted,S(D))}:C=function(D,M,E){M&&(D.isHighlighted=!0),S(D,E)};var x=function(){for(s=l[0];s<=l[2];s++)for(h=c&&(s>=b[0]&&s<=b[2]||s<m)&&!lt(v,s),u&&(p=Yr(v,s),d=Math.max(p&&p.cells?p.cells.length-1:null,v.columns.length-1,l[3])),a=l[1];a<=d;a++)r=Q(s,a,v,!1,!0),n=v.columns[a],r.validation?C(r.validation,!0,n):hs(n,s,a)&&C(n.validation,s===l[2])};if(t){if(t.includes("!")){var I=js(this.parent,t);v=ke(this.parent,I),t=Gc(t),c=I===this.parent.activeSheetIndex}else c=!0;l=tt(ie(this.getRangeWhenColumnSelected(jM(v,t),v).range)),d=l[3],x()}else u=!0,this.parent.sheets.forEach(function(D,M){v=D,l=[0,0,Math.max(v.rows.length-1,b[2]),Math.max(v.usedRange.colIndex,b[3])],c=M===i.parent.activeSheetIndex,x()})},o.prototype.beforeInsertDeleteHandler=function(t){var e=this,i;if(t.modelType==="Sheet"){if(t.name!==Ss)return;i=!0}else if(t.name===Ss)return;var r=t.name===Ed,n,s,a,l;if(r)a=ke(this.parent,t.activeSheetIndex),s=t.index+(t.model.length-1),n={insertDeleteArgs:{startIndex:t.index,endIndex:s,modelType:t.modelType,isInsert:!0,sheet:a},sheetIdx:t.activeSheetIndex},l=t.index-1;else if(i){var h=[],c=void 0,u={action:"getSheetInfo",sheetInfo:[]};this.parent.notify(At,u);for(var d=t.startIndex;d<=t.endIndex;d++){c=this.parent.sheets[d].id;for(var p=0;p<u.sheetInfo.length;p++)if(u.sheetInfo[p].index===c){h.push(u.sheetInfo[p].sheet);break}}n={sheetNames:h}}else a=t.model,n={insertDeleteArgs:{startIndex:t.start,modelType:t.modelType,endIndex:t.end,sheet:a},sheetIdx:Cn(this.parent,a.id)};var f=function(M){pt(M.value1)&&(!n.otherSheet||M.value1.includes(a.name))&&(n.cell={formula:M.value1},e.parent.notify(e0,n),M.value1=n.cell.formula),pt(M.value2)&&(!n.otherSheet||M.value2.includes(a.name))&&(n.cell={formula:M.value2},e.parent.notify(e0,n),M.value2=n.cell.formula)},v=t.modelType==="Column",m=function(M,E){if(M){n.insertDeleteArgs.forceUpdate=!0;for(var A=t.index;A<=s;A++)M=pe({},M),f(M),E?Hl(a,A,{validation:M}):v?Zt(x,A,a,{validation:M},!0):Zt(A,I,a,{validation:M},!0);delete n.insertDeleteArgs.forceUpdate}},y,b,S,C,x,I,D;this.parent.sheets.forEach(function(M,E){if(i){if(E>=t.startIndex&&E<=t.endIndex)return}else E===n.sheetIdx?(D=r,delete n.otherSheet,delete n.formulaSheet):(n.otherSheet=!0,n.formulaSheet=M,D=!1);for(S=M.usedRange.rowIndex+1,I=0,C=M.usedRange.colIndex+1;I<C;I++)if(!(D&&v&&I>=t.index&&I<=s))for(b=M.columns&&M.columns[I],b&&b.validation&&(f(b.validation),D&&v&&l===I&&m(b.validation,!0)),x=0;x<S;x++)y=Q(x,I,M,!1,!0),y.validation&&(!D||v||x<t.index||x>s)&&(f(y.validation),D&&l===(v?I:x)&&m(y.validation))})},o.prototype.getRangeWhenColumnSelected=function(t,e){var i,r=t.split(":");return t.match(/\D/g)&&!t.match(/[0-9]/g)?(r[0]+=1,r[1]+=e.rowCount,t=r[0]+":"+r[1],i=!0):!t.match(/\D/g)&&t.match(/[0-9]/g)&&(r[0]="A"+r[0],r[1]=st(0,e.colCount-1).replace(/[0-9]/g,"")+r[1],t=r[0]+":"+r[1]),{range:t,isFullCol:i}},o.prototype.updataSheetValidation=function(){var t=this,e,i,r,n,s,a=function(c,u){var d=ie(e.shift());if(s=[d[0],d[1]],e.length){var p=[d];e.forEach(function(f){d=ie(f),d[0]<s[0]&&(s[0]=d[0]),d[1]<s[1]&&(s[1]=d[1]),p.push(d)}),p.forEach(function(f){h(f,c,u)})}else h(d,c,u)},l,h=function(c,u,d){if(c[0]===0&&c[2]===1048575)for(n=c[1],r=0;n<=c[3];)i=Object.assign({},u),l(),Hl(d,n,{validation:i}),n++;else{r=c[0];for(var p=Math.min(c[2],d.usedRange.rowIndex),f=Math.min(c[3],d.usedRange.colIndex);r<=p;){for(n=c[1];n<=f;)i=Object.assign({},u),l(),Zt(r,n,d,{validation:i},!0),n++;r++}}};this.parent.sheets.forEach(function(c){c.validations&&(c.validations.forEach(function(u){u.range&&u.range.length&&(e=u.range,delete u.range,pt(u.value2)?(pt(u.value1)?l=function(){i.value1=ln([r,n],s,c,t.parent,{formula:i.value1},null,!0),i.value2=ln([r,n],s,c,t.parent,{formula:i.value2},null,!0)}:l=function(){i.value2=ln([r,n],s,c,t.parent,{formula:i.value2},null,!0)},a(u,c)):pt(u.value1)?(l=function(){i.value1=ln([r,n],s,c,t.parent,{formula:i.value1},null,!0)},a(u,c)):(l=function(){},e.forEach(function(d){h(ie(d),u,c)})))}),delete c.validations)})},o.prototype.getModuleName=function(){return"workbookDataValidation"},o})(),_D=function(){return _D=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},_D.apply(this,arguments)},qz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(TM,this.find,this),this.parent.on(Cg,this.replace,this),this.parent.on(Bd,this.replaceAll,this),this.parent.on(_b,this.totalCount,this),this.parent.on(SM,this.findAllValues,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(TM,this.find),this.parent.off(Cg,this.replace),this.parent.off(Bd,this.replaceAll),this.parent.off(_b,this.totalCount),this.parent.off(SM,this.findAllValues))},o.prototype.find=function(t){t.sheetIndex=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex;var e=this.parent.sheets[t.sheetIndex],i=ie(e.activeCell),r={startRow:i[0],startCol:i[1],findVal:t.isCSen?t.value:t.value.toLowerCase(),activeCell:i};(t.searchBy==="By Row"?r.startRow>e.usedRange.rowIndex:r.startCol>e.usedRange.colIndex)?t.findOpt==="next"?r.startRow=r.startCol=0:(r.startRow=e.usedRange.rowIndex,r.startCol=e.usedRange.colIndex):t.searchBy==="By Row"?r.startCol>e.usedRange.colIndex&&(t.findOpt==="next"?(r.startRow++,r.startRow>e.usedRange.rowIndex&&(r.startRow=0),r.startCol=0):(r.startRow--,r.startRow<0&&(r.startRow=e.usedRange.rowIndex),r.startCol=e.usedRange.colIndex)):r.startRow>e.usedRange.rowIndex&&(t.findOpt==="next"?(r.startCol++,r.startCol>e.usedRange.colIndex&&(r.startRow=0),r.startRow=0):(r.startCol--,r.startCol<0&&(r.startCol=e.usedRange.colIndex),r.startRow=e.usedRange.colIndex)),t.mode==="Workbook"?(r.sheets=this.parent.sheets,r.sheetIdx=t.sheetIndex):(r.sheets=[e],r.sheetIdx=0);var n,s=t.showDialog&&this.parent.element&&this.parent.element.querySelector(".e-header-panel");s&&(n=(s.offsetHeight||(e.showHeaders?30:0))+1),t.localeObj=Ki(this.parent.locale),t.findOpt==="next"?this.findNext(t,r):this.findPrevious(t,r),t.showDialog&&this.parent.notify(Qc,{findValue:t.value,isPublic:!0,headerHgt:n})},o.prototype.findNext=function(t,e){var i=this,r=function(s,a,l){for(var h,c,u=s;u<=a&&(h=e.sheets[u],u===e.sheetIdx?l?c=i.findNextOnSheet(t,e.startRow,e.startCol,e.findVal,h,void 0,e.activeCell):c=i.findNextOnSheet(t,0,0,e.findVal,h,t.searchBy==="By Row"?e.startRow:e.startCol):c=i.findNextOnSheet(t,0,0,e.findVal,h),!c);u++);return c},n=r(e.sheetIdx,e.sheets.length-1,!0);n||(n=r(0,e.sheetIdx)),n?this.parent.notify(Vc,{address:n}):this.parent.notify(Hb,null)},o.prototype.findNextOnSheet=function(t,e,i,r,n,s,a){var l,h,c;if(t.searchBy==="By Row"){s===void 0&&(s=n.rows.length-1);var u=void 0;for(h=e;h<=s;h++)if(!lt(n,h)){for(c=a&&h===e?i:0,u=n.rows[h]&&n.rows[h].cells&&n.rows[h].cells.length,c;c<u;c++)if(!Ft(n,c)&&(l=this.checkMatch(t,r,h,c,n,a),l))return l}}else{s===void 0&&(s=n.usedRange.colIndex);var d=n.rows&&n.rows.length-1;for(c=i;c<=s;c++)if(!Ft(n,c)){for(h=a&&c===i?e:0,h;h<=d;h++)if(!lt(n,h)&&(l=this.checkMatch(t,r,h,c,n,a),l))return l}}return l},o.prototype.findPrevious=function(t,e){var i=this,r=function(s,a,l){for(var h,c,u=s;u>=a&&(h=e.sheets[u],u===e.sheetIdx?l?c=i.findPrevOnSheet(t,e.startRow,e.startCol,0,0,e.findVal,h,e.activeCell):t.searchBy==="By Row"?c=i.findPrevOnSheet(t,h.usedRange.rowIndex,h.usedRange.colIndex,e.startRow,0,e.findVal,h):c=i.findPrevOnSheet(t,h.usedRange.rowIndex,h.usedRange.colIndex,0,e.startCol,e.findVal,h):c=i.findPrevOnSheet(t,h.usedRange.rowIndex,h.usedRange.colIndex,0,0,e.findVal,h),!c);u--);return c},n;n=r(e.sheetIdx,0,!0),n||(n=r(e.sheets.length-1,e.sheetIdx)),n?this.parent.notify(Vc,{address:n}):this.parent.notify(Hb,null)},o.prototype.findPrevOnSheet=function(t,e,i,r,n,s,a,l){var h,c,u;if(t.searchBy==="By Row"){for(u=e;u>=r;u--)if(!lt(a,u)){for(c=l&&u===e?i:a.rows[u]&&a.rows[u].cells&&a.rows[u].cells.length-1,c;c>=n;c--)if(!Ft(a,c)&&(h=this.checkMatch(t,s,u,c,a,l),h))return h}}else for(c=i;c>=n;c--)if(!Ft(a,c)){for(u=l&&c===i?e:a.rows&&a.rows.length-1,u;u>=r;u--)if(!lt(a,u)&&(h=this.checkMatch(t,s,u,c,a,l),h))return h}return h},o.prototype.checkMatch=function(t,e,i,r,n,s){if(s&&i===s[0]&&r===s[1])return null;var a=Q(i,r,n,!1,!0);if(n.isProtected&&!n.protectSettings.selectCells&&n.protectSettings.selectUnLockedCells&&mn(a,Ht(n,r)))return null;var l=function(u){if(u){if(t.isCSen||(u=u.toLowerCase()),t.isEMatch){if(u===e)return n.name+"!"+st(i,r)}else if(u.includes(e))return n.name+"!"+st(i,r)}return null},h=this.getDisplayText(a,i,r,t.localeObj),c=l(h);return c||(a=Q(i,r,n,!1,!0),a.format&&!Bs(a.format,!0)&&!h.includes("%")&&(c=l(this.getCellVal(a,t.localeObj)))),c},o.prototype.replace=function(t){var e=this,i=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=ke(this.parent,t.sheetIndex);if(r.isProtected){this.parent.notify(PY,null);return}var n=t.address,s=ie(n||r.activeCell),a=Q(s[0],s[1],r,!1,!0),l=this.parent.getDisplayText(a).toString(),h;t.value=t.value.toString(),t.isCSen||(h=t.value.toLowerCase());var c=Ki(this.parent.locale),u=function(f){var v;if(t.isCSen)t.isEMatch?v=l===t.value&&t.replaceValue:v=l.indexOf(t.value)>-1&&l.replace(t.value,t.replaceValue);else if(t.isEMatch)v=l.toLowerCase()===h&&t.replaceValue;else{var m=RegExp;v=l.toLowerCase().includes(h)&&l.replace(new m(t.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),t.replaceValue)}return!f&&!d&&a.format&&!Bs(a.format,!0)&&!l.includes("%")&&(l=e.getCellVal(a,c),l&&(v=u(!0))),v},d=u();if(!(!d&&(t.findOpt="next",this.find(t),s=xe(r.activeCell),a=Q(s[0],s[1],r,!1,!0),l=this.parent.getDisplayText(a).toString(),d=u(),!d))){if(Pl(Q(s[0],s[1],r),Ht(r,s[1]),Yr(r,s[0]))){this.parent.notify(Sd,null);return}var p={address:r.name+"!"+st(s[0],s[1]),cancel:!1,compareValue:t.value,replaceValue:t.replaceValue,sheetIndex:i};if(t.isAction){if(this.parent.notify(hi,{action:"beforeReplace",eventArgs:p}),p.cancel)return;delete p.cancel}gr(this.parent,r,{cell:{value:d},rowIdx:s[0],colIdx:s[1],uiRefresh:!0,checkCF:!0,valChange:!0}),t.isAction&&this.parent.notify("actionComplete",{action:"replace",eventArgs:p})}},o.prototype.replaceAll=function(t){var e=this,i=t.mode==="Sheet"?t.sheetIndex:0,r=this.parent.sheets[i],n=r.usedRange.rowIndex,s=0,a=r.usedRange.colIndex,l=0,h=[],c=t.isAction,u=xe(r.activeCell),d=_D({addressCollection:h,cancel:!1},t),p=0,f=function(x,I,D){requestAnimationFrame?requestAnimationFrame(function(){if(!d.cancel&&d.addressCollection[I]){var M=xe(d.addressCollection[I].substring(d.addressCollection[I].lastIndexOf("!")+1)),E=js(e.parent,d.addressCollection[I]);gr(e.parent,e.parent.sheets[E],{cell:{value:x},rowIdx:M[0],uiRefresh:!0,checkCF:!0,colIdx:M[1],valChange:!0,skipFormatCheck:t.skipFormatCheck}),u[0]===M[0]&&u[1]===M[1]&&e.parent.notify("formulaBarOperation",{action:"refreshFormulabar",cell:Q(M[0],M[1],e.parent.sheets[E],!1,!0)}),I===d.addressCollection.length-1&&c&&e.parent.notify("actionComplete",{action:"replaceAll",eventArgs:d})}}):e.parent.updateCellDetails({value:x},d.addressCollection[I],void 0,void 0,!0),D.formula||p++},v=function(x,I){var D;if(x)if(t.isCSen)t.isEMatch?x===t.value&&(f(t.replaceValue,h.length,I),h.push(r.name+"!"+st(s,l)),D=!0):x.indexOf(t.value)>-1&&(f(x.replace(t.value,t.replaceValue),h.length,I),h.push(r.name+"!"+st(s,l)),D=!0);else if(t.isEMatch)x.toLowerCase()===t.value&&(f(t.replaceValue,h.length,I),h.push(r.name+"!"+st(s,l)),D=!0);else{var M=x.toLowerCase();if(x===t.value||M.indexOf(t.value.toString().toLowerCase())>-1||M===t.value||x===t.value||M.indexOf(t.value)>-1){var E=RegExp;b=new E(t.value.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),f(x.replace(b,t.replaceValue),h.length,I),h.push(r.name+"!"+st(s,l)),D=!0}}return D},m,y,b,S=Ki(this.parent.locale),C;for(s;s<=n+1;s++){if(l>a&&s>n&&t.mode==="Workbook")if(i++,r=this.parent.sheets[i],r)l=0,s=0,a=r.usedRange.colIndex,n=r.usedRange.rowIndex;else break;if(y=r.rows[s],y){for(l===a+1&&(l=0),l;l<=a;l++)if(y&&(C=y.cells&&y.cells[l],C)){if(Pl(C,Ht(r,l),y))continue;m=this.getDisplayText(C,s,l,S).toString(),!v(m,C)&&C.format&&!Bs(C.format,!0)&&!m.includes("%")&&v(this.getCellVal(y.cells[l],S),C)}}}h.length&&c?(this.parent.notify("actionBegin",{action:"beforeReplaceAll",eventArgs:d}),d.cancel||this.parent.notify(Ub,{count:p,replaceValue:d.replaceValue})):this.parent.notify(Ub,{count:p,replaceValue:d.replaceValue})},o.prototype.getDisplayText=function(t,e,i,r){if(!t)return"";if(!t.value&&t.value!==0)return t.hyperlink?typeof t.hyperlink=="string"?t.hyperlink:t.hyperlink.address||"":"";var n=t.value.toString();if(t.format||n.includes(r.dateSeparator)){var s={value:t.value,format:t.format,formattedText:t.value,cell:t,rowIndex:e,colIndex:i};return this.parent.notify(yr,s),s.formattedText}else return n},o.prototype.getCellVal=function(t,e){return De(t.value)?e.decimal!=="."?t.value.toString().split(".").join(e.decimal):t.value.toString():t.value?t.value.toString().toLowerCase():""},o.prototype.totalCount=function(t){var e=this,i=this.parent.sheets[t.sheetIndex],r=xe(i.activeCell),n=0,s=0,a=t.value.toLowerCase(),l=Ki(this.parent.locale),h;i.rows.filter(function(u,d){return u&&u.cells&&!u.isFiltered&&!u.hidden&&u.cells.filter(function(p,f){p&&(p.value||p.value===0||p.hyperlink)&&!Ft(i,f)&&(!i.isProtected||i.protectSettings.selectCells||!mn(p,Ht(i,f)))&&(h=p.format||p.hyperlink?e.parent.getDisplayText(p):p.value.toString().toLowerCase(),(h.includes(a)||p.format&&!Bs(p.format,!0)&&!h.includes("%")&&e.getCellVal(p,l).includes(a))&&(n++,(d===r[0]&&f>=r[1]||d>r[0])&&s++))})}),s-=1;var c=n;n=c-s,n>c&&(n=c),n!==0&&!this.parent.getDisplayText(Q(r[0],r[1],i)).toLowerCase().includes(a)&&(n-=1),t.findCount=n+" of "+c},o.prototype.findAllValues=function(t){var e=t.sheetIndex,i=this.parent.sheets[e],r=i.usedRange.rowIndex,n=0,s=0,a,l=i.usedRange.colIndex,h=0,c=this.parent.sheets.length,u=t.sheetIndex;for(n;n<=r+1;n++){if(u!==1&&t.sheetIndex===c&&(e=1),n>r&&h>l&&t.mode==="Workbook"){if(e++,e>c-1&&(e=0),u===e)return void 0;i=this.parent.sheets[e],i&&(n=0,h=0,l=i.usedRange.colIndex,r=i.usedRange.rowIndex)}if(!g(i)&&i.rows[n]){var d=i.rows[n];for(h===l+2&&(h=0),h;h<=l+1;h++)if(d&&d.cells&&d.cells[h]){var p=i.rows[n].cells[h];if(p&&!g(p.value)&&p.value!==""&&(!i.isProtected||i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!mn(p,Ht(i,h)))){var f=p.format,v=void 0;if(f){var m=this.parent.getDisplayText(i.rows[n].cells[h]);v=m.toString()}else v=p.value.toString();if(t.isCSen&&t.isEMatch)v===t.value&&(a=i.name+"!"+st(n,h),t.findCollection.push(a),s++);else if(t.isCSen&&!t.isEMatch){var y=v.indexOf(t.value)>-1;(v===t.value||y)&&(a=i.name+"!"+st(n,h),t.findCollection.push(a),s++)}else if(!t.isCSen&&t.isEMatch){var b=v.toString().toLowerCase();b===t.value.toLowerCase()&&(a=i.name+"!"+st(n,h),t.findCollection.push(a),s++)}else if(!t.isCSen&&!t.isEMatch){var b=v.toString().toLowerCase(),y=b.indexOf(t.value.toLowerCase())>-1;(b===t.value||v===t.value||y||v===t.value)&&(a=i.name+"!"+st(n,h),t.findCollection.push(a),s++)}}}}}},o.prototype.getModuleName=function(){return"workbookfindAndReplace"},o})(),Yz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.protectsheetHandler=function(t){var e=g(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,i=ke(this.parent,e);this.parent.setSheetPropertyOnMute(i,"isProtected",!0),this.parent.setSheetPropertyOnMute(i,"protectSettings",{selectCells:t.protectSettings.selectCells,formatCells:t.protectSettings.formatCells,formatColumns:t.protectSettings.formatColumns,formatRows:t.protectSettings.formatRows,insertLink:t.protectSettings.insertLink,selectUnLockedCells:t.protectSettings.selectUnLockedCells}),this.parent.notify(nz,{sheetIndex:e,triggerEvent:t.triggerEvent}),this.parent.notify(sz,{props:"Protect"}),i.password=t.password?t.password:"",i.columns.forEach(function(r){r&&Te(r.isLocked)&&(r.isLocked=!0)})},o.prototype.unprotectsheetHandler=function(t){var e=this.parent.getActiveSheet();g(t.sheet)||(e=this.parent.sheets[t.sheet]),e.isImportProtected&&(e.isImportProtected=!1),e.protectSettings.formatCells=e.protectSettings.formatColumns=!1,e.protectSettings.formatRows=e.protectSettings.selectCells=!1,this.parent.setSheetPropertyOnMute(e,"isProtected",!1),this.parent.notify(nz,e.protectSettings),this.parent.notify(sz,{props:"Protect"})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Dd,this.protectsheetHandler,this),this.parent.on(Mz,this.unprotectsheetHandler,this),this.parent.on(Wb,this.lockCells,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Dd,this.protectsheetHandler),this.parent.off(Wb,this.lockCells),this.parent.off(Dd,this.unprotectsheetHandler))},o.prototype.lockCells=function(t){var e=this.parent.getAddressInfo(t.range),i=tt(e.indices),r=ke(this.parent,e.sheetIndex),n=t.isLocked?t.isLocked:!1;if(i[0]===0&&i[2]===r.rowCount-1)for(var s=i[1];s<=i[3];s++)Hl(r,s,{isLocked:t.isLocked});for(var s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++)Zt(s,a,r,{isLocked:n},!0);t.triggerEvent&&this.parent.notify("actionComplete",{action:"lockCells",eventArgs:t})},o.prototype.getModuleName=function(){return"workbookProtectSheet"},o})(),Gz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.merge=function(t){t.sheetIndex=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,t.isAction&&(this.parent.notify("actionBegin",{eventArgs:t,action:"merge"}),t.model||(t.model=[])),typeof t.range=="string"&&(t.range=ie(t.range));var e=t.range=tt(t.range);if(t.skipChecking||this.mergedRange(t),!t.merge||t.type==="All")this.mergeAll(t),t.refreshRibbon&&this.parent.notify(vo,null);else if(t.type==="Horizontally")for(var i=t.range[0],r=t.range[2];i<=r;i++)t.range=[i,e[1],i,e[3]],this.mergeAll(t,i-e[0]);else if(t.type==="Vertically")for(var n=t.range[1],r=t.range[3];n<=r;n++)t.range=[e[0],n,e[2],n],this.mergeAll(t,0,n-e[1]);t.range=e,this.parent.setUsedRange(t.range[2],t.range[3]),t.isAction&&this.parent.notify("actionComplete",{eventArgs:t,action:"merge"}),t.sheetIndex===this.parent.activeSheetIndex&&(this.parent.notify("selectRange",{address:ke(this.parent,t.sheetIndex).selectedRange,skipChecking:!0}),this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(Xo,{range:t.range}))},o.prototype.mergeAll=function(t,e,i){e===void 0&&(e=0),i===void 0&&(i=0);var r=0,n;t.range=t.range;for(var s,a,l,h,c,u=Te(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex),d={cell:new Object,rowIdx:t.range[0],colIdx:t.range[1],valChange:!t.merge,preventEvt:!0,uiRefresh:!t.preventRefresh,skipFormatCheck:!0},p=t.range[0],f=e;p<=t.range[2];p++,f++){s=0,t.isAction&&!t.model[f]&&t.model.push({cells:[]});for(var v=t.range[1],m=i;v<=t.range[3];v++,m++){if(n=Q(p,v,u),n&&(n.value||n.value===0||n.formula)&&!a&&(a=n.formula||n.value,h=n.format),t.isAction&&t.merge&&(c=t.model[f].cells[m]={},pe(c,n,null,!0)),n){delete n.rowSpan,delete n.colSpan,c=!t.merge&&!t.isAction&&t.model&&t.model[f]&&t.model[f].cells[m];var y=this.parent.calculationMode==="Manual"&&this.parent.getActiveSheet().isSheetCalculated&&!g(n.value)&&n.value!=="";c?(y&&(c.value=n.value),Zt(p,v,u,c)):t.model&&t.model[f].cells[m]&&y&&(t.model[f].cells[m].value=n.value)}if(p===t.range[0]&&v===t.range[1]){if(t.merge){t.range[3]-t.range[1]>0&&(d.cell.colSpan=t.range[3]-t.range[1]+1),t.range[2]-t.range[0]>0&&(d.cell.rowSpan=t.range[2]-t.range[0]+1),gr(this.parent,u,d),d.valChange=d.mergedCells=!0;continue}}else d.rowIdx=p,d.colIdx=v,d.cell={},t.merge&&(p!==t.range[0]&&(d.cell.rowSpan=-r),v!==t.range[1]&&(s++,d.cell.colSpan=-s));gr(this.parent,u,d),l||(l=d.isFormulaDependent)}r++}if(t.merge)if(a||a===0){delete d.mergedCells,d.cell={};var b=Q(t.range[0],t.range[1],u);(!b||!b.value&&!b.formula)&&(pt(a)?d.cell.formula=a:d.cell.value=a,h&&(d.cell.format=h)),d.rowIdx=t.range[0],d.colIdx=t.range[1],gr(this.parent,u,d)}else t.preventRefresh||this.parent.notify(LM,{rowIdx:t.range[0],colIdx:t.range[1]});t.preventRefresh||this.refreshCF(u,t.range.slice(),l,t.merge)},o.prototype.refreshCF=function(t,e,i,r){t.conditionalFormats&&t.conditionalFormats.length&&(r?this.parent.notify(Gi,{indexes:[e[0],e[1]],refreshAll:i,isAction:!0}):this.parent.notify(Gi,{indexes:e,refreshAll:i,isAction:!0}))},o.prototype.activeCellRange=function(t){t.range=t.range;var e=this.parent.getActiveSheet(),i=Q(t.range[0],t.range[1],e);i&&(!g(i.rowSpan)&&i.rowSpan<0&&(t.range[0]+=i.rowSpan,t.insertCount&&(t.range[0]-=t.insertCount)),!g(i.colSpan)&&i.colSpan<0&&(t.range[1]+=i.colSpan,t.insertCount&&(t.range[1]-=t.insertCount)),i=Q(t.range[0],t.range[1],e),i&&(i.rowSpan>1&&(t.range[0]+(i.rowSpan-1)>=t.range[2]||t.insertCount)&&(t.range[2]=t.range[0]+(i.rowSpan-1)),i.colSpan>1&&(t.range[1]+(i.colSpan-1)>=t.range[3]||t.insertCount)&&(t.range[3]=t.range[1]+(i.colSpan-1))))},o.prototype.mergedRange=function(t){typeof t.range=="string"&&(t.range=ie(t.range)),t.range[0]<=t.range[2]&&t.range[1]<=t.range[3]?this.forward(t):t.range[0]>=t.range[2]&&t.range[1]>=t.range[3]?this.reverse(t):t.range[0]<t.range[2]&&t.range[1]>t.range[3]?this.forwardReverse(t):t.range[0]>t.range[2]&&t.range[1]<t.range[3]&&this.reverseForward(t)},o.prototype.forward=function(t){t.range=t.range;var e=Te(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex),i=Q(t.range[0],t.range[1],e),r,n,s=r=t.range[0],a=n=t.range[1];if(i&&(!g(i.rowSpan)&&i.rowSpan<0&&(s=r=t.range[0]+i.rowSpan),!g(i.colSpan)&&i.colSpan<0&&(a=n=t.range[1]+i.colSpan),i=Q(s,a,e),i&&(i.rowSpan>1&&(r+=i.rowSpan-1,s+(i.rowSpan-1)>=t.range[2]&&(t.range[2]=t.range[0],t.range[2]=s+(i.rowSpan-1))),i.colSpan>1&&(n+=i.colSpan-1,a+(i.colSpan-1)>=t.range[3]&&(t.range[3]=t.range[1],t.range[3]=a+(i.colSpan-1))))),t.range[0]=s,t.range[1]=a,t.range[0]===s&&t.range[1]===a&&t.range[2]===r&&t.range[3]===n&&(t.isActiveCell=!0),!t.skipChecking){for(var l=t.range[1];l<=t.range[3];l++)i=Q(t.range[2],l,e),i&&(s=t.range[2],a=l,!g(i.colSpan)&&i.colSpan<0&&(a+=i.colSpan,a<t.range[1]&&(t.range[1]=a)),!g(i.rowSpan)&&i.rowSpan<0&&(s+=i.rowSpan,s<t.range[0]&&(t.range[0]=s)),i=Q(s,a,e),i&&(i.colSpan>1&&a+(i.colSpan-1)>t.range[3]&&(t.range[3]=a,t.range[3]=a+(i.colSpan-1)),i.rowSpan>1&&s+(i.rowSpan-1)>t.range[2]&&(t.range[2]=s,t.range[2]=s+(i.rowSpan-1))));for(var h,c,l=t.range[1];l<=t.range[3];l++)i=Q(t.range[0],l,e),i&&(c=l,h=t.range[0],!g(i.colSpan)&&i.colSpan<0&&(c+=i.colSpan,c<t.range[1]&&(t.range[1]=c)),!g(i.rowSpan)&&i.rowSpan<0&&(h+=i.rowSpan,h<t.range[0]&&(t.range[0]=h)));for(var l=t.range[0];l<=t.range[2];l++)i=Q(l,t.range[3],e),i&&(s=l,a=t.range[3],!g(i.rowSpan)&&i.rowSpan<0&&(s+=i.rowSpan,s<t.range[0]&&(t.range[0]=s)),!g(i.colSpan)&&i.colSpan<0&&(a+=i.colSpan,a<t.range[1]&&(t.range[1]=a)),i=Q(s,a,e),i&&(i.rowSpan>1&&s+(i.rowSpan-1)>t.range[2]&&(t.range[2]=s,t.range[2]=s+(i.rowSpan-1)),i.colSpan>1&&a+(i.colSpan-1)>t.range[3]&&(t.range[3]=a,t.range[3]=a+(i.colSpan-1))))}},o.prototype.forwardReverse=function(t){var e=this.parent.getActiveSheet();t.range=t.range;var i=t.range[1],r=Q(t.range[0],t.range[1],e),n=t.range[0];if(r&&(!g(r.colSpan)&&r.colSpan<0&&(i+=r.colSpan,t.range[3]>=i&&(t.range[3]=i)),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<t.range[0]&&(t.range[0]=n)),r=Q(n,i,e),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=t.range[2]&&(t.range[2]=n+(r.rowSpan-1)),r.colSpan>1&&i+(r.colSpan-1)>=t.range[1]&&(t.range[1]=i+(r.colSpan-1)))),t.range[0]=n,!t.skipChecking){for(var s,a,l=t.range[3];l<=t.range[1];l++)r=Q(t.range[2],l,e),r&&(a=l,s=t.range[2],!g(r.rowSpan)&&r.rowSpan<0&&(s+=r.rowSpan,s<t.range[0]&&(t.range[0]=s)),!g(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan,a<t.range[3]&&(t.range[3]=a)),r=Q(s,a,e),r&&(r.rowSpan>1&&s+(r.rowSpan-1)>t.range[2]&&(t.range[2]=s+(r.rowSpan-1)),r.colSpan>1&&a+(r.colSpan-1)>t.range[1]&&(t.range[1]=a+(r.colSpan-1))));for(var h,l=t.range[3];l<=t.range[1];l++)r=Q(t.range[0],l,e),r&&(a=l,h=t.range[0],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<t.range[0]&&(t.range[0]=h)),!g(r.colSpan)&&r.colSpan<0&&(a+=r.colSpan),r=Q(h,a,e),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>t.range[2]&&(t.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&a+(r.colSpan-1)>t.range[1]&&(t.range[1]=a,t.range[1]=a+(r.colSpan-1))));for(var c,l=t.range[0];l<=t.range[2];l++)r=Q(l,t.range[3],e),r&&(h=l,c=t.range[3],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<t.range[0]&&(t.range[0]=h)),!g(r.colSpan)&&r.colSpan<0&&(c+=r.colSpan,c<t.range[3]&&(t.range[3]=c)),r=Q(h,c,e),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>t.range[2]&&(t.range[2]=h,t.range[2]=h+(r.rowSpan-1)),r.colSpan>1&&c+(r.colSpan-1)>t.range[1]&&(t.range[1]=c,t.range[1]=c+(r.colSpan-1))))}},o.prototype.reverse=function(t){t.range=t.range;var e=t.range[1],i=Te(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex),r=Q(t.range[0],t.range[1],i),n=t.range[0];r&&(!g(r.colSpan)&&r.colSpan<0&&(e+=r.colSpan),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),t.range[2]>=n&&(t.range[2]=n,t.isActiveCell=!0),t.range[3]>=e?(t.range[3]=e,t.range[2]===n&&(t.isActiveCell=!0)):t.isActiveCell&&(t.isActiveCell=!1),r=Q(n,e,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>=t.range[0]&&(t.range[0]=n,t.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&e+(r.colSpan-1)>=t.range[1]&&(t.range[1]=e,t.range[1]=e+(r.colSpan-1))));var s=t.range[3];if(!t.skipChecking){for(var a=t.range[3];a<=t.range[1];a++)r=Q(t.range[2],a,i),r&&(s=a,n=t.range[2],!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan,n<t.range[2]&&(t.range[2]=n)),!g(r.colSpan)&&r.colSpan<0&&(s+=r.colSpan,s<t.range[3]&&(t.range[3]=s)),r=Q(n,s,i),r&&(r.rowSpan>1&&n+(r.rowSpan-1)>t.range[0]&&(t.range[0]=n,t.range[0]=n+(r.rowSpan-1)),r.colSpan>1&&s+(r.colSpan-1)>t.range[1]&&(t.range[1]=s,t.range[1]=s+(r.colSpan-1))));s=t.range[3];for(var a=t.range[3];a<=t.range[1];a++)r=Q(t.range[0],a,i),r&&(s=a,n=t.range[0],!g(r.colSpan)&&r.colSpan<0&&(s+=r.colSpan),!g(r.rowSpan)&&r.rowSpan<0&&(n+=r.rowSpan),r=Q(n,s,i),r&&(r.colSpan>1&&s+(r.colSpan-1)>t.range[1]&&(t.range[1]=s,t.range[1]=s+(r.colSpan-1)),r.rowSpan>1&&n+(r.rowSpan-1)>t.range[0]&&(t.range[0]=n,t.range[0]=n+(r.rowSpan-1))));for(var l,h,a=t.range[2];a<=t.range[0];a++)r=Q(a,t.range[3],i),r&&(h=a,l=t.range[3],!g(r.rowSpan)&&r.rowSpan<0&&(h+=r.rowSpan,h<t.range[2]&&(t.range[2]=h)),!g(r.colSpan)&&r.colSpan<0&&(l+=r.colSpan,l<t.range[3]&&(t.range[3]=l)),r=Q(h,l,i),r&&(r.rowSpan>1&&h+(r.rowSpan-1)>t.range[0]&&(t.range[0]=h,t.range[0]=h+(r.rowSpan-1)),r.colSpan>1&&l+(r.colSpan-1)>t.range[1]&&(t.range[1]=l,t.range[1]=l+(r.colSpan-1))))}},o.prototype.reverseForward=function(t){t.range=t.range;var e=Te(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex),i=t.range[0],r=t.range[1],n=Q(t.range[0],t.range[1],e);if(n&&(!g(n.rowSpan)&&n.rowSpan<0&&(i+=n.rowSpan,t.range[2]>=i&&(t.range[2]=i)),!g(n.colSpan)&&n.colSpan<0&&(r+=n.colSpan),n=Q(i,r,e),n&&(n.rowSpan>1&&i+(n.rowSpan-1)>=t.range[0]&&(t.range[0]=i,t.range[0]=i+(n.rowSpan-1)),n.colSpan>1&&r+(n.colSpan-1)>=t.range[3]&&(t.range[3]=t.range[1],t.range[3]=r+(n.colSpan-1)))),!t.skipChecking){for(var s=t.range[3],a,l=t.range[1];l<=t.range[3];l++)n=Q(t.range[2],l,e),n&&(a=t.range[2],s=l,!g(n.rowSpan)&&n.rowSpan<0&&(a+=n.rowSpan,a<t.range[2]&&(t.range[2]=a)),!g(n.colSpan)&&n.colSpan<0&&(s+=n.colSpan,s<t.range[1]&&(t.range[1]=s)),n=Q(a,s,e),n&&(n.colSpan>1&&s+(n.colSpan-1)>t.range[3]&&(t.range[3]=s+(n.colSpan-1)),n.rowSpan>1&&n.rowSpan-1+a>t.range[0]&&(t.range[0]=n.rowSpan-1+a)));for(var h,c,l=t.range[1];l<=t.range[3];l++)n=Q(t.range[0],l,e),n&&(c=l,h=t.range[0],!g(n.colSpan)&&n.colSpan<0&&(c+=n.colSpan,c<t.range[1]&&(t.range[1]=c)),!g(n.rowSpan)&&n.rowSpan<0&&(h+=n.rowSpan),n=Q(h,c,e),n&&n.rowSpan>1&&h+(n.rowSpan-1)>t.range[0]&&(t.range[0]=h+(n.rowSpan-1)));for(var u,l=t.range[2];l<=t.range[0];l++)n=Q(l,t.range[3],e),n&&(a=l,u=t.range[3],!g(n.rowSpan)&&n.rowSpan<0&&(a+=n.rowSpan,a<t.range[2]&&(t.range[2]=a)),!g(n.colSpan)&&n.colSpan<0&&(u+=n.colSpan,u<t.range[1]&&(t.range[1]=u)),n=Q(a,u,e),n&&(n.rowSpan>1&&n.rowSpan-1+a>t.range[0]&&(t.range[0]=n.rowSpan-1+a),n.colSpan>1&&n.colSpan-1+u>t.range[3]&&(t.range[3]=u,t.range[3]=n.colSpan-1+u)))}},o.prototype.insertHandler=function(t){this.activeCellRange(t),t.range=t.range,t.insertModel==="Row"?t.range[2]+=t.insertCount:t.range[3]+=t.insertCount,t.preventRefresh=!0,t.merge=!0,this.mergeAll(t)},o.prototype.updateMergedCellsFromSheet=function(){this.parent.sheets.forEach(function(t){t.mergedCells&&(t.mergedCells.forEach(function(e){for(var i=e.address[0],r=e.address[1],n=e.rowSpan,s=e.colSpan,a=i+n-1,l=r+s-1,h=i;h<=a;h++)for(var c=r;c<=l;c++){var u=Q(h,c,t,!0,!0);if(h===i&&c===r)n>1&&(u.rowSpan=n),s>1&&(u.colSpan=s);else{var d=h-i,p=c-r;n>1&&d>0&&(u.rowSpan=-d),s>1&&p>0&&(u.colSpan=-p)}Zt(h,c,t,u,!0)}}),delete t.mergedCells)})},o.prototype.addEventListener=function(){this.parent.on(Nn,this.merge,this),this.parent.on(uo,this.mergedRange,this),this.parent.on(pr,this.activeCellRange,this),this.parent.on(qb,this.insertHandler,this),this.parent.on(aa,this.updateMergedCellsFromSheet,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Nn,this.merge),this.parent.off(uo,this.mergedRange),this.parent.off(pr,this.activeCellRange),this.parent.off(qb,this.insertHandler),this.parent.off(aa,this.updateMergedCellsFromSheet))},o.prototype.getModuleName=function(){return"workbookmerge"},o})(),Qz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(jd,this.setCFRule,this),this.parent.on(po,this.clearCFRule,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(jd,this.setCFRule),this.parent.off(po,this.clearCFRule))},o.prototype.setCFRule=function(t){var e=t.cfModel,i=t.sheetIdx===void 0?js(this.parent,e.range):t.sheetIdx,r=ke(this.parent,i),n=tt(ie(e.range||r.selectedRange));if(e.range=Ve(n),t.isAction){var s={range:e.range,type:e.type,cancel:!1,cFColor:e.cFColor,value:e.value,sheetIdx:i};if(this.parent.notify(hi,{eventArgs:s,action:"conditionalFormat"}),s.cancel)return;e.type=s.type,e.cFColor=s.cFColor,e.value=s.value,s.range!==e.range&&(e.range=s.range,n=tt(ie(s.range))),delete s.cancel}r.conditionalFormats||this.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]),r.conditionalFormats.push(e),i!==this.parent.activeSheetIndex?t.isUndoRedo&&!t.isFromUpdateAction&&this.parent.notify(Vc,{address:r.name+"!"+e.range}):this.parent.notify(Gi,{cfModel:[e],isAction:!0}),this.parent.setUsedRange(n[2],n[3]),t.isAction&&this.parent.notify("actionComplete",{eventArgs:{range:e.range,type:e.type,cFColor:e.cFColor,value:e.value,sheetIdx:i},action:"conditionalFormat"})},o.prototype.clearCFRule=function(t){t.sheetIdx===void 0&&(t.sheetIdx=this.parent.activeSheetIndex);var e=ke(this.parent,t.sheetIdx),i=e.conditionalFormats,r=i&&i[i.length-1]&&i[i.length-1].action!=="autofillWithCF";if(t.isUndo){t.updatedCFModel&&t.updatedCFModel.forEach(function(x){for(var I=0;I<i.length;I++)if(i[I].type===x.type&&i[I].cFColor===x.cFColor&&i[I].range===x.range&&i[I].value===x.value){i.splice(I,1);break}}),i.push.apply(i,t.oldCFModel.map(function(x){return{range:x.range,type:x.type,cFColor:x.cFColor,value:x.value,format:x.format,result:x.result,action:x.action}})),this.parent.notify(Gi,{cfModel:t.oldCFModel,isAction:!0}),t.sheetIdx!==this.parent.activeSheetIndex&&this.parent.notify(Vc,{address:e.name+"!"+t.range});return}if(!(!i||!i.length)){var n,s,a,l,h,c,u,d,p,f=t.range&&(typeof t.range=="string"?ie(t.range):t.range);f=f&&tt(f),t.oldCFModel=[],t.updatedCFModel=[];for(var v=[],m=[],y=[],b=0;b<i.length;b++){n=i[b],s=n.range.split(",");for(var S=0;S<s.length;S++){if(a=ie(s[S]),t.range)if(f[0]<=a[0]&&f[1]<=a[1]&&f[2]>=a[2]&&f[3]>=a[3])s.splice(S,1),S--;else if(u=f[0]>=a[0]&&f[0]<=a[2],d=f[2]>=a[0]&&f[2]<=a[2],h=f[1]>=a[1]&&f[1]<=a[3],c=f[3]>=a[1]&&f[3]<=a[3],l=[],u&&d?((h||c||f[1]<a[1]&&f[3]>a[3])&&(f[0]-a[0]>0&&l.push(Ve([a[0],a[1],f[0]-1,a[3]])),a[2]-f[2]>0&&l.push(Ve([f[2]+1,a[1],a[2],a[3]]))),h&&f[1]!==a[1]&&l.push(Ve([f[0],a[1],f[2],f[1]-1])),c&&f[3]!==a[3]&&l.push(Ve([f[0],f[3]+1,f[2],a[3]]))):h&&c?((u||d||f[0]<a[0]&&f[2]>a[2])&&(f[1]-a[1]>0&&l.push(Ve([a[0],a[1],a[2],f[1]-1])),a[3]-f[3]>0&&l.push(Ve([a[0],f[3]+1,a[2],a[3]]))),u?f[0]!==a[0]&&l.push(Ve([a[0],f[1],f[0]-1,f[3]])):d&&f[2]!==a[2]&&l.push(Ve([f[2]+1,f[1],a[2],f[3]]))):(u||d)&&(h?(f[1]!==a[1]&&l.push(Ve([a[0],a[1],a[2],f[1]-1])),f[0]-a[0]>0?l.push(Ve([a[0],f[1],f[0]-1,a[3]])):a[2]-f[2]>0&&l.push(Ve([f[2]+1,f[1],a[2],a[3]]))):c&&(f[3]!==a[3]&&l.push(Ve([a[0],f[3]+1,a[2],a[3]])),f[0]-a[0]>0?l.push(Ve([a[0],a[1],f[0]-1,f[3]])):a[2]-f[2]>0&&l.push(Ve([f[2]+1,a[1],a[2],f[3]])))),l.length)s[S]=l.join(",");else continue;else f=a,s.splice(S,1),S--;t.sheetIdx===this.parent.activeSheetIndex&&this.parent.notify(NM,{indexes:f.slice()})}if(p=s.join(","),p!==n.range){if(t.cfModel&&(t.cfModel.cFColor!==n.cFColor||t.cfModel.type!==n.type||t.cfModel.value!==n.value)){y.push(n);continue}m.push(n.range),p?(t.oldCFModel.push({type:n.type,cFColor:n.cFColor,format:n.format,range:n.range,value:n.value}),n.range=p,n.result&&(delete n.result,this.parent.notify(Gi,{cfModel:[n],isAction:!0})),t.updatedCFModel.push(n),v.push(n)):(t.oldCFModel.push(n),v.concat(i.splice(b,1)),b--)}}if(t.sheetIdx!==this.parent.activeSheetIndex?t.isUndoRedo&&!t.isFromUpdateAction&&this.parent.notify(Vc,{address:e.name+"!"+t.range}):y.length&&this.parent.notify(Gi,{cfModel:y,isAction:!0}),(t.isAction||t.isClear)&&t.oldCFModel.length){var C={cFormats:v,oldRange:m,previousConditionalFormats:t.oldCFModel,sheetIdx:t.sheetIdx,selectedRange:t.range};t.updatedCFModel.length&&(C.conditionalFormats=t.updatedCFModel),t.isClear?t.cfClearActionArgs=C:r&&this.parent.notify("actionComplete",{eventArgs:C,action:"clearCF"})}}},o.prototype.getModuleName=function(){return"workbookConditionalFormatting"},o})(),Xz=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.getFillInfo=function(t){for(var e=this.parent.serviceLocator.getService(r0),i="",r=!0,n="CopyCells",s=[],a=["Down","Up"].indexOf(t.direction)>-1,l=this.getRangeData({range:t.dataRange,sheetIdx:this.parent.activeSheetIndex}),h=l.join().replace(/,/g,"").length,c=this.isRange(t.dataRange)&&h?l.length:1;c--;)if(i=l[c]&&!g(l[c].value)?l[c].value:"",De(i)||pt(i)||De(i[i.length-1])){r=!1,n=this.parent.autoFillSettings.fillType;break}return(!h||r)&&(s.push(e.getConstant("FillSeries")),n=t.fillType==="FillSeries"?n:t.fillType),(!a||a&&t.dataRange[1]!==t.dataRange[3])&&s.push("Flash Fill"),{fillType:n,disableItems:s}},o.prototype.isRange=function(t){return t&&(t[0]!==t[2]||t[1]!==t[3])},o.prototype.autoFill=function(t){if(!(!t.dataRange||!t.fillRange||!t.direction||!this.parent.allowEditing||this.parent.getActiveSheet().isProtected&&t.isLockedCell)){var e=tt(ie(t.dataRange)),i=tt(ie(t.fillRange)),r={dataRange:e,fillRange:i,direction:t.direction,fillType:t.fillType||this.fillInfo.fillType,dataSheetIndex:js(this.parent,t.dataRange),fillSheetIndex:js(this.parent,t.fillRange),cells:t.cells};switch(this.fillInfo=this.getFillInfo({dataRange:e,fillRange:i,fillType:t.fillType,direction:t.direction}),this.fillInfo.fillType=t.isFillOptClick?t.fillType:this.fillInfo.fillType,t.fillType){case"FillSeries":case"FillWithoutFormatting":this.fillSeries(r);break;case"CopyCells":case"FillFormattingOnly":this.copyCells(r);break}}},o.prototype.fillSeries=function(t){var e,i,r,n,s,a,l,h,c,u,d,p,f,v,m,y,b,S,C,x,I,D={},M=0,E,A,L,N=Te(t.dataSheetIndex)?this.parent.activeSheetIndex:t.dataSheetIndex,R=ke(this.parent,N),P,k;Te(t.fillSheetIndex)?(P=this.parent.activeSheetIndex,k=!0):(P=t.fillSheetIndex,k=P===this.parent.activeSheetIndex);for(var B=ke(this.parent,P),F=t.dataRange[0],O=t.dataRange[1],z=t.dataRange[2],Y=t.dataRange[3],K=t.fillRange[0],U=t.fillRange[1],q=t.fillRange[2],ae=t.fillRange[3],te=["Down","Up"].indexOf(t.direction)>-1,he=["Up","Left"].indexOf(t.direction)>-1,ue=te?Y-O:z-F,ne=t.fillType==="FillSeries",le,$,ee,He=R.conditionalFormats&&R.conditionalFormats.length&&[].slice.call(R.conditionalFormats),qe=[],we=k&&this.applyWrapToOuterCells(B),je=t.fillType!=="FillWithoutFormatting"&&k&&te;M<=ue;){s=this.updateFillValues(te,F,O,z,Y,K,U,q,ae,M),a=s.patternRange,l=s.fillRange,r=this.getPattern(a,{isReverseFill:he,isVFill:te},N),h=this.getRangeData({range:a,sheetIdx:N}),te||(h=this.getRangeData({range:a,sheetIdx:N},!0));var Ne=!1;h[0]&&h[0].formula&&h[0].formula.match(/=[A-Za-z]+\(([^:]+):([^:]+)\)/)&&(Ne=!0),p=h.length;for(var Ye=0;Ye<p;Ye++)if(h[Ye]&&h[Ye].isReadOnly){this.parent.notify(Sd,null);return}if(!r||!r.length)return;for(i=r.length,C=this.getSelectedRange(B,{rowIndex:l[0],colIndex:l[1]},{rowIndex:l[2],colIndex:l[3]}),x=C.length,he&&(C=C.reverse(),r=r.reverse(),r=this.ensurePattern(r),h=h.reverse()),f=0;f<x;){switch(I=C[f],n=r[f%i],De(n)&&(n=r[n]),m=f%p,n.type){case"number":case"date":if(n=n,n.isStartWithMonth&&p===1?(A=Yn(n.regVal.a),L=new Date(A),A.setMonth(A.getMonth()+n.regVal.b*n.i),L.getDate()>28&&L.getDate()!==A.getDate()&&(L.setDate(1),L.setMonth(L.getMonth()+n.regVal.b*n.i),L.setDate(new Date(L.getFullYear(),L.getMonth()+1,0).getDate()),A=L),e=ls(A).toString()):(e=this.round(n.regVal.a+n.regVal.b*n.i,5).toString(),n.val&&(u=typeof n.val[0]=="string"&&n.val[0].match(/^0+/),u&&(c=this.getNextFormattedValue(n.val[0],Number(e))))),n.dataVal){if(n.copy===void 0&&!u&&(n.copy=n.val.length>2,n.copy))for(var dt=2;dt<n.val.length&&(n.copy=Math.abs(this.round(n.regVal.a+n.regVal.b*dt,5))!==n.val[dt],!n.copy);dt++);e=n.copy?h[m]&&!g(h[m].value)?h[m].value:"":n.start?Math.abs(Number(e))+n.dataVal:u?n.dataVal+c:n.dataVal+Math.abs(Number(e))}he?n.i--:n.i++;break;case"string":var Ke=n.i%n.val.length;e=n.val[Ke],n.i++;break;case"formula":for(S=!1,e="=",v=0,y=n.val.length;v<y;)d=n.val[v],typeof d=="object"?(S=!0,b=this.round(d.a+d.b*n.i,5),b<1?(e+="#REF!",Ne&&(v=y-1,e+=n.val[v])):e+=te?d.c+(d.b?b:"$"+b):(d.b?ji(b):d.c.substring(0,d.c.search(/\d/))+"$"+ji(b))+d.c.trim()):e+=d,v++;S&&he?n.i--:n.i++;break;case"time":e=(n.regVal.a+n.regVal.b*n.i).toString(),Number(e)<0&&he&&(e=(n.regVal.a+Math.ceil(Math.abs(n.i/24))+n.regVal.b*n.i).toString()),he?n.i--:n.i++;break}if(E=Q(I.rowIndex,I.colIndex,B,!1,!0),E&&E.isReadOnly){this.parent.notify(Sd,null);return}if(ne?Object.assign(D,h[m],null,!0):(t.fillType==="FillWithoutFormatting"&&h[m]&&h[m].hyperlink?(D.hyperlink=h[m].hyperlink,D.style={textDecoration:"none",color:"inherit"}):D.style=E.style,D.format=E.format,D.wrap=E.wrap,D.rowSpan=E.rowSpan,D.colSpan=E.colSpan),h[m]&&h[m].validation){D.validation=Object.assign({},h[m].validation);var ci=[I.rowIndex,I.colIndex,I.rowIndex,I.colIndex],Jt=[t.dataRange[0],t.dataRange[1],t.dataRange[2],t.dataRange[3]],vt=this.parent.sheets[this.parent.activeSheetIndex],bi=ln(ci,Jt,vt,this.parent,{formula:D.validation.value1});D.validation.value1=bi,D.validation.value2!==""&&(bi=ln(ci,Jt,vt,this.parent,{formula:D.validation.value2}),D.validation.value2=bi)}var Bi=pt(e);Bi&&(D.formula=e),(e!=="0"||e==="0"&&t.fillType!=="FillWithoutFormatting")&&(D.value=Bi&&this.parent.calculationMode==="Manual"?h[m]?h[m].value:"0":e),g(D.notes)||delete D.notes,le={cell:D,rowIdx:I.rowIndex,colIdx:I.colIndex,valChange:!0,uiRefresh:k,pvtExtend:!0,skipFormatCheck:!0,fillType:t.fillType},k&&!lt(B,I.rowIndex)&&!Ft(B,I.colIndex)&&(le.td=this.parent.getCell(I.rowIndex,I.colIndex),le.td&&(le.uiRefresh=!0)),ee=gr(this.parent,B,le,t.cells),ee||(k&&we(le),He&&!$&&($=le.isFormulaDependent,$||Eg(He,qe,I.rowIndex,I.colIndex,t.dataRange,t.fillRange,R)),je&&D.style&&Qd(D.style)&&this.parent.notify(Mr,{rowIdx:I.rowIndex,colIdx:I.colIndex,style:D.style,lastCell:!0,isHeightCheckNeeded:!0,onActionUpdate:!0,manualUpdate:!0})),D={},f++}M++}(qe.length||$)&&this.parent.notify(Gi,{cfModel:!$&&qe,refreshAll:$,isAction:!0,isEdit:!0})},o.prototype.copyCells=function(t){var e=0,i,r,n,s,a,l,h,c,u,d={},p,f=t.dataRange[0],v=t.dataRange[1],m=t.dataRange[2],y=t.dataRange[3],b=t.fillRange[0],S=t.fillRange[1],C=t.fillRange[2],x=t.fillRange[3],I=["Down","Up"].indexOf(t.direction)>-1,D=["Up","Left"].indexOf(t.direction)>-1,M=I?y-v:m-f,E=Te(t.dataSheetIndex)?this.parent.activeSheetIndex:t.dataSheetIndex,A=ke(this.parent,E),L,N;Te(t.fillSheetIndex)?(N=!0,L=this.parent.activeSheetIndex):(N=t.fillSheetIndex===this.parent.activeSheetIndex,L=t.fillSheetIndex);for(var R=ke(this.parent,L),P=t.fillType==="FillFormattingOnly",k,B,F,O=A.conditionalFormats&&A.conditionalFormats.length&&[].slice.call(A.conditionalFormats),z,Y=N&&this.applyWrapToOuterCells(R),K=[],U=N&&I;e<=M;){a=this.updateFillValues(I,f,v,m,y,b,S,C,x,e),n=a.patternRange,s=a.fillRange,l=this.getRangeData({range:n,sheetIdx:E}),h=l.length;for(var q=0;q<h;q++)if(l[q]&&l[q].isReadOnly){this.parent.notify(Sd,null);return}for(c=this.getSelectedRange(R,{rowIndex:s[0],colIndex:s[1]},{rowIndex:s[2],colIndex:s[3]}),u=c.length,i=0,D&&(c=c.reverse());i<u;){if(r=i%h,p=c[i],P&&(k=Q(p.rowIndex,p.colIndex,R)),Object.assign(d,l[r],null,!0),P&&(d.value=k.value,d.formula=k.formula,g(d.notes)||delete d.notes,d.validation&&delete d.validation),d&&d.isReadOnly){this.parent.notify(Sd,null);return}!g(d.notes)&&!g(d.isNoteEditable)&&(delete d.notes,delete d.isNoteEditable),F={cell:d,rowIdx:p.rowIndex,colIdx:p.colIndex,valChange:!0,pvtExtend:!0,fillType:t.fillType},N&&!lt(R,p.rowIndex)&&!Ft(R,p.colIndex)&&(F.td=this.parent.getCell(p.rowIndex,p.colIndex),F.uiRefresh=!!F.td),z=gr(this.parent,R,F,t.cells),z||(N&&Y(F),O&&!B&&(B=F.isFormulaDependent,B||Eg(O,K,p.rowIndex,p.colIndex,t.dataRange,t.fillRange,A)),U&&d.style&&Qd(d.style)&&this.parent.notify(Mr,{rowIdx:p.rowIndex,colIdx:p.colIndex,style:d.style,lastCell:!0,isHeightCheckNeeded:!0,onActionUpdate:!0,manualUpdate:!0})),d={},i++}e++}(K.length||B)&&this.parent.notify(Gi,{cfModel:!B&&K,refreshAll:B,isAction:!0,isEdit:!0})},o.prototype.applyWrapToOuterCells=function(t){var e=this,i,r,n=this.parent.frozenRowCount(t),s=this.parent.frozenColCount(t),a=this.parent.viewport;a&&(i=a.topIndex+n,r=a.leftIndex+s);var l;return function(h){!h.td&&Q(h.rowIdx,h.colIdx,t,!1,!0).wrap&&(h.rowIdx>=n&&h.rowIdx<i||h.colIdx>=s&&h.colIdx<r)&&(l||(l={range:null,wrap:!0,sheet:t,initial:!0,outsideViewport:!0}),l.range=[h.rowIdx,h.colIdx,h.rowIdx,h.colIdx],e.parent.notify(sa,l))}},o.prototype.updateFillValues=function(t,e,i,r,n,s,a,l,h,c){var u,d,p,f;t?(u={rowIndex:e,colIndex:i+c},d={rowIndex:r,colIndex:i+c},p={rowIndex:s,colIndex:a+c},f={rowIndex:l,colIndex:a+c}):(u={rowIndex:e+c,colIndex:i},d={rowIndex:e+c,colIndex:n},p={rowIndex:s+c,colIndex:a},f={rowIndex:s+c,colIndex:h});var v=[u.rowIndex,u.colIndex,d.rowIndex,d.colIndex],m=[p.rowIndex,p.colIndex,f.rowIndex,f.colIndex];return{patternRange:v,fillRange:m}},o.prototype.getDataPattern=function(t,e){var i,r,n,s=0,a={val:null,type:null},l=[],h=this.getRangeData({range:t,sheetIdx:Te(e)?this.parent.activeSheetIndex:e}),c=h.length,u,d;if(c){for(var p=void 0,f=void 0,v=void 0,m=void 0,y=function(C){return!u&&C&&C[C.length-1]==="-"?C.slice(0,C.length-1):C};s<c;){if(d=!1,h[s])if(h[s].formula&&pt(h[s].formula))i=h[s].formula,n="formula";else{i=g(h[s].value)?"":h[s].value;var b={};if(v=h[s].format,m=De(i),v&&Bs(v,!0,b)&&i!==""){if(n=b.type,i&&!m){var S={value:i,updatedVal:i,cell:h[s]};this.parent.notify(Jr,S),S.isDate||S.isTime?h[s].value=i=S.updatedVal:n="string"}d=n==="date"&&v.toLowerCase().startsWith("mmm")}else n=m?"number":"string"}else i="",n="string";if(f="",n==="string"){if(u=!1,De(i[0])){p=0;do p++;while(De(i[p]));i[p]===" "&&(u=!0,n="number",f=i.slice(p,i.length),i=Number(i.slice(0,p)))}if(i=i,!u&&De(i[i.length-1])){p=1;do p++;while(De(i[i.length-p]));n="number",p-=1,f=i.slice(0,i.length-p),r=i.slice(i.length-p,i.length),i=r.match(/^0+/)?r:Number(r),a.dataVal&&a.dataVal!==f&&a.dataVal===y(f)&&(f=a.dataVal)}}s===0?(a={val:[i],type:n,isStartWithMonth:d},f&&(a.dataVal=f,a.start=u)):n===a.type&&(!a.dataVal||y(a.dataVal)===y(f))?a.val.push(i):(l.push(a),a={val:[i],type:n},f&&(a.dataVal=f,a.start=u)),s++}return l.push(a),l}else return[{val:null,type:null}]},o.prototype.getPredictionValue=function(t,e){for(var i=0,r=0,n=0,s=0,a=0,l=0,h=0,c=t.length;i<c;)r=r+i,n=n+Number(t[i]),s=s+i*Number(t[i]),a=a+i*i,i++;return e?(l=(n*a-r*s)/(c*a-r*r),h=(c*s-r*n)/(c*a-r*r)):(l=this.round((n*a-r*s)/(c*a-r*r),5),h=this.round((c*s-r*n)/(c*a-r*r),5)),{a:l,b:h}},o.prototype.getPattern=function(t,e,i){var r,n,s,a,l,h,c=0,u=[],d=this.getDataPattern(t,i),p=d.length,f;if(d){for(;c<p;){switch(f=d[c],f.type){case"number":case"date":if(n=u.length,h=f.val.length,l=e.isReverseFill?-1:h,h===1){var v=parseFloat(f.val[0])+1;typeof f.val[0]=="string"&&f.val[0].match(/^0+/)?f.val.push(this.getNextFormattedValue(f.val[0],v)):f.val.push(v)}for(a=this.getPredictionValue(f.dataVal?f.val.slice(0,2):f.val),s={regVal:a,type:f.type,i:l,isStartWithMonth:f.isStartWithMonth},f.dataVal&&(s.dataVal=f.dataVal,s.val=f.val,s.start=f.start),u.push(s),r=1;r<h;)u.push(n),r++;break;case"string":for(n=u.length,s={val:f.val,type:f.type,i:0},u.push(s),r=1,h=f.val.length;r<h;)u.push(n),r++;break;case"formula":if(h=f.val.length,f=this.getFormulaPattern(f.val,e),l=e.isReverseFill?-1:h,f.isInPattern)for(n=u.length,s={val:f.val,type:"formula",i:l},u.push(s),r=1;r<h;)u.push(n),r++;else for(r=0,l=e.isReverseFill?-1:1;r<h;)u.push({val:f.val[r],type:"formula",i:l}),r++;break;case"time":if(n=u.length,h=f.val.length,l=e.isReverseFill?-1:h,h===1){var m=Yn(f.val[0]),y=Number(f.val[0]),b=y>=0&&y<1,S=ls(new Date(m.getTime()+60*6e4),!0,b);f.val.push(S)}for(a=this.getPredictionValue(f.val,!0),s={regVal:a,type:f.type,i:l},u.push(s),r=1;r<h;)u.push(n),r++;break}c++}return u}else return[{regVal:null}]},o.prototype.getNextFormattedValue=function(t,e){var i=new Nt().formatNumber(Math.abs(e),{minimumIntegerDigits:t.length,useGrouping:!1}),r=Da({value:i},this.parent.locale);return r.isNumber?r.value:i},o.prototype.isCellReference=function(t){return/^[a-z]{1,3}\d{1,7}$/gi.test(t)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(t)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(t)?"mixed":!1},o.prototype.round=function(t,e){return+(Math.round(parseFloat(t+"e"+e))+"e-"+e)||Number(t)},o.prototype.getRangeData=function(t,e){for(var i=[],r=Te(t.sheetIdx)?this.parent.getActiveSheet():ke(this.parent,t.sheetIdx),n=t.range[0],s=t.range[1],a=t.range[2],l=t.range[3],h=s,c,u;n<=a;){if(lt(r,n)){n++;continue}for(s=h;s<=l;){if(Ft(r,s)){s++;continue}if(c=Q(n,s,r),e&&(c=Object.assign({},Q(n,s,r)),u=Object.assign({},Ht(r,s)),c&&!c.validation&&u&&u.validation)){c.validation=Object.assign({},Ht(r,s).validation);var d=[n,s,n,s],p=[0,s,0,s],f=ln(d,p,r,this.parent,{formula:u.validation.value1});c.validation.value1=f,c.validation.value2!==""&&(f=ln(d,p,r,this.parent,{formula:u.validation.value2}),c.validation.value2=f)}i.push(c),s++}n++}return i},o.prototype.getFormulaPattern=function(t,e){for(var i,r,n,s=[],a=0,l=t.length,h,c={};a<l;)c.formula=t[a],this.parent.notify(t0,c),s.push(c.formulaArr),a++;var u=this.isInPattern(s,e.isVFill);if(u){for(n=s[0],a=n.length;a--;)r=n[a],h=this.isCellReference(r),h&&h!=="absolute"&&(n[a]=this.getCellRefPrediction(r,e,null,h));return{isInPattern:u,val:n}}else{for(a=0;a<l;){for(n=s[a],i=n.length;i--;)r=n[i],h=this.isCellReference(r.trim()),h&&h!=="absolute"&&(s[a][i]=this.getCellRefPrediction(r,e,l,h));a++}return{isInPattern:u,val:s}}},o.prototype.generateColCount=function(t){for(var e=0,i=0;i<t.length;i++){var r=t.charCodeAt(i)-64;e=e*26+r}return e},o.prototype.getCellRefPrediction=function(t,e,i,r){t=t.toUpperCase();var n="",s=new RegExp("[a-z$]","gi"),a=new RegExp("[0-9$]","g"),l=e.isVFill?t.replace(a,n):t.replace(s,n),h=e.isVFill?Number(t.replace(s,n)):this.generateColCount(t.replace(a,n).trim()),c=null,u=[h],d=t[0]==="$";if(!d&&t.includes("$")&&t.trim()[0]==="$"){for(var p=1;p<t.length;p++)if(t[p]==="$"){c=p,d=!0;break}}return i&&i!==1?u.push(h+i):u.push(h+1),h=this.getPredictionValue(u),r&&r==="mixed"&&(d===e.isVFill?c?l=l.substring(0,c)+"$"+l.substring(c):l="$"+l:h.b=0),h.c=l,h},o.prototype.isInPattern=function(t,e){var i,r,n,s,a,l,h,c,u="",d=0,p=1,f=t.length,v=new RegExp("[0-9$]","g"),m=new RegExp("[a-z$]","gi");if(f===1)return!1;for(;p<f;){if(i=t[d],n=t[p],r=i.length,s=n.length,r!==s)return!1;for(;r--;)if(a=i[r],l=n[r],this.isCellReference(a)===this.isCellReference(l)){if(e?(h=Number(a.replace(m,u)),c=Number(l.replace(m,u))):(h=this.generateColCount(a.replace(v,u)),c=this.generateColCount(l.replace(v,u))),h!==c-1)return!1}else if(a!==l)return!1;d++,p++}return!0},o.prototype.ensurePattern=function(t){for(var e,i=-1,r=t.length;r--;)e=t[r],typeof e=="object"?(i=r,e.type==="string"&&(e.val=e.val.reverse())):t[r]=i;return t},o.prototype.getSelectedRange=function(t,e,i){var r,n,s,a=[],l=tt([e.rowIndex,e.colIndex,i.rowIndex,i.colIndex]);r=l[0];for(var h=l[2];r<=h;){if(as(t,r)){r++;continue}for(n=l[1],s=l[3];n<=s;)a.push({rowIndex:r,colIndex:n}),n++;r++}return a},o.prototype.getFillType=function(t){return t.fillType=this.fillInfo.fillType,t.disableItems=this.fillInfo.disableItems,t},o.prototype.addEventListener=function(){this.parent.on(Vd,this.autoFill,this),this.parent.on(FM,this.getFillType,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Vd,this.autoFill),this.parent.off(FM,this.getFillType))},o.prototype.getModuleName=function(){return"workbookautofill"},o})(),Kz=(function(){function o(){this.services={}}return o.prototype.getService=function(t){if(g(this.services[""+t]))throw"The service "+t+" is not registered";return this.services[""+t]},o.prototype.register=function(t,e){g(this.services[""+t])&&(this.services[""+t]=e)},o})(),m9=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),UD=function(){return UD=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},UD.apply(this,arguments)},Ot=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},y9=(function(o){m9(t,o);function t(i){var r=o.call(this,i)||this;return r.isEdit=!1,r.sheetNameCount=1,r.dataValidationRange="",r.isOpen=!1,r.chartColl=[],r.isPrintingProcessing=!1,r.currentPrintSheetIndex=0,r.customFormulaCollection=new Map,e.Inject(q0,kz,Nz,Oz,Hz,Vz,Rz,zz,_z,Pz,Uz,qz,Wz,Yz,Gz,Qz,Bz,jz,Xz),r.commonCellStyle={},i&&i.cellStyle&&(r.commonCellStyle=i.cellStyle),r.getModuleName()==="workbook"&&(r.serviceLocator=new Kz,r.initWorkbookServices(),r.dataBind(),r.initEmptySheet()),r}e=t,t.prototype.preRender=function(){Object.keys(this.commonCellStyle).length||(this.commonCellStyle=eE(this.cellStyle,!0)),this.getModuleName()==="spreadsheet"&&!this.refreshing&&this.initEmptySheet()},t.prototype.initWorkbookServices=function(){this.serviceLocator.register(r0,new Ri(this.getModuleName(),YY,this.locale))},t.prototype.render=function(){},t.prototype.requiredModules=function(){return wz(this)},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.cellFormat=function(i,r){var n=this.getActiveSheet();n&&(!n.isProtected||n.protectSettings.formatCells)&&(r=r||n.selectedRange,this.notify(ur,{style:i,range:r,refreshRibbon:r.indexOf(n.activeCell)>-1}))},t.prototype.lockCells=function(i,r){var n=this.getActiveSheet();i=i||n.selectedRange,this.notify(Wb,{range:i,isLocked:r,triggerEvent:!0})},t.prototype.getCellStyleValue=function(i,r){var n=this,s=Q(r[0],r[1],this.getActiveSheet()),a={};return i.forEach(function(l){a[""+l]=n.cellStyle[""+l],s&&s.style&&s.style[""+l]&&(a[""+l]=s.style[""+l])}),a},t.prototype.numberFormat=function(i,r){this.notify(vg,{format:i,range:r}),this.notify(qd,{action:"addToCustomFormats",format:i})},t.prototype.createSheet=function(i,r){i===void 0&&(i=this.sheets.length),r===void 0&&(r=[{}]);var n;(n=this.sheets).splice.apply(n,[i,0].concat(r)),ng(this,r),this.notify(yg,{sheetIndex:i||0,sheets:r}),this.notify(At,{action:"registerSheet",sheetIndex:i||0,sheetCount:i+r.length})},t.prototype.removeSheet=function(i){this.sheets.splice(i,1)},t.prototype.destroy=function(){this.notify(LY,null),o.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];switch(a){case"cellStyle":mt(this.commonCellStyle,i.cellStyle);break;case"sheets":i.sheets===this.sheets?(this.notify(At,{action:"unRegisterSheet",propertyChange:!0}),this.sheetNameCount=1,this.notify(ka,{}),ng(this),this.notify(yg,null),this.notify(At,{action:"registerSheet"})):ng(this);break;case"listSeparator":this.notify(At,{action:"setArgumentSeparator"});break}}},t.prototype.appendTo=function(i){o.prototype.appendTo.call(this,i)},t.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var s=this.getActiveSheet(),a=i;a<=r;a++)Cs(s,a,{hidden:n})},t.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0);for(var s=this.getActiveSheet(),a=i;a<=r;a++)Hl(s,a,{hidden:n})},t.prototype.setBorder=function(i,r,n,s){this.notify(ur,{style:i,borderType:n,range:r||this.getActiveSheet().selectedRange,isUndoRedo:s})},t.prototype.insertRow=function(i,r,n){this.notify(Fa,{model:this.getSheetModel(n),start:i,end:r,modelType:"Row",insertType:"below"})},t.prototype.insertColumn=function(i,r,n){this.notify(Fa,{model:this.getSheetModel(n),start:i,end:r,modelType:"Column",insertType:"after"})},t.prototype.insertSheet=function(i,r){this.isProtected||this.notify(Fa,{model:this,start:i,end:r,modelType:"Sheet"})},t.prototype.delete=function(i,r,n,s){if(!this.isProtected){i=i||0;var a;if(r=g(r)?i:r,!n||n==="Sheet"){if(a=this,Math.abs(r-i)>=this.sheets.length)return}else if(a=this.getSheetModel(s),!a)return;this.notify(Sg,{model:a,start:i,end:r,modelType:n||"Sheet"})}},t.prototype.moveSheet=function(i,r){this.isProtected||a0(this,i,r)},t.prototype.duplicateSheet=function(i){this.isProtected||JD(this,i)},t.prototype.getSheetModel=function(i){if(g(i))return this.getActiveSheet();var r=typeof i=="string"?Ct(this,i):i;return g(r)||r>=this.sheets.length?null:this.sheets[r]},t.prototype.merge=function(i,r){var n,s;i?(n=this.isPrintingProcessing?this.currentPrintSheetIndex:js(this,i),s=ke(this,n)):(s=this.getActiveSheet(),i=s.selectedRange,n=this.activeSheetIndex),!s.isProtected&&this.notify(Nn,{merge:!0,range:i,type:r||"All",sheetIndex:n,refreshRibbon:i.indexOf(s.activeCell)>-1,preventRefresh:this.activeSheetIndex!==n})},t.prototype.unMerge=function(i){var r,n;i?(r=js(this,i),n=ke(this,r)):(n=this.getActiveSheet(),i=n.selectedRange,r=this.activeSheetIndex),!n.isProtected&&this.notify(Nn,{merge:!1,range:i,sheetIndex:r,type:"All",refreshRibbon:i.indexOf(n.activeCell)>-1,preventRefresh:this.activeSheetIndex!==r})},t.prototype.computeExpression=function(i){var r={action:"computeExpression",formula:i,isFromComputeExpression:!0};return this.notify(At,r),r.calcValue},t.prototype.initEmptySheet=function(){this.sheets.length?ng(this):this.createSheet()},t.prototype.getActiveSheet=function(){return this.sheets[this.activeSheetIndex]},t.prototype.skipHiddenSheets=function(i,r,n){return n===void 0&&(n=0),this.sheets[i]&&this.sheets[i].state!=="Visible"&&(r===void 0&&(r=i),i&&i+1===this.sheets.length?i=r-1:i=i<r?--i:++i,i=this.skipHiddenSheets(i,r,++n)),n===this.sheets.length?(this.setSheetPropertyOnMute(this.sheets[0],"state","Visible"),0):i},t.prototype.setUsedRange=function(i,r,n,s,a){if(n===void 0&&(n=this.getActiveSheet()),a){this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:i,colIndex:r});return}i>n.usedRange.rowIndex&&(this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:i,colIndex:n.usedRange.colIndex}),n===this.getActiveSheet()&&!s&&this.notify(Od,{index:i,update:"row"})),r>n.usedRange.colIndex&&(this.setSheetPropertyOnMute(n,"usedRange",{rowIndex:n.usedRange.rowIndex,colIndex:r}),n===this.getActiveSheet()&&!s&&this.notify(Od,{index:r,update:"col"}))},t.prototype.getData=function(i){return Aa(this,i)},t.prototype.getModuleName=function(){return"workbook"},t.prototype.goTo=function(i){},t.prototype.getValueRowCol=function(i,r,n,s,a,l,h){var c=Cn(this,i),u=ke(this,c),d=Q(r-1,n-1,u);if(s&&s.includes("!")&&!d&&u.ranges&&u.ranges.length){var p;if(this.formulaRefCell&&this.formulaRefCell===s)return d&&d.value;if(u.ranges.forEach(function(v){if(!v.info||!v.info.loadedRange||!v.info.loadedRange.length){p=!0;return}}),p){if(this.formulaRefCell=s,c=Cn(this,Number(s.substring(s.lastIndexOf(",")+1,s.length))),g(c))return d&&d.value;s=s.substring(s.lastIndexOf("!")+1,s.lastIndexOf(",")),Aa(this,u.name+"!A1:"+st(r-1,n-1),null,null,null,null,s,c)}}else d&&d.formula&&(a||g(d.value))&&!l&&this.calculationMode==="Automatic"&&this.notify(zl,{cell:d,rowIdx:r-1,colIdx:n-1,sheetIndex:c,formulaRefresh:!0});if(d&&!De(d.value)&&!this.isEdit){var f={formattedText:d.value,value:d.value,format:d.format,cell:d,skipFormatCheck:!1};this.notify(yr,f),d=f.cell}return h&&d&&d.formula&&d.formula.includes("SUBTOTAL(")?d.formula:d&&d.value},t.prototype.setValueRowCol=function(i,r,n,s,a,l){this.notify(Xc,{action:"updateCellValue",address:[n-1,s-1],value:r,sheetIndex:Cn(this,i),isValueOnly:!0,formula:a,isRandomFormula:l})},t.prototype.open=function(i){this.notify(Lb,i)},t.prototype.openFromJson=function(i,r){this.isOpen=!0;var n=typeof i.file=="object"?JSON.stringify(i.file):i.file;if(n!==""&&r){var s=[];if(r.onlyValues)s.push.apply(s,["style","formula","format","conditionalFormats","validation","hyperlink","wrap","chart","image","notes"]);else{var a={style:r.ignoreStyle,formula:r.ignoreFormula,format:r.ignoreFormat,conditionalFormats:r.ignoreConditionalFormat,validation:r.ignoreValidation,wrap:r.ignoreWrap,chart:r.ignoreChart,image:r.ignoreImage,notes:r.ignoreNote};r.ignoreFreezePane&&s.push.apply(s,["frozenColumns","frozenRows"]);for(var l in a)a[l]&&s.push(l)}n=JSON.stringify(JSON.parse(n),function(h,c){if(!(s.indexOf(h)>-1))return c})}this.notify(Lb,{jsonObject:n,triggerEvent:i.triggerEvent})},t.prototype.save=function(i,r){if(i===void 0&&(i={}),this.allowSave){var n={url:this.saveUrl,fileName:i.fileName||"Sample",saveType:"Xlsx"},s=UD({},n,i,{customParams:{},isFullPost:!0,needBlobData:!1,cancel:!1,autoDetectFormat:!1,pdfLayoutSettings:{fitSheetOnOnePage:!1,orientation:"Portrait"},jsonConfig:r});this.trigger("beforeSave",s),this.notify(hi,{eventArgs:s,action:"beforeSave"}),s.cancel||this.notify(pg,{saveSettings:s,isFullPost:s.isFullPost,needBlobData:s.needBlobData,customParams:s.customParams,pdfLayoutSettings:s.pdfLayoutSettings,jsonConfig:s.jsonConfig,skipWorkerPipeline:s.skipWorkerPipeline})}},t.prototype.saveAsJson=function(i){var r=this;return new Promise(function(n){r.on(MM,function(s){s.cancel=!0,r.off(MM),n({jsonObject:{Workbook:s.jsonObject}}),r.notify(gg,s)}),r.save({},i)})},t.prototype.addHyperlink=function(i,r){var n={hyperlink:i,cell:r};this.notify(Pd,n)},t.prototype.findHandler=function(i){this.notify(TM,i)},t.prototype.replaceHandler=function(i){i.replaceBy==="replace"?this.notify(Cg,i):this.notify(Bd,i)},t.prototype.protectSheet=function(i,r,n){g(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=Ct(this,i));var s=this.sheets[i];s&&(this.setSheetPropertyOnMute(s,"isProtected",!0),this.setSheetPropertyOnMute(s,"password",n||""),this.setSheetPropertyOnMute(s,"protectSettings",r||{}),this.notify(Dd,{protectSettings:s.protectSettings,password:s.password,sheetIndex:i}))},t.prototype.unprotectSheet=function(i){if(g(i)?i=this.activeSheetIndex:typeof i=="string"&&(i=Ct(this,i)),!!this.sheets[i]){var r={sheet:i};this.notify(Mz,r)}},t.prototype.sort=function(i,r,n){if(!this.allowSorting)return Promise.reject();var s={range:r||this.getActiveSheet().selectedRange,sortOptions:i||{sortDescriptors:{}},cancel:!1},a=new Promise(function(h){h((function(){})())}),l={args:s,promise:a,previousSort:n};return this.notify(bg,l),l.promise},t.prototype.addDataValidation=function(i,r){g(i.value1)||(i.type==="List"?i.value1.length>256&&(i.value1=i.value1.substring(0,255)):(i.value1=Td([i.value1],this)[0],i.value2&&(i.value2=Td([i.value2],this)[0])),this.notify(Qo,{rules:i,range:r||jM(this.getActiveSheet())}))},t.prototype.removeDataValidation=function(i){this.notify(Qo,{range:i||jM(this.getActiveSheet()),isRemoveValidation:!0})},t.prototype.addInvalidHighlight=function(i){this.notify(jb,{range:i})},t.prototype.removeInvalidHighlight=function(i){this.notify(Vb,{range:i})},t.prototype.isValidCell=function(i){var r,n,s;if(i){var a=yM(this,i);n=a.sheetIndex,s=a.indices,r=ke(this,n)}else r=this.getActiveSheet(),s=xe(r.activeCell),n=this.activeSheetIndex;var l=Q(s[0],s[1],r,!1,!0);if(l.validation||hs(r.columns[s[1]],s[0],s[1])){var h=l.value||l.value===0?l.value.toString():l.hyperlink?typeof l.hyperlink=="string"?l.hyperlink:l.hyperlink.address||"":"",c={value:h,range:s,sheetIdx:n,td:null,isValid:!0};return this.notify(Bb,c),c.isValid}else return!0},t.prototype.conditionalFormat=function(i){var r=this;if(i.range?this.listSeparator!==","&&i.range.includes(this.listSeparator)&&(i.range=i.range.split(this.listSeparator).join(",")):i.range=this.getActiveSheet().selectedRange,i.value){var n=void 0;if(i.type==="Between")if(this.listSeparator!==","&&i.value.includes(this.listSeparator)){var s=i.value.split('"').filter(function(a){return a.trim()&&a.trim()!==r.listSeparator});n=s.length>1?s:i.value.split(this.listSeparator)}else{var s=i.value.split('"').filter(function(l){return l.trim()&&l.trim()!==","});n=s.length>1?s:i.value.split(",")}else n=[i.value];Td(n,this),i.value=n.join(",")}this.notify(jd,{cfModel:i})},t.prototype.clearConditionalFormat=function(i){var r={};if(!i||!i.includes("!"))r.range=i||this.getActiveSheet().selectedRange,r.sheetIdx=this.activeSheetIndex;else{var n=i.lastIndexOf("!");r.range=i.substring(n+1),r.sheetIdx=Ct(this,i.substring(0,n))}this.notify(po,r)},t.prototype.updateCell=function(i,r,n){g(n)&&(n=!0),this.updateCellDetails(i,r,void 0,void 0,n)},t.prototype.updateCellDetails=function(i,r,n,s,a,l,h){var c,u;if(r||(r=this.getActiveSheet().activeCell),r.includes("!")){if(c=Ji(r),u=Ct(this,r.substring(0,r.lastIndexOf("!"))),u===void 0)return}else c=ie(r),u=this.activeSheetIndex;var d=ke(this,u);if(l&&!(d.rowCount>c[0]&&d.rowCount>c[2]&&d.colCount>c[1]&&d.colCount>c[3])){this.notify(x0,null);return}gr(this,d,{cell:i,rowIdx:c[0],colIdx:c[1],preventEvt:!0});var p=h?i.formula||(g(i.value)?null:i.value):g(i.value)?i.formula||null:i.value,f=p!==null,v=Q(c[0],c[1],d,!1,!0);if(n&&n.format&&s&&(v.format=n.format),f?(delete v.formattedText,this.notify(Xc,{action:"updateCellValue",address:c,value:p,sheetIndex:u,cellInformation:n,isRedo:s,isDependentUpdate:a}),this.isEdit&&v.value==="#CIRCULARREF!"&&(v.value="0")):!g(i.format)&&v.formattedText&&delete v.formattedText,u===this.activeSheetIndex){var m={sheet:d,cell:v,rowIdx:c[0],colIdx:c[1]};(v.rowSpan>1||v.colSpan>1)&&W0(m);var y=!lt(d,m.rowIdx)&&!Ft(d,m.colIdx)&&this.getCell(m.rowIdx,m.colIdx);y&&this.serviceLocator.getService("cell").refresh(m.rowIdx,m.colIdx,!0,y,f,f);var b=xe(d.activeCell);c[0]===b[0]&&c[1]===b[1]&&(this.notify(Hs,null),this.notify(ho,{action:"refreshFormulabar",cell:v}),y&&i.validation&&(m.validation=v.validation,m.td=y,m.isRefresh=!0,this.notify(Yd,m)))}},t.prototype.getRowData=function(i,r){g(i)&&(i=0),g(r)&&(r=this.activeSheetIndex);var n={sheetIdx:r,startIndex:i,modelType:"Row",isDataRequest:!0};return this.notify(Ib,n),n.data},t.prototype.updateRange=function(i,r){r===void 0&&(r=this.activeSheetIndex);var n=ke(this,r);n&&(i.startCell||(i.startCell="A1"),i.showFieldAsHeader===void 0&&(i.showFieldAsHeader=!0),i.template&&!i.address&&(i.address=i.startCell),n.ranges.push(i),this.setSheetPropertyOnMute(n,"ranges",n.ranges),i.dataSource&&this.notify(Ab,{sheetIdx:r,rangeIdx:n.ranges.length-1,changedData:i.dataSource}))},t.prototype.wrap=function(i,r){r===void 0&&(r=!0),_c(i,r,this,null,!0)},t.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(At,r),r.isAdded},t.prototype.removeDefinedName=function(i,r){r===void 0&&(r="");var n={action:"removeDefinedName",isRemoved:!1,definedName:i,scope:r};return this.notify(At,n),n.isRemoved},t.prototype.insertImage=function(i,r){this.notify(Yb,{options:i,range:r||this.getActiveSheet().selectedRange})},t.prototype.autoFill=function(i,r,n,s){var a={dataRange:r||this.getActiveSheet().selectedRange,fillRange:i,direction:n||"Down",fillType:s||"FillSeries"};this.notify(Vd,a)},t.prototype.insertChart=function(i){this.notify(jh,{chart:i})},t.prototype.deleteChart=function(i){this.notify(lu,{id:i})},t.prototype.filter=function(i,r){if(!this.allowFiltering)return Promise.reject();var n={range:r||this.getActiveSheet().selectedRange,filterOptions:i,cancel:!1},s=new Promise(function(l){l((function(){})())}),a={args:n,promise:s};return this.notify(Pb,a),a.promise},t.prototype.addCustomFunction=function(i,r,n){r=r||(typeof i=="string"?i:i.name.replace("bound ",""));var s={action:"addCustomFunction",functionHandler:i,functionName:r,formulaDescription:n};this.notify(At,s)},t.prototype.clear=function(i){this.notify(Hd,i)},t.prototype.getDisplayText=function(i){if(!i)return"";if(i.format&&!g(i.value)){var r={formattedText:i.value,value:i.value,format:i.format,cell:i,skipFormatCheck:!0};return this.notify(yr,r),r.formattedText}else return!i.value&&i.hyperlink?typeof i.hyperlink=="string"?i.hyperlink:i.hyperlink.address:i.value||typeof i.value=="number"?i.value.toString():""},t.prototype.freezePanes=function(i,r,n){i===void 0&&(i=1),r===void 0&&(r=1);var s=this.getSheetModel(n);!this.allowFreezePane||s.frozenRows===i&&s.frozenColumns===r||(this.setSheetPropertyOnMute(s,"frozenRows",i),this.setSheetPropertyOnMute(s,"frozenColumns",r),this.updateTopLeftCell(),s.id===this.getActiveSheet().id&&this.getModuleName()==="spreadsheet"&&this.renderModule.refreshSheet())},t.prototype.Unfreeze=function(i){this.freezePanes(0,0,i)},t.prototype.unfreezePanes=function(i){this.freezePanes(0,0,i)},t.prototype.calculateNow=function(i,r){var n;i==="Workbook"&&this.calculationMode==="Manual"&&(i="CalculateWorkbook",this.setProperties({calculationMode:"Automatic"},!0)),i==="Workbook"||i==="CalculateWorkbook"?n=this.sheets:(typeof r=="string"?r=Ct(this,r):r=g(r)?this.activeSheetIndex:r,n=[ke(this,r)]);var s={action:"calculateNow",scope:i,sheets:n,promise:new Promise(function(a){a((function(){})())})};return this.notify(At,s),s.promise},t.prototype.updateTopLeftCell=function(i,r,n,s){s||(s=this.getActiveSheet());var a=xe(s.topLeftCell);s.frozenRows||s.frozenColumns?((g(i)||i<0)&&(i=s.frozenRows?0:a[0]),(g(r)||r<0)&&(r=s.frozenColumns?0:a[1]),i+=this.frozenRowCount(s),r+=this.frozenColCount(s),n&&(n==="row"?i=xe(s.paneTopLeftCell)[0]:r=xe(s.paneTopLeftCell)[1]),this.setSheetPropertyOnMute(s,"paneTopLeftCell",st(i,r)),s.frozenRows&&(i=a[0]),s.frozenColumns&&(r=a[1])):(g(i)&&(i=a[0]),g(r)&&(r=a[1]),this.setSheetPropertyOnMute(s,"paneTopLeftCell",st(i,r))),this.setSheetPropertyOnMute(s,"topLeftCell",st(i,r))},t.prototype.getAddressInfo=function(i){return yM(this,i)},t.prototype.setSheetPropertyOnMute=function(i,r,n){this.isProtectedOnChange=!0,i[""+r]=n,this.isProtectedOnChange=!1},t.prototype.frozenRowCount=function(i){return i.frozenRows?i.topLeftCell==="A1"?i.frozenRows:xe(i.topLeftCell)[0]+i.frozenRows:0},t.prototype.frozenColCount=function(i){return i.frozenColumns?i.topLeftCell==="A1"?i.frozenColumns:xe(i.topLeftCell)[1]+i.frozenColumns:0},t.prototype.updateRangeOnInsertDelete=function(i,r,n,s,a,l,h){var c,u=!1;if(i.isInsert)if(c=i.endIndex-i.startIndex+1,i.modelType==="Row")if(i.forceUpdate)r[0]+=1,r[2]+=1,u=!0;else{var d=!l&&h&&r[2]===i.startIndex-1&&s===i.startIndex&&r[1]===r[3];i.startIndex<=r[0]&&(r[0]+=c,u=!0),(i.startIndex<=r[2]||n&&i.startIndex===r[2]+1&&d)&&(r[2]+=c,u=!0)}else if(i.forceUpdate)r[1]+=1,r[3]+=1,u=!0;else{var d=!l&&h&&r[3]===i.startIndex-1&&a===i.startIndex&&r[0]===r[2];i.startIndex<=r[1]&&(r[1]+=c,u=!0),(i.startIndex<=r[3]||n&&i.startIndex===r[3]+1&&d)&&(r[3]+=c,u=!0)}else i.modelType==="Row"?(c=r[0]-i.startIndex,c>0&&(r[0]>i.endIndex?(c=i.endIndex-i.startIndex+1,c>0&&(r[0]-=c,u=!0)):(r[0]-=c,u=!0)),i.startIndex<=r[2]&&(i.endIndex<=r[2]?r[2]-=i.endIndex-i.startIndex+1:r[2]-=r[2]-i.startIndex+1,u=!0)):(c=r[1]-i.startIndex,c>0&&(r[1]>i.endIndex?(c=i.endIndex-i.startIndex+1,c>0&&(r[1]-=c,u=!0)):(r[1]-=c,u=!0)),i.startIndex<=r[3]&&(i.endIndex<=r[3]?r[3]-=i.endIndex-i.startIndex+1:r[3]-=r[3]-i.startIndex+1,u=!0));return u},t.prototype.getCell=function(i,r,n){return null},t.prototype.dateToInt=function(i,r){return ls(i,r)},t.prototype.setDateFormat=function(i,r,n){var s=ke(this,Cn(this,i)),a=Q(r,n,s,null,!0).format;(!a||a==="General")&&Zt(r,n,s,{format:cr("ShortDate")},!0)};var e;return Ot([Gt([],XY)],t.prototype,"sheets",void 0),Ot([w(0)],t.prototype,"activeSheetIndex",void 0),Ot([w("100%")],t.prototype,"height",void 0),Ot([w(!0)],t.prototype,"allowFindAndReplace",void 0),Ot([w()],t.prototype,"filterCollection",void 0),Ot([w()],t.prototype,"sortCollection",void 0),Ot([w("100%")],t.prototype,"width",void 0),Ot([w(!0)],t.prototype,"showRibbon",void 0),Ot([w(!0)],t.prototype,"showFormulaBar",void 0),Ot([w(!0)],t.prototype,"showSheetTabs",void 0),Ot([w(!0)],t.prototype,"allowEditing",void 0),Ot([w(!0)],t.prototype,"allowOpen",void 0),Ot([w(!0)],t.prototype,"allowSave",void 0),Ot([w(!0)],t.prototype,"allowSorting",void 0),Ot([w(!0)],t.prototype,"allowFiltering",void 0),Ot([w(!0)],t.prototype,"allowNumberFormatting",void 0),Ot([w(!0)],t.prototype,"allowCellFormatting",void 0),Ot([w(!0)],t.prototype,"allowHyperlink",void 0),Ot([w(!0)],t.prototype,"enableNotes",void 0),Ot([w(!0)],t.prototype,"allowInsert",void 0),Ot([w(!0)],t.prototype,"allowDelete",void 0),Ot([w(!0)],t.prototype,"allowMerge",void 0),Ot([w(!0)],t.prototype,"allowDataValidation",void 0),Ot([w(!0)],t.prototype,"allowImage",void 0),Ot([w(!0)],t.prototype,"allowChart",void 0),Ot([w(!0)],t.prototype,"allowAutoFill",void 0),Ot([w(!0)],t.prototype,"allowPrint",void 0),Ot([w("Automatic")],t.prototype,"calculationMode",void 0),Ot([Ce({},AY)],t.prototype,"autoFillSettings",void 0),Ot([w(!0)],t.prototype,"allowConditionalFormat",void 0),Ot([Ce({},xz)],t.prototype,"cellStyle",void 0),Ot([w("")],t.prototype,"openUrl",void 0),Ot([Ce({},e9)],t.prototype,"openSettings",void 0),Ot([w("")],t.prototype,"saveUrl",void 0),Ot([w("")],t.prototype,"password",void 0),Ot([w(!1)],t.prototype,"isProtected",void 0),Ot([Gt([],Iz)],t.prototype,"definedNames",void 0),Ot([G()],t.prototype,"beforeOpen",void 0),Ot([G()],t.prototype,"openFailure",void 0),Ot([G()],t.prototype,"beforeSave",void 0),Ot([G()],t.prototype,"saveComplete",void 0),Ot([G()],t.prototype,"beforeCellFormat",void 0),Ot([G()],t.prototype,"queryCellInfo",void 0),Ot([G()],t.prototype,"beforeCellUpdate",void 0),Ot([w(!0)],t.prototype,"allowFreezePane",void 0),Ot([w(",")],t.prototype,"listSeparator",void 0),t=e=Ot([It],t),t})(ti);function Yr(o,t){return o.rows[t]}function Cs(o,t,e){o.rows[t]||(o.rows[t]={}),Object.keys(e).forEach(function(i){o.rows[t][""+i]=e[""+i]})}function lt(o,t){return o.rows[t]&&o.rows[t].hidden}function as(o,t){return o.rows[t]&&o.rows[t].isFiltered}function ei(o,t,e,i){var r,n;if(o&&o.standardHeight&&(n=o.standardHeight),o&&o.rows&&o.rows[t]){if(!i&&o.rows[t].hidden)return 0;r=o.rows[t].height===void 0?n===void 0?20:n:o.rows[t].height}else r=n===void 0?20:n;if(e&&window.devicePixelRatio%1>0){var s=r*window.devicePixelRatio%1;return r+(s?(s>.5?1-s:-1*s)/window.devicePixelRatio:0)}else return r}function H0(o,t,e){o&&o.rows&&(o.rows[t]||(o.rows[t]={}),o.rows[t].height=e)}function xi(o,t,e,i,r){e===void 0&&(e=t);var n=0,s;t>e&&(s=t,t=e,e=s);for(var a=t;a<=e;a++)n+=ei(o,a,i,r);return n}function Ht(o,t){return o.columns?o.columns[t]||(o.columns[t]={}):(o.columns=[],o.columns[t]={}),o.columns[t]}function Hl(o,t,e){var i=Ht(o,t);Object.keys(e).forEach(function(r){i[""+r]=e[""+r]})}function qr(o,t,e,i){var r;if(o&&o.columns&&o.columns[t]){if(!e&&o.columns[t].hidden)return 0;r=o.columns[t].width||o.columns[t].customWidth?o.columns[t].width:64}else r=64;if(i&&window.devicePixelRatio%1>0){var n=r*window.devicePixelRatio%1;return r+(n?(n>.5?1-n:-1*n)/window.devicePixelRatio:0)}else return r}function wi(o,t,e,i){e===void 0&&(e=t);var r=0;if(t>e){var n=t;t=e,e=n}for(var s=t;s<=e;s++)r+=qr(o,s,null,i);return r}function Ft(o,t){return o.columns[t]&&o.columns[t].hidden}function hs(o,t,e){return o&&o.validation&&(!o.validation.address||Tz(o.validation.address,t,e))}function b9(o){var t=[];return S9(o,t),wz(o,t),t}function S9(o,t){o.showRibbon&&t.push({member:"ribbon",args:[o]}),o.showFormulaBar&&t.push({member:"formulaBar",args:[o]}),o.showSheetTabs&&t.push({member:"sheetTabs",args:[o]}),o.allowEditing&&(t.push({member:"edit",args:[o]}),t.push({member:"formula",args:[o]})),o.allowOpen&&t.push({member:"open",args:[o]}),o.allowSave&&t.push({member:"save",args:[o]}),o.enableContextMenu&&t.push({member:"contextMenu",args:[o]}),o.allowAutoFill&&t.push({member:"autofill",args:[o]}),o.selectionSettings.mode!=="None"&&t.push({member:"selection",args:[o]}),o.enableKeyboardNavigation&&t.push({member:"keyboardNavigation",args:[o]}),o.allowNumberFormatting&&t.push({member:"numberFormat",args:[o]}),o.enableKeyboardShortcut&&t.push({member:"keyboardShortcut",args:[o]}),o.enableClipboard&&t.push({member:"clipboard",args:[o]}),o.allowCellFormatting&&t.push({member:"cellformat",args:[o]}),o.allowSorting&&t.push({member:"sort",args:[o]}),o.allowResizing&&t.push({member:"resize",args:[o]}),t.push({member:"protectSheet",args:[o]}),t.push({member:"workbookFormula",args:[o]}),t.push({member:"workbookEdit",args:[o]}),o.allowHyperlink&&t.push({member:"spreadsheetHyperlink",args:[o]}),o.enableNotes&&t.push({member:"spreadsheetNote",args:[o]}),o.allowUndoRedo&&t.push({member:"undoredo",args:[o]}),o.allowFiltering&&t.push({member:"filter",args:[o]}),o.allowWrap&&t.push({member:"wrapText",args:[o]}),o.allowInsert&&t.push({member:"insert",args:[o]}),o.allowDelete&&t.push({member:"delete",args:[o]}),o.allowDataValidation&&t.push({member:"dataValidation",args:[o]}),o.allowFindAndReplace&&t.push({member:"findAndReplace",args:[o]}),o.allowMerge&&t.push({member:"merge",args:[o]}),o.allowConditionalFormat&&t.push({member:"conditionalFormatting",args:[o]}),o.allowImage&&t.push({member:"spreadsheetImage",args:[o]}),o.allowChart&&t.push({member:"spreadsheetChart",args:[o]})}function er(o,t){if(t){t.rafIds.length>0&&(t.rafIds.forEach(function(i){return cancelAnimationFrame(i)}),t.rafIds.length=0);var e=requestAnimationFrame(function(){o();var i=t.rafIds.indexOf(e);i!==-1&&t.rafIds.splice(i,1)});t.rafIds.push(e)}else requestAnimationFrame(function(){o()})}function lo(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function bz(o){var t=30;return o.toString().length>3&&(t=o.toString().length*10),t}var gM=null,C9=1.24;function $z(){if(gM!==null)return gM;var o=document.createElement("div"),t=0;return o.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(o),t=o.offsetWidth-o.clientWidth|0,document.body.removeChild(o),gM=t}function Zz(o,t,e){e===void 0&&(e=1),t=t||["e-ribbon","e-formula-bar-panel","e-sheet-tab-panel","e-header-toolbar"];var i=Sz(o,"previous",t,e),r=Sz(o,"next",t,e);return i+r}function Sz(o,t,e,i){for(var r=o[t+"ElementSibling"],n=0;r;)e.some(function(s){return r.classList.contains(s)})&&(n+=r.getBoundingClientRect().height*i),r=r[t+"ElementSibling"];return n}function WD(o,t,e){if(o.scrollSettings.enableVirtualization){var i=o.getActiveSheet(),r=o.frozenRowCount(i),n=o.frozenColCount(i),s=o.viewport.topIndex+r,a=o.viewport.leftIndex+n,l=o.viewport.bottomIndex,h=o.viewport.rightIndex;if(i.frozenRows||i.frozenColumns){if(o.insideViewport(t[0],t[1])||o.insideViewport(t[2],t[3]))return!0}else if(s<=t[0]&&l>=t[2]&&a<=t[1]&&h>=t[3])return!0;var c=!1;if(e){if(t[0]<s&&t[2]<s||t[0]>l&&t[2]>l||(t[0]<s&&t[2]>s&&t[0]>=r&&(t[0]=s,c=!0),t[2]>l&&(t[2]=l,c=!0),t[1]<a&&t[3]<a||t[1]>h&&t[3]>h))return!1;t[1]<a&&t[3]>a&&t[1]>=n&&(t[1]=a,c=!0),t[3]>h&&(t[3]=h,c=!0)}return c}else return!0}function Y0(o,t,e,i,r,n,s,a){var l,h={left:{idx:0,size:0},top:{idx:0,size:0}},c=h.top.size,u=h.left.size;for(l=h.top.idx;l<t[0];l++)e&&e-1<t[0]&&l<e||(c+=ei(o,l,!a));for(l=h.left.idx;l<t[1];l++)i&&i-1<t[1]&&l<i||(u+=qr(o,l,null,!a));return e&&t[0]<e&&(o.showHeaders&&(c+=30),r&&(c-=r)),i&&t[1]<i&&(o.showHeaders&&(u+=s||30),n&&(u-=n)),{top:c,left:u}}function ra(o,t,e,i,r,n,s){i===void 0&&(i="e-selection");var a=o.getActiveSheet();if(a.frozenRows||a.frozenColumns){var l,h=o.frozenRowCount(a),c=o.frozenColCount(a);if(i==="e-active-cell"){if(e[0]<h||e[1]<c){t.style.display="none",l=e[0]<h&&e[1]<c?o.getSelectAllContent():e[0]<h?o.getColumnHeaderContent():o.getRowHeaderContent();var u=l.querySelector("."+i);u||(u=t.cloneNode(!0),l.appendChild(u)),t=u,ta(o,t,e,a,o.enableRtl,h,c,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth)}else ta(o,t,e,a,o.enableRtl,h,c,r);t.style.display&&(t.style.display=""),qi(o.getSelectAllContent(),l,"e-active-cell"),qi(o.getColumnHeaderContent(),l,"e-active-cell"),qi(o.getRowHeaderContent(),l,"e-active-cell")}else if(i==="e-autofill"){var d=void 0,p=o.frozenRowCount(a),f=o.frozenColCount(a);if(e[0]<p||e[1]<f){t.style.display="none",d=e[0]<p&&e[1]<f?o.getSelectAllContent():e[0]<p?o.getColumnHeaderContent():o.getRowHeaderContent();var u=d.querySelector("."+i);u||(u=t.cloneNode(!0),d.appendChild(u)),t=u,ta(o,t,e,a,o.enableRtl,p,f,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-autofill")}else ta(o,t,e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-autofill");t.style.display&&(t.style.display=""),qi(o.getSelectAllContent(),d,"e-autofill"),qi(o.getColumnHeaderContent(),d,"e-autofill"),qi(o.getRowHeaderContent(),d,"e-autofill")}else if(i==="e-filloption"){var d=void 0,p=o.frozenRowCount(a),f=o.frozenColCount(a);if(e[0]<p||e[1]<f)if(e[3]+1===f&&e[2]+1>p)ta(o,o.getMainContent().querySelector(".e-filloption"),e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4});else if(e[2]+1===p&&e[3]+1>f)ta(o,o.getMainContent().querySelector(".e-filloption"),e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4});else if(e[3]+1===f&&e[2]+1<p){d=o.getColumnHeaderContent();var v=d.querySelector("."+i);v||o.notify($b,{id:o.element.id+"_autofilloptionbtn",appendElem:d}),t=o.autofillModule.autoFillDropDown.element,ta(o,t,e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{left:-4})}else if(e[2]+1===p&&e[3]+1===f)ta(o,o.getMainContent().querySelector(".e-filloption"),e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0,{top:-4,left:-4});else{d=e[0]<p&&e[1]<f?o.getSelectAllContent():e[0]<p?o.getColumnHeaderContent():o.getRowHeaderContent();var u=d.querySelector("."+i);u||o.notify($b,{id:o.element.id+"_autofilloptionbtn",appendElem:d}),t=o.autofillModule.autoFillDropDown.element,ta(o,t,e,a,o.enableRtl,p,f,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-filloption",!0)}else ta(o,o.getMainContent().querySelector(".e-filloption"),e,a,o.enableRtl,p,f,r,!1,0,0,0,"e-filloption",!0);t.style.display&&(t.style.display=""),qi(o.getSelectAllContent(),d,"e-filloption"),qi(o.getColumnHeaderContent(),d,"e-filloption"),qi(o.getRowHeaderContent(),d,"e-filloption")}else{var m=tt(e);if(m[0]<h||m[1]<c){t&&!t.classList.contains("e-multi-range")&&t.classList.add("e-hide");var y=[];m[0]<h&&m[1]<c?m[2]<h&&m[3]<c?(y.push(e),n||(qi(o.getColumnHeaderContent(),l,i,!0),qi(o.getRowHeaderContent(),l,i,!0))):m[2]>h-1?m[3]<c?(n||qi(o.getColumnHeaderContent(),l,i,!0),y.push([m[0],m[1],h-1,m[3]]),y.push([h,m[1],m[2],m[3]])):(y.push([m[0],m[1],h-1,c-1]),y.push([h,m[1],m[2],c-1]),y.push([m[0],c,h-1,m[3]]),y.push([h,c,m[2],m[3]])):m[2]<h?(y.push([m[0],m[1],m[2],c-1]),y.push([m[0],c,m[2],m[3]]),n||qi(o.getRowHeaderContent(),l,i,!0)):(y.push([h,m[1],m[2],c-1]),y.push([m[0],m[1],h-1,c-1]),y.push([h,c,m[2],m[3]]),y.push([m[0],c,h-1,m[3]])):m[0]<h?m[2]<h?(y.push(e),n||qi(o.getRowHeaderContent(),l,i,!0)):(y.push([m[0],m[1],h-1,m[3]]),y.push([h,m[1],m[2],m[3]]),n||(qi(o.getSelectAllContent(),l,i,!0),qi(o.getRowHeaderContent(),l,i,!0))):m[3]<c?(y.push(e),n||qi(o.getSelectAllContent(),l,i,!0)):(y.push([m[0],m[1],m[2],c-1]),y.push([m[0],c,m[2],m[3]]),n||(qi(o.getSelectAllContent(),l,i,!0),qi(o.getColumnHeaderContent(),l,i,!0)));var b;y.forEach(function(C){var x;if(C[2]<h&&C[3]<c)l=o.getSelectAllContent();else{if(h||c){var I=o.getSelectAllContent();I&&(x=I.style.zIndex)}if(C[2]<h)l=o.getColumnHeaderContent();else if(C[3]<c)l=o.getRowHeaderContent();else{if(l=o.getMainContent(),h&&!x){var D=o.getColumnHeaderContent();D&&(x=D.style.zIndex)}if(c&&!x){var M=o.getRowHeaderContent();M&&(x=M.style.zIndex)}}}var E;i==="e-copy-indicator"||i==="e-range-indicator"?(E=t.cloneNode(!0),l.appendChild(E),h&&(C[2]+1===h&&y.forEach(function(A){A!==C&&(b=E.getElementsByClassName("e-bottom")[0],b&&A[0]===h&&se(b))}),C[0]===h&&l.parentElement.classList.contains("e-main-panel")&&y.forEach(function(A){A!==C&&(b=E.getElementsByClassName("e-top")[0],b&&A[2]+1===h&&se(b))})),c&&(C[3]+1===c&&y.forEach(function(A){A!==C&&(b=E.getElementsByClassName("e-right")[0],b&&A[1]===c&&se(b))}),C[1]===c&&(l.classList.contains("e-sheet-content")||l.classList.contains("e-column-header"))&&y.forEach(function(A){A!==C&&(b=E.getElementsByClassName("e-left")[0],b&&A[3]+1===c&&se(b))}))):(E=l.querySelector("."+i),E||(E=t.cloneNode(!0),n&&!E.classList.contains("e-multi-range")&&E.classList.add("e-multi-range"),l.appendChild(E)),s&&E.classList.remove(i)),(h||c)&&(x?E.style.zIndex=x:E.style.zIndex&&(E.style.zIndex="")),ta(o,E,C,a,o.enableRtl,h,c,r,!1,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth),E.classList.contains("e-hide")&&E.classList.remove("e-hide")})}else n||(qi(o.getSelectAllContent(),null,i,!0),qi(o.getColumnHeaderContent(),null,i,!0),qi(o.getRowHeaderContent(),null,i,!0)),ta(o,t,e,a,o.enableRtl,h,c,r),(i==="e-range-indicator"||!o.getMainContent().querySelector("."+i))&&o.getMainContent().appendChild(t),t.classList.contains("e-hide")&&t.classList.remove("e-hide"),s&&t.classList.remove(i)}}else{var S=ta(o,t,e,a,o.enableRtl,0,0,r);return t&&!o.getMainContent().querySelector("."+i)&&o.getMainContent().appendChild(t),S}}function qi(o,t,e,i,r){if(i||o!==t)if(r)for(var n=o.querySelectorAll("."+e),s=0;s<n.length;)n[s].classList.remove(e),s++;else{var a=o.querySelector("."+e);a&&!a.classList.contains("e-multi-range")&&se(a)}}function ta(o,t,e,i,r,n,s,a,l,h,c,u,d,p,f){var v=tt(e),m=Y0(i,v,n,s,h,c,u),y=[ce(i,0,!0),ce(i,0,!0,"columns")],b,S;o.scrollSettings.isFinite?(b=v[0]>=i.rowCount?0:xi(i,v[0],v[2]<i.rowCount?v[2]:i.rowCount-1,!0),S=v[1]>=i.colCount?0:wi(i,v[1],v[3]<i.colCount?v[3]:i.colCount-1,!0)):(b=xi(i,v[0],v[2],!0),S=wi(i,v[1],v[3],!0));var C=v[1]===0&&v[3]===i.colCount-1,x=v[0]===0&&v[2]===i.rowCount-1,I=0,D=-5,M=-5,E=0,A=6,L=6;if(g(d)){var N={top:(v[0]===y[0]?m.top:m.top-zr(1))+"px",height:b&&b+(v[0]===y[0]?0:zr(1))+"px",width:S&&S+(v[1]===y[1]?0:zr(1))+(l&&s&&v[1]<s&&v[3]>=s?1:0)+"px"};if(N[r?"right":"left"]=(v[1]===y[1]?m.left:m.left-1)+"px",t){var R=vM([{element:t,attrs:N}],a);return R}}else{C&&(D=-5,M=-2,A=6,L=3),x&&(M=-5,D=0,A=1,L=6),x||(I+=b),C||(E+=S),I+=Math.round(m.top)+D,E+=Math.round(m.left)+M;var N={};p?(Z([t],"e-hide"),I=f&&f.top?f.top:I,E=f&&f.left?f.left:E,N={top:I+A+"px"},N[r?"right":"left"]=E+L+"px",t&&vM([{element:t,attrs:N}],a)):(N={top:I+"px"},N[r?"right":"left"]=E+"px",t&&vM([{element:t,attrs:N}],a))}}function vM(o,t){var e=new Promise(function(i){var r=function(){o.forEach(function(n){Ze(n.element,n.attrs),i()})};t?r():requestAnimationFrame(function(){return r()})});return e}function tp(){return j.isPointer?"pointerdown":"mousedown touchstart"}function Fh(){return j.isPointer?"pointermove":"mousemove touchmove"}function Md(){return j.isPointer?"pointerup":"mouseup touchend"}function Oc(o){return o.type==="touchstart"||o.type==="pointerdown"&&o.pointerType==="touch"}function V0(o){return o.type==="touchmove"||o.type==="pointermove"&&o.pointerType==="touch"}function xb(o){return o.type==="touchend"||o.type==="pointerup"&&o.pointerType==="touch"}function Eb(o){return o&&(o.type==="mousedown"||o.type==="pointerdown")}function yd(o){return o&&(o.type==="mousemove"||o.type==="pointermove")}function mM(o){return o&&(o.type==="mouseup"||o.type==="pointerup")}function Yc(o){return o===ia.UP||o===ia.DOWN||o===ia.LEFT||o===ia.RIGHT}function Uo(o){return o.changedTouches?o.changedTouches[0].clientX:o.clientX}function Wo(o){return o.changedTouches?o.changedTouches[0].clientY:o.clientY}function w9(o){return o.changedTouches?o.changedTouches[0].pageX:o.pageX}function x9(o){return o.changedTouches?o.changedTouches[0].pageY:o.pageY}function zr(o,t){if(window.devicePixelRatio%1>0){var e=o*window.devicePixelRatio%1;return o+(e?(e>.5||t?1-e:-1*e)/window.devicePixelRatio:0)}else return o}var I9={role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",busy:"aria-busy",colcount:"aria-colcount"};function bd(o,t){var e=Object.keys(t);e.forEach(function(i){o&&o.setAttribute(I9[""+i],t[""+i])})}function M9(o,t){if(o){var e=ot(o,t);e&&e.destroy()}}function qD(o,t,e,i,r){var n,s,a,l,h,c,u,d,p,f=r.getActiveSheet(),v=r.frozenRowCount(f),m=r.frozenColCount(f),y,b;if(i){var S=r.getSelectAllContent(),C=r.getRowHeaderContent();m&&o>=m&&(S.style.zIndex&&(y=[].slice.call(S.querySelectorAll("col.e-empty"))[t]),C.style.zIndex&&(b=[].slice.call(C.querySelectorAll("col.e-empty"))[t]));var x=o<m?S:r.getColumnHeaderContent();n=x.getElementsByTagName("th")[t],s=x.getElementsByTagName("col")[t],a=(o<m?C:r.getMainContent()).getElementsByTagName("col")[t]}else{n=s=v||m?r.getRow(o,null,m-1):r.getRow(o,r.getRowHeaderTable()),s.style.height=parseInt(e,10)>0?zr(parseInt(e,10))+"px":"2px",a=r.getRow(o,null,m),a.style.height=parseInt(e,10)>0?zr(parseInt(e,10))+"px":"0px";var I=void 0;if(f.showHeaders){var D=r.getRowHeaderContent().getElementsByClassName("e-row"),M=[];M[0]=D[t].getElementsByTagName("td")[0].cloneNode(!0),I=D9(r.getRowHeaderTable(),M,!1,r)+1}for(var E=r.getMainContent().getElementsByClassName("e-row"),A=[],L=0,N=0,R=o,P=0;P<E[t].getElementsByTagName("td").length;P++){var k=E[t].getElementsByTagName("td")[P];A[P]=k.cloneNode(!0);var B=parseInt(k.getAttribute("aria-colindex"),10)-1,F=Q(R,B,f,!1,!0),O=void 0;if(F.rowSpan<1&&(O={range:[R,B,R,B]},r.notify(pr,O),F=Q(O.range[0],O.range[1],f,!1,!0),k=r.getCell(O.range[0],O.range[1])),L=F.value?cg(r,F.style):L,N=N<L?L:N,k.getElementsByClassName("e-cf-databar")[0]){var z=Number(a.style.height.split("px")[0]);r.notify(Gi,{indexes:[R,B],cell:F,ele:k,isRender:!0,resizedRowHeight:z,mergeArgs:O})}}var Y=N+1,K=I>=Y?I:Y;parseInt(a.style.height,10)<K||n&&n.classList.contains("e-reach-fntsize")&&parseInt(a.style.height,10)===K?(f.showHeaders&&(n.classList.add("e-reach-fntsize"),s.style.lineHeight=parseInt(e,10)>=4?parseInt(e,10)-4+"px":parseInt(e,10)>0?parseInt(e,10)-1+"px":"0px"),a.style.lineHeight=parseInt(e,10)>0?parseInt(e,10)-1+"px":"0px"):(s&&s.style.removeProperty("line-height"),a.style.removeProperty("line-height"),n&&n.classList.contains("e-reach-fntsize")&&n.classList.remove("e-reach-fntsize"))}if(c=a.previousElementSibling,p=a.nextElementSibling,c&&(f.showHeaders&&(l=n.previousElementSibling,h=s.previousElementSibling),c=a.previousElementSibling),p&&(f.showHeaders&&(u=n.nextElementSibling,d=s.nextElementSibling),p=a.nextElementSibling),parseInt(e,10)<=0&&!(a.classList.contains("e-zero")||a.classList.contains("e-zero-start"))){if(c&&p)if(i?(f.showHeaders&&(s.style.width="2px"),a.style.width="0px"):(f.showHeaders&&(s.style.height="2px"),a.style.height="0px"),c.classList.contains("e-zero-start")?(f.showHeaders&&n.classList.add("e-zero-start"),a.classList.add("e-zero-start")):(f.showHeaders&&n.classList.add("e-zero"),a.classList.add("e-zero")),u&&!u.classList.contains("e-zero")&&!u.classList.contains("e-zero-last")&&(f.showHeaders&&n.classList.add("e-zero-last"),a.classList.add("e-zero-last")),c.classList.contains("e-zero-last")&&(f.showHeaders&&l.classList.remove("e-zero-last"),c.classList.remove("e-zero-last")),f.showHeaders&&l.classList.contains("e-zero")?(n.classList.contains("e-zero-end"),An(h,-2,i)):f.showHeaders&&An(h,-1,i),f.showHeaders&&l.classList.contains("e-zero-start")&&An(s,-1,i),f.showHeaders&&u.classList.contains("e-zero"))if(n.classList.contains("e-zero-start"))for(;u;)if(u.classList.contains("e-zero")&&parseInt(d.style.height,10)!==0&&!i||parseInt(d.style.width,10)!==0&&i){i?(s.style.width=parseInt(s.style.width,10)-1+"px",d.style.width=parseInt(d.style.width,10)-1+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",d.style.height=parseInt(d.style.height,10)-1+"px"),u.classList.remove("e-zero"),u.classList.add("e-zero-start");break}else{var U=void 0;u.classList.remove("e-zero"),u.classList.add("e-zero-start"),i?(U=parseInt(u.getAttribute("aria-colindex"),10)-1,u=r.getColHeaderTable().getElementsByTagName("th")[U+1],d=r.getColHeaderTable().getElementsByTagName("col")[U+1]):(U=parseInt(u.getAttribute("aria-rowindex"),10)-1,u=r.getRowHeaderTable().getElementsByTagName("tr")[U+1],d=r.getRowHeaderTable().getElementsByTagName("tr")[U+1])}else An(s,-2,i);else f.showHeaders&&(u.classList.contains("e-zero-end")?i?s.style.width="0px":s.style.height="0px":An(d,-1,i));else if(c)i?(f.showHeaders&&(s.style.width="1px"),a.style.width="0px"):(f.showHeaders&&(s.style.height="1px"),a.style.height="0px"),f.showHeaders&&n.classList.add("e-zero-end"),a.classList.add("e-zero-end"),f.showHeaders&&n.classList.add("e-zero-last"),a.classList.add("e-zero-last"),f.showHeaders&&l.classList.contains("e-zero")?An(h,-2,i):An(h,-1,i);else if(u)if(n.classList.add("e-zero-start"),a.classList.add("e-zero-start"),u.classList.contains("e-zero")||(n.classList.add("e-zero-last"),a.classList.add("e-zero-last")),i?(s.style.width="1px",a.style.width="0px"):(s.style.height="1px",a.style.height="0px"),f.showHeaders&&u.classList.contains("e-zero"))for(;u;)if(u.classList.contains("e-zero")&&parseInt(d.style.width,10)!==0&&i||parseInt(d.style.height,10)!==0&&!i){i?(d.style.width=parseInt(d.style.width,10)-1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(d.style.height=parseInt(d.style.height,10)-1+"px",s.style.height=parseInt(s.style.height,10)-1+"px"),u.classList.add("e-zero-start"),u.classList.remove("e-zero");break}else{var U=void 0;u.classList.add("e-zero-start"),u.classList.remove("e-zero"),i?(U=parseInt(u.getAttribute("aria-colindex"),10)-1,d=r.getColHeaderTable().getElementsByTagName("col")[U+1],u=r.getColHeaderTable().getElementsByTagName("th")[U+1]):(U=parseInt(u.getAttribute("aria-rowindex"),10)-1,d=r.getRowHeaderTable().getElementsByTagName("tr")[U+1],u=r.getRowHeaderTable().getElementsByTagName("tr")[U+1])}else f.showHeaders&&An(d,-1,i)}else if(parseInt(e,10)>0){var q=zr(parseInt(e,10))+"px";i?(s.style.width=q,a.style.width=q,y&&(y.style.width=q),b&&(b.style.width=q)):(s.style.height=q,a.style.height=q),f.showHeaders&&l&&u?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(h.style.width=parseInt(h.style.width,10)+2+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+2+"px",s.style.height=parseInt(s.style.height,10)-1+"px"):An(s,-1,i):n.classList.contains("e-zero")?An(h,1,i):n.classList.contains("e-zero-start")&&(i?(h.style.width=parseInt(h.style.width,10)+1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(h.style.height=parseInt(h.style.height,10)+1+"px",s.style.height=parseInt(s.style.height,10)-1+"px")),u.classList.contains("e-zero")?An(s,-1,i):(n.classList.contains("e-zero")||n.classList.contains("e-zero-start"))&&An(d,1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),a.classList.contains("e-zero-start")&&a.classList.remove("e-zero-start"),n.classList.contains("e-zero-last")&&n.classList.remove("e-zero-last"),a.classList.contains("e-zero-last")&&a.classList.remove("e-zero-last"),(l.classList.contains("e-zero")||l.classList.contains("e-zero-start"))&&(l.classList.add("e-zero-last"),c.classList.add("e-zero-last"))):f.showHeaders&&l?(l.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(s.style.width=parseInt(s.style.width,10)-1+"px",h.style.width=parseInt(h.style.width,10)+2+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",h.style.height=parseInt(h.style.height,10)+2+"px"):An(s,-1,i):n.classList.contains("e-zero")?An(h,1,i):An(s,-1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-end")&&n.classList.remove("e-zero-end"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),a.classList.contains("e-zero-end")&&a.classList.remove("e-zero-end")):f.showHeaders&&u&&(u.classList.contains("e-zero")?An(s,-1,i):n.classList.contains("e-zero-start")&&(An(d,1,i),n.classList.remove("e-zero-start")),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),a.classList.contains("e-zero")&&a.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),a.classList.contains("e-zero-start")&&a.classList.remove("e-zero-start"))}}function An(o,t,e){e?o.style.width=parseInt(o.style.width,10)+t+"px":o.style.height=parseInt(o.style.height,10)+t+"px"}function D9(o,t,e,i,r,n){var s=i.createElement("div",{className:i.element.className,styles:"display: block"}),a=i.createElement("table",{className:o.className+"e-resizetable",styles:"width: auto;height: auto"}),l=i.createElement("tr");e?t.forEach(function(p){var f=l.cloneNode();f.appendChild(p),a.appendChild(f)}):(t.forEach(function(p){l.appendChild(p.cloneNode(!0))}),a.appendChild(l)),s.appendChild(a),document.body.appendChild(s);var h,c,u=a.getBoundingClientRect().width,d=a.getBoundingClientRect().height;return n?(e&&parseInt(r,10)>u?h=u:h=parseInt(r,10),!e&&parseInt(r,10)>d?c=d:c=parseInt(r,10)):(c=d,h=u),document.body.removeChild(s),Math.ceil(e?h:c)}function on(o,t,e,i,r,n){var s=o.eventArgs,a,l,h,c,u,d,p,f,v,m,y,b,S,C=o.isFromUpdateAction||Te(e);if(o.isUndoRedo){C=o.isFromUpdateAction=!0,delete o.isUndoRedo,t.notify(yo,o);return}if(C&&!n){var x=s.address||s.range||s.pastedRange||s.addressCollection&&s.addressCollection[0]||s.dataRange,I=Te(s.sheetIndex)?Te(s.sheetIdx)?Te(s.activeSheetIndex)?x?js(t,x):t.activeSheetIndex:s.activeSheetIndex:s.sheetIdx:s.sheetIndex;if(I!==t.activeSheetIndex){var D={sheet:ke(t,I),resolveAfterFullDataLoaded:!0,indexes:[0,0,0,0],promise:new Promise(function(ue){ue((function(){})())})};t.notify(Bh,D),D.promise.then(function(){on(o,t,e,i,r,!0)});return}}var M,E,A,L=Cn(t,s.index),N;switch(o.action){case"sorting":h={range:o.eventArgs.range,sortOptions:o.eventArgs.sortOptions,cancel:!1},c=new Promise(function(ue){ue((function(){})())}),u={args:h,promise:c},t.notify(bg,u),u.promise.then(function(ue){t.serviceLocator.getService("cell").refreshRange(Ji(ue.range))});break;case"cellSave":d=o.eventArgs,M={element:d.element,value:d.value,oldValue:d.oldValue,address:d.address,displayText:d.displayText,formula:d.formula,originalEvent:d.originalEvent,format:d.format},p=M.formula?{formula:M.formula}:{value:M.value},t.updateCellInfo(p,M.address,!1,o.eventArgs,e),e===!0&&t.trigger("cellSave",M);break;case"addNote":case"editNote":case"deleteNote":N=Ji(o.eventArgs.address),e&&(gr(t,t.getActiveSheet(),{rowIdx:N[0],colIdx:N[1],preventEvt:!0,cell:{notes:o.eventArgs.notes}}),t.serviceLocator.getService("cell").refreshRange(Ji(s.address),!1,!1,!0,!0,xs(t)));break;case"cellDelete":E=yM(t,o.eventArgs.address),tP(t,E.indices,E.sheetIndex);break;case"format":if(s.requestType==="CellFormat"){if(s.style&&s.style.border&&!g(s.borderType)){var R={};Object.assign(R,s.style,null,!0),s.style.border=void 0,t.notify(ur,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!0,isUndoRedo:!0}),s.style.border=R.border,t.setBorder(s.style,s.range,s.borderType),s.style=R}else t.notify(ur,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!0,isUndoRedo:!0});er(function(){return t.selectRange(t.getActiveSheet().selectedRange)})}else t.numberFormat(s.format,s.range);break;case"clipboard":f=new Promise(function(ue){ue((function(){})())}),S=t.getAddressInfo(s.copiedRange),t.notify(s.copiedInfo.isCut?iu:ru,{range:S.indices,sId:ke(t,S.sheetIndex).id,promise:c,invokeCopy:!0,isPublic:!0,isFromUpdateAction:!0}),f.then(function(){return t.notify(fo,{range:Ji(s.pastedRange),sIdx:Ct(t,na(s.pastedRange)),type:s.type,isAction:!1,isInternal:!0,isFromUpdateAction:!0})});break;case"gridLines":t.setSheetPropertyOnMute(t.sheets[s.sheetIdx],"showGridLines",s.isShow),t.serviceLocator.getService("sheet").toggleGridlines(),t.notify(Hs,null);break;case"headers":t.setSheetPropertyOnMute(t.sheets[s.sheetIdx],"showHeaders",s.isShow),t.serviceLocator.getService("sheet").showHideHeaders(),t.notify(Hs,null);break;case"resize":case"resizeToFit":C&&(m=t.sheets[s.sheetIndex],y=Ht(m,s.index),b=Yr(m,s.index),(s.isCol&&y&&y.hidden||b&&b.hidden)&&t.notify(kn,{startIndex:s.index,endIndex:s.index,hide:!1,isCol:s.isCol,sheetIndex:s.sheetIndex})),s.isCol?s.hide===void 0?t.setColWidth(C&&!Te(e)?s.oldWidth:s.width,s.index,s.sheetIndex):t.hideColumn(s.index,s.index,s.hide):(s.hide===void 0?t.setRowHeight(C&&!Te(e)?s.oldHeight:s.height,s.index,s.sheetIndex):t.hideRow(s.index,s.index,s.hide),t.notify(u0,{rowIndex:s.index}));break;case"renameSheet":t.setSheetPropertyOnMute(t.sheets[L],"name",s.value),t.notify(g0,{items:t.element.querySelector(".e-sheet-tabs-items"),value:s.value,idx:L});break;case"hideSheet":t.notify(v0,{sheetIndex:s.sheetIndex});break;case"showSheet":t.notify(xD,s);break;case"removeSheet":t.notify(h0,{index:s.index,isAction:!0,count:s.sheetCount,clicked:!0});break;case"gotoSheet":t.notify(wD,{selectedIndex:s.currentSheetIndex,previousIndex:s.previousSheetIndex});break;case"moveSheet":a0(t,s.position,s.sheetIndexes,null,C);break;case"wrap":_c(o.eventArgs.address,o.eventArgs.wrap,t);break;case"hideShow":s.isCol?t.notify(kn,{startIndex:s.startIndex,endIndex:s.endIndex,isCol:!0,hide:e===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex,hiddenIndexes:s.hiddenIndexes}):t.notify(kn,{startIndex:s.startIndex,endIndex:s.endIndex,hide:e===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex});break;case"replace":t.notify(Cg,{value:s.compareValue,replaceValue:s.replaceValue,sheetIndex:s.sheetIndex,address:s.address});break;case"replaceAll":t.notify(Bd,s);break;case"filter":c=new Promise(function(ue){ue((function(){})())}),e===!1?t.notify(Yo,{predicates:s.previousPredicates,range:s.range,sIdx:s.sheetIndex,promise:c,isInternal:!0}):t.notify(Yo,{predicates:s.predicates,range:s.range,sIdx:s.sheetIndex,promise:c,isInternal:!0,useFilterRange:s.useFilterRange,allowHeaderFilter:s.allowHeaderFilter}),r&&!C&&c.then(function(){t.notify(wt,pe({isUndo:!e,isUndoRedo:!C},r))});break;case"insert":if(o.eventArgs.modelType==="Sheet")m=t;else if(m=ke(t,o.eventArgs.activeSheetIndex),!m)break;e===!1?t.notify(Sg,{model:m,start:o.eventArgs.index,isUndoRedo:!0,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType}):t.notify(Fa,{model:m,start:o.eventArgs.index,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType,checkCount:e===void 0?o.eventArgs.sheetCount:null,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.insertType,isFromUpdateAction:C,isRedo:e});break;case"delete":if(o.eventArgs.modelType==="Sheet")m=t;else if(m=ke(t,o.eventArgs.activeSheetIndex),!m)break;e===!1?t.notify(Fa,{model:m,start:o.eventArgs.deletedModel,modelType:o.eventArgs.modelType,columnCellsModel:o.eventArgs.deletedCellsModel,definedNames:o.eventArgs.definedNames,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before",conditionalFormats:o.eventArgs.conditionalFormats,prevAction:o.action,freezePane:s.freezePane}):t.notify(Sg,{model:m,start:o.eventArgs.startIndex,checkCount:o.eventArgs.sheetCount,end:o.eventArgs.endIndex,modelType:o.eventArgs.modelType,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before"});break;case"validation":e===!1?t.notify(zg,{range:s.range}):t.notify(Qo,{rules:{type:s.type,operator:s.operator,value1:s.value1,value2:s.value2,ignoreBlank:s.ignoreBlank,inCellDropDown:s.inCellDropDown},range:s.range,isAction:!0});break;case"removeHighlight":case"addHighlight":t.notify(Og,{isRemoveHighlight:o.action==="removeHighlight",isPublic:!0});break;case"merge":o.eventArgs.isAction=!1,v=[];for(var P=0,k=s.model.length;P<k;P++){v.push({cells:[]});for(var B=0,F=s.model[P].cells.length;B<F;B++)v[P].cells[B]={},Object.assign(v[P].cells[B],s.model[P].cells[B])}if(e===!1&&s.mergeCollection)for(var O=void 0,z=0;z<s.mergeCollection.length;z++)O={range:null},Object.assign(O,s),O.range=s.mergeCollection[z],t.notify(Nn,O);else t.notify(Nn,o.eventArgs);if(t.calculationMode==="Manual"&&e&&t.getActiveSheet().isSheetCalculated)for(var z=0;z<s.model.length;z++)for(var Y=s.model[z].cells,K=0;K<Y.length;K++){var U=s.model[z].cells[K].value;v[z].cells[K].value=!g(U)&&U!==""?U:v[z].cells[K].value}s.model=v;break;case"clear":A={options:o.eventArgs,isFromUpdateAction:C},t.notify(Pg,A),!C&&A.cfClearActionArgs&&(s.cfClearActionArgs.previousConditionalFormats=A.cfClearActionArgs.previousConditionalFormats,s.cfClearActionArgs.conditionalFormats=A.cfClearActionArgs.conditionalFormats);break;case"conditionalFormat":e===!1?t.notify(po,{range:s.range,cfModel:{type:s.type,cFColor:s.cFColor,value:s.value},sheetIdx:s.sheetIdx,isUndoRedo:!s.cancel,isFromUpdateAction:C}):t.notify(jd,{cfModel:{type:s.type,cFColor:s.cFColor,value:s.value,range:s.range},sheetIdx:s.sheetIdx,isUndoRedo:!0,isFromUpdateAction:C});break;case"clearCF":if(e===!1)t.notify(po,{oldCFModel:s.previousConditionalFormats,updatedCFModel:s.conditionalFormats,range:s.selectedRange,isUndo:!0,sheetIdx:s.sheetIdx});else{var q={range:s.selectedRange,sheetIdx:s.sheetIdx,isUndoRedo:!0,isFromUpdateAction:C};t.notify(po,q),C||(s.previousConditionalFormats=q.oldCFModel,q.updatedCFModel.length?s.conditionalFormats=q.updatedCFModel:delete s.conditionalFormats)}break;case"insertImage":e===!1?t.notify(La,{id:o.eventArgs.id,sheetIdx:o.eventArgs.sheetIndex+1,range:o.eventArgs.range,preventEventTrigger:!0}):t.notify(go,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,id:o.eventArgs.id},range:o.eventArgs.range,isPublic:!1,isUndoRedo:!0});break;case"deleteImage":e===!1?t.notify(go,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,id:o.eventArgs.id},range:o.eventArgs.address,isPublic:!1,isUndoRedo:!0}):t.notify(La,{id:o.eventArgs.id,range:o.eventArgs.address,preventEventTrigger:!0});break;case"imageRefresh":l=document.getElementById(o.eventArgs.id),e===!1?t.notify(Jd,{prevTop:o.eventArgs.currentTop,prevLeft:o.eventArgs.currentLeft,currentTop:o.eventArgs.prevTop,currentLeft:o.eventArgs.prevLeft,id:o.eventArgs.id,currentHeight:o.eventArgs.prevHeight,currentWidth:o.eventArgs.prevWidth,requestType:"imageRefresh",prevHeight:o.eventArgs.currentHeight,prevWidth:o.eventArgs.currentWidth,prevRowIdx:o.eventArgs.currentRowIdx,prevColIdx:o.eventArgs.currentColIdx,currentRowIdx:o.eventArgs.prevRowIdx,currentColIdx:o.eventArgs.prevColIdx,isUndoRedo:!0}):(o.eventArgs.isUndoRedo=!0,t.notify(Jd,o.eventArgs)),l&&(l.style.height=e===!1?o.eventArgs.prevHeight+"px":o.eventArgs.currentHeight+"px",l.style.width=e===!1?o.eventArgs.prevWidth+"px":o.eventArgs.currentWidth+"px",l.style.top=e===!1?o.eventArgs.prevTop+"px":o.eventArgs.currentTop+"px",l.style.left=e===!1?o.eventArgs.prevLeft+"px":o.eventArgs.currentLeft+"px");break;case"insertChart":if(e===!1)t.notify(lu,{id:s.id,range:s.posRange||s.range,isUndoRedo:!0});else{var ae=[{type:s.type,theme:s.theme,markerSettings:s.markerSettings,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width,top:s.top,left:s.left,enableCanvas:s.enableCanvas,skipDateInterpolation:s.skipDateInterpolation}];t.notify(jh,{chart:ae,isUndoRedo:!1,range:s.posRange||s.range,isInitCell:!0,isRedo:!0})}break;case"deleteChart":if(e===!1){var te=[{type:s.type,theme:s.theme,markerSettings:s.markerSettings,dataLabelSettings:s.dataLabelSettings,title:s.title,legendSettings:s.legendSettings,primaryXAxis:s.primaryXAxis,primaryYAxis:s.primaryYAxis,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width,top:s.top,left:s.left,enableCanvas:s.enableCanvas,skipDateInterpolation:s.skipDateInterpolation}];t.notify(jh,{chart:te,isUndoRedo:!1,range:s.posRange,isInitCell:!0,isUndo:!0})}else t.notify(lu,{id:s.id,range:s.range,isUndoRedo:!0});break;case"chartRefresh":a=document.getElementById(o.eventArgs.id),e===!1?(t.notify(Uc,pe({},o.eventArgs,{currentColIdx:o.eventArgs.prevColIdx,currentHeight:o.eventArgs.prevHeight,currentLeft:o.eventArgs.prevLeft,currentRowIdx:o.eventArgs.prevRowIdx,currentTop:o.eventArgs.prevTop,currentWidth:o.eventArgs.prevWidth,prevColIdx:o.eventArgs.currentColIdx,prevHeight:o.eventArgs.currentHeight,prevLeft:o.eventArgs.currentLeft,prevRowIdx:o.eventArgs.currentRowIdx,prevTop:o.eventArgs.currentTop,prevWidth:o.eventArgs.currentWidth,isUndoRedo:!0})),t.notify(kh,{height:o.eventArgs.prevHeight.toString(),width:o.eventArgs.prevWidth.toString(),overlayEle:a})):(o.eventArgs.isUndoRedo=!0,t.notify(Uc,o.eventArgs),t.notify(kh,{height:o.eventArgs.currentHeight.toString(),width:o.eventArgs.currentWidth.toString(),overlayEle:a}));break;case"chartDesign":t.notify(Wc,o.eventArgs);break;case"autofill":C&&s.undoArgs&&(s.undoArgs.isFromUpdateAction=s.undoArgs.isUndo=s.undoArgs.preventEvt=!0,s.undoArgs.isPublic=!0,t.notify(yo,s.undoArgs)),t.notify(Vd,{fillRange:o.eventArgs.fillRange,dataRange:o.eventArgs.dataRange,fillType:o.eventArgs.fillType,direction:o.eventArgs.direction,cells:o.eventArgs.beforeActionData});break;case"removeValidation":e!==!1&&t.notify(zg,{range:s.range,isCol:s.isColSelected});break;case"addDefinedName":if(e===!1)t.notify(At,{action:"removeDefinedName",isRemoved:!1,definedName:s.name,scope:s.scope,isEventTrigger:!0});else{var he={name:s.name,refersTo:s.refersTo,scope:s.scope,comment:s.comment};t.notify(At,{action:"addDefinedName",isAdded:!1,definedName:he,isEventTrigger:!0})}break;case"hyperlink":t.notify(Pd,{hyperlink:s.hyperlink,cell:s.address,displayText:s.displayText,isUndoRedo:!0}),t.serviceLocator.getService("cell").refreshRange(Ji(s.address),!1,!1,!1,!0,xs(t));break;case"removeHyperlink":t.notify(Fg,{range:s.address,preventEventTrigger:!0});break;case"freezePanes":t.freezePanes(s.row,s.column,s.sheetIndex);break;case"duplicateSheet":JD(t,s.sheetIndex,null,C);break;case"protectSheet":s.isProtected?t.notify(Dd,s):(t.setSheetPropertyOnMute(ke(t,s.sheetIndex),"password",""),t.notify(sg,{isActive:!0,sheetIndex:s.sheetIndex}));break;case"protectWorkbook":s.isProtected?t.notify(ND,s):t.notify(kD,null);break;case"lockCells":t.notify(Wb,s)}}function Jz(o,t,e,i){for(var r=o.sheets[i],n=r.ranges,s,a=0,l=n.length;a<l;a++)if(n[a].template&&(s=ie(n[a].address.length?n[a].address:n[a].startCell),s[0]<=t&&s[1]<=e&&s[2]>=t&&s[3]>=e))return!0;return!1}function Na(o,t,e,i,r,n,s,a){s===void 0&&(s=!0);var l=ei(t,i,!0),h=zr(e);if(!a){var c=o.frozenColCount(t);if(r=r||(t.frozenRows?o.getRow(i,null,c):o.getRow(i)),r&&(r.style.height=h+"px"),t.frozenColumns)n=n||o.getRow(i,null,c-1);else{var u=o.frozenRowCount(t);n=n||o.getRow(i,i<u?o.sheetModule.getSelectAllTable():o.getRowHeaderTable())}n&&(n.style.height=h+"px")}H0(t,i,e),o.setProperties({sheets:o.sheets},!0),s&&o.notify(Fn,{rowIdx:i,threshold:h-l})}function cg(o,t,e,i){e===void 0&&(e=1);var r=t&&t.fontSize||o.cellStyle.fontSize,n=r.indexOf("pt")>-1?parseInt(r,10)/.75:parseInt(r,10),s=n*(i||tE(t&&t.fontFamily?t:o.cellStyle))*e;return Math.ceil(s%1>.9?s+1:s)}function tE(o){var t=C9;return o&&(o.fontFamily==="Arial Black"||o.fontFamily==="Comic Sans MS"?t=1.44:o.fontFamily==='"Segoe UI", sans-serif'&&(t=1.36)),t}function dr(o,t,e,i){t||(t=e);var r=document.createElement("canvas"),n=r.getContext("2d");return n.font=(t.fontStyle||e.fontStyle)+" "+(t.fontWeight||e.fontWeight)+" "+(t.fontSize||e.fontSize)+" "+(t.fontFamily||e.fontFamily),i?n.measureText(o).width:zr(n.measureText(o).width,!0)}function jg(o,t,e,i){var r,n,s,a,l=0,h=o.toString().split(" "),c=dr(" ",e,i),u,d,p=0,f=0,v=0,m=function(b,S){l&&p++,r/t>=1&&(b.split("").forEach(function(C){a=dr(C,e,i,!0),s+=a,s>t&&(p++,s=a)}),r=zr(s,!0)),S||y(r),l=r},y=function(b){r+=(b+c)/t>=1?0:c};return h.forEach(function(b){if(s=0,a=0,r=dr(b,e,i),d=(l+r)/t,d>1)if(n=b.split("-"),n.length>1){var S=n.length-1;n.forEach(function(C,x){s=0,a=0,u||(u=dr("-",e,i)),r=dr(C,e,i),x<S&&(r+=u),d=(l+r)/t,d>=1?m(C,x!==S):(x===S&&h[h.length-1]!==b&&y(l+r),l+=r)})}else m(b,!1);else y(l+r),l+=r}),l&&(f=(l-c)/t,v=parseFloat(f.toString().split(".")[0]),p+=f+.05>=v+1?Math.ceil(f)+1:Math.ceil(f)),p}function eP(o,t,e){var i=0,r=Q(o,t,e,null,!0),n=Q(o,t+1,e,null,!0);return r.style&&(r.style.border?i=(t===0?2:1)*parseFloat(r.style.border.split("px")[0]):(t===0&&r.style.borderLeft&&(i=parseFloat(r.style.borderLeft.split("px")[0])),r.style.borderRight&&(i+=parseFloat(r.style.borderRight.split("px")[0])))),!(r.style&&(r.style.border||r.style.borderRight))&&n.style&&n.style.borderLeft&&(i+=parseFloat(n.style.borderLeft.split("px")[0])),i>0&&i<1?1:i}function _0(o,t,e){var i=0,r=Q(o,t,e,null,!0);r.style&&(r.style.border?i=(o===0?2:1)*parseFloat(r.style.border.split("px")[0]):(o===0&&r.style.borderTop&&(i=parseFloat(r.style.borderTop.split("px")[0])),r.style.borderBottom&&(i+=parseFloat(r.style.borderBottom.split("px")[0]))));var n=Q(o+1,t,e,null,!0);return!(r.style&&(r.style.border||r.style.borderBottom))&&n.style&&n.style.borderTop&&(i+=parseFloat(n.style.borderTop.split("px")[0])),Math.ceil(i)||1}function ip(o,t,e,i){return i===void 0&&(i=e),wi(o,e,i,!0)-zr(4+(eP(t,e,o)||1))}function kd(o,t,e,i,r,n,s){return cg(o,r,n,s)+_0(t,e,i)}function Ph(o,t,e,i){o.maxHgts[t]||(o.maxHgts[t]={}),o.maxHgts[t][e]=i}function qo(o,t){var e=0,i=o.maxHgts[t];return i&&Object.keys(i).forEach(function(r){i[""+r]>e&&(e=i[""+r])}),e}function Re(o){if(!document.activeElement.classList.contains("e-text-findNext-short"))if(j.isIE){var t=window.scrollX,e=window.scrollY;o.focus(),window.scrollTo(t,e)}else{if(o.classList.contains("e-input")){var i=o,r=i.value.length;i.setSelectionRange(r,r)}o.focus({preventScroll:!0})}}function Ko(o,t){for(var e=o.getActiveSheet(),i,r=g(t)?tt(ie(e.selectedRange)):t,n=r[0];n<=r[2];n++)for(var s=r[1];s<=r[3];s++){var a=Q(n,s,e);if(mn(a,Ht(e,s))){i=!0;break}}return i}function YD(o){return o.includes(" ")}function tP(o,t,e){for(var i=ke(o,e),r,n,s,a,l,h=e===o.activeSheetIndex,c,u=i.conditionalFormats&&i.conditionalFormats.length&&[].slice.call(i.conditionalFormats),d=[],p=!1,f=t[0],v=t[2];f<=v;f++)if(!as(i,f))for(var m=t[1],y=t[3];m<=y;m++){var b={cellIdx:[f,m],isUnique:!1,uniqueRange:""};if(o.notify(Kc,b),r=!1,b.uniqueRange!==""){var S=Ji(b.uniqueRange);r=Q(S[0],S[1],i).value==="#SPILL!"}var C=f===v&&m===y;if(!b.isUnique||r){if(n=Q(f,m,i),n&&n.value===0||n&&n.value&&(g(n.value)||n.value!=="")){p=!1,s={},n.formula&&(s.formula=""),(n.value||n.value===0)&&(s.value=""),n.hyperlink&&(s.hyperlink="");var x={sheet:i,cell:n,rowIdx:f,colIdx:m};if((n.colSpan>1||n.rowSpan>1)&&W0(x),a=o.getCell(x.rowIdx,x.colIdx),l={cell:s,rowIdx:f,colIdx:m,valChange:!0,uiRefresh:h,td:a,cellDelete:!0,isDelete:!C,deletedRange:t},!Object.keys(s).length||gr(o,i,l))continue;u&&!c&&(c=l.isFormulaDependent,c||Eg(u,d,f,m)),a&&(a.querySelector(".e-cf-databar")&&a.removeChild(a.querySelector(".e-cf-databar")),a.querySelector(".e-iconsetspan")&&a.removeChild(a.querySelector(".e-iconsetspan")))}else if(!p&&l&&(p=C,l.isDelete=!C,!Object.keys(s).length||gr(o,i,l)))continue}}(d.length||c)&&h&&o.notify(Gi,{cfModel:!c&&d,refreshAll:c,isAction:!0,isEdit:!0})}function Fd(o,t){for(var e=0,i=o.getActiveSheet(),r=(i.frozenRows?o.viewport.height-o.sheetModule.getColHeaderHeight(i,!0):o.viewport.height)-17||20,n=t;;n++)if(e+=ei(i,n,!0),e>=r)return{index:n,height:e}}function Tb(o,t){for(var e=0,i=o.getActiveSheet(),r=o.getMainContent().parentElement.offsetWidth-o.sheetModule.getRowHeaderWidth(i)-o.sheetModule.getScrollSize(),n=t;;n++)if(e+=qr(i,n,null,!0),e>=r)return n}function Nh(o){for(var t,e=[],i=o.getActiveSheet().name,r=0,n=o.chartColl.length;r<n;r++)if(t=o.chartColl[r],i===na(t.range)){var s={clientY:t.top,isImage:!0},a={clientX:t.left,isImage:!0};o.notify(Is,s),o.notify(Ms,a),e.push({chart:t,chartRowIdx:s.clientY,chartColIdx:a.clientX})}return e}function iP(o){return/^[A-Za-z]+:[A-Za-z]+$/.test(o)}function E9(o){return/^[0-9]+:[0-9]+$/.test(o)}function ws(o){o.forEach(function(t){t&&t.parentNode&&t.parentNode.removeChild(t)})}function rP(o){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(o)}var nP=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),GD=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},T9=(function(o){nP(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return GD([w(!1)],t.prototype,"isFinite",void 0),GD([w(!0)],t.prototype,"enableVirtualization",void 0),t})(Oe),A9=(function(o){nP(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return GD([w("Multiple")],t.prototype,"mode",void 0),t})(Oe),L9=(function(){function o(t){this.colGroupWidth=30,this.parent=t,this.col=t.createElement("col"),this.rowRenderer=t.serviceLocator.getService("row"),this.cellRenderer=t.serviceLocator.getService("cell"),this.addEventListener()}return o.prototype.refreshSelectALLContent=function(){var t,e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var i=this.getSelectAllTable().querySelector("thead"),r=this.rowRenderer.render();i.appendChild(r),t=this.parent.createElement("th",{className:"e-select-all-cell"}),r.appendChild(t)}else t=this.headerPanel.firstElementChild,t.classList.add("e-select-all-cell");t.appendChild(this.parent.createElement("button",{className:"e-selectall",id:this.parent.element.id+"_select_all",attrs:{"aria-label":this.parent.serviceLocator.getService(ve).getConstant("SelectAll"),type:"button"}}))},o.prototype.updateLeftColGroup=function(t,e){t&&(this.colGroupWidth=t),e||(e=this.getRowHeaderPanel());var i=e.querySelector("table"),r=this.parent.getActiveSheet(),n=document.createDocumentFragment(),s;if(t)i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px";else{s=this.parent.createElement("colgroup");var a=this.col.cloneNode();a.style.width=this.colGroupWidth+"px",n.appendChild(a),s.appendChild(n),i.insertBefore(s,i.querySelector("tbody"))}(r.frozenRows||r.frozenColumns)&&(i=this.getSelectAllTable(),t?i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px":i.insertBefore(s.cloneNode(!0),i.querySelector("thead"))),this.setPanelWidth(r,e),this.setPanelHeight(r)},o.prototype.setPanelWidth=function(t,e,i){var r=this.getScrollSize(!0),n=this.getRowHeaderWidth(t),s=this.parent.enableRtl,a=s?"right":"left",l,h=this.getColHeaderPanel(),c=this.getContentPanel();if(i&&(l=s?"left":"right",c.style[""+l]=h.style[""+l]=""),t.frozenColumns){var u=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-column")[0];u.style.height="calc(100% - "+r+"px)",i&&(u.style[""+l]=""),u.style[""+a]=n-zr(1)+"Px",u.style.display=""}var d="calc(100% - "+n+"px)";this.setHeaderPanelWidth(this.getSelectAllContent(),n),h.style.width=d,h.style[""+a]=n+"px",this.setHeaderPanelWidth(e,n),c.style.width=d,c.style[""+a]=n+"px";var p=this.contentPanel.nextElementSibling?this.contentPanel.nextElementSibling:null;p&&(r?p.style.height=r+1+"px":(p.style.height="1px",p.style.borderTopWidth="0px"),p=p.firstElementChild,i&&(p.style[""+l]=""),p.style[""+a]=n+"px",p.style.width=d,j.userAgent.indexOf("Mac OS")>-1&&j.info.name==="safari"&&(p.style.height="7px",p.style.top="-7px"))},o.prototype.getScrollSize=function(t){var e=parseInt(this.headerPanel.style[this.parent.enableRtl?"margin-left":"margin-right"],10);return e?e+(t?1:0):0},o.prototype.setHeaderPanelWidth=function(t,e){var i=[].slice.call(t.querySelectorAll("col.e-empty"));i.forEach(function(r){e+=parseInt(r.style.width,10)}),t.style.width=e+"px"},o.prototype.setPanelHeight=function(t){var e=this.getScrollSize(!0),i=this.contentPanel,r=this.headerPanel;if(t.frozenRows){var n=this.getColHeaderHeight(t);!t.showHeaders&&!t.frozenColumns?r.style.height=n+"px":r.style.height="",i.style.height="calc(100% - "+(n+e)+"px)";var s=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-row")[0];s.style.width=j.isDevice?"100%":"calc(100% - "+e+"px)",s.style.top=n-1-(t.showHeaders?1:0)+"px",s.style.display=""}else i.style.height="calc(100% - "+((t.showHeaders?zr(31):0)+e)+"px)"},o.prototype.renderPanel=function(){this.contentPanel=this.parent.createElement("div",{className:"e-main-panel",attrs:{tabindex:"0"}});var t=this.parent.getActiveSheet(),e=this.parent.element.id,i=document.createDocumentFragment(),r=this.parent.createElement("div",{className:"e-row-header",id:e+"_row_header"});i.appendChild(r),this.initHeaderPanel(),this.parent.allowScrolling&&this.parent.scrollModule.setPadding();var n=document.getElementById(this.parent.element.id+"_sheet");t.frozenColumns&&n.classList.add("e-frozen-columns"),t.frozenRows&&n.classList.add("e-frozen-rows"),this.updateHideHeaders(t,n),t.showGridLines||n.classList.add("e-hide-gridlines");var s=this.parent.createElement("div",{className:"e-sheet-content",id:e+"_main_content"});i.appendChild(s),this.parent.allowScrolling||(s.style.overflow="hidden"),t.frozenRows&&n.appendChild(this.parent.createElement("div",{className:"e-frozen-row",styles:"display: none"})),t.frozenColumns&&n.appendChild(this.parent.createElement("div",{className:"e-frozen-column",styles:"display: none"})),j.userAgent.indexOf("Mac OS")>-1&&j.info.name==="safari"&&n.classList.add("e-mac-safari"),this.contentPanel.appendChild(i)},o.prototype.initHeaderPanel=function(){var t=this.parent.element.id,e=document.createDocumentFragment();this.headerPanel=this.parent.createElement("div",{className:"e-header-panel"});var i=this.parent.createElement("div",{className:"e-selectall-container",id:t+"_selectall"});e.appendChild(i);var r=this.parent.createElement("div",{className:"e-column-header",id:t+"_col_header"});e.appendChild(r),this.headerPanel.appendChild(e)},o.prototype.createHeaderTable=function(){var t=this.contentPanel.querySelector(".e-row-header"),e=this.parent.getActiveSheet();(e.frozenRows||e.frozenColumns)&&this.updateTable(e.frozenRows?["thead","tbody"]:["thead"],"selectall",this.headerPanel.querySelector(".e-selectall-container")),this.updateTable(e.frozenRows?["thead","tbody"]:["thead"],"colhdr",this.headerPanel.querySelector(".e-column-header")),this.updateTable(["tbody"],"rowhdr",t),this.updateLeftColGroup(null,t)},o.prototype.updateTable=function(t,e,i){var r=this,n=document.createDocumentFragment(),s=this.parent.createElement("table",{className:"e-table e-"+e+"-table",attrs:{role:"grid"}});t.forEach(function(a){n.appendChild(r.parent.createElement(a))}),s.appendChild(n),i.appendChild(s)},o.prototype.renderTable=function(t){var e=this,i,r,n,s=this.parent.getActiveSheet(),a,l,h=[],c=document.createDocumentFragment();if(c.appendChild(this.headerPanel),c.appendChild(this.contentPanel),this.parent.allowScrolling){var u=this.parent.createElement("div",{className:"e-scrollbar"});u.appendChild(this.parent.createElement("div",{className:"e-scroller"})),c.appendChild(u)}this.createHeaderTable(),this.updateTable(["tbody"],"content",this.contentPanel.lastElementChild);var d=this.parent.createElement("colgroup"),p,f=this.contentPanel.querySelector(".e-sheet-content tbody");this.refreshSelectALLContent();var v=this.getSelectAllContent().querySelector("colgroup"),m=this.getRowHeaderPanel().querySelector("colgroup"),y=this.getSelectAllContent().querySelector("thead .e-header-row"),b=this.contentPanel.querySelector(".e-row-header tbody"),S=this.getSelectAllContent().querySelector("tbody"),C=this.headerPanel.querySelector(".e-column-header thead"),x=this.headerPanel.querySelector(".e-column-header tbody"),I=this.rowRenderer.render();C.appendChild(I),this.getColHeaderTable().insertBefore(d,C);var D=this.parent.frozenRowCount(s),M=this.parent.frozenColCount(s),E=ce(s,M-1,!1,"columns");this.parent.notify(UM,{top:t.top,left:t.left});var A=s.colCount.toString(),L=s.colCount.toString(),N=t.top&&t.left?"RowColumn":t.top?"Row":t.left?"Column":"";this.parent.getColHeaderTable().setAttribute("aria-colcount",A),this.parent.getRowHeaderTable().setAttribute("aria-rowcount",L);var R;Ee(this.parent.getContentTable(),{"aria-rowcount":L,"aria-colcount":A}),t.cells.forEach(function(k,B){i=ie(B),(i[1]===t.indexes[1]||!r)&&(i[1]===t.indexes[1]&&(n=e.rowRenderer.render(i[0],!0)),M&&D&&i[1]<M&&i[0]<D?(R=S.querySelector(".e-empty"),R?S.insertBefore(n,R):S.appendChild(n),r=n):M&&i[1]<M?(b.appendChild(n),r=n):(r=e.rowRenderer.render(i[0]),D&&i[0]<D?(R=x.querySelector(".e-empty"),R?x.insertBefore(r,R):x.appendChild(r)):f.appendChild(r),i[1]===t.indexes[1]&&(D&&i[0]<D?S.appendChild(n):b.appendChild(n))),i[1]===t.indexes[1]&&e.cellRenderer.renderRowHeader(i[0],n)),l={colIdx:i[1],rowIdx:i[0],cell:k,mergeBorderRows:h,address:B,lastCell:i[1]===t.indexes[3],isHeightCheckNeeded:!0,row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isRefreshing:t.isRefreshing,first:N?N.includes("Row")?i[0]===t.indexes[0]?"Row":N.includes("Column")&&i[1]===t.indexes[1]?"Column":"":i[1]===t.indexes[1]?"Column":"":""},a=e.cellRenderer.render(l);var F=e.parent.scrollSettings.enableVirtualization&&e.parent.viewport.topIndex!==ce(s,0,!0),O=e.parent.scrollSettings.enableVirtualization&&e.parent.viewport.leftIndex!==ce(s,0,!0,"columns");if(F&&e.checkRowMerge(i,t.indexes,a,k,s),O&&e.checkColMerge(i,t.indexes,a,k,s),M&&i[1]===E&&(r=null),i[0]===t.indexes[0])if(M&&i[1]<M){p=e.updateCol(s,i[1],v);var z=m.querySelector(".e-empty");z?m.insertBefore(p.cloneNode(!0),z):m.appendChild(p.cloneNode(!0)),e.cellRenderer.renderColHeader(i[1],y)}else e.updateCol(s,i[1],d),e.cellRenderer.renderColHeader(i[1],I)}),this.parent.isReact&&this.parent.renderReactTemplates(),md(this.parent,h),f.parentElement.insertBefore(d.cloneNode(!0),f);var P=t.openOptions&&t.openOptions.eventArgs&&t.openOptions.eventArgs.triggerEvent;er(function(){if(e.parent){var k=e.parent.getMainContent(),B=document.getElementById(e.parent.element.id+"_sheet");if(B){if(B.childElementCount&&B.querySelector(".e-header-panel")!==e.headerPanel)for(var F=B.children,O=0;O<F.length;O++)!F[O].classList.contains("e-frozen-row")&&!F[O].classList.contains("e-frozen-column")&&!F[O].classList.contains("e-ss-overlay")&&B.removeChild(F[O]);B.appendChild(c),B.style.backgroundColor=""}if(s.conditionalFormats&&s.conditionalFormats.length&&e.parent.notify(Gi,{indexes:t.indexes}),e.checkRowHeightChanged(t,s),t.top&&(k.parentElement.scrollTop=t.top),t.left&&(k.scrollLeft=t.left,e.parent.getColumnHeaderContent().scrollLeft=t.left),e.parent.notify(Ln,t),e.checkTableWidth(s),e.parent.notify(ui,{action:"renderEditor",initLoad:t.initLoad&&!e.parent.isOpen}),!t.initLoad&&!e.parent.isOpen&&e.parent.hideSpinner(),bd(k,{busy:!1}),e.parent.trigger(t9,{}),e.parent.isEdit&&e.parent.notify(DD,null),P&&e.parent.trigger("openComplete",{response:t.openOptions}),t.initLoad){var z=!0;if(e.parent.scrollSettings.enableVirtualization){for(var O=0;O<s.ranges.length;O++)if(s.ranges[O].info.count-1>e.parent.viewport.bottomIndex){z=!1;break}}z?e.parent.isReact?setTimeout(function(){e.parent&&e.triggerCreatedEvent()}):e.triggerCreatedEvent():e.parent.isOpen||e.parent.hideSpinner()}}},t.initLoad||P?void 0:this.parent)},o.prototype.triggerCreatedEvent=function(){this.parent.isOpen||this.parent.hideSpinner(),this.parent.createdHandler&&(this.parent.createdHandler.observers?(this.parent.created.observers=this.parent.createdHandler.observers,this.parent.isAngular&&this.parent.createdHandler.currentObservers&&(this.parent.created.currentObservers=this.parent.createdHandler.currentObservers)):this.parent.setProperties({created:this.parent.createdHandler},!0),this.parent.createdHandler=void 0,this.parent.trigger(fM,null),this.parent&&this.parent.notify(Vh,null)),this.parent&&this.parent.notify(yD,null)},o.prototype.checkRowHeightChanged=function(t,e){var i={top:t.top,left:t.left,sheet:e};this.parent.notify(PD,i),t.top!==i.top&&(this.parent.scrollModule&&this.parent.scrollModule.offset.top.idx&&i.top-t.top<ei(e,this.parent.scrollModule.offset.top.idx)&&(this.parent.scrollModule.offset.top.size=i.top),t.top=i.top),t.left!==i.left&&(this.parent.scrollModule&&this.parent.scrollModule.offset.left.idx&&i.left-t.left<qr(e,this.parent.scrollModule.offset.left.idx)&&(this.parent.scrollModule.offset.left.size=i.left),t.left=i.left)},o.prototype.checkTableWidth=function(t){if(this.parent.scrollSettings.isFinite&&!this.parent.scrollSettings.enableVirtualization&&t.colCount-1===this.parent.viewport.rightIndex){var e=wi(t,this.parent.viewport.leftIndex+this.parent.frozenColCount(t),this.parent.viewport.rightIndex),i=this.getRowHeaderWidth(t),r=this.getScrollSize();e<this.contentPanel.getBoundingClientRect().width-i-r?(this.getContentPanel().style.width=e+"px",this.getColHeaderPanel().style.width=e+"px"):this.getContentPanel().style.width.includes("calc")||(this.getContentPanel().style.width="calc(100% - "+i+"px)",this.getColHeaderPanel().style.width="calc(100% - "+i+"px)")}},o.prototype.clearCFResult=function(t){t.conditionalFormats&&t.conditionalFormats.length&&t.conditionalFormats.forEach(function(e){delete e.result})},o.prototype.refreshColumnContent=function(t){var e=this,i,r=0,n=this.parent.getActiveSheet(),s,a=[],l=document.createDocumentFragment(),h=document.createDocumentFragment(),c=this.parent.element.querySelector(".e-sheet-content tbody"),u=this.parent.element.querySelector(".e-column-header tbody"),d=this.parent.element.querySelector(".e-sheet-content colgroup");d=d.cloneNode(),l.appendChild(d),c=l.appendChild(c.cloneNode(!0));var p=d.cloneNode();h.appendChild(p);var f=this.parent.element.querySelector(".e-column-header thead");f=h.appendChild(f.cloneNode(!0));var v=f.querySelector("tr");v.innerText="";var m=this.parent.frozenRowCount(n),y=this.parent.frozenColCount(n);m&&(u=h.appendChild(u.cloneNode(!0)));var b=ce(n,m-1,!1),S=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.topIndex!==ce(n,0,!0);this.clearCFResult(n),t.cells.forEach(function(x,I){var D=ie(I);if(D[0]===t.indexes[0]){var M=e.updateCol(n,D[1],p);d.appendChild(M.cloneNode()),e.cellRenderer.renderColHeader(D[1],v)}if(D[1]-y===t.indexes[1])if(i=D[0]<m?u.children[r]:c.children[r],i)i.innerText="",r++;else return;if(i){s={colIdx:D[1],rowIdx:D[0],cell:x,address:I,row:i,pRow:i.previousSibling,first:!t.skipUpdateOnFirst&&D[1]===t.indexes[1]?"Column":S&&D[0]===t.indexes[0]?"Row":"",isRefreshing:!0,mergeBorderRows:a};var E=e.cellRenderer.render(s);e.checkColMerge(D,t.indexes,E,x,n),m&&D[0]===b&&(r=0)}});var C=function(){var x=e.getColHeaderTable();lo(x),x.appendChild(h),x=e.getContentTable(),lo(x),x.appendChild(l),e.parent.notify(co,{refresh:"Column",prevRowColCnt:t.prevRowColCnt}),md(e.parent,a),n.conditionalFormats&&n.conditionalFormats.length&&e.parent.notify(Gi,{indexes:t.indexes,isRender:!0}),e.parent.isEdit&&e.parent.notify(wd,{}),e.parent.allowChart&&e.parent.notify(Id,null),e.parent.isOpen||e.parent.hideSpinner(),bd(e.parent.getMainContent(),{busy:!1})};t.insertDelete?C():er(function(){return C()})},o.prototype.refreshRowContent=function(t){var e=this,i,r,n=this.colGroupWidth,s=this.parent.getActiveSheet(),a,l,h=[],c=document.createDocumentFragment(),u=document.createDocumentFragment(),d=this.parent.createElement("tbody"),p=d.cloneNode();u.appendChild(p),c.appendChild(d);var f=this.parent.frozenColCount(s),v=ce(s,f-1,!1,"columns"),m=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.leftIndex!==ce(s,0,!0,"columns");this.clearCFResult(s),t.cells.forEach(function(S,C){var x=ie(C);(x[1]===t.indexes[1]||!i)&&(x[1]===t.indexes[1]&&(r=e.rowRenderer.render(x[0],!0)),f&&x[1]<f?(p.appendChild(r),i=r):(x[1]===t.indexes[1]&&p.appendChild(r),i=e.rowRenderer.render(x[0]),d.appendChild(i)),x[1]===t.indexes[1]&&(e.cellRenderer.renderRowHeader(x[0],r),n=bz(x[0]+1))),f&&(r=p.lastElementChild||r),l={rowIdx:x[0],colIdx:x[1],cell:S,address:C,lastCell:x[1]===t.indexes[3],row:i,hRow:r,pRow:i.previousSibling,pHRow:r.previousSibling,isHeightCheckNeeded:!0,first:!t.skipUpdateOnFirst&&x[0]===t.indexes[0]?"Row":m&&x[1]===t.indexes[1]?"Column":"",isRefreshing:!0,mergeBorderRows:h},a=e.cellRenderer.render(l),e.checkRowMerge(x,t.indexes,a,S,s),f&&x[1]===v&&(i=null)}),this.colGroupWidth!==n&&this.updateLeftColGroup(n);var y=this.contentPanel.querySelector(".e-row-header tbody");y&&(se(y),this.getRowHeaderTable().appendChild(u));var b=this.contentPanel.querySelector(".e-sheet-content tbody");b&&(se(b),this.getContentTable().appendChild(c)),this.parent.notify(co,{refresh:"Row",prevRowColCnt:t.prevRowColCnt}),md(this.parent,h),s.conditionalFormats&&s.conditionalFormats.length&&this.parent.notify(Gi,{indexes:t.indexes,isRender:!0}),this.parent.allowChart&&this.parent.notify(Id,{}),this.parent.isEdit&&this.parent.notify(wd,null),this.parent.isOpen||this.parent.hideSpinner(),bd(this.parent.getMainContent(),{busy:!1})},o.prototype.updateCol=function(t,e,i){var r=this.col.cloneNode();if(r.style.width=Ae(qr(t,e,null,!0)),i){var n=i.querySelector(".e-empty");return n?i.insertBefore(r,n):i.appendChild(r)}else return r},o.prototype.updateColContent=function(t){var e=this;er(function(){var i,r,n=0,s,a,l,h,c=e.parent.getActiveSheet(),u=[],d=e.parent.element.querySelector(".e-column-header .e-header-row"),p=e.parent.element.querySelector(".e-sheet-content colgroup"),f=e.parent.element.querySelector(".e-column-header colgroup"),v=d.firstElementChild,m=p.firstElementChild,y=f.firstElementChild,b=e.parent.element.querySelector(".e-sheet-content tbody"),S=e.parent.element.querySelector(".e-column-header tbody"),C=e.parent.frozenRowCount(c),x=e.parent.frozenColCount(c),I=ce(c,C-1,!1),D=ce(c,t.indexes[0],!0);e.clearCFResult(c),t.cells.forEach(function(M,E){if(!l){var A=ie(E);if(t.direction==="first"&&A[1]===t.indexes[1]&&e.checkColMerge([A[0],e.parent.viewport.leftIndex+x],t.indexes,((A[0]<C?S:b).rows[n]||{cells:[]}).cells[t.indexes[3]-t.indexes[1]+1],Q(A[0],e.parent.viewport.leftIndex+x,c)||{},c),A[0]===D&&(t.direction==="last"?(a=e.col.cloneNode(),a.style.width=Ae(qr(c,A[1],null,!0)),p.insertBefore(a,m),f.insertBefore(a.cloneNode(),y),e.cellRenderer.renderColHeader(A[1],d,v)):(a=e.updateCol(c,A[1],p),f.appendChild(a.cloneNode()),e.cellRenderer.renderColHeader(A[1],d)),e.parent.scrollSettings.enableVirtualization&&t.direction&&(se(p[t.direction+"ElementChild"]),se(f[t.direction+"ElementChild"]),se(d[t.direction+"ElementChild"]))),A[1]===t.indexes[1]){if(A[0]<C)i=S.children[n];else if(i=b.children[n],!i){l=!0;return}n++,r=i.firstElementChild}h={colIdx:A[1],rowIdx:A[0],cell:M,address:E,row:i,pRow:i.previousSibling,lastCell:A[1]===t.indexes[3],isHeightCheckNeeded:t.direction==="first",first:t.direction==="last"&&!t.skipUpdateOnFirst&&A[1]===t.indexes[1]?"Column":"",checkNextBorder:t.direction==="last"&&A[3]===t.indexes[3]?"Column":"",isRefreshing:t.direction==="first",mergeBorderRows:u},t.direction==="last"?(h.refChild=r,s=e.cellRenderer.render(h),e.checkColMerge(A,t.indexes,s,M,c,((A[0]<C?S:b).rows[n-1]||{cells:[]}).cells[1])):s=e.cellRenderer.render(h),e.parent.scrollSettings.enableVirtualization&&t.direction&&se(i[t.direction+"ElementChild"]),C&&A[0]===I&&(n=0)}}),e.parent.notify(co,{refresh:"Column",prevRowColCnt:t.prevRowColCnt}),md(e.parent,u),c.conditionalFormats&&c.conditionalFormats.length&&e.parent.notify(Gi,{indexes:t.indexes,isRender:!0}),e.parent.allowChart&&e.parent.notify(Id,null),e.parent.isEdit&&e.parent.notify(wd,{}),e.parent.isOpen||e.parent.hideSpinner(),bd(e.parent.getMainContent(),{busy:!1})})},o.prototype.updateRowContent=function(t){var e=this,i=this.parent.getMainContent();if(!(t.direction===""&&!i.children.length)){var r,n,s,a,l,h=[],c=0,u=this.colGroupWidth,d=this.parent.getActiveSheet(),p=i.querySelector("tbody"),f=this.parent.getRowHeaderContent().querySelector("tbody"),v=document.createDocumentFragment(),m=document.createDocumentFragment();this.parent.showSpinner();var y=this.parent.frozenColCount(d),b=this.parent.frozenRowCount(d),S=ce(d,t.indexes[1],!0,"columns"),C=ce(d,y-1,!1,"columns");this.clearCFResult(d),t.cells.forEach(function(x,I){var D=ie(I),M,E;t.direction==="first"&&D[0]===t.indexes[0]&&(M=f.rows[f.rows.length-1],E=p.rows[p.rows.length-1],a===void 0&&(a=(D[1]<y?f:p).rows[t.indexes[2]-t.indexes[0]+1]||null),e.checkRowMerge([e.parent.viewport.topIndex+b,D[1]],t.indexes,(a||{cells:[]}).cells[D[1]<y?c+1:c],Q(e.parent.viewport.topIndex+b,D[1],d)||{},d)),(D[1]===S||!r)&&(D[1]===S&&(n=e.rowRenderer.render(D[0],!0)),y&&D[1]<y?(v.appendChild(n),r=n):(r=e.rowRenderer.render(D[0]),m.appendChild(r),D[1]===S&&v.appendChild(n),e.parent.scrollSettings.enableVirtualization&&t.direction&&se(p[t.direction+"ElementChild"])),D[1]===S&&(e.cellRenderer.renderRowHeader(D[0],n),u=bz(D[0]+1),e.parent.scrollSettings.enableVirtualization&&t.direction&&se(f[t.direction+"ElementChild"]))),y&&(n=v.lastElementChild||n),l={colIdx:D[1],rowIdx:D[2],cell:x,address:I,row:r,lastCell:D[1]===t.indexes[3],pHRow:n.previousSibling||M,checkNextBorder:t.direction==="last"&&D[2]===t.indexes[2]?"Row":"",pRow:r.previousSibling||E,isHeightCheckNeeded:t.direction==="first"||t.direction==="",hRow:n,first:t.direction==="last"&&!t.skipUpdateOnFirst&&D[0]===t.indexes[0]?"Row":"",isRefreshing:t.direction==="first",mergeBorderRows:h},s=e.cellRenderer.render(l),t.direction==="last"&&p.rows.length&&e.checkRowMerge(D,t.indexes,s,x,d,(D[1]<y?f:p).rows[0].cells[D[1]<y?c+1:c]),c++,y&&D[1]===C&&(r=null,a=void 0,c=0)}),this.colGroupWidth!==u&&this.updateLeftColGroup(u),t.direction==="last"?(f.insertBefore(v,f.firstElementChild),p.insertBefore(m,p.firstElementChild)):(f.appendChild(v),p.appendChild(m)),this.parent.scrollSettings.enableVirtualization&&this.parent.notify(co,{refresh:"Row",prevRowColCnt:t.prevRowColCnt}),md(this.parent,h),d.conditionalFormats&&d.conditionalFormats.length&&this.parent.notify(Gi,{indexes:t.indexes,isRender:!0}),this.parent.isEdit&&this.parent.notify(wd,null),this.parent.allowChart&&this.parent.notify(Id,{}),this.parent.isOpen||this.parent.hideSpinner(),bd(this.parent.getMainContent(),{busy:!1})}},o.prototype.checkRowMerge=function(t,e,i,r,n,s){if(this.parent.scrollSettings.enableVirtualization&&i&&(!g(r.rowSpan)||!g(r.colSpan))){var a=this.parent.frozenRowCount(n),l=this.parent.viewport.topIndex+a;if(t[0]===l){if(r.rowSpan<0){var h={td:i,rowIdx:t[0],colIdx:t[1],isRow:!0,isFreezePane:!0};if(this.parent.notify(D0,h),h.insideFreezePane)return;l>=e[2]&&this.refreshPrevMerge(e[2]+1,t[1])}s&&this.refreshFirstCell(t[0]+(e[2]-e[0])+1,t[1],n,s)}else if(r.rowSpan>1){var c=e[2]+1;t[0]+r.rowSpan-1>=c&&t[0]<c&&this.refreshPrevMerge(c,t[1],l)}}},o.prototype.refreshPrevMerge=function(t,e,i){var r=this.parent.getCell(t,e,this.parent.getRow(i||0,null,e));r&&this.cellRenderer.refresh(t,e,null,r)},o.prototype.refreshFirstCell=function(t,e,i,r){var n=Q(t,e,i,!1,!0);(n.rowSpan<0||n.colSpan<0)&&this.cellRenderer.refresh(t,e,null,r)},o.prototype.checkColMerge=function(t,e,i,r,n,s){if(this.parent.scrollSettings.enableVirtualization&&i&&(!g(r.rowSpan)||!g(r.colSpan))){var a=this.parent.frozenColCount(n),l=this.parent.viewport.leftIndex+a;if(t[1]===l){if(r.colSpan<0){var h={td:i,colIdx:t[1],rowIdx:t[0],isFreezePane:!0};if(this.parent.notify(D0,h),h.insideFreezePane)return;if(l>=e[3]){var c=this.parent.getCell(t[0],t[3]+1,this.parent.getRow(t[0],null,t[3]+1));c&&this.cellRenderer.refresh(t[0],e[3]+1,null,c)}}s&&this.refreshFirstCell(t[0],t[1]+(e[3]-e[1])+1,n,s)}else if(r.colSpan>1&&t[1]+r.colSpan-1>=e[3]+1&&t[1]<e[3]+1){var c=this.parent.getCell(t[0],t[3]+1,this.parent.getRow(t[0],null,t[3]+1));c&&this.cellRenderer.refresh(t[0],e[3]+1,null,c)}}},o.prototype.toggleGridlines=function(){var t=document.getElementById(this.parent.element.id+"_sheet");this.parent.getActiveSheet().showGridLines?t.classList.remove("e-hide-gridlines"):t.classList.add("e-hide-gridlines")},o.prototype.showHideHeaders=function(){var t=this,e=this.parent.getActiveSheet();er(function(){var i=document.getElementById(t.parent.element.id+"_sheet");if(i)if(e.showHeaders){var r=t.getContentPanel();t.setPanelWidth(e,t.getRowHeaderPanel()),t.setPanelHeight(e),i.classList.remove("e-hide-headers"),t.getColHeaderPanel().scrollLeft=r.scrollLeft,t.parent.selectRange(e.selectedRange)}else t.updateHideHeaders(e,i),t.setPanelHeight(e),t.parent.frozenColCount(e)||t.parent.frozenRowCount(e)?(t.setPanelWidth(e,t.getRowHeaderPanel()),t.parent.selectRange(e.selectedRange)):(t.getContentPanel().style.width="",t.getContentPanel().style[t.parent.enableRtl?"right":"left"]=""),t.getScrollElement().style.left=t.getRowHeaderWidth(e)+"px"})},o.prototype.updateHideHeaders=function(t,e){t.showHeaders||e.classList.add("e-hide-headers")},o.prototype.rowHeightChanged=function(t){if(t.threshold||t.isHideShow){var e=this.parent.getActiveSheet();t.rowIdx<this.parent.frozenRowCount(e)&&this.setPanelHeight(e)}},o.prototype.colWidthChanged=function(t){if(t.threshold||t.isHideShow){var e=this.parent.getActiveSheet();t.colIdx<this.parent.frozenColCount(e)&&this.setPanelWidth(e,this.getRowHeaderPanel()),this.checkTableWidth(e)}},o.prototype.getRowHeaderWidth=function(t,e,i){var r=0,n=i?this.parent.viewport.scaleX:1;if(!e&&t.frozenColumns){var s=xe(t.topLeftCell)[1];r=wi(t,s,s+t.frozenColumns-1,!0)/n}return r+=t.showHeaders?zr(this.colGroupWidth)/n:0,r},o.prototype.getColHeaderHeight=function(t,e){var i=xe(t.topLeftCell)[0];return(t.showHeaders&&!e?zr(31):0)+xi(t,i,i+t.frozenRows-1,!0)},o.prototype.getSelectAllContent=function(){return this.headerPanel.getElementsByClassName("e-selectall-container")[0]},o.prototype.getScrollElement=function(){var t;return this.contentPanel&&(t=this.contentPanel.parentElement||this.contentPanel.nextElementSibling),t&&t.querySelector(".e-scroller")},o.prototype.getSelectAllTable=function(){return this.headerPanel.getElementsByClassName("e-selectall-table")[0]},o.prototype.getColHeaderTable=function(){return this.headerPanel.getElementsByClassName("e-colhdr-table")[0]},o.prototype.getRowHeaderTable=function(){return this.contentPanel.getElementsByClassName("e-rowhdr-table")[0]},o.prototype.getContentTable=function(){return this.contentPanel.getElementsByClassName("e-content-table")[0]},o.prototype.getRowHeaderPanel=function(){return this.contentPanel.getElementsByClassName("e-row-header")[0]},o.prototype.getColHeaderPanel=function(){return this.headerPanel.getElementsByClassName("e-column-header")[0]},o.prototype.getContentPanel=function(){return this.contentPanel.getElementsByClassName("e-sheet-content")[0]},o.prototype.addEventListener=function(){this.parent.on(fM,this.triggerCreatedEvent,this),this.parent.on(Fn,this.rowHeightChanged,this),this.parent.on(Qn,this.colWidthChanged,this),this.parent.on(Xn,this.removeEventListener,this)},o.prototype.destroy=function(){this.headerPanel&&(lo(this.headerPanel),this.headerPanel.remove()),this.headerPanel=null,this.contentPanel&&(lo(this.contentPanel),this.contentPanel.remove()),this.contentPanel=null,this.col&&(lo(this.col),this.col.remove()),this.col=null,this.rowRenderer=null,this.cellRenderer=null,this.colGroupWidth=null,this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(fM,this.triggerCreatedEvent),this.parent.off(Fn,this.rowHeightChanged),this.parent.off(Qn,this.colWidthChanged),this.parent.off(Xn,this.removeEventListener)},o})(),N9=(function(){function o(t){this.parent=t,this.element=this.parent.createElement("tr"),this.cellRenderer=t.serviceLocator.getService("cell"),this.parent.on(nu,this.initProps,this)}return o.prototype.render=function(t,e,i){var r=this.element.cloneNode(),n=this.parent.getActiveSheet();if(t===void 0)return r.classList.add("e-header-row"),r;if(r.classList.add("e-row"),!this.bottomBorderWidth){var s=1;if(window.devicePixelRatio%1>0){var a=1*window.devicePixelRatio%1;s=1+(a?(a>.5?1-a:-1*a)/window.devicePixelRatio:0)}this.bottomBorderWidth=s}var l=ei(n,t,!0),h=ei(n,t),c={height:l+"px",lineHeight:h<20?l>this.bottomBorderWidth?l-this.bottomBorderWidth+"px":"0px":""};if(Object.assign(r.style,c),Ee(r,{"aria-rowindex":(t+1).toString()}),e&&!i){if(h<20){var s=4+(this.bottomBorderWidth-1);r.style.lineHeight=l>=s?l-s+"px":l>this.bottomBorderWidth?l-this.bottomBorderWidth+"px":"0px",r.classList.contains("e-reach-fntsize")||r.classList.add("e-reach-fntsize")}lt(n,t+1)&&!lt(n,t-1)&&r.classList.add("e-hide-start"),t!==0&&lt(n,t-1)&&!lt(n,t+1)&&r.classList.add("e-hide-end")}return r},o.prototype.refresh=function(t,e,i,r,n){var s=this,a=this.parent.getActiveSheet(),l;if(r)l=this.render(t,r,n),this.cellRenderer.renderRowHeader(t,l);else{var h,c,u=function(){for(;h<=c;)Ft(a,h)||s.cellRenderer.render({colIdx:h,rowIdx:t,cell:Q(t,h,a),address:st(t,h),lastCell:h===c,row:l,hRow:i,isHeightCheckNeeded:!0,pRow:e,first:t===s.parent.viewport.topIndex&&ce(a,t,!0)!==ce(a,0,!0)?"Row":"",skipFormatCheck:xs(s.parent),checkCF:!0}),h++},d=this.parent.frozenColCount(a);d&&(l=i,h=xe(a.topLeftCell)[0],c=d-1,u()),l=this.render(t,r,n),h=this.parent.viewport.leftIndex+d,c=this.parent.viewport.rightIndex,u()}return l},o.prototype.initProps=function(){this.bottomBorderWidth=null},o.prototype.destroy=function(){this.parent.off(nu,this.initProps),this.element&&this.element.remove(),this.bottomBorderWidth&&(this.bottomBorderWidth=null),this.parent=null,this.element=null},o})(),k9=(function(){function o(t){this.parent=t,this.element=this.parent.createElement("td"),this.th=this.parent.createElement("th",{className:"e-header-cell"}),this.tableRow=t.createElement("tr",{className:"e-row"}),this.parent.on(_d,this.updateView,this),this.parent.on(zl,this.calculateFormula,this)}return o.prototype.renderColHeader=function(t,e,i){var r=this.th.cloneNode(),n=ji(t+1);r.innerText=n;var s=this.parent.getActiveSheet();Ft(s,t+1)&&r.classList.add("e-hide-start"),t!==0&&Ft(s,t-1)&&r.classList.add("e-hide-end"),i?e.insertBefore(r,i):e.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:n,colIndex:t}),this.parent.notify(Cd,{td:r,rowIndex:0,colIndex:t}),Ee(r,{"aria-colindex":(t+1).toString(),tabindex:"-1"})},o.prototype.renderRowHeader=function(t,e,i){var r=this.element.cloneNode();X([r],"e-header-cell"),Ee(r,{role:"rowheader",tabindex:"-1"}),r.innerText=(t+1).toString(),i?e.insertBefore(r,i):e.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:""+(t+1),rowIndex:t})},o.prototype.render=function(t){var e=this.parent.getActiveSheet();if(t.td=this.element.cloneNode(),t.td.className="e-cell",Ee(t.td,{"aria-colindex":(t.colIdx+1).toString(),tabindex:"-1"}),this.checkMerged(t))return this.createImageAndChart(t),t.refChild?t.row.insertBefore(t.td,t.refChild):t.row.appendChild(t.td),t.td;t.isRefresh=!1,t.skipFormatCheck=xs(this.parent);var i=this.update(t);if(t.checkCF&&t.cell&&e.conditionalFormats&&e.conditionalFormats.length&&this.parent.notify(Gi,{indexes:[t.rowIdx,t.colIdx],cell:t.cell,ele:t.td,isRender:!0}),t.td.classList.contains("e-cell-template")||this.parent.notify(Cd,{td:t.td,rowIndex:t.rowIdx,colIndex:t.colIdx}),t.refChild?t.row.insertBefore(t.td,t.refChild):t.row.appendChild(t.td),this.parent.enableRtl&&(!t.cell||!t.cell.style||!t.cell.style.borderRight||t.cell.style.borderRight!=="none")){var r=Q(t.rowIdx,t.colIdx-1,e);if(r&&r.style&&r.style.borderLeft){var n=this.parent.getCell(t.rowIdx,t.colIdx-1),s=Object.assign({},t,{cell:r,colIdx:t.colIdx-1,td:n,prevCell:t.td,style:{borderLeft:r.style.borderLeft}});this.parent.notify(Mr,s)}}var a={cell:t.cell,element:t.td,address:t.address,rowIndex:t.rowIdx,colIndex:t.colIdx,needHeightCheck:!1,row:t.row};if(this.parent.trigger("beforeCellRender",a),!e.rows[t.rowIdx]||!e.rows[t.rowIdx].customHeight){if(a.needHeightCheck||i&&a.element&&a.element.children.length){var l=a.element.cloneNode(!0);l.style.width=qr(e,t.colIdx,!0)+"px",this.tableRow.appendChild(l)}if(t.lastCell&&this.tableRow.childElementCount){var h=this.getRowHeightOnInit();h>ei(e,t.rowIdx)&&Na(this.parent,e,h,t.rowIdx,t.row,t.hRow),this.tableRow.innerText=""}}return this.setWrapByValue(e,t),a.element},o.prototype.setWrapByValue=function(t,e){e.cell&&g(e.cell.wrap)&&e.cell.value&&e.cell.value.toString().includes(`
`)&&(Zt(e.rowIdx,e.colIdx,t,{wrap:!0},!0),this.parent.notify(sa,{range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx],wrap:!0,initial:!0,sheet:t,td:e.td,row:e.row,hRow:e.hRow}))},o.prototype.update=function(t){var e=this.parent.getActiveSheet(),i;if(!t.isRefresh||t.cell&&t.cell.template){var r=this.processTemplates(t.cell,t.rowIdx,t.colIdx);r&&(typeof r=="string"?t.td.innerHTML=r:(lo(t.td),bt(r,t.td)),t.td.classList.add("e-cell-template"),i=!0)}if(t.isRefresh){if(t.td.rowSpan&&(this.mergeFreezeRow(e,t.rowIdx,t.colIdx,t.td.rowSpan,t.row,!0),t.td.removeAttribute("rowSpan")),t.td.colSpan&&(this.mergeFreezeCol(e,t.rowIdx,t.colIdx,t.td.colSpan,!0),t.td.removeAttribute("colSpan")),this.checkMerged(t))return!1;if(t.cell&&!t.cell.hyperlink){var n=t.td.querySelector(".e-hyperlink");n&&se(n)}if(t.cell&&t.td.children.length>0&&t.td.children[t.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1){var s=t.td.querySelector(".e-addNoteIndicator");s&&se(s)}(!t.cell||!this.parent.allowWrap)&&t.td.classList.contains("e-wraptext")&&t.td.classList.remove("e-wraptext")}t.cell&&t.cell.formula&&!t.isRandomFormula&&this.parent.calculationMode==="Automatic"&&(this.calculateFormula(t),t.fillType&&t.fillType==="FillWithoutFormatting"&&delete t.cell.format,t.isRefresh||(this.isFormulaCell=!0));var a={value:t.cell&&t.cell.value,type:t.cell&&en(t.cell.format),format:t.cell&&t.cell.format,formattedText:t.cell&&t.cell.value,isRightAlign:!1,cell:t.cell,rowIndex:t.rowIdx,colIndex:t.colIdx,td:t.td,skipFormatCheck:t.skipFormatCheck,refresh:!0};this.parent.calculationMode==="Manual"&&t.cell&&!t.cell.value&&t.cell.value!==""&&t.cell.formula&&(a.value=0,t.cell.value="0"),t.cell&&this.parent.notify(yr,a),this.parent.refreshNode(t.td,a);var l={};if(t.cell){if(t.cell.style&&(t.cell.style.properties?l=eE(t.cell.style,!0):l=t.cell.style),a.color!==void 0&&(l=Object.assign({},l),l.color=a.color),this.createImageAndChart(t),t.cell.hyperlink&&(t.fillType==="FillFormattingOnly"?(t.td.style.textDecoration="underline",t.td.style.color="#00e"):this.parent.notify(f0,{cell:t.cell,style:l,td:t.td,rowIdx:t.rowIdx,colIdx:t.colIdx,fillType:t.fillType,action:t.action})),this.parent.allowMerge){if(t.cell.rowSpan>1){var h=t.rowSpan||t.cell.rowSpan-this.parent.hiddenCount(t.rowIdx,t.rowIdx+(t.cell.rowSpan-1));h>1&&(t.td.rowSpan=h,this.mergeFreezeRow(e,t.rowIdx,t.colIdx,h,t.row))}if(t.cell.colSpan>1){var c=t.colSpan||t.cell.colSpan-this.parent.hiddenCount(t.colIdx,t.colIdx+(t.cell.colSpan-1),"columns");c>1&&(t.td.colSpan=c,this.mergeFreezeCol(e,t.rowIdx,t.colIdx,c))}}!g(t.cell.notes)&&!t.fillType?this.parent.notify(Zd,{targetElement:t.td,rowIndex:t.rowIdx,columnIndex:t.colIdx}):!g(t.td)&&t.td.children.length>0&&t.td.children[t.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&this.parent.notify(kg,{rowIndex:t.rowIdx,columnIndex:t.colIdx}),t.cell.isNoteEditable&&this.parent.notify(Ld,{rowIndex:t.rowIdx,columnIndex:t.colIdx,isNoteEditable:!0,isScrollWithNote:!0,cellElement:t.td})}if(t.isRefresh&&g(t.cell)&&!g(t.td)&&t.td.children.length>0&&t.td.children[t.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&this.parent.notify(kg,{rowIndex:t.rowIdx,columnIndex:t.colIdx}),t.isRefresh&&this.removeStyle(t.td,t.rowIdx,t.colIdx),t.lastCell&&(this.isFormulaCell||t.isRefresh)&&this.parent.chartColl&&this.parent.chartColl.length&&(this.parent.notify(Xo,{cell:t.cell,rIdx:t.rowIdx,cIdx:t.colIdx,sheetIdx:this.parent.activeSheetIndex,isSelectAll:t.isSelectAll}),t.isRefresh||(this.isFormulaCell=!1)),this.applyStyle(t,l),t.checkNextBorder==="Row"){var u=this.parent.getCellStyleValue(["borderTop"],[Number(this.parent.getContentTable().rows[0].getAttribute("aria-rowindex"))-1,t.colIdx]).borderTop;u!==""&&(!t.cell||!t.cell.style||!t.cell.style.bottomPriority)&&(t.style={borderBottom:u},this.parent.notify(Mr,t))}if(t.checkNextBorder==="Column"){var d=this.parent.getCellStyleValue(["borderLeft"],[t.rowIdx,t.colIdx+1]).borderLeft;d!==""&&(!t.cell||!t.cell.style||!t.cell.style.borderRight&&!t.cell.style.border)&&(t.style={borderRight:d},this.parent.notify(Mr,t))}t.cell&&!g(t.cell.wrap)&&this.parent.notify(sa,{range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx],wrap:t.cell.wrap,sheet:e,initial:!0,td:t.td,row:t.row,hRow:t.hRow,isCustomHgt:!t.isRefresh&&ei(e,t.rowIdx)>(e&&e.standardHeight?e.standardHeight:20)});var p,f;return t.cell&&t.cell.validation?(p=t.cell.validation,f=e.columns&&e.columns[t.colIdx]):p=hs(e.columns&&e.columns[t.colIdx],t.rowIdx,t.colIdx)&&e.columns[t.colIdx].validation,p&&(p.isHighlighted&&(t.validation=p,t.col=f,this.parent.notify(Rh,t)),p.type==="List"&&!t.isRefresh&&t.address===e.activeCell&&(t.validation=p,this.parent.notify(Yd,t))),i},o.prototype.applyStyle=function(t,e){(Object.keys(e).length||Object.keys(this.parent.commonCellStyle).length||t.lastCell)&&(t.style=pe({},this.parent.commonCellStyle,e),this.parent.notify(Mr,t))},o.prototype.createImageAndChart=function(t){if(t.cell.chart&&t.cell.chart.length>0&&this.parent.notify(jh,{chart:t.cell.chart,isInitCell:!0,range:st(t.rowIdx,t.colIdx),isUndoRedo:!1}),t.cell.image&&t.cell.image.length>0)for(var e=0;e<t.cell.image.length;e++)t.cell.image[e]&&this.parent.notify(go,{options:{src:t.cell.image[e].src,id:t.cell.image[e].id,height:t.cell.image[e].height,width:t.cell.image[e].width,top:t.cell.image[e].top,left:t.cell.image[e].left,preservePos:t.cell.image[e].preservePos},range:Ve([t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]),isPublic:!1})},o.prototype.calculateFormula=function(t){if(t.cell.value!==void 0&&t.cell.value!==null){var e={action:"checkFormulaAdded",added:!0,address:t.address,sheetId:(t.sheetIndex===void 0?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex)).id.toString()};if(this.parent.notify(At,e),e.added)return}else t.formulaRefresh&&(t.cell.value="");var i=pt(t.cell.formula),r={action:"refreshCalculate",value:t.cell.formula,rowIndex:t.rowIdx,colIndex:t.colIdx,isFormula:i,sheetIndex:t.sheetIndex,isRefreshing:t.isRefreshing,isDependentRefresh:t.isDependentRefresh,isRandomFormula:t.isRandomFormula,fillType:t.fillType};(this.parent.calculationMode==="Automatic"||t.isSortAction||t.action==="calculate"||t.isDependentRefresh)&&this.parent.notify(At,r),(t.cell.value===void 0&&this.parent.calculationMode==="Manual"&&!this.parent.getActiveSheet().isSheetCalculated||this.parent.isEdit&&t.cell.value==="#CIRCULARREF!")&&(t.cell.value="0"),t.cell.value=Q(t.rowIdx,t.colIdx,g(t.sheetIndex)?this.parent.getActiveSheet():ke(this.parent,t.sheetIndex)).value,i&&(t.cell.formula.indexOf("^+")>-1||t.cell.formula.indexOf("&+")>-1)&&(t.cell.formula=r.value)},o.prototype.checkMerged=function(t){if(this.parent.allowMerge&&t.cell&&(t.cell.colSpan<0||t.cell.rowSpan<0)){var e=this.parent.getActiveSheet();if(e.frozenRows||e.frozenColumns){var i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};this.parent.notify(pr,i);var r=this.parent.frozenRowCount(e),n=this.parent.frozenColCount(e),s=void 0;i.range=i.range,e.frozenRows&&e.frozenColumns?i.range[0]<r&&i.range[1]<n?s=t.rowIdx<r&&t.colIdx<n:i.range[0]<r?s=t.rowIdx<r:i.range[1]<n?s=t.colIdx<n:s=!0:s=r?i.range[0]>=r||t.rowIdx<r:i.range[1]>=n||t.colIdx<n,s&&(t.td.style.display="none")}else t.td.style.display="none";t.isMerged=!0;var a=t.cell.rowSpan,l=t.cell.colSpan;return(l<0||a<0)&&(this.parent.notify(CD,t),l<0&&t.cell.style&&t.cell.style.borderTop&&this.applyStyle(t,{borderTop:t.cell.style.borderTop}),a<0&&t.cell.style&&t.cell.style.borderLeft&&this.applyStyle(t,{borderLeft:t.cell.style.borderLeft})),t.isMerged}return!1},o.prototype.mergeFreezeRow=function(t,e,i,r,n,s){var a=this.parent.frozenRowCount(t);if(a&&e<a&&e+(r-1)>=a){var l=void 0,h=0,c=void 0,u=this.parent.frozenColCount(t),d=n||this.parent.getRow(e,null,i),p=[].slice.call(d.parentElement.querySelectorAll(".e-empty"));if(s){var f=e+r-a;if(f<p.length)return;var v=0;if(f===p.length){var m=void 0,y=void 0,b=void 0;for(u&&i<u?(y=xe(t.topLeftCell)[1],b=u):(y=this.parent.viewport.leftIndex+u,b=this.parent.viewport.rightIndex),y;y<b;y++)y!==i&&(m=Q(e,y,t,!1,!0),m.rowSpan&&e+m.rowSpan-a>v&&(v=e+m.rowSpan-a));if(v===f)return}else v=f;for(var S=e+(r-1),y=v,b=p.length;y<b;y++)h+=ei(t,S),S--,se(p.pop());this.updateSpanTop(i,u,h,!0),p.length||this.updateColZIndex(i,u,!0);return}this.updateColZIndex(i,u);for(var y=a,b=e+(r-1);y<=b;y++)c=ei(t,ce(t,y,!0),!0),h+=-c,!(a+p.length>y)&&(l=d.cloneNode(),l.classList.add("e-empty"),l.style.visibility="hidden",l.style.height=c+"px",d.parentElement.appendChild(l));this.updateSpanTop(i,u,h)}},o.prototype.updateSpanTop=function(t,e,i,r){var n=this.parent.serviceLocator.getService("sheet").contentPanel;if(r){if(!parseInt(n.style.top,10))return;i=parseInt(n.style.top,10)+i}if(e&&t<e&&(r||!parseInt(n.style.top,10)||i<parseInt(n.style.top,10))){n.style.top=i+"px";var s=n.nextElementSibling;s&&(s.style.top=i+"px")}},o.prototype.mergeFreezeCol=function(t,e,i,r,n){var s=this.parent.frozenColCount(t);if(s&&i<s&&i+(r-1)>=s){var a=void 0,l=void 0,h=this.parent.frozenRowCount(t),c=(e<h?this.parent.getSelectAllContent():this.parent.getRowHeaderContent()).querySelector("colgroup"),u=[].slice.call(c.querySelectorAll(".e-empty"));if(n){var d=i+r-s;if(d<u.length)return;var p=0;if(d===u.length){var f=void 0,v=void 0,m=void 0;for(h&&e<h?(v=h,m=xe(t.topLeftCell)[0]):(v=this.parent.viewport.bottomIndex,m=this.parent.viewport.topIndex+h),m;m<v;m++)m!==e&&(f=Q(m,i,t,!1,!0),f.colSpan&&i+f.colSpan-s>p&&(p=i+f.colSpan-s));if(p===d)return}else p=d;for(var m=p,v=u.length;m<v;m++)se(u.pop());this.parent.serviceLocator.getService("sheet").setPanelWidth(t,this.parent.getRowHeaderContent()),u.length||this.updateRowZIndex(e,h,!0);return}this.updateRowZIndex(e,h);for(var m=s,v=i+(r-1);m<=v;m++)s+u.length>m||(a=c.childNodes[0].cloneNode(),a.classList.add("e-empty"),a.style.visibility="hidden",l=qr(t,ce(t,m,!0,"columns"),null,!0),a.style.width=l+"px",c.appendChild(a),m===v&&this.parent.serviceLocator.getService("sheet").setPanelWidth(t,this.parent.getRowHeaderContent()))}},o.prototype.updateColZIndex=function(t,e,i){t<e?this.updateSelectAllZIndex(i):(this.parent.getColumnHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.updateSelectAllZIndex=function(t){var e=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");if(t)this.parent.getSelectAllContent().style.zIndex="",e&&(e.style.zIndex=""),i&&(i.style.zIndex="");else{var r=this.parent.getRowHeaderContent(),n=this.parent.getColumnHeaderContent();if(r.style.zIndex||n.style.zIndex){this.parent.getSelectAllContent().style.zIndex="3",e&&(e.style.zIndex="4"),i&&(i.style.zIndex="4");var s=r.querySelector(".e-selection");s&&(s.style.zIndex="3");var a=n.querySelector(".e-selection");a&&(a.style.zIndex="3")}else this.parent.getSelectAllContent().style.zIndex="2"}},o.prototype.updatedHeaderZIndex=function(t){if(!t&&this.parent.getSelectAllContent().style.zIndex==="2"){this.parent.getSelectAllContent().style.zIndex="3";var e=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");i&&(i.style.zIndex="4"),e&&(e.style.zIndex="4");var r=this.parent.getRowHeaderContent().querySelector(".e-selection");r&&(r.style.zIndex="3");var n=this.parent.getColumnHeaderContent().querySelector(".e-selection");n&&(n.style.zIndex="3")}},o.prototype.updateRowZIndex=function(t,e,i){t<e?this.updateSelectAllZIndex(i):(this.parent.getRowHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.processTemplates=function(t,e,i){for(var r=this.parent.getActiveSheet(),n=r.ranges,s,a=0,l=n.length;a<l;a++)if(n[a].template&&(s=ie(n[a].address.length?n[a].address:n[a].startCell),s[0]<=e&&s[1]<=i&&s[2]>=e&&s[3]>=i)){if(t)return this.compileCellTemplate(n[a].template,Object.assign({rowIndex:e,colIndex:i},t));if(!Q(e,i,r,!0))return this.compileCellTemplate(n[a].template,Object.assign({rowIndex:e,colIndex:i},Q(e,i,r,null,!0)))}return""},o.prototype.compileCellTemplate=function(t,e){var i;if(typeof t=="string"){var r=void 0;return t.trim().indexOf("#")===0?r=document.querySelector(t).innerHTML.trim():r=t,i=Et(r),!this.parent.isVue||this.isSelector(t)?i(e,this.parent,"ranges","",!0)[0].outerHTML:i(e,this.parent,"ranges","")}else{i=Et(t);var n=i(e,this.parent,"ranges","");return n[0]?n:[n]}},o.prototype.isSelector=function(t){try{return!!document.querySelector(t)}catch{return!1}},o.prototype.getRowHeightOnInit=function(){var t=this.parent.createElement("table",{className:"e-table e-test-table"}),e=t.appendChild(this.parent.createElement("tbody"));e.appendChild(this.tableRow),this.parent.element.appendChild(t);var i=this.tableRow.getBoundingClientRect().height;return this.parent.element.removeChild(t),i<20?20:i},o.prototype.removeStyle=function(t,e,i){var r;if(t.style.length){r=this.parent.getCellStyleValue(["borderLeft","border"],[e,i+1]);var n=r.borderLeft||r.border;r=this.parent.getCellStyleValue(["borderTop","border"],[e+1,i]);var s=r.borderTop||r.border;n||s?[].slice.call(t.style).forEach(function(c){n&&s?!c.includes("border-right")&&!c.includes("border-bottom")&&t.style.removeProperty(c):(n&&!(c.indexOf("border-right")>-1)&&(!s||s==="none")||s&&!(c.indexOf("border-bottom")>-1)&&(!n||n==="none"))&&t.style.removeProperty(c)}):t.removeAttribute("style")}var a=this.parent.getCell(e-1,i);if(a&&a.style.borderBottom){var l=Number(a.parentElement.getAttribute("aria-rowindex"))-1;r=this.parent.getCellStyleValue(["borderBottom","border"],[l,i]),r.borderBottom||r.border||(a.style.borderBottom="")}var h=t.previousElementSibling;h&&h.style.borderRight&&(i=Number(h.getAttribute("aria-colindex"))-1,r=this.parent.getCellStyleValue(["borderRight","border"],[e,i]),r.borderRight||r.border||(h.style.borderRight=""))},o.prototype.refreshRange=function(t,e,i,r,n,s,a,l,h,c,u,d){h===void 0&&(h=!0);var p=this.parent.getActiveSheet(),f=t.slice(),v,m;if(WD(this.parent,f,!0)){for(var y=0,b=f[0];b<=f[2];b++)if(!lt(p,b))for(var S=f[1];S<=f[3];S++)Ft(p,S)||(m=this.parent.getCell(b,S),m&&(v={rowIdx:b,colIdx:S,td:m,cell:Q(b,S,p),isRefreshing:e,lastCell:S===f[3],isRefresh:!0,isHeightCheckNeeded:h,manualUpdate:!0,first:"",onActionUpdate:r,skipFormatCheck:s,isFromAutoFillOption:l,isSelectAll:u,rowHeight:d&&d[y]&&d[y].rowHeight},y++,a&&(v.address=st(b,S)),this.update(v),n&&p.conditionalFormats&&p.conditionalFormats.length&&this.parent.notify(Gi,{indexes:[b,S],isAction:!0}),this.parent.notify(Cd,{td:m,rowIndex:b,colIndex:S}),i&&this.setWrapByValue(p,v)),this.parent.calculationMode==="Manual"&&c&&(m?v.isSortAction=c:v={rowIdx:b,colIdx:S,td:m,cell:Q(b,S,p),isRefreshing:e,lastCell:S===f[3],isRefresh:!0,isHeightCheckNeeded:h,manualUpdate:!0,first:"",onActionUpdate:r,skipFormatCheck:s,isFromAutoFillOption:l,isSortAction:c},v.cell&&v.cell.formula&&p.isSheetCalculated&&this.calculateFormula(v)))}},o.prototype.refresh=function(t,e,i,r,n,s,a,l,h){var c=this.parent.getActiveSheet();if(!(!r&&(lt(c,t)||Ft(c,e)))&&(r||!this.parent.scrollSettings.enableVirtualization||this.parent.insideViewport(t,e))){var u=r||this.parent.getCell(t,e);if(!u)return;var d={rowIdx:t,colIdx:e,td:u,cell:Q(t,e,c),isRefresh:!0,lastCell:i,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",skipFormatCheck:a,isRandomFormula:l,fillType:h};this.update(d),n&&c.conditionalFormats&&c.conditionalFormats.length&&this.parent.notify(Gi,{indexes:[t,e],isAction:!0}),this.parent.notify(Cd,{td:u,rowIndex:t,colIndex:e}),s&&this.setWrapByValue(c,d)}},o.prototype.updateView=function(t){if(g(t.sheetIndex)||t.sheetIndex===this.parent.activeSheetIndex){if(!t.indexes){var e=this.parent.getActiveSheet(),i=this.parent.frozenRowCount(e),r=this.parent.frozenColCount(e),n=ie(e.topLeftCell);i&&r&&this.refreshRange([n[0],n[1],i-1,r-1],t.refreshing,t.checkWrap,!1,t.checkCF),i&&this.refreshRange([n[0],this.parent.viewport.leftIndex+r,i-1,this.parent.viewport.rightIndex],t.refreshing,t.checkWrap,!1,t.checkCF),r&&this.refreshRange([this.parent.viewport.topIndex+i,n[1],this.parent.viewport.bottomIndex,r-1],t.refreshing,t.checkWrap,!1,t.checkCF),t.indexes=[this.parent.viewport.topIndex+i,this.parent.viewport.leftIndex+r,this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex]}this.refreshRange(t.indexes,t.refreshing,t.checkWrap,!1,t.checkCF)}else t.refreshing&&this.calculateFormula({cell:Q(t.indexes[0],t.indexes[1],ke(this.parent,t.sheetIndex),!0,!0),rowIdx:t.indexes[0],colIdx:t.indexes[1],sheetIndex:t.sheetIndex})},o.prototype.destroy=function(){this.parent.off(_d,this.updateView),this.parent.off(zl,this.calculateFormula),this.element&&this.element.remove(),this.element=null,this.th&&this.th.remove(),this.th=null,this.tableRow&&this.tableRow.remove(),this.tableRow=null,this.parent=null},o})(),F9=(function(){function o(t){this.parent=t,this.addEventListener(),this.instantiateRenderer()}return o.prototype.render=function(){this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),this.parent.isMobileView()||(this.parent.notify(Fl,null),this.parent.notify(Tg,null));var t=this.parent.createElement("div",{id:this.parent.element.id+"_sheet_panel",className:"e-sheet-panel"});this.parent.enableRtl&&t.classList.add("e-rtl"),this.parent.element.appendChild(t),this.parent.showSheetTabs?this.parent.notify(o0,null):(this.parent.notify(At,{action:"initSheetInfo"}),this.parent.notify(At,{action:"initiateDefinedNames"})),this.parent.isMobileView()&&(this.parent.notify(Tg,null),this.parent.notify(Fl,null)),this.parent.password&&(this.parent.password.length>0||this.parent.isProtected)&&(this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"))),this.parent.selectionSettings.mode==="None"&&(this.parent.allowAutoFill=!1),this.setSheetPanelSize(),this.renderSheet(t),this.checkTopLeftCell(!this.parent.refreshing)},o.prototype.checkTopLeftCell=function(t,e,i,r,n,s){var a=this.parent.getActiveSheet();this.parent.showSpinner();var l=a.topLeftCell==="A1",h=xe(a.topLeftCell),c;if(a.topLeftCell!==a.paneTopLeftCell&&(a.frozenRows||a.frozenColumns)){var u=xe(a.paneTopLeftCell);c=this.parent.scrollSettings.enableVirtualization,l=a.frozenRows&&a.frozenColumns?h[0]+a.frozenRows===u[0]&&h[1]+a.frozenColumns===u[1]:a.frozenRows?h[0]+a.frozenRows===u[0]&&h[1]===0:h[1]+a.frozenColumns===u[1]&&h[0]===0,h[0]&&u[0]>h[0]?this.parent.viewport.beforeFreezeHeight=xi(a,0,h[0]-1,!0):this.parent.viewport.beforeFreezeHeight=0,h[1]&&u[1]>h[1]?this.parent.viewport.beforeFreezeWidth=wi(a,0,h[1]-1,!0):this.parent.viewport.beforeFreezeWidth=0}else this.parent.viewport.beforeFreezeHeight=this.parent.viewport.beforeFreezeWidth=0;var d=this.parent.frozenRowCount(a),p=this.parent.frozenColCount(a);if(!this.parent.scrollSettings.enableVirtualization||l)this.refreshUI({rowIndex:h[0],colIndex:h[1],refresh:"All"},null,t,e,n,s),c&&(this.parent.viewport.topIndex=ce(a,d,!0)-d,this.parent.viewport.leftIndex=ce(a,p,!0,"columns")-p);else{var f=a.paneTopLeftCell===a.topLeftCell?h:xe(a.paneTopLeftCell),v={preventScroll:!0};v.scrollTop=i||(f[0]>d?xi(a,d,f[0]-1,!0):0),v.scrollLeft=r||(f[1]>p?wi(a,p,f[1]-1,!0):0),this.parent.notify(lD,v);var m=this.parent.getThreshold("row"),y=a.frozenRows?h[0]:h[0]>m?ce(a,h[0]-m,!0):0,b=[];a.frozenRows&&b.push(f[0]-m>d?f[0]-m:d),m=this.parent.getThreshold("col");var S=a.frozenColumns?h[1]:h[1]>m?ce(a,h[1]-m,!0,"columns"):0;a.frozenColumns?(b.length||b.push(d),b.push(f[1]-m>p?f[1]-m:p)):b.length&&b.push(p),this.refreshUI({rowIndex:y,colIndex:S,refresh:"All",top:v.scrollTop,left:v.scrollLeft,frozenIndexes:b},null,t,e,n,s),c&&(d&&b[0]>=d&&(this.parent.viewport.topIndex=ce(a,b[0],!0)-d),p&&b[1]>=p&&(this.parent.viewport.leftIndex=ce(a,b[1],!0,"columns")-p))}},o.prototype.renderSheet=function(t){t===void 0&&(t=document.getElementById(this.parent.element.id+"_sheet_panel")),t.appendChild(this.parent.createElement("div",{className:"e-sheet",id:this.parent.element.id+"_sheet",styles:"background-color: #fff"})),this.parent.serviceLocator.getService("sheet").renderPanel()},o.prototype.refreshUI=function(t,e,i,r,n,s){var a=this;t.refresh!=="All"&&this.parent.showSpinner();var l=this.parent.serviceLocator.getService("sheet"),h=this.parent.getActiveSheet(),c=Gn(this.parent),u={rowCount:h.rowCount,colCount:h.colCount};if(t.frozenIndexes=t.frozenIndexes?t.frozenIndexes:[],!e)if(this.parent.scrollSettings.enableVirtualization){var d=t.rowIndex+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,p=t.colIndex+this.parent.viewport.colCount+this.parent.getThreshold("col")*2,f=this.parent.frozenRowCount(h),v=this.parent.frozenColCount(h);t.frozenIndexes.length&&(d+=t.frozenIndexes[0]-f,p+=t.frozenIndexes[1]-v),t.refresh==="Row"?d+=f:d+=h.frozenRows,t.refresh==="Column"?p+=v:p+=h.frozenColumns;var m=t.frozenIndexes[0]>f?t.frozenIndexes[0]:t.rowIndex+(t.refresh==="Row"?f:h.frozenRows),y=this.parent.skipHidden(m,d,"rows",!1);if(d=y[1],m!==y[0]){var b=xe(h.paneTopLeftCell);b[0]===m&&this.parent.updateTopLeftCell(y[0]-f,b[1],"col")}y[0]-=f;var S=h.rowCount-1,C=0,x=t.rowIndex;if(this.parent.scrollSettings.isFinite&&d>S&&(C=d-S,d=ce(h,S,!1),y[0]+f>ce(h,f,!0))){var I=t.rowIndex-C;I=I<0?0:I,I=this.decreaseHidden(I,t.rowIndex-1,f),t.top&&I<t.rowIndex&&this.parent.notify(qc,{height:xi(h,I+f,t.rowIndex-1+f,!0),isRender:!0}),this.parent.viewport.topIndex=y[0]=I,x=t.refresh==="Row"?I:x}t.refresh==="Row"?t.rowIndex=ce(h,x+f,!0)-f:x=t.rowIndex=f?ce(h,x,!0):y[0];var D=t.frozenIndexes[1]>v?t.frozenIndexes[1]:t.colIndex+(t.refresh==="Column"?v:h.frozenColumns);if(y=this.parent.skipHidden(D,p,"columns",!1),p=y[1],D!==y[0]){var b=xe(h.paneTopLeftCell);b[1]===D&&this.parent.updateTopLeftCell(b[0],y[0]-v,"row")}y[0]-=v,S=h.colCount-1,C=0;var M=t.colIndex;if(this.parent.scrollSettings.isFinite&&p>S&&(C=p-S,p=ce(h,S,!1,"columns"),y[0]+v>ce(h,v,!0,"columns"))){var I=t.colIndex-C;I=I>-1?I:0,I=this.decreaseHidden(I,t.colIndex-1,v,"columns"),t.left&&I<t.colIndex&&this.parent.notify(qc,{width:wi(h,I+v,t.colIndex-1+v,!0),isRender:!0}),this.parent.viewport.leftIndex=y[0]=I,M=t.refresh==="Column"?I:M}t.refresh==="Column"?t.colIndex=ce(h,M+v,!0,"columns")-v:M=t.colIndex=v?ce(h,M,!0,"columns"):y[0],t.refresh==="Row"&&(x+=f,f&&(d+=xe(h.topLeftCell)[0]),p=this.parent.viewport.rightIndex),t.refresh==="Column"&&(M+=v,v&&(p+=xe(h.topLeftCell)[1]),d=this.parent.viewport.bottomIndex),this.parent.viewport.topIndex=t.rowIndex,this.parent.viewport.bottomIndex=d,this.parent.viewport.leftIndex=t.colIndex,this.parent.viewport.rightIndex=p,e=st(x,M)+":"+st(d,p)}else t.refresh==="All"&&this.updateTopLeftScrollPosition(pe(t,{sheet:h})),this.parent.viewport.bottomIndex=h.rowCount-1,this.parent.viewport.rightIndex=h.colCount-1,e=st(t.rowIndex,t.colIndex)+":"+st(this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex);t.refresh==="All"&&this.parent.trigger(i9,{});var E=this.parent.isOpen||this.parent.refreshing;bd(this.parent.getMainContent(),{busy:!0});var A=this.parent.sheets.length;Aa(this.parent,c+"!"+e,null,null,t.frozenIndexes).then(function(L){if(!(!a.parent||A<a.parent.sheets.length)){var N=Cn(a.parent,h.id);if(!n&&(N===void 0||N!==a.parent.activeSheetIndex)){N>-1&&a.checkTopLeftCell();return}var R=[t.rowIndex,t.colIndex].concat(xe(e.split(":")[1])),P,k;switch(t.refresh){case"All":l.renderTable({cells:L,indexes:R,top:t.top,left:t.left,initLoad:i,isRefreshing:r,isOpen:E,openOptions:s});break;case"Row":l.refreshRowContent({cells:L,indexes:R,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u}),P=!1,k={isEdit:P},a.parent.notify(Kd,k),k.isEdit&&a.parent.notify(ui,{action:"startEdit",refreshCurPos:!1});break;case"Column":l.refreshColumnContent({cells:L,indexes:R,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u,insertDelete:t.insertDelete});break;case"RowPart":l.updateRowContent({cells:L,indexes:R,direction:t.direction,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u});break;case"ColumnPart":l.updateColContent({cells:L,indexes:R,direction:t.direction,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u});break}a.parent&&a.parent.isReact&&a.parent.renderReactTemplates()}}),this.parent.notify(WM,{refresh:t.refresh,skipTranslate:t.skipTranslate})},o.prototype.updateTopLeftScrollPosition=function(t){var e=xe(t.sheet.topLeftCell),i=xe(t.sheet.paneTopLeftCell);if(t.sheet.frozenRows){var r=this.parent.frozenRowCount(t.sheet);i[0]>r&&(t.top=xi(t.sheet,r,i[0]-1,!0))}else t.rowIndex&&(t.rowIndex=0),e[0]!==0&&(t.top=xi(t.sheet,0,e[0]-1,!0));if(t.sheet.frozenColumns){var n=this.parent.frozenColCount(t.sheet);i[1]>n&&(t.left=wi(t.sheet,n,i[1]-1,!0))}else t.colIndex&&(t.colIndex=0),e[1]!==0&&(t.left=wi(t.sheet,0,e[1]-1,!0))},o.prototype.removeSheet=function(){document.getElementById(this.parent.element.id+"_sheet")&&Qe(document.getElementById(this.parent.element.id+"_sheet"))},o.prototype.refreshSheet=function(t,e,i,r,n){var s=0,a=0;if(e){var l=this.parent.element.getElementsByClassName("e-main-panel")[0];l&&(s=l.scrollTop);var h=this.parent.getMainContent();h&&(a=h.scrollLeft)}this.removeSheet(),this.renderSheet(),this.parent.notify(nu,{}),this.checkTopLeftCell(!1,t,s,a,r,n),i&&Re(this.parent.element)},o.prototype.setSheetPanelSize=function(t){var e=document.getElementById(this.parent.element.id+"_sheet_panel"),i=this.parent.element.getBoundingClientRect(),r;if(this.parent.viewport.scaleY=this.parent.viewport.scaleX=1,this.parent.enableScaling){var n=this.parent.element.offsetHeight,s=n/i.height;s!==1&&Math.abs(n-i.height)>=n*.1&&(this.parent.viewport.scaleY=s);var a=this.parent.element.offsetWidth,l=a/i.width;l!==1&&Math.abs(a-i.width)>=a*.1&&(this.parent.viewport.scaleX=l)}this.parent.height==="auto"?(e.style.height="260px",r=230):(r=i.height*this.parent.viewport.scaleY-Zz(e,null,this.parent.viewport.scaleY),e.style.height=r+"px",r-=32/this.parent.viewport.scaleY),t!==void 0&&(this.colMinWidth=t),this.parent.viewport.height=r;var h=i.width*this.parent.viewport.scaleX;this.parent.viewport.width=h-32/this.parent.viewport.scaleX,this.parent.viewport.rowCount=this.roundValue(r,20),this.parent.viewport.colCount=this.roundValue(h,this.colMinWidth||64)},o.prototype.roundValue=function(t,e){var i=t/e,r=Math.round(i);return Math.abs(i-r)<.5?r:r-1},o.prototype.moveOrDuplicateSheetHandler=function(t){this.parent.notify(Oh,null),t.refresh&&this.refreshSheet(t.isDuplicate)},o.prototype.decreaseHidden=function(t,e,i,r){r===void 0&&(r="rows"),t+=i,e+=i;for(var n=this.parent.getActiveSheet(),s=e;s>=t;s--)if(n[""+r][s]&&n[""+r][s].hidden&&(t--,t<i)){t=ce(n,i,!0,r);break}return t-i},o.prototype.instantiateRenderer=function(){this.parent.serviceLocator.register("cell",new k9(this.parent)),this.parent.serviceLocator.register("row",new N9(this.parent)),this.parent.serviceLocator.register("sheet",new L9(this.parent))},o.prototype.destroy=function(){this.removeEventListener(),this.parent.serviceLocator.getService("row").destroy(),this.parent.serviceLocator.getService("cell").destroy(),this.colMinWidth&&(this.colMinWidth=null),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Xn,this.destroy,this),this.parent.on(Kb,this.moveOrDuplicateSheetHandler,this),this.parent.on(PD,this.updateTopLeftScrollPosition,this)},o.prototype.removeEventListener=function(){this.parent.off(Xn,this.destroy),this.parent.off(Kb,this.moveOrDuplicateSheetHandler),this.parent.off(PD,this.updateTopLeftScrollPosition)},o})(),R9=function(o,t,e,i){return new(e||(e=Promise))(function(r,n){function s(h){try{l(i.next(h))}catch(c){n(c)}}function a(h){try{l(i.throw(h))}catch(c){n(c)}}function l(h){h.done?r(h.value):new e(function(c){c(h.value)}).then(s,a)}l((i=i.apply(o,t||[])).next())})},O9=function(o,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,r,n,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(c){return l([h,c])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,r&&(n=h[0]&2?r.return:h[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,h[1])).done)return n;switch(r=0,n&&(h=[h[0]&2,n.value]),h[0]){case 0:case 1:n=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,r=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!n||h[1]>n[0]&&h[1]<n[3])){e.label=h[1];break}if(h[0]===6&&e.label<n[1]){e.label=n[1],n=h;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(h);break}n[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(o,e)}catch(c){h=[6,c],r=0}finally{i=n=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},iE=(function(){function o(t){this.parent=t,this.init(),this.addEventListener()}return o.prototype.init=function(){this.parent.element.appendChild(this.parent.createElement("input",{className:"e-clipboard",attrs:{contenteditable:"true",tabindex:"-1","aria-hidden":"true"}}))},o.prototype.addEventListener=function(){var t=this.getClipboardEle();this.parent.on(iu,this.cut,this),this.parent.on(ru,this.copy,this),this.parent.on(fo,this.paste,this),this.parent.on($d,this.clearCopiedInfo,this),this.parent.on(QM,this.tabSwitchHandler,this),this.parent.on(eu,this.cMenuBeforeOpenHandler,this),this.parent.on(Ag,this.ribbonClickHandler,this),this.parent.on(Ln,this.initCopyIndicator,this),this.parent.on(Fn,this.rowHeightChanged,this),this.parent.on(Qn,this.colWidthChanged,this),this.parent.on(Jb,this.refreshOnInsertDelete,this),T.add(t,"cut",this.cut,this),T.add(t,"copy",this.copy,this),T.add(t,"paste",this.paste,this)},o.prototype.removeEventListener=function(){var t=this.getClipboardEle();this.parent.isDestroyed||(this.parent.off(iu,this.cut),this.parent.off(ru,this.copy),this.parent.off(fo,this.paste),this.parent.off($d,this.clearCopiedInfo),this.parent.off(QM,this.tabSwitchHandler),this.parent.off(eu,this.cMenuBeforeOpenHandler),this.parent.off(Ag,this.ribbonClickHandler),this.parent.off(Ln,this.initCopyIndicator),this.parent.off(Fn,this.rowHeightChanged),this.parent.off(Qn,this.colWidthChanged),this.parent.off(Jb,this.refreshOnInsertDelete)),T.remove(t,"cut",this.cut),T.remove(t,"copy",this.copy),T.remove(t,"paste",this.paste)},o.prototype.ribbonClickHandler=function(t){var e=this.parent.element.id;switch(t.item.id){case e+"_cut":this.cut({invokeCopy:!0});break;case e+"_copy":this.copy({invokeCopy:!0});break}},o.prototype.tabSwitchHandler=function(t){t.activeTab===0&&!this.copiedInfo&&!this.copiedShapeInfo&&this.hidePaste()},o.prototype.cMenuBeforeOpenHandler=function(t){var e=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(ve),r=[],n=[],s=[],a=[],l=e.activeCell,h=xe(l),c=Q(h[0],h[1],e),u=e.isProtected&&mn(c,Ht(e,h[1]));(t.target==="Content"||t.target==="RowHeader"||t.target==="ColumnHeader"||t.target==="SelectAll")&&(this.parent.enableContextMenuItems([i.getConstant("Paste"),i.getConstant("PasteSpecial")],!!(this.copiedInfo||this.copiedShapeInfo&&!u)),this.parent.enableContextMenuItems([i.getConstant("Cut")],!u)),t.target==="Content"&&(e.isProtected&&this.parent.enableContextMenuItems([i.getConstant("Filter"),i.getConstant("Sort"),i.getConstant("AddNote")],!1),u?this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Hyperlink"),i.getConstant("EditNote"),i.getConstant("DeleteNote")],!1):Hi(this.parent,tt(ie(e.selectedRange)))?this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Paste"),i.getConstant("PasteSpecial"),i.getConstant("Filter"),i.getConstant("Sort"),i.getConstant("Hyperlink"),i.getConstant("EditHyperlink"),i.getConstant("OpenHyperlink"),i.getConstant("RemoveHyperlink"),i.getConstant("AddNote")],!1):e.isProtected&&!e.protectSettings.insertLink&&this.parent.enableContextMenuItems([i.getConstant("Hyperlink")],!1)),e.isProtected&&(t.target==="ColumnHeader"&&(s=[i.getConstant("DeleteColumn"),i.getConstant("DeleteColumns"),i.getConstant("InsertColumn"),i.getConstant("InsertColumns")],a=[i.getConstant("HideColumn"),i.getConstant("HideColumns"),i.getConstant("UnhideColumns")],this.parent.enableContextMenuItems(s,!1),this.parent.enableContextMenuItems(a,e.protectSettings.formatColumns)),t.target==="RowHeader"&&(r=[i.getConstant("DeleteRow"),i.getConstant("DeleteRows"),i.getConstant("InsertRow"),i.getConstant("InsertRows")],n=[i.getConstant("HideRow"),i.getConstant("HideRows"),i.getConstant("UnhideRows")],this.parent.enableContextMenuItems(r,!1),this.parent.enableContextMenuItems(n,e.protectSettings.formatRows)))},o.prototype.rowHeightChanged=function(t){if(this.copiedInfo){var e=this.getCopyIndicator();e&&(this.copiedInfo.range[0]>t.rowIdx?e.style.top=parseFloat(e.style.top)+t.threshold+"px":Vo(this.copiedInfo.range,t.rowIdx,this.copiedInfo.range[1])&&(e.style.height=parseFloat(e.style.height)+t.threshold+"px"))}},o.prototype.colWidthChanged=function(t){if(this.copiedInfo){var e=this.getCopyIndicator();e&&(this.copiedInfo.range[1]>t.colIdx?e.style.left=parseFloat(e.style.left)+t.threshold+"px":Vo(this.copiedInfo.range,this.copiedInfo.range[0],t.colIdx)&&(e.style.width=parseFloat(e.style.width)+t.threshold+"px"))}},o.prototype.cut=function(t){this.setCopiedInfo(t,!0)},o.prototype.copy=function(t){this.setCopiedInfo(t,!1)},o.prototype.paste=function(t){var e=this;if(this.parent.isEdit||this.parent.element.getElementsByClassName("e-dlg-overlay").length>0){var i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0];i.style.height="auto";return}var r,n=t&&t.clipboardData||window.clipboardData;if(!(n&&t.clipboardData&&t.clipboardData.getData("isInternalCut").length&&!this.copiedInfo))if(n||this.copiedShapeInfo||t.isInternal&&this.copiedInfo){t.isInternal=!n;var s=void 0,a=this.getCopiedIdx();t.isAction=!!n||t.isAction;var l=t&&t.sIdx>-1?t.sIdx:this.parent.activeSheetIndex,h=ke(this.parent,l),c=tt(t&&t.range||ie(h.selectedRange)),u=void 0,d=void 0;if(n){if(u=this.getExternalCells(t),d=u.model,!t.isInternal&&u.internal&&(n=!1,!this.copiedInfo))return;if(!d||!d.length)if(u.file){this.parent.notify(ED,{file:u.file});return}else if(this.copiedInfo)n=!1;else return}u=u;var p=Object.assign({isExternal:n},this.copiedInfo),f,v,m=void 0,y=void 0,b=void 0,S=void 0,C,x=void 0,I=void 0;n?(v=l,C=ke(this.parent,v),m={},S=u.selection,b=S!=="Sheet"&&(c[2]-c[0]+1)%u.rowCount===0&&(c[3]-c[1]+1)%u.colCount===0,f=[0,0,u.usedRowIndex,u.usedColIndex]):(f=tt(this.copiedShapeInfo?ie(h.selectedRange):this.copiedInfo.range),v=a,m=Ht(h,f[1]),y=ug(f)&&this.isRangeMerged(c,h),C=ke(this.parent,v),b=!y&&(c[2]-c[0]+1)%(f[2]-f[0]+1)===0&&(c[3]-c[1]+1)%(f[3]-f[1]+1)===0,C&&(x=f[1]===0&&f[3]===C.colCount-1,I=f[0]===0&&f[2]===C.rowCount-1,x?I?(S="Sheet",f[2]=C.usedRange.rowIndex,f[3]=C.usedRange.colIndex):(S="Row",f[3]=C.usedRange.colIndex):I&&(S="Column",f[2]=C.usedRange.rowIndex))),r=b?c:[c[0],c[1]].concat([c[0]+f[2]-f[0],c[1]+f[3]-f[1]||c[1]]),S&&((S==="Sheet"||S==="Column")&&r[2]<h.usedRange.rowIndex&&(r[2]=h.usedRange.rowIndex),(S==="Sheet"||S==="Row")&&r[3]<h.usedRange.colIndex&&(r[3]=h.usedRange.colIndex));var D=t&&t.type||"All";if(Hi(this.parent,r)){this.parent.notify(fr,null);return}else if(h.isProtected&&Ko(this.parent,r)){this.parent.notify(Ra,null);return}if(t.isAction&&!this.copiedShapeInfo){var M={requestType:"paste",copiedInfo:this.copiedInfo,copiedRange:Ve(f),pastedRange:Ve(r),type:D,cancel:!1};if(this.parent.notify(hi,{eventArgs:M,action:"clipboard"}),M.cancel)return;c=ie(M.pastedRange),n?b=u.selection!=="Sheet"&&(c[2]-c[0]+1)%u.rowCount===0&&(c[3]-c[1]+1)%u.colCount===0:b=!y&&!x&&(c[2]-c[0]+1)%(f[2]-f[0]+1)===0&&!I&&(c[3]-c[1]+1)%(f[3]-f[1]+1)===0,r=b?c:[c[0],c[1]].concat([c[0]+f[2]-f[0],c[1]+f[3]-f[1]||c[1]]),D=M.type}var E=void 0;S?(E=[].concat(r),(S==="Sheet"||S==="Column")&&(r[2]<h.usedRange.rowIndex&&(r[2]=h.usedRange.rowIndex),f[2]<h.usedRange.rowIndex&&(f[2]+=h.usedRange.rowIndex-f[2]),E[2]<h.rowCount&&(E[2]=h.rowCount-1)),(S==="Sheet"||S==="Row")&&(r[3]<h.usedRange.colIndex&&(f[3]+=h.usedRange.colIndex-r[3],r[3]=h.usedRange.colIndex),f[3]<h.usedRange.colIndex&&(f[3]+=h.usedRange.colIndex-f[3]),E[3]<h.colCount&&(E[3]=h.colCount-1))):E=r;var A=void 0,L=void 0,N=void 0,R=c[0],P=[];if(h.isProtected&&Ko(this.parent,r)){this.parent.notify(Ra,null);return}if(this.copiedShapeInfo&&!this.copiedInfo){var k=this.copiedShapeInfo.pictureElem;k.classList.contains("e-datavisualization-chart")?(this.copiedShapeInfo.chartInfo.top=null,this.copiedShapeInfo.chartInfo.left=null,this.parent.notify(jh,{chart:[this.copiedShapeInfo.chartInfo],isInitCell:!0,isUndoRedo:!0,isPaste:!0,dataSheetIdx:this.copiedShapeInfo.sheetIdx,isCut:this.copiedShapeInfo.isCut,sheetId:h.id,range:t.range||h.name+"!"+h.selectedRange})):this.parent.notify(go,{options:{src:k.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:this.copiedShapeInfo.height,width:this.copiedShapeInfo.width,id:this.copiedShapeInfo.isCut?k.id:""},range:Ve([R,c[1],R,c[1]]),isPublic:!1,isUndoRedo:!0});var B=Q(R,c[1],h);if(B&&!g(B.image)&&B.image.length>0){var F={requestType:"imagePaste",copiedShapeInfo:this.copiedShapeInfo,pasteSheetIndex:this.parent.activeSheetIndex,pastedRange:Gn(this.parent)+"!"+Ve([R,c[1],R,c[1]]),pastedPictureElement:document.getElementById(B.image[B.image.length-1].id)};this.parent.notify(wt,{eventArgs:F,action:"clipboard"})}}else{var O=[],z=this.isInRange(f,c,a),Y=!1,K=!1,U=0,q=[],ae=void 0,te=void 0;!b&&D!=="Values"&&(ae=this.setCF(f,r,C,h,q,ae));for(var he=!1,ue=[],ne={sheet:h,isExternal:!!n},le=this.setCell(ne),$=!n&&this.copiedInfo.isCut&&this.setCell({sheet:C}),ee=[],He=[],qe=[],we=f[0],je=0;we<=f[2];we++,je++){if(!n&&!p.isCut&&as(C,we)){je--,U++;continue}z&&(O[c[0]+je]={cells:[]});for(var Ne=f[1],Ye=0;Ne<=f[3];Ne++,Ye++){if(z&&(O[c[0]+je].cells[c[1]+Ye]=Q(c[0]+je,c[1]+Ye,C,!1,!0)),A=n?d[we]&&d[we].cells[Ne]||{}:pe({},z&&O[we]&&O[we].cells[Ne]?O[we].cells[Ne]:Q(we,Ne,C),null,!0),m=Ht(C,Ne),!A.validation&&hs(m,we,Ne)){var dt=Object.assign({},m.validation),Ke=[0,f[1],0,f[3]],ci=dt.value1,Jt=dt.value2;pt(ci)&&(dt.value1=ln([we,Ne],Ke,C,this.parent,{formula:ci})),pt(Jt)&&(dt.value2=ln([we,Ne],Ke,C,this.parent,{formula:Jt})),A.validation=dt}if(A&&A.isReadOnly&&delete A.isReadOnly,x||I){if(A&&A.rowSpan){if(A.rowSpan>0)A.rowSpan+we-1<=f[2]?Y=!0:A={};else if(!Y)A={};else if(A.rowSpan<0){var vt=A.rowSpan,bi=A.colSpan?A.colSpan:0,Bi=Q(R+vt,c[1]+Ye+bi,h);Bi&&!Bi.rowSpan&&(A={})}}A&&A.colSpan&&(A.colSpan>0?A.colSpan+Ne-1<=f[3]?K=!0:A={}:K||(A={}))}if(A&&D){var Dr=void 0;switch(D){case"Formats":Dr={format:A.format,style:A.style},this.copiedInfo&&!this.copiedInfo.isCut&&(A.rowSpan&&(Dr.rowSpan=A.rowSpan),A.colSpan&&(Dr.colSpan=A.colSpan)),A=Dr;break;case"Values":if(A={value:A.value},A.value&&A.value.toString().indexOf(`
`)>-1){var vr=this.parent.getCell(c[0],c[1]);vr.classList.add("e-alt-unwrap")}break}L=["Formats","Values"].indexOf(D)>-1}if(!this.parent.scrollSettings.isFinite&&(f[2]-f[0]>1048575-c[0]||f[3]-f[1]>16383-c[1])||this.parent.scrollSettings.isFinite&&(f[2]-f[0]>h.rowCount-1-c[0]||f[3]-f[1]>h.colCount-1-c[1])){this.showDialog();return}if(b){for(var Fi=c[0];Fi<=c[2];Fi+=f[2]-f[0]+1)if(!(!p.isCut&&!U&&as(h,Fi+je)))for(var tr=c[1];tr<=c[3];tr+=f[3]-f[1]+1){if(we===f[0]&&Ne===f[1]&&(ae===void 0||ae.length)&&D!=="Values"&&(ae=this.setCF(f,[Fi,tr,Fi+(f[2]-f[0]),tr+(f[3]-f[1])],C,h,q,ae)),N=Q(Fi+je,tr+Ye,h,!1,!0),!n&&(!g(N.colSpan)||!g(N.rowSpan))){if(x||I)continue;var _={range:[Fi+je,tr+Ye,Fi+je,tr+Ye],merge:!1,isAction:!1,type:"All",sheetIndex:l,preventRefresh:l!==this.parent.activeSheetIndex};P.push(_),this.parent.notify(Nn,_)}var re=tr+Ye;if(A&&A.rowSpan>1||A.colSpan>1){var Se=[Fi+je,re,Fi+je+(A.rowSpan||1)-1,re+(A.colSpan||1)-1],Be=!(Se[2]<f[0]||Se[0]>f[2]||Se[3]<f[1]||Se[1]>f[3]);Be&&qe.push(Se)}if(A=pe({},A||{},null,!0),!L&&this.copiedInfo&&!this.copiedInfo.isCut&&A.formula){var _e=ln([Fi+je,re],[we,Ne],C,this.parent,null);g(_e)||(A.formula=_e)}if(this.copiedInfo&&!this.copiedInfo.isCut&&A.validation){var We=c,Ke=f,Dt=ln(We,Ke,C,this.parent,{formula:A.validation.value1});A.validation.value1=Dt,A.validation.value2!==""&&(Dt=ln(We,Ke,C,this.parent,{formula:A.validation.value2}),A.validation.value2=Dt)}h.isProtected&&A&&A.isLocked!==!1&&(A.isLocked=N.isLocked),N&&N.formula&&N.formula.indexOf("=UNIQUE(")>-1&&this.parent.notify(zd,null);var _i={cellIdx:[we,Ne],isUnique:!1,uniqueRange:"",sheetName:C.name};this.parent.notify(Kc,_i),_i.isUnique&&(A.value=null),he=!1,A&&A.formula&&A.formula.indexOf("=UNIQUE(")>-1&&(he=!0,ue.push([Fi,re]),A.value=null),te=le(Fi+je,re,A,re===c[3],L,he,t.beforeActionData,t.isUndo),!te&&A.formula&&this.copiedInfo&&this.copiedInfo.isCut&&this.parent.notify($c,{cellRef:Ve([we,Ne,we,Ne])})}}else(n||!Jz(this.parent,we,Ne,a))&&(y?le(R,c[1]+Ye,{value:A.value},Ne===f[3],!0):le(R,c[1]+Ye,A,Ne===f[3],L));if(!n&&this.copiedInfo.isCut&&!(Vo(c,we,Ne)&&a===this.parent.activeSheetIndex)){var qt=Q(we,Ne,C);if(qt){if(qt.isReadOnly)continue;if(qt.isLocked||g(qt.isLocked))if((x||I)&&(qt.rowSpan!==void 0||qt.colSpan!==void 0))if(qt.rowSpan>1||qt.colSpan>1)ee.push({range:[we,Ne,we,Ne],rowSpan:qt.rowSpan,colSpan:qt.colSpan}),qt=null;else continue;else!qt.validation&&C.columns[Ne]&&C.columns[Ne].validation&&He.indexOf(Ne)===-1&&He.push(Ne),qt=null;else qt.isLocked===!1&&(C.isProtected?qt={isLocked:!1}:qt=null)}$(we,Ne,qt,Ne===f[3])}}R++}if(qe.length&&qe.forEach(function(Gr){for(var hn=Gr[0];hn<=Gr[2];hn++)for(var $n=Gr[1];$n<=Gr[3];$n++)if(!(hn===Gr[0]&&$n===Gr[1])){var Qr=Q(hn,$n,h,!1,!0);if(Qr&&Qr.rowSpan===void 0&&Qr.colSpan===void 0){hn!==Gr[0]&&(Qr.rowSpan=Gr[0]-hn),$n!==Gr[1]&&(Qr.colSpan=Gr[1]-$n);var Es=e.parent.getCell(hn,$n);Es&&e.parent.serviceLocator.getService("cell").refresh(hn,$n,!1,Es)}}}),ee.length&&ee.forEach(function(Gr){Zt(Gr.range[0],Gr.range[1],C,{rowSpan:Gr.rowSpan,colSpan:Gr.colSpan});var hn={range:Gr.range};e.parent.notify(uo,hn),e.parent.notify(Nn,{merge:!1,range:hn.range,type:"All",sheetIndex:v,preventRefresh:v!==e.parent.activeSheetIndex}),hn.range=hn.range;for(var $n=hn.range[0];$n<=hn.range[2];$n++)for(var Qr=hn.range[1];Qr<=hn.range[3];Qr++)$($n,Qr,null)}),He.length&&He.forEach(function(Gr){e.parent.notify(Qo,{range:C.name+"!"+Ve([f[0],Gr,f[2],Gr]),isRemoveValidation:!0})}),ue.length)for(var we=0;we<ue.length;we++)this.parent.serviceLocator.getService("cell").refresh(ue[we][0],ue[we][1]);ne.isRandFormula&&this.parent.calculationMode==="Automatic"&&this.parent.notify(At,{action:"refreshRandomFormula"}),this.parent.notify(Hs,null);var Kn=r[2]-U,br=E[2]-U;r[2]=Kn,E[2]=br,this.parent.setUsedRange(r[2],r[3]);var ql=Ve(E);l===this.parent.activeSheetIndex&&!t.isFromUpdateAction&&this.parent.notify(tu,{address:ql}),!n&&this.copiedInfo.isCut&&(s=this.copiedInfo.isCut,a===this.parent.activeSheetIndex&&this.parent.serviceLocator.getService("cell").refreshRange(f),this.clearCopiedInfo()),(n||z)&&this.copiedInfo&&this.clearCopiedInfo();var Zo=void 0;if(s){ae&&ae.length&&D!=="Values"&&(Zo={range:f,sheetIdx:v,isClear:!0},this.parent.notify(po,Zo));var Ba=this.parent.activeSheetIndex===v,ja=Ba?(this.parent.getRow(f[0],null,this.parent.frozenColCount(C))||{offsetHeight:20}).offsetHeight:ei(C,f[0],!1,!0);Ph(C,f[0],f[1],ja);var sp=qo(C,f[0]);Na(this.parent,C,sp,f[0],void 0,void 0,Ba,!Ba)}q.length&&l===this.parent.activeSheetIndex&&this.parent.notify(Gi,{cfModel:q,isAction:!0});var Ha=ke(this.parent,a);if(!n&&f[0]===f[2]&&S==="Row"){for(var sp=Ha.rows[f[0]].height,we=c[0];we<=c[2];we++)Na(this.parent,this.parent.getActiveSheet(),sp,we);if(s){var Jo=Ha&&Ha.standardHeight?Ha.standardHeight:20;Na(this.parent,Ha,Jo,f[0])}}if(t.isAction){var F={requestType:"paste",copiedInfo:p,mergeCollection:P,pasteSheetIndex:this.parent.activeSheetIndex,copiedRange:C.name+"!"+(p.range?Ve(p.range):C.selectedRange),pastedRange:h.name+"!"+Ve(r),type:D||"All",selectedRange:ql};U&&(F.skipFilterCheck=!0),Zo&&Zo.cfClearActionArgs&&(F.cfClearActionArgs=Zo.cfClearActionArgs),q.length&&(F.cfActionArgs={cfModel:q,sheetIdx:l}),this.parent.notify(wt,{eventArgs:F,action:"clipboard"})}t.focus&&Re(this.parent.element)}}else this.getClipboardEle().select()},o.prototype.setCF=function(t,e,i,r,n,s){var a=this,l,h,c=function(p){l=[e[0]+(h[0]<=t[0]?0:h[0]-t[0]),e[1]+(h[1]<=t[1]?0:h[1]-t[1]),e[2]-(h[2]>=t[2]?0:t[2]-h[2]),e[3]-(h[3]>=t[3]?0:t[3]-h[3])],r.conditionalFormats||a.parent.setSheetPropertyOnMute(r,"conditionalFormats",[]);var f={range:Ve(l),type:p.type,cFColor:p.cFColor,value:p.value,format:p.format};r.conditionalFormats.push(f),n.push(f)};if(s)for(var u=0,d=s.length;u<d;u++)h=ie(s[u].range),c(s[u]);else if(s=[],i.conditionalFormats)for(var u=0,d=i.conditionalFormats.length;u<d;u++)h=ie(i.conditionalFormats[u].range),i0([t],i.conditionalFormats[u].range)&&(s.push(i.conditionalFormats[u]),c(i.conditionalFormats[u]));return s},o.prototype.isRangeMerged=function(t,e){var i=Q(t[0],t[1],e);if(i&&(i.colSpan>1||i.rowSpan>1)){var r={range:t.slice(2,4).concat(t.slice(2,4))};return this.parent.notify(pr,r),r.range[0]===t[0]&&r.range[1]===t[1]&&r.range[2]===t[2]&&r.range[3]===t[3]}return!1},o.prototype.updateFilter=function(t,e){var i,r;this.parent.notify(kb,null);for(var n=0;n<this.parent.sheets.length;n++)if(this.parent.filterCollection&&this.parent.filterCollection[n]&&this.parent.filterCollection[n].sheetIndex===Cn(this.parent,t.sId)){var s=t.range,a=ie(this.parent.filterCollection[n].filterRange);s=tt(s),a[0]===s[0]&&a[2]===s[2]&&a[1]===s[1]&&a[3]===s[3]&&(i=!0,r=[Math.abs(s[0]-a[0]),Math.abs(s[1]-a[1]),Math.abs(s[2]-a[2]),Math.abs(s[3]-a[3])])}var l=this.parent.getCell(t.range[0],t.range[1]);l=l&&(l.querySelector(".e-filter-icon")?l:this.parent.getCell(t.range[2],t.range[3]));var h=l&&l.querySelector(".e-sortasc-filter"),c=l&&l.querySelector(".e-sortdesc-filter");if(i)for(var u=0;u<this.parent.filterCollection.length;u++){var d=this.parent.filterCollection[u],p=t&&t.sId?Cn(this.parent,t.sId):this.parent.activeSheetIndex;if(d.sheetIndex===p&&this.parent.notify(Yo,{predicates:null,range:d.filterRange,sIdx:p,isCut:!0}),d.sheetIndex===p&&p===this.parent.activeSheetIndex&&(r=[e[0]+r[0],e[1]+r[1],Math.abs(e[2]-r[2]),Math.abs(e[3]-r[3])],this.parent.notify(Yo,{predicates:null,range:Ve(r),sIdx:null,isCut:!0}),t.range[3]===t.range[1])){var f=this.parent.getCell(e[0],e[1]);h&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"),c&&f&&f.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter")}}},o.prototype.isInRange=function(t,e,i){var r=this.parent.activeSheetIndex;return Vo(t,e[0],e[1])&&i===r||Vo(t,e[2],e[3])&&i===r},o.prototype.setCell=function(t){var e=this,i=t.sheet,r=i.name===this.parent.getActiveSheet().name;return function(n,s,a,l,h,c,u,d){a&&a.formula&&(a.formula.indexOf("RANDBETWEEN(")>-1||a.formula.indexOf("RAND(")>-1||a.formula.indexOf("NOW(")>-1)&&(t.isRandFormula=!0);var p;Q(n,s,i,!1,!0).wrap&&(p=!0);var f=gr(e.parent,i,{cell:a,rowIdx:n,colIdx:s,pvtExtend:!h,valChange:!c,lastCell:l,uiRefresh:r,requestType:"paste",skipFormatCheck:!t.isExternal,isRandomFormula:t.isRandFormula},u,d);if(!f){if(a&&a.style&&t.isExternal){var v=kd(e.parent,n,s,i,a.style||e.parent.cellStyle,a.wrap?jg(e.parent.getDisplayText(a),ip(i,n,s,a.colSpan>1?s+a.colSpan-1:s),a.style,e.parent.cellStyle):1);v=Math.round(v),v<20&&(v=20),Ph(i,n,s,v);var m=xi(i,n),y=qo(i,n),b=y>m;b&&Na(e.parent,i,y,n)}p&&!Q(n,s,i,!1,!0).wrap&&e.parent.notify(sa,{range:[n,s,n,s],wrap:!1,sheet:i,initial:!0})}return f}},o.prototype.getCopiedIdx=function(){if(this.copiedInfo){for(var t=0;t<this.parent.sheets.length;t++)if(this.parent.sheets[t].id===this.copiedInfo.sId)return t;this.clearCopiedInfo()}return-1},o.prototype.setCopiedInfo=function(t,e){var i=this;if(!this.parent.isEdit){var r=new zn;t.promise=r.promise;var n=this.parent.getActiveSheet(),s;if(t&&t.range){var a=t.range[1]===0&&t.range[3]===n.colCount-1,l=t.range[0]===0&&t.range[2]===n.rowCount-1,h={range:t.range};a||l||this.parent.notify(uo,h),s=h.range}else s=ie(n.selectedRange);if(e&&Hi(this.parent,s)){this.parent.notify(fr,null);return}if(t&&!t.isPublic&&!t.clipboardData){var c={copiedRange:n.name+"!"+Ve(s),cancel:!1,action:e?"cut":"copy"};if(this.parent.notify(hi,c),c.cancel)return}var u={sheet:n,indexes:[0,0,n.rowCount-1,n.colCount-1],isFinite:this.parent.scrollSettings.isFinite,promise:new Promise(function(f){f((function(){})())})},d=document.getElementsByClassName("e-ss-overlay-active"),p=d.length;n.isLocalData&&!(t&&t.clipboardData)&&s[0]===0&&s[2]===n.rowCount-1&&!p&&(this.parent.showSpinner(),this.parent.notify("updateSheetFromDataSource",u)),this.checkForUncalculatedFormula(s,t&&t.sId?t.sId:n.id),u.promise.then(function(){if(p>0){var f={clientY:d[0].offsetTop,isImage:!0};i.parent.notify(Is,f);var v={clientX:d[0].offsetLeft,isImage:!0};if(i.parent.notify(Ms,v),i.copiedShapeInfo={sId:t&&t.sId?t.sId:n.id,sheetIdx:n.index,isCut:e,pictureElem:d[0],copiedRange:Ve([f.clientY,v.clientX,f.clientY,v.clientX]),height:d[0].offsetHeight,width:d[0].offsetWidth,chartInfo:i.getChartElemInfo(d[0])},!d[0].classList.contains("e-datavisualization-chart")){var m=window.getComputedStyle(d[0]).backgroundImage.slice(5,-2);i.addImgToClipboard(m,i.copiedShapeInfo.height,i.copiedShapeInfo.width)}i.hidePaste(!0),e&&(d[0].classList.contains("e-datavisualization-chart")?i.parent.deleteChart(i.copiedShapeInfo.chartInfo.id):i.parent.notify(La,{id:i.copiedShapeInfo.pictureElem.id,sheetIdx:i.copiedShapeInfo.sId,range:i.copiedShapeInfo.copiedRange}))}else t&&t.clipboardData||(i.copiedInfo&&i.clearCopiedInfo(),i.copiedInfo={range:s,sId:t&&t.sId?t.sId:n.id,isCut:e},i.hidePaste(!0),t.isFromUpdateAction||i.initCopyIndicator(),j.isIE||i.getClipboardEle().select(),t&&t.invokeCopy&&document.execCommand(e?"cut":"copy"),i.parent.hideSpinner());j.isIE&&i.setExternalCells(t,e),r.resolve()}),t&&t.clipboardData&&(this.setExternalCells(t,e),this.getClipboardEle().setAttribute("aria-label",n.selectedRange+" "+this.parent.serviceLocator.getService(ve).getConstant(e?"Cut":"Copy")))}},o.prototype.imageToCanvas=function(t,e,i){return new Promise(function(r){var n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.src=t,a.crossOrigin="anonymous",a.onload=function(){n.width=i,n.height=e,s.drawImage(a,0,0,i,e),n.toBlob(function(l){r(l)},"image/png")}})},o.prototype.addImgToClipboard=function(t,e,i){return R9(this,void 0,void 0,function(){var r,n,s;return O9(this,function(a){switch(a.label){case 0:return n=window.navigator,[4,this.imageToCanvas(t,e,i)];case 1:return s=a.sent(),[4,n.clipboard.write([new ClipboardItem((r={},r[s.type]=s,r))])];case 2:return a.sent(),[2]}})})},o.prototype.checkForUncalculatedFormula=function(t,e){for(var i,r=Cn(this.parent,e),n=ke(this.parent,r),s=t[0];s<=t[2];s++)for(var a=t[1];a<=t[3];a++)i=Q(s,a,n,null,!0),i.formula&&Te(i.value)&&this.parent.notify(At,{action:"refreshCalculate",value:i.formula,rowIndex:s,colIndex:a,isFormula:pt(i.formula),sheetIndex:r})},o.prototype.getChartElemInfo=function(t){var e=this.parent.chartColl;if(t.classList.contains("e-datavisualization-chart")){for(var i=t.getElementsByClassName("e-control")[0].id,r=0;r<e.length;r++)if(e[r].id===i){var n=e[r];return n}}return null},o.prototype.clearCopiedInfo=function(){this.copiedInfo&&(this.parent.getActiveSheet().id===this.copiedInfo.sId&&(this.removeIndicator(this.parent.getSelectAllContent()),this.removeIndicator(this.parent.getColumnHeaderContent()),this.removeIndicator(this.parent.getRowHeaderContent()),this.removeIndicator(this.parent.getMainContent())),this.copiedInfo=null,this.hidePaste()),this.copiedShapeInfo&&(this.copiedShapeInfo=null,this.hidePaste())},o.prototype.removeIndicator=function(t){if(t){var e=t.getElementsByClassName("e-copy-indicator")[0];e&&se(e)}},o.prototype.initCopyIndicator=function(){if(this.copiedInfo&&this.parent.getActiveSheet().id===this.copiedInfo.sId){var t=this.parent.createElement("div",{className:"e-copy-indicator"});t.appendChild(this.parent.createElement("div",{className:"e-top"})),t.appendChild(this.parent.createElement("div",{className:"e-bottom"})),t.appendChild(this.parent.createElement("div",{className:"e-left"})),t.appendChild(this.parent.createElement("div",{className:"e-right"})),ra(this.parent,t,this.copiedInfo.range,"e-copy-indicator")}},o.prototype.showDialog=function(){var t=this;this.parent.serviceLocator.getService(jt).show({header:"Spreadsheet",height:205,width:340,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(ve).getConstant("PasteAlert"),beforeOpen:function(e){var i={dialogName:"PasteDialog",element:e.element,target:e.target,cancel:e.cancel};t.parent.trigger("dialogBeforeOpen",i),i.cancel&&(e.cancel=!0)}})},o.prototype.hidePaste=function(t){this.parent.getActiveSheet().isProtected&&(t=!1),this.parent.notify(Ea,[{items:[this.parent.element.id+"_paste"],enable:t||!1}])},o.prototype.setExternalCells=function(t,e){var i,r,n="",s,a=this.parent.getActiveSheet(),l=tt(this.copiedInfo.range),h=l[1]===0&&l[3]===a.colCount-1,c=l[0]===0&&l[2]===a.rowCount-1,u,d,p,f='<html><body><table class="e-spreadsheet" xmlns="http://www.w3.org/1999/xhtml" style="border-collapse:collapse;"';(h||c)&&(f+=' aria-rowcount="'+a.usedRange.rowIndex+'" aria-colcount="'+a.usedRange.colIndex+'"',f+=' aria-label="'+(h&&c?"Sheet":h?"Row":"Column")+'"'),f+="><tbody>";for(var v=l[0];v<=l[2];v++)if(!(!e&&as(a,v))){u=ei(a,v),f+='<tr style="height:'+u+'px;">';for(var m=function(S){if(i=Q(v,S,a,!1,!0),i.colSpan<0||i.rowSpan<0)return"continue";if(f+="<td",i.colSpan&&(f+=' colspan="'+i.colSpan+'"'),i.rowSpan&&(f+=' rowspan="'+i.rowSpan+'"'),d=qr(a,S),f+=' style="width:'+d+"px;",i.style?(s="",i.style.whiteSpace||(s+="white-space:"+(i.wrap?"normal":"nowrap")+";"),i.style.verticalAlign||(s+="vertical-align:bottom;"),i.style.fontFamily||(s+="font-family:Calibri;"),i.style.fontSize||(s+="font-size:11pt;"),Object.keys(i.style).forEach(function(I){var D=i.style[""+I];I.includes("border")&&D.includes("dashed")&&D.includes("1px")&&(D=D.replace("1px","thin"));var M=I.match(/[A-Z]/);s+=(I==="backgroundColor"?"background":M?I.replace(M[0],"-"+M[0].toLowerCase()):I)+":"+(I==="backgroundColor"||I==="color"?i.style[""+I].slice(0,7):D)+";"}),f+=s.includes('"')?"'"+s+"'":s+'"'):f+="white-space:"+(i.wrap?"normal":"nowrap")+';vertical-align:bottom;font-family:Calibri;font-size:11pt;"',p="",!g(i.value)){if(r=i.value,i.format&&i.format!=="General"){f+=i.value.toString().includes('"')?" cell-value='"+r+"'":' cell-value="'+i.value+'"',f+=i.format.includes('"')?" num-format='"+i.format+"'":' num-format="'+i.format+'"';var C={formattedText:r,value:r,format:i.format,cell:i,rowIndex:v,colIndex:S,dataUpdate:!0};y.parent.notify(yr,C),r=C.formattedText}p=typeof r=="string"&&r.includes(`
`)?r.split(`
`).join("<br>"):r}if(f+=">",i.hyperlink){var x=typeof i.hyperlink=="string"?i.hyperlink:i.hyperlink.address||"";x&&["http://","https://","ftp://"].some(function(I){return x.startsWith(I)})?f+='<a href="'+x+'" target="_blank">'+p+"</a>":f+=p}else f+=p;n+=p,f+="</td>",n+=S===l[3]?"":"	"},y=this,b=l[1];b<=l[3];b++)m(b);f+="</tr>",n+=v===l[2]?"":`
`}f+="</tbody></table></body></html>",j.isIE?(window.clipboardData.setData("text",n),e&&window.clipboardData.setData("isInternalCut",n)):(t.clipboardData.setData("text/html",f),t.clipboardData.setData("text/plain",n),e&&t.clipboardData.setData("isInternalCut",n),t.preventDefault())},o.prototype.getExternalCells=function(t){var e=this,i,r,n=[],s={model:n},a=this.parent.createElement("span"),l=function(){return setTimeout(function(){e.getClipboardEle().innerHTML=""},0)};if(j.isIE)r=window.clipboardData.getData("text");else{if(i=t.clipboardData.getData("text/html"),r=t.clipboardData.getData("text/plain"),this.copiedInfo&&i.includes('<table class="e-spreadsheet"')){var h=!1;if(!this.copiedInfo.isCut){var c={sheetIdx:Cn(this.parent,this.copiedInfo.sId)};if(this.parent.notify(ou,c),c.isFiltered){var u=c.filterRange,d=this.copiedInfo.range;h=u[0]===d[0]&&u[1]===d[1]&&u[2]===d[2]&&u[3]===d[3]}}if(!h)return l(),{internal:!0}}a.innerHTML=i}if(a.querySelector("table"))this.generateCells(a,s);else if(a.querySelector("img")){var p=a.querySelector("img");this.parent.notify(go,{options:{src:p.src,height:p.height,width:p.width},isPublic:!0})}else if(r){var f=[],v,m,y;i&&(m=[].slice.call(a.children));var b=this.cellStyle(a);s.colCount=1;var S=r.split(`
`);r.endsWith(`\r
`)&&S.length>0&&S[S.length-1]===""&&S.pop(),S.forEach(function(C){v=null,i&&(y=m.filter(function(x){return x.textContent&&x.textContent.replace(/(\r\n|\n|\r|\s)/gm," ").trim()===C.trim()})[0],y&&(v=b(y),m.splice(m.indexOf(y),1))),C.split("	").forEach(function(x,I){(x||v)&&(f[I]={},v&&(v.whiteSpace&&v.whiteSpace!=="nowrap"?(f[I].wrap=!0,delete v.whiteSpace,Object.keys(v).length&&(f[I].style=v)):f[I].style=v),x&&(pt(x)?f[I].formula=x:f[I].value=Ad(x.trim(),!0,!0)))}),n.push({cells:f}),s.colCount=Math.max(s.colCount,f.length),f=[]}),s.rowCount=n.length,s.usedRowIndex=n.length-1,s.usedColIndex=s.colCount-1}else if(t.clipboardData.files&&t.clipboardData.files[0]&&t.clipboardData.files[0].type.includes("image"))return l(),{file:t.clipboardData.files[0]};return l(),s},o.prototype.generateCells=function(t,e){var i=e.model,r=t.querySelector("table"),n=r.classList.contains("e-spreadsheet"),s={},a={};e.usedRowIndex=r.rows.length-1,e.rowCount=r.rows.length,n&&(e.selection=r.getAttribute("aria-label"),e.selection&&(e.selection==="Sheet"?(e.usedRowIndex=Number(r.getAttribute("aria-rowcount")),e.usedColIndex=Number(r.getAttribute("aria-colcount"))):e.selection==="Row"?e.usedColIndex=Number(r.getAttribute("aria-colcount")):e.usedRowIndex=Number(r.getAttribute("aria-rowcount"))));var l=[];g(r)||g(r.getAttribute("style"))||(l.push(r.getAttribute("style")),this.generateStyles(l,s));var h=this.cellStyle(t,n),c,u,d,p,f=1,v,m,y;e.colCount=1;for(var b=[],S=0,C=e.usedRowIndex;S<=C;S++){c=r.rows[S],g(c.getAttribute("style"))||(b.push(c.getAttribute("style")),this.generateStyles(b,a)),i[S]||(i[S]={cells:[]}),u=i[S].cells,e.colCount=Math.max(e.colCount,c.cells.length),v=e.usedColIndex<c.cells.length?e.usedColIndex:c.cells.length-1;for(var x=0;x<=v;x++){p=c.cells[x],y=x,u[x]&&(x=this.getNewIndex(u,x)),u[x]={},d=h(p,a,s);var I=p.getElementsByTagName("a");if(I&&I[0]){var D=I[0].getAttribute("href");D&&rP(D)&&(u[x].hyperlink={address:D})}if(p.textContent=p.textContent.replace(/(\r\n|\n|\r)/gm,""),p.textContent=p.textContent.replace(/\s+/g," "),d.whiteSpace&&d.whiteSpace!=="nowrap"&&(u[x].wrap=!0,delete d.whiteSpace),Object.keys(d).length&&(d.border&&(["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(R){d[""+R]=d.border}),delete d.border),u[x].style=d),p.textContent&&(u[x].value=Ad(p.textContent.trim(),!0,!0)),m=n?"num-format":"number-format",p.getAttribute(m)&&(u[x].format=p.getAttribute(m),u[x].value&&p.getAttribute("cell-value")&&(u[x].value=Ad(p.getAttribute("cell-value").trim(),!0,!0))),p.getAttribute("colspan")&&parseInt(p.getAttribute("colspan"),10)>1&&(u[x].colSpan=parseInt(p.getAttribute("colspan"),10)),p.getAttribute("rowspan")&&parseInt(p.getAttribute("rowspan"),10)>1&&(u[x].rowSpan=parseInt(p.getAttribute("rowspan"),10)),u[x].colSpan>1&&u[x].rowSpan>1)for(var M=void 0,E=S,A=S+u[x].rowSpan;E<A;E++)for(var L=x,N=x+u[x].colSpan;L<N;L++)E===S&&L===x||(M=u[x].style?{style:pe({},u[x].style)}:{},E!==S&&(M.rowSpan=S-E),L!==x&&(M.colSpan=x-L),i[E]||(i[E]={cells:[]}),i[E].cells[L]=M);else if(u[x].colSpan>1)for(var E=x+1,A=x+u[x].colSpan;E<A;E++)u[E]={colSpan:x-E,style:pe({},d)};else if(u[x].rowSpan>1)for(var E=S+1,A=S+u[x].rowSpan;E<A;E++)i[E]||(i[E]={cells:[]}),i[E].cells[x]={rowSpan:S-E,style:pe({},d)};x=y}f=Math.max(f,u.length)}e.usedColIndex=f-1},o.prototype.getNewIndex=function(t,e){return t[e]&&(e++,e=this.getNewIndex(t,e)),e},o.prototype.cellStyle=function(t,e){var i=this,r,n;if(!e){r=t.querySelector("style")&&t.querySelector("style").innerHTML;var s=Object.keys(this.parent.commonCellStyle);if(s&&s.length&&r){var a=r.includes("td")?r.split("td")[1]:r;a=a.includes("{")?a.split("{")[1].split("}")[0]:a.split("}")[0],n={};for(var l=0;l<s.length;l++){var h=s[l],c=h.match(/[A-Z]/);c&&(h=h.replace(c[0],"-"+c[0].toLowerCase())),a.indexOf(h)>-1&&(n[s[l]]=a.split(h+":")[1].split(";")[0].trim())}}}return function(u,d,p){var f={},v;if(e)if(u.getAttribute("style"))v=u.getAttribute("style").split(";");else return f;else{if(v=[],r&&u.className&&r.includes(u.classList[0])){var m=r.split(u.classList[0]);v.push(m[m.length-1].split("{")[1].split("}")[0])}var y=[].slice.call(u.querySelectorAll("*"));y.unshift(u),y.forEach(function(b){b.getAttribute("style")&&v.push(b.getAttribute("style")),b.tagName==="B"&&v.push("font-weight:bold"),b.tagName==="I"&&v.push("font-style:italic"),b.tagName==="U"&&v.push("text-decoration:underline")}),Object.assign(f,p,d,n)}return v.length&&i.generateStyles(v,f),u.querySelector("S")&&(f.textDecoration=f.textDecoration?"underline line-through":"line-through"),f.textDecoration&&["underline","line-through","underline line-through","none"].indexOf(f.textDecoration)===-1&&(f.textDecoration="none"),f.textAlign&&["left","center","right"].indexOf(f.textAlign)===-1&&(f.textAlign="left"),f.verticalAlign&&["bottom","middle","top"].indexOf(f.verticalAlign)===-1&&(f.verticalAlign="bottom"),f.fontSize&&(f.fontSize=Math.round(parseFloat(f.fontSize.indexOf("px")>-1?(parseFloat(f.fontSize)*.75).toString():f.fontSize.indexOf("em")>-1?(parseFloat(f.fontSize)*16/1.3333).toString():f.fontSize))+"pt"),f.fontWeight&&["bold","normal"].indexOf(f.fontWeight)===-1&&(f.fontWeight=f.fontWeight>"599"?"bold":"normal"),f}},o.prototype.generateStyles=function(t,e){var i,r,n,s,a,l=["font-family","vertical-align","text-align","text-indent","color","white-space","font-weight","font-style","font-size","text-decoration","background","background-color"],h=["fontFamily","verticalAlign","textAlign","textIndent","color","whiteSpace","fontWeight","fontStyle","fontSize","textDecoration","backgroundColor","backgroundColor"],c=["border-bottom","border-top","border-right","border-left","border"],u=["borderBottom","borderTop","borderRight","borderLeft","border"];t&&t.length&&t.forEach(function(d){d.split(";").forEach(function(p){if(r=p.split(":")[0].trim(),i=l.indexOf(r),i>-1)r=p.split(":")[1].trim(),e[h[i]]=r;else if(i=c.indexOf(r),i>-1){if(r=p.split(":")[1].trim(),r==="none")r=void 0;else if(r.includes("pt")){n=r.split("pt"),s=n[0].split(" ");for(var f=0;f<s.length;f++)if(a=parseFloat(s[f]),a){s.splice(f,1),s.unshift((a/.75).toFixed(2)+"px"),n[0]=s.join(" ");break}r=n.join("")}e[u[i]]=r}})})},o.prototype.refreshOnInsertDelete=function(t){if(this.copiedInfo){if(t.model.id!==this.copiedInfo.sId)return;var e=this.copiedInfo.range;if(t.isInsert){if(t.modelType==="Column"){if(t.start<=e[3]){if(t.start<=e[1]){var i=t.end-t.start+1;e[1]+=i,e[3]+=i}else e[3]=e[1]+(t.start-e[1]-1);this.performAction()}}else if(t.start<=e[2]){if(t.start<=e[0]){var i=t.end-t.start+1;e[0]+=i,e[2]+=i}else e[2]=e[1]+(t.start-e[1]-1);this.performAction()}}else this.clearCopiedInfo()}},o.prototype.performAction=function(){var t=this.getCopyIndicator();t&&ra(this.parent,t,this.copiedInfo.range,"e-copy-indicator")},o.prototype.getClipboardEle=function(){return this.parent.element.getElementsByClassName("e-clipboard")[0]},o.prototype.getCopyIndicator=function(){return this.parent.element.getElementsByClassName("e-copy-indicator")[0]},o.prototype.getModuleName=function(){return"clipboard"},o.prototype.destroy=function(){this.removeEventListener();var t=this.getClipboardEle();se(t),this.parent=null},o})(),rE=(function(){function o(t){this.editorElem=null,this.editCellData={},this.isEdit=!1,this.isCellEdit=!0,this.isNewValueEdit=!0,this.isAltEnter=!1,this.curEndPos=null,this.curStartPos=null,this.uniqueColl="",this.uniqueActCell="",this.isSpill=!1,this.keyCodes={BACKSPACE:8,SPACE:32,TAB:9,DELETE:46,ESC:27,ENTER:13,FIRSTALPHABET:65,LASTALPHABET:90,FIRSTNUMBER:48,LASTNUMBER:59,FIRSTNUMPAD:96,LASTNUMPAD:111,SYMBOLSETONESTART:186,SYMBOLSETONEEND:192,SYMBOLSETTWOSTART:219,SYMBOLSETTWOEND:222,FIREFOXEQUALPLUS:61,FIREFOXMINUS:173,F2:113},this.formulaErrorStrings=["mismatched parentheses","requires 3 arguments","improper formula","empty expression","mismatched string quotes","wrong number of arguments","invalid arguments"],this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.isEdit&&this.cancelEdit(!0,!1),this.removeEventListener(),this.editorElem=null,this.formulaErrorStrings&&(this.formulaErrorStrings=[]),this.editCellData&&(this.editCellData={}),this.keyCodes&&(this.keyCodes={}),this.parent=null},o.prototype.addEventListener=function(){j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)?T.add(this.parent.element,"touchend",this.tapHandler,this):T.add(this.parent.element,"dblclick",this.dblClickHandler,this),this.parent.on(Bl,this.mouseDownHandler,this),this.parent.on(Ds,this.keyUpHandler,this),this.parent.on(mo,this.keyDownHandler,this),this.parent.on(ui,this.performEditOperation,this),this.parent.on(E0,this.initiateCurPosition,this),this.parent.on(T0,this.updateFormulaBarValue,this),this.parent.on(Rl,this.addressHandler,this),this.parent.on(DD,this.initiateRefSelection,this),this.parent.on(wd,this.refSelectionRender,this),this.parent.on(Kc,this.checkUniqueRange,this),this.parent.on(Ob,this.reApplyFormula,this),this.parent.on(su,this.sheetChangeHandler,this),this.parent.on(fr,this.readOnlyAlertHandler,this),this.parent.on(x0,this.finiteAlertHandler,this)},o.prototype.removeEventListener=function(){j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)?T.remove(this.parent.element,"touchend",this.tapHandler):T.remove(this.parent.element,"dblclick",this.dblClickHandler),this.parent.isDestroyed||(this.parent.off(Bl,this.mouseDownHandler),this.parent.off(Ds,this.keyUpHandler),this.parent.off(mo,this.keyDownHandler),this.parent.off(ui,this.performEditOperation),this.parent.off(E0,this.initiateCurPosition),this.parent.off(T0,this.updateFormulaBarValue),this.parent.off(Rl,this.addressHandler),this.parent.off(DD,this.initiateRefSelection),this.parent.off(wd,this.refSelectionRender),this.parent.off(Kc,this.checkUniqueRange),this.parent.off(Ob,this.reApplyFormula),this.parent.off(su,this.sheetChangeHandler),this.parent.off(fr,this.readOnlyAlertHandler),this.parent.off(x0,this.finiteAlertHandler))},o.prototype.getModuleName=function(){return"edit"},o.prototype.performEditOperation=function(t){var e=t.action;switch(e){case"renderEditor":if(this.renderEditor(),t.initLoad&&j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)){var i=this.parent.createElement("div",{className:"e-ss-focus-edit",attrs:{contentEditable:"true",inputmode:"none",tabindex:"-1"}}),r=this.parent.element.querySelector(".e-sheet-panel");r&&(r.style.position="relative",r.appendChild(i)),this.parent.element.onfocus=function(){Re(i)}}break;case"refreshEditor":this.refreshEditor(t.value,t.refreshFormulaBar,t.refreshEditorElem,t.isAppend,t.trigEvent),t.refreshCurPos&&this.setCursorPosition();break;case"startEdit":if(!this.isEdit)this.isNewValueEdit=t.isNewValueEdit,this.startEdit(t.address,t.value,t.refreshCurPos);else{var n=!1,s={isEdit:n};this.parent.notify(Kd,s),s.isEdit&&(this.isNewValueEdit=t.isNewValueEdit,this.startEdit(t.address,t.value,t.refreshCurPos))}break;case"endEdit":this.isEdit&&this.endEdit(t.refreshFormulaBar,null,t.isPublic);break;case"cancelEdit":this.isEdit&&this.cancelEdit(t.refreshFormulaBar);break;case"getCurrentEditValue":t.editedValue=this.editCellData.value,t.endFormulaRef!==void 0&&(t.endFormulaRef=this.endFormulaRef);break;case"refreshDependentCellValue":this.refreshDependentCellValue(t.rowIdx,t.colIdx);break;case"getElement":t.element=this.getEditElement(this.parent.getActiveSheet());break;case"focusEditorElem":this.editorElem.focus();break;case"getCurrentEditSheetIdx":t.sheetIndex=this.editCellData.sheetIndex;break}},o.prototype.keyUpHandler=function(t){if(this.isEdit){var e=this.getEditElement(this.parent.getActiveSheet());t.altKey&&t.keyCode===13?(t.target.classList.contains("e-formula-bar")?this.positionEditor(!0):(e.focus(),this.altEnter()),this.isAltEnter=!0):this.isCellEdit&&this.editCellData.value!==e.textContent&&t.keyCode!==16&&(!t.shiftKey||t.shiftKey&&!Yc(t.keyCode))&&this.refreshEditor(e.textContent,this.isCellEdit);var i=pt(this.editCellData.value,!0);if(i&&(!t||t.keyCode!==16&&t.keyCode!==17&&(!t.shiftKey||!Yc(t.keyCode)))&&(this.updateFormulaReference(e),this.endFormulaRef)){var r=this.getCurPosition(),n=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];r.end&&n.indexOf(this.editCellData.value[r.end-1])>-1&&(this.endFormulaRef=!1)}}},o.prototype.updateFormulaReference=function(t){this.removeRefIndicator(),this.editCellData.value!==t.textContent&&this.refreshEditor(t.textContent,!0);var e=this.editCellData.sheetIndex,i=this.editCellData.value;this.parent.notify(kl,{range:i,formulaSheetIdx:e})},o.prototype.keyDownHandler=function(t){var e=t.target,i=t.keyCode,r=this.parent.getActiveSheet(),n=xe(r.activeCell),s=Q(n[0],n[1],r,!1,!0),a=this.parent.enableKeyboardShortcut;if(!H(e,".e-spreadsheet .e-dialog")){if(!r.isProtected||e.classList.contains("e-sheet-rename")||!mn(s,Ht(r,n[1]))||(e.classList.contains("e-formula-bar")||e.classList.contains("e-combobox"))&&!e.disabled){if(this.isEdit){var l=this.getEditElement(r),h=pt(this.editCellData.value,!0);if((this.isCellEdit||h&&this.editCellData.value!==l.textContent&&t.keyCode!==16&&t.keyCode!==17)&&(l&&l.style.height!=="auto"&&(n[1]<this.parent.frozenColCount(r)&&(!r.frozenRows||n[0]>=this.parent.frozenRowCount(r))&&dr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.height="auto"),dr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)-5&&(l.style.height="auto")),n[0]<this.parent.frozenRowCount(r)&&l&&!l.style.overflow&&dr(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.overflow="auto"),(!t.shiftKey||t.shiftKey&&!Yc(t.keyCode))&&this.refreshEditor(l.textContent,this.isCellEdit,!1,!1,!1)),!t.altKey)switch(i){case this.keyCodes.ENTER:j.isWindows&&t.preventDefault(),h?(this.removeRefIndicator(),ke(this.parent,this.editCellData.sheetIndex).id===r.id?this.endEdit(!1,t):(this.parent.goTo(this.editCellData.fullAddr),this.isEdit&&this.endEdit(!1,t))):this.endEdit(!1,t);break;case this.keyCodes.TAB:this.hasFormulaSuggSelected()||this.endEdit(!1,t);break;case this.keyCodes.ESC:this.cancelEdit(!0,!0,t),this.removeRefIndicator();break}}else if(e.classList.contains("e-spreadsheet")||H(e,".e-sheet-panel")){i===13&&e.contentEditable==="true"&&t.preventDefault();var c=String.fromCharCode(i),u=i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||c.toLowerCase()!==c.toUpperCase()&&!(i>=112&&i<=123),d=i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER,p=i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD,f=i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND;f||(f=i>=this.keyCodes.SYMBOLSETTWOSTART&&i<=this.keyCodes.SYMBOLSETTWOEND);var v=i===this.keyCodes.FIREFOXEQUALPLUS||i===this.keyCodes.FIREFOXMINUS,m=!t.shiftKey&&!t.ctrlKey&&!t.metaKey&&i===this.keyCodes.F2&&a,y=i===this.keyCodes.BACKSPACE&&a,b=/(Macintosh|MacIntel|MacPPC|Mac68K|Mac|Mac OS|iPod|iPad)/i.test(navigator.userAgent)&&y,S=this.parent.element.querySelector(".e-readonly-alert-dlg"),C=this.parent.element.getElementsByClassName("e-ss-overlay-active");if((!t.ctrlKey&&!t.metaKey&&!t.altKey&&(!t.shiftKey&&i===this.keyCodes.SPACE||u||d||p||f||j.info.name==="mozilla"&&v)||m||y)&&(m&&(this.isNewValueEdit=!1),S||(Hi(this.parent)&&C.length===0?this.parent.notify(fr,null):C.length?y&&!b&&this.editingHandler("delete"):(this.startEdit(null,null,!0,!0),Re(this.getEditElement(r))))),(i===this.keyCodes.DELETE||b)&&a){var x=r.isProtected&&Ko(this.parent);S||(x?this.parent.notify(Ra,null):Hi(this.parent)&&C.length===0?this.parent.notify(fr,null):(this.editingHandler("delete"),this.parent.notify(vo,null)))}}}else if((i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER||i===this.keyCodes.DELETE||i===this.keyCodes.BACKSPACE||i===this.keyCodes.SPACE||i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD||i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND||i>=219&&i<=222||!t.shiftKey&&!t.ctrlKey&&!t.metaKey&&i===this.keyCodes.F2)&&i!==67&&i!==89&&i!==90){if(r.protectSettings.insertLink&&i===75||t.altKey&&(i===65||i===70||i===72||i===77||i===78||i===87))return;!t.ctrlKey&&t.keyCode!==70&&!this.parent.element.querySelector(".e-editAlert-dlg")&&!e.parentElement.classList.contains("e-unprotectpwd-content")&&!e.parentElement.classList.contains("e-password-content")&&!e.parentElement.classList.contains("e-sheet-password-content")&&!e.parentElement.classList.contains("e-unprotectsheetpwd-content")&&!e.parentElement.classList.contains("e-reenterpwd-content")&&this.parent.notify(Ra,null)}}},o.prototype.renderEditor=function(){if(!this.editorElem||!J("#"+this.parent.element.id+"_edit",this.parent.element)){var t=this.parent.createElement("div",{id:this.parent.element.id+"_edit",className:"e-spreadsheet-edit",attrs:{contentEditable:"true",role:"textbox",spellcheck:"false","aria-multiline":"true"}});this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0]&&this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0].remove();var e=this.parent.element.querySelector(".e-sheet-content");if(!e)return;e.appendChild(t),this.editorElem=t}this.parent.notify(Ol,{action:"renderAutoComplete"})},o.prototype.refreshEditor=function(t,e,i,r,n,s){n===void 0&&(n=!0),r?t=this.editCellData.value=this.editCellData.value+t:this.editCellData.value=s||t;var a=this.getEditElement(this.parent.getActiveSheet());i&&a&&(a.textContent=t),e&&this.parent.notify(ho,{action:"refreshFormulabar",value:t}),this.parent.isEdit&&a&&n&&this.editCellData.value===a.textContent&&this.triggerEvent("cellEditing").cancel&&this.cancelEdit(!1,!1,null,!0)},o.prototype.startEdit=function(t,e,i,r){i===void 0&&(i=!0),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true");var n=this.parent.getActiveSheet(),s=xe(n.activeCell),a=Q(s[0],s[1],n,!1,!0);if(this.parent.calculationMode==="Manual"&&pt(a.formula)&&(this.editCellData.prevFormulaValue=a.value),Jz(this.parent,s[0],s[1],this.parent.activeSheetIndex)){var l=this.parent.getCell(s[0],s[1]),h=!1,c=l.innerHTML;if(l&&c.indexOf("<")>-1&&c.indexOf(">")>-1&&c.indexOf("input")>-1&&(h=!0),h)return}var u=this.updateEditCellDetail(t,e);this.initiateEditor(i,u),this.positionEditor(),this.parent.isEdit=this.isEdit=!0,this.parent.notify($d,null),this.parent.notify(Ea,[{enable:!1}]),a.formula&&!r&&this.parent.notify(kl,{range:a.formula,formulaSheetIdx:this.editCellData.sheetIndex})},o.prototype.setCursorPosition=function(){var t=this.getEditElement(this.parent.getActiveSheet()),e=t.textContent.length;if(e){var i=document.getSelection(),r=document.createRange();r.setStart(t.firstChild,e),r.collapse(!0),i.removeAllRanges(),i.addRange(r)}t.focus()},o.prototype.hasFormulaSuggSelected=function(){var t=document.getElementById(this.parent.element.id+"_ac_popup");return t&&t.style.visibility==="visible"&&t.querySelectorAll(".e-item-focus").length>0},o.prototype.editingHandler=function(t){var e=document.getElementsByClassName("e-ss-overlay-active"),i=e.length,r;switch(t){case"delete":if(i>0)e[0].classList.contains("e-datavisualization-chart")?this.parent.notify(lu,{id:e[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.parent.notify(La,{id:e[0].id,sheetIdx:this.parent.activeSheetIndex+1});else{var n=this.parent.getActiveSheet(),s=n.selectedRange,a=Ji(s);a=a[0]>a[2]||a[1]>a[3]?tt(a):a,s=Ve(a);var l={address:n.name+"!"+s,cancel:!1};if(this.parent.notify(hi,{action:"cellDelete",eventArgs:l}),l.cancel)return;s=Gc(l.address),a=ie(s),tP(this.parent,a,this.parent.activeSheetIndex),this.parent.notify(Ta,{}),a[0]===0&&a[1]===0&&a[2]>=n.usedRange.rowIndex&&a[3]>=n.usedRange.colIndex&&this.parent.setUsedRange(0,0,n,!1,!0);var h={cellIdx:a,isUnique:!1};if(this.checkUniqueRange(h),h.isUnique){var c=ie(this.uniqueColl),u=Q(c[0],c[1],this.parent.getActiveSheet());u&&u.value&&(r=u.value.toString().indexOf("#SPILL!")>-1)}if(h.isUnique&&this.uniqueColl.split(":")[0]===s.split(":")[0]){for(var d=ie(this.uniqueColl),p=d[0];p<=d[2];p++)for(var f=d[1];f<=d[3];f++)this.parent.updateCellInfo({value:"",formula:""},Ve([p,f]),!0);this.parent.notify(zd,null),this.uniqueColl=""}else if(h.isUnique){var v=ie(this.uniqueColl);if(Q(v[0],v[1],n).value==="#SPILL!"){for(var m=!1,f=v[0];f<=v[2];f++)for(var y=v[1];y<=v[3];y++){var u=Q(f,y,n);f===v[0]&&y===v[1]?m=!1:u&&!g(u.value)&&u.value!==""&&(m=!0)}m||this.reApplyFormula()}}h.isUnique?this.parent.notify(wt,{action:"cellDelete",eventArgs:{address:n.name+"!"+s,isSpill:r}}):this.parent.notify(wt,{action:"cellDelete",eventArgs:{address:n.name+"!"+s}})}break}},o.prototype.getCurPosition=function(){var t={},e=window.getSelection();if(e&&e.focusNode&&e.focusNode.classList&&e.focusNode.classList.contains("e-formula-bar-panel")){var i=e.focusNode.getElementsByClassName("e-formula-bar e-css")[0];i.value===this.editCellData.value&&(t.start=i.selectionStart,t.end=i.selectionEnd)}else if(this.getEditElement(this.parent.getActiveSheet()).textContent===this.editCellData.value&&(t.start=e.anchorOffset,t.end=e.focusOffset,t.start>t.end)){var r=t.start;t.start=t.end,t.end=r}return t},o.prototype.mouseDownHandler=function(t){if(!H(t.target,".e-findtool-dlg")&&!H(t.target,".e-validation-error-dlg")&&this.isEdit){var e=this.getCurPosition(),i=void 0,r=void 0;e.start&&(this.curStartPos=i=e.start),e.end&&(this.curEndPos=r=e.end);var n=t.target,s=this.parent.getActiveSheet(),a=this.parent.element.querySelector(".e-formularef-indicator");this.isCellEdit=n.classList.contains("e-spreadsheet-edit");var l=pt(this.editCellData.value,!0),h=this.getEditElement(s),c=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];if(n.classList.contains("e-cell")||n.classList.contains("e-header-cell")||n.classList.contains("e-selectall")||H(n,".e-toolbar-item.e-active")||H(n,".e-table"))if(!l||this.endFormulaRef)this.endFormulaRef=!1,this.endEdit(!1,t);else{var u=xe(s.activeCell),d=Q(u[0],u[1],s),p=document.activeElement.classList.contains("e-formula-bar")?document.activeElement.value:h.textContent;if(this.editCellData.value===p)if(i===r){if(this.editCellData.sheetIndex!==Ct(this.parent,s.name)){if(c.indexOf(p.substring(i-1,i))===-1){a&&a.parentElement.removeChild(a),this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,t);return}}else if(c.indexOf(h.textContent.substring(i-1,i))===-1){a&&a.parentElement.removeChild(a),this.endEdit(!1,t);return}}else c.indexOf(p.substring(i-1,i))!==-1&&Or(p.substring(i,r))&&p.indexOf(":")!==r&&(this.editCellData.value=p.substring(0,i)+p.substring(r,p.length));if(!d)return;if(l=d.formula&&(pt(d.formula)||this.editCellData.value&&this.editCellData.value.toString().indexOf("=")===0),l&&this.parent.isEdit){var f=r;this.editCellData.value.length===f?(this.editCellData.value.substring(this.editCellData.value.length-1)===")"||De(this.editCellData.value.substring(this.editCellData.value.length-1)))&&(a&&a.parentElement.removeChild(a),this.endEdit(!1,t)):this.editCellData.value===p&&c.indexOf(p.substring(f-1,f))===-1&&(a&&a.parentElement.removeChild(a),this.endEdit(!1,t))}}else if(l&&this.editCellData.value===h.textContent&&h.textContent.indexOf("(")!==h.textContent.length-1&&!this.isCellEdit&&!n.classList.contains("e-formula-bar")&&c.indexOf(this.editCellData.value.substring(i-1,i))===-1&&ke(this.parent,this.editCellData.sheetIndex).id===s.id){var f=window.getSelection().focusOffset;if(c.indexOf(h.textContent.substring(f-1,f))===-1){a&&a.parentElement.removeChild(a),this.parent.goTo(this.editCellData.fullAddr),this.isEdit&&this.endEdit(!1,t);return}}}},o.prototype.tapHandler=function(t){var e=this;if(!this.tapedTwice){this.tapedTwice=!0,setTimeout(function(){if(e.tapedTwice=!1,!e.parent.isEdit&&t.target.classList.contains("e-cell")){var i=e.parent.element.querySelector(".e-ss-focus-edit");i&&Re(i)}},300);return}t.preventDefault(),this.dblClickHandler(t)},o.prototype.dblClickHandler=function(t){var e=t.target;if(!H(e,".e-datavisualization-chart")&&!e.classList.contains("e-ss-overlay")&&(e.classList.contains("e-active-cell")||e.classList.contains("e-cell")||e.classList.contains("e-wrap-content")||H(e,".e-sheet-content")||e.classList.contains("e-table"))){var i=this.parent.getActiveSheet(),r=xe(i.activeCell),n=Q(r[0],r[1],i,!1,!0);if(Pl(n,Ht(i,r[1]),Yr(i,r[0])))this.parent.notify(fr,null);else if(!i.isProtected||!mn(n,Ht(i,r[1])))if(this.isEdit){if(!e.classList.contains("e-spreadsheet-edit"))if(pt(this.editCellData.value)){var s=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!"));this.parent.getActiveSheet().name===s&&(this.endEdit(),this.removeRefIndicator())}else this.endEdit(),this.removeRefIndicator()}else this.isNewValueEdit=!1,this.startEdit(),Re(this.getEditElement(i));else this.parent.notify(Ra,null)}},o.prototype.updateEditCellDetail=function(t,e){var i,r,n;if(g(this.editCellData.sheetIndex)?t&&t.lastIndexOf("!")>-1?i=Ct(this.parent,na(t)):i=this.parent.activeSheetIndex:i=this.editCellData.sheetIndex,this.editCellData.addr?pt(this.editCellData.value,!0)&&(r=ke(this.parent,i),this.isNewValueEdit=!1):(r=ke(this.parent,i),t?t=Gc(t):t=r.activeCell),t){var s=ie(t),a=s[0],l=s[1],h=Q(a,l,r,!1,!0);if(h.colSpan>1||h.rowSpan>1){var c={sheet:r,cell:h,rowIdx:a,colIdx:l};W0(c),a=c.rowIdx,l=c.colIdx,n=c.isMergedHiddenCell}var u=this.parent.getCell(a,l),d=Y0(r,s,this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth);this.editCellData={addr:t,fullAddr:Gn(this.parent,i)+"!"+t,rowIndex:a,colIndex:l,sheetIndex:i,element:u,value:e||"",position:d,prevFormulaValue:this.editCellData.prevFormulaValue}}return n},o.prototype.initiateEditor=function(t,e){var i=this;Aa(this.parent,this.editCellData.fullAddr,!1,e).then(function(r){i.parent&&r.forEach(function(n){var s,a=function(){var c={cell:n,value:n?n.value:"",showFormattedText:i.editCellData.showFormattedText};i.parent.notify(Fb,c),s=n?n.formula||c.value:"",i.editCellData.oldValue=s};a();var l=i.triggerEvent("cellEdit",null,s);if(l.cancel){i.cancelEdit(!0,!1,null,!0);return}l.showFormattedText&&(i.editCellData.showFormattedText=!0,a()),i.editCellData.value?s=i.editCellData.value:i.editCellData.value=s;var h;i.isNewValueEdit?(h=s,s=""):i.isNewValueEdit=!0,Te(s)&&(s=""),i.refreshEditor(s,!1,!0,!1,!1,h),t&&i.setCursorPosition()})})},o.prototype.positionEditor=function(t){var e=this.editCellData.element,i=!1,r,n={isEdit:i};if(this.parent.notify(Kd,n),n.isEdit&&g(e)&&(r=this.parent.getCell(this.editCellData.rowIndex,this.editCellData.colIndex),e=r,this.editCellData.element=r),e){e.classList.add("e-ss-edited");var s=this.parent.getActiveSheet(),a=Q(this.editCellData.rowIndex,this.editCellData.colIndex,s,!1,!0),l=this.editCellData.position.left+1,h=this.editCellData.position.top+1,c={range:[this.editCellData.rowIndex,this.editCellData.colIndex,this.editCellData.rowIndex,this.editCellData.colIndex]};this.parent.notify(pr,c);var u=xi(s,c.range[0],c.range[2])-3,d=wi(s,c.range[1],c.range[3])-3,p=this.parent.getMainContent(),f=p.parentElement,v=void 0,m=this.parent.frozenColCount(s),y=void 0,b=void 0,S=this.parent.frozenRowCount(s),C=void 0;if(this.editCellData.colIndex<m)v=Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl?"left":"right"]-e.getBoundingClientRect()[this.parent.enableRtl?"right":"left"])-1,this.editCellData.rowIndex<S?this.parent.getRowHeaderContent().style.zIndex==="2"&&(y="3"):dr(a.value,a.style,this.parent.cellStyle)>v&&(C=!0);else{v=f.offsetWidth-(l-p.scrollLeft)-28-this.parent.sheetModule.getRowHeaderWidth(s);var x=e.getBoundingClientRect(),I=f.getBoundingClientRect(),D=this.parent.enableRtl?x.left:x.right,M=this.parent.enableRtl?I.left:I.right,E=this.parent.getScrollElement(),A=this.parent.sheetModule.getScrollSize();this.parent.enableRtl?M+A>D&&(E.scrollLeft-=x.width):M-A<D&&(E.scrollLeft+=x.width)}this.editCellData.rowIndex<S&&(b=!0);var L=!b&&(a&&a.wrap||e&&t||C)?"auto;":u+"px;",N="display:block;top:"+h+"px;"+(this.parent.enableRtl?"right:":"left:")+l+"px;min-width:"+d+"px;max-width:"+(a&&a.wrap?d:v)+"px;height:"+L+(a&&a.wrap?"width:"+d+"px;":"")+"min-height:"+u+"px;"+(y?"z-index: "+y+";":"")+(b&&(a&&!a.wrap||e&&t)&&(dr(a.value,a.style,this.parent.cellStyle)>v||e&&t)?"overflow: auto;":""),R=e.style.cssText.split(";");R.forEach(function(B){B.includes("border")||(N+=B+";")});var P=this.getEditElement(s,!0);P.style.cssText=N,dr(P.textContent,a.style,this.parent.cellStyle)>v&&(P.style.height="auto");var k=this.parent.element.querySelector(".e-active-cell");k&&(k.style.height=u+4+"px"),e.classList.contains("e-right-align")?P.classList.add("e-right-align"):e.classList.contains("e-center-align")&&P.classList.add("e-center-align")}},o.prototype.updateEditedValue=function(t,e,i,r){var n=this,s=this.editCellData.oldValue;e&&(this.editCellData.value=e);var a=this.editCellData.value;this.parent.notify(Hh,{args:{action:"beforeCellSave",eventArgs:{address:this.editCellData.addr}}});var l=!0;if(this.parent.allowDataValidation){var h=this.parent.getActiveSheet(),c=ie(h.activeCell),u=Q(c[0],c[1],h,!1,!0),d=Ht(h,c[1]);if(u.validation||hs(d,c[0],c[1])){var p=this.editCellData.value||this.getEditElement(h).innerText,f=this.parent.activeSheetIndex,v=typeof this.editCellData.addr=="string"?ie(this.editCellData.addr):this.editCellData.addr,m={value:p,range:v,sheetIdx:f,isEdit:!0,td:null,isValid:!0},y=Object.assign({},u,{value:p});Zt(c[0],c[1],h,y),this.parent.notify(Bb,m),Zt(c[0],c[1],h,u),l=m.isValid,l?pt(p)||!u.format?this.editCellData.value||(this.editCellData.value=p):(p!==m.value||!this.editCellData.value&&m.value)&&(this.editCellData.value=m.value):this.isCellEdit=!0}}if(!r&&pt(this.editCellData.value)){var b={formula:this.editCellData.value};if(this.parent.notify(OM,b),b.isInvalid){var S;this.isCellEdit=!0,l=!1;var C=this.parent.serviceLocator.getService(ve),x=this.parent.serviceLocator.getService(jt);x.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg",content:C.getConstant("CellReferenceTypoError")+"<br>"+b.formula,beforeOpen:function(){return n.editCellData.element.focus()},buttons:[{buttonModel:{content:C.getConstant("Yes"),isPrimary:!0},click:function(){S=!0,x.hide()}},{buttonModel:{content:C.getConstant("No")},click:function(){return x.hide()}}],close:function(){if(S)e=n.editCellData.value=b.formula,n.updateCell(s,t,e,a,i),n.parent.notify(ho,{action:"refreshFormulabar",value:b.formula});else{var I=n.getEditElement(n.parent.getActiveSheet());I.innerText&&window.getSelection().selectAllChildren(I)}}},!1)}}l?this.updateCell(s,t,e,a,i):i&&i.preventDefault()},o.prototype.updateCell=function(t,e,i,r,n){var s=t?t.toString().toUpperCase():"",a=this.parent.getActiveSheet();(t||t===0)&&(t=t.toString());var l=this.editCellData.value;l&&(l=l.toString());var h=t!==l||pt(s);if(h){this.isAltEnter&&l&&l.includes(`
`)&&(_c(a.activeCell,!0,this.parent,!0),this.refreshEditor(l,this.isCellEdit,!1,!1,!1));var c=ie(a.activeCell);t&&t.indexOf("=UNIQUE(")>-1&&this.editCellData.value===""&&this.parent.notify(zd,null);var u={cellIdx:c,isUnique:!1};this.checkUniqueRange(u);var d=u.isUnique;if(d&&t!==""&&this.editCellData.value===""){var p=ie(this.uniqueColl);if(Q(p[0],p[1],a).value.toString().indexOf("#SPILL!")===-1)return}t&&t.indexOf("UNIQUE")>-1&&this.editCellData.value&&this.editCellData.value.toString().indexOf("UNIQUE")>-1&&d&&this.updateUniqueRange("");var f={action:"updateCellValue",address:this.editCellData.addr,value:this.editCellData.value,skipCellFormat:this.editCellData.showFormattedText};this.parent.notify(Xc,f);var v=Q(c[0],c[1],a,!0),m=void 0;!g(v)&&!g(v.value)&&(m=v.value.toString());var y=m==="#CIRCULARREF!",b=this.formulaErrorStrings.indexOf(m)>-1;if(b||y){var S=void 0;if(n){var C=n.target,x=["e-toolbar-item","e-tab-wrap","e-text-wrap","e-tab-text","e-caret"],I=["e-scroller","e-main-panel","e-autofill"];(!x.some(function(P){return C.classList.contains(P)})||!H(C,".e-ribbon"))&&!I.some(function(P){return C.classList.contains(P)})&&(S=this.showFormulaAlertDlg(m,y)),S||n.preventDefault()}if(S)v.value="0";else{delete v.value,delete v.formula,this.parent.notify($c,{cellRef:a.activeCell,clearFormulaInfo:!0}),pt(s)?this.parent.updateCellInfo({formula:s},a.activeCell):t&&this.parent.updateCellInfo({value:t},a.activeCell);return}}var D=void 0;f.isFormulaDependent&&(D=Az(this.parent,this.parent.viewport));var M=Q(c[0],c[1],a,!0),E=this.getRefreshNodeArgs(M,this.editCellData.element,this.editCellData.rowIndex,this.editCellData.colIndex);if(this.editCellData.value=E.value,this.parent.notify(Xo,{cell:null,rIdx:this.editCellData.rowIndex,cIdx:this.editCellData.colIndex,viewportIndexes:D}),M&&M.formula&&(this.editCellData.formula=M.formula),e&&this.parent.refreshNode(this.editCellData.element,E),M&&M.hyperlink&&this.parent.serviceLocator.getService("cell").refreshRange(c),a.conditionalFormats&&a.conditionalFormats.length&&this.parent.notify(Gi,{indexes:[this.editCellData.rowIndex,this.editCellData.colIndex],isAction:!0,refreshAll:f.isFormulaDependent,isEdit:!0}),M&&M.wrap&&this.parent.notify(sa,{range:c,wrap:!0,sheet:a}),d){var p=ie(this.uniqueColl);if(Q(p[0],p[1],a).value.toString().indexOf("#SPILL!")>-1&&(this.isSpill=!0),t!==""&&this.editCellData.value===""||this.editCellData.formula&&this.editCellData.formula.length>1&&t!==this.editCellData.formula){for(var A=!1,L=p[0];L<=p[2];L++)for(var N=p[1];N<=p[3];N++){var R=Q(L,N,a);L===p[0]&&N===p[1]?A=!1:R&&!g(R.value)&&R.value!==""&&(A=!0)}A||this.reApplyFormula()}else this.updateUniqueRange(r)}}else if(this.editCellData.value&&this.editCellData.value.toString().includes(`
`)){var M=Q(this.editCellData.rowIndex,this.editCellData.colIndex,a,!1,!0);M&&!M.wrap&&_c(a.activeCell,!0,this.parent,!0)}this.triggerEvent("cellSave",n,i),this.resetEditState(),this.focusElement(n)},o.prototype.checkUniqueRange=function(t){var e={range:[]};this.parent.notify(xM,e);var i=e.range;t.sheetName||(t.sheetName=this.parent.getActiveSheet().name);for(var r=0;r<i.length;r++)if(i[r].substring(0,i[r].lastIndexOf("!"))===t.sheetName){for(var n=ie(i[r]),s=n[0];s<=n[2];s++)for(var a=n[1];a<=n[3];a++)if(t.cellIdx[0]===s&&t.cellIdx[1]===a){t.isUnique=!0,this.uniqueCell=!0;var l=this.uniqueColl!==""?ie(this.uniqueColl):[0,0,0,0],h=ie(i[r]);if(l[0]===h[0]&&l[1]===h[1]){var c=[l[0],h[1],l[0],h[1]];c[2]=l[2]>h[2]?l[2]:h[2],c[3]=l[3]>h[3]?l[3]:h[3],this.uniqueColl=Ve(c),t.uniqueRange=Ve(c)}else this.uniqueColl=i[r],t.uniqueRange=i[r]}}},o.prototype.updateUniqueRange=function(t){var e=ie(this.uniqueColl),i=!1;Q(e[0],e[1],this.parent.getActiveSheet()).value!=="#SPILL!"&&(i=!0);for(var r=e[0];r<=e[2];r++)for(var n=e[1];n<=e[3];n++)i&&(r===e[0]&&n===e[1]?this.parent.updateCellInfo({value:"#SPILL!"},Ve([r,n]),!0):Ve([r,n]).split(":")[0]===this.editCellData.addr?this.parent.updateCellInfo({value:t},Ve([r,n]),!0):this.parent.updateCellInfo({value:""},Ve([r,n]),!0))},o.prototype.reApplyFormula=function(){var t=ie(this.uniqueColl),e=Q(t[0],t[1],this.parent.getActiveSheet());this.parent.updateCellInfo({value:""},Ve([t[0],t[1]]),!0);for(var i=this.parent.sheets,r=e.formula,n=0;n<i.length;n++)r.indexOf(i[n].name)>-1&&(r=r.replace(i[n].name,"!"+n));this.parent.notify(At,{action:"computeExpression",formula:r}),this.uniqueCell=!1,this.uniqueActCell!==""&&(this.editCellData.value=this.uniqueActCell,this.uniqueActCell="")},o.prototype.refreshDependentCellValue=function(t,e){if(t&&e&&(t--,e--,this.editCellData.rowIndex!==t||this.editCellData.colIndex!==e||this.uniqueCell)){var i=this.parent.getActiveSheet(),r=void 0;if(!lt(i,t)&&!Ft(i,e)&&(r=this.parent.getCell(t,e)),r){var n=r.parentElement;if(n){var s=n.getAttribute("aria-rowindex");if(s&&Number(s)-1!==t)return;var a=r.getAttribute("aria-colindex");if(a&&Number(a)-1!==e)return}var l=Q(t,e,i),h=ie(i.activeCell);h[0]===t&&h[1]===e&&(this.uniqueActCell=l.value);var c=this.getRefreshNodeArgs(l,r,t,e);this.parent.refreshNode(r,c)}}},o.prototype.getRefreshNodeArgs=function(t,e,i,r){t=t||{};var n={value:t.value,format:t.format,formattedText:t.formattedText&&t.formattedText!==""?t.formattedText:t.value,isRightAlign:!1,type:"General",cell:t,rowIndex:i,td:e,colIndex:r,refresh:!0,isEdit:!0};return this.parent.notify(yr,n),n},o.prototype.endEdit=function(t,e,i){t===void 0&&(t=!1),t&&this.refreshEditor(this.editCellData.oldValue,!1,!0,!1,!1);var r=this.triggerEvent("beforeCellSave");if(r.cancel){this.parent.isEdit&&e&&e.preventDefault();return}if(!this.isAltEnter&&r.value&&r.value.toString().indexOf(`
`)>-1){var n=Q(this.editCellData.rowIndex,this.editCellData.colIndex,this.parent.getActiveSheet());_c(this.parent.getActiveSheet().activeCell,n?n.wrap!==!1:!0,this.parent),this.refreshEditor(r.value,this.isCellEdit,!1,!1,!1)}this.updateEditedValue(!0,r.value,e,i)},o.prototype.cancelEdit=function(t,e,i,r){t===void 0&&(t=!0),e===void 0&&(e=!0),this.refreshEditor(this.editCellData.oldValue,t,!1,!1,!1),r||(e?this.triggerEvent("cellSave",i,void 0,!0):this.triggerEvent("cellEdited")),this.resetEditState(),this.focusElement()},o.prototype.focusElement=function(t){if(t&&t.keyCode===9&&document.activeElement.classList.contains("e-formula-bar")){var e=this.parent.element.querySelector(".e-formula-bar-panel "+(t.shiftKey?".e-insert-function":".e-combobox"));e&&Re(e)}else Re(this.parent.element);this.parent.notify(Ea,[{enable:!0}])},o.prototype.triggerEvent=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=Q(this.editCellData.rowIndex,this.editCellData.colIndex,n),a={element:this.editCellData.element,value:i||this.editCellData.value,oldValue:this.editCellData.oldValue,address:this.editCellData.fullAddr,displayText:this.parent.getDisplayText(s),previousFormulaValue:this.editCellData.prevFormulaValue};if(a.address){var l=ie(a.address),h={cellIdx:l,isUnique:!1};this.checkUniqueRange(h),h.isUnique&&(a.isSpill=this.isSpill)}var c=(a.value||a.value===0?a.value.toString():"")!==(a.oldValue||a.oldValue===0?a.oldValue.toString():"");if(c||!r&&pt(a.value)&&(!s||!s.format||en(s.format)!=="Text")){if(t!=="cellSave"&&(a.cancel=!1),t==="beforeCellSave"){this.parent.notify(hi,{eventArgs:a,action:"cellSave",preventAction:!0}),s=pt(a.value)?{formula:a.value}:{value:a.value};var u=gr(this.parent,n,{cell:s,rowIdx:this.editCellData.rowIndex,colIdx:this.editCellData.colIndex,eventOnly:!0});if(u)return this.cancelEdit(!1,!1,null,!0),a.cancel=!0,a}this.parent.trigger(t,a),t==="cellSave"&&(this.parent.trigger("cellEdited",a),this.editCellData.formula?a.formula=this.editCellData.formula:c||(a.formula=a.value),s.format&&(a.format=s.format),a.originalEvent=e,this.parent.notify(wt,{eventArgs:a,action:"cellSave"}))}else t!=="beforeCellSave"&&(t==="cellSave"?this.parent.trigger("cellEdited",a):this.parent.trigger(t,a));return a},o.prototype.altEnter=function(){this.positionEditor(!0);var t=window.getSelection(),e=t.anchorNode,i,r=document.createRange();i=e.nodeType===3?t.anchorOffset:e.textContent.length,i===0&&e.textContent.length>0&&(i=e.textContent.length);var n=e.textContent,s=n.slice(0,i),a=n.slice(i)||" ";e.textContent=s+`
`+a,r=document.createRange(),e.nodeType===3?(r.setStart(e,i+1),r.setEnd(e,i+1)):e.nodeType===1&&(r.setStart(e.firstChild,i+1),r.setEnd(e.firstChild,i+1)),t.removeAllRanges(),t.addRange(r)},o.prototype.resetEditState=function(t){if(t===void 0&&(t=!0),t){var e=this.getEditElement(this.parent.getActiveSheet());(pt(e.textContent)||e.textContent==="")&&this.parent.notify(MD,null),this.editCellData.element&&(this.editCellData.element.classList.remove("e-ss-edited"),this.editorElem.textContent="",e===this.editorElem?(this.editorElem.removeAttribute("style"),this.editorElem.classList.remove("e-right-align")):se(e))}if(this.editCellData={},this.parent.isEdit=this.isEdit=!1,this.isCellEdit=!0,this.isAltEnter=!1,this.parent.notify(Ol,{action:"endEdit"}),this.parent.showSheetTabs&&!this.parent.isProtected){var i=this.parent.element.querySelector(".e-add-sheet-tab");i&&i.removeAttribute("disabled")}},o.prototype.refSelectionRender=function(){var t=this.getEditElement(this.parent.getActiveSheet());t&&(pt(t.textContent)&&this.parent.notify(kl,{range:t.textContent,formulaSheetIdx:this.editCellData.sheetIndex}),t=this.parent.getCell(this.editCellData.rowIndex,this.editCellData.colIndex),t&&(this.editCellData.element=t))},o.prototype.initiateRefSelection=function(){var t=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!")),e=this.editCellData.value;this.parent.getActiveSheet().name===t&&pt(this.editCellData.value,!0)?(this.startEdit(this.editCellData.addr,e,!1),this.parent.notify(kl,{range:this.editCellData.value,formulaSheetIdx:this.editCellData.sheetIndex}),this.getEditElement(this.parent.getActiveSheet()).textContent=e,this.initiateCurPosition()):this.initiateCurPosition()},o.prototype.addressHandler=function(t){var e=this.parent.serviceLocator.getService(jt).dialogInstance;if(e&&e.element&&e.element.classList.contains("e-validation-error-dlg")){t.isAlertDlgOpen=!0;return}if(!this.curStartPos){var i=this.getCurPosition();i.start&&(this.curStartPos=i.start),i.end&&(this.curEndPos=i.end)}var r=t.range,n=this.editCellData.sheetIndex,s=this.getEditElement(this.parent.getActiveSheet());r=this.getMergedAddress(r),this.parent.activeSheetIndex!==n&&(r="'"+this.parent.getActiveSheet().name+"'!"+r,t.isNameBoxSelect&&(n=this.parent.activeSheetIndex));var a=this.editCellData.value;if(t.isSelect)this.parent.notify(kl,{range:a+r,formulaSheetIdx:n});else if(this.parent.activeSheetIndex===n){var l=document.activeElement.classList.contains("e-formula-bar")?document.activeElement.value:s.textContent;t.isNameBoxSelect&&(this.parent.notify(kl,{range:a+r,formulaSheetIdx:n}),this.curStartPos=a.length);var h=void 0,c=void 0;t.isMouseDown&&l!==a?(h=l.substring(0,this.curEndPos)+this.parent.listSeparator,c=l.substring(this.curEndPos),this.refreshEditor(h+c,!1,!0),this.parent.notify(kl,{range:s.textContent,formulaSheetIdx:n}),this.curEndPos+=this.parent.listSeparator.length,this.curStartPos=this.curEndPos,h+=r):(h=a.substring(0,this.curStartPos)+r,c=a.substring(this.curStartPos),t.isNameBoxSelect&&this.refreshEditor(h+c,!0,!0)),s.textContent=h+c,this.curEndPos=h.length}},o.prototype.updateFormulaBarValue=function(t){var e=this.editCellData.value,i=this.parent.getActiveSheet().selectedRange.split(" "),r=i[i.length-1];r=ug(Ji(r))?r.split(":")[0]:r,r=this.getMergedAddress(r);var n=this.parent.element.querySelector(".e-formula-bar");if(e&&pt(e,!0)){var s=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.lastIndexOf("!")),a=this.parent.getActiveSheet().name!==s;a&&(r="'"+this.parent.getActiveSheet().name+"'!"+r);var l=void 0,h=void 0;a&&t.isMouseDown&&i.length>1&&t.formulaBarVal&&t.formulaBarVal!==e?(l=t.formulaBarVal.substring(0,this.curEndPos)+this.parent.listSeparator,h=t.formulaBarVal.substring(this.curEndPos),this.refreshEditor(l+h,!0),this.curEndPos+=this.parent.listSeparator.length,this.curStartPos=this.curEndPos,l+=r):(l=e.substring(0,this.curStartPos)+r,h=e.substring(this.curStartPos)),n.value=l+h,this.curEndPos=l.length}},o.prototype.getMergedAddress=function(t){var e=ie(t);if(e[0]!==e[2]||e[1]!==e[3]){var i=Q(e[0],e[1],this.parent.getActiveSheet());if(i&&(i.rowSpan||i.colSpan)){var r={range:[e[0],e[1],e[0],e[1]]};this.parent.notify(uo,r);var n=r.range;if(e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3])return st(n[0],n[1])}}return t},o.prototype.setFormulaBarCurPosition=function(t,e,i){t.setSelectionRange&&(t.focus(),t.selectionStart=e,t.selectionEnd=e,t.setSelectionRange(e,i))},o.prototype.initiateCurPosition=function(t){t===void 0&&(t={isCellEdit:!1});var e=this.getEditElement(this.parent.getActiveSheet(),!0);if(t.isCellEdit){var i=this.getCurPosition();if(!this.endFormulaRef&&i.start===i.end){this.updateFormulaReference(e);var r=["+","-","*","/",this.parent.listSeparator,"(","=","&",":"];i.end&&r.indexOf(this.editCellData.value[i.end-1])===-1&&(this.endFormulaRef=!0)}return}var n=e.innerText,s=window.getSelection();if(s&&s.focusNode&&s.focusNode.classList&&s.focusNode.classList.contains("e-formula-bar-panel")){var a=this.parent.element.querySelector(".e-formula-bar");this.setFormulaBarCurPosition(a,this.curEndPos,this.curEndPos);return}if(n){var l=document.createRange();n.indexOf(")")===n.length-1?(l.setStart(e.childNodes[0],this.curEndPos),l.setEnd(e.childNodes[0],this.curEndPos)):(l.setStart(e.childNodes[0],this.curEndPos),l.setEnd(e.childNodes[0],this.curEndPos)),s.removeAllRanges(),s.addRange(l)}var h=this.editCellData.sheetIndex;if(h!==this.parent.activeSheetIndex){var c=this.parent.element.querySelector(".e-formula-bar");c&&c.value&&(c.value.indexOf(")")===this.curEndPos-1?this.setFormulaBarCurPosition(c,this.curEndPos-1,this.curEndPos-1):this.setFormulaBarCurPosition(c,this.curEndPos,this.curEndPos))}},o.prototype.getEditElement=function(t,e){if((this.isEdit||e)&&(t.frozenRows||t.frozenColumns)){var i=this.parent.frozenRowCount(t),r=this.parent.frozenColCount(t),n=xe(t.activeCell),s=void 0;if(n[0]<i&&n[1]<r)s=this.parent.getSelectAllContent();else if(n[0]<i)s=this.parent.getColumnHeaderContent();else if(n[1]<r)s=this.parent.getRowHeaderContent();else return this.editorElem;var a=s.getElementsByClassName("e-spreadsheet-edit")[0];return!a&&e&&(a=s.appendChild(this.editorElem.cloneNode())),a}return this.editorElem},o.prototype.sheetChangeHandler=function(){this.isEdit||(this.editCellData.value=null)},o.prototype.showFormulaAlertDlg=function(t,e){var i=this,r=this.parent.serviceLocator.getService(ve),n=this.parent.serviceLocator.getService("dialog"),s,a=this.getFormulaErrorKey(t),l,h=r.getConstant(a),c=n.dialogInstance;return c&&c.visible&&c.element.classList.contains("e-circularref-dlg")||n.show({width:400,isModal:!0,showCloseIcon:!0,target:this.parent.element,cssClass:"e-validation-error-dlg e-circularref-dlg",content:h,beforeOpen:function(u){if(e){var d=i.parent.getActiveSheet(),p={dialogName:"CircularReferenceDialog",element:u.element,target:u.target,cancel:u.cancel,cellAddress:d.name+"!"+d.activeCell,content:h};if(i.parent.trigger("dialogBeforeOpen",p),p.cancel){u.cancel=l=!0;return}else p.content!==h&&(n.dialogInstance.content=p.content,n.dialogInstance.dataBind())}if(window.getSelection().rangeCount>0){var f=window.getSelection().getRangeAt(0);s=f.endOffset}},buttons:[{buttonModel:{content:r.getConstant("Ok"),isPrimary:!0},click:function(){return n.hide()}}],close:function(){if(!l){var u=i.getEditElement(i.parent.getActiveSheet());if(u.childElementCount){var d=u.textContent;s=d.length,u.textContent=d}var p=document.getSelection(),f=document.createRange();f.setStart(u.firstChild,s),f.collapse(!0),p.removeAllRanges(),p.addRange(f),u.focus()}}},!1),l},o.prototype.getFormulaErrorKey=function(t){var e;switch(t){case"invalid arguments":e="InvalidArguments";break;case"improper formula":e="ImproperFormula";break;case"empty expression":e="EmptyExpression";break;case"mismatched parentheses":e="MismatchedParenthesis";break;case"mismatched string quotes":e="MismatchedStringQuotes";break;case"wrong number of arguments":e="WrongNumberOfArguments";break;case"requires 3 arguments":e="Requires3Arguments";break;case"#CIRCULARREF!":e="FormulaCircularRef";break;default:e="InvalidFormulaError"}return e},o.prototype.readOnlyAlertHandler=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService("dialog"),r=this.parent.element.querySelector(".e-find-dlg"),n;g(r)||(n=ot(r,"dialog")),i.show({content:e.getConstant("ReadonlyAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-readonly-alert-dlg",beforeOpen:function(s){var a={dialogName:"ReadOnlyAlertDialog",content:e.getConstant("ReadonlyAlert"),element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(i.dialogInstance.content=a.content,Re(t.parent.element))},close:function(){g(r)||(i.dialogInstance=n),Re(t.parent.element)}})},o.prototype.removeRefIndicator=function(){var t=this.parent.element.querySelector(".e-formularef-indicator");t&&t.parentElement.removeChild(t)},o.prototype.finiteAlertHandler=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.serviceLocator.getService("dialog");e.show({header:t.getConstant("Alert"),content:t.getConstant("FiniteAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-finite-alert-dlg"})},o})(),nE=(function(){function o(t){this.invalidOperators=["%"],this.formulaRange=[],this.isNoteActiveElement=!1,this.isNoteTouch=!1,this.parent=t,this.addEventListener(),this.mouseMoveEvt=this.mouseMoveHandler.bind(this)}return o.prototype.addEventListener=function(){this.parent.on(Ln,this.init,this),this.parent.on(Bl,this.mouseDownHandler,this),this.parent.on(co,this.virtualContentLoadedHandler,this),this.parent.on(Pc,this.cellNavigateHandler,this),this.parent.on(tu,this.selectRange,this),this.parent.on(Fn,this.rowHeightChanged,this),this.parent.on(Qn,this.colWidthChanged,this),this.parent.on(I0,this.protectHandler,this),this.parent.on(kl,this.initiateFormulaSelection,this),this.parent.on(MD,this.clearBorder,this),this.parent.on(Is,this.getRowIdxFromClientY,this),this.parent.on(Ms,this.getColIdxFromClientX,this),this.parent.on(Ud,this.getRowIdxFromClientY,this),this.parent.on(Wd,this.getColIdxFromClientX,this),this.parent.on(xd,this.chartBorderHandler,this),this.parent.on(Bg,this.isTouchSelectionStarted,this),this.parent.on(XM,this.selectionByKeydown,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ln,this.init),this.parent.off(Bl,this.mouseDownHandler),this.parent.off(co,this.virtualContentLoadedHandler),this.parent.off(Pc,this.cellNavigateHandler),this.parent.off(tu,this.selectRange),this.parent.off(Fn,this.rowHeightChanged),this.parent.off(Qn,this.colWidthChanged),this.parent.off(I0,this.protectHandler),this.parent.off(kl,this.initiateFormulaSelection),this.parent.off(MD,this.clearBorder),this.parent.off(Is,this.getRowIdxFromClientY),this.parent.off(Ms,this.getColIdxFromClientX),this.parent.off(Ud,this.getRowIdxFromClientY),this.parent.off(Wd,this.getColIdxFromClientX),this.parent.off(xd,this.chartBorderHandler),this.parent.off(Bg,this.isTouchSelectionStarted),this.parent.off(XM,this.selectionByKeydown))},o.prototype.isTouchSelectionStarted=function(t){t.touchSelectionStarted=this.touchSelectionStarted},o.prototype.selectionByKeydown=function(t){this.selectRangeByIdx(t.range,t.e,!1,!1,!1,!1,void 0,!1)},o.prototype.rowHeightChanged=function(t){var e=this;t.threshold&&er(function(){if(e.parent){var i=e.parent.getActiveSheet(),r=e.getActiveCell();if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){e.selectRange({address:i.selectedRange,isRowHeightChanged:!0});return}var n=tt(ie(i.selectedRange)),s={range:n,isActiveCell:!1,skipChecking:!0},a;if(r){var l=xe(i.activeCell)[0];if(e.parent.notify(uo,s),s.isActiveCell){var h=Q(n[0],n[1],i,!1,!0);a=h.rowSpan>1&&n[0]<=t.rowIdx&&n[2]>=t.rowIdx}l===t.rowIdx||a?r.style.height=parseFloat(r.style.height)+t.threshold+"px":l>t.rowIdx&&(r.style.top=parseFloat(r.style.top)+t.threshold+"px")}if(r=e.getSelectionElement(),r){if(a||n[0]===n[2]&&n[1]===n[3])return;var c=n[0],u=n[2];c<=t.rowIdx&&u>=t.rowIdx&&r?r.style.height=parseFloat(r.style.height)+t.threshold+"px":c>t.rowIdx&&r&&(r.style.top=parseFloat(r.style.top)+t.threshold+"px")}}})},o.prototype.colWidthChanged=function(t){var e=this;t.threshold&&er(function(){if(e.parent){var i=e.parent.getActiveSheet(),r=e.getActiveCell(),n=e.parent.enableRtl;if(r&&(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" "))){e.selectRange({address:i.selectedRange});return}var s=tt(ie(i.selectedRange)),a={range:s,isActiveCell:!1,skipChecking:!0},l;if(r){e.parent.notify(uo,a);var h=xe(i.activeCell)[1];if(a.isActiveCell){var c=Q(s[0],s[1],i,!1,!0);l=c.rowSpan>1||c.colSpan>1}h===t.colIdx||l?r.style.width=parseFloat(r.style.width)+t.threshold+"px":h>t.colIdx&&(n?r.style.right=parseFloat(r.style.right)+t.threshold+"px":r.style.left=parseFloat(r.style.left)+t.threshold+"px")}if(r=e.getSelectionElement(),!(!r||l||s[0]===s[2]&&s[1]===s[3])){var u=s[1],d=s[3];u<=t.colIdx&&d>=t.colIdx&&r?r.style.width=parseFloat(r.style.width)+t.threshold+"px":u>t.colIdx&&r&&(n?r.style.right=parseFloat(r.style.right)+t.threshold+"px":r.style.left=parseFloat(r.style.left)+t.threshold+"px")}}})},o.prototype.selectRange=function(t){t.address=this.parent.selectionSettings.mode==="Single"?Ve(xe(t.address)):t.address,this.selectMultiRange(t.address,null,null,t.skipChecking,t.isRowHeightChanged)},o.prototype.init=function(){this.createSelectionElement();var t=this.parent.getActiveSheet(),e=tt(ie(t.selectedRange)),i=xe(t.activeCell),r=e[0]<=i[0]&&e[2]>=i[0]&&e[1]<=i[1]&&e[3]>=i[1];this.selectMultiRange(t.selectedRange,!0,r)},o.prototype.selectMultiRange=function(t,e,i,r,n){var s=this,a=this.parent.activeSheetIndex;t.indexOf("!")>-1&&(a=Ct(this.parent,na(t)),t=t.substring(t.lastIndexOf("!")+1)),this.parent.activeSheetIndex===a?t.split(" ").forEach(function(l,h){s.selectRangeByIdx(ie(l),{type:"mousedown",ctrlKey:h!==0},null,i,e,r,void 0,!1,n)}):lg(this.parent,t,this.parent.sheets[a])},o.prototype.createSelectionElement=function(){var t=this.parent.getMainContent(),e=this.parent.createElement("div",{className:"e-selection"});t.appendChild(e),e=this.parent.createElement("div",{className:"e-active-cell"}),t.appendChild(e)},o.prototype.isMergeActiveCell=function(t,e,i,r){var n=Q(i,r,t,!1,!0);if(n.rowSpan&&n.rowSpan!==1||n.colSpan&&n.colSpan!==1){var s={range:[i,r,i,r]};this.parent.notify(pr,s);var a=s.range;return a[0]===e[0]&&a[1]===e[1]}return!1},o.prototype.mouseDownHandler=function(t){var e=this;if(this.isNoteActiveElement=!g(document)&&!g(document.activeElement)&&typeof document.activeElement.className=="string"&&document.activeElement.className.indexOf("e-addNoteContainer")>-1,!(H(t.target,".e-scrollbar")||t.target.classList.contains("e-main-panel")||t.target.classList.contains("e-sheet"))){var i={action:"getCurrentEditValue",editedValue:""},r=this.parent.getActiveSheet();this.parent.notify(ui,i);var n=pt(i.editedValue,!0),s=this.parent.enableNotes&&!g(this.parent.spreadsheetNoteModule.noteCellIndexes),a=s?this.parent.spreadsheetNoteModule.noteCellIndexes:xe(this.parent.getActiveSheet().activeCell),l=this.parent.getCell(a[0],a[1]);if(!g(l)&&l.children!==null&&l.children.length>0&&this.isNoteActiveElement&&l.children[l.children.length-1].classList.contains("e-addNoteIndicator")){var h=Q(a[0],a[1],r),c=!g(h)&&h.notes?"editNote":"addNote",u=document.getElementsByClassName("e-addNoteContainer")[0],d=Gn(this.parent,this.parent.activeSheetIndex)+"!"+Ve(a);if(!g(u)&&!g(u.value)&&t.target.className!=="e-addNoteContainer"&&(g(h)||g(h.notes)||h.notes!==u.value)){this.parent.notify(Hh,{args:{action:"beforeCellSave",eventArgs:{address:d}}}),gr(this.parent,this.parent.getActiveSheet(),{rowIdx:a[0],colIdx:a[1],preventEvt:!0,cell:{notes:u.value,isNoteEditable:!1}});var p={notes:u.value,address:d};this.parent.notify(wt,{eventArgs:p,action:c})}else t.target.className!=="e-addNoteContainer"&&gr(this.parent,this.parent.getActiveSheet(),{rowIdx:a[0],colIdx:a[1],preventEvt:!0,cell:{isNoteEditable:!1}});this.parent.spreadsheetNoteModule.isShowNote=null}if(!this.isNoteTouch&&t.target.className!=="e-addNoteContainer"&&document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&this.parent.notify(jc,""),this.isNoteTouch&&t.type.indexOf("mouse")>-1&&(this.isNoteTouch=!1),!this.parent.isEdit||n){var f=document.getElementById(this.parent.element.id+"_overlay");if(typeof t.target.className=="string"){if(t.target.className.indexOf("e-ss-overlay")>-1)return}else f&&f.classList.remove("e-ss-overlay-active");if(H(t.target,".e-datavisualization-chart")||r.isProtected&&!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells)return;if(!(H(t.target,".e-findtool-dlg")||H(t.target,".e-dragfill-ddb"))&&this.getSheetElement().contains(t.target)&&!t.target.classList.contains("e-colresize")&&!t.target.classList.contains("e-rowresize")){var v=this.parent.getActiveSheet(),m=this.parent.selectionSettings.mode,y=Uo(t),b=Wo(t),S=this.getRowIdxFromClientY({clientY:b,target:t.target}),C=this.getColIdxFromClientX({clientX:y,target:t.target}),x=xe(v.activeCell),I,D=void 0;if(v.showHeaders){var M=t.target;if(v.frozenColumns||v.frozenRows){var E=this.parent.getSelectAllContent().querySelector("thead");E?D=(this.parent.getColumnHeaderContent().contains(M)||E.contains(M))&&M.classList.contains("e-header-cell")||M.classList.contains("e-selectall-table")&&S<0&&C>=this.parent.frozenColCount(v):D=this.parent.getColumnHeaderContent().contains(M)&&M.classList.contains("e-header-cell"),E=this.parent.getSelectAllContent().querySelector("tbody"),E?I=(this.parent.getRowHeaderContent().contains(M)||E.contains(M))&&M.classList.contains("e-header-cell")||M.classList.contains("e-selectall-table")&&C<0&&S>=this.parent.frozenRowCount(v):I=this.parent.getRowHeaderContent().contains(M)&&M.classList.contains("e-header-cell"),S===-1&&(S=0),C===-1&&(C=0)}else I=this.parent.getRowHeaderContent().contains(t.target),D=this.parent.getColumnHeaderContent().contains(t.target)}if((v.frozenRows||v.frozenColumns)&&!D&&!I){var A=t.target,L=["e-rowhdr-table","e-selectall-table","e-colhdr-table"].findIndex(function(je){return A.classList.contains(je)});if(L>-1){var N=[".e-row-header",".e-selectall-container",".e-column-header"][L],R=H(A,N);if(R&&R.style.zIndex){var h=Q(S,C,v);if(h&&h.validation&&h.validation.type==="List"||hs(v.columns[C],S,C)&&v.columns[C].validation.type==="List"){var P=this.parent.getCell(S,C);if(P){var k=P.querySelector(".e-validation-list");if(k){var B=k.getBoundingClientRect(),F=y>=B.left&&y<=B.right&&b>=B.top&&b<=B.bottom;if(F){var O=k.querySelector(".e-dropdownlist");if(O){var z=ot(O,"dropdownlist");z&&z.showPopup()}}}}}}}}if(t.which===3&&this.isSelected(S,C))return;if(t.target.classList.contains("e-autofill")){this.isautoFillClicked=!0;var Y=t.target.parentElement.querySelector(".e-dragfill-ddb");(!Y||Y.classList.contains("e-hide"))&&(this.dAutoFillCell=v.selectedRange)}var K=ie(v.topLeftCell),U=void 0;if(I?(this.isRowSelected=!0,!t.shiftKey||m==="Single"?this.startCell=[S,0]:this.startCell||(this.startCell=[K[0],0]),U=[this.startCell[0],v.frozenColumns?K[1]:0,S,v.colCount-1]):D?(this.isColSelected=!0,!t.shiftKey||m==="Single"?this.startCell=[0,C]:this.startCell||(this.startCell=[0,K[1]]),U=[v.frozenRows?K[0]:0,this.startCell[1],v.rowCount-1,C]):H(t.target,".e-select-all-cell")?(this.startCell=[v.frozenRows?K[0]:0,v.frozenColumns?K[1]:0],U=[].concat(this.startCell,[v.rowCount-1,v.colCount-1])):t.target.classList.contains("e-sheet-content")||((!t.shiftKey||m==="Single")&&(this.startCell=[S,C]),!this.isautoFillClicked&&!H(t.target,".e-filloption")&&(U=[].concat(this.startCell?this.startCell:xe(v.activeCell),[S,C]))),Oc(t)&&!(I||D)&&U){var q=this.isRowColSelected(U);this.isRowSelected=q.isRowSelected,this.isColSelected=q.isColSelected}var ae=t.ctrlKey&&U&&v.selectedRange.includes(Ve(U));if(!ae&&m==="Multiple"&&(!xb(t)&&(!Oc(t)||Oc(t)&&(x[0]===S&&x[1]===C||this.isMergeActiveCell(v,x,S,C)))||D||I)?(document.addEventListener(Fh().split(" ")[0],this.mouseMoveEvt),j.isPointer||(j.isIos&&Oc(t)&&t.target&&t.target.classList.contains("e-cell")&&t.preventDefault(),document.addEventListener(Fh().split(" ")[1],this.mouseMoveEvt,{passive:!1})),this.touchSelectionStarted=!0):this.touchSelectionStarted=!1,!xb(t))if(ae){if(this.parent.isEdit){var te=function(je){T.remove(document,Md(),te),e.updateFormulaCursorPosition(je)};T.add(document,Md(),te,this)}}else T.add(document,Md(),this.mouseUpHandler,this);var he=t.target,ue=he.className==="e-addNoteIndicator";if(!ue&&he.children.length>0){var ne=he.children[he.childElementCount-1].className;ue=typeof ne=="string"&&ne.indexOf("e-addNoteIndicator")>-1}if(Oc(t)&&ue){var le=xe(Ve(U).split(":")[0]);this.parent.notify(Ld,{rowIndex:le[0],columnIndex:le[1],isNoteEditable:!1}),this.isNoteTouch=!0,this.parent.spreadsheetNoteModule.isNoteVisibleOnTouch=!0}if(Oc(t)&&!(D||I)){this.touchEvt=t;return}var $=xb(t)&&this.isMobileContextMenuOpening(t);if($?j.isDevice&&!j.isAndroid&&t.preventDefault():U&&this.selectRangeByIdx(U,t),!this.isNoteTouch&&t.type.indexOf("mouse")>-1&&ue){var ee=xe(Ve(U).split(":")[0]);this.parent.notify(Ld,{rowIndex:ee[0],columnIndex:ee[1],isNoteEditable:!1}),this.parent.spreadsheetNoteModule.isNoteVisible=!0}this.parent.isMobileView()&&(this.parent.element.classList.add("e-mobile-focused"),this.parent.renderModule.setSheetPanelSize())}}if(n&&this.parent.isEdit){var He=t.target,qe=["e-cell","e-wrap-content","e-header-cell","e-cf-databar","e-databar","e-databar-value","e-fill-before","e-fill","e-fill-sec","e-hyperlink","e-iconsetspan"];if(qe.some(function(je){return He.classList.contains(je)})){var U=this.parent.getActiveSheet().selectedRange,we=U.split(" ");U=ug(Ji(we[we.length-1]))?we[we.length-1].split(":")[0]:we[we.length-1],this.parent.notify(Rl,{range:U,isSelect:!1,isMouseDown:t.ctrlKey})}}}},o.prototype.mouseMoveHandler=function(t){var e=this,i=this.parent.getActiveSheet();V0(t)&&t.preventDefault();var r={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,r);var n=pt(r.editedValue,!0),s=this.parent.getMainContent().parentElement,a=this.parent.element.getElementsByClassName("e-scroller")[0],l=s.getBoundingClientRect(),h=this.parent.frozenColCount(i),c=l.left+this.parent.sheetModule.getRowHeaderWidth(i,!1,!0),u=l.right-$z(),d=l.top,p=l.bottom,f=Uo(t),v=Wo(t),m=this.isRowSelected?i.colCount-1:this.getColIdxFromClientX({clientX:f,target:t.target,mouseMove:!0}),y=this.isColSelected?i.rowCount-1:this.getRowIdxFromClientY({clientY:v,target:t.target,mouseMove:!0}),b,S;if(t.ctrlKey){var C=i.selectedRange.split(" ");b=ie(C[C.length-1])}else b=ie(i.selectedRange);if(j.isDevice){var x=screen.availWidth;u>=x-40&&(u-=40-(x-u)),!i.showHeaders&&c<40&&(c+=40-c)}var I={range:[y,m,y,m]};if(this.parent.notify(pr,I),!(I.range[2]===b[2]&&I.range[3]===b[3]&&v<=p&&v>=d&&f<=u&&f>=c)){var D=this.parent.frozenRowCount(i);!n&&!this.isColSelected&&!this.isRowSelected&&(b=xe(i.activeCell));var M=v>p&&!this.isColSelected&&y<i.rowCount,E=v<d&&y>=0&&!this.isColSelected&&!!s.scrollTop&&(!D||b[0]>=D),A=f>u&&!this.isRowSelected&&m<i.colCount,L=f<c&&m>=0&&!this.isRowSelected&&!!a.scrollLeft&&(!h||b[1]>=h);this.clearInterval();var N,R;if(M||E||A||L){(E||L)&&(N=y,R=m);var P=function(){if(M||E){if(y=e.getRowIdxFromClientY({clientY:M?p:d}),y>=i.rowCount){e.clearInterval();return}s.scrollTop+=(M?1:-1)*ei(i,y)}if(A||L){if(m=e.getColIdxFromClientX({clientX:A?u:c,isFScroll:!0}),m>=i.colCount){e.clearInterval();return}a.scrollLeft+=(A?1:-1)*qr(i,m)}if(E&&i.frozenRows&&!s.scrollTop||L&&i.frozenColumns&&!a.scrollLeft){e.selectRangeByIdx([].concat(b[0],b[1],[N,R]),t),e.clearInterval();return}e.selectRangeByIdx([].concat(b[0],b[1],[y,m]),t)};P(),this.scrollInterval=setInterval(function(){P(),e.clearInterval(),e.scrollInterval=setInterval(P,100)})}else{var k=[].concat(b[0],b[1],[y,m]);if(D&&k[0]<D&&k[2]>=D&&s.scrollTop&&!this.isColSelected&&(s.scrollTop=0,k[2]=D),h&&k[1]<h&&k[3]>=h&&a.scrollLeft&&!this.isRowSelected&&(a.scrollLeft=0,k[3]=h),this.isautoFillClicked){t.target.classList.contains("e-autofill")&&(this.dAutoFillCell=i.selectedRange);var B={e:t,indexes:null};this.parent.notify(OD,B),k=B.indexes,S=k}this.selectRangeByIdx(k,t)}if(n&&this.parent.isEdit&&!H(t.target,"#"+this.parent.element.id+"_edit")){var F=void 0;this.isautoFillClicked?F=Ve(S):F=this.parent.getActiveSheet().selectedRange;var O=F.split(" ");this.parent.notify(Rl,{range:O[O.length-1],isSelect:!1})}}},o.prototype.mouseUpHandler=function(t){var e=this.getRowIdxFromClientY({clientY:Wo(t),target:t.target}),i=this.getColIdxFromClientX({clientX:Uo(t),target:t.target});this.clearInterval(),xb(t)&&!(this.isColSelected||this.isRowSelected)&&this.getRowIdxFromClientY({clientY:Wo(this.touchEvt),target:t.target})===e&&this.getColIdxFromClientX({clientX:Uo(this.touchEvt),target:t.target})===i&&this.mouseDownHandler(t),document.removeEventListener(Fh().split(" ")[0],this.mouseMoveEvt),j.isPointer||document.removeEventListener(Fh().split(" ")[1],this.mouseMoveEvt),T.remove(document,Md(),this.mouseUpHandler);var r=this.parent.getActiveSheet();if((r.frozenRows||r.frozenColumns)&&qi(this.parent.element,null,"e-cur-selection",!0,!0),this.parent.notify(qM,t),this.isautoFillClicked){var n=this.parent.getActiveSheet(),s=ie(n.selectedRange),a=KD(n,s),l=Ez(n,s);if(!(l&&s[1]===i)&&!(a&&s[0]===e)){if(t.target.parentElement){var h=t.target.parentElement.querySelector(".e-dragfill-ddb");(!h||h.classList.contains("e-hide"))&&(this.dAutoFillCell=n.selectedRange)}this.parent.notify(z0,{event:t,dAutoFillCell:this.dAutoFillCell})}this.isautoFillClicked=!1}else!t.ctrlKey&&!YD(uz(this.parent.getActiveSheet()))||this.parent.selectionSettings.mode==="Single"?this.parent.notify(Oa,null):this.parent.notify(zh,null);this.updateFormulaCursorPosition(t)},o.prototype.updateFormulaCursorPosition=function(t){if(this.parent.isEdit){var e={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,e);var i=pt(e.editedValue,!0);i&&this.parent.notify(E0,{isCellEdit:t.target.classList.contains("e-spreadsheet-edit")})}},o.prototype.isSelected=function(t,e){for(var i=!1,r,n=this.parent.getActiveSheet().selectedRange.split(" "),s=0;s<n.length;s++)if(r=tt(ie(n[s])),r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]){i=!0;break}return i},o.prototype.virtualContentLoadedHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r,n,s;i.selectedRange.split(" ").forEach(function(a,l){if(r=ie(a),s=r[1]===0&&r[3]===t.prevRowColCnt.colCount-1,n=r[0]===0&&r[2]===t.prevRowColCnt.rowCount-1,s||n)n&&s?r=[0,0,i.rowCount-1,i.colCount-1]:n?r=[0,r[1],i.rowCount-1,r[3]]:r=[r[0],0,r[2],i.colCount-1],i.frozenRows||i.frozenColumns?e.selectRangeByIdx(r,{type:"mousedown",ctrlKey:l!==0},!1,!1,!1,!1,void 0,!0):e.selectRangeByIdx(r,null,!0,null,null,null,l);else{r=ie(a);var h=e.parent.viewport.topIndex+e.parent.frozenRowCount(i),c=e.parent.viewport.leftIndex+e.parent.frozenColCount(i);e.highlightHdr(r,l!==0,r[0]>=h||r[2]>=h,r[1]>=c||r[3]>=c)}})},o.prototype.clearInterval=function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=null)},o.prototype.getScrollLeft=function(){return this.parent.scrollModule?this.parent.scrollModule.prevScroll.scrollLeft:0},o.prototype.cellNavigateHandler=function(t){var e=this.parent.getActiveSheet();e.isProtected&&!e.protectSettings.selectCells&&!e.protectSettings.selectUnLockedCells||(t.type="mousedown",this.selectRangeByIdx(t.range,t,!1,!1,!1,!1,void 0,t.preventAnimation))},o.prototype.getColIdxFromClientX=function(t){var e=this,i=0,r=this.parent.getActiveSheet(),n=0;if(t.isImage)n=t.clientX;else{var s=document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect();this.parent.enableRtl?n=s.right-this.parent.sheetModule.getRowHeaderWidth(r,!0,!0)-t.clientX:n=t.clientX-(s.left+this.parent.sheetModule.getRowHeaderWidth(r,!0,!0)),n+=this.parent.viewport.beforeFreezeWidth;var a=function(){var c=e.parent.element.querySelector(".e-frozen-column");return parseInt(c.style[e.parent.enableRtl?"right":"left"],10)/e.parent.viewport.scaleX};if((!t.target||!H(t.target,".e-row-header")&&!H(t.target,".e-selectall-container")||this.isScrollableArea(t.clientX,t.target,!0))&&(!this.parent.frozenColCount(r)||n>a()||t.isFScroll)&&(n+=this.getScrollLeft()/this.parent.viewport.scaleX),r.frozenRows&&n<0&&r.showHeaders)return t.mouseMove?0:-1}for(var l,h=0;;h++)if(l=i+=qr(r,h,null,!t.isImage)/this.parent.viewport.scaleX,n<(t.isImage?Number(os(l).toFixed(2)):l)||this.parent.scrollSettings.isFinite&&h===r.colCount-1)return t.isImage||(t.size=n),t.clientX=h,h},o.prototype.isScrollableArea=function(t,e,i){return e.classList.contains("e-table")?i?t>this.parent.getMainContent().getBoundingClientRect().left:t>this.parent.getMainContent().parentElement.getBoundingClientRect().top:!1},o.prototype.getRowIdxFromClientY=function(t){var e=0,i=this.parent.getActiveSheet(),r=0;if(t.isImage)r=t.clientY;else{var n=document.getElementById(this.parent.element.id+"_sheet");if(r=t.clientY+this.parent.viewport.beforeFreezeHeight-(n.getBoundingClientRect().top+(i.showHeaders?(t.isOverlay?30:31)/this.parent.viewport.scaleY:0)),(!t.target||!H(t.target,".e-header-panel")||this.isScrollableArea(t.clientY,t.target))&&(r+=this.parent.getMainContent().parentElement.scrollTop/this.parent.viewport.scaleY),i.frozenColumns&&r<0&&i.showHeaders)return t.mouseMove?0:-1}for(var s,a=0;;a++)if(s=e+=ei(i,a,!t.isImage)/this.parent.viewport.scaleY,r<(t.isImage?Number(os(s).toFixed(2)):s)||this.parent.scrollSettings.isFinite&&a===i.rowCount-1)return t.isImage||(t.size=r),t.clientY=a,a},o.prototype.initFormulaReferenceIndicator=function(t){if(this.parent.isEdit){var e=this.parent.createElement("div",{className:"e-formularef-indicator"});e.appendChild(this.parent.createElement("div",{className:"e-top"})),e.appendChild(this.parent.createElement("div",{className:"e-bottom"})),e.appendChild(this.parent.createElement("div",{className:"e-left"})),e.appendChild(this.parent.createElement("div",{className:"e-right"})),this.parent.getMainContent().appendChild(e),ra(this.parent,e,t,"e-formularef-indicator")}},o.prototype.isMouseEvent=function(t){return Eb(t)||mM(t)||yd(t)},o.prototype.selectRangeByIdx=function(t,e,i,r,n,s,a,l,h){var c=this,u=e&&this.isMouseEvent(e);if(!(e&&e.target&&u&&H(e.target,"#"+this.parent.element.id+"_edit"))){var d={action:"getCurrentEditValue",editedValue:"",endFormulaRef:!1};this.parent.notify(ui,d);var p=(this.parent.isEdit?pt(d.editedValue,!0):!1)&&!d.endFormulaRef,f=e&&e.ctrlKey&&Eb(e)&&this.parent.selectionSettings.mode!=="Single",v;f||(v=this.getSelectionElement(e,a));var m=this.parent.getActiveSheet(),y=ie(m.topLeftCell),b=this.parent.element.querySelector(".e-formularef-indicator"),S={range:[].slice.call(t),isActiveCell:!1,skipChecking:s},C,x=this.isRowColSelected(t);!x.isColSelected&&!x.isRowSelected&&this.parent.notify(uo,S),t!==S.range&&(C=!0),t=S.range;var I=new Promise(function(O){O((function(){})())}),D={range:Ve(t),cancel:!1};if(m.isProtected){var M=Q(t[2],t[3],m);if(m.protectSettings.selectUnLockedCells&&!m.protectSettings.selectCells)if(g(M)){if(!m.protectSettings.selectCells)return}else{if(M.isLocked===!0||g(M.isLocked))return;var E=this.parent.element.getElementsByClassName("e-sheet-panel")[0];E&&E.classList.contains("e-protected")&&E.classList.remove("e-protected")}}if(this.parent.trigger("beforeSelect",D),!D.cancel){if(p&&b&&b.parentElement.removeChild(b),h||this.parent.notify(O0,null),(ug(t)||S.isActiveCell)&&!f){if(v&&(v.classList.contains("e-multi-range")||v.classList.add("e-hide"),m.frozenRows||m.frozenColumns)){var A=yd(e)?"e-cur-selection":"e-selection";qi(this.parent.getSelectAllContent(),null,A,!0),qi(this.parent.getColumnHeaderContent(),null,A,!0),qi(this.parent.getRowHeaderContent(),null,A,!0)}if(!m.frozenColumns&&!m.frozenRows&&v&&ra(this.parent,v,t),p&&e&&e.target&&(!u||!e.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var L={range:Ve(t).split(":")[0],isSelect:!0};if(this.parent.notify(Rl,L),L.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(t)}}else{if(f)if(a===void 0){var N=Ve(t);if(m.selectedRange.includes(N)&&!p){var R=m.selectedRange.split(" ");R.length>1?(R.splice(R.indexOf(N),1),N=R.join(" ")):N=m.activeCell+":"+m.activeCell,this.selectRange({address:N});return}else v=this.getSelectionElement(e,a)}else v=this.getSelectionElement(e,a);if(p&&this.parent.isEdit){if(e&&e.target&&(!u||!e.target.classList.contains("e-spreadsheet-edit"))&&this.parent.isEdit){var L={range:Ve(t),isSelect:!0};if(this.parent.notify(Rl,L),L.isAlertDlgOpen)return;this.initFormulaReferenceIndicator(t)}}else{var A=void 0;v&&(v.classList.remove("e-hide"),(m.frozenRows||m.frozenColumns)&&((e&&e.target||f)&&(A="e-cur-selection",yd(e)&&v.classList.contains("e-cur-selection")?v.classList.add("e-hide"):v.classList.add(A)),!f&&(this.isColSelected||this.isRowSelected)&&Eb(e)&&(qi(this.parent.getSelectAllContent(),null,"e-selection"),qi(this.parent.getColumnHeaderContent(),null,"e-selection"),qi(this.parent.getRowHeaderContent(),null,"e-selection"))));var P=this.isColSelected&&this.isRowSelected?void 0:this.getOffset(t[2],t[3]);C&&P&&(P.left={idx:0,size:0}),I=ra(this.parent,v,t,A,l,f,f&&!e.target)||I}}var k={action:"getCurrentEditSheetIdx",sheetIndex:null};this.parent.notify(ui,k),m.frozenColumns&&t[1]>0&&t[1]===y[1]&&t[3]===m.colCount-1&&(t[1]=0),m.frozenRows&&t[0]>0&&t[0]===y[0]&&t[2]===m.rowCount-1&&(t[0]=0);var B=Ve(t);if(e&&e.ctrlKey&&(yd(e)||mM(e))&&!p)B=m.selectedRange.slice(0,m.selectedRange.lastIndexOf(" "))+" "+B;else if(a>-1){var R=m.selectedRange.split(" ");R[a]=B,B=R.join(" ")}if(!p&&!this.isautoFillClicked){var F=!1;m.selectedRange!==B&&(F=!0),lg(this.parent,B,m,f),F&&I.then(function(){c.parent&&c.parent.trigger("select",{range:c.parent.getActiveSheet().selectedRange})})}else!n&&!this.isautoFillClicked&&lg(this.parent,B,m,f);x=this.isRowColSelected(t),this.isRowSelected=x.isRowSelected,this.isColSelected=x.isColSelected,this.highlightHdr(t,e&&e.ctrlKey&&this.parent.selectionSettings.mode!=="Single"),!i&&!(e&&(e.type==="mousemove"||V0(e)))&&(p?k.sheetIndex===this.parent.getActiveSheet().id-1&&n?(r=!0,this.updateActiveCell(r?ie(m.activeCell):t,n,l)):this.parent.isEdit||this.updateActiveCell(r?ie(m.activeCell):t,n,l):this.updateActiveCell(r?ie(m.activeCell):t,n,l)),g(e)&&(e={type:"mousedown"}),p?n||this.parent.notify(Ta,e):this.parent.notify(Ta,e),!f&&!YD(uz(this.parent.getActiveSheet()))?this.parent.notify(Oa,{preventAnimation:l,isSelection:n}):this.parent.notify(zh,null),this.parent.showAggregate&&this.parent.notify(jl,{}),this.parent.notify(Nd,null)}}},o.prototype.isRowColSelected=function(t){var e=this.parent.getActiveSheet();return{isRowSelected:t[1]===0&&t[3]===e.colCount-1,isColSelected:t[0]===0&&t[2]===e.rowCount-1}},o.prototype.updateActiveCell=function(t,e,i){var r=this.parent.getActiveSheet(),n=ie(r.topLeftCell),s,a,l;this.isColSelected?(s=n[0],a=t[1],this.isRowSelected&&(a=n[1])):(s=t[0],a=t[1],this.isRowSelected&&(a=n[1]));var h={range:[s,a].concat([s,a])};if(this.parent.notify(pr,h),t!==h.range&&(l=!0),t=h.range,r.activeCell!==st(t[0],t[1])||e){if(this.previousActiveCell=r.activeCell.indexOf(":")>-1?this.previousActiveCell:r.activeCell,this.parent.setSheetPropertyOnMute(r,"activeCell",st(t[0],t[1])),r.isProtected){var c=this.parent.element.querySelector(".e-formula-bar"),u=Q(t[0],t[1],r),d=mn(u,Ht(r,t[1]));d&&c&&!c.disabled?c.disabled=!0:!d&&c&&c.disabled&&(c.disabled=!1)}if(this.getActiveCell()){var p=this.getOffset(t[2],t[3]);l&&(p.left={idx:0,size:0}),ra(this.parent,this.getActiveCell(),t,"e-active-cell",i)}this.parent.notify(vo,null)}else ra(this.parent,this.getActiveCell(),t,"e-active-cell",i)},o.prototype.getOffset=function(t,e){var i={left:{idx:0,size:0},top:{idx:0,size:0}};return this.parent.scrollModule&&(e>=this.parent.scrollModule.offset.left.idx&&(i.left=this.parent.scrollModule.offset.left),t>=this.parent.scrollModule.offset.top.idx&&(i.top=this.parent.scrollModule.offset.top)),i},o.prototype.getSelectionElement=function(t,e){var i=this.parent.getActiveSheet();if(t&&t.ctrlKey&&!this.parent.isEdit&&this.parent.selectionSettings.mode!=="Single")if(mM(t)||yd(t))if(i.frozenColumns||i.frozenRows){var r=this.parent.getMainContent().querySelector(".e-cur-selection");return r||(r=this.parent.element.querySelector(".e-multi-range"),r&&r.cloneNode())}else return this.parent.getMainContent().querySelector(".e-selection:last-child");else{var n=this.parent.getMainContent().getElementsByClassName("e-selection")[0],r=n.cloneNode();return r.classList.add("e-multi-range"),i.frozenColumns||i.frozenRows?(i.selectedRange.includes(" ")||(n.classList.remove("e-hide"),ra(this.parent,n,tt(ie(i.selectedRange)),void 0,!1,!0)),!this.parent.getMainContent().querySelector(".e-multi-range")&&n.classList.contains("e-hide")?n:r):(n.classList.remove("e-hide"),this.parent.getMainContent().appendChild(r))}else{if(e>-1)return i.frozenRows||i.frozenColumns?this.parent.element.querySelector(".e-sheet").getElementsByClassName("e-selection")[e]:this.parent.getMainContent().getElementsByClassName("e-selection")[e];var s=[].slice.call(this.parent.element.getElementsByClassName("e-multi-range"));return s.forEach(function(a){Qe(a)}),this.parent.getMainContent().getElementsByClassName("e-selection")[0]}},o.prototype.getActiveCell=function(){return this.parent.getMainContent().getElementsByClassName("e-active-cell")[0]},o.prototype.getSheetElement=function(){return document.getElementById(this.parent.element.id+"_sheet")},o.prototype.highlightHdr=function(t,e,i,r){var n=this;i===void 0&&(i=!0),r===void 0&&(r=!0);var s=this.parent.getActiveSheet();if(s.showHeaders){e||(Z(this.getSheetElement().querySelectorAll(".e-highlight"),"e-highlight"),Z(this.getSheetElement().querySelectorAll(".e-prev-highlight"),"e-prev-highlight"));var a=this.parent.element.getElementsByClassName("e-select-all-cell")[0];a&&Z([a],["e-prev-highlight-right","e-prev-highlight-bottom"]);var l=[],h=[],c=tt(t);this.isRowSelected&&(c[1]=ce(s,c[1],!0,"columns")),this.isColSelected&&(c[0]=ce(s,c[0],!0));var u=[0,0,0,0],d=[0,0,0,0],p=xe(s.topLeftCell),f,v,m=function(C,x,I){var D,M;if(C&&c[f]<C){p[f]=ce(s,p[f],!0,x);var E=ce(s,c[f],!0,x);E===p[f]&&(c[f]=E),M=n.parent.hiddenCount(p[f],c[f]-1,x,s),u[f]=c[f]-M-p[f],D=c[v]<C?c[v]:C-1,u[v]=D-n.parent.hiddenCount(c[f],D,x,s)-M-p[f]+1,D=n.parent.viewport[""+I]+C,c[v]>=D&&(d[f]=0,d[f]-=n.parent.hiddenCount(D,D,x,s),d[v]=c[v]-n.parent.hiddenCount(D,c[v],x,s)-D+1)}else{D=ce(s,n.parent.viewport[""+I]+C,!0,x);var E=ce(s,c[f],!0,x);D===E&&(c[f]=D),M=n.parent.hiddenCount(D,c[f]-1,x,s),d[f]=c[f]-M-D,d[v]=c[v]-n.parent.hiddenCount(c[f],c[v],x,s)-M-D+1}},y=function(C,x,I){for(var D=[].slice.call(x.getElementsByClassName("e-header-cell")),M=C[f];M<C[v];M++)D[M]&&I.push(D[M])};if(i){if(f=0,v=2,m(this.parent.frozenRowCount(s),"rows","topIndex"),s.frozenRows){var b=this.parent.getSelectAllContent().querySelector("tbody");b&&y(u,b,l)}y(d,this.parent.getRowHeaderContent(),l)}if(r){if(f=1,v=3,m(this.parent.frozenColCount(s),"columns","leftIndex"),s.frozenColumns){var S=this.parent.getSelectAllContent().querySelector("thead");S&&y(u,S,h)}y(d,this.parent.getColumnHeaderContent(),h)}s.isProtected&&!s.protectSettings.selectCells?Z([].concat(l,h),"e-highlight"):X([].concat(l,h),"e-highlight"),l.length&&l[0].parentElement.previousElementSibling&&l[0].parentElement.previousElementSibling.classList.add("e-prev-highlight"),h.length&&h[0].previousElementSibling&&h[0].previousElementSibling.classList.add("e-prev-highlight"),this.isRowSelected&&this.isColSelected&&(s.isProtected&&!s.protectSettings.selectCells?document.getElementById(this.parent.element.id+"_select_all").classList.remove("e-highlight"):document.getElementById(this.parent.element.id+"_select_all").classList.add("e-highlight")),a&&(ce(s,c[0],!0)===ce(s,0,!0)&&a.classList.add("e-prev-highlight-bottom"),ce(s,c[1],!0,"columns")===ce(s,0,!0,"columns")&&a.classList.add("e-prev-highlight-right"))}},o.prototype.protectHandler=function(){var t=ie(this.parent.getActiveSheet().selectedRange),e=tt(t),i=xe(this.parent.getActiveSheet().activeCell),r=e[0]<=i[0]&&e[2]>=i[0]&&e[1]<=i[1]&&e[3]>=i[1];this.selectRangeByIdx(t,null,null,r)},o.prototype.initiateFormulaSelection=function(t){this.processFormulaEditRange(t.range,t.formulaSheetIdx)},o.prototype.processFormulaEditRange=function(t,e){var i,r=e,n=0,s={formula:t};this.parent.notify(t0,s);var a=s.formulaArr,l=a.length,h=0,c=[["e-vborderright","e-vborderbottom"],["e-pborderright","e-pborderbottom"],["e-cborderright","e-cborderbottom"],["e-gborderright","e-gborderbottom"],["e-oborderright","e-oborderbottom"],["e-bborderright","e-bborderbottom"]];this.clearBorder();for(var u=this.parent.getActiveSheet().id-1;n<l&&(i=a[n],!(this.invalidOperators.indexOf(i)>-1));){if(Or(i.toUpperCase())){if(i=i.replace(/\$/g,""),n>0&&a[n-1].lastIndexOf("!")===a[n-1].length-1){var d=a[n-1].substring(1,a[n-1].lastIndexOf("!")-1);r=d?Ct(this.parent,d):r}a[n+1]===":"&&(n++,a[n+1]&&Or(a[n+1].toUpperCase())&&(i=i+":"+a[n+1],n++)),u===r&&this.updateFormulaEditRange(i,h,c),r=e,h++}n++}},o.prototype.updateFormulaEditRange=function(t,e,i){var r=ie(t);this.formulaRange[e]=t,this.dStartCell={rowIndex:r[0],colIndex:r[1]},this.dEndCell={rowIndex:r[2],colIndex:r[3]},this.focusBorder(this.dStartCell,this.dEndCell,i[e%6])},o.prototype.chartBorderHandler=function(t){this.focusBorder(t.startcell,t.endcell,t.classes,!0)},o.prototype.focusBorder=function(t,e,i,r){r=g(r)?!1:r;var n=this.parent.getActiveSheet(),s=tt([t.rowIndex,t.colIndex,e.rowIndex,e.colIndex]);if(n.frozenRows||n.frozenColumns){var a=this.parent.createElement("div",{className:r?"e-range-indicator e-chart-range":"e-range-indicator e-formuala-range"});a.appendChild(this.parent.createElement("div",{className:"e-top"})),a.appendChild(this.parent.createElement("div",{className:"e-bottom"})),a.appendChild(this.parent.createElement("div",{className:"e-left"})),a.appendChild(this.parent.createElement("div",{className:"e-right"})),ra(this.parent,a,s,"e-range-indicator");return}var l=this.getRefIndicatorFn(r),h=s[0],c=s[1],u=s[2],d=s[3];if(h){var p=ce(n,h-1,!1);l([p,c,p,d],i[1])}var f=ce(n,d,!1,"columns");l([h,f,u,f],i[0]);var v=ce(n,u,!1);if(l([v,c,v,d],i[1]),c){var m=ce(n,c-1,!1,"columns");l([h,m,u,m],i[0])}},o.prototype.getRefIndicatorFn=function(t){var e=this,i=this.parent.getActiveSheet(),r=this.parent.scrollSettings.enableVirtualization?[this.parent.viewport.topIndex,this.parent.viewport.leftIndex,this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex]:[0,0,i.rowCount-1,i.colCount-1];return function(n,s){var a,l;n[0]>n[2]&&(a=n[0],n[0]=n[2],n[2]=a),n[1]>n[3]&&(a=n[1],n[1]=n[3],n[3]=a);for(var h=n[0];h<=n[2];h++)if(h>=r[0]&&h<=r[2]&&!lt(i,h)&&(l=e.parent.getRow(h,null),l)){for(var c=n[1];c<=n[3];c++)if(c>=r[1]&&c<=r[3]&&!Ft(i,c)){var u=e.parent.getCell(h,c,l);u&&(u.classList.add(s),t||u.classList.add("e-formularef-selection"))}}}},o.prototype.clearBorder=function(){var t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var e=[].slice.call(this.parent.element.getElementsByClassName("e-formuala-range"));e.forEach(function(l){se(l)});return}for(var i=this.parent.element.getElementsByClassName("e-formularef-selection"),r=i.length-1;r>=0;r--)for(var n=i[r],s=["e-vborderright","e-vborderbottom","e-pborderright","e-pborderbottom","e-cborderright","e-cborderbottom","e-gborderright","e-gborderbottom","e-oborderright","e-oborderbottom","e-bborderright","e-bborderbottom","e-formularef-selection"],a=0;a<s.length;a++)n.classList.remove(s[a])},o.prototype.isMobileContextMenuOpening=function(t){var e=t.timeStamp-(this.touchEvt?this.touchEvt.timeStamp:t.timeStamp);return e>500},o.prototype.getModuleName=function(){return"selection"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o})(),z9=(function(){function o(t){this.clientX=0,this.isKeyScroll=!0,this.parent=t,this.addEventListener(),this.initProps()}return o.prototype.onContentScroll=function(t){if(this.parent){var e=this.parent.getMainContent().parentElement,i=t.scrollLeft,r=t.scrollTop||e.scrollTop,n=i&&this.parent.enableRtl?this.initScrollValue-i:i,s,a;if(this.parent.allowAutoFill){var l=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn-popup"),h=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(l){var c=ot(h,"dropdown-btn");c.toggle()}}if(!g(i)&&this.prevScroll.scrollLeft!==n){var u=n>this.prevScroll.scrollLeft;a=this.offset.left.size,this.offset.left=this.getColOffset(n,u,t.skipHidden),t.preventScroll||(this.parent.getColumnHeaderContent().scrollLeft=i,this.parent.getMainContent().scrollLeft=i,t.scrollLeft=i),s={cur:this.offset.left,prev:{idx:this.leftIndex,size:a},increase:u,preventScroll:t.preventScroll},this.updateTopLeftCell(u,!0),this.parent.notify(l0,null),this.parent.notify(_M,s),this.updateNoteContainer(),!this.parent.scrollSettings.enableVirtualization&&u&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualCols(),this.leftIndex=s.prev.idx,this.prevScroll.scrollLeft=n}if(Math.round(this.prevScroll.scrollTop)!==Math.round(r)){t.skipRowVirualScroll&&(this.prevScroll.scrollTop=0,this.offset.top={idx:0,size:0});var d=r>this.prevScroll.scrollTop;a=this.offset.top.size,this.offset.top=this.getRowOffset(r,d),s={cur:this.offset.top,prev:{idx:this.topIndex,size:a},increase:d,preventScroll:t.preventScroll},this.updateTopLeftCell(d),t.preventScroll&&this.offset.top.idx<=this.parent.getThreshold("row")?this.offset.top={idx:0,size:0}:t.skipRowVirualScroll?s.prev.idx=s.cur.idx:(this.parent.notify(l0,null),this.parent.notify(VM,s),this.updateNoteContainer()),!this.parent.scrollSettings.enableVirtualization&&d&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualRows(),this.topIndex=s.prev.idx,this.prevScroll.scrollTop=r}var p=!1,f={isEdit:p};if(this.parent.notify(Kd,f),f.isEdit){var v=this.parent.element.querySelector(".e-formula-bar");v.focus()}this.isKeyScroll=!0}},o.prototype.updateNoteContainer=function(){document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&this.parent.notify(uD,null)},o.prototype.updateScrollValue=function(t){t.scrollLeft!==void 0&&(this.prevScroll.scrollLeft=t.scrollLeft+(this.prevScroll.scrollLeft-this.offset.left.size),this.offset.left.size=t.scrollLeft),t.scrollTop!==void 0&&(this.prevScroll.scrollTop=t.scrollTop+(this.prevScroll.scrollTop-this.offset.top.size),this.offset.top.size=t.scrollTop)},o.prototype.updateNonVirtualRows=function(){var t=this.parent.getActiveSheet(),e=this.parent.getThreshold("row");this.offset.top.idx>t.rowCount-(this.parent.viewport.rowCount+e)&&(this.parent.renderModule.refreshUI({rowIndex:t.rowCount,colIndex:0,direction:"first",refresh:"RowPart"},st(t.rowCount,0)+":"+st(t.rowCount+e-1,t.colCount-1)),this.parent.setSheetPropertyOnMute(t,"rowCount",t.rowCount+e),this.parent.viewport.bottomIndex=t.rowCount-1)},o.prototype.updateNonVirtualCols=function(){var t=this.parent.getActiveSheet(),e=this.parent.getThreshold("col");this.offset.left.idx>t.colCount-(this.parent.viewport.colCount+e)&&(this.parent.renderModule.refreshUI({rowIndex:0,colIndex:t.colCount,direction:"first",refresh:"ColumnPart"},st(0,t.colCount)+":"+st(t.rowCount-1,t.colCount+e-1)),this.parent.setSheetPropertyOnMute(t,"colCount",t.colCount+e),this.parent.viewport.rightIndex=t.colCount-1)},o.prototype.updateTopLeftCell=function(t,e){var i=this.parent.getActiveSheet(),r=this.offset.top.idx,n=this.offset.left.idx;if(!t){var s=this.parent.frozenRowCount(i);r=ce(i,r+s,!0)-s;var a=this.parent.frozenColCount(i);n=ce(i,n+a,!0,"columns")-a}e?this.parent.updateTopLeftCell(null,n,"row"):this.parent.updateTopLeftCell(r,null,"col")},o.prototype.getRowOffset=function(t,e){var i=this.offset.top.size,r=this.parent.getActiveSheet(),n=e?this.offset.top.idx+1:this.offset.top.idx?this.offset.top.idx-1:0,s=this.parent.frozenRowCount(r),a=this.parent.scrollSettings.isFinite?r.rowCount:1/0;for(t=Math.round(t);n<a;)if(e){var l=ei(r,n-1+s,!0);if(i+=l,Math.abs(Math.round(i)-t)<=1)return{idx:ce(r,n+s,!0)-s,size:i};if(Math.round(i)>t)return{idx:n-1,size:i-l};n++}else{var l=ei(r,n+s,!0);if(i-=l,i<=0)return{idx:0,size:0};if(Math.abs(Math.round(i)-t)<=1)return{idx:n,size:i};if(Math.round(i)<t)return i+=l,Math.round(i)>t?{idx:n,size:i-l<0?0:i-l}:{idx:ce(r,n+1+s,!0)-s,size:i};n--}return{idx:this.offset.top.idx,size:this.offset.top.size}},o.prototype.getColOffset=function(t,e,i){for(var r=this.offset.left.size,n=this.parent.getActiveSheet(),s=e?this.offset.left.idx+1:this.offset.left.idx?this.offset.left.idx-1:0,a=this.parent.frozenColCount(n),l=this.parent.scrollSettings.isFinite?n.colCount:1/0;s<l;)if(e){var h=qr(n,s-1+a,i,!0);if(r+=h,Math.abs(Math.round(r)-t)<=1)return{idx:ce(n,s+a,!0,"columns")-a,size:r};if(Math.round(r)>t)return{idx:s-1,size:r-h};s++}else{var h=qr(n,s+a,i,!0);if(r-=h,r<=0)return{idx:0,size:0};if(Math.abs(Math.round(r)-t)<=1)return{idx:s,size:r};if(Math.round(r)<t)return r+=h,Math.round(r)>t?(r=r-h,{idx:s,size:r<0?0:r}):{idx:ce(n,s+1+a,!0,"columns")-a,size:r};s--}return{idx:this.offset.left.idx,size:this.offset.left.size}},o.prototype.contentLoaded=function(t){if(!this.parent.scrollSettings.enableVirtualization){var e=this.parent.createElement("div",{className:"e-virtualtrack"});this.updateNonVirualScrollWidth({scrollTrack:e}),this.parent.getScrollElement().appendChild(e)}t.left&&(this.parent.getScrollElement().scrollLeft=t.left),this.setScrollEvent(),this.parent.enableRtl&&(this.initScrollValue=this.parent.getScrollElement().scrollLeft)},o.prototype.updateNonVirualScrollWidth=function(t){t.scrollTrack||(t.scrollTrack=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0]),t.scrollTrack.style.width=Math.abs(this.parent.getContentTable().getBoundingClientRect().width+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0))+"px"},o.prototype.onHeaderWheel=function(t){if(!(t.ctrlKey||t.metaKey)){if(t.shiftKey&&t.deltaY!==0){this.applyShiftScroll(t);return}t.deltaY!==0&&(t.cancelable&&t.preventDefault(),this.parent.getMainContent().parentElement.scrollTop+=t.deltaY),t.deltaX!==0&&(t.cancelable&&t.preventDefault(),this.parent.getScrollElement().scrollLeft+=t.deltaX)}},o.prototype.onContentWheel=function(t){if(!(t.ctrlKey||t.metaKey)){if(t.shiftKey&&t.deltaY!==0){this.applyShiftScroll(t);return}t.deltaX!==0&&(t.cancelable&&t.preventDefault(),this.parent.getScrollElement().scrollLeft+=t.deltaX,t.deltaY!==0&&(this.parent.getMainContent().parentElement.scrollTop+=t.deltaY))}},o.prototype.applyShiftScroll=function(t){t.cancelable&&t.preventDefault(),t.deltaX!==0?(this.parent.getScrollElement().scrollLeft+=t.deltaX,this.parent.getMainContent().parentElement.scrollTop+=t.deltaY):this.parent.getScrollElement().scrollLeft+=t.deltaY},o.prototype.scrollHandler=function(t){this.onContentScroll({scrollLeft:t.target.scrollLeft})},o.prototype.updateScroll=function(t){g(t.left)?this.parent.sheetModule.contentPanel.scrollTop=t.top:this.parent.getScrollElement().scrollLeft=t.left},o.prototype.setScrollEvent=function(){T.add(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll,this),T.add(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel,this),T.add(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel,this),T.add(this.parent.getMainContent(),"wheel",this.onContentWheel,this),T.add(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel,this),T.add(this.parent.getScrollElement(),"scroll",this.scrollHandler,this)},o.prototype.initProps=function(){this.topIndex=0,this.leftIndex=0,this.prevScroll={scrollLeft:0,scrollTop:0},this.offset={left:{idx:0,size:0},top:{idx:0,size:0}}},o.prototype.setPadding=function(t){this.parent.sheetModule.contentPanel.style.overflowY="scroll";var e=$z();if(e>0){var i=this.parent.getColumnHeaderContent(),r=this.parent.enableRtl?{margin:"marginLeft",border:"borderLeftWidth"}:{margin:"marginRight",border:"borderRightWidth"};i.parentElement.style[r.margin]=e+"px",i.style[r.border]="1px"}t&&(this.initScrollValue=0)},o.prototype.setClientX=function(t){if(!(t.type==="mousedown"||t.pointerType==="mouse")){var e={touchSelectionStarted:!1};if(this.parent.notify(Bg,e),!(e.touchSelectionStarted||e.isOverlayClicked)){this.clientX=this.getPointX(t);var i=document.getElementById(this.parent.element.id+"_sheet");T.add(i,j.isPointer?"pointermove":"touchmove",this.onTouchScroll,this),T.add(i,j.isPointer?"pointerup":"touchend",this.pointerUpHandler,this)}}},o.prototype.getPointX=function(t){var e=0;return t.touches&&t.touches.length?e=t.touches[0].clientX:e=t.clientX,e},o.prototype.onTouchScroll=function(t){if(t.pointerType!=="mouse"){var e=this.getPointX(t),i=this.clientX-e,r=this.parent.element.getElementsByClassName("e-scroller")[0];(i>10||i<-10)&&r.scrollLeft+i>=0&&(t.preventDefault(),this.clientX=e,er(function(){r.scrollLeft+=i}))}},o.prototype.pointerUpHandler=function(){var t=document.getElementById(this.parent.element.id+"_sheet");T.remove(t,j.isPointer?"pointermove":"touchmove",this.onTouchScroll),T.remove(t,j.isPointer?"pointerup":"touchend",this.pointerUpHandler)},o.prototype.addEventListener=function(){this.parent.on(Ln,this.contentLoaded,this),this.parent.on(lD,this.onContentScroll,this),this.parent.on(R0,this.updateScroll,this),this.parent.on(nu,this.initProps,this),this.parent.on(Xn,this.destroy,this),this.parent.on(Bl,this.setClientX,this),this.parent.on(P0,this.updateScrollValue,this),this.parent.scrollSettings.enableVirtualization||(this.parent.on(co,this.updateNonVirualScrollWidth,this),this.parent.on(Qn,this.updateNonVirualScrollWidth,this))},o.prototype.destroy=function(){this.removeEventListener();var t=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(t){var e=ot(t,"dropdown-btn");e&&e.destroy()}this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(Ln,this.contentLoaded),this.parent.off(lD,this.onContentScroll),this.parent.off(R0,this.updateScroll),this.parent.off(nu,this.initProps),this.parent.off(Xn,this.destroy),this.parent.off(Bl,this.setClientX),this.parent.off(P0,this.updateScrollValue),this.parent.scrollSettings.enableVirtualization||(this.parent.off(co,this.updateNonVirualScrollWidth),this.parent.off(Qn,this.updateNonVirualScrollWidth))},o})(),P9=(function(){function o(t){this.scroll=[],this.parent=t,this.addEventListener()}return o.prototype.createVirtualElement=function(t){var e=this.parent.getActiveSheet(),i=this.parent.getMainContent();this.content=this.parent.createElement("div",{className:"e-virtualable"}),this.content.appendChild(i.querySelector(".e-table")),i.appendChild(this.content);var r=i.appendChild(this.parent.createElement("div",{className:"e-virtualtrack"})),n=0,s;this.parent.sheets.length>this.scroll.length&&this.initScroll();var a=this.parent.viewport.bottomIndex;e.rowCount>a+1||e.usedRange.rowIndex>a?(!this.parent.scrollSettings.isFinite&&e.rowCount<=e.usedRange.rowIndex&&this.parent.setSheetPropertyOnMute(e,"rowCount",e.usedRange.rowIndex+1),this.setScrollCount(e.rowCount,"row")):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(e,"rowCount",a+1),this.scroll[this.parent.activeSheetIndex].rowCount=e.rowCount);var l=this.parent.frozenRowCount(e),h=xe(e.topLeftCell);t.top&&(n=t.top,e.frozenRows&&(n+=xi(e,h[0],l-1,!0)),l=xe(e.paneTopLeftCell)[0]),n+=xi(e,l,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0),a=this.parent.viewport.rightIndex;var c=0,u=this.parent.frozenColCount(e);t.left?(c=t.left,u&&(c+=wi(e,h[1],u-1,!0)),l=xe(e.paneTopLeftCell)[1]):l=u,e.colCount>a+1||e.usedRange.colIndex>a?(!this.parent.scrollSettings.isFinite&&e.colCount<=e.usedRange.colIndex&&this.parent.setSheetPropertyOnMute(e,"colCount",e.usedRange.colIndex+1),c+=wi(e,l,a,!0),this.setScrollCount(e.colCount,"col"),s=c+wi(e,a+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0)):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(e,"colCount",a+1),c+=wi(e,l,e.colCount-1,!0),this.scroll[this.parent.activeSheetIndex].colCount=e.colCount,s=c),g(this.parent.viewport.leftIndex)&&(this.parent.viewport.leftIndex=0),g(this.parent.viewport.topIndex)&&(this.parent.viewport.topIndex=0),t.left&&(c=wi(e,this.parent.viewport.leftIndex+u,a,!0)),g(this.translateX)&&(this.translateX=0),g(this.translateY)&&(this.translateY=0),i=this.parent.getRowHeaderContent(),this.rowHeader=this.content.cloneNode(),this.rowHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.rowHeader);var d=i.appendChild(r.cloneNode());this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)",i=this.parent.getColumnHeaderContent(),this.colHeader=this.content.cloneNode(),this.colHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.colHeader);var p=i.appendChild(r.cloneNode());if(this.colHeader.style.width=c+"px",d.style.height=n+"px",p.style.width=s+"px",this.colHeader.style.transform="translate("+this.translateX+"px, 0px)",this.content.style.transform="translate("+this.translateX+"px, "+this.translateY+"px)",this.content.style.width=c+"px",r.style.height=n+"px",r.style.width=s+"px",this.parent.allowScrolling){var f=p.cloneNode(!0);f.style.width=s+(this.parent.scrollSettings.isFinite?this.parent.sheetModule.getScrollSize():0)+"px",this.parent.getScrollElement().appendChild(f)}},o.prototype.initScroll=function(){for(var t=0;t<this.parent.sheets.length;)this.scroll[t]||this.scroll.push({rowCount:0,colCount:0}),t++},o.prototype.setScrollCount=function(t,e){var i=this.parent.activeSheetIndex;(!this.scroll[i][e+"Count"]||this.scroll[i][e+"Count"]!==t)&&(this.scroll[i][e+"Count"]=t)},o.prototype.getRowAddress=function(t){var e=this.parent.getActiveSheet();return Ve([t[0],e.frozenColumns?xe(e.topLeftCell)[1]:this.parent.viewport.leftIndex,t[1],this.parent.viewport.rightIndex])},o.prototype.getColAddress=function(t){var e=this.parent.getActiveSheet();return Ve([e.frozenRows?xe(e.topLeftCell)[0]:this.parent.viewport.topIndex,t[0],this.parent.viewport.bottomIndex,t[1]])},o.prototype.updateScrollCount=function(t,e,i){i===void 0&&(i=t);var r=this.parent.getActiveSheet(),n=t+this.parent.viewport[e+"Count"]+1+i,s=this.scroll[this.parent.activeSheetIndex][e+"Count"];if(n<s){if(r[e+"Count"]===s)return;n=s}this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(r,e+"Count",n)},o.prototype.onVerticalScroll=function(t){var e=t.cur.idx,i=t.cur.size,r=t.prev.idx,n=Math.abs(e-r),s=this.parent.getThreshold("row");if(n>Math.round(s/2)){var a=void 0,l=void 0,h=void 0,c=this.parent.getActiveSheet();if(e<=s&&!t.increase){if(this.translateY&&r>s){this.translateY=0;var u=this.parent.frozenColCount(c),d=this.parent.frozenRowCount(c);if(t.preventScroll)this.parent.viewport.topIndex=r-(s-d);else{var p=u?xe(c.topLeftCell)[1]:this.parent.viewport.leftIndex,f=u?[d,this.parent.viewport.leftIndex+u]:[];if(n<this.parent.viewport.rowCount+s){a=ce(c,d,!0),l=ce(c,this.parent.viewport.topIndex+d-1,!1),this.parent.viewport.topIndex=a-d;var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-a+1-this.hiddenCount(a,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=ce(c,v,!1),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"last",refresh:"RowPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getRowAddress([a,ce(c,l,!1)]))}else{var m=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:0,colIndex:p,refresh:"Row",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),u&&(this.parent.viewport.leftIndex=m),this.translate({refresh:"Row"})}Re(this.parent.element),e=0}}this.updateScrollCount(s,"row")}if(r<s&&(n=Math.abs(e-s)),!t.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===ce(c,c.rowCount-1,!1)){var d=this.parent.frozenRowCount(c),y=this.parent.viewport.topIndex+d+ie(c.paneTopLeftCell)[0]-1;if(e+d>y){t.prev.idx=e;return}n=y-(e+d)}if(e>s){if(h=this.parent.viewport.topIndex,this.parent.viewport.topIndex=e-s,t.increase&&h>this.parent.viewport.topIndex){this.parent.viewport.topIndex=h;return}var d=this.parent.frozenRowCount(c);if(t.preventScroll)this.setThresholdHeight(i,s,d),this.translate({refresh:"Row"});else{var u=this.parent.frozenColCount(c),p=void 0,b=[];if(u?(p=xe(c.topLeftCell)[1],b.push(d),b.push(this.parent.viewport.leftIndex+u)):p=this.parent.viewport.leftIndex,n<this.parent.viewport.rowCount+s)if(t.increase){if(a=this.parent.viewport.bottomIndex+1,l=this.parent.viewport.bottomIndex+(this.parent.viewport.topIndex-h),l-=this.hiddenCount(h+d,this.parent.viewport.topIndex-1+d),l<=this.parent.viewport.bottomIndex||this.parent.scrollSettings.isFinite&&a>ce(c,c.rowCount-1,!1,"rows")){this.parent.viewport.topIndex=h;return}var S=this.parent.skipHidden(a,l,"rows",!1),C=this.checkLastIdx(S[1],"row");a=S[0],l=C.index;var x=this.parent.viewport.topIndex+d;if(C.diff){var I=l-a+1-this.hiddenCount(a,l);x=ce(c,h,!0,"rows",I)+d}this.parent.viewport.topIndex=ce(c,x,!C.diff)-d,this.setThresholdHeight(i,e-this.parent.viewport.topIndex,d,!!C.diff,h===ce(c,d,!0)),this.parent.viewport.bottomIndex=l,this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"first",refresh:"RowPart",frozenIndexes:b},this.getRowAddress([a,l]))}else{if(a=ce(c,this.parent.viewport.topIndex+d,!1),a<d&&(a=d,a=ce(c,a,!0)),this.parent.viewport.topIndex=a-d,l=ce(c,h+d-1,!1),l<d||l<a){this.parent.viewport.topIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.bottomIndex-(l-a+1-this.hiddenCount(a,l)),this.parent.viewport.bottomIndex);this.parent.viewport.bottomIndex=ce(c,v,!1),this.setThresholdHeight(i,e-this.parent.viewport.topIndex,d),this.parent.renderModule.refreshUI({colIndex:p,rowIndex:a,direction:"last",refresh:"RowPart",frozenIndexes:b},this.getRowAddress([a,l]))}else h=this.parent.viewport.leftIndex,this.parent.viewport.topIndex=ce(c,this.parent.viewport.topIndex+d,!1)-d,this.parent.viewport.topIndex<0&&(this.parent.viewport.topIndex=ce(c,d,!0)-d),this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:p,refresh:"Row",frozenIndexes:b,skipTranslate:!0}),u&&(this.parent.viewport.leftIndex=h),this.setThresholdHeight(i,e-this.parent.viewport.topIndex,d,this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===ce(c,c.rowCount-1,!1)),this.translate({refresh:"Row"});this.updateScrollCount(e,"row",s),this.focusSheet()}}t.prev.idx=e}},o.prototype.skipHiddenLastIdx=function(t,e,i){i===void 0&&(i="rows");for(var r=this.parent.getActiveSheet(),n=0,s=t;s<=e;s++)r[""+i][s]&&r[""+i][s].hidden&&n++;return n&&(t=this.skipHiddenLastIdx(t-n,t-1,i)),t},o.prototype.hiddenCount=function(t,e,i){i===void 0&&(i="rows");for(var r=0,n=this.parent.getActiveSheet(),s=t;s<=e;s++)n[""+i][s]&&n[""+i][s].hidden&&r++;return r},o.prototype.checkLastIdx=function(t,e){var i=0;if(this.parent.scrollSettings.isFinite){var r=this.parent.getActiveSheet(),n=ce(r,r[e+"Count"]-1,!1,e==="col"?"columns":"rows");t>n&&(i=t-n,t=n)}return{index:t,diff:i}},o.prototype.onHorizontalScroll=function(t){var e=t.cur.idx,i=t.cur.size,r=t.prev.idx,n=Math.abs(e-r),s=this.parent.getThreshold("col");if(n>Math.round(s/2)){var a=void 0,l=void 0,h=void 0,c=this.parent.getActiveSheet();if(e<=s&&!t.increase){if(this.translateX&&r>s){this.translateX=0;var u=this.parent.frozenColCount(c),d=this.parent.frozenRowCount(c);if(t.preventScroll)this.parent.viewport.leftIndex=r-(s-u);else{var p=d?xe(c.topLeftCell)[0]:this.parent.viewport.topIndex,f=d?[this.parent.viewport.topIndex+d,u]:[];if(n<this.parent.viewport.colCount+s){a=ce(c,u,!0,"columns"),l=ce(c,this.parent.viewport.leftIndex+u-1,!1,"columns"),this.parent.viewport.leftIndex=a-u;var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-a+1-this.hiddenCount(a,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=ce(c,v,!1,"columns"),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"last",refresh:"ColumnPart",skipUpdateOnFirst:!0,frozenIndexes:f},this.getColAddress([a,ce(c,l,!1,"columns")]))}else{var m=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({rowIndex:p,colIndex:0,refresh:"Column",skipUpdateOnFirst:!0,frozenIndexes:f,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=m),this.translate({refresh:"Column"})}Re(this.parent.element),e=0}}this.updateScrollCount(s,"col")}if(r<s&&(n=Math.abs(e-s)),!t.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===ce(c,c.colCount-1,!1,"columns")){var u=this.parent.frozenColCount(c),y=this.parent.viewport.leftIndex+u+ie(c.paneTopLeftCell)[1]-1;if(y+=this.hiddenCount(this.parent.viewport.leftIndex+u,y),e+u>y){t.prev.idx=e;return}n=y-(e+u)}if(e>s){if(h=this.parent.viewport.leftIndex,this.parent.viewport.leftIndex=e-s,t.increase&&h>this.parent.viewport.leftIndex){this.parent.viewport.leftIndex=h;return}var u=this.parent.frozenColCount(c);if(t.preventScroll)this.setThresholdWidth(i,s,u),this.translate({refresh:"Column"});else{var d=this.parent.frozenRowCount(c),p=d?xe(c.topLeftCell)[0]:this.parent.viewport.topIndex,b=[];if(d&&(b=[d+this.parent.viewport.topIndex,u]),n<this.parent.viewport.colCount+s)if(t.increase){if(a=this.parent.viewport.rightIndex+1,l=this.parent.viewport.rightIndex+(this.parent.viewport.leftIndex-h),l-=this.hiddenCount(h+u,this.parent.viewport.leftIndex-1+u,"columns"),l<=this.parent.viewport.rightIndex||this.parent.scrollSettings.isFinite&&a>ce(c,c.colCount-1,!1,"columns")){this.parent.viewport.leftIndex=h;return}var S=this.parent.skipHidden(a,l,"columns",!1),C=this.checkLastIdx(S[1],"col");a=S[0],l=C.index,this.parent.viewport.leftIndex=ce(c,this.parent.viewport.leftIndex-C.diff+u,!C.diff,"columns")-u,this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,u,!!C.diff,h===ce(c,u,!0,"columns")),this.parent.viewport.rightIndex=l,this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"first",refresh:"ColumnPart",frozenIndexes:b},this.getColAddress([a,l]))}else{if(a=ce(c,this.parent.viewport.leftIndex+u,!1,"columns"),a<u&&(a=u,a=ce(c,a,!0,"columns")),this.parent.viewport.leftIndex=a-u,l=ce(c,h+u-1,!1,"columns"),l<u||l<a){this.parent.viewport.leftIndex=h;return}var v=this.skipHiddenLastIdx(this.parent.viewport.rightIndex-(l-a+1-this.hiddenCount(a,l,"columns")),this.parent.viewport.rightIndex,"columns");this.parent.viewport.rightIndex=ce(c,v,!1,"columns"),this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,u),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:a,direction:"last",refresh:"ColumnPart",frozenIndexes:b},this.getColAddress([a,l]))}else h=this.parent.viewport.topIndex,this.parent.viewport.leftIndex=ce(c,this.parent.viewport.leftIndex+u,!1,"columns")-u,this.parent.viewport.leftIndex<0&&(this.parent.viewport.leftIndex=ce(c,u,!0,"columns")-u),this.parent.renderModule.refreshUI({rowIndex:p,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:b,skipTranslate:!0}),d&&(this.parent.viewport.topIndex=h),this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,u,this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===ce(c,c.colCount-1,!1,"columns")),this.translate({refresh:"Column"});this.updateScrollCount(e,"col",s),this.focusSheet()}}t.prev.idx=e}},o.prototype.focusSheet=function(){(!document.activeElement.classList.contains("e-text-findNext-short")||!H(document.activeElement,"#"+this.parent.element.id))&&Re(this.parent.element)},o.prototype.setThresholdHeight=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),a=this.parent.viewport.topIndex+i,l=a+e-1;r||n||l<a?this.translateY=a<=i?0:xi(s,i,a-1,!0):this.translateY=t-xi(s,a,l,!0)},o.prototype.setThresholdWidth=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),a=this.parent.viewport.leftIndex+i,l=a+e-1;r||n||l<a?this.translateX=a<=i?0:wi(s,i,a-1,!0):this.translateX=t-wi(s,a,l,!0)},o.prototype.translate=function(t){if(!(t.skipTranslate||!this.content)){var e=this.translateX||0;e=this.parent.enableRtl?-e:e,(t.refresh==="Row"||t.refresh==="RowPart")&&(this.content.style.transform="translate("+e+"px, "+this.translateY+"px)",this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)"),(t.refresh==="Column"||t.refresh==="ColumnPart")&&(this.content.style.transform="translate("+e+"px, "+this.translateY+"px)",this.colHeader.style.transform="translate("+e+"px, 0px)")}},o.prototype.updateColumnWidth=function(t){if(t.refresh==="Column"){this.content.style.width="";var e=this.parent.getActiveSheet(),i=wi(e,this.parent.viewport.leftIndex+this.parent.frozenColCount(e),this.parent.viewport.rightIndex,!0);if(this.colHeader.style.width=i+"px",this.content.style.width=i+"px",!this.parent.scrollSettings.isFinite||t.isUpdate){var r=this.parent.element.querySelector(".e-scroller .e-virtualtrack");if(!r)return;var n=parseInt(r.style.width,10),s=i+this.translateX+this.parent.viewport.beforeFreezeWidth;if(s>n){var a=s-n;r.style.width=n+a+"px"}else{var a=n-s,l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];n-a<parseInt(l.style.width,10)&&(r.style.width=l.style.width)}}}else if(!this.parent.scrollSettings.isFinite){var l=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0],h=parseInt(l.style.height,10),c=this.content.getBoundingClientRect().height,u=c+this.translateY+this.parent.viewport.beforeFreezeHeight;if(u>h){var a=u-h;l.style.height=h+a+"px"}else{var a=h-u,d=this.parent.getRowHeaderContent().getElementsByClassName("e-virtualtrack")[0];h-a<parseInt(d.style.height,10)&&(l.style.height=d.style.height)}}},o.prototype.updateRowColCount=function(t){if(this.scroll.length){var e=this.parent.getActiveSheet();if(t.update==="row"){if(t.index!==this.scroll[this.parent.activeSheetIndex].rowCount-1){var i=this.getVTrackHeight("height"),r=i;if(t.index>=this.scroll[this.parent.activeSheetIndex].rowCount?t.start===void 0?r+=xi(e,this.scroll[this.parent.activeSheetIndex].rowCount,t.index,!0):r+=xi(e,t.start,t.end,!0):t.start===void 0?r-=xi(e,t.index+1,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0):r-=xi(e,t.start,t.end,!0),!t.isDelete&&r<i)return;this.scroll[this.parent.activeSheetIndex].rowCount=t.index+1,this.updateVTrack(this.rowHeader,r,"height"),this.scroll[this.parent.activeSheetIndex].rowCount>e.rowCount&&this.parent.setSheetPropertyOnMute(e,"rowCount",this.scroll[this.parent.activeSheetIndex].rowCount)}}else if(t.index!==this.scroll[this.parent.activeSheetIndex].colCount-1){var n=this.getVTrackHeight("width"),s=n;if(t.index>=this.scroll[this.parent.activeSheetIndex].colCount?t.start===void 0?s+=wi(e,this.scroll[this.parent.activeSheetIndex].colCount,t.index,!0):s+=wi(e,t.start,t.end,!0):t.start===void 0?s-=wi(e,t.index+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0):s-=wi(e,t.start,t.end,!0),!t.isDelete&&s<n)return;this.scroll[this.parent.activeSheetIndex].colCount=t.index+1,this.updateVTrack(this.colHeader,s,"width"),this.scroll[this.parent.activeSheetIndex].colCount>e.colCount&&this.parent.setSheetPropertyOnMute(e,"colCount",this.scroll[this.parent.activeSheetIndex].colCount)}}},o.prototype.getVTrackHeight=function(t){var e=this.content.nextElementSibling.style[""+t];if(e.includes("e+")){e=e.split("px")[0];var i=e.split("e+");return Number(i[0])*Math.pow(10,Number(i[1]))}else return parseFloat(e)},o.prototype.updateVTrackHeight=function(t){if(this.parent.allowScrolling){var e=this.parent.frozenRowCount(this.parent.getActiveSheet());if(t.rowIdx<this.scroll[this.parent.activeSheetIndex].rowCount&&this.updateVTrack(this.rowHeader,this.getVTrackHeight("height")+t.threshold,"height"),t.rowIdx>=e&&t.rowIdx<this.parent.scrollModule.offset.top.idx+e){var i=this.parent.element.getElementsByClassName("e-main-panel")[0];i&&(this.parent.scrollModule.prevScroll.scrollTop=i.scrollTop+t.threshold,i.scrollTop+=t.threshold),this.parent.scrollModule.offset.top.size+=t.threshold,t.rowIdx<this.parent.viewport.topIndex+e&&(this.translateY+=t.threshold,this.translate({refresh:"Row"}))}}},o.prototype.updateVTrackWidth=function(t){if(!(Ft(this.parent.getActiveSheet(),t.colIdx)||!this.parent.allowScrolling)){var e=this.parent.frozenColCount(this.parent.getActiveSheet());if(t.colIdx>=this.parent.viewport.leftIndex+e&&t.colIdx<=this.parent.viewport.rightIndex){var i=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualtrack")[0];i.style.width=parseFloat(i.style.width)+t.threshold+"px";var r=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];r.style.width=parseFloat(r.style.width)+t.threshold+"px";var n=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0];n.style.width=parseFloat(n.style.width)+t.threshold+"px";var s=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualable")[0];s.style.width=parseFloat(s.style.width)+t.threshold+"px";var a=this.parent.getMainContent().getElementsByClassName("e-virtualable")[0];a.style.width=parseFloat(a.style.width)+t.threshold+"px"}else t.colIdx>=e&&t.colIdx<this.parent.viewport.leftIndex+e&&(this.parent.scrollModule.offset.left.size+=t.threshold,this.translateX+=t.threshold,this.translate({refresh:"Column"}))}},o.prototype.updateVTrack=function(t,e,i){t.nextElementSibling.style[""+i]=e+"px",this.content.nextElementSibling.style[""+i]=e+"px",i==="width"&&this.parent.allowScrolling&&(this.parent.getScrollElement().firstElementChild.style.width=e+"px")},o.prototype.deInitProps=function(){this.parent.viewport.leftIndex=null,this.parent.viewport.topIndex=null,this.parent.viewport.bottomIndex=null,this.translateX=null,this.translateY=null},o.prototype.updateScrollProps=function(t){var e=this;t===void 0&&(t={sheetIndex:0,sheets:this.parent.sheets}),this.scroll.length===0?this.initScroll():t.sheets.forEach(function(){e.scroll.splice(t.sheetIndex,0,{rowCount:0,colCount:0})})},o.prototype.sliceScrollProps=function(t){g(t.sheetIndex)?this.scroll.length=0:this.scroll.splice(t.sheetIndex,1)},o.prototype.updateTranslate=function(t){if(t.height){if(t.isRender)this.translateY-=t.height;else{var e=parseInt(this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0].style.height,10);t.isHide?(this.updateVTrack(this.rowHeader,e-t.height,"height"),this.setThresholdHeight(this.translateY,t.prevSize-1-this.parent.viewport.topIndex+1,this.parent.frozenRowCount(this.parent.getActiveSheet()))):(this.updateVTrack(this.rowHeader,e+t.height,"height"),this.translateY=this.translateY+t.size)}this.translate({refresh:"Row"})}t.width&&(this.translateX-=t.width,this.translate({refresh:"Column"}))},o.prototype.addEventListener=function(){this.parent.on(UM,this.createVirtualElement,this),this.parent.on(WM,this.translate,this),this.parent.on(co,this.updateColumnWidth,this),this.parent.on(TD,this.updateColumnWidth,this),this.parent.on(VM,this.onVerticalScroll,this),this.parent.on(_M,this.onHorizontalScroll,this),this.parent.on(Od,this.updateRowColCount,this),this.parent.on(Fn,this.updateVTrackHeight,this),this.parent.on(Qn,this.updateVTrackWidth,this),this.parent.on(nu,this.deInitProps,this),this.parent.on(ka,this.sliceScrollProps,this),this.parent.on(yg,this.updateScrollProps,this),this.parent.on(qc,this.updateTranslate,this),this.parent.on(Xn,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener();var t=document.querySelectorAll(".e-addNoteIndicator");t&&t.forEach(function(e){e.remove()}),this.rowHeader&&(lo(this.rowHeader),this.rowHeader.remove()),this.colHeader&&(lo(this.colHeader),this.colHeader.remove()),this.content&&(lo(this.content),this.content.remove()),this.rowHeader=null,this.colHeader=null,this.content=null,this.parent=null,this.scroll.length=0,this.translateX=null,this.translateY=null},o.prototype.removeEventListener=function(){this.parent.off(UM,this.createVirtualElement),this.parent.off(WM,this.translate),this.parent.off(co,this.updateColumnWidth),this.parent.off(TD,this.updateColumnWidth),this.parent.off(VM,this.onVerticalScroll),this.parent.off(_M,this.onHorizontalScroll),this.parent.off(Od,this.updateRowColCount),this.parent.off(Fn,this.updateVTrackHeight),this.parent.off(Qn,this.updateVTrackWidth),this.parent.off(ka,this.sliceScrollProps),this.parent.off(yg,this.updateScrollProps),this.parent.off(qc,this.updateTranslate),this.parent.off(Xn,this.destroy)},o})(),sE=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(mo,this.keyDownHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(mo,this.keyDownHandler)},o.prototype.keyDownHandler=function(t){var e=this,i=t.target,r=this.parent.enableRtl,n=this.parent.enableKeyboardShortcut;if(t.altKey&&(t.keyCode===38||t.keyCode===40)&&!n){t.preventDefault();return}if(t.altKey&&t.keyCode===38&&this.parent.element.lastElementChild.classList.contains("e-filter-popup")){this.parent.notify(C0,{closePopup:!0});return}if(this.parent.allowPrint&&t.ctrlKey&&t.keyCode===80&&n){t.preventDefault(),this.parent.print();return}var s=t.target;if(!g(s)&&s.classList.contains("e-addNoteContainer")){if(t.key==="Escape"||t.keyCode===27){var a=!g(this.parent.spreadsheetNoteModule.noteCellIndexes),l=a?this.parent.spreadsheetNoteModule.noteCellIndexes:xe(this.parent.getActiveSheet().activeCell),h=Q(l[0],l[1],this.parent.getActiveSheet()),c=this.parent.getCell(l[0],l[1]),u=Gn(this.parent,this.parent.activeSheetIndex)+"!"+Ve(l);if(!g(s)&&!g(s.value)&&(g(h)||g(h.notes)||h.notes!==s.value)&&document.activeElement.className.indexOf("e-addNoteContainer")>-1){var d=!g(h)&&h.notes?"editNote":"addNote";this.parent.notify(Hh,{args:{action:"beforeCellSave",eventArgs:{address:u}}}),gr(this.parent,this.parent.getActiveSheet(),{rowIdx:l[0],colIdx:l[1],preventEvt:!0,cell:{notes:s.value,isNoteEditable:!1}});var p={notes:s.value,address:u};this.parent.notify(wt,{eventArgs:p,action:d})}this.parent.spreadsheetNoteModule.isShowNote=null,this.parent.notify(jc,""),Re(c)}return}var f=this.parent.serviceLocator.getService(jt).dialogInstance,v=i.id===this.parent.element.id+"_name_box";if(this.parent.selectionSettings.mode==="None"||f||this.parent.isEdit||i.classList.contains("e-ss-ddb")&&t.keyCode!==117&&t.keyCode!==9||v&&t.keyCode!==117||i.classList.contains("e-sheet-rename")||i.id===this.parent.element.id+"_SearchBox"||i.classList.contains("e-chk-hidden")||i.classList.contains("e-ddl")&&i.classList.contains("e-input-focus")){if(f){if(t.keyCode===13)f.element.classList.contains("e-spreadsheet-function-dlg")&&(i.classList.contains("e-formula-list")||i.classList.contains("e-list-item"))&&Re(f.element.querySelector(".e-footer-content .e-primary"));else if(t.keyCode===9){if(f.element.classList.contains("e-find-dlg")){var m=f.element.querySelectorAll(".e-footer-content .e-btn:not(:disabled)"),y=m.length?m[m.length-1].className:"e-findnreplace-checkmatch";if(t.shiftKey){if(document.activeElement.classList.contains("e-dlg-closeicon-btn"))if(t.preventDefault(),m.length)Re(m[m.length-1]);else{var b=f.element.querySelector(".e-findnreplace-exactmatchcheckbox");b&&(Re(b.querySelector(".e-findnreplace-checkmatch")),b.classList.add("e-focus"))}}else document.activeElement.className.includes(y)&&Re(f.element)}else if(f.element.classList.contains("e-protect-dlg")){if(t.shiftKey?document.activeElement.classList.contains("e-primary"):document.activeElement.id===this.parent.element.id+"_protect_check"){var S=f.element.querySelector(".e-protect-option-list");if(S&&!S.querySelector(".e-list-item.e-focused")){var C=S.querySelector(".e-list-item");C&&C.classList.add("e-focused")}}}else if(f.element.classList.contains("e-custom-format-dlg"))if(t.shiftKey){if(document.activeElement.className.includes("e-list-item e-active")){var S=H(document.activeElement,".e-custom-listview");S&&Re(S)}}else if(document.activeElement.classList.contains("e-btn")&&document.activeElement.parentElement.classList.contains("e-input-button")){var S=f.element.querySelector(".e-custom-listview"),x=ot(S,"listview");if(S){var C=S.querySelector(".e-list-item.e-active");if(!C)if(C=S.querySelector(".e-list-item"),C)x.selectItem(C);else return;t.preventDefault(),C.focus()}}else document.activeElement.classList.contains("e-list-item")&&Re(f.element);else if(f.element.classList.contains("e-spreadsheet-function-dlg")){if(t.shiftKey&&document.activeElement.className.includes("e-list-item e-active")){var S=H(document.activeElement,".e-formula-list");S&&Re(S)}}else if(f.element.classList.contains("e-goto-dlg")&&!f.element.classList.contains("e-dlg-modal"))if(t.shiftKey){if(document.activeElement.className.includes("e-dlg-closeicon-btn")){var I=f.element.querySelector(".e-footer-content .e-btn");I&&(t.preventDefault(),Re(I))}}else document.activeElement.className.includes("e-btn-goto-ok")&&Re(f.element)}}else v&&t.keyCode===9&&t.shiftKey&&this.focusEle(t,".e-formula-bar",!1,!0);var p={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,p);var D=pt(p.editedValue,!0);this.parent.isEdit&&D&&t.shiftKey&&!t.ctrlKey&&Yc(t.keyCode)&&this.shiftSelection(t);return}var M=this.parent.getActiveSheet(),E=xe(M.activeCell);if(t.altKey){if(t.keyCode===40){if(i.classList.contains("e-dropdown-btn")||i.classList.contains("e-split-btn"))return;var A={e:t,isFilterCell:!1};if(this.parent.notify(C0,A),A.isFilterCell)return}if(t.keyCode===40&&!document.getElementById(this.parent.element.id+"listValid_popup")){var h=this.parent.getCell(E[0],E[1]);if(h){var L=h.querySelector(".e-validation-list .e-ddl");if(L){Re(L);var N=L.querySelector(".e-dropdownlist")||L,x=ot(N,"dropdownlist");x&&x.showPopup();return}}}}i.id===this.parent.element.id+"_File"&&Re(this.parent.element);var R=i.classList.contains("e-add-sheet-tab")||i.classList.contains("e-sheets-list")||i.classList.contains("e-tab-wrap")&&!!H(i,".e-sheet-tabs-items")||i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-nav");[9,37,38,39,40,33,34,35,36].indexOf(t.keyCode)>-1&&!R&&t.preventDefault();var P,k=ie(M.selectedRange);if(t.keyCode===36){var B=this.parent.frozenColCount(M),F=void 0;if(t.ctrlKey||t.metaKey){var O=ce(M,this.parent.frozenRowCount(M),!0);t.shiftKey?F=[E[0],E[1],O,ce(M,B,!0,"columns")]:(F=[O,ce(M,B,!0,"columns"),O],F[3]=F[1]);var z=this.parent.element.querySelector(".e-main-panel");z.scrollTop&&(z.scrollTop=0);var Y=this.parent.getScrollElement();Y.scrollLeft&&(Y.scrollLeft=0)}else if(t.shiftKey){var K=ce(M,B,!0,"columns");M.frozenColumns&&ce(M,E[1],!0,"columns")===K?F=[k[0],E[1],k[2],ce(M,0,!0,"columns")]:F=[k[0],E[1],k[2],K],this.scrollNavigation([F[2],F[3]],!0)}else{var K=ce(M,B,!0,"columns");M.frozenColumns&&(K===E[1]||B===E[1])&&(K=ce(M,0,!0,"columns")),F=[E[0],K,E[0],K],this.scrollNavigation([F[0],F[1]],!0)}this.updateSelection(M,F,t)}else if(t.ctrlKey||t.metaKey){if(t.keyCode===35){t.preventDefault();var U=ce(M,M.usedRange.rowIndex,!1);U=U>-1?U:M.usedRange.rowIndex;var q=ce(M,M.usedRange.colIndex,!1,"columns");q=q>-1?q:M.usedRange.colIndex,t.shiftKey||(E[0]=U,E[1]=q),E[2]=U,E[3]=q,this.updateSelection(M,E.concat(E),t),this.scrollNavigation([U,q],!0)}else t.keyCode===32&&!t.shiftKey&&n&&(k[0]=0,k[2]=M.rowCount-1,this.updateSelection(M,k,{shiftKey:!0}));if(t.keyCode===40||t.keyCode===39||t.keyCode===38||t.keyCode===37)t.shiftKey?(t.keyCode===40?k[2]=this.getNextNonEmptyCell(k[2],E[1],"down"):t.keyCode===39&&!r||t.keyCode===37&&r?k[3]=this.getNextNonEmptyCell(E[0],k[3],"right"):t.keyCode===38?k[2]=this.getNextNonEmptyCell(k[2],E[1],"top"):k[3]=this.getNextNonEmptyCell(E[0],k[3],"left"),this.updateSelection(M,k,t),this.scrollNavigation([k[2],k[3]],!0)):(t.keyCode===37&&!r||t.keyCode===39&&r?E[1]=this.getNextNonEmptyCell(E[0],E[1],"left"):t.keyCode===38?E[0]=this.getNextNonEmptyCell(E[0],E[1],"top"):t.keyCode===39&&!r||t.keyCode===37&&r?E[1]=this.getNextNonEmptyCell(E[0],E[1],"right"):E[0]=this.getNextNonEmptyCell(E[0],E[1],"down"),this.parent.selectRange(Ve(E)),this.scrollNavigation([E[0],E[1]],!0));else if(t.keyCode===117){var ae=document.activeElement;ae.classList.contains("e-spreadsheet")||H(ae,".e-sheet")?this.setFocus("Sheet",t,!0):R?this.setFocus("SheetTabs",t):H(ae,".e-ribbon")?this.setFocus("Ribbon",t):(v||ae.classList.contains("e-insert-function"))&&this.setFocus("FormulaBar",t)}}else{if(t.shiftKey){if(t.keyCode===32&&n&&(t.preventDefault(),k[1]=0,k[3]=M.colCount-1,this.updateSelection(M,k,t)),this.shiftSelection(t),(t.keyCode===34||t.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var te=0,z=this.parent.element.querySelector(".e-main-panel"),he=ce(M,xe(M.paneTopLeftCell)[0],!0),ue=Fd(this.parent,he).height;if(t.keyCode===34){if(te=ue+this.parent.scrollModule.offset.top.size,!this.parent.scrollSettings.isFinite){var ne=this.parent.getMainContent().querySelector(".e-virtualtrack");ne&&parseFloat(ne.style.height)<te+ue&&(ne.style.height=te+ue+"px")}}else if(te=this.parent.scrollModule.offset.top.size-ue,Math.round(te)<0)if(z.scrollTop)te=0;else{this.parent.selectRange(Ve([k[0],k[1],he,k[3]]));return}var le=ce(M,ie(M.selectedRange)[2],!0),$=he>le?0:le-he;this.parent.scrollModule&&z.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),z.scrollTop=te,er(function(){t.keyCode===34?(k[2]=ce(M,xe(M.paneTopLeftCell)[0]+$,!0),e.parent.scrollSettings.isFinite&&k[2]>M.rowCount-1&&(k[2]=ce(M,M.rowCount-1,!1),k[2]=k[2]<0?0:k[2])):(k[2]=ce(M,xe(M.paneTopLeftCell)[0]+$,!1),k[2]=k[2]<0?0:k[2]),e.updateSelection(M,k,t)})}}else if(t.keyCode===9||(this.parent.enableRtl?t.keyCode===37:t.keyCode===39)){var h=Q(E[0],E[1],M);if(h&&h.colSpan>1&&(E[1]+=h.colSpan-1),E[1]<M.colCount-1&&(!M.isProtected||M.protectSettings.selectCells))E[1]+=1,P=!0;else if(M.protectSettings.selectUnLockedCells){var ee=this.getNextUnlockedCell("right",E);P=E[1]!==ee[1]||E[0]!==ee[0],E[1]=ee[1],E[0]=ee[0]}}else if(t.keyCode===13||t.keyCode===40){var h=Q(E[0],E[1],M);if(h&&h.rowSpan>1&&(E[0]+=h.rowSpan-1),E[0]<M.rowCount-1&&(!M.isProtected||M.protectSettings.selectCells))P=!0,E[0]+=1;else if(M.protectSettings.selectUnLockedCells){var ee=this.getNextUnlockedCell("down",E);P=E[0]!==ee[0]||E[1]!==ee[1],E[1]=ee[1],E[0]=ee[0]}}else if((t.keyCode===34||t.keyCode===33)&&this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){var z=this.parent.element.querySelector(".e-main-panel"),te=0,He=ce(M,xe(M.paneTopLeftCell)[0],!0),qe=ce(M,xe(M.activeCell)[0],!0),ue=Fd(this.parent,He).height;if(t.keyCode===34){if(te=this.parent.scrollModule.offset.top.size+ue,!this.parent.scrollSettings.isFinite){var ne=this.parent.getMainContent().querySelector(".e-virtualtrack");ne&&parseFloat(ne.style.height)<te+ue&&(ne.style.height=te+ue+"px")}}else{if(te=this.parent.scrollModule.offset.top.size-ue,M.frozenRows&&E[0]<this.parent.frozenRowCount(M)){this.parent.selectRange(Ve([He,k[1],He,k[1]]));return}if(Math.round(te)<0)if(z.scrollTop)te=0;else return}var we=He>qe?0:qe-He;this.parent.scrollModule&&z.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),z.scrollTop=te,er(function(){var Se;t.keyCode===34?(Se=ce(M,xe(M.paneTopLeftCell)[0]+we,!0),e.parent.scrollSettings.isFinite&&Se>M.rowCount-1&&(Se=ce(M,M.rowCount-1,!1),Se=Se<0?0:Se)):(Se=xe(M.paneTopLeftCell)[0]+we,Se-=e.parent.hiddenCount(He,qe),Se=ce(M,Se,!1),Se=Se<0?0:Se),e.parent.notify(Pc,{range:[Se,E[1],Se,E[1]],preventAnimation:!0})})}if(t.shiftKey?t.keyCode===9:this.parent.enableRtl?t.keyCode===39:t.keyCode===37){if(E[1]>0&&(!M.isProtected||M.protectSettings.selectCells))E[1]-=1,P=!0;else if(M.protectSettings.selectUnLockedCells){var ee=this.getNextUnlockedCell("left",E);P=E[1]!==ee[1]||E[0]!==ee[0],E[1]=ee[1],E[0]=ee[0]}if(E[1]<=0){var je=this.parent.getMainContent();E[1]===0&&je.scrollLeft&&!this.parent.enableRtl&&(je.scrollLeft=0)}}else if((t.shiftKey?t.keyCode===13:t.keyCode===38)&&!this.parent.element.querySelector(".e-find-toolbar")){if(E[0]>0&&(!M.isProtected||M.protectSettings.selectCells))E[0]-=1,P=!0;else if(M.protectSettings.selectUnLockedCells){var Ne=this.getNextUnlockedCell("up",E);P=E[0]!==Ne[0]||E[1]!==Ne[1],E[1]=Ne[1],E[0]=Ne[0]}if(E[0]<=0){var Ye=this.parent.getMainContent().parentElement;E[0]===0&&Ye.scrollTop&&(Ye.scrollTop=0)}}}if(P&&(!this.parent.scrollModule||this.parent.scrollModule.isKeyScroll)&&!R&&!H(document.activeElement,".e-ribbon")&&!i.classList.contains("e-insert-function")&&(!i.classList.contains("e-formula-bar")||i.classList.contains("e-formula-bar")&&i.nodeName==="TEXTAREA"&&t.keyCode===13)){if(t.keyCode===40||t.keyCode===38||t.keyCode===13){for(;lt(M,E[0]);)if((t.keyCode===40||!t.shiftKey&&t.keyCode===13)&&(E[0]=E[0]+1),(t.keyCode===38||t.shiftKey&&t.keyCode===13)&&(E[0]=E[0]-1,E[0]<0))return}if(t.keyCode===37||t.keyCode===39||t.keyCode===9){for(;Ft(M,E[1]);)if((t.keyCode===39||!t.shiftKey&&t.keyCode===9)&&(E[1]=E[1]+1),(t.keyCode===37||t.shiftKey&&t.keyCode===9)&&(E[1]=E[1]-1,E[1]<0))return}var dt=ie(M.topLeftCell);M.frozenRows&&E[0]<dt[0]&&(E[0]=ce(M,dt[0],!0)),M.frozenColumns&&E[1]<dt[1]&&(E[1]=ce(M,dt[1],!0,"columns")),this.scrollNavigation(E);var Ke=Ve(E),ci=function(tr){if(Ke!==M.selectedRange){e.parent.selectionModule.previousActiveCell=M.activeCell,document.getElementsByClassName("e-addNoteContainer")&&document.getElementsByClassName("e-addNoteContainer").length>0&&e.parent.notify(jc,""),e.parent.setSheetPropertyOnMute(M,"activeCell",Ke),e.parent.notify(Pc,{range:E.concat(E),preventAnimation:tr});var _;j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)&&(_=e.parent.element.querySelector(".e-ss-focus-edit")),_=_||e.parent.getCell(E[0],E[1]),_&&Re(_)}};if(this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){if(Ke===M.selectedRange)return;er(ci.bind(this,!0))}else ci()}else if(t.keyCode===9){var Jt=this.parent.showRibbon&&H(document.activeElement,".e-ribbon");if(Jt)H(document.activeElement,".e-tab-header")?t.shiftKey||Jt.classList.contains("e-collapsed")?this.focusEle(t,".e-ribbon .e-drop-icon"):this.focusEle(t,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn"):H(document.activeElement,".e-content")?t.shiftKey?this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.focusEle(t,".e-ribbon .e-drop-icon"):document.activeElement.classList.contains("e-drop-icon")&&(t.shiftKey&&!Jt.classList.contains("e-collapsed")?this.focusEle(t,".e-ribbon .e-content .e-toolbar-item:not(.e-separator):not(.e-overlay):not(.e-hide) .e-btn"):this.focusEle(t,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0));else if(i.classList.contains("e-insert-function"))t.shiftKey?this.focusEle(t,".e-formula-bar-panel .e-combobox"):this.focusEle(t,".e-formula-bar",!1,!0);else if(R)if(t.shiftKey){var vt=i.classList.contains("e-aggregate-list")||i.classList.contains("e-scroll-left-nav");if(i.classList.contains("e-add-sheet-tab")||vt||i.classList.contains("e-sheets-list")&&i.previousElementSibling&&i.previousElementSibling.disabled){var bi=!vt&&this.parent.element.querySelector(".e-aggregate-list");if(bi)this.focusEle(t,null,!1,!1,bi);else if(!i.classList.contains("e-scroll-left-nav")&&this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav"))this.focusEle(t,".e-sheet-tab-panel .e-scroll-right-nav",!0);else{var Bi=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item"));Bi[Bi.length-1]&&this.focusEle(t,null,!0,!1,Bi[Bi.length-1].querySelector(".e-tab-wrap"))}}else if(i.classList.contains("e-scroll-right-nav"))this.focusEle(t,".e-sheet-tab-panel .e-scroll-left-nav",!0);else if(i.classList.contains("e-tab-wrap")){var Bi=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),ee=Bi.indexOf(i.parentElement);ee===0?this.focusEle(t,".e-sheet-tab-panel .e-sheets-list"):this.focusEle(t,null,!0,!1,Bi[ee-1].querySelector(".e-tab-wrap"))}}else{var Dr=!!this.parent.element.querySelector(".e-aggregate-list");if(i.classList.contains("e-aggregate-list")||!Dr&&i.classList.contains("e-scroll-right-nav"))this.focusEle(t,".e-sheet-tab-panel .e-icon-btn:not(:disabled)");else if(i.classList.contains("e-sheets-list"))this.focusEle(t,".e-sheet-tab-panel .e-toolbar-item .e-tab-wrap",!0);else if(i.classList.contains("e-scroll-left-nav"))this.focusEle(t,".e-sheet-tab-panel .e-scroll-right-nav",!0);else if(i.classList.contains("e-tab-wrap")){var Bi=[].slice.call(this.parent.element.querySelectorAll(".e-sheet-tab-panel .e-toolbar-item")),vr=Bi.indexOf(i.parentElement);if(vr===Bi.length-1){var Fi=!!this.parent.element.querySelector(".e-sheet-tab-panel .e-scroll-nav");(Fi||!Dr)&&this.focusEle(t,".e-sheet-tab-panel ."+(Fi?"e-scroll-nav":"e-icon-btn:not(:disabled)"),Fi)}else this.focusEle(t,null,!0,!1,Bi[vr+1].querySelector(".e-tab-wrap"))}}}t.keyCode===121&&t.shiftKey&&!this.parent.enableKeyboardShortcut&&t.preventDefault()},o.prototype.setFocus=function(t,e,i){t==="Sheet"?e.shiftKey?this.parent.showFormulaBar?this.focusEle(e,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",e,i):this.parent.showSheetTabs?this.focusEle(e,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):this.setFocus("SheetTabs",e,i):t==="SheetTabs"?e.shiftKey?i||this.focusEle(e,".e-selectall"):this.parent.showRibbon?this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",e,i):t==="Ribbon"?e.shiftKey?this.parent.showSheetTabs?this.focusEle(e,".e-sheet-tab-panel .e-icon-btn:not(:disabled)"):i||this.focusEle(e,".e-selectall"):this.parent.showFormulaBar?this.focusEle(e,".e-formula-bar-panel .e-combobox"):this.setFocus("FormulaBar",e,i):t==="FormulaBar"&&(e.shiftKey?this.parent.showRibbon?this.focusEle(e,".e-ribbon .e-toolbar-items .e-toolbar-item.e-active .e-tab-wrap",!0):this.setFocus("Ribbon",e,i):i||this.focusEle(e,".e-selectall"))},o.prototype.focusEle=function(t,e,i,r,n){if(n=n||this.parent.element.querySelector(e),i&&!n){var s=this.parent.element.querySelector(".e-ribbon .e-tab"),a=s&&ot(s,"tab").selectedItem||0;n=this.parent.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[a],n=n&&n.querySelector(".e-tab-wrap")}if(n)if(t.preventDefault(),r)n.click(),Re(n),n.setSelectionRange(n.value.length,n.value.length);else if(i){if(n.setAttribute("tabindex","0"),n.parentElement.classList.contains("e-active")&&n.parentElement.classList.contains("e-toolbar-item")){var s=this.parent.element.querySelector(".e-sheet-tab-panel .e-sheet-tab");!s&&s.classList.contains("e-focused")&&s.classList.add("e-focused")}n.focus()}else Re(n)},o.prototype.updateSelection=function(t,e,i){t.isProtected&&!t.protectSettings.selectCells&&t.protectSettings.selectUnLockedCells?Ko(this.parent,tt(e))||this.parent.notify(Pc,{range:e,shiftKey:i.shiftKey}):this.parent.notify(Pc,{range:e,shiftKey:i.shiftKey})},o.prototype.getNextNonEmptyCell=function(t,e,i){var r=this.parent.getActiveSheet(),n=function(b,S){var C=Q(b,S,r,null,!0).value;return!g(C)&&C!==""},s,a;if(i==="down"){var l=ce(r,t+1,!0);s=n(l,e);for(var h=ce(r,r.rowCount-1,!1),c=l;c<r.rowCount;c++){if(c===h)return c;if(s){if(!n(ce(r,c,!0),e))return ce(r,c-1,!1)}else if(a=ce(r,c+1,!0),n(a,e))return a}return t}else if(i==="top"){var l=ce(r,t-1,!1);s=n(l,e);for(var u=this.parent.frozenRowCount(r)?ie(r.topLeftCell)[0]:0,d=ce(r,u,!0),p=l;p>=0;p--){if(p===d)return p;if(s){if(!n(ce(r,p,!1),e))return ce(r,p+1,!0)}else if(a=ce(r,p-1,!1),n(a,e))return a}return t}else if(i==="right"){var f=ce(r,e+1,!0,"columns");s=n(t,f);for(var v=ce(r,r.colCount-1,!1,"columns"),m=f;m<r.colCount;m++){if(m===v)return m;if(s){if(!n(t,ce(r,m,!0,"columns")))return ce(r,m-1,!1,"columns")}else if(a=ce(r,m+1,!0,"columns"),n(t,a))return a}return e}else{var f=ce(r,e-1,!1,"columns");s=n(t,f);for(var u=this.parent.frozenColCount(r)?ie(r.topLeftCell)[1]:0,d=ce(r,u,!0,"columns"),y=f;y>=0;y--){if(y===d)return y;if(s){if(!n(t,ce(r,y,!1,"columns")))return ce(r,y+1,!0,"columns")}else if(a=ce(r,y-1,!1,"columns"),n(t,a))return a}return e}},o.prototype.getNextUnlockedCell=function(t,e){var i=this.parent.getActiveSheet(),r,n;if(t==="right")for(var s=e[0],a=void 0,l=void 0,h=i.usedRange.rowIndex,c=i.usedRange.colIndex;s<=h;){for(a=a===void 0?e[1]+1:0,l&&s===e[0]&&(c=e[1]-1),a;a<=c;a++)if(r=Q(s,a,i),n=Ht(i,a)||{},!mn(r,n)&&!n.hidden&&!lt(i,s))return[s,a];s===i.usedRange.rowIndex&&!l?(s=0,h=e[0],l=!0):s++}else if(t==="left")for(var s=e[0],a=void 0,l=void 0,h=0,c=0;s>=h;){for(a=a===void 0?e[1]-1:i.usedRange.colIndex,l&&s===e[0]&&(c=e[1]+1),a;a>=c;a--)if(r=Q(s,a,i),n=Ht(i,a)||{},!mn(r,n)&&!n.hidden&&!lt(i,s))return[s,a];s===0&&!l?(s=i.usedRange.rowIndex,h=e[0],l=!0):s--}else if(t==="down")for(var a=e[1],s=void 0,l=void 0,c=i.usedRange.colIndex,h=i.usedRange.rowIndex;a<=c;){for(s=s===void 0?e[0]+1:0,l&&a===e[1]&&(h=e[0]-1),s;s<=h;s++)if(r=Q(s,a,i),n=Ht(i,a)||{},!mn(r,n)&&!n.hidden&&!lt(i,s))return[s,a];a===i.usedRange.colIndex&&!l?(a=0,c=e[1],l=!0):a++}else for(var a=e[1],s=void 0,l=void 0,c=0,h=0;a>=c;){for(s=s===void 0?e[0]-1:i.usedRange.rowIndex,l&&a===e[1]&&(h=e[0]+1),s;s>=h;s--)if(r=Q(s,a,i),n=Ht(i,a)||{},!mn(r,n)&&!n.hidden&&!lt(i,s))return[s,a];a===0&&!l?(a=i.usedRange.colIndex,c=e[1],l=!0):a--}return e},o.prototype.shiftSelection=function(t){var e=this.parent.getActiveSheet(),i=ie(e.selectedRange),r=tt(i),n=!0,s=this.parent.enableRtl;if(t.keyCode===38){for(var a=r[1];a<=r[3];a++){var l=Q(i[2],a,e);if(!g(l)&&l.rowSpan&&l.rowSpan<0){i[2]=ce(e,i[2]-(Math.abs(l.rowSpan)+1),!1),n=!1;break}}n&&(i[2]=ce(e,i[2]-1,!1));var h=this.parent.frozenRowCount(e)?ie(e.topLeftCell)[0]:0;if(i[2]<h)return}if(t.keyCode===40){for(var a=r[1];a<=r[3];a++){var l=Q(i[2],a,e);if(!g(l)&&l.rowSpan&&l.rowSpan>0){i[2]=ce(e,i[2]+Math.abs(l.rowSpan),!0),n=!1;break}}if(n&&(i[2]=ce(e,i[2]+1,!0)),i[2]>=e.rowCount&&(i[2]=ce(e,e.rowCount-1,!1),i[2]<0))return}if(t.keyCode===39&&!s||t.keyCode===37&&s){for(var a=r[0];a<=r[2];a++){var l=Q(a,i[3],e);if(!g(l)&&l.colSpan&&l.colSpan>0){i[3]=ce(e,i[3]+Math.abs(l.colSpan),!0,"columns"),n=!1;break}}if(n&&(i[3]=ce(e,i[3]+1,!0,"columns")),i[3]>=e.colCount&&(i[3]=ce(e,e.colCount-1,!1,"columns"),i[3]<0))return}if(t.keyCode===37&&!s||t.keyCode===39&&s){for(var a=r[0];a<=r[2];a++){var l=Q(a,i[3],e);if(!g(l)&&l.colSpan&&l.colSpan<0){i[3]=ce(e,i[3]-(Math.abs(l.colSpan)+1),!1,"columns"),n=!1;break}}n&&(i[3]=ce(e,i[3]-1,!1,"columns"));var h=this.parent.frozenColCount(e)?ie(e.topLeftCell)[1]:0;if(i[3]<h)return}if(!this.parent.scrollSettings.enableVirtualization&&t.shiftKey&&t.ctrlKey){var c=[e.usedRange.rowIndex,e.usedRange.colIndex];if(t.keyCode===37&&(i[3]<=c[1]?i[3]=ce(e,0,!0,"columns"):i[3]=ce(e,c[1],!0,"columns")),t.keyCode===38&&(i[2]<=c[0]?i[2]=ce(e,0,!0):i[2]=ce(e,c[0],!0)),t.keyCode===39&&(i[3]<=c[1]?i[3]=ce(e,c[1],!1,"columns"):i[3]=ce(e,e.colCount,!1,"columns"),i[3]<0)||t.keyCode===40&&(i[2]<=c[0]?i[2]=ce(e,c[0],!1):i[2]=ce(e,e.rowCount,!1),i[2]<0))return}if(t.keyCode===37||t.keyCode===39||t.keyCode===38||t.keyCode===40){var u=xe(e.activeCell);this.parent.isEdit&&t.shiftKey?(t.preventDefault(),this.parent.notify(XM,{range:i,e:t}),this.parent.notify(Rl,{range:Ve(tt(i)),isSelect:!1}),this.parent.notify(E0,{})):this.parent.notify(Pc,{range:i,shiftKey:t.shiftKey}),this.scrollNavigation([Ez(e,i)?u[0]:i[2],KD(e,i)?u[1]:i[3]])}},o.prototype.scrollNavigation=function(t,e){if(this.parent.allowScrolling){var i=this.parent.enableRtl?-1:1,r=this.parent.getMainContent().parentElement,n=this.parent.getScrollElement(),s=this.parent.getActiveSheet(),a=tt(ie(s.selectedRange)),l=xe(s.topLeftCell),h=this.parent.frozenRowCount(s),c=this.parent.frozenColCount(s),u=xe(s.paneTopLeftCell),d=ce(s,t[0]<h?l[0]:u[0],!0),p=this.parent.scrollModule.offset.top.size;if(r.scrollTop){if(h&&t[0]!==a[2]){if(t[0]===h){r.scrollTop=0;return}t[0]===h-1&&(r.scrollTop=0)}else if(t[0]===ce(s,0,!0)){r.scrollTop=0;return}}if(n&&n.scrollLeft){if(c&&t[1]!==a[3]){if(t[1]===c){n.scrollLeft=0;return}t[1]===c-1&&(n.scrollLeft=0)}else if(t[1]===ce(s,0,!0,"columns")){n.scrollLeft=0;return}}var f=Fd(this.parent,d).index;if(f<=t[0]){if(t[0]>=h)if(e){var v=r.getBoundingClientRect().height,m=xi(s,u[0],t[0],!0);m>v*2?r.scrollTop=p+m-v:r.scrollTop=p+m-ei(s,t[0],!0),Re(this.parent.element)}else r.scrollTop=p+xi(s,f,t[0],!0)}else d>t[0]&&(r.scrollTop&&(this.parent.scrollModule.isKeyScroll=!1),r.scrollTop=p-Math.ceil(xi(s,t[0],d-1,!0)),e&&Re(this.parent.element));var y=Tb(this.parent,u[1]);if(y<=t[1]&&n){if(t[1]>=c)if(e){var b=n.getBoundingClientRect().width,S=wi(s,u[1],t[1],!0);S>b*2?n.scrollLeft=(this.parent.scrollModule.offset.left.size+S-b)*i:n.scrollLeft=(this.parent.scrollModule.offset.left.size+(S-qr(s,t[0],null,!0)))*i,Re(this.parent.element)}else n.scrollLeft=(this.parent.scrollModule.offset.left.size+wi(s,y,t[1],!0))*i}else u[1]>t[1]&&n&&(n.scrollLeft&&(this.parent.scrollModule.isKeyScroll=!1),n.scrollLeft=(this.parent.scrollModule.offset.left.size-wi(s,t[1],u[1]-1,!0))*i,e&&Re(this.parent.element))}},o.prototype.getModuleName=function(){return"keyboardNavigation"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o})(),aE=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(mo,this.keyDownHandler,this),this.parent.on(Ds,this.keyUpHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(mo,this.keyDownHandler),this.parent.off(Ds,this.keyUpHandler))},o.prototype.isTrgtNotInput=function(t){var e=t.target;return!H(e,".e-filter-popup")&&!H(e,".e-find-dlg")&&!H(e,".e-hyperlink-dlg")&&!H(e,".e-sheet-tab")&&!H(e,".e-name-box")&&!H(e,".e-link-dialog")},o.prototype.ribbonShortCuts=function(t){if(this.parent.showRibbon&&t.altKey&&!t.ctrlKey&&!t.shiftKey){var e=ot(this.parent.element.querySelector(".e-ribbon .e-tab"),"tab"),i=void 0;if(t.keyCode===72)i=1;else if(t.keyCode===78)i=2;else if(t.keyCode===65)i=4;else if(t.keyCode===87)i=5;else if(t.keyCode===77)i=3;else if(t.keyCode===70)t.preventDefault(),J("#"+this.parent.element.id+"_File",this.parent.element).click();else if(t.keyCode===18){t.preventDefault();var r=xe(this.parent.getActiveSheet().activeCell),n={sheetIdx:this.parent.activeSheetIndex};if(this.parent.notify(ou,n),!(n.hasFilter&&n.filterRange&&n.filterRange[0]===r[0]&&n.filterRange[1]<=r[1]&&n.filterRange[3]>=r[1])){var s=document.activeElement;if(!s.classList.contains("e-spreadsheet-edit")&&!s.classList.contains("e-sheet-rename")&&s.id!==this.parent.element.id+"_name_box"&&!H(s,".e-dropdown-btn")&&!H(s,".e-split-btn")&&!H(s,".e-popup-open")&&!s.classList.contains("e-formula-bar")){var a=this.parent.getCell(r[0],r[1]);if(a&&a.querySelector(".e-validation-list"))return;if(H(s,".e-ribbon")){Re(this.parent.element);return}for(var l=0;l<=this.parent.ribbonModule.ribbon.items.length;l++)if(l===this.parent.ribbonModule.ribbon.selectedTab){var h=this.parent.element.querySelector(".e-toolbar-items").children[l+2].children[0];h.setAttribute("tabindex","0"),Re(h);return}}}}i&&(!e.items[i].disabled&&!e.items[i].cssClass.includes("e-hide")?(t.preventDefault(),e.select(i,Object.assign(t,{isShortcut:!0}))):Re(this.parent.element))}},o.prototype.keyUpHandler=function(t){if(t.keyCode===37||t.keyCode===39){var e=document.activeElement;if(e.classList.contains("e-colorpicker-wrapper")||e.classList.contains("e-split-btn-wrapper")){var i=e.querySelector(".e-split-btn");i&&Re(i)}}else if(t.keyCode===13){var r=t.target;if(r.classList.contains("e-scroll-nav")){var n=function(){r.getAttribute("tabindex")||(r.setAttribute("tabindex","0"),Re(r)),T.remove(r,"blur",n)};T.add(r,"blur",n,this)}}},o.prototype.keyDownHandler=function(t){var e=this.parent.selectionSettings.mode==="None";this.ribbonShortCuts(t);var i=this.parent.getActiveSheet(),r=t.target,n=t.target;if(!(!g(n)&&n.classList.contains("e-addNoteContainer"))){if((t.ctrlKey||t.metaKey)&&this.isTrgtNotInput(t)){!H(r,".e-find-dlg")&&!e&&([79,83].indexOf(t.keyCode)>-1||t.keyCode===65&&!this.parent.isEdit)&&t.preventDefault();var s=xe(i.activeCell);if(t.keyCode===79)this.parent.allowOpen&&this.parent.openUrl&&J("#"+this.parent.element.id+"_fileUpload",this.parent.element).click();else if(t.keyCode===83)this.parent.saveUrl&&this.parent.allowSave&&this.parent.notify(fg,null);else if(t.keyCode===67&&!e)this.parent.notify(ru,{promise:Promise});else if(t.keyCode===75&&!e){var a=i.rows[s[0]],l=void 0;t.preventDefault(),g(a)||(l=a.cells[s[1]]),g(l)&&Zt(s[0],s[1],i,l,!1),l&&l.hyperlink?this.parent.notify(Ng,null):this.parent.notify(Lg,null)}else if(t.keyCode===90&&!e)this.parent.isEdit||(t.preventDefault(),this.parent.notify(yo,{isUndo:!0}));else if(t.keyCode===89&&!e)this.parent.isEdit||(t.preventDefault(),this.parent.notify(yo,{isUndo:!1}));else if((t.keyCode===82||t.keyCode===68)&&!e){t.preventDefault();var h=tt(ie(i.selectedRange)),c={colIndex:h[1],rowIndex:h[0]},u=void 0,d=void 0;if(t.keyCode===68?(h[0]===h[2]?c.rowIndex=h[0]-1:h[0]+=1,d=Ve([c.rowIndex,c.colIndex,c.rowIndex,h[3]]),u="Down"):(h[1]===h[3]?c.colIndex=h[1]-1:h[1]+=1,u="Right",d=Ve([c.rowIndex,c.colIndex,h[2],c.colIndex])),c.rowIndex<0||c.colIndex<0)return;this.parent.notify(z0,{fillType:Q(c.rowIndex,c.colIndex,i,!1,!0).formula?"FillSeries":"CopyCells",dAutoFillCell:d,rangeInfo:{direction:u,startCell:c,endCell:{rowIndex:h[2],colIndex:h[3]},fillRange:h}}),this.parent.notify(Ta,{type:"mousedown"}),this.parent.notify(Hs,null)}var p=i.isProtected&&mn(Q(s[0],s[1],i),Ht(i,s[1]));if(t.keyCode===70&&!e&&this.parent.allowFindAndReplace){t.preventDefault();var f=document.querySelector(".e-text-findNext-short");f?f.focus():this.parent.notify(Qc,{})}if((!p||!i.isProtected||t.keyCode===86)&&t.keyCode!==70&&!e){if(t.keyCode===71)t.preventDefault(),this.parent.notify(mD,null);else if(t.keyCode===72){t.preventDefault();var f=document.querySelector(".e-text-findNext");f?f.focus():this.parent.notify(w0,null)}else t.keyCode===88?this.parent.notify(iu,{promise:Promise}):t.keyCode===86&&this.parent.notify(fo,{isAction:!0});t.shiftKey&&t.keyCode===76&&!this.parent.isEdit&&!i.isProtected&&(t.preventDefault(),this.parent.notify(Yo,{}))}if(!e&&(!i.isProtected||i.protectSettings.formatCells))if(t.keyCode===66){t.preventDefault();var v=this.parent.getCellStyleValue(["fontWeight"],s).fontWeight;v=v==="bold"?"normal":"bold",this.parent.notify(ur,{style:{fontWeight:v},onActionUpdate:!0,refreshRibbon:!0})}else if(t.keyCode===73){t.preventDefault();var v=this.parent.getCellStyleValue(["fontStyle"],s).fontStyle;v=v==="italic"?"normal":"italic",this.parent.notify(ur,{style:{fontStyle:v},onActionUpdate:!0,refreshRibbon:!0})}else t.ctrlKey&&t.keyCode===85&&!t.shiftKey?(t.preventDefault(),this.parent.notify(Rd,{style:{textDecoration:"underline"},refreshRibbon:!0})):t.ctrlKey&&t.keyCode===53&&!t.shiftKey&&(t.preventDefault(),this.parent.notify(Rd,{style:{textDecoration:"line-through"},refreshRibbon:!0}))}if(t.keyCode===27&&this.parent.notify($d,null),((t.ctrlKey||t.metaKey)&&t.keyCode===119||t.keyCode===13&&r.classList.contains("e-drop-icon"))&&this.parent.showRibbon){t.preventDefault();var m=this.parent.element.querySelector(".e-drop-icon");m&&m.click()}if((t.ctrlKey||t.metaKey)&&!e){if(t.keyCode===57){if(!i.isProtected||i.protectSettings.formatRows){t.preventDefault();var s=ie(i.selectedRange);this.parent.notify(kn,{startIndex:s[0],endIndex:s[2],hide:!t.shiftKey,isCol:!1,actionUpdate:!0})}}else if(t.keyCode===48&&(!i.isProtected||i.protectSettings.formatColumns)){var s=ie(i.selectedRange);this.parent.notify(kn,{startIndex:s[1],endIndex:s[3],hide:!t.shiftKey,isCol:!0,actionUpdate:!0})}}if(t.shiftKey&&!e){if(t.keyCode===113&&!i.isProtected)t.preventDefault(),t.target.children.length>0&&typeof t.target.children[t.target.children.length-1].className=="string"&&t.target.children[t.target.children.length-1].className.indexOf("e-addNoteIndicator")>-1?this.parent.notify(p0,null):this.parent.notify(d0,null);else if(t.keyCode===114)t.preventDefault(),this.parent.notify(BD,null);else if(t.keyCode===116&&this.parent.allowFindAndReplace)t.preventDefault(),this.parent.notify(Qc,{});else if(t.keyCode===121){var y=document.activeElement.className;["e-spreadsheet","e-cell","e-header-cell","e-clipboard","e-rowhdr-table","e-selectall-table","e-main-panel"].some(function(E){return y.includes(E)})&&this.focusTarget(i)}}if(t.altKey&&!e&&((t.ctrlKey||t.metaKey)&&t.keyCode===78?(t.preventDefault(),this.parent.refresh(!0)):t.keyCode===113&&this.parent.saveUrl&&(t.preventDefault(),this.parent.notify(fg,null))),(t.ctrlKey||t.metaKey)&&t.shiftKey&&!e){if(!i.isProtected||i.protectSettings.formatCells){var b=i.selectedRange,S=void 0;if(t.keyCode===192)S="General";else if(t.keyCode===52)S=cr("CurrencyWithColorCode");else if(t.keyCode===53)S="0%";else if(t.keyCode===54)S=cr("Scientific");else if(t.keyCode===51)S="dd-mmm-yy";else if(t.keyCode===50)S="h:mm AM/PM";else if(t.keyCode===49)S=cr("Number");else if(t.keyCode===55){t.preventDefault();var C="1px solid #000000";this.parent.notify(ur,{style:{border:C},onActionUpdate:!0,borderType:"Outer"})}if(S){var x=Hi(this.parent,tt(ie(b)));if(!x){var I={format:S,range:b,cancel:!1,requestType:"NumberFormat"},D={range:i.name+"!"+I.range,format:I.format,requestType:"NumberFormat"};this.parent.trigger("beforeCellFormat",I),this.parent.notify(hi,{eventArgs:I,action:"format"}),I.cancel||(this.parent.notify(vg,I),this.parent.notify(Ta,{type:"mousedown"}),this.parent.notify(wt,{eventArgs:D,action:"format"}),this.parent.notify(Hs,null))}}}if(t.keyCode===85){t.preventDefault();var M=this.parent.element.querySelector(".e-formula-bar-panel .e-drop-icon");M&&M.click()}}t.keyCode===122&&t.shiftKey&&!t.ctrlKey&&!this.parent.isProtected&&this.parent.notify(Fa,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1}),t.shiftKey&&t.altKey&&t.keyCode===75&&this.parent.showSheetTabs&&this.parent.element.querySelector(".e-sheets-list").click()}},o.prototype.focusTarget=function(t){var e=tt(ie(t.selectedRange)),i=e[1]===0&&e[3]===t.colCount-1,r=e[0]===0&&e[2]===t.rowCount-1,n;if(i&&r)n=this.parent.element.querySelector(".e-selectall");else if(i){var s=this.parent.frozenRowCount(t);if(e[0]<s){var a=this.parent.getRow(e[0],this.parent.sheetModule.getSelectAllTable());n=a&&a.cells[0]}else{e[0]=ce(t,e[0],!0);var l=ce(t,ie(t.paneTopLeftCell)[0],!0),h=Fd(this.parent,l).index,c=void 0;e[0]>l&&e[0]<h?c=this.parent.getRow(e[0],this.parent.getRowHeaderTable()):e[0]>=h?c=this.parent.getRow(h-1,this.parent.getRowHeaderTable()):c=this.parent.getRow(l+1,this.parent.getRowHeaderTable()),n=c&&c.cells[0]}}else if(r){var u=this.parent.frozenColCount(t);if(e[1]<u){var a=this.parent.element.querySelector(".e-selectall-container .e-header-row");n=a&&this.parent.getCell(0,e[1],a)}else{e[1]=ce(t,e[1],!0,"columns");var d=ce(t,ie(t.paneTopLeftCell)[1],!0,"columns"),p=Tb(this.parent,d),c=this.parent.element.querySelector(".e-column-header .e-header-row");e[1]>d&&e[1]<p?n=c&&this.parent.getCell(0,e[1],c):e[1]>=p?n=c&&this.parent.getCell(0,p-1,c):n=c&&this.parent.getCell(0,d+1,c)}}else{var f=ie(t.paneTopLeftCell);n=this.parent.getCell(e[0],e[1]);var s=this.parent.frozenRowCount(t),u=this.parent.frozenColCount(t);if(e[0]<s&&e[1]<u)n=this.parent.getCell(e[0],e[1]);else if(e[0]<s){var d=ie(t.paneTopLeftCell)[1],p=Tb(this.parent,d);e[1]>d&&e[1]<p?n=this.parent.getCell(e[0],e[1]):e[1]>=p?n=this.parent.getCell(e[0],p-1):n=this.parent.getCell(e[0],d+1)}else if(e[1]<u){var l=ie(t.paneTopLeftCell)[0],h=Fd(this.parent,l).index;e[0]>l&&e[0]<h?n=this.parent.getCell(e[0],e[1]):e[0]>=h?n=this.parent.getCell(h-1,e[1]):n=this.parent.getCell(l+1,e[1])}else{var l=ie(t.paneTopLeftCell)[0],h=Fd(this.parent,l).index,d=ie(t.paneTopLeftCell)[1],p=Tb(this.parent,d);e[0]>l&&e[0]<h?e[1]>d&&e[1]<p?n=this.parent.getCell(e[0],e[1]):e[1]>=p?n=this.parent.getCell(e[0],p-1):n=this.parent.getCell(e[0],d+1):e[0]>=h?e[1]>d&&e[1]<p?n=this.parent.getCell(h-1,e[1]):e[1]>=p?n=this.parent.getCell(h-1,p-1):n=this.parent.getCell(h-1,d+1):e[1]>d&&e[1]<p?n=this.parent.getCell(l+1,e[1]):e[1]>=p?n=this.parent.getCell(l+1,p-1):n=this.parent.getCell(l+1,d+1)}n||(n=this.parent.getCell(f[0]+1,f[1]+1))}n&&Re(n)},o.prototype.getModuleName=function(){return"keyboardShortcut"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o})(),oE=(function(){function o(t){this.checkHeight=!1,this.parent=t,this.addEventListener()}return o.prototype.applyCellFormat=function(t){if(t.checkHeight){this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t.rowIdx,t.colIdx,t.lastCell,t.onActionUpdate,t.outsideViewport,t.rowHeight);return}var e=Object.keys(t.style),i=this.parent.getActiveSheet();if(!(t.lastCell&&!e.length&&qo(i,t.rowIdx)<=(i.standardHeight||20))){var r=t.td||this.parent.getCell(t.rowIdx,t.colIdx);if(r){var n=this.updateMergeBorder(t,i),s=void 0;if(t.formatColor&&r.style.color===t.formatColor&&(s=t.style.color,delete t.style.color),t.style.border!==void 0||t.style.borderTop!==void 0||t.style.borderLeft!==void 0){var a={};Object.keys(t.style).forEach(function(m){a[""+m]=t.style[""+m]}),a.border!==void 0&&(Object.assign(r.style,{borderRight:t.style.border,borderBottom:t.style.border}),this.setLeftBorder(t.style.border,r,t.rowIdx,t.colIdx,t.colIdx===this.parent.frozenColCount(i)?t.hRow:t.row,t.onActionUpdate,t.first,i,t.prevCell),this.setTopBorder(t.style.border,r,t.rowIdx,t.colIdx,t.pRow,t.pHRow,t.onActionUpdate,t.first,t.lastCell,t.manualUpdate,i,t),delete a.border),a.borderTop!==void 0&&(this.setTopBorder(t.style.borderTop,r,t.rowIdx,t.colIdx,t.pRow,t.pHRow,t.onActionUpdate,t.first,t.lastCell,t.manualUpdate,i,t),delete a.borderTop),a.borderLeft!==void 0&&(this.setLeftBorder(t.style.borderLeft,r,t.rowIdx,t.colIdx,t.colIdx===this.parent.frozenColCount(i)?t.hRow:t.row,t.onActionUpdate,t.first,i,t.prevCell),delete a.borderLeft),Object.keys(a).length&&(a.borderBottom!==void 0&&this.setThickBorderHeight(a.borderBottom,t.rowIdx,t.colIdx,r,t.row,t.hRow,t.onActionUpdate,t.lastCell,t.manualUpdate),Object.assign(r.style,a))}else{if(t.style.borderBottom!==void 0&&this.setThickBorderHeight(t.style.borderBottom,t.rowIdx,t.colIdx,r,t.row,t.hRow,t.onActionUpdate,t.lastCell,t.manualUpdate),Object.assign(r.style,t.style),r){var l=r.querySelector(".e-cf-databar");if(l){var h=l.querySelector(".e-databar-value");h&&(h.style.textDecoration=t.style.textDecoration,t.style.verticalAlign&&(h.style.alignItems=t.style.verticalAlign==="top"?"start":t.style.verticalAlign==="middle"?"center":"end"))}}var c=Q(t.rowIdx,t.colIdx,i);if(c&&(c.rowSpan||c.colSpan)&&r.offsetHeight>0){var u=cg(this.parent,c.style||this.parent.cellStyle);u>r.offsetHeight&&Na(this.parent,i,r.offsetHeight,t.rowIdx)}if(t.style.fontSize&&r){var d=r.querySelector(".e-validation-list");d&&this.parent.notify(Yd,{ddlCont:d,rowIdx:t.rowIdx,colIdx:t.colIdx,updatePosition:!0})}}var p=Q(t.rowIdx,t.colIdx,i,null,!0);if(!i.rows[t.rowIdx]||!i.rows[t.rowIdx].customHeight){if(t.isHeightCheckNeeded){if(t.manualUpdate)this.checkHeight||(this.checkHeight=Qd(t.style,t.onActionUpdate)),r&&r.children[0]&&r.children[0].className==="e-cf-databar"&&t.style.fontSize&&(r.children[0].querySelector(".e-databar-value").style.fontSize=t.style.fontSize),t.isFromAutoFillOption||this.updateRowHeight(t.rowIdx,t.colIdx,t.lastCell,t.onActionUpdate,null,t.rowHeight),p.wrap&&(t.style.fontSize||t.style.fontFamily)&&(r.style.lineHeight=parseFloat(p.style&&p.style.fontSize||this.parent.cellStyle.fontSize)*tE(p.style&&p.style.fontFamily?p.style:this.parent.cellStyle)+"pt");else if(!p.wrap&&Qd(t.style)&&Ph(i,t.rowIdx,t.colIdx,kd(this.parent,t.rowIdx,t.colIdx,i,t.style)),t.lastCell){var u=qo(i,t.rowIdx),f=i.standardHeight||20;u>f&&u>ei(i,t.rowIdx)&&Na(this.parent,i,u,t.rowIdx,t.row,t.hRow)}}}else if(!p.wrap&&(t.style.fontSize||t.style.fontFamily)){var v=ei(i,t.rowIdx,!0)-_0(t.rowIdx,t.colIdx,i);v<cg(this.parent,p.style)?r.style.lineHeight=v+"px":r.style.lineHeight&&(r.style.lineHeight="")}s!==void 0&&(t.style.color=s),t.onActionUpdate&&p.format&&p.format.includes("*")&&(t.style.fontFamily||t.style.fontSize||t.style.borderRight&&parseInt(t.style.borderRight,10)>1)&&this.parent.notify(yr,{value:p.value,format:p.format,cell:p,formattedText:p.value,rowIndex:t.rowIdx,colIndex:t.colIdx,td:r}),n.isColMerge&&t.style.borderRight&&delete t.style.borderRight,n.isRowMerge&&t.style.borderBottom&&delete t.style.borderBottom}else this.updateRowHeight(t.rowIdx,t.colIdx,!0,t.onActionUpdate,null,t.rowHeight)}},o.prototype.updateRowHeight=function(t,e,i,r,n,s){if(this.checkHeight){var a=this.parent.getActiveSheet(),l=Q(t,e,a,null,!0);if(!l.rowSpan){var h=0;h=kd(this.parent,t,e,a,l.style||this.parent.cellStyle,l.wrap&&!l.colSpan?jg(this.parent.getDisplayText(l),ip(a,t,e),l.style,this.parent.cellStyle):1);var c=l.value&&l.value.toString();if(c&&c.indexOf(`
`)>-1){var u=void 0,d=c.split(`
`),p=0,f=d.length;for(u=0;u<f;u++){var v=jg(d[u],ip(a,t,e,l.colSpan>1?e+l.colSpan-1:e),l.style,this.parent.cellStyle);v===0&&(v=1),p=p+v}h=kd(this.parent,t,e,a,l.style||this.parent.cellStyle,p)}var m=a&&a.standardHeight?a.standardHeight:20;if(h<m&&(h=m),Ph(a,t,e,h),!n){var y=this.parent.getCell(t,e);y&&y.children[0]&&y.children[0].className==="e-cf-databar"&&(y.children[0].style.height="100%",y.children[0].firstElementChild.nextElementSibling.style.height="100%")}if(i){this.checkHeight=!1;var b=s||qo(a,t),S=ei(a,t);(r?b!==S:b>S)&&Na(this.parent,a,b,t,null,null,!0,n)}}}},o.prototype.updateMergeBorder=function(t,e){var i,r,n=Q(t.rowIdx,t.colIdx,e,null,!0);if(n.rowSpan>1||n.colSpan>1){var s={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};if(this.parent.notify(pr,s),n.rowSpan>1){var a=Q(s.range[2],s.range[1],e,null,!0);a.style&&a.style.borderBottom&&(t.style.borderBottom=a.style.borderBottom,i=!0)}if(n.colSpan>1){var l=Q(s.range[0],s.range[3],e,null,!0);l.style&&l.style.borderRight&&(t.style.borderRight=l.style.borderRight,r=!0)}}return{isRowMerge:i,isColMerge:r}},o.prototype.setLeftBorder=function(t,e,i,r,n,s,a,l,h){var c=this,u=function(m,y,b){b===void 0&&(b=Q(i,y,l,null,!0)),s&&b.format&&b.format.includes("*")&&parseInt(t,10)>1&&c.parent.notify(yr,{value:b.value,format:b.format,cell:b,formattedText:b.value,rowIndex:i,colIndex:y,td:m})};if(!(a&&a.includes("Column"))){var d=this.parent.enableRtl,p=d?r+1:r-1;if(h||(h=this.parent.getCell(i,p,n)),h){var f=Q(i,p,l,!1,!0);if(f.rowSpan&&f.rowSpan!==1||f.colSpan&&f.colSpan!==1){var v={range:[i,p,i,p]};if(this.parent.notify(pr,v),f=Q(v.range[0],v.range[1],l,!1,!0),f.style&&f.style.borderRight&&f.style.borderRight!=="none")return;if(f=Q(v.range[0],v.range[3],l,null,!0),f.style&&f.style.borderRight&&f.style.borderRight!=="none")return;e.style.borderLeft=t,u(e,r)}else s&&t!==""&&r===this.parent.viewport.leftIndex&&(this.parent.getMainContent().scrollLeft-=this.getBorderSize(t)),h.style.borderRight=t==="none"?h.style.borderRight:t,u(h,p,f)}else(!d||this.parent.scrollSettings.isFinite&&r===l.colCount-1)&&(e.style.borderLeft=t,u(e,r))}},o.prototype.setTopBorder=function(t,e,i,r,n,s,a,l,h,c,u,d){if(!(l&&l.includes("Row"))){var p=r,f=Q(i,r,u,!1,!0);f.colSpan>1&&Ft(u,r)&&(p=ce(u,r,!0,"columns"),p>r+f.colSpan-1&&(p=r));var v=this.parent.getCell(i-1,p,n);if(v)if(f=Q(i-1,r,u,!1,!0),f.rowSpan&&f.rowSpan!==1||f.colSpan&&f.colSpan!==1){var m={range:[i-1,r,i-1,r]};if(this.parent.notify(pr,m),f=Q(m.range[0],m.range[1],u,!1,!0),f.style&&f.style.borderBottom&&f.style.borderBottom!=="none")return;if(f=Q(m.range[2],m.range[1],u,null,!0),f.style&&f.style.borderBottom&&f.style.borderBottom!=="none")return;e.style.borderTop=t,d.mergeBorderRows!==void 0&&d.mergeBorderRows.indexOf(i)===-1&&d.mergeBorderRows.push(i)}else{if(lt(u,i-1)){var y=[Number(v.parentElement.getAttribute("aria-rowindex"))-1,r];if(this.parent.getCellStyleValue(["bottomPriority"],y).bottomPriority)return}a&&t!==""&&u.topLeftCell.includes(""+(i+1))&&(this.parent.getMainContent().parentElement.scrollTop-=this.getBorderSize(t)),this.setThickBorderHeight(t,i-1,r,v,n,s,a,h,c),v.style.borderBottom=t==="none"?v.style.borderBottom:t}else e.style.borderTop=t}},o.prototype.setThickBorderHeight=function(t,e,i,r,n,s,a,l,h){var c=t?this.getBorderSize(t):1,u=this.parent.getActiveSheet();if(c>2&&(!u.rows[e]||!u.rows[e].customHeight))if(h)this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e,i,l,a);else{var d=ei(u,e),p=Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(["fontFamily","fontSize"],[e,i]),1,3));p>d&&Na(this.parent,u,p,e,n,s)}if(!u.rows[e]||!u.rows[e].customHeight)a&&(l||!this.checkHeight)&&c<3&&(this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e,i,l,a));else{var f=Q(e,i,u,null,!0);if(!f.wrap)if(c>1){var v=ei(u,e,!0)-_0(e,i,u);v<cg(this.parent,f.style)&&c>1?r.style.lineHeight=v+"px":r.style.lineHeight&&(r.style.lineHeight="")}else r.style.lineHeight&&(r.style.lineHeight="")}},o.prototype.getBorderSize=function(t){var e=t.split(" ")[0];return e==="thin"?1:e==="medium"?2:e==="thick"?3:parseInt(e,10)||1},o.prototype.clearObj=function(t){var e=this,i=t.options,r=i.range?i.range.indexOf("!")>0?i.range.substring(i.range.lastIndexOf("!")+1):i.range:this.parent.getActiveSheet().selectedRange,n=i.range&&i.range.indexOf("!")>0?Ct(this.parent,i.range.substring(0,i.range.lastIndexOf("!"))):this.parent.activeSheetIndex,s=tt(ie(r)),a=Hi(this.parent,s);if(a){t.isAction&&this.parent.notify(fr,null);return}var l=this.parent.sheets[n],h=s[0],c=s[2],u,d,p=this.parent.element.getElementsByClassName("e-ss-overlay-active"),f=p.length>0,v,m=this.parent.element.getElementsByClassName("e-prev-highlight-bottom").length>0,y={range:r,type:i.type,requestType:"clear",sheetIndex:n},b=function(){t.isAction&&e.parent.notify(hi,{action:"beforeClear",eventArgs:y})},S=function(){t.isAction&&(y={range:l.name+"!"+r,type:i.type,sheetIndex:n},v&&(y.cfClearActionArgs=v.cfClearActionArgs),e.parent.notify(wt,{eventArgs:y,action:"clear",isSelectAll:m}))},C=i.type==="Clear All";if(f)(i.type==="Clear Contents"||C)&&(b(),p[0].classList.contains("e-datavisualization-chart")?this.parent.notify(lu,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1,clearAction:!0}):this.parent.notify(La,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1,clearAction:!0}),S());else{if(b(),i.type==="Clear Formats"||C)for(v={range:r,sheetIdx:n,isClear:!0},this.parent.notify(po,v),t.cfClearActionArgs=v.cfClearActionArgs,C&&(this.parent.notify(Qo,{range:r,isRemoveValidation:!0}),h===0&&s[1]===0&&c>=l.usedRange.rowIndex&&s[3]>=l.usedRange.colIndex&&this.parent.setUsedRange(h,s[1],l,!1,!0)),h;h<=c;h++)for(u=s[1],d=s[3],u;u<=d;u++){var x=Q(h,u,l),I=this.parent.getCell(h,u);x&&(C&&x.formula&&this.parent.notify($c,{cellRef:Ve([h,u,h,u])}),x.wrap&&this.parent.notify(sa,{range:[h,u,h,u],wrap:!1,sheet:l}),x.hyperlink&&(I&&Z(I.querySelectorAll(".e-hyperlink"),"e-hyperlink-style"),C&&this.parent.removeHyperlink(l.name+"!"+Ve([h,u,h,u]))))}i.type==="Clear Hyperlinks"&&this.parent.removeHyperlink(l.name+"!"+r),this.parent.notify(Hd,{range:l.name+"!"+r,type:i.type,isAction:t.isAction===!0||t.isFromUpdateAction===!1}),this.parent.serviceLocator.getService("cell").refreshRange(tt(ie(r)),!1,!1,!1,i.type==="Clear Hyperlinks",xs(this.parent),!C,null,!0,null,m),t.isFromUpdateAction||this.parent.notify(tu,{address:r}),this.parent.notify(vo,null),S()}},o.prototype.addEventListener=function(){this.parent.on(Mr,this.applyCellFormat,this),this.parent.on(Pg,this.clearObj,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Mr,this.applyCellFormat),this.parent.off(Pg,this.clearObj))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.checkHeight=null},o.prototype.getModuleName=function(){return"cellformat"},o})(),B9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Ln,this.wireEvents,this),this.parent.on(hD,this.autoFit,this),this.parent.on(pD,this.setAutoFitHandler,this),this.parent.on(jD,this.propertyChange,this)},o.prototype.autoFit=function(t){for(var e=t.isRow?this.parent.getRowHeaderTable():this.parent.getColHeaderTable().rows[0],i=t.startIndex;i<=t.endIndex;i++)this.trgtEle=t.isRow?this.parent.getRow(i,e):this.parent.getCell(null,i,e),this.setAutofit(i,!t.isRow)},o.prototype.wireEvents=function(){var t=this.parent.getRowHeaderContent(),e=this.parent.element.getElementsByClassName("e-header-panel")[0];e&&(T.add(e,"dblclick",this.dblClickHandler,this),T.add(t,"dblclick",this.dblClickHandler,this),T.add(e,"mousedown",this.mouseDownHandler,this),T.add(t,"mousedown",this.mouseDownHandler,this),this.wireResizeCursorEvent(t,e))},o.prototype.wireResizeCursorEvent=function(t,e){T.add(t,"mousemove",this.setTarget,this),T.add(e,"mousemove",this.setTarget,this)},o.prototype.unWireResizeCursorEvent=function(){T.remove(this.parent.getRowHeaderContent(),"mousemove",this.setTarget);var t=this.parent.element.getElementsByClassName("e-header-panel")[0];t&&T.remove(t,"mousemove",this.setTarget)},o.prototype.unwireEvents=function(){var t=this.parent.getRowHeaderContent(),e=this.parent.element.getElementsByClassName("e-header-panel")[0];e&&(T.remove(e,"dblclick",this.dblClickHandler),T.remove(t,"dblclick",this.dblClickHandler),T.remove(e,"mousedown",this.mouseDownHandler),T.remove(t,"mousedown",this.mouseDownHandler),this.unWireResizeCursorEvent())},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ln,this.wireEvents),this.parent.off(hD,this.autoFit),this.parent.off(pD,this.setAutoFitHandler),this.parent.off(jD,this.propertyChange))},o.prototype.mouseMoveHandler=function(t){var e=this.parent.element.getElementsByClassName("e-colresize-handler")[0],i=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(this.resizeTooltip(null,!0,t),e||i){this.isMouseMoved=!0;var r=this.parent.enableRtl;e?(r?t.x<this.trgtEle.parentElement.firstChild.getBoundingClientRect().right:t.x>this.trgtEle.parentElement.firstChild.getBoundingClientRect().left)&&(e.style.left=t.clientX-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().left+"px"):i&&t.y>=this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top&&(i.style.top=t.clientY-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().top+"px")}},o.prototype.mouseDownHandler=function(t){if(!(!H(t.target,".e-header-cell")||t.target.className.includes("e-filter-icon"))){if(this.event=t,this.trgtEle=t.target,this.trgtEle.parentElement.classList.contains("e-hide-end")||this.trgtEle.classList.contains("e-hide-end")){var e=this.trgtEle.offsetHeight,i=t.offsetY;(e>=10&&i<5||e-2<8&&i<Math.ceil((i-2)/2))&&this.trgtEle.classList.add("e-skip-resize")}this.updateTarget(t,this.trgtEle);var r=this.trgtEle,n=r.classList.contains("e-colresize")?"e-colresize-handler":r.classList.contains("e-rowresize")?"e-rowresize-handler":"";this.createResizeHandler(r,n),this.unWireResizeCursorEvent(),T.add(this.parent.element,"mousemove",this.mouseMoveHandler,this),T.add(document,"mouseup",this.mouseUpHandler,this)}},o.prototype.mouseUpHandler=function(t){var e=this.parent.element.getElementsByClassName("e-resize-handle")[0];this.resizeOn(t),this.isMouseMoved=null;var i=document.querySelector(".e-header-tooltip");e&&(se(e),this.updateCursor()),i&&i.remove(),T.remove(document,"mouseup",this.mouseUpHandler),T.remove(this.parent.element,"mousemove",this.mouseMoveHandler);var r=this.parent.element.getElementsByClassName("e-header-panel")[0];r&&this.wireResizeCursorEvent(this.parent.getRowHeaderContent(),r),this.parent.notify(Oa,null),this.parent.notify(O0,null)},o.prototype.dblClickHandler=function(t){if(!(!H(t.target,".e-header-cell")||t.target.className.includes("e-filter-icon"))){this.trgtEle=t.target;var e=this.updateTarget(t,this.trgtEle);if(e){this.parent.notify(fr,null);return}if(this.trgtEle.classList.contains("e-colresize")){var i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1,r=qr(this.parent.getActiveSheet(),i)+"px";this.trgtEle.classList.contains("e-unhide-column")?this.showHiddenColumns(i-1):this.setAutofit(i,!0,r,this.trgtEle)}else if(this.trgtEle.classList.contains("e-rowresize")){var n=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,s=ei(this.parent.getActiveSheet(),n)+"px";this.setAutofit(n,!1,s)}this.parent.notify(Oa,null)}},o.prototype.setTarget=function(t){if(!(this.parent.isEdit||!H(t.target,".e-header-cell")||t.target.className.includes("e-filter-icon"))){var e=t.target,i=this.parent.getActiveSheet();if(!(i.isProtected&&(!i.protectSettings.formatColumns||!i.protectSettings.formatRows)&&(!i.protectSettings.formatRows&&!i.protectSettings.formatColumns||i.protectSettings.formatRows&&H(e,".e-colhdr-table")||i.protectSettings.formatColumns&&H(e,".e-rowhdr-table")))){var r,n,s,a;if(H(e,".e-header-row")){n=e.offsetWidth,a="e-colresize",s=this.parent.enableRtl?n-t.offsetX:t.offsetX;var l=this.getColPrevSibling(e);l&&!l.classList.contains("e-select-all-cell")?r=l:Number(e.getAttribute("aria-colindex"))>1&&(r=e)}else if(H(e,".e-row")){s=t.offsetY,n=e.offsetHeight,a="e-rowresize";var l=this.getRowPrevSibling(e);l?r=l.firstElementChild:Number(e.parentElement.getAttribute("aria-rowindex"))>1&&(r=e)}if(n-2<8&&s!==Math.ceil((n-2)/2))s<Math.ceil((n-2)/2)?(e.classList.add(a),r&&r.classList.add(a)):s>Math.ceil((n-2)/2)&&e.classList.add(a);else if(n-5<s&&s<=n&&n>=10)e.classList.add(a);else if(s<5&&r&&n>=10)e.classList.add(a),r.classList.add(a);else for(var h=this.parent.element.getElementsByClassName(a),c=0;c<h.length;c++)h[c].classList.remove(a)}}},o.prototype.getColPrevSibling=function(t){var e=this.parent.frozenColCount(this.parent.getActiveSheet());return t.previousElementSibling||(e&&H(t,".e-column-header")?this.parent.getSelectAllContent().querySelector(".e-header-row").lastElementChild:null)},o.prototype.getRowPrevSibling=function(t){var e=this.parent.frozenRowCount(this.parent.getActiveSheet());return t.parentElement.previousElementSibling||(e&&H(t,".e-row-header")?this.parent.getSelectAllContent().querySelector("tbody").lastElementChild:null)},o.prototype.updateTarget=function(t,e){if(H(e,".e-header-row")){var i=this.parent.enableRtl?e.offsetWidth-t.offsetX:t.offsetX;if(e.offsetWidth<10&&i<Math.ceil((e.offsetWidth-2)/2)||i<5&&e.offsetWidth>=10&&e.classList.contains("e-colresize")){var r=this.parent.getActiveSheet(),n=Number(this.trgtEle.getAttribute("aria-colindex"))-2,s=this.getColPrevSibling(e);if(s&&!Ft(r,n))this.trgtEle=s;else if(n>-1){var a=Ht(r,n);if(a.isReadOnly||Hi(this.parent,[0,n,r.rowCount-1,n]))return!0;this.trgtEle.classList.add("e-unhide-column")}}}else if(e.offsetHeight<10&&t.offsetY<Math.ceil((e.offsetHeight-2)/2)||t.offsetY<5&&e.offsetHeight>=10&&e.classList.contains("e-rowresize")){var r=this.parent.getActiveSheet(),n=Number(e.parentElement.getAttribute("aria-rowindex"))-2,s=this.getRowPrevSibling(e);if(s||lt(r,n))if(t.type==="dblclick"&&lt(r,n)){var l=Yr(r,n);if(l.isReadOnly||Hi(this.parent,[n,0,n,r.colCount-1]))return!0;var h=tt(ie(r.selectedRange)),c=void 0;n<=h[2]&&n>h[0]&&KD(r,h)?c={startIndex:h[0],endIndex:h[2],hide:!1,autoFit:!0}:c={startIndex:n,endIndex:n,hide:!1,autoFit:!0},this.parent.notify(kn,c)}else lt(r,n)||(this.trgtEle=s.getElementsByClassName("e-header-cell")[0])}return!1},o.prototype.setAutoFitHandler=function(t){t.isCol&&Ft(this.parent.getActiveSheet(),t.idx)?this.showHiddenColumns(t.idx):this.setAutofit(t.idx,t.isCol,null,null,t.sheetIdx)},o.prototype.getWrapText=function(t,e,i){var r=this,n=t.toString().split(" "),s=dr(" ",i,this.parent.cellStyle),a,l=0,h=0,c=t,u="",d=function(){var p=parseInt(h.toString(),10);(p>l||p===l&&dr(u.trim(),i,r.parent.cellStyle)>dr(c,i,r.parent.cellStyle))&&(c=u.trim(),l=p)};return n.forEach(function(p,f){a=dr(p,i,r.parent.cellStyle),(h+a)/e>1?(d(),u="",h=a):(a+=(h+a+s)/e>=1?0:s,h+=a),u+=p+" ",f===n.length-1&&d()}),c},o.prototype.setAutofit=function(t,e,i,r,n){var s=this,a=g(n)?this.parent.getActiveSheet():ke(this.parent,n),l,h=g(n)?!0:n===this.parent.activeSheetIndex;if(r){var c={cancel:!1,index:t,isCol:e,sheetIndex:this.parent.activeSheetIndex};if(e?(c.oldWidth=i,c.autoFitWithHeader=!1):c.oldHeight=i,this.parent.notify(hi,{eventArgs:c,action:"resizeToFit"}),c.cancel)return;l=c.autoFitWithHeader}var u,d={},p,f,v,m=this.parent.createElement("table",{className:this.parent.getContentTable().className+" e-resizetable",styles:"height: auto"}),y=this.parent.createElement("tbody"),b=this.parent.createElement("tr",{className:"e-row"}),S=this.parent.createElement("td",{className:"e-cell"}),C=0,x=0;if(e){var I;m.style.width="auto";var D=function(z){p=S.cloneNode(),p.textContent=z,p.style.fontFamily=d.style&&d.style.fontFamily||s.parent.cellStyle.fontFamily,p.style.fontSize=d.style&&d.style.fontSize||s.parent.cellStyle.fontSize,p.style.fontWeight=d.style&&d.style.fontWeight||s.parent.cellStyle.fontWeight,I=b.cloneNode(),I.appendChild(p),y.appendChild(I)};l&&D(r.textContent);for(var M=0,E=a.rows.length;M<E;M++)d=Q(M,t,a),d&&d.value&&(d.wrap?(v=!0,D(this.getWrapText(this.parent.getDisplayText(d),ip(a,t,t,d.colSpan>1?t+d.colSpan-1:t),d.style))):D(this.parent.getDisplayText(d)));u=qr(a,t)}else{var A=a.rows[t]&&a.rows[t].cells?a.rows[t].cells.length:0;f=this.parent.createElement("colgroup");for(var L=0;L<A;L++)d=Q(t,L,a),d&&(p=S.cloneNode(),d.wrap&&p.classList.add("e-wraptext"),p.textContent=this.parent.getDisplayText(d),p.style.fontFamily=d.style&&d.style.fontFamily||this.parent.cellStyle.fontFamily,p.style.fontSize=d.style&&d.style.fontSize||this.parent.cellStyle.fontSize,b.appendChild(p),x=d.colSpan&&d.colSpan>=1?this.getMergedColumnsWidth(d.colSpan,L,a):d.colSpan&&d.colSpan<1?0:qr(a,L,!1,!0),C+=x,f.appendChild(this.parent.createElement("col",{styles:"width:"+x+"px"})));m.appendChild(f),y.appendChild(b),u=ei(a,t)}m.appendChild(y),C&&(m.style.width=C+"px");var N=this.parent.createElement("div",{className:this.parent.element.className,styles:"display: block"});N.appendChild(m),document.body.appendChild(N);var R=m.getBoundingClientRect();document.body.removeChild(N);var P=Math.ceil(e?R.width:R.height),k=(e?this.getFloatingElementWidth(P+(v?1:0),t):P)||u,B;if(e){k>0?B=-(u-k):B=-u;var F=this.parent.frozenColCount(a);F&&t>=ie(a.topLeftCell)[1]&&t<F||t>=this.parent.viewport.leftIndex+F&&t<=this.parent.viewport.rightIndex?(Ht(a,t).width=k>0?k:0,h&&(this.resizeStart(t,this.parent.getViewportIndex(t,!0),k+"px",e,!0,i),this.parent.notify(Qn,{threshold:B,colIdx:t}))):(h&&this.parent.notify(Qn,{threshold:B,colIdx:t}),Ht(a,t).width=k>0?k:0)}else{var O=this.parent.frozenRowCount(a);k=k>20?k:20,B=-(u-k),O&&t>=ie(a.topLeftCell)[0]&&t<O||t>=this.parent.viewport.topIndex+O&&t<=this.parent.viewport.bottomIndex?(H0(a,t,k),Cs(a,t,{customHeight:!1}),h&&(this.resizeStart(t,this.parent.getViewportIndex(t),k+"px",e,!0,i),this.parent.notify(Fn,{threshold:B,rowIdx:t}))):(h&&this.parent.notify(Fn,{threshold:B,rowIdx:t}),H0(a,t,k))}h&&this.parent.selectRange(a.selectedRange)},o.prototype.getMergedColumnsWidth=function(t,e,i){for(var r=0,n=0;n<t;n++)r+=qr(i,e,!1,!0),e++;return r},o.prototype.createResizeHandler=function(t,e){var i=this.parent.createElement("div",{className:e});i.classList.add("e-resize-handle");var r=document.getElementById(this.parent.element.id+"_sheet"),n=this.parent.getActiveSheet();t.classList.contains("e-colresize")?(i.style.height=this.parent.getMainContent().parentElement.clientHeight+this.parent.getColumnHeaderContent().offsetHeight+"px",i.style.left=this.event.clientX-r.getBoundingClientRect().left+"px",i.style.top="0px"):t.classList.contains("e-rowresize")&&(i.style.width=this.parent.getMainContent().parentElement.clientWidth+"px",i.style.left="0px",i.style.top=this.event.clientY-r.getBoundingClientRect().top+"px"),(n.frozenRows||n.frozenColumns)&&this.hasZIndex()&&(i.style.zIndex="3"),r.appendChild(i),this.resizeTooltip(t,!1),this.updateCursor()},o.prototype.resizeTooltip=function(t,e,i){var r=this.parent.enableRtl;if(e){var n=document.querySelector(".e-header-tooltip"),s=this.parent.element.getElementsByClassName("e-colresize-handler")[0],a=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(s){var l=r?Math.round(this.trgtEle.getBoundingClientRect().right)-i.clientX:i.clientX-Math.round(this.trgtEle.getBoundingClientRect().left);n&&(n.firstChild.textContent=l>0?"Width:("+l.toString()+" pixels)":"Width: 0.00")}else if(a){var h=i.clientY-Math.round(this.trgtEle.getBoundingClientRect().top);n&&(n.firstChild.textContent=h>0?"Height:("+h.toString()+" pixels)":"Height: 0.00")}}else{var c=t.classList.contains("e-colresize"),u=t.classList.contains("e-rowresize");if(c||u){var d=c?"e-colresize-handler":"e-rowresize-handler",p=new uh({cssClass:"e-header-tooltip",showTipPointer:!1});c?p.content=fa(function(){return"Width:("+Math.round(t.getBoundingClientRect().width).toString()+" pixels)"}):u&&(p.content=fa(function(){return"Height:("+Math.round(t.getBoundingClientRect().height).toString()+" pixels)"}),p.offsetX=(r?1:-1)*(this.parent.getMainContent().parentElement.clientWidth/2-Math.round(t.getBoundingClientRect().width))),p.appendTo("."+d),p.open(),p.refresh()}}},o.prototype.setColWidth=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=zr(i)-r;if(s<0&&r<-s&&(s=-r),i>0){if(this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")){this.showHiddenColumns(t,i),this.parent.notify(wt,{eventArgs:{index:t,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!1},action:"resize"});return}this.resizeStart(t,e,i+"px",!0,!1,r+"px"),Hl(n,t,{width:i,customWidth:!0}),this.parent.notify(Qn,{threshold:s,colIdx:t,checkWrapCell:!0});var a=this.parent.frozenColCount(n);if(a&&t>=a&&this.hasZIndex()){var l=this.parent.getSelectAllContent(),h=this.parent.getRowHeaderContent();(l||l.querySelectorAll("col.e-empty")[e])&&(h||h.querySelectorAll("col.e-empty")[e])&&this.parent.serviceLocator.getService("sheet").setPanelWidth(n,h)}}else this.isMouseMoved&&(this.parent.hideColumn(t),this.showHideCopyIndicator(),this.parent.notify(wt,{eventArgs:{index:t,width:"0px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!0},action:"resize"}))},o.prototype.hasZIndex=function(){var t=this;return["e-row-header","e-selectall-container","e-column-header"].some(function(e){var i=t.parent.element.getElementsByClassName(e)[0];return i&&!!i.style.zIndex})},o.prototype.showHideCopyIndicator=function(){var t=this.parent.element.getElementsByClassName("e-copy-indicator")[0],e=!1;t&&(se(t),this.parent.notify(zh,null),e=!0),e&&this.parent.notify(Ln,{})},o.prototype.showHiddenColumns=function(t,e){var i=this,r=this.parent.getActiveSheet(),n=ie(r.selectedRange),s,a,l;if(t>=n[1]&&t<=n[3]&&n[2]===r.rowCount-1&&xe(r.activeCell)[0]===xe(r.topLeftCell)[0]?(s=n[1],a=n[3],l=this.parent.getMainContent().querySelector("colgroup")):s=a=t,e!==void 0)for(var h=s;h<=a;h++)Hl(r,h,{width:e,customWidth:!0}),h>=this.parent.viewport.leftIndex&&h<=this.parent.viewport.rightIndex&&!Ft(r,h)&&(l.children[this.parent.getViewportIndex(h,!0)].style.width=e+"px");this.trgtEle&&this.trgtEle.classList.remove("e-unhide-column");var c={startIndex:s,endIndex:a,hide:!1,isCol:!0,autoFit:!0};if(this.parent.notify(kn,c),this.showHideCopyIndicator(),e===void 0)if(c.autoFit)this.autoFit({isRow:!1,startIndex:s,endIndex:a});else{var u=function(){i.parent.off(Ln,u),i.autoFit({isRow:!1,startIndex:s,endIndex:a})};this.parent.on(Ln,u,this)}},o.prototype.setRowHeight=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=this.parent.frozenColCount(n),a=parseInt(this.parent.getRow(t,null,s).style.height,10),l=i,h=zr(parseInt(l,10))-a;h<0&&a<-h&&(h=-a);var c;n.rows[t]&&n.rows[t].customHeight&&(c=!0),this.resizeStart(t,e,l,!1,!1,r,c),Cs(n,t,{height:parseInt(l,10)>0?parseInt(l,10):0,customHeight:!0}),this.parent.notify(Fn,{threshold:h,rowIdx:t,isCustomHgt:!0})},o.prototype.resizeOn=function(t){var e=this,i,r,n=this.parent.getActiveSheet(),s=ie(n.activeCell),a=Q(s[0],s[1],n);if(this.trgtEle.classList.contains("e-rowresize")){var l=Number(this.trgtEle.parentElement.getAttribute("aria-rowindex"))-2;if(this.isMouseMoved&&lt(n,l)&&this.trgtEle.classList.contains("e-skip-resize")&&t.clientY>this.trgtEle.getBoundingClientRect().top){this.trgtEle.classList.remove("e-skip-resize");var h={startIndex:l,endIndex:l,hide:!1,skipAppend:!0};this.parent.notify(kn,h);var c=this.parent.getRowHeaderTable().tBodies[0],u=this.parent.getContentTable().tBodies[0];h.hdrRow.style.display="none",h.row.style.display="none",c.insertBefore(h.hdrRow,c.children[h.insertIdx]),u.insertBefore(h.row,u.children[h.insertIdx]),this.trgtEle=h.hdrRow.firstElementChild,h.hdrRow.nextElementSibling.classList.remove("e-hide-end"),h.mergeCollection.forEach(function(x){e.parent.notify(Nn,x)})}else if(this.trgtEle.classList.contains("e-skip-resize")){if(this.trgtEle.classList.remove("e-skip-resize"),!this.isMouseMoved&&lt(n,l)||!this.trgtEle.parentElement.previousElementSibling)return;this.trgtEle=this.trgtEle.parentElement.previousElementSibling.getElementsByClassName("e-header-cell")[0]}r=i=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,i=this.parent.getViewportIndex(r);var d=this.parent.frozenColCount(n),p=this.parent.getRow(r,null,d).style.height,f=t.clientY-this.event.clientY+parseInt(p,10);if(f<=0){this.parent.hideRow(r),this.showHideCopyIndicator(),Cs(n,r,{height:0,customHeight:!0}),this.parent.notify(wt,{eventArgs:{index:r,height:"0px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"});return}if(this.setRowHeight(r,i,f+"px",p),this.parent.notify(u0,{rowIndex:r}),this.trgtEle.parentElement.style.display==="none"){var v=this.parent.getActiveSheet(),m=tt(ie(v.selectedRange));if(r<=m[2]&&r>m[0]){f=ei(v,r);for(var y=void 0,b=m[0];b<=m[2];b++)b!==r&&(p=ei(v,b)+"px",Cs(v,b,{customHeight:!0,height:f}),lt(v,b)?y||(y=b):(this.parent.getRow(b).style.height=f+"px",v.showHeaders&&(this.parent.getRow(b,this.parent.getRowHeaderTable()).style.height=f+"px")),this.parent.notify(wt,{eventArgs:{index:b,height:f+"px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:p},action:"resize"}));this.parent.hideRow(m[0],r-1,!1),this.showHideCopyIndicator(),i+=Math.abs(r-y)}else i!==0&&!lt(v,r-1)?this.trgtEle.parentElement.previousElementSibling.classList.remove("e-hide-start"):i!==0&&this.trgtEle.parentElement.classList.add("e-hide-end"),this.parent.selectRange(v.selectedRange);this.trgtEle.parentElement.style.display="",this.parent.getContentTable().rows[i].style.display=""}}else if(this.trgtEle.classList.contains("e-colresize")){this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")&&t.clientX<this.trgtEle.getBoundingClientRect().left&&(this.trgtEle.classList.remove("e-unhide-column"),this.trgtEle.previousElementSibling&&(this.trgtEle=this.trgtEle.previousElementSibling)),i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1;var S=void 0;this.trgtEle.classList.contains("e-unhide-column")?(i-=1,S=0):S=qr(this.parent.getActiveSheet(),i),this.setColWidth(i,this.parent.getViewportIndex(i,!0),(this.parent.enableRtl?this.event.clientX-t.clientX:t.clientX-this.event.clientX)+S,S);var C=this.parent.frozenRowCount(n);C>0&&this.reapplyFormats(n,i,xe(n.topLeftCell)[0],C-1),this.reapplyFormats(n,i,this.parent.viewport.topIndex+C,this.parent.viewport.bottomIndex)}},o.prototype.reapplyFormats=function(t,e,i,r){for(i;i<=r;i++){var n=Q(i,e,t,!1,!0);n.format&&n.format.includes("*")&&this.parent.notify(yr,{value:n.value,format:n.format,cell:n,formattedText:n.value,rowIndex:i,colIndex:e})}},o.prototype.resizeStart=function(t,e,i,r,n,s,a){qD(t,e,i,r,this.parent);var l=n?"resizeToFit":"resize",h,c;r?(h={index:t,width:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldWidth:s},c=s!==i):(h={index:t,height:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldHeight:s,isPrevCustomHeight:a},c=s!==i),c&&this.parent.notify(wt,{eventArgs:h,action:l})},o.prototype.updateCursor=function(){this.parent.element.getElementsByClassName("e-colresize-handler")[0]?this.parent.element.classList.add("e-col-resizing"):this.parent.element.classList.contains("e-col-resizing")&&this.parent.element.classList.remove("e-col-resizing"),this.parent.element.getElementsByClassName("e-rowresize-handler")[0]?this.parent.element.classList.add("e-row-resizing"):this.parent.element.classList.contains("e-row-resizing")&&this.parent.element.classList.remove("e-row-resizing")},o.prototype.getFloatingElementWidth=function(t,e){var i=t,r={filterRange:[],hasFilter:!1};return this.parent.notify(ou,r),r.hasFilter&&r.filterRange&&r.filterRange[1]<=e&&r.filterRange[3]>=e&&(i=t+22),i},o.prototype.destroy=function(){this.unwireEvents(),this.removeEventListener(),this.trgtEle&&this.trgtEle.remove(),this.trgtEle=null,this.event=null,this.parent=null},o.prototype.getModuleName=function(){return"resize"},o.prototype.propertyChange=function(t){t.propertyName==="allowResizing"&&this.wireEvents()},o})(),j9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.hideShow=function(t){var e=this,i=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=ke(this.parent,i);if(t.startIndex>t.endIndex){var n=t.startIndex;t.startIndex=t.endIndex,t.endIndex=n}if(t.actionUpdate!==void 0){var s=t.isCol?[0,t.startIndex,r.rowCount-1,t.endIndex]:[t.startIndex,0,t.endIndex,r.colCount-1];if(Hi(this.parent,s)){t.actionUpdate&&this.parent.notify(fr,null);return}}var a;if(t.actionUpdate){if(t.sheetIndex=i,a={eventArgs:t,action:"hideShow"},this.parent.notify(hi,a),t.cancel)return;delete t.cancel}t.hide&&(t.hiddenIndexes=[]);var l=function(d){t.isCol?(e.hideCol(t),d&&e.parent.sheetModule.colWidthChanged({colIdx:t.startIndex,isHideShow:!0})):(e.hideRow(t),d&&e.parent.sheetModule.rowHeightChanged({rowIdx:t.startIndex,isHideShow:!0}))},h=t.isCol?this.parent.frozenColCount(r):this.parent.frozenRowCount(r);if(h&&t.startIndex<h){var c=void 0;if(t.freezePane=!0,t.endIndex>=h&&(c=t.endIndex,t.endIndex=h-1),l(!0),delete t.freezePane,c!==void 0){var u=t.startIndex;t.endIndex=c,t.startIndex=h,l(!this.parent.scrollSettings.enableVirtualization),t.startIndex=u}}else l(!this.parent.scrollSettings.enableVirtualization);t.actionUpdate&&(this.updateIndexOnlyForHiddenColumnsAndRows(t,r),this.parent.notify(wt,a),Re(this.parent.element))},o.prototype.updateIndexOnlyForHiddenColumnsAndRows=function(t,e){for(var i=t.startIndex,r=t.endIndex,n,s=t.startIndex;s<=r;s++)if(n=t.isCol?Ht(e,s):Yr(e,s)||{},n.hidden===!1){t.startIndex=s;break}for(var a=t.endIndex;a>=i;a--)if(n=t.isCol?Ht(e,a):Yr(e,a)||{},n.hidden===!1){t.endIndex=a;break}},o.prototype.hideRow=function(t){var e=this,i=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=ke(this.parent,i),n,s=0,a,l,h,c,u=Object.assign({},t),d=this.parent.scrollSettings.isFinite&&!u.freezePane,p;if(d){if(u.startIndex>=r.rowCount)return;u.endIndex>=r.rowCount&&(u.endIndex=r.rowCount-1),p=0}var f=this.parent.frozenRowCount(r);if(u.hide){for(var v=void 0,m,y=void 0,b=[],S=[],C=d&&u.endIndex===ce(r,r.rowCount-1,!1),x=u.startIndex;x<=u.endIndex;x++){if(lt(r,x)){u.isFiltering&&!as(r,x)&&Cs(r,x,{isFiltered:!0});continue}if(a===void 0&&(u.freezePane?(m=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(m=this.parent.getRowHeaderTable(),v=this.parent.getContentTable()),a=this.parent.getViewportIndex(x),s=0),c={hidden:!0},u.isFiltering&&(c.isFiltered=!0),u.isFiltering||(b=Nh(this.parent)),Cs(r,x,c),u.isFiltering||(S=Nh(this.parent)),i===this.parent.activeSheetIndex)if(d&&(p+=ei(r,x,!0,!0)),this.refreshChart(x,"rows"),u.isFiltering||this.refreshChartCellModel(b,S),y=v&&v.rows[a],y){if(!h){for(var I=0;I<=r.usedRange.colIndex;I++)if(n=Q(x,I,r)||{},(n.colSpan||n.rowSpan)&&(u.startIndex>=this.parent.viewport.topIndex||this.parent.scrollSettings.enableVirtualization)){h=!0;break}}if(h)continue;if(m.rows[a]&&se(m.rows[a]),se(y),s++,y=v.rows[a],y&&x===u.endIndex){var D=void 0;l=ce(r,x+1,!0);for(var M=l!==ce(r,0,!0)&&l===(this.parent.viewport.topIndex>=u.startIndex?u.endIndex+1:this.parent.viewport.topIndex)?"Row":"",I=this.parent.viewport.leftIndex;I<=this.parent.viewport.rightIndex;I++){var E=this.parent.getCellStyleValue(["borderTop"],[l,I]).borderTop;E!==""&&(D=y.cells[I],this.parent.notify(Mr,{onActionUpdate:!1,rowIdx:l,colIdx:I,style:{borderTop:E},row:y,pRow:y.previousElementSibling,first:M,td:D}))}}}else x<=this.parent.viewport.bottomIndex?s++:s&&s--}if(u.refreshUI)return;if(h&&(u.startIndex>=this.parent.viewport.topIndex||!this.parent.scrollSettings.enableVirtualization)){u.isFiltering?t.refreshUI=!0:(this.parent.selectRange(r.selectedRange),r.frozenRows||r.frozenColumns?(this.parent.renderModule.refreshSheet(!1,!1,!0),t.refreshUI=!0):this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:this.parent.viewport.leftIndex,refresh:"Row"}));return}if(!s)return;this.parent.selectRange(r.selectedRange);var A=function(){if(r.showHeaders){var Ke=u.freezePane?1:0;a===Ke?m.rows[Ke]&&m.rows[Ke].classList.add("e-hide-end"):(m&&m.rows[a-1]&&m.rows[a-1].classList.add("e-hide-start"),m&&m.rows[a]&&m.rows[a].classList.add("e-hide-end"))}};if(!u.freezePane&&this.parent.scrollSettings.enableVirtualization){var L=u.startIndex,N=u.startIndex;if(u.startIndex<xe(r.paneTopLeftCell)[0]||s>this.parent.viewport.rowCount){if(u.isFiltering){t.refreshUI=!0;return}this.parent.updateTopLeftCell(ce(r,u.startIndex-1<f?f:u.startIndex-1,!0)-f,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0)}else{L=this.parent.viewport.bottomIndex+1,N=L+s-1;var R=this.parent.skipHidden(L,N,"rows",!1);if(L=R[0],N=R[1],d)if(L>=r.rowCount){this.parent.viewport.topIndex+f===ce(r,f,!0)?(A(),this.parent.notify(qc,{isHide:!0,height:p}),C&&(this.parent.viewport.bottomIndex=ce(r,r.rowCount-1,!1))):this.parent.renderModule.refreshSheet(!1,!1,!0);return}else if(N>=r.rowCount){this.parent.renderModule.refreshSheet(!1,!1,!0);return}else this.parent.notify(qc,{isHide:!0,height:p});this.parent.viewport.bottomIndex=N;var P=void 0,k=this.parent.frozenColCount(r),B=[];k?(B.push(f),B.push(this.parent.viewport.leftIndex+k),P=xe(r.topLeftCell)[1]):P=this.parent.viewport.leftIndex,this.parent.renderModule.refreshUI({colIndex:P,rowIndex:L,direction:"",refresh:"RowPart",frozenIndexes:B},st(L,P)+":"+st(N,this.parent.viewport.rightIndex))}}A()}else{var F=void 0,O=void 0,z=void 0,y=void 0,Y=void 0,K=void 0,v=void 0,U=void 0,q=void 0,ae=u.startIndex-1,te=[],he=u.freezePane,ue="lastElementChild",ne=0,le=this.parent.viewport.topIndex+f;if(d){var $=ce(r,r.rowCount-1,!1);if(this.parent.viewport.bottomIndex===$)if(le===ce(r,f,!0))he=!0;else{var ee=ie(r.paneTopLeftCell)[0],He=r.rowCount-1-ee+1-this.parent.hiddenCount(ee,r.rowCount-1);He<this.parent.viewport.rowCount+Math.round(this.parent.getThreshold("row")/2)&&(ue="firstElementChild")}}for(var b=Nh(this.parent),x=u.startIndex,qe=u.endIndex;x<=qe;x++){if(!(u.isFiltering?lt(r,x):lt(r,x)&&!as(r,x))){if(u.startIndex===u.endIndex)return;a===void 0?ae++:Y=x;continue}if(Y!==void 0){qe=x;continue}if(c={hidden:!1},u.isFiltering&&(c.isFiltered=!1),!he&&x>this.parent.viewport.bottomIndex){Cs(r,x,c);continue}if(q===void 0&&(q=x),Cs(r,x,c),i===this.parent.activeSheetIndex){d&&(p+=ei(r,x,!0,!0)),this.refreshChart(x,"rows"),a===void 0&&(F=document.createDocumentFragment(),O=document.createDocumentFragment(),K=this.parent.serviceLocator.getService("row"),u.freezePane?(U=this.parent.sheetModule.getSelectAllTable(),v=this.parent.getColHeaderTable()):(U=this.parent.getRowHeaderTable(),v=this.parent.getContentTable(),x<this.parent.viewport.topIndex+f&&(this.parent.viewport.topIndex=x-f)),a=this.parent.getViewportIndex(x)),ae++,z=K.refresh(x,null,null,!0,!0),F.appendChild(z),U&&U.rows.length&&!he&&se(U.tBodies[0][""+ue]),y=O.appendChild(K.refresh(x,y,z)),v&&v.rows.length&&!he&&(se(v.tBodies[0][""+ue]),ue==="firstElementChild"&&(a!==void 0&&a-1>-1&&(a-=1),ne+=ei(r,this.parent.viewport.topIndex,!0),this.parent.viewport.topIndex=ce(r,this.parent.viewport.topIndex+1,!0)));for(var I=this.parent.viewport.leftIndex;I<=this.parent.viewport.rightIndex;I++)if(n=Q(x,I,r)||{},n.rowSpan!==void 0||n.colSpan!==void 0){var we={range:[x,I,x,I],isAction:!1,merge:!0,type:"All",skipChecking:!0};this.parent.notify(pr,we),(!te.length||we.range[1]!==te[te.length-1].range[1]||we.range[0]!==te[te.length-1].range[0])&&te.push(we)}}}var S=Nh(this.parent);if(this.refreshChartCellModel(b,S),a===void 0)return;var je=void 0;if(!u.freezePane){if(u.isFiltering&&u.startIndex<xe(r.paneTopLeftCell)[0]&&(t.refreshUI=!0,Y===void 0||Y===u.endIndex))return;var Ne=this.parent.viewport.bottomIndex;this.parent.viewport.bottomIndex=this.parent.viewport.topIndex+f+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2;var Ye=this.parent.hiddenCount(u.endIndex+1,this.parent.viewport.bottomIndex);s=this.parent.hiddenCount(this.parent.viewport.topIndex+f,u.startIndex)+Ye,this.parent.viewport.bottomIndex+=s,d&&this.parent.viewport.bottomIndex>=r.rowCount&&(this.parent.viewport.bottomIndex=ce(r,r.rowCount-1,!1)),!u.isFiltering&&q>=le&&q<=Ne&&q>this.parent.viewport.bottomIndex-Ye-Math.abs(ae-q)&&(je=!0)}if(u.insertIdx=t.insertIdx=a,u.row=t.row=O.querySelector(".e-row"),u.mergeCollection=t.mergeCollection=te,r.showHeaders&&(t.hdrRow=u.hdrRow=F.querySelector(".e-row"),a!==0&&!lt(r,ae-1)&&U.rows[a-1]&&U.rows[a-1].classList.remove("e-hide-start"),u.startIndex!==0&&lt(r,u.startIndex-1)&&u.hdrRow.classList.add("e-hide-end"),lt(r,ae+1)?F.lastElementChild.classList.add("e-hide-start"):U.rows[a]&&U.rows[a].classList.remove("e-hide-end")),y&&v&&v.rows[a]){l=ce(r,ae+1,!0);for(var x=this.parent.viewport.leftIndex;x<=this.parent.viewport.rightIndex;x++){var E=this.parent.getCellStyleValue(["borderTop"],[l,x]).borderTop;if(E!==""){this.parent.notify(Mr,{onActionUpdate:!1,rowIdx:l,colIdx:x,style:{borderTop:E},pRow:y,td:v.rows[a].cells[x],first:""});var dt=ce(r,q-1,!1);dt>-1?v.rows[a-1]&&!this.parent.getCellStyleValue(["borderBottom"],[dt,x]).borderBottom&&!this.parent.getCellStyleValue(["borderTop"],[q,x]).borderTop&&(v.rows[a-1].cells[x].style.borderBottom=""):v.rows[a].cells[x].style.borderTop=""}}}if(u.skipAppend)return;d&&this.parent.notify(qc,{height:p,size:ne}),je||Math.abs(ae-q)>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2?this.parent.renderModule.refreshSheet(!1,!1,!0):(U&&(U.tBodies[0].rows.length?U.tBodies[0].insertBefore(F,U.rows[a]):U.tBodies[0].appendChild(F)),v&&v.tBodies[0]&&(v.tBodies[0].rows.length?v.tBodies[0].insertBefore(O,v.rows[a]):v.tBodies[0].appendChild(O)),this.parent.selectRange(r.selectedRange),u.autoFit&&r.showHeaders&&this.parent.notify(hD,{startIndex:u.startIndex,endIndex:u.endIndex,isRow:!0}),te.forEach(function(bi){e.parent.notify(Nn,bi)}),Y!==void 0&&Y!==u.endIndex&&(u.startIndex=Y,this.hideRow(u)))}},o.prototype.hideCol=function(t){for(var e=this,i=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=ke(this.parent,i),n=[],s=[],a=xe(r.paneTopLeftCell),l=this.parent.frozenColCount(r),h=this.parent.frozenRowCount(r),c=this.parent.viewport.leftIndex+l,u,d=ce(r,r.colCount-1,!1,"columns"),p=t.startIndex;p<=t.endIndex;p++){if(t.hide){if(Ft(r,p))continue}else if(!Ft(r,p)||t.hiddenIndexes&&t.hiddenIndexes.indexOf(p)===-1)continue;var f=Nh(this.parent);Hl(r,p,{hidden:t.hide});var v=Nh(this.parent);if(this.refreshChart(p,"columns"),this.refreshChartCellModel(f,v),this.parent.scrollSettings.enableVirtualization&&!t.freezePane&&(p<c||p>this.parent.viewport.rightIndex&&(!this.parent.scrollSettings.isFinite||!(d===this.parent.viewport.rightIndex&&p>=d&&p<r.colCount)))){p<c&&s.push(p);continue}n.push(p),t.hide&&(t.hiddenIndexes.push(p),p<=a[1]&&(u=!0))}if(!(!s.length&&!n.length)&&i===this.parent.activeSheetIndex){var m=xe(r.topLeftCell),y,b,S=function(){var R;return e.parent.scrollSettings.enableVirtualization?R=[h?m[0]:e.parent.viewport.topIndex,e.parent.viewport.bottomIndex]:R=[0,r.rowCount-1],t.freezePane?(y=e.parent.getRowHeaderTable(),b=e.parent.sheetModule.getSelectAllTable()):(y=e.parent.getContentTable(),b=e.parent.getColHeaderTable()),R};if(t.hide){if(!n.length)return;if((n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||t.freezePane)&&this.removeCell(r,n,S(),y,b),!t.freezePane&&this.parent.scrollSettings.enableVirtualization){if(u){this.parent.updateTopLeftCell(null,ce(r,n[0]-1<l?l:n[0]-1,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);return}var C=[],x=this.parent.viewport.topIndex,I=h?m[0]:x;if(h&&(C=[h+x,l]),this.parent.scrollSettings.isFinite){var D=ce(r,r.colCount-1,!1,"columns"),M=this.parent.viewport.leftIndex+l,E=this.parent.viewport.rightIndex;if(E+n.length>=D){var A=ce(r,M-(E+n.length-D),!1,"columns");A>=l&&(this.parent.viewport.leftIndex=A,this.parent.viewport.leftIndex-=this.parent.hiddenCount(E,D)),this.parent.viewport.rightIndex=D,M!==this.parent.viewport.leftIndex+l||E!==this.parent.viewport.rightIndex?(this.parent.renderModule.refreshUI({colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:C,rowIndex:I,skipUpdateOnFirst:this.parent.viewport.leftIndex+l===ce(r,l,!0,"columns")}),h&&(this.parent.viewport.topIndex=x)):this.parent.notify(TD,{refresh:"Column",isUpdate:!0}),this.parent.selectRange(r.selectedRange);return}}if(n.length<=this.parent.getThreshold("col")){var L=this.parent.skipHidden(this.parent.viewport.rightIndex+1,this.parent.viewport.rightIndex+n.length,"columns");this.parent.viewport.rightIndex=L[1],this.parent.renderModule.refreshUI({rowIndex:I,colIndex:L[0],direction:"",refresh:"ColumnPart",frozenIndexes:C},""+Ve([I,L[0],this.parent.viewport.bottomIndex,L[1]]))}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+l===ce(r,l,!0,"columns"),rowIndex:I,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:C}),h&&(this.parent.viewport.topIndex=x)}this.parent.selectRange(r.selectedRange)}else{if(s.length&&this.parent.scrollSettings.enableVirtualization){s.sort(function(R,P){return R-P});var N=s[0]-1<l?l:s[0]-1;this.parent.updateTopLeftCell(null,ce(r,N,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0),t.autoFit&&(t.autoFit=!1);return}(!this.parent.scrollSettings.isFinite||this.parent.viewport.rightIndex<d)&&(n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||t.freezePane)?(this.appendCell(r,n,S(),y,b,t.freezePane),this.parent.scrollSettings.enableVirtualization&&!t.freezePane&&this.parent.notify(co,{refresh:"Column",prevRowColCnt:{rowCount:r.rowCount,colCount:r.colCount}}),this.parent.selectRange(r.selectedRange)):this.parent.renderModule.refreshSheet(!1,!1,!0)}}},o.prototype.removeCell=function(t,e,i,r,n){var s=this,a=i[0],l=i[1],h=0,c=e.length-1,u=this.parent.frozenRowCount(t),d=r.getElementsByTagName("colgroup")[0],p=this.parent.getViewportIndex(e[0],!0)+1,f=ce(t,u-1,!1),v,m,y,b,S;for(t.showHeaders&&(y=n.getElementsByTagName("colgroup")[0],v=n.rows[0]);a<=l;){if(lt(t,a)){a++;continue}m=u&&a<u?n.rows[h+1]:r.rows[h],m&&e.forEach(function(C,x){if(h===0&&a>=u&&(t.showHeaders&&(se(y.children[p]),se(v.cells[p])),se(d.children[p])),se(m.cells[p]),x===0&&(b=Q(a,C,t,!1,!0),(b.colSpan!==void 0&&(b.rowSpan===void 0||b.colSpan>1)||b.rowSpan<0&&a-1>-1&&lt(t,a-1)&&Math.abs(b.rowSpan)===s.parent.hiddenCount(a+b.rowSpan,a,"rows",t))&&s.parent.notify(M0,{rowIdx:a,colIdx:C,model:"col",start:e[0],end:e[c]})),x===c){S=ce(t,C+1,!0,"columns");var I=s.parent.getCellStyleValue(["borderLeft"],[h,S]).borderLeft;I!==""&&s.parent.notify(Mr,{onActionUpdate:!1,rowIdx:h,colIdx:S,style:{borderLeft:I},row:m,first:""}),b=Q(a,C,t)||{},(b.colSpan!==void 0&&(b.rowSpan===void 0||b.colSpan>1)||b.rowSpan<0&&a-1>-1&&lt(t,a-1)&&Math.abs(b.rowSpan)===s.parent.hiddenCount(a+b.rowSpan,a,"rows",t))&&s.parent.notify(M0,{rowIdx:a,colIdx:C,model:"col",start:e[0],end:e[c],isEnd:!0})}}),u&&a===f?(h=0,a=this.parent.viewport.topIndex+u):(h++,a++)}p-1>-1&&t.showHeaders&&v.cells[p-1]&&v.cells[p-1].classList.add("e-hide-start"),t.showHeaders&&v.cells[p]&&v.cells[p].classList.add("e-hide-end")},o.prototype.appendCell=function(t,e,i,r,n,s){var a=this,l=i[0],h=i[1],c=0,u=e.length-1,d,p,f,v,m=this.parent.frozenRowCount(t),y=r.getElementsByTagName("colgroup")[0];t.showHeaders&&(f=n.getElementsByTagName("colgroup")[0],d=n.rows[0]);var b=this.parent.serviceLocator.getService("cell");e.sort(function(A,L){return A-L});for(var S=[],C=[],x,I,D,M=ce(t,m-1,!1),E;l<=h;){if(lt(t,l)){l++;continue}p=m&&l<m?n.rows[c+1]:r.rows[c],p&&e.forEach(function(A,L){if(c===0&&(C[L]=a.parent.getViewportIndex(A,!0),t.showHeaders&&(I=d.cells[C[L]],I&&(L===0&&e[L]&&!Ft(t,e[L]-1)&&I.previousSibling&&I.previousElementSibling.classList.remove("e-hide-start"),L===u&&I.classList.remove("e-hide-end"))),l>=m&&(y.children[C[L]]?(y.insertBefore(a.parent.sheetModule.updateCol(t,A),y.children[C[L]]),t.showHeaders&&b.renderColHeader(A,d,I)):(y.appendChild(a.parent.sheetModule.updateCol(t,A)),t.showHeaders&&b.renderColHeader(A,d)),s||(se(y.lastChild),t.showHeaders&&se(d.lastChild)),t.showHeaders&&L===u&&(se(f),n.insertBefore(y.cloneNode(!0),n.tHead)))),s||se(p.lastChild),I=p.cells[C[L]],E={rowIdx:l,colIdx:A,cell:Q(l,A,t),row:p,address:st(l,A),lastCell:A===u,isHeightCheckNeeded:!0,first:A!==ce(t,0,!0,"columns")&&A===a.parent.viewport.leftIndex?"Column":"",checkNextBorder:L===u?"Column":"",checkCF:!0},I&&(E.refChild=I),x=b.render(E),L===0&&x.previousSibling){var N=a.parent.getCellStyleValue(["borderLeft"],[c,ce(t,e[e.length-1]+1,!0,"columns")]).borderLeft;N!==""&&(v=ce(t,e[0]-1,!1,"columns"),v>-1&&!a.parent.getCellStyleValue(["borderRight"],[c,v]).borderRight&&!a.parent.getCellStyleValue(["borderLeft"],[c,e[0]]).borderLeft&&(x.previousSibling.style.borderRight=""))}if(D=Q(l,A,t)||{},D.colSpan!==void 0&&(D.rowSpan===void 0||D.colSpan>1)||D.rowSpan<0&&l-1>-1&&lt(t,l-1)&&Math.abs(D.rowSpan)===a.parent.hiddenCount(l+D.rowSpan,l,"rows",t)){var R={range:[l,A,l,A],isAction:!1,merge:!0,type:"All",skipChecking:!0};a.parent.notify(pr,R),(!S.length||R.range[1]!==S[S.length-1].range[1]||R.range[0]!==S[S.length-1].range[0])&&S.push(R)}}),m&&l===M?(l=this.parent.viewport.topIndex+m,c=0):(l++,c++)}S.forEach(function(A){a.parent.notify(Nn,A)}),this.parent.viewport.rightIndex=ce(t,this.parent.viewport.rightIndex-e.length,!1,"columns")},o.prototype.refreshChart=function(t,e){this.parent.notify(Xo,{rIdx:t,showHide:e})},o.prototype.refreshChartCellModel=function(t,e){this.parent.notify(A0,{prevChartIndexes:t,currentChartIndexes:e})},o.prototype.addEventListener=function(){this.parent.on(kn,this.hideShow,this),this.parent.on(Xn,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(kn,this.hideShow),this.parent.off(Xn,this.destroy)},o})(),H9=(function(){function o(t){this.divElements=[],this.inputElements=[],this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Lg,this.initiateHyperlinkHandler,this),this.parent.on(Ng,this.editHyperlinkHandler,this),this.parent.on(cD,this.openHyperlinkHandler,this),this.parent.on(Jc,this.hyperlinkClickHandler,this),this.parent.on(f0,this.createHyperlinkEle,this),this.parent.on(Ds,this.keyUpHandler,this),this.parent.on(Mb,this.removeHyperlink,this),this.parent.on(Fg,this.removeHyperlinkHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Lg,this.initiateHyperlinkHandler),this.parent.off(Ng,this.editHyperlinkHandler),this.parent.off(cD,this.openHyperlinkHandler),this.parent.off(Jc,this.hyperlinkClickHandler),this.parent.off(f0,this.createHyperlinkEle),this.parent.off(Ds,this.keyUpHandler),this.parent.off(Mb,this.removeHyperlink),this.parent.off(Fg,this.removeHyperlinkHandler))},o.prototype.getModuleName=function(){return"spreadsheetHyperlink"},o.prototype.keyUpHandler=function(t){var e=t.target;if(H(e,".e-document")){var i=document.querySelector(".e-hyp-text"),r=this.parent.element.querySelector(".e-hyperlink-alert-span"),n=H(e,".e-hyperlink-dlg")||H(e,".e-edithyperlink-dlg"),s=n.getElementsByClassName("e-footer-content")[0],a=s.firstChild;i&&!g(i.value)&&(Or(i.value.toUpperCase())?r&&(r.remove(),a.removeAttribute("disabled")):(this.showDialog(),a.setAttribute("disabled","true")))}if(e.classList.contains("e-text")&&H(e,".e-cont")&&H(e,".e-webpage")&&H(e,".e-webpage").getElementsByClassName("e-cont")[1]===e.parentElement){var l=H(e,".e-hyperlink-dlg")||H(e,".e-edithyperlink-dlg"),h=l.getElementsByClassName("e-footer-content")[0],a=h.firstChild;if(e.value!=="")a.removeAttribute("disabled");else{var c=H(e,".e-link-dialog"),u=c.querySelector(".e-webpage"),d=!!u.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;d||a.setAttribute("disabled","true")}}},o.prototype.initiateHyperlinkHandler=function(){var t=this,e=this.parent.getActiveSheet();if(e.isProtected&&(!e.protectSettings.insertLink||Ko(this.parent))){this.parent.notify(Ra,null);return}if(Hi(this.parent)){this.parent.notify(fr,null);return}var i=this.parent.serviceLocator.getService(ve);if(!this.parent.element.querySelector(".e-hyperlink-dlg")){var r=this.parent.serviceLocator.getService(jt),n;r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-hyperlink-dlg",enableRtl:this.parent.enableRtl,header:i.getConstant("InsertLink"),beforeOpen:function(s){var a={dialogName:"InsertLinkDialog",element:s.element,target:s.target,cancel:s.cancel};if(t.parent.trigger("dialogBeforeOpen",a),a.cancel){s.cancel=!0;return}r.dialogInstance.content=t.hyperlinkContent(),n=r.dialogInstance.content.querySelector(".e-text").value,r.dialogInstance.dataBind(),Re(t.parent.element)},open:function(){setTimeout(function(){Re(r.dialogInstance.element.querySelectorAll(".e-webpage input")[1])})},beforeClose:this.dialogBeforeClose.bind(this),buttons:[{buttonModel:{content:i.getConstant("Insert"),isPrimary:!0,disabled:!0},click:function(){t.dlgClickHandler(n),r.hide()}}]})}},o.prototype.dialogBeforeClose=function(){var t=this.headerTabs;t&&t.element&&(t.destroy(),t.element.remove()),this.headerTabs=null,ws(this.inputElements),this.inputElements=[],ws(this.divElements),this.divElements=[]},o.prototype.dlgClickHandler=function(t){var e,i,r=this.parent.getActiveSheet(),n=r.name+"!"+r.selectedRange,s=this.parent.element.querySelector(".e-link-dialog").getElementsByClassName("e-content")[0].querySelector(".e-item.e-active");if(s)if(e=s.getElementsByClassName("e-cont")[0].querySelector(".e-text").value,e===t&&(e=null),s.querySelector(".e-webpage")){i=s.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var a={address:i};e===i&&(e=null),this.parent.insertHyperlink(a,n,e,!1)}else{i=s.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var l=s.getElementsByClassName("e-cont")[2];if(l.getElementsByClassName("e-list-item")[0].querySelector(".e-active")){var h=s.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent;i=h+"!"+i.toUpperCase();var a={address:i};this.parent.insertHyperlink(a,n,e,!1)}else if(l.querySelector(".e-active")){for(var c=s.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent,u=0;u<this.parent.definedNames.length;u++)if(this.parent.definedNames[u].name===c){var a={address:this.parent.definedNames[u].name};this.parent.insertHyperlink(a,n,e,!1)}}}},o.prototype.showDialog=function(){this.parent.element.querySelector(".e-hyperlink-alert-span")&&this.parent.element.querySelector(".e-hyperlink-alert-span").remove();var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("span",{className:"e-hyperlink-alert-span"});e.innerText=t.getConstant("HyperlinkAlert");var i=this.parent.element.querySelector(".e-hyperlink-dlg")||this.parent.element.querySelector(".e-edithyperlink-dlg");i.querySelector(".e-dlg-content").appendChild(e)},o.prototype.editHyperlinkHandler=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService(jt),r;i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-edithyperlink-dlg",enableRtl:this.parent.enableRtl,header:e.getConstant("EditLink"),beforeOpen:function(n){var s={dialogName:"EditLinkDialog",element:n.element,target:n.target,cancel:n.cancel};if(t.parent.trigger("dialogBeforeOpen",s),s.cancel){n.cancel=!0;return}i.dialogInstance.content=t.hyperEditContent(),r=i.dialogInstance.content.querySelector(".e-text").value,i.dialogInstance.dataBind(),Re(t.parent.element)},open:function(){setTimeout(function(){i.dialogInstance.element.querySelector(".e-webpage")?Re(i.dialogInstance.element.querySelectorAll(".e-webpage input")[1]):Re(i.dialogInstance.element.querySelectorAll(".e-document input")[1])})},buttons:[{buttonModel:{content:e.getConstant("Update"),isPrimary:!0},click:function(){t.dlgClickHandler(r),i.hide()}}]})},o.prototype.openHyperlinkHandler=function(){var t=xe(this.parent.getActiveSheet().activeCell),e=this.parent.getCell(t[0],t[1]);e.getElementsByClassName("e-hyperlink")[0]&&(e=e.querySelector(".e-hyperlink")),this.hlOpenHandler(e)},o.prototype.hlOpenHandler=function(t,e,i){var r=this;if(t.classList.contains("e-hyperlink")){var n=H(t,".e-cell");if(!n)return;var s=["",""],a=void 0,l=!0,h=this.parent.getActiveSheet(),c=parseInt(n.getAttribute("aria-colindex"),10)-1,u=parseInt(n.parentElement.getAttribute("aria-rowindex"),10)-1,d=Q(u,c,h,!1,!0);d.style&&d.style.color==="#00e"&&(gr(this.parent,h,{rowIdx:u,colIdx:c,preventEvt:!0,cell:{style:{color:"#551a8b"}}}),n.style.color="#551a8b");var p=d.hyperlink,f=void 0,v={hyperlink:p,address:h.activeCell,target:"_blank",cancel:!1};if(this.parent.trigger(RY,v),v.cancel){i&&i.preventDefault();return}p=v.hyperlink;var m={hyperlink:p,address:h.activeCell};typeof p=="string"&&(f=p),typeof p=="object"&&(f=p.address);var y=f;if(f.indexOf("http://")===-1&&f.indexOf("https://")===-1&&f.indexOf("ftp://")===-1){if(!g(f)){if(this.parent.definedNames){for(var b=0;b<this.parent.definedNames.length;b++)if(this.parent.definedNames[b].name===f){f=this.parent.definedNames[b].refersTo,f=f.slice(1);break}}f.lastIndexOf("!")!==-1?(s[0]=f.substring(0,f.lastIndexOf("!")),s[0].startsWith("'")&&s[0].endsWith("'")&&(s[0]=s[0].slice(1,s[0].length-1)),s[1]=f.substring(f.lastIndexOf("!")+1)):(s[0]=this.parent.getActiveSheet().name,s[1]=f);for(var S,b=0;b<this.parent.sheets.length;b++)this.parent.sheets[b].name===s[0]&&(S=b);if(h=this.parent.sheets[S],s[1].indexOf(":")!==-1){var C=s[1].indexOf(":"),x=s[1].substr(0,C),I=s[1].substr(C+1,s[1].length);x=x.replace("$",""),I=I.replace("$",""),I.match(/\D/g)&&!I.match(/[0-9]/g)&&x.match(/\D/g)&&!x.match(/[0-9]/g)?(x=x+"1",I=I+h.rowCount,s[1]=x+":"+I):!I.match(/\D/g)&&I.match(/[0-9]/g)&&!x.match(/\D/g)&&x.match(/[0-9]/g)&&(a=[parseInt(x,10)-1,0,parseInt(I,10)-1,h.colCount-1],l=!1)}var D=void 0,M=this.parent.definedNames;if(!g(M)){for(var b=0;b<M.length;b++)if(M[b].name===y){D=!0;break}}if(Or(s[1])||D){if(a=l?ie(s[1]):a,!g(h)){var E=Ve(a);if(h===this.parent.getActiveSheet())er(function(){r.parent.goTo(E)});else{if(E.indexOf(":")>=0){var A=E.split(":");E=A[0]===A[1]?A[0]:E}er(function(){r.parent.goTo(r.parent.sheets[S].name+"!"+E)})}}}else this.showInvalidHyperlinkDialog()}}else e||(rP(f)?window.open(f,v.target):this.showInvalidHyperlinkDialog());this.parent.trigger(OY,m)}},o.prototype.showInvalidHyperlinkDialog=function(){var t=this.parent.serviceLocator.getService(jt),e=this.parent.serviceLocator.getService(ve);t.show({width:323,isModal:!0,showCloseIcon:!0,header:e.getConstant("Hyperlink"),content:e.getConstant("InvalidHyperlinkAlert"),buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){t.hide()}}]},!1)},o.prototype.hyperlinkClickHandler=function(t){if(this.parent.isEdit){var e={action:"getCurrentEditValue",editedValue:""};if(this.parent.notify(ui,e),pt(e.editedValue,!0))return}var i=t.target;if(H(i,".e-link-dialog")&&H(i,".e-toolbar-item")){var r=H(i,".e-hyperlink-dlg")||H(i,".e-edithyperlink-dlg"),n=r.getElementsByClassName("e-footer-content")[0],s=n.firstChild,a=r.querySelector(".e-document"),l=r.querySelector(".e-webpage"),h=l?l.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value,c=a?a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:h,u=H(i,".e-toolbar-items");if(u.getElementsByClassName("e-toolbar-item")[1].classList.contains("e-active")){var d=a.querySelectorAll(".e-cont")[2].querySelector(".e-active");a.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=h,H(d,".e-list-item").classList.contains("e-level-2")&&s.hasAttribute("disabled")?s.removeAttribute("disabled"):H(d,".e-list-item").classList.contains("e-level-1")&&!s.hasAttribute("disabled")&&s.setAttribute("disabled","true")}else{var p=!l.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;l.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=c,p&&!s.hasAttribute("disabled")?s.setAttribute("disabled","true"):!p&&s.hasAttribute("disabled")&&s.removeAttribute("disabled")}}if(H(i,".e-list-item")&&i.classList.contains("e-fullrow")){var f=this.parent.element.getElementsByClassName("e-link-dialog")[0];if(f)f=f.getElementsByClassName("e-content")[0].getElementsByClassName("e-active")[0];else return;var v=f.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0],r=H(i,".e-hyperlink-dlg")||H(i,".e-edithyperlink-dlg"),n=r.getElementsByClassName("e-footer-content")[0],s=n.firstChild;H(i,".e-list-item").classList.contains("e-level-2")?H(i,".e-list-item").getAttribute("data-uid")==="defName"?(!v.classList.contains("e-disabled")&&!v.hasAttribute("readonly")&&(v.setAttribute("readonly","true"),v.classList.add("e-disabled"),v.setAttribute("disabled","true")),s.hasAttribute("disabled")&&s.removeAttribute("disabled")):H(i,".e-list-item").getAttribute("data-uid")==="sheet"&&(v.classList.contains("e-disabled")&&v.hasAttribute("readonly")&&(v.removeAttribute("readonly"),v.classList.remove("e-disabled"),v.removeAttribute("disabled")),Or(v.value.toUpperCase())&&s.hasAttribute("disabled")&&s.removeAttribute("disabled")):H(i,".e-list-item").classList.contains("e-level-1")&&s.setAttribute("disabled","true")}else this.hlOpenHandler(i,!0,t)},o.prototype.createHyperlinkEle=function(t){var e=t.cell;if(!g(e.hyperlink)){var i=t.td,r=this.parent.createElement("a",{className:"e-hyperlink e-hyperlink-style"}),n=void 0;if(typeof e.hyperlink=="string"?(e.hyperlink.toLowerCase().indexOf("www.")===0&&(e.hyperlink="http://"+e.hyperlink),n=e.hyperlink):(n=e.hyperlink.address,n.toLowerCase().indexOf("www.")===0&&(e.hyperlink.address=n="http://"+n)),n.indexOf("http://")===0||n.indexOf("https://")===0||n.indexOf("ftp://")===0?(r.setAttribute("href",n),r.setAttribute("target","_blank")):(n.includes("=")||n.includes("!"))&&r.setAttribute("ref",n),e.format&&e.format.includes("*")?r.innerHTML=i.innerHTML:r.innerText=i.innerText!==""?i.innerText:n,i.textContent="",i.innerText="",(this.parent.autoFillSettings.fillType==="FillWithoutFormatting"||t.fillType==="FillWithoutFormatting"||t.action==="Clear Formats")&&(r.style.textDecoration="none"),i.appendChild(r),!t.style.color||!t.style.textDecoration){var s={};t.style.color||(t.style.color=s.color="#00e"),t.style.textDecoration||(t.style.textDecoration=s.textDecoration="underline"),gr(this.parent,this.parent.getActiveSheet(),{rowIdx:t.rowIdx,colIdx:t.colIdx,preventEvt:!0,cell:{style:s}})}}},o.prototype.hyperEditContent=function(){var t=!0,e=this.hyperlinkContent(),i=ie(this.parent.getActiveSheet().activeCell),r=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[i[0]].cells[i[1]];this.parent.scrollSettings.enableVirtualization&&(i[0]=i[0]-this.parent.viewport.topIndex,i[1]=i[1]-this.parent.viewport.leftIndex);var n=this.parent.getDisplayText(r),s,a=r.hyperlink;typeof a=="string"?(s=a,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(t=!1)):typeof a=="object"&&(s=a.address,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(t=!1));for(var l=0,h=0,c=this.parent.definedNames,u=this.parent.sheets,d=0,p=c.length;d<p;d++)c[d].name===s&&l++;for(var d=0,p=u.length;d<p;d++)s.includes(u[d].name)&&h++;l===0&&h===0&&(t=!0);var f=e.querySelector(".e-content");if(t){var v=f.querySelector(".e-webpage"),m=v.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0],y=v.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0];m.setAttribute("value",n),typeof a=="string"?y.setAttribute("value",a):y.setAttribute("value",a.address),r.hyperlink&&(!r.value||r.value!==0)&&y.addEventListener("input",function(){m.value=y.value})}else{var b=void 0,S=f.querySelector(".e-document");S.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n);var C=void 0,x=void 0;if(this.parent.definedNames){for(var d=0;d<this.parent.definedNames.length;d++)if(this.parent.definedNames[d].name===s){b=!0;break}}if(b){var I=S.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0];I.setAttribute("readonly","true"),I.classList.add("e-disabled"),I.setAttribute("disabled","true");for(var D=S.getElementsByClassName("e-cont")[2],M=D.querySelectorAll(".e-list-item.e-level-1")[1],d=0;d<M.getElementsByTagName("li").length;d++)M.getElementsByTagName("li")[d].innerText===s&&M.getElementsByTagName("li")[d].classList.add("e-active")}else{if(s&&s.lastIndexOf("!")!==-1){var E=s.lastIndexOf("!");C=s.substring(0,E),x=s.substring(E+1)}S.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",x);for(var D=S.getElementsByClassName("e-cont")[2],M=D.querySelectorAll(".e-list-item.e-level-1")[0],d=0;d<M.getElementsByTagName("li").length;d++)if(M.getElementsByTagName("li")[d].innerText===C){if(M.getElementsByTagName("li")[d].classList.contains("e-active"))break;M.getElementsByTagName("li")[d].classList.add("e-active")}else M.getElementsByTagName("li")[d].classList.contains("e-active")&&M.getElementsByTagName("li")[d].classList.remove("e-active")}}return e},o.prototype.hyperlinkContent=function(){var t=this.parent.serviceLocator.getService(ve),e=0,i=0,r=!0,n,s=!0,a,l=ie(this.parent.getActiveSheet().activeCell),h=this.parent.getActiveSheet(),c=Q(l[0],l[1],h),u=!0,d=this.parent.enableRtl;if(c){c.value&&typeof c.value=="string"&&c.value.match("[A-Za-z]+")!==null||c.value===""||g(c.value)?u=!0:u=!1;var p=c.hyperlink;if(typeof p=="string"){var f=p;f.indexOf("http://")===-1&&f.indexOf("https://")===-1&&f.indexOf("ftp://")===-1&&(a=p,r=!1)}else if(typeof p=="object"){var f=p.address;f.indexOf("http://")===-1&&f.indexOf("https://")===-1&&f.indexOf("ftp://")===-1&&(a=p.address,r=!1)}if(a){for(var v=0,m=0,y=this.parent.definedNames,b=this.parent.sheets,S=0,C=b.length;S<C;S++)a.includes(b[S].name)&&m++;for(var x=0,C=y.length;x<C;x++)y[x].name===a&&v++;v===0&&m===0&&(r=!0)}if(r?i=0:i=1,this.parent.definedNames){for(var I=0;I<this.parent.definedNames.length;I++)if(this.parent.definedNames[I].name===a){n=!0,s=!1;break}}}var D=this.parent.createElement("div",{className:"e-link-dialog"}),M=this.parent.createElement("div",{className:"e-webpage"}),E=this.parent.createElement("div",{className:"e-document"});this.headerTabs=new wy({selectedItem:i,enableRtl:d,items:[{header:{text:t.getConstant("WebPage")},content:M},{header:{text:t.getConstant("ThisDocument")},content:E}]}),this.headerTabs.appendTo(D);var A=D.querySelector(".e-toolbar-items").querySelector(".e-indicator");r?A.style.cssText=d?"left: 136px; right: 0":"left: 0; right: 136px":A.style.cssText=d?"left: 0; right: 136px":"left: 136px; right: 0";var L=this.parent.createElement("div",{className:"e-cont"}),N=this.parent.createElement("div",{className:"e-cont"}),R=this.parent.createElement("div",{className:"e-header"});R.innerText=t.getConstant("DisplayText");var P=this.parent.createElement("div",{className:"e-header"});P.innerText=t.getConstant("Url");var k=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(k),u||(k.classList.add("e-disabled"),k.setAttribute("readonly","true"),k.setAttribute("disabled","true")),c&&g(c.hyperlink)&&k.setAttribute("value",this.parent.getDisplayText(c));var B=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(B),k.setAttribute("placeholder",t.getConstant("EnterTheTextToDisplay")),B.setAttribute("placeholder",t.getConstant("EnterTheUrl")),L.appendChild(k),L.insertBefore(R,k),N.appendChild(B),N.insertBefore(P,B),M.appendChild(N),M.insertBefore(L,N);var F=[],O=[],z=this.parent.sheets;for(e;e<this.parent.sheets.length;e++){var Y=this.parent.sheets[e].name;this.parent.sheets[e].state==="Visible"&&(z[e]===this.parent.getActiveSheet()?F.push({nodeId:"sheet",nodeText:Y.indexOf(" ")!==-1?"'"+Y+"'":Y,selected:!0}):F.push({nodeId:"sheet",nodeText:Y.indexOf(" ")!==-1?"'"+Y+"'":Y}))}for(e=0;e<this.parent.definedNames.length;e++)O.push({nodeId:"defName",nodeText:this.parent.definedNames[e].name});var K=[{nodeId:"01",nodeText:t.getConstant("CellReference"),expanded:s,nodeChild:F},{nodeId:"02",nodeText:t.getConstant("DefinedNames"),expanded:n,nodeChild:O}],U=new CI({fields:{dataSource:K,id:"nodeId",text:"nodeText",child:"nodeChild"},enableRtl:d}),q=this.parent.createElement("div",{className:"e-cont"}),ae=this.parent.createElement("div",{className:"e-header"});ae.innerText=t.getConstant("CellReference");var te=this.parent.createElement("input",{className:"e-input e-text e-hyp-text",attrs:{type:"Text"}});te.setAttribute("value","A1"),this.inputElements.push(te),q.appendChild(te),q.insertBefore(ae,te);var he=this.parent.createElement("div",{className:"e-cont"}),ue=this.parent.createElement("div",{className:"e-header"});ue.innerText=t.getConstant("DisplayText");var ne=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});this.inputElements.push(ne),u||(ne.classList.add("e-disabled"),ne.setAttribute("readonly","true"),ne.setAttribute("disabled","true")),c&&g(c.hyperlink)&&ne.setAttribute("value",this.parent.getDisplayText(c)),ne.setAttribute("placeholder",t.getConstant("EnterTheTextToDisplay")),he.appendChild(ne),he.insertBefore(ue,ne);var le=this.parent.createElement("div",{className:"e-cont"}),$=this.parent.createElement("div",{className:"e-header"});$.innerText=t.getConstant("Sheet");var ee=this.parent.createElement("div",{className:"e-refcont"});return this.divElements.push(L),this.divElements.push(N),this.divElements.push(R),this.divElements.push(P),this.divElements.push(q),this.divElements.push(ae),this.divElements.push(he),this.divElements.push(ue),this.divElements.push(le),this.divElements.push($),this.divElements.push(ee),this.divElements.push(E),this.divElements.push(M),this.divElements.push(D),le.appendChild(ee),le.insertBefore($,ee),E.appendChild(q),E.insertBefore(he,q),U.appendTo(ee),E.appendChild(le),D},o.prototype.removeHyperlink=function(t){var e=Q(t.rowIdx,t.colIdx,t.sheet);e&&e.hyperlink&&(typeof e.hyperlink=="string"?e.value=e.value||e.value===0?e.value:e.hyperlink:e.value=e.value||e.value===0?e.value:e.hyperlink.address,delete e.hyperlink,e.style&&(delete e.style.textDecoration,delete e.style.color),e.validation&&e.validation.isHighlighted&&e.style.backgroundColor&&(e.style.color="#ff0000"),t.sheet===this.parent.getActiveSheet()&&(e.style&&this.parent.notify(Hs,null),t.preventRefresh||this.parent.serviceLocator.getService("cell").refresh(t.rowIdx,t.colIdx,!1,null,!0,!1,xs(this.parent))))},o.prototype.removeHyperlinkHandler=function(t){var e=t.range,i,r=this.parent.getActiveSheet(),n;if(!t.preventEventTrigger){var s={address:e.indexOf("!")===-1?r.name+"!"+e:e,cancel:!1};if(this.parent.notify(hi,{action:"removeHyperlink",eventArgs:s}),s.cancel)return}if(e&&e.indexOf("!")!==-1){var a=e.lastIndexOf("!");i=e.substring(0,a);for(var l=this.parent.sheets,h=0;h<l.length;h++)l[h].name===i&&(n=h);r=this.parent.sheets[n],e=e.substring(a+1)}for(var c=ie(e||r.activeCell),u,d,p=c[0];p<=c[2];p++)for(var f=c[1];f<=c[3];f++)if(r&&r.rows[p]&&r.rows[p].cells[f]){if(d=[],u=this.parent.getCell(p,f),u)for(var v=0;v<u.classList.length;v++)d.push(u.classList[v]);this.parent.notify(Mb,{sheet:r,rowIdx:p,colIdx:f});for(var v=0;v<d.length;v++)u.classList.contains(d[v])||u.classList.add(d[v])}t.preventEventTrigger||this.parent.notify(wt,{action:"removeHyperlink",eventArgs:{address:e.indexOf("!")===-1?r.name+"!"+e:e}})},o})(),QD=function(){return QD=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},QD.apply(this,arguments)},V9=(function(){function o(t){this.undoCollection=[],this.redoCollection=[],this.isUndo=!1,this.undoRedoStep=100,this.parent=t,this.addEventListener()}return o.prototype.setActionData=function(t){var e=this,i=this.parent.getActiveSheet(),r,n=[],s=[],a=t.args,l=a.eventArgs,h={};switch(a.action){case"format":r=ie(a.eventArgs.range);break;case"clipboard":h=l.copiedInfo,r=ie(Gc(l.pastedRange)),h&&h.isCut&&(s=this.getCellDetails(h.range,ke(this.parent,Cn(this.parent,h.sId)),"clipboard"));break;case"beforeSort":r=ie(a.eventArgs.range),r[0]===r[2]&&r[2]-r[0]===0&&(r[0]=0,r[1]=0,r[2]=i.usedRange.rowIndex,r[3]=i.usedRange.colIndex);break;case"beforeCellSave":case"cellDelete":case"cellSave":case"addNote":case"editNote":case"deleteNote":r=ie(l.address);break;case"beforeWrap":case"beforeReplace":case"chartDesign":r=this.parent.getAddressInfo(l.address).indices;break;case"beforeClear":r=ie(l.range);break;case"beforeInsertImage":r=ie(l.range);break;case"deleteImage":r=ie(l.address);break;case"beforeInsertChart":r=ie(l.range);break;case"filter":r=ie(l.range);break;case"autofill":r=ie(l.fillRange);break;case"validation":iP(l.range.substring(l.range.lastIndexOf("!")+1))?(r=ie(l.range),r[2]=i.usedRange.rowIndex):r=ie(l.range);break;case"removeValidation":if(l.isColSelected){this.beforeActionData={cellDetails:[]};for(var c=l.range.substring(l.range.lastIndexOf("!")+1).split(":"),u=Sn(c[0]),d=Sn(c[1]);u<=d;u++)i.columns[u]&&i.columns[u].validation&&this.beforeActionData.cellDetails.push({colIndex:u,validation:i.columns[u].validation})}else r=ie(l.range);break;case"hyperlink":case"removeHyperlink":r=ie(l.address);break}a.action==="beforeSort"?(this.beforeActionData={cellDetails:l.cellDetails},this.beforeActionData.sortedCellDetails=l.sortedCellDetails):r&&(a.isClearAction&&this.beforeActionData.cellDetails.length>0?n=this.beforeActionData.cellDetails:a.action==="format"&&l.requestType==="CellFormat"&&l.range.includes(" ")?l.range.split(" ").forEach(function(p){n.push.apply(n,e.getCellDetails(ie(p),i,a.action))}):n=this.getCellDetails(r,i,a.action),this.beforeActionData={cellDetails:n,cutCellDetails:s})},o.prototype.getBeforeActionData=function(t){t.beforeDetails=this.beforeActionData},o.prototype.performUndoRedo=function(t){var e;t.isFromUpdateAction?e=t:(e=t.isUndo?this.undoCollection.pop():this.redoCollection.pop(),t.setCollection&&(t.undoArgs=e)),this.isUndo=t.isUndo;var i;if(e){var r=void 0,n=e.action,s={},a=[],l;if(e.action==="autofill"||e.action==="autofillWithCF"?a=e.eventArgs.fillRange.split("!"):e.action==="cellSave"||e.action==="cellDelete"?a=e.eventArgs.address.split("!"):e.action==="clipboard"&&(a=e.eventArgs.pastedRange.split("!")),a.length>0?l=ke(this.parent,Ct(this.parent,a[0])):e.action==="clear"&&(l=ke(this.parent,e.eventArgs.sheetIndex)),e.action==="autofillWithCF"){e.action="autofill";var h=l.conditionalFormats;h.length&&h[h.length-1].action==="autofillWithCF"&&t.isUndo&&(h[h.length-1].value?h.pop():this.parent.notify(po,{range:h[h.length-1].range,isAction:!0}))}if(!t.isPublic){var c=e.eventArgs.beforeActionData;if(delete e.eventArgs.beforeActionData,r={action:e.action,eventArgs:{}},pe(r.eventArgs,e.eventArgs,null,!0),this.parent.calculationMode==="Manual"&&(e.action==="clipboard"||e.action==="cellDelete"||e.action==="autofill"||e.action==="clear")){if(!t.isUndo)l.isSheetCalculated&&(c.cutCellDetails.length?c.cutCellDetails:c.cellDetails).forEach(function(C){var x=Q(C.rowIndex,C.colIndex,l,!1,!0).value;(x||x===0)&&C.value!==x&&(C.value=x)});else if(e.eventArgs.requestType==="paste"&&e.action==="clipboard"||e.eventArgs.fillType){var u=void 0;if(c.cutCellDetails.length?l.isSheetCalculated&&(u="Cut"):u=e.eventArgs.fillType?"autofill":"Copy",u)for(var d=0,p=c.cellDetails,f=c.cutCellDetails;d<p.length;d++){var v=Q(p[d].rowIndex,p[d].colIndex,l,!1,!0);v=v?v.value:"",u==="Copy"?p[d].copyCellValue=v:u==="autofill"?p[d].value!==v&&p[d].autoFillText!==v&&(p[d].autoFillText=v):u==="Cut"&&f[d].value!==v&&(f[d].value=v)}}}if(e.eventArgs.beforeActionData=c,r.eventArgs.cancel=!1,e.preventAction=r.preventAction=!0,t.isUndo){if(r.isUndo=!0,e.action==="cellSave"&&this.parent.calculationMode==="Manual"&&l.isSheetCalculated&&c.cellDetails.length===1){var m=Q(c.cellDetails[0].rowIndex,c.cellDetails[0].colIndex,l);m&&e.eventArgs.displayText!==m.value&&(e.eventArgs.displayText=m.value)}}else r.isRedo=!0;if(t.isFromUpdateAction||this.parent.notify(hi,r),r.eventArgs.cancel){this.updateUndoRedoIcons();return}delete r.eventArgs.cancel}switch(e.action){case"cellSave":case"format":case"wrap":case"cellDelete":case"autofill":case"removeValidation":case"hyperlink":case"addNote":case"editNote":case"deleteNote":case"removeHyperlink":e=this.performOperation(e,t.preventEvt,t.preventReSelect,t.isFromAutoFillOption),e.action=n;break;case"sorting":this.undoForSorting(e,t.isUndo);break;case"clipboard":e=this.undoForClipboard(e,t.isUndo,r),i=!0;break;case"resize":case"resizeToFit":if(e=this.undoForResize(e),t.isUndo){var y=e.eventArgs;if(!y.isPrevCustomHeight){var b=this.parent.sheets[y.sheetIndex],S=b&&Yr(b,y.index);S&&S.customHeight&&delete S.customHeight}}break;case"hideShow":on(e,this.parent,!t.isUndo);break;case"replace":e=this.performOperation(e);break;case"replaceAll":e.eventArgs.isAction=!1,t.isUndo&&(s.value=e.eventArgs.replaceValue,s.replaceValue=e.eventArgs.value,s.skipFormatCheck=xs(this.parent)),this.parent.notify(Bd,QD({},e.eventArgs,s));break;case"insert":case"filter":on(e,this.parent,!t.isUndo,null,r),i=e.action==="filter";break;case"delete":on(e,this.parent,!t.isUndo);break;case"validation":on(e,this.parent,!t.isUndo),e=this.performOperation(e);break;case"addHighlight":case"removeHighlight":on(e,this.parent,!t.isUndo);break;case"merge":e.eventArgs.merge=e.isFromUpdateAction?e.eventArgs.merge:!e.eventArgs.merge,on(e,this.parent,!t.isUndo);break;case"clear":e=this.performOperation(e),t.isUndo&&e.eventArgs.cfClearActionArgs&&on({action:"clearCF",eventArgs:e.eventArgs.cfClearActionArgs},this.parent,!t.isUndo);for(var d=this.undoCollection.length;d>0&&this.undoCollection[d-1].isClearAction;d--)this.performUndoRedo(t);break;case"conditionalFormat":on(e,this.parent,!t.isUndo,this.undoCollection);break;case"clearCF":on(e,this.parent,!t.isUndo);break;case"insertImage":case"deleteImage":on(e,this.parent,!t.isUndo);break;case"imageRefresh":on(e,this.parent,!t.isUndo);break;case"insertChart":case"deleteChart":on(e,this.parent,!t.isUndo);break;case"chartRefresh":on(e,this.parent,!t.isUndo);break;case"chartDesign":e.eventArgs.isUndo=t.isUndo,this.parent.notify(LD,e.eventArgs);break;case"addDefinedName":on(e,this.parent,!t.isUndo);break}t.isFromUpdateAction||(t.isUndo?this.redoCollection.push(e):this.undoCollection.push(e),this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.redoCollection.length>this.undoRedoStep&&this.redoCollection.splice(0,1),this.updateUndoRedoIcons(),!t.isPublic&&!i&&this.parent.notify(wt,pe({isUndoRedo:!0,isUndo:t.isUndo},e))),this.parent.notify(Hs,null)}},o.prototype.undoForSorting=function(t,e){var i=this,r=js(this.parent,t.eventArgs.range),n=ie(t.eventArgs.range),s=function(u,d){if(r===i.parent.activeSheetIndex){var p=i.parent.getCell(n[0]-1,i.parent.sortCollection[u].columnIndex);if(p&&(p=J(".e-filter-icon",p),p)){var f="e-sort"+(i.parent.sortCollection[u].order==="Ascending"?"asc":"desc")+"-filter";d?p.classList.add(f):p.classList.remove(f)}}};if(e){if(this.parent.notify(IM,{result:t.eventArgs.beforeActionData.cellDetails,range:n,sheet:ke(this.parent,r),jsonData:t.eventArgs.beforeActionData.sortedCellDetails,isUndo:!0}),this.parent.notify(og,{range:t.eventArgs.range}),this.parent.sortCollection&&t.eventArgs.previousSort){for(var a=this.parent.sortCollection.length-1;a>=0;a--)if(this.parent.sortCollection[a].sheetIndex===r){s(a,!1),this.parent.sortCollection.splice(a,1);var l=t.eventArgs.previousSort;if(Array.isArray(l))for(var h=0;h<l.length;h++)this.parent.sortCollection.splice(h,0,l[h]),s(h,!0);this.parent.sortCollection.length||(this.parent.sortCollection=void 0);break}}}else if(on(t,this.parent,!0),t.eventArgs.previousSort){var c=0;if(this.parent.sortCollection)for(var a=this.parent.sortCollection.length-1;a>=0;a--)this.parent.sortCollection[a].sheetIndex===r&&(s(a,!1),c=a,this.parent.sortCollection.splice(a,1));else this.parent.sortCollection=[];this.parent.sortCollection.splice(c,0,{sortRange:t.eventArgs.range.substring(t.eventArgs.range.lastIndexOf("!")+1),sheetIndex:r,columnIndex:Sn(t.eventArgs.sortOptions.sortDescriptors.field),order:t.eventArgs.sortOptions.sortDescriptors.order}),s(c,!0)}},o.prototype.updateUndoRedoCollection=function(t){var e=["clipboard","format","sorting","cellSave","resize","resizeToFit","wrap","hideShow","replace","validation","merge","clear","conditionalFormat","clearCF","insertImage","imageRefresh","insertChart","deleteChart","chartRefresh","filter","cellDelete","autofill","autofillWithCF","addDefinedName","removeValidation","removeHighlight","addHighlight","hyperlink","removeHyperlink","deleteImage","chartDesign","replaceAll","addNote","editNote","deleteNote"];(t.args.action==="insert"||t.args.action==="delete")&&t.args.eventArgs.modelType!=="Sheet"&&e.push(t.args.action);var i=t.args.action;if(!(e.indexOf(i)===-1&&!t.isPublic)){var r=t.args.eventArgs;if(i==="clipboard"||i==="sorting"||i==="format"||i==="cellSave"||i==="wrap"||i==="replace"||i==="validation"||i==="clear"||i==="conditionalFormat"||i==="clearCF"||i==="insertImage"||i==="imageRefresh"||i==="insertChart"||i==="chartRefresh"||i==="filter"||i==="cellDelete"||i==="autofill"||i==="autofillWithCF"||i==="removeValidation"||i==="addDefinedName"||i==="hyperlink"||i==="removeHyperlink"||i==="deleteImage"||i==="chartDesign"||i==="addNote"||i==="editNote"||i==="deleteNote"){var n={beforeDetails:{cellDetails:[]}};this.parent.notify(pM,n),r.beforeActionData=n.beforeDetails}if(i==="clipboard"&&r.copiedInfo&&r.copiedInfo.isExternal){var s=this.parent.getAddressInfo(r.pastedRange);r.copiedInfo.cellDetails=this.getCellDetails(s.indices,ke(this.parent,s.sheetIndex),i)}this.redoCollection.length>0&&this.redoCollection[this.redoCollection.length-1].action==="autofillWithCF"&&t.args.action==="autofill"&&(t.args.action="autofillWithCF"),this.undoCollection.push(t.args),this.redoCollection=[],this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.updateUndoRedoIcons()}},o.prototype.clearUndoRedoCollection=function(){this.undoCollection=[],this.redoCollection=[],this.updateUndoRedoIcons()},o.prototype.updateUndoRedoIcons=function(){var t=this.parent.serviceLocator.getService(ve);this.parent.notify(Ea,[{tab:t.getConstant("Home"),items:[this.parent.element.id+"_undo"],enable:this.undoCollection.length>0}]),this.parent.notify(Ea,[{tab:t.getConstant("Home"),items:[this.parent.element.id+"_redo"],enable:this.redoCollection.length>0}])},o.prototype.updateUndoRedoSheetReferences=function(t){var e=function(i){i.forEach(function(r){var n=r.eventArgs;n&&["address","dataRange","fillRange"].forEach(function(s){n[s]&&n[s].includes(t.pName)&&(n[s]=n[s].replace(t.pName,t.value))})})};e(this.undoCollection),e(this.redoCollection)},o.prototype.undoForClipboard=function(t,e,i){var r=this,n=t.eventArgs,s=[];s[0]=n.pastedRange.substring(0,n.pastedRange.lastIndexOf("!")),s[1]=n.pastedRange.substring(n.pastedRange.lastIndexOf("!")+1);var a=ie(s[1]),l=Ct(this.parent,s[0]),h=ke(this.parent,l),c=n.copiedInfo,u=n.beforeActionData,d=t.isFromUpdateAction,p=l===this.parent.activeSheetIndex,f;if(i&&(i.isUndoRedo=!0,i.eventArgs.beforeActionData=u),t.eventArgs.requestType==="imagePaste"){var v=n.copiedShapeInfo;e?(f=v.pictureElem,v.isCut?(this.parent.notify(La,{id:f.id,sheetIdx:n.pasteSheetIndex+1,isUndoRedo:!0}),this.parent.notify(go,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,id:f.id},range:v.copiedRange,isPublic:!1,isUndoRedo:!0})):this.parent.notify(La,{id:n.pastedPictureElement.id,sheetIdx:n.pasteSheetIndex+1,range:n.pastedRange,isUndoRedo:!0})):v.isCut?(f=v.pictureElem,this.parent.notify(La,{id:f.id,sheetIdx:v.sId,isUndoRedo:!0}),this.parent.notify(go,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,id:f.id},range:v.pastedRange,isPublic:!1,isUndoRedo:!0})):(f=n.pastedPictureElement,this.parent.notify(go,{options:{src:f.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:v.height,width:v.width,id:f.id},range:n.pastedRange,isPublic:!1,isUndoRedo:!0}))}else{if(e){if(c.isCut){var m=u.cutCellDetails;this.updateCellDetails(m,ke(this.parent,Cn(this.parent,c.sId)),tt(c.range),p,t),n.cfClearActionArgs&&on({action:"clearCF",eventArgs:n.cfClearActionArgs},this.parent,!1)}u&&this.updateCellDetails(u.cellDetails,h,a,p,t,null,null,i?i.isUndoRedo:null),n.cfActionArgs&&n.cfActionArgs.cfModel.forEach(function(C){on({eventArgs:{range:C.range,type:C.type,cFColor:C.cFColor,value:C.value,sheetIdx:n.cfActionArgs.sheetIdx,cancel:!0},action:"conditionalFormat"},r.parent,!1)}),Ph(h,a[0],a[1],ei(h,a[0]));var y=qo(h,a[0]);Na(this.parent,h,y,a[0]),n.mergeCollection.forEach(function(C){C.merge=!C.merge,r.parent.notify(Nn,C),C.merge=!C.merge}),i&&!d&&this.parent.notify(wt,i)}else if(c.isExternal){var b=this.parent.getAddressInfo(n.pastedRange);this.updateCellDetails(c.cellDetails,ke(this.parent,b.sheetIndex),b.indices,!0,t,null,null,i?i.isUndoRedo:null),i&&!d&&this.parent.notify(wt,i)}else{var S=new Promise(function(x){x((function(){})())}),b=this.parent.getAddressInfo(n.copiedRange);this.parent.notify(n.copiedInfo.isCut?iu:ru,{range:b.indices,sId:ke(this.parent,b.sheetIndex).id,promise:S,invokeCopy:!0,isPublic:!0,isFromUpdateAction:d}),S.then(function(){r.parent.notify(fo,{range:s&&Ji(n.pastedRange),sIdx:s&&Ct(r.parent,na(n.pastedRange)),type:n.type,isAction:!1,isInternal:!0,isFromUpdateAction:d,beforeActionData:n.beforeActionData,isUndo:e}),i&&!d&&r.parent.notify(wt,i)})}p&&!d?(this.parent.notify(tu,{address:n.selectedRange}),this.parent.notify(Oa,{})):this.checkRefreshNeeded(l,d)}return t},o.prototype.undoForResize=function(t){var e=t.eventArgs;if(e.hide===void 0)if(e.isCol){var i=e.oldWidth;e.oldWidth=e.width,e.width=i}else{var i=e.oldHeight;e.oldHeight=e.height,e.height=i}else e.hide=!e.hide;on(t,this.parent,!1);var r=this.parent.getActiveSheet(),n=ie(r.activeCell),s=Q(n[0],n[1],r);if(s&&s.rowSpan){var a=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.height=a.offsetHeight+"px"}else if(s&&s.colSpan){var a=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.width=a.offsetWidth+"px"}if(e.isCol){var l=this.parent.frozenColCount(r),h=e.index,c=xe(r.topLeftCell);if(l&&h>=c[1]&&h<l||h>=this.parent.viewport.leftIndex+l&&h<=this.parent.viewport.rightIndex){var u=this.parent.frozenRowCount(r);u>0&&this.reapplyFormats(r,h,c[0],u-1),this.reapplyFormats(r,h,this.parent.viewport.topIndex+u,this.parent.viewport.bottomIndex)}}return t},o.prototype.reapplyFormats=function(t,e,i,r){for(i;i<=r;i++){var n=Q(i,e,t,!1,!0);n.format&&n.format.includes("*")&&this.parent.notify(yr,{value:n.value,format:n.format,cell:n,formattedText:n.value,rowIndex:i,colIndex:e})}},o.prototype.performOperation=function(t,e,i,r){var n=this,s=t.eventArgs,a=[],l=t.action==="cellSave"||t.action==="wrap"||t.action==="replace"||t.action==="cellDelete"||t.action==="hyperlink"||t.action==="addNote"||t.action==="editNote"||t.action==="deleteNote"||t.action==="removeHyperlink"?s.address:s.range;t.action==="autofill"?(a[0]=s.fillRange.substring(0,s.fillRange.lastIndexOf("!")),a[1]=s.fillRange.substring(s.fillRange.lastIndexOf("!")+1)):(a[0]=l.substring(0,l.lastIndexOf("!")),a[1]=l.substring(l.lastIndexOf("!")+1));var h=Ct(this.parent,a[0]),c=ke(this.parent,h),u=s.beforeActionData,d=t.isFromUpdateAction,p=this.checkRefreshNeeded(h,d),f=a[1].split(" "),v;return f.forEach(function(m){if(s.isColSelected){var y=m.split(":");v=[0,Sn(y[0]),c.rowCount-1,Sn(y[1])]}else v=tt(ie(m));var b=v,S={cellIdx:[v[0],v[1]],isUnique:!1,uniqueRange:""};if(s.isColSelected||n.parent.notify(Kc,S),n.isUndo){if(S.isUnique&&s.formula&&s.formula.indexOf("UNIQUE")>-1){var C=ie(S.uniqueRange);if(Q(C[0],C[1],n.parent.getActiveSheet()).value!=="#SPILL!")for(var x=C[0];x<=C[2];x++)for(var I=C[1];I<=C[3];I++)x===C[0]&&I===C[1]&&(I=I+1),n.parent.updateCellInfo({value:""},Ve([x,I]),!0)}if(n.updateCellDetails(u.cellDetails,c,v,p,t,e,s.isColSelected,!0,r),S.isUnique&&t.action==="cellDelete"&&s.isSpill){for(var C=ie(S.uniqueRange),D=Q(C[0],C[1],n.parent.getActiveSheet()),M=C[0];M<=C[2];M++)for(var x=C[1];x<=C[3];x++)for(var I=v[0];I<=v[2];I++)for(var E=v[1];E<=v[3];E++)(M!==I||x!==E)&&n.parent.updateCellInfo({value:""},st(M,x),!0);D.value="#SPILL!",n.parent.updateCellInfo(D,st(C[0],C[1]),!0)}if(!s.isSpill&&S.uniqueRange!==""){for(var A=ie(S.uniqueRange),x=A[0];x<=A[2];x++)for(var I=A[1];I<=A[3];I++)x===A[0]&&I===A[1]&&(I=I+1),n.parent.updateCellInfo({value:""},Ve([x,I]),!0);n.parent.notify(Ob,null)}}else{var L=t.eventArgs,N=ie(c.activeCell),R=m?m.split(":"):[];b[0]!==N[0]&&b[1]!==N[1]&&t.action==="hyperlink"&&R.length>0&&(c.activeCell=R[0],N=ie(c.activeCell));var P=n.parent.getCellStyleValue(["textDecoration"],N).textDecoration;if(L&&L.style&&L.style.textDecoration){var k=L.style.textDecoration,B=k,F=void 0,O=!1;P==="underline"?B=k==="underline"?"none":"underline line-through":P==="line-through"?B=k==="line-through"?"none":"underline line-through":P==="underline line-through"&&(B=k==="underline"?"line-through":"underline",O=!0),B==="none"&&(O=!0),L.style.textDecoration=B,t.eventArgs=L;for(var M=b[0];M<=b[2];M++)for(var x=b[1];x<=b[3];x++){if(F={},P=n.parent.getCellStyleValue(["textDecoration"],[M,x]).textDecoration,P==="none"){if(O)continue;F.textDecoration=k}else if(P==="underline"||P==="line-through")if(O)if(k===P)F.textDecoration="none";else continue;else F.textDecoration=k!==P?"underline line-through":k;else if(P==="underline line-through")if(O)F.textDecoration=k==="underline"?"line-through":"underline";else continue;n.parent.notify(ur,{style:{textDecoration:F.textDecoration},range:[M,x,M,x],refreshRibbon:!0,onActionUpdate:!0})}L.style.textDecoration=k,t.eventArgs=L}else{if(!g(s.oldValue)&&s.oldValue!==s.value&&S.isUnique){var z=ie(S.uniqueRange);if(Q(z[0],z[1],n.parent.getActiveSheet()).value!=="#SPILL!")for(var x=z[0];x<=z[2];x++)for(var I=z[1];I<=z[3];I++)x===z[0]&&I===z[1]&&(n.parent.updateCellInfo({value:"#SPILL!"},Ve([z[0],z[1]]),!0),I=I+1),n.parent.updateCellInfo({value:""},Ve([x,I]),!0)}if(on(t,n.parent,!0),S.isUnique&&t.action==="cellDelete"&&s.isSpill){for(var Y=ie(S.uniqueRange),K=!1,M=Y[0];M<=Y[1];M++)for(var x=Y[1];x<=Y[3];x++)M===Y[0]&&x===Y[1]&&x++,Q(M,x,c)&&!g(Q(M,x,c).value)&&Q(M,x,c).value!==""&&(K=!0);if(!K){var D=Q(Y[0],Y[1],n.parent.getActiveSheet());D.value="",n.parent.updateCellInfo(D,st(Y[0],Y[1]),!0),n.parent.notify(Ob,null)}}}}}),t.action==="autofill"&&(a[1]=this.isUndo?t.eventArgs.dataRange:t.eventArgs.selectedRange),p&&!i&&!d&&(s.isColSelected&&(a[1]=c.selectedRange),this.parent.notify(tu,{address:a[1]})),this.parent.showAggregate&&this.parent.notify(jl,{}),t},o.prototype.getCellDetails=function(t,e,i){var r=this,n=[],s,a=i==="cellDelete",l={};t=tt(t);var h=function(v,m){var y={rowIndex:v,colIndex:m,value:s?s.value:"",formula:s?s.formula:""},b=ei(e,v);if(s){s.format&&(y.format=s.format),g(s.isLocked)||(y.isLocked=s.isLocked),s.style&&(y.style=Object.assign({},s.style)),s.wrap&&(y.wrap=s.wrap),s.rowSpan&&(y.rowSpan=s.rowSpan),s.colSpan&&(y.colSpan=s.colSpan),s.image&&(y.image=s.image),s.chart&&(y.chart=JSON.parse(JSON.stringify(s.chart))),s.validation&&(y.validation=Object.assign({},s.validation)),s.notes&&(y.notes=s.notes),s.isReadOnly&&(y.isReadOnly=s.isReadOnly),s.formattedText&&(y.formattedText=s.formattedText),s.hyperlink&&(y.hyperlink=Ls(s.hyperlink)?pe({},s.hyperlink):s.hyperlink),(e.standardHeight?b!==e.standardHeight:b!==20)&&(s.rowHeight=y.rowHeight=b);var S=r.parent.editModule;y.value=s&&S&&s.formula===S.editCellData.value&&!g(S.editCellData.prevFormulaValue)?S.editCellData.prevFormulaValue:y.value}n.push(y)};if(i==="validation"||i==="removeValidation")for(var c=t[1];c<=t[3];c++)for(var u=Ht(e,c),d=t[0];d<=t[2];d++)!l[c]&&hs(u,d,c)&&(n.push({colIndex:c,validation:Object.assign({},u.validation)}),l[c]=!0),s=Q(d,c,e),!(s&&!s.validation)&&h(d,c);else for(var p=t[0];p<=t[2];p++)if(!(a&&as(e,p)))for(var f=t[1];f<=t[3];f++)s=Q(p,f,e),h(p,f);return n},o.prototype.updateCellDetails=function(t,e,i,r,n,s,a,l,h){var c=this,u=t.length,d=n&&!s&&(n.action==="cellSave"||n.action==="cellDelete"||n.action==="autofill"||n.action==="clipboard"),p,f,v,m=n&&!n.eventArgs.cfClearActionArgs&&e.conditionalFormats&&e.conditionalFormats.length&&[].slice.call(e.conditionalFormats),y=[],b,S,C,x;n.action==="cellDelete"&&(C=!1,x=i);for(var I=function(L){if(a||Te(t[L].rowIndex))return Hl(e,t[L].colIndex,{validation:t[L].validation}),"continue";f=Q(t[L].rowIndex,t[L].colIndex,e,!1,!0),f.style&&n&&(n.action==="format"||n.action==="clipboard")&&(f.style.borderTop&&(!t[L].style||!t[L].style.borderTop)&&D.parent.setBorder({borderTop:""},e.name+"!"+st(t[L].rowIndex,t[L].colIndex),null,l),f.style.borderLeft&&(!t[L].style||!t[L].style.borderLeft)&&D.parent.setBorder({borderLeft:""},e.name+"!"+st(t[L].rowIndex,t[L].colIndex),null,l),f.style.borderRight&&(!t[L].style||!t[L].style.borderRight)&&D.parent.setBorder({borderRight:""},e.name+"!"+st(t[L].rowIndex,t[L].colIndex),null,l),f.style.fontSize&&(!t[L].style||!t[L].style.fontSize)&&(f.style.fontSize="11pt",v=!0,D.parent.notify(Mr,{style:{fontSize:"11pt"},rowIdx:t[L].rowIndex,colIdx:t[L].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0})),f.style.fontFamily&&(!t[L].style||!t[L].style.fontFamily)&&(v=!0,f.style.fontFamily="Calibri",D.parent.notify(Mr,{style:{fontFamily:"Calibri"},rowIdx:t[L].rowIndex,colIdx:t[L].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0}))),f.image&&n&&n.action==="clipboard"&&f.image.forEach(function(P){c.parent.notify(La,{id:P.id,sheet:e,preventEventTrigger:!0,rowIdx:t[L].rowIndex,colIdx:t[L].colIndex})});var N={value:t[L].formula&&t[L].formula.toUpperCase().includes("UNIQUE")?null:t[L].value,formula:t[L].formula};if(t[L].format&&(N.format=t[L].format),g(t[L].isLocked)||(N.isLocked=f.isLocked?f.isLocked:t[L].isLocked),t[L].style&&(N.style=Object.assign({},t[L].style)),t[L].wrap&&(N.wrap=t[L].wrap),t[L].rowSpan&&(N.rowSpan=t[L].rowSpan),t[L].colSpan&&(N.colSpan=t[L].colSpan),t[L].hyperlink&&(N.hyperlink=t[L].hyperlink),t[L].image&&(N.image=t[L].image),t[L].notes&&(N.notes=t[L].notes),t[L].isReadOnly&&(N.isReadOnly=t[L].isReadOnly),t[L].formattedText&&(N.formattedText=t[L].formattedText),Zt(t[L].rowIndex,t[L].colIndex,e,N),S={action:"updateCellValue",address:[t[L].rowIndex,t[L].colIndex,t[L].rowIndex,t[L].colIndex],notes:t[L].notes,value:t[L].formula?t[L].formula:t[L].value,sheetIndex:Ct(D.parent,e.name),skipFormatCheck:xs(D.parent),isDelete:C,deletedRange:x,actionName:n.action},D.parent.notify(Xc,S),m&&!b&&(b=S.isFormulaDependent),n&&n.action==="format"&&n.eventArgs.requestType==="NumberFormat"&&N.wrap&&N.format!==f.format&&!Yr(e,t[L].rowIndex).customHeight?D.parent.notify(sa,{range:[t[L].rowIndex,t[L].colIndex,t[L].rowIndex,t[L].colIndex],wrap:!0,sheet:e,initial:!0,isOtherAction:!0}):n&&n.action==="wrap"&&n.eventArgs.wrap||f.wrap&&!t[L].wrap?D.parent.notify(sa,{range:[t[L].rowIndex,t[L].colIndex,t[L].rowIndex,t[L].colIndex],wrap:!1,sheet:e,initial:!0}):n&&n.action==="cellSave"&&f.wrap&&t[L].wrap&&f.value&&f.value.toString().includes(`
`)&&t[L].value&&!t[L].value.toString().includes(`
`)&&D.parent.notify(sa,{range:[t[L].rowIndex,t[L].colIndex,t[L].rowIndex,t[L].colIndex],wrap:!0,sheet:e,initial:!0,isOtherAction:!0}),n&&t[L].hyperlink&&n.action==="clear"){var R=e.name+"!"+Ve([t[L].rowIndex,t[L].colIndex,t[L].rowIndex,t[L].colIndex]);p=D.parent.getCell(t[L].rowIndex,t[L].colIndex),n.eventArgs.type==="Clear All"||n.eventArgs.type==="Clear Hyperlinks"?D.parent.addHyperlink(t[L].hyperlink,R,t[L].value):n.eventArgs.type==="Clear Formats"&&p&&X(p.querySelectorAll(".e-hyperlink"),"e-hyperlink-style")}t[L].validation&&D.parent.notify(Qo,{rules:t[L].validation,range:e.name+"!"+st(t[L].rowIndex,t[L].colIndex)}),d&&t[L].value!==f.value&&D.parent.trigger("cellSave",{element:null,value:t[L].value,oldValue:f.value,formula:t[L].formula,cancel:!1,address:e.name+"!"+st(t[L].rowIndex,t[L].colIndex),displayText:D.parent.getDisplayText(t[L])}),m&&!b&&Eg(m,y,t[L].rowIndex,t[L].colIndex)},D=this,M=0;M<u;M++)I(M);if(r){if(i[0]===i[2]&&i[1]===i[3]){var E=Q(i[0],i[1],e);E.rowSpan>1&&(i[2]=i[0]+E.rowSpan-1),E.colSpan>1&&(i[3]=i[1]+E.colSpan-1)}var A=!1;n.action==="autofill"||n.action==="clipboard"||n.action==="wrap"?A=!0:n.action==="format"&&n.eventArgs.requestType==="CellFormat"&&(A=Qd(n.eventArgs.style,!0)),this.parent.serviceLocator.getService("cell").refreshRange(i,!1,!1,!0,!1,xs(this.parent),null,h,A,null,null,t),(y.length||b)&&this.parent.notify(Gi,{cfModel:!b&&y,refreshAll:b,isAction:!0}),v&&er(function(){return c.parent.selectRange(e.selectedRange)})}},o.prototype.checkRefreshNeeded=function(t,e){var i=!0;return t!==this.parent.activeSheetIndex&&(e||(this.parent.activeSheetIndex=t,this.parent.dataBind()),i=!1),i},o.prototype.addEventListener=function(){this.parent.on(yo,this.performUndoRedo,this),this.parent.on(m0,this.updateUndoRedoCollection,this),this.parent.on(Hh,this.setActionData,this),this.parent.on(pM,this.getBeforeActionData,this),this.parent.on(Vh,this.clearUndoRedoCollection,this),this.parent.on(bD,this.updateUndoRedoIcons,this),this.parent.on(Mg,this.updateUndoRedoSheetReferences,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(yo,this.performUndoRedo),this.parent.off(m0,this.updateUndoRedoCollection),this.parent.off(Hh,this.setActionData),this.parent.off(pM,this.getBeforeActionData),this.parent.off(Vh,this.clearUndoRedoCollection),this.parent.off(bD,this.updateUndoRedoIcons),this.parent.off(Mg,this.updateUndoRedoSheetReferences))},o.prototype.destroy=function(){this.removeEventListener(),this.undoCollection.length>0&&(this.undoCollection=[]),this.redoCollection.length>0&&(this.redoCollection=[]),this.beforeActionData&&this.beforeActionData.cellDetails&&(this.beforeActionData.cellDetails=[]),this.parent=null},o.prototype.getModuleName=function(){return"undoredo"},o})(),_9=(function(){function o(t){this.parent=t,this.wrapCell=this.parent.createElement("span",{className:"e-wrap-content"}),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Ag,this.ribbonClickHandler,this),this.parent.on(sa,this.wrapTextHandler,this),this.parent.on(Fn,this.rowHeightChangedHandler,this),this.parent.on(Qn,this.colWidthChanged,this),this.parent.on(HD,this.updateWrapCell,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ag,this.ribbonClickHandler),this.parent.off(sa,this.wrapTextHandler),this.parent.off(Fn,this.rowHeightChangedHandler),this.parent.off(Qn,this.colWidthChanged),this.parent.off(HD,this.updateWrapCell))},o.prototype.wrapTextHandler=function(t){if(t.initial||WD(this.parent,t.range,!0)){if(t.isPublic&&Hi(this.parent,t.range))return;t.initial&&!t.td&&!t.outsideViewport&&WD(this.parent,t.range,!0)&&(t.initial=!1);var e=void 0,i=void 0,r=void 0,n=void 0,s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,u=void 0,d=this.parent.frozenRowCount(t.sheet),p=void 0,f=void 0,v=void 0;!g(t.sheet.standardHeight)&&t.sheet.standardHeight<20?p=!0:f=this.parent.allowFiltering&&this.parent.filterModule.filterRange.has(this.parent.activeSheetIndex)&&this.parent.filterModule.filterRange.get(this.parent.activeSheetIndex).range;for(var m=t.range[0];m<=t.range[2];m++){n=0,c=Yr(t.sheet,m),l=c.customHeight,a=l||t.isCustomHgt,u=!lt(t.sheet,m);for(var y=t.range[1];y<=t.range[3];y++)if(i=Q(m,y,t.sheet,null,!0),!(i.rowSpan<0||i.colSpan<0)){var b=i.rowSpan>1||i.colSpan>1;if(e=t.initial?t.td:u&&!Ft(t.sheet,y)&&this.parent.getCell(m,y),e?(t.wrap?(h=tE(i.style&&i.style.fontFamily?i.style:this.parent.cellStyle),e.classList.add(yz)):(e.classList.remove(yz),h=null),(a||b||c.height<20||p||f&&m===f[0]&&y>=f[1]&&y<=f[3])&&this.updateWrapCell({rowIdx:m,colIdx:y,sheet:t.sheet,ele:e}),j.isIE&&e.classList.add("e-ie-wrap")):h=null,a||b)b&&!t.wrap&&(i.value&&i.value.toString().includes(`
`)?e.classList.add("e-alt-unwrap"):e.classList.contains("e-alt-unwrap")&&e.classList.remove("e-alt-unwrap"));else{r=ip(t.sheet,m,y,i.colSpan>1?y+i.colSpan-1:y);var S=this.parent.getDisplayText(i).toString();if(this.parent.isEdit&&e&&S.indexOf(`
`)<0){var C=this.parent.element.querySelector(".e-spreadsheet-edit");C&&C.textContent.indexOf(`
`)>-1&&(S=C.textContent)}if(S)if(t.wrap){e&&e.classList.contains("e-alt-unwrap")&&(e.classList.remove("e-alt-unwrap"),S.includes(`
`)&&(v=e.querySelector(".e-hyperlink"),v&&!v.innerText.includes(`
`)&&(v.innerText=S)));var x=void 0,I=0,D=void 0;if(S.indexOf(`
`)>-1){var M=S.split(`
`),E=M.length;for(D=0;D<E;D++)x=jg(M[D],r,i.style,this.parent.cellStyle),x===0&&(x=1),I=I+x;x=I}else x=jg(S,r,i.style,this.parent.cellStyle);if(s=kd(this.parent,m,y,t.sheet,i.style||this.parent.cellStyle,x,h),n=Math.max(n,s),i.rowSpan>1){var A=xi(t.sheet,m,m+(i.rowSpan-1));if(A>=n)return;s=n=ei(t.sheet,m)+(n-A)}Ph(t.sheet,m,y,s)}else{if(e&&(S.indexOf(`
`)>-1&&e.classList.add("e-alt-unwrap"),v=e.querySelector(".e-hyperlink"),v)){var L=v.innerText;L.includes(`
`)&&(v.innerText=L.split(`
`).join(" "))}s=kd(this.parent,m,y,t.sheet,i.style||this.parent.cellStyle,1,h),Ph(t.sheet,m,y,s),n=Math.max(qo(t.sheet,m),20)}else(!t.wrap||!S)&&(Ph(t.sheet,m,y,20),n=Math.max(qo(t.sheet,m),20));if(y===t.range[3]){var N=ei(t.sheet,m);(t.wrap&&(t.isOtherAction?n>=20:n>20)&&qo(t.sheet,m)<=n||(!t.wrap||!S)&&qo(t.sheet,m)<N&&N>20)&&N!==n&&(e?(Na(this.parent,t.sheet,n,m,t.row,t.hRow,u),e&&t.sheet.conditionalFormats&&t.sheet.conditionalFormats.length&&this.parent.notify(Gi,{indexes:[m,y],isAction:!0})):Na(this.parent,t.sheet,n,m,null,null,u,!u||m>this.parent.viewport.bottomIndex||m>=d&&m<this.parent.viewport.topIndex+d))}}if(e){if(a&&!b){var S=this.parent.getDisplayText(i);t.wrap?e.classList.contains("e-alt-unwrap")&&e.classList.remove("e-alt-unwrap"):S.indexOf(`
`)>-1&&e.classList.add("e-alt-unwrap")}t.wrap?l?e.style.lineHeight&&(e.style.lineHeight=""):e.style.lineHeight=parseFloat(i.style&&i.style.fontSize||this.parent.cellStyle.fontSize)*h+"pt":e.style.lineHeight=""}}}t.initial||this.parent.notify(Oa,null)}},o.prototype.ribbonClickHandler=function(t){var e=H(t.originalEvent.target,".e-btn");if(e&&e.id===this.parent.element.id+"_wrap"){var i=e.classList.contains("e-active"),r=IY(this.parent.getActiveSheet()),n={address:r,wrap:i,cancel:!1};if(Hi(this.parent)){this.parent.notify(fr,null);return}this.parent.notify(hi,{action:"beforeWrap",eventArgs:n}),n.cancel||(_c(this.parent.getActiveSheet().selectedRange,i,this.parent),this.parent.notify(wt,{action:"wrap",eventArgs:{address:r,wrap:i}}))}},o.prototype.rowHeightChangedHandler=function(t){if(t.isCustomHgt){t.sheet=this.parent.getActiveSheet();for(var e=this.parent.viewport.leftIndex,i=this.parent.viewport.rightIndex;e<=i;e++)Q(t.rowIdx,e,t.sheet,!1,!0).wrap&&(t.colIdx=e,t.ele=this.parent.getCell(t.rowIdx,e),this.updateWrapCell(t),t.ele.style.lineHeight&&(t.ele.style.lineHeight=""))}},o.prototype.colWidthChanged=function(t){if(t.checkWrapCell){t.sheet=this.parent.getActiveSheet();for(var e=this.parent.viewport.topIndex,i=this.parent.viewport.bottomIndex;e<=i;e++)Q(e,t.colIdx,t.sheet,!1,!0).wrap&&(t.rowIdx=e,t.ele=this.parent.getCell(e,t.colIdx),this.updateWrapCell(t))}},o.prototype.updateWrapCell=function(t){if(t.ele&&!t.ele.querySelector(".e-wrap-content")){for(var e=this.wrapCell.cloneNode(),i=t.ele.querySelector(".e-filter-btn");t.ele.childElementCount&&!g(t.ele.firstElementChild)&&t.ele.firstElementChild.className.indexOf("e-addNoteIndicator")===-1;)e.appendChild(t.ele.firstElementChild);var r=void 0;if(!g(t.ele.firstElementChild)&&t.ele.firstElementChild.className.indexOf("e-addNoteIndicator")>-1&&(r=t.ele.firstElementChild),i&&(t.ele.firstChild?t.ele.insertBefore(i,t.ele.firstChild):t.ele.appendChild(i)),!Q(t.rowIdx,t.colIdx,t.sheet,!1,!0).hyperlink){var n=t.ele.lastChild;n&&n.nodeType===3?(e.appendChild(document.createTextNode(n.textContent)),n.textContent=""):(e.appendChild(document.createTextNode(t.ele.textContent)),t.ele.textContent="")}t.ele.appendChild(e),g(r)||t.ele.appendChild(r)}},o.prototype.getModuleName=function(){return"wrapText"},o.prototype.destroy=function(){this.removeEventListener(),this.wrapCell&&(this.wrapCell.remove(),this.wrapCell=null),this.parent=null},o})(),U9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.insert=function(t){var e=t.eventArgs;this.parent.notify(Ed,e);var i=ke(this.parent,e.activeSheetIndex);switch(e.modelType){case"Sheet":this.parent.notify(YM,{startIdx:e.index,endIdx:e.index+(e.model.length-1),preventUpdate:!e.isAction}),this.parent.renderModule.refreshSheet();break;case"Row":if(e.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.frozenRowCount(i);if(!this.parent.scrollSettings.enableVirtualization||e.index<=this.parent.viewport.bottomIndex)if(e.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenColCount(i);if(e.index>=this.parent.viewport.topIndex+r){var s=[],a=void 0;n?(a=xe(i.topLeftCell)[1],s.push(r),s.push(this.parent.viewport.leftIndex+n)):a=this.parent.viewport.leftIndex;var l=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:a,refresh:"Row",frozenIndexes:s,skipUpdateOnFirst:this.parent.viewport.topIndex+r===ce(i,r,!0)}),n&&(this.parent.viewport.leftIndex=l)}var h=xe(i.paneTopLeftCell)[0];e.index<h&&(this.parent.notify(P0,{scrollTop:xi(i,r,h-1,!0)}),this.parent.goTo(st(e.index,ce(i,n,!0,"columns")))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.topIndex+r===ce(i,0,!0)||this.parent.viewport.bottomIndex===ce(i,i.rowCount-e.model.length-1,!1))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break;case"Column":if(e.activeSheetIndex===this.parent.activeSheetIndex){var n=this.parent.frozenColCount(i);if(!this.parent.scrollSettings.enableVirtualization||e.index<=this.parent.viewport.rightIndex)if(e.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0);else if(this.parent.scrollSettings.enableVirtualization){var r=this.parent.frozenRowCount(i);if(e.index>=this.parent.viewport.leftIndex+n){var s=[];r&&(s=[r+this.parent.viewport.topIndex,n]);var c=r?xe(i.topLeftCell)[0]:this.parent.viewport.topIndex,u=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+n===ce(i,n,!0,"columns"),rowIndex:c,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:s}),r&&(this.parent.viewport.topIndex=u)}var d=xe(i.paneTopLeftCell)[1];e.index<d&&(this.parent.notify(P0,{scrollLeft:wi(i,0,d-1,!0)}),this.parent.goTo(st(ce(i,r,!0),e.index))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.leftIndex+n===ce(i,0,!0,"columns")||this.parent.viewport.rightIndex===ce(i,i.colCount-e.model.length-1,!1,"columns"))&&this.parent.renderModule.refreshSheet(!1,!1,!0)}break}this.refreshImgChartElement(e.model.length,this.parent.activeSheetIndex,e.modelType,e.index),e.isAction?(delete e.isAction,this.parent.notify(wt,t),Re(this.parent.element)):e.isUndoRedo||(e.isMethod=!0,this.parent.notify(dg,t))},o.prototype.refreshImgChartElement=function(t,e,i,r){if(i!=="Sheet")for(var n=this.parent.sheets[e],s=n.rows,a=0,l=s.length;a<l;a++){var h=s[a]&&s[a].cells;if(h&&h.length)for(var c=0;c<h.length;c++){var u=Q(a,c,n);if((i==="Row"&&a>=r||i==="Column"&&c>=r)&&(u&&u.image&&u.image.length>0&&this.parent.notify(L0,{rowIdx:a,colIdx:c,sheetIdx:e,type:i,count:t,status:"insert"}),u&&u.chart&&u.chart.length>0))for(var d=0;d<u.chart.length;d++){var p=u.chart[d],f={clientY:Number(os(p.top).toFixed(2)),isImage:!0},v={clientX:Number(os(p.left).toFixed(2)),isImage:!0};if(this.parent.notify(Ud,f),this.parent.notify(Wd,v),a!==f.clientY||c!==v.clientX){var m={prevTop:p.top,prevLeft:p.left,prevRowIdx:a,prevColIdx:c,prevHeight:p.height,prevWidth:p.width,currentTop:p.top,currentLeft:p.left,currentRowIdx:f.clientY,currentColIdx:v.clientX,currentHeight:p.height,currentWidth:p.width,id:p.id,requestType:"chartRefreshOnInit"};this.parent.notify(Ig,m)}}}}},o.prototype.addEventListener=function(){this.parent.on(DM,this.insert,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(DM,this.insert)},o.prototype.getModuleName=function(){return"insert"},o})(),W9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.delete=function(t){var e=t.eventArgs;if(e.modelType==="Sheet"){var i=e.activeSheetIndex>=e.startIndex&&e.activeSheetIndex<=e.endIndex;i&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(e.startIndex<this.parent.sheets.length?e.startIndex:e.startIndex?e.startIndex-1:0)},!0),e.endIndex<e.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:e.activeSheetIndex-(e.endIndex+1-e.startIndex)},!0),this.parent.notify(Oh,null),i&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else if(e.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.getActiveSheet(),n=this.parent.frozenRowCount(r),s=this.parent.frozenColCount(r);if(e.modelType==="Row"){if(!this.parent.scrollSettings.enableVirtualization||e.startIndex<=this.parent.viewport.bottomIndex)if(this.parent.scrollSettings.enableVirtualization)if(e.startIndex<xe(r.paneTopLeftCell)[0])this.parent.updateTopLeftCell(ce(r,e.startIndex-1<n?n:e.startIndex-1,!0)-n,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(e.freezePane||this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex>=ce(r,r.rowCount-1,!1))this.parent.renderModule.refreshSheet(!1,!1,!0);else{var a=[],l=this.parent.frozenColCount(r),h=void 0,c=this.parent.viewport.leftIndex;l?(a.push(n),a.push(c+l),h=xe(r.topLeftCell)[1]):h=c,this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,refresh:"Row",colIndex:h,skipUpdateOnFirst:this.parent.viewport.topIndex+n===ce(r,n,!0),frozenIndexes:a}),l&&(this.parent.viewport.leftIndex=c),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0)}else{if(e.refreshSheet!==!1&&(!this.parent.scrollSettings.enableVirtualization||e.startIndex<=this.parent.viewport.rightIndex))if(this.parent.scrollSettings.enableVirtualization)if(e.startIndex<xe(r.paneTopLeftCell)[1])this.parent.updateTopLeftCell(null,ce(r,e.startIndex-1<s?s:e.startIndex-1,!0,"columns")-s,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);else if(e.freezePane||e.refreshSheet===!0)this.parent.renderModule.refreshSheet(!1,!1,!0);else{var u=this.parent.frozenRowCount(r),a=[],d=this.parent.viewport.topIndex,p=u?xe(r.topLeftCell)[0]:d;u&&(a=[u+d,s]),this.parent.renderModule.refreshUI({rowIndex:p,refresh:"Column",colIndex:this.parent.viewport.leftIndex,insertDelete:!0,skipUpdateOnFirst:this.parent.viewport.leftIndex+s===ce(r,s,!0,"columns"),frozenIndexes:a}),u&&(this.parent.viewport.topIndex=d),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshSheet(!1,!1,!0);delete e.refreshSheet}}this.refreshImgChartElement(e.deletedModel.length,this.parent.activeSheetIndex,e.modelType,e.startIndex),e.isAction?(delete e.isAction,this.parent.notify(wt,t),Re(this.parent.element)):e.isUndoRedo||(e.isMethod=!0,this.parent.notify(dg,t))},o.prototype.refreshImgChartElement=function(t,e,i,r){if(i!=="Sheet")for(var n=this.parent.sheets[e],s=n.rows,a=0,l=s.length;a<l;a++){var h=s[a]&&s[a].cells;if(h&&h.length)for(var c=0;c<h.length;c++){var u=Q(a,c,n);if((i==="Row"&&a>=r||i==="Column"&&c>=r)&&(u&&u.image&&u.image.length>0&&this.parent.notify(L0,{rowIdx:a,colIdx:c,sheetIdx:e,type:i,count:t,status:"delete"}),u&&u.chart&&u.chart.length>0))for(var d=0;d<u.chart.length;d++){var p=u.chart[d],f={clientY:Number(os(p.top).toFixed(2)),isImage:!0},v={clientX:Number(os(p.left).toFixed(2)),isImage:!0};if(this.parent.notify(Ud,f),this.parent.notify(Wd,v),a!==f.clientY||c!==v.clientX){var m={prevTop:p.top,prevLeft:p.left,prevRowIdx:a,prevColIdx:c,prevHeight:p.height,prevWidth:p.width,currentTop:p.top,currentLeft:p.left,currentRowIdx:f.clientY,currentColIdx:v.clientX,currentHeight:p.height,currentWidth:p.width,id:p.id,requestType:"chartRefreshOnInit"};this.parent.notify(Ig,m)}}}}},o.prototype.addEventListener=function(){this.parent.on(EM,this.delete,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(EM,this.delete)},o.prototype.getModuleName=function(){return"delete"},o})(),q9=(function(){function o(t){this.divElements=[],this.spanElements=[],this.inputElements=[],this.checkBoxElements=[],this.numericTextBoxElements=[],this.dropDownListElements=[],this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener();var t={};if(!this.parent.isDestroyed&&!this.parent.refreshing){var e=xe(this.parent.getActiveSheet().activeCell),i=this.parent.getCell(e[0],e[1]);i&&(t={rowIdx:e[0],colIdx:e[1],td:i,isRefresh:!0})}this.removeListDropdownHandler(this.parent.element.querySelector(".e-validation-list"),t);var r=J("#"+this.parent.element.id+"_datavalidation-popup");r&&r.remove(),this.typeData=[],this.operatorData=[],this.dataList&&(this.dataList=null),this.formObj&&(this.formObj.destroy(),this.formObj=null),this.parent=null},o.prototype.addEventListener=function(){j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)?T.add(this.parent.element,"touchend",this.listOpen,this):T.add(this.parent.element,"dblclick",this.listOpen,this),this.parent.on(gD,this.initiateDataValidationHandler,this),this.parent.on(Og,this.invalidDataHandler,this),this.parent.on(Bb,this.isValidCellHandler,this),this.parent.on(vo,this.listHandler,this),this.parent.on(Ds,this.keyUpHandler,this),this.parent.on(zg,this.removeValidationHandler,this),this.parent.on(Rh,this.updateHighlightHandler,this),this.parent.on(Fn,this.listValidationHeightHandler,this),this.parent.on(Yd,this.addListValidationDropdownHandler,this)},o.prototype.removeEventListener=function(){j.isDevice&&j.info.name==="safari"&&(j.isIos||j.isIos7)?T.remove(this.parent.element,"touchend",this.listOpen):T.remove(this.parent.element,"dblclick",this.listOpen),this.parent.isDestroyed||(this.parent.off(gD,this.initiateDataValidationHandler),this.parent.off(Og,this.invalidDataHandler),this.parent.off(Bb,this.isValidCellHandler),this.parent.off(vo,this.listHandler),this.parent.off(Ds,this.keyUpHandler),this.parent.off(zg,this.removeValidationHandler),this.parent.off(Rh,this.updateHighlightHandler),this.parent.off(Fn,this.listValidationHeightHandler),this.parent.off(Yd,this.addListValidationDropdownHandler))},o.prototype.removeValidationHandler=function(t){var e,i,r={cancel:!1,isColSelected:t.isCol};if(t.range&&t.range.includes("!")){if(i=t.range,e=ke(this.parent,Ct(this.parent,i.substring(0,i.lastIndexOf("!")))),!e)return}else if(e=this.parent.getActiveSheet(),i=e.name+"!",t.range)i+=t.range;else{var n=this.getRange(e.selectedRange);i+=n.range,r.isColSelected=n.isColSelected}r.range=i,t.isAction&&this.parent.notify(hi,{eventArgs:r,action:"removeValidation"}),r.cancel||(this.parent.notify(Qo,{range:i,isRemoveValidation:!0}),t.isAction&&(delete r.cancel,this.parent.notify(wt,{eventArgs:r,action:"removeValidation"})))},o.prototype.updateNoteIndicator=function(t,e,i){var r=t.querySelector(".e-addNoteIndicator");r&&(Qe(r),this.parent.notify(Zd,{targetElement:t,rowIndex:e,columnIndex:i,skipEvent:!0}))},o.prototype.keyUpHandler=function(t){var e=t.target,i=this.parent.element.querySelector(".e-datavalidation-dlg");if(H(e,".e-values")&&i&&t.keyCode!==13){var r=i.querySelector(".e-values"),n=r.querySelector(".e-dlg-error"),s=i.querySelector(".e-footer-content"),a=s.querySelector(".e-primary");a.hasAttribute("disabled")&&a.removeAttribute("disabled"),n&&r.removeChild(n)}},o.prototype.listOpen=function(t){var e=t.target;this.listObj&&e.classList.contains("e-cell")&&e.querySelector(".e-validation-list")&&this.parent.isEdit&&this.listObj.showPopup()},o.prototype.invalidDataHandler=function(t){var e={range:"",cancel:!1},i,r=t.isRemoveHighlight?Vb:jb;!t.isPublic&&(i={eventArgs:e,action:r},this.parent.notify(hi,i),e.cancel)||(this.parent.notify(r,{range:e.range,isAction:!0}),t.isPublic||(i.preventAction=!0,this.parent.notify(wt,i)))},o.prototype.listHandler=function(){var t=this.parent.getActiveSheet(),e=xe(t.activeCell),i=Q(e[0],e[1],t),r=this.parent.getCell(e[0],e[1]);if(r){this.removeListDropdownHandler(this.parent.element.getElementsByClassName("e-validation-list")[0]);var n=i&&i.validation||t.columns&&t.columns[e[1]]&&t.columns[e[1]].validation;if(n&&n.type==="List"){if(n.address&&!Tz(n.address,e[0],e[1]))return;this.addListValidationDropdownHandler({cell:i,validation:n,td:r,rowIdx:e[0],colIdx:e[1]})}i&&i.validation&&(i.validation=n)}},o.prototype.removeListDropdownHandler=function(t,e){if(t){if(this.listObj&&this.listObj.destroy(),Qe(t),e)e.isRefresh&&this.updateNoteIndicator(e.td,e.rowIdx,e.colIdx);else if(!g(this.parent.selectionModule.previousActiveCell)){var i=xe(this.parent.selectionModule.previousActiveCell),r=this.parent.getCell(i[0],i[1]);r&&this.updateNoteIndicator(r,i[0],i[1])}}},o.prototype.addListValidationDropdownHandler=function(t){var e=this;if(t.updatePosition){this.updateTopPosition({ddlCont:t.ddlCont,rowIdx:t.rowIdx,colIdx:t.colIdx});return}var i=t.validation.inCellDropDown;if(t.isRefresh){if(!t.td&&(t.td=this.parent.getCell(t.rowIdx,t.colIdx),!t.td)||(this.removeListDropdownHandler(t.td.querySelector(".e-validation-list"),t),t.validation.type!=="List"))return;g(i)&&(i=!0)}else g(t.validation.ignoreBlank)&&(t.validation.ignoreBlank=!0),g(i)&&(i=t.validation.inCellDropDown=!0);if(i){var r=this.parent.createElement("div",{className:"e-validation-list"+(this.parent.enableRtl?" e-rtl":"")}),n=this.parent.createElement("input",{id:this.parent.element.id+"listValid"});r.appendChild(n);var s,a=t.td,l=a.getElementsByClassName("e-wrap-content")[0]||a;this.updateTopPosition({ddlCont:r,rowIdx:t.rowIdx,colIdx:t.colIdx}),this.listValidationHeightHandler({ddlCont:r}),l.insertBefore(r,l.firstChild);var h=t.validation.value1;(!t.cell||!t.cell.validation)&&h.startsWith("=")&&(h=ln([t.rowIdx,t.colIdx,t.rowIdx,t.colIdx],[0,t.colIdx,0,t.colIdx],this.parent.getActiveSheet(),this.parent,{formula:h},null,!0));var c=this.getListDataSource(h);this.listObj=new $s({index:this.setDropDownListIndex(c,t.cell),dataSource:c,fields:{text:"text",value:"id"},width:"0px",popupHeight:"200px",noRecordsTemplate:"",change:function(){return e.listValueChange(e.listObj.text)},enableRtl:this.parent.enableRtl,beforeOpen:function(){s=window.browserDetails.isDevice,s&&(window.browserDetails.isDevice=!1)},open:function(u){u.popup.offsetX=e.parent.enableRtl?a.offsetWidth-24:-a.offsetWidth+24,u.popup.offsetY=-(a.querySelector(".e-control-wrapper.e-ddl").offsetHeight-18),u.popup.element.style.width=a.offsetWidth-1+"px",s&&(window.browserDetails.isDevice=!0)},close:function(u){u.event&&(u.event.keyCode===13||u.event.altKey&&u.event.keyCode===38)&&(u.event.preventDefault(),u.event.stopPropagation()),Re(e.parent.element)}}),this.listObj.appendTo(n),this.updateNoteIndicator(a,t.rowIdx,t.colIdx)}},o.prototype.updateTopPosition=function(t){var e=this.parent.getActiveSheet(),i=Q(t.rowIdx,t.colIdx,e);i&&i.style&&i.style.fontSize&&parseFloat(i.style.fontSize)>11?t.ddlCont.style.top=parseFloat(i.style.fontSize)-11+"pt":t.ddlCont.style.top&&(t.ddlCont.style.top="")},o.prototype.listValidationHeightHandler=function(t){var e=this.parent.getActiveSheet(),i=xe(e.activeCell),r=Q(i[0],i[1],e),n=r&&r.validation||e.columns&&e.columns[i[1]]&&e.columns[i[1]].validation;if(n&&n.type==="List"&&n.inCellDropDown){var s=ei(e,i[0],!0)-_0(i[0],i[1],e);if(s<=18){var a=t.ddlCont||this.parent.element.querySelector(".e-validation-list");a&&(a.style.height=s+"px")}else if(!t.ddlCont){var a=this.parent.element.querySelector(".e-validation-list");a&&a.style.removeProperty("height")}}},o.prototype.setDropDownListIndex=function(t,e){if(e&&!g(e.value)){for(var i=e.value.toString(),r=De(i),n=r&&Ki(this.parent.locale),s=0,a=t.length;s<a;s++)if(t[s].text===i||r&&this.parseValidationValue(t[s].text,n).toString()===i)return s}return null},o.prototype.getListDataSource=function(t){var e=this,i=[],r=0,n=this.parent.definedNames,s=t,a=s.startsWith("=");if(n.length>0&&a){for(var l=s.split("=")[1],h=0,c=n.length;h<c;h++)if(n[h].name===l){for(var u=n[h].refersTo;u.includes("'");)u=u.replace("'","");s=u}}if(a){var d=void 0,p=void 0,f=void 0,v=s.lastIndexOf("!");v>-1?(f=s.substring(1,v),p=s.substring(v+1),f.startsWith("'")&&f.endsWith("'")&&(f=f.substring(1,f.length-1)),d=ke(this.parent,Ct(this.parent,f))):(d=this.parent.getActiveSheet(),p=s.substring(1));var m=this.parent.getActiveSheet();if(d){if(d.name!==m.name){var y,b=ie(m.selectedRange);d.ranges.forEach(function(N){if(!N.info||!N.info.loadedRange||!N.info.loadedRange.length){y=!0;return}}),y&&(this.parent.showSpinner(),Aa(this.parent,d.name+"!"+p).then(function(){if(e.parent.hideSpinner(),m.name===e.parent.getActiveSheet().name){var N=ie(e.parent.getActiveSheet().selectedRange);if(N[0]===b[0]&&N[1]===b[1]){var R=e.getListDataSource(t);e.listObj.dataSource=R;var P=Q(N[0],N[1],m);e.listObj.index=e.setDropDownListIndex(R,P),e.listObj.dataBind()}}}))}var S=void 0,C=p.split(":");if(C[0]&&C[1]&&(C[0].match(/[a-z]+$/ig)&&C[1].match(/[a-z]+$/ig)||C[0].match(/^[0-9]/g)&&C[1].match(/^[0-9]/g))){var x=this.parent.getIndexes(p);x.isCol?S=[0,x.startIdx,d.usedRange.rowIndex,x.startIdx]:S=[x.startIdx,0,x.startIdx,d.usedRange.colIndex]}else S=ie(p);for(var I=void 0,D=void 0,M=S[0];M<=S[2];M++){d.rows[M]||Cs(d,M,{});for(var E=S[1];E<=S[3];E++){d.rows[M].cells||Zt(M,E,d,{}),I=d.rows[M].cells[E];var A=this.parent.getDisplayText(I)||"";A?(r+=1,i.push({text:A,id:"list-"+r})):D||(D=!0,r+=1,i.push({text:A,id:"list-"+r}))}}}}else for(var L=this.getListOfValues(s),h=0;h<L.length;h++)r+=1,i.push({text:L[h],id:"list-"+r});return i},o.prototype.listValueChange=function(t){var e=this.parent.getActiveSheet(),i=Ji(e.activeCell),r=Object.assign({},Q(i[0],i[1],e));if(e.isProtected&&mn(r,Ht(e,i[1])))this.parent.notify(Ra,null);else if(Pl(r,Ht(e,i[1]),Yr(e,i[0])))this.parent.notify(fr,null);else{this.parent.isEdit&&this.parent.closeEdit();var n={value:t,oldValue:r.value,address:e.name+"!"+e.activeCell,cancel:!1};if(this.parent.notify(hi,{action:"cellSave",eventArgs:n}),n.cancel)return;var s={value:t,formula:""};if(r.format&&Bs(r.format)&&!De(t)){var a={formattedText:t,value:t,format:"General",cell:{value:t,format:"General"},isEdit:!0};this.parent.notify(yr,a),a.format!=="General"&&["Currency","Percentage"].indexOf(en(a.format))>-1&&(s.format=a.format,s.value=a.value)}var l=gr(this.parent,e,{cell:s,rowIdx:i[0],colIdx:i[1],valChange:!0,lastCell:!0,checkCF:!0,uiRefresh:!0});if(!l){var h=Q(i[0],i[1],e,!1,!0);delete h.formula,this.parent.notify(ho,{action:"refreshFormulabar",cell:h}),this.parent.notify(Hs,null),this.parent.notify(wt,{action:"cellSave",eventArgs:{value:t,oldValue:r.value,address:e.name+"!"+e.activeCell}})}}},o.prototype.getRange=function(t){var e=ie(t),i=this.parent.getActiveSheet(),r=i.rowCount,n;return e[2]===r-1&&e[0]===0&&(t=t.replace(/[0-9]/g,""),n=!0),{range:t,isColSelected:n}},o.prototype.initiateDataValidationHandler=function(){var t=this,e=this.parent.getActiveSheet(),i=ie(e.selectedRange),r=i[0],n=i[1],s,a;i[2]>=i[0]?(s=function(){return r<=i[2]},a=function(){r++}):(s=function(){return r>=i[2]},a=function(){r--});var l,h;i[3]>=i[1]?(l=function(){return n<=i[3]},h=function(){n++}):(l=function(){return n>=i[3]},h=function(){n--});var c,u,d,p,f,v,m,y=function(A,L){if(v){var N=ln(A,L,e,t.parent,{formula:p.value1},null,!0);N.includes("#REF!")||(p.value1=N)}if(m){var N=ln(A,L,e,t.parent,{formula:p.value2},null,!0);N.includes("#REF!")||(p.value2=N)}};for(r;s();a()){for(n;l();h())if(c=Q(r,n,e,!1,!0),f=c.validation||hs(e.columns[n],r,n)&&e.columns[n].validation,f)if(p){if(f.type!==p.type||f.operator!==p.operator||(!v||!pt(f.value1))&&f.value1!==p.value1||(!m||!pt(f.value2))&&f.value2!==p.value2){u=!0;break}}else{p=Object.assign({},f),v=pt(p.value1),m=pt(p.value2),c.validation||y([r,n,r,n],[0,n,0,n]);var b=ie(e.activeCell);(r!==b[0]||n!==b[1])&&y(b,[r,n,r,n])}else d=!0;n=i[1]}var S=this.parent.serviceLocator.getService(ve),C=this.parent.serviceLocator.getService(jt),x=function(A){if(!t.parent.element.querySelector(".e-datavalidation-dlg")){var L=t.getRange(e.selectedRange).range;C.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-datavalidation-dlg",enableRtl:t.parent.enableRtl,header:S.getConstant("DataValidation"),beforeOpen:function(N){var R={dialogName:"ValidationDialog",element:N.element,target:N.target,cancel:N.cancel};t.parent.trigger("dialogBeforeOpen",R),R.cancel?N.cancel=!0:(C.dialogInstance.content=t.dataValidationContent(S,L,A),C.dialogInstance.dataBind(),Re(t.parent.element))},beforeClose:t.dialogBeforeClose.bind(t),buttons:[{buttonModel:{content:S.getConstant("ClearAll"),cssClass:"e-btn e-clearall-btn e-flat"},click:function(){C.dialogInstance.content=t.dataValidationContent(S,L),C.dialogInstance.dataBind()}},{buttonModel:{content:S.getConstant("Apply"),isPrimary:!0},click:function(){t.dlgClickHandler(C)}}]})}};if(u||p&&d){var I,D=[{buttonModel:{isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){C.hide(!0),x()}}];u?(I="MoreValidation",D[0].buttonModel.content=S.getConstant("Ok")):(I="ExtendValidation",D[0].buttonModel.content=S.getConstant("No"),D.splice(0,0,{buttonModel:{content:S.getConstant("Yes"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){C.hide(!0),x(p)}}));var M=S.getConstant(I),E={width:350,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:S.getConstant("Spreadsheet"),content:M,enableRtl:this.parent.enableRtl,beforeOpen:function(A){var L={dialogName:I,element:A.element,target:A.target,cancel:A.cancel,content:M};t.parent.trigger("dialogBeforeOpen",L),L.cancel?A.cancel=!0:(L.content!==M&&(C.dialogInstance.content=L.content,C.dialogInstance.dataBind()),Re(t.parent.element))},buttons:D};C.show(E)}else x(p)},o.prototype.dataValidationContent=function(t,e,i){var r=this,n,s,a,l=!i,h,c;if(l)n=s="0",c=!0;else{var u=i.value1,d=i.value2;if(a=i.type,h=i.operator,c=i.ignoreBlank!==!1,a==="Date"||a==="Time"){var p=function(ne){if(De(ne)){var le={cell:{value:ne},type:a.toLowerCase(),value:ne};return r.parent.notify(Fb,le),le.value}return ne};n=p(u),s=p(d)}else{var f=function(ne){if(De(ne)){ne=ne.toString();var le=Ki(r.parent.locale);le.decimal!=="."&&ne.includes(".")&&(ne=ne.replace(".",le.decimal))}return ne};n=f(u),s=f(d)}}var v=this.parent.createElement("div",{className:"e-validation-dlg"}),m=this.parent.createElement("div",{className:"e-cellrange"}),y=this.parent.createElement("div",{className:"e-allowdata"}),b=this.parent.createElement("div",{className:"e-values"}),S=this.parent.createElement("div",{className:"e-ignoreblank"});this.divElements.push(v),this.divElements.push(m),this.divElements.push(y),this.divElements.push(b),this.divElements.push(S),v.appendChild(m),v.appendChild(y),v.appendChild(b),v.appendChild(S);var C=this.parent.createElement("span",{className:"e-header"});C.innerText=t.getConstant("CellRange");var x=this.parent.createElement("input",{className:"e-input",attrs:{value:e,"aria-label":t.getConstant("CellRange")}});m.appendChild(C),m.appendChild(x);var I=this.parent.createElement("div",{className:"e-allow"}),D=this.parent.createElement("div",{className:"e-data"});y.appendChild(I),y.appendChild(D);var M=this.parent.createElement("span",{className:"e-header"});M.innerText=t.getConstant("Allow"),this.typeData=[{text:t.getConstant("WholeNumber"),id:"type-1"},{text:t.getConstant("Decimal"),id:"type-2"},{text:t.getConstant("Date"),id:"type-3"},{text:t.getConstant("Time"),id:"type-4"},{text:t.getConstant("TextLength"),id:"type-5"},{text:t.getConstant("List"),id:"type-6"},{text:t.getConstant("Custom"),id:"type-7"}],this.operatorData=[{text:t.getConstant("Between"),id:"operator-1"},{text:t.getConstant("NotBetween"),id:"operator-2"},{text:t.getConstant("EqualTo"),id:"operator-3"},{text:t.getConstant("NotEqualTo"),id:"operator-4"},{text:t.getConstant("GreaterThan"),id:"operator-5"},{text:t.getConstant("LessThan"),id:"operator-6"},{text:t.getConstant("GreaterThanOrEqualTo"),id:"operator-7"},{text:t.getConstant("LessThanOrEqualTo"),id:"operator-8"}];var E=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(C),this.inputElements.push(x),this.divElements.push(I),this.divElements.push(D),this.spanElements.push(M),this.inputElements.push(E);var A=0;if(!l){a&&(a=this.formattedType(a));for(var L=0;L<this.typeData.length;L++)if(a===this.formattedType(this.typeData[L].text)){A=L;break}}if(l||a!=="List"&&a!=="Custom"){var N=0,R=this.parent.createElement("span",{className:"e-header"});R.innerText=t.getConstant("Data");var P=this.parent.createElement("input",{className:"e-select"});if(!l){for(var L=0;L<this.operatorData.length;L++)if(h===this.formattedValue(this.operatorData[L].text)){N=L;break}}D.appendChild(R),D.appendChild(P),this.spanElements.push(R),this.inputElements.push(P),this.dataList=new $s({dataSource:this.operatorData,enableRtl:this.parent.enableRtl,index:N,popupHeight:"200px",change:this.userInput.bind(this)}),this.dropDownListElements.push(this.dataList),this.dataList.appendTo(P)}else if(a!=="Custom"){var k=this.parent.createElement("input",{className:"e-checkbox"});D.appendChild(k);var B=new ma({label:t.getConstant("InCellDropDown"),checked:i.inCellDropDown!==!1,enableRtl:this.parent.enableRtl});this.checkBoxElements.push(B),B.appendTo(k),this.inputElements.push(k)}I.appendChild(M),I.appendChild(E),this.typeList=new $s({dataSource:this.typeData,enableRtl:this.parent.enableRtl,index:A,popupHeight:"200px",change:this.userInput.bind(this)}),this.dropDownListElements.push(this.typeList),this.typeList.appendTo(E);var F=function(ne,le){var $=r.parent.createElement("span",{className:"e-header"});$.innerText=ne;var ee=r.parent.createElement("input",{className:"e-input",attrs:{value:le}});b.appendChild($),b.appendChild(ee),r.spanElements.push($),r.inputElements.push(ee)};if(l||this.typeList.value!==t.getConstant("List")&&this.typeList.value!==t.getConstant("Custom")&&(this.dataList.value===t.getConstant("Between")||this.dataList.value===t.getConstant("NotBetween"))){var O=this.parent.createElement("div",{className:"e-minimum"}),z=this.parent.createElement("div",{className:"e-maximum"});b.appendChild(O),b.appendChild(z);var Y=this.parent.createElement("span",{className:"e-header"});Y.innerText=t.getConstant("Minimum");var K=this.parent.createElement("span",{className:"e-header"});K.innerText=t.getConstant("Maximum");var U=this.parent.createElement("input",{id:"minvalue",className:"e-input",attrs:{value:n,"aria-label":t.getConstant("Minimum")}}),q=this.parent.createElement("input",{id:"maxvalue",className:"e-input",attrs:{value:s,"aria-label":t.getConstant("Maximum")}});O.appendChild(Y),O.appendChild(U),z.appendChild(K),z.appendChild(q),this.divElements.push(O),this.divElements.push(z),this.spanElements.push(Y),this.spanElements.push(K),this.inputElements.push(U),this.inputElements.push(q);var ae=new ba({value:0,enableRtl:this.parent.enableRtl});this.numericTextBoxElements.push(ae),ae.appendTo("#minvalue");var te=new ba({value:0,enableRtl:this.parent.enableRtl});this.numericTextBoxElements.push(te),te.appendTo("#maxvalue")}else F(!l&&a==="List"?t.getConstant("Sources"):!l&&a==="Custom"?t.getConstant("Formula"):t.getConstant("Value"),n);var he=this.parent.createElement("input",{className:"e-checkbox"});S.appendChild(he);var ue=new ma({label:t.getConstant("IgnoreBlank"),checked:c,enableRtl:this.parent.enableRtl});return this.checkBoxElements.push(ue),ue.appendTo(he),this.inputElements.push(he),v},o.prototype.dialogBeforeClose=function(){this.checkBoxElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.checkBoxElements=[],this.numericTextBoxElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.numericTextBoxElements=[],this.dropDownListElements.forEach(function(t){t&&t.element&&(t.destroy(),t.element.remove())}),this.dropDownListElements=[],ws(this.spanElements),this.spanElements=[],ws(this.inputElements),this.inputElements=[],ws(this.divElements),this.divElements=[]},o.prototype.userInput=function(){var t=this.typeList,e=this.dataList,i=this.parent.element.querySelector(".e-datavalidation-dlg"),r=i.querySelector(".e-validation-dlg"),n=r.querySelector(".e-allowdata"),s=r.querySelector(".e-values"),a=this.parent.serviceLocator.getService(ve),l=n.querySelector(".e-data"),h=function(M){for(;M.lastChild;)M.removeChild(M.lastChild)};if(h(s),t.value===a.getConstant("List")){h(l);var c=this.parent.createElement("input",{className:"e-checkbox"});this.inputElements.push(c),l.appendChild(c);var u=new ma({label:a.getConstant("InCellDropDown"),checked:!0,enableRtl:this.parent.enableRtl});this.checkBoxElements.push(u),u.appendTo(c)}else if(t.value===a.getConstant("Custom"))h(l);else if(!l.childElementCount||l.getElementsByClassName("e-checkbox-wrapper")[0]){h(l);var d=this.parent.createElement("span",{className:"e-header"});d.innerText=a.getConstant("Data");var p=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(d),this.inputElements.push(p),l.appendChild(d),l.appendChild(p),e.appendTo(p)}if(t.value!==a.getConstant("List")&&t.value!==a.getConstant("Custom")&&(e.value===a.getConstant("Between")||e.value===a.getConstant("NotBetween"))){var f=this.parent.createElement("div",{className:"e-minimum"}),v=this.parent.createElement("div",{className:"e-maximum"});this.divElements.push(f),this.divElements.push(v),s.appendChild(f),s.appendChild(v);var m=this.parent.createElement("span",{className:"e-header"});m.innerText=a.getConstant("Minimum");var y=this.parent.createElement("span",{className:"e-header"});y.innerText=a.getConstant("Maximum");var b=this.parent.createElement("input",{id:"min",className:"e-input",attrs:{value:"0"}}),S=this.parent.createElement("input",{id:"max",className:"e-input",attrs:{value:"0"}});this.spanElements.push(m),this.spanElements.push(y),this.inputElements.push(b),this.inputElements.push(S);var C=new ba({value:0,enableRtl:this.parent.enableRtl});this.numericTextBoxElements.push(C),C.appendTo("min");var x=new ba({value:0,enableRtl:this.parent.enableRtl});this.numericTextBoxElements.push(x),x.appendTo("max"),f.appendChild(m),f.appendChild(b),v.appendChild(y),v.appendChild(S)}else{var I=this.parent.createElement("span",{className:"e-header"});I.innerText=t.value===a.getConstant("List")?a.getConstant("Sources"):t.value===a.getConstant("Custom")?a.getConstant("Formula"):a.getConstant("Value");var D=t.value===a.getConstant("List")?this.parent.createElement("input",{className:"e-input",attrs:{placeholder:"Enter value"}}):this.parent.createElement("input",{className:"e-input",attrs:{value:"0"}});this.spanElements.push(I),this.inputElements.push(D),s.appendChild(I),s.appendChild(D)}},o.prototype.dlgClickHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r,n=this.parent.element.querySelector(".e-datavalidation-dlg"),s=n.querySelector(".e-footer-content"),a=n.getElementsByClassName("e-dlg-content")[0].getElementsByClassName("e-validation-dlg")[0],l=a.getElementsByClassName("e-allowdata")[0],h=l.getElementsByClassName("e-allow")[0].getElementsByTagName("input")[0],c=l.getElementsByClassName("e-data")[0].getElementsByTagName("input")[0],u=a.getElementsByClassName("e-values")[0],d=[];d[0]=u.getElementsByTagName("input")[0].value,d[1]=u.getElementsByTagName("input")[1]?u.getElementsByTagName("input")[1].value:"";var p=this.formattedType(h.value),f=!0,v=a.querySelector(".e-ignoreblank .e-checkbox").checked,m=l.querySelector(".e-data").querySelector(".e-checkbox-wrapper")?!!l.querySelector(".e-data").querySelector(".e-checkbox-wrapper").querySelector(".e-check"):null,y=a.querySelector(".e-cellrange").getElementsByTagName("input")[0].value,b;c&&(b=this.formattedValue(c.value));var S=[];if(p==="List")if(d[0]!==""&&S.push(d[0]),d[0].startsWith("=")){var C=d[0].substring(1),x=this.parent.definedNames.find(function(Y){return Y.name===C});x&&(C=x.refersTo.substring(1));var I=void 0,D=void 0;if(C.includes("!")){D=C.lastIndexOf("!");var M=C.substring(0,D);C=C.substring(D+1),M.startsWith("'")&&M.endsWith("'")&&(M=M.substring(1,M.length-1)),I=Ct(this.parent,M)>-1,x||(S[0]="="+M+"!"+C)}else I=!0;!C.includes(":")&&Or(C)&&(C=C+":"+C);var E=void 0;if(I){var A=C.split(":");A.length===2&&(E=C.match(/[a-z]/gi)&&A[0].replace(/[0-9]/g,"")===A[1].replace(/[0-9]/g,"")||C.match(/\d/g)&&A[0].replace(/\D/g,"")===A[1].replace(/\D/g,""))}f=E,f||(r=!x&&D===void 0&&!C.includes(":")?i.getConstant("NamedRangeError"):i.getConstant("DialogError"))}else d[0].length>256&&(f=!1,r=i.getConstant("ListLengthError"));else{var L=Ki(this.parent.locale);if(p==="Decimal"&&L.decimal!=="."){var N=function(Y){return De(Y)&&Y.includes(".")&&(L.group!=="."||!Gd(Y,e.parent.locale,L.group,L.decimal))};(N(d[0])||N(d[1]))&&(f=!1,r=i.getConstant("InvalidNumberError"))}Td(d,this.parent,L),d[0]!==""&&S.push(d[0]),d[1]!==""&&S.push(d[1])}if(f){var R=this.parent.getActiveSheet(),P=this.isDialogValidator(S,p,b);if(b==="Between"&&P.isValid&&!isNaN(parseFloat(S[0]))&&!isNaN(parseFloat(S[1]))&&parseFloat(S[0])>parseFloat(S[1])&&(P.isValid=!1,P.errorMsg=i.getConstant("MinMaxError")),p==="Custom"&&pt(S[0])){var k=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!","#CALC!"],B={value:S[0]};this.parent.notify(zc,B);var F=B.value;k.indexOf(F)>-1&&(P.isValid=!1,P.errorMsg=i.getConstant("InvalidFormula"))}if(r=P.errorMsg,f=P.isValid,f){if(Hi(this.parent,tt(ie(y)))){t.hide(!0),this.parent.notify(fr,null);return}var O={range:R.name+"!"+y,value1:S[0],value2:S[1]||"",ignoreBlank:v,type:p,operator:b,inCellDropDown:m,cancel:!1};this.parent.notify(hi,{eventArgs:O,action:"validation"}),O.cancel||(this.parent.notify(Qo,{rules:{type:O.type,operator:O.operator,value1:O.value1,value2:O.value2,ignoreBlank:O.ignoreBlank,inCellDropDown:O.inCellDropDown},range:O.range,isAction:!0}),delete O.cancel,this.parent.element.getElementsByClassName("e-validation-error-dlg")[0]||(t.dialogInstance?t.dialogInstance.hide():t.hide()),this.parent.notify(wt,{eventArgs:O,action:"validation"}))}}if(!f){var z=this.parent.createElement("div",{className:"e-dlg-error",id:"e-invalid"});z.innerText=r,u.appendChild(z),s.querySelector(".e-primary").setAttribute("disabled","true")}},o.prototype.formattedValue=function(t){var e=this.parent.serviceLocator.getService(ve);switch(t){case e.getConstant("Between"):t="Between";break;case e.getConstant("NotBetween"):t="NotBetween";break;case e.getConstant("EqualTo"):t="EqualTo";break;case e.getConstant("NotEqualTo"):t="NotEqualTo";break;case e.getConstant("GreaterThan"):t="GreaterThan";break;case e.getConstant("LessThan"):t="LessThan";break;case e.getConstant("GreaterThanOrEqualTo"):t="GreaterThanOrEqualTo";break;case e.getConstant("LessThanOrEqualTo"):t="LessThanOrEqualTo";break;default:t="Between";break}return t},o.prototype.formattedType=function(t){var e=this.parent.serviceLocator.getService(ve);switch(t){case e.getConstant("WholeNumber"):t="WholeNumber";break;case e.getConstant("Decimal"):t="Decimal";break;case e.getConstant("Date"):t="Date";break;case e.getConstant("TextLength"):t="TextLength";break;case e.getConstant("List"):t="List";break;case e.getConstant("Time"):t="Time";break;case e.getConstant("Custom"):t="Custom";break}return t},o.prototype.isDialogValidator=function(t,e,i){var r=this.parent.serviceLocator.getService(ve),n=0,s=!1,a;if(e==="List"?s=!(t.length>0):i==="Between"||i==="NotBetween"?s=t.length!==2:s=!(t.length>0),s)return{isValid:!1,errorMsg:r.getConstant("EmptyError")};for(var l=void 0,h=0;h<t.length;h++){if(pt(t[h])){var c={value:t[h]};this.parent.notify(zc,c),l=c.value}else e==="Date"||e==="Time"?l=t[h]=this.getDateAsNumber({range:[],cell:{value:t[h]}},t[h]):l=t[h];if(a=this.formatValidation(l,e,!0),a.isValid)n=n+1;else break}return a.isValid=n===t.length,a},o.prototype.getDateAsNumber=function(t,e){var i={value:e,rowIndex:t.range[0],cell:t.cell,colIndex:t.range[1],sheetIndex:t.sheetIdx,updatedVal:""};return this.parent.notify(Jr,i),i.updatedVal||e},o.prototype.getListOfValues=function(t){var e;return this.parent.listSeparator!==","&&t.includes(this.parent.listSeparator)?e=t.split(this.parent.listSeparator):e=t.split(","),e},o.prototype.checkValidationHandler=function(t,e){var i=t.value.toString(),r=this.parent.sheets[t.sheetIdx],n=Q(t.range[0],t.range[1],r,null,!0),s=e.value1,a=e.value2;if(!n.validation){var l=t.range,h=[0,t.range[1],0,t.range[3]];pt(s)&&(s=ln(l,h,r,this.parent,{formula:s},null,!0)),pt(a)&&(a=ln(l,h,r,this.parent,{formula:a},null,!0))}if(e.type!=="List"){if(pt(s)){var c={value:s};this.parent.notify(zc,c),s=c.value}if(pt(a)){var u={value:a};this.parent.notify(zc,u),a=u.value}if(pt(t.value)){var d={value:t.value};this.parent.notify(zc,d),t.value=d.value}}var p=t.value,f=e.operator||"Between",v=e.type||"WholeNumber",m=g(e.ignoreBlank)?!0:e.ignoreBlank;if(i==="")return m;var y=v==="Date"||v==="Time";if(t.value)if(y||e.type==="TextLength")De(t.value)||(p=t.value=this.getDateAsNumber(t,t.value));else{var b=t.isEdit&&Ki(this.parent.locale),S=this.parseValidationValue(t.value,b);S!==t.value&&De(S)&&(p=t.value=S.toString())}var C=this.formatValidation(t.value,v).isValid;if(C)if(C=!1,y?(s&&!De(s)&&(s=this.getDateAsNumber(t,s)),a&&!De(a)&&(a=this.getDateAsNumber(t,a))):e.type==="TextLength"&&(p=t.value.toString().length.toString()),v==="List"){var x=t.value.toString(),I=De(x),b=I&&Ki(this.parent.locale);if(s.startsWith("=")){for(var D=void 0,M=this.getListDataSource(s),E=0;E<M.length;E++)if(D=M[E].text.toString(),i===D||x===D||I&&x===this.parseValidationValue(D,b).toString()){C=!0;break}}else for(var A=this.getListOfValues(s),E=0;E<A.length;E++)if(i===A[E]||x===A[E]||I&&x===this.parseValidationValue(A[E],b).toString()){C=!0;break}!C&&m&&x===""&&(C=!0)}else if(v==="Custom"){var S=parseFloat(s.toString());if(De(S))if(S===0){var L={value:e.value1};this.parent.notify(zM,L),C=L.value===""}else C=!0;else s.toUpperCase()==="TRUE"?C=!0:C=!1;!C&&m&&s===""&&(C=!0)}else switch(v==="Decimal"||v==="Time"?(p=parseFloat(p.toString()),s=parseFloat(s.toString()),a=a?parseFloat(a.toString()):null):(p=parseInt(p.toString(),10),s=parseInt(s.toString(),10),a=a?parseInt(a.toString(),10):null),f){case"EqualTo":C=p===s;break;case"NotEqualTo":C=p!==s;break;case"Between":C=p>=s&&p<=a;break;case"NotBetween":C=!(p>=s&&p<=a);break;case"GreaterThan":C=p>s;break;case"LessThan":C=p<s;break;case"GreaterThanOrEqualTo":C=p>=s;break;case"LessThanOrEqualTo":C=p<=s;break}return C},o.prototype.parseValidationValue=function(t,e){if(De(t))return e&&e.group==="."&&(t=t.toString(),t.indexOf(".")&&Gd(t,this.parent.locale,e.group,e.decimal)&&(t=t.split(e.group).join(""))),t;var i={formattedText:t,value:t,format:"General",cell:{value:t,format:"General"},isEdit:!!e};return this.parent.notify(yr,i),i.value},o.prototype.isValidCellHandler=function(t){var e=this.parent.sheets[t.sheetIdx],i=Q(t.range[0],t.range[1],e),r={skip:!1,value:""},n=i&&i.validation;if(n){if(pt(n.value1)&&!Or(n.value1.substring(1,n.value1.length))&&n.value1.indexOf("(")>-1){var s=n.value1;s=s.substring(s.indexOf("=")+1,s.indexOf("(")),r.value=s.toUpperCase(),this.parent.notify(zb,r)}if(!r.skip&&pt(n.value2)&&!Or(n.value2.substring(1,n.value2.length))&&n.value1.indexOf("(")>-1){var a=n.value2;a=a.substring(a.indexOf("=")+1,a.indexOf("(")),r.value=a.toUpperCase(),this.parent.notify(zb,r)}}if(!r.skip&&(t.value=g(t.value)?"":t.value,n?(t.isValid=this.checkValidationHandler(t,n),t.isValid&&hs(e.columns[t.range[1]],t.range[0],t.range[1])&&(n=e.columns[t.range[1]].validation,t.isValid=this.checkValidationHandler(t,n))):hs(e.columns[t.range[1]],t.range[0],t.range[1])&&(n=e.columns[t.range[1]].validation,t.isValid=this.checkValidationHandler(t,n)),n)){var l=void 0;t.isEdit&&!t.isValid&&(t.isValid=l=this.validationErrorHandler(this.parent.serviceLocator.getService(ve).getConstant("ValidationError"))),t.isValid&&n.isHighlighted&&!lt(e,t.range[0])&&!Ft(e,t.range[1])&&this.updateHighlightHandler({rowIdx:t.range[0],colIdx:t.range[1],isRemoveHighlightedData:!l,isRemoveValidation:!0})}},o.prototype.formatValidation=function(t,e,i){var r=this.parent.element.getElementsByClassName("e-sheet-panel")[0],n,s=this.parent.createElement("form",{id:"formId",className:"form-horizontal"}),a=this.parent.createElement("input",{id:"e-validation"});if(a.setAttribute("name","validation"),a.setAttribute("type","text"),e==="Date"&&De(t)){var l=t.toString().split(".");l.length===2&&(t=l[0])}a.setAttribute("value",t),s.appendChild(a),r.appendChild(s);var h;switch(e){case"Date":h={rules:{validation:{date:!0}},customPlacement:function(u,d){n=d.innerText}};break;case"Decimal":h={rules:{validation:{number:!0}},customPlacement:function(u,d){n=d.innerText}};break;case"WholeNumber":h={rules:{validation:{regex:/^-?\d*\.?[0]*$/}},customPlacement:function(u,d){n=d.innerText}};break;case"TextLength":i&&(h={rules:{validation:{regex:/^\d*\.?[0]*$/}},customPlacement:function(u,d){n=d.innerText}});break}this.formObj=new qx("#formId",h);var c=this.formObj.validate();return r.removeChild(r.getElementsByClassName("form-horizontal")[0]),{isValid:c,errorMsg:n}},o.prototype.updateHighlightHandler=function(t){var e;if(!t.isRemoveValidation){var i=t.cell?t.cell.value||t.cell.value===0?t.cell.value:t.cell.hyperlink?typeof t.cell.hyperlink=="string"?t.cell.hyperlink:t.cell.hyperlink.address||"":"":"",r={value:i,range:[t.rowIdx,t.colIdx],sheetIdx:this.parent.activeSheetIndex};e=this.checkValidationHandler(r,t.validation),e&&t.col&&hs(t.col,t.rowIdx,t.colIdx)&&(r.value=i,e=this.checkValidationHandler(r,t.col.validation))}if(e){if(t.removeOnValidData){var n=this.parent.getCell(t.rowIdx,t.colIdx);n&&n.style.backgroundColor&&(t.td=n,t.style=this.parent.getCellStyleValue(["backgroundColor","color"],[t.rowIdx,t.colIdx]),this.parent.notify(Mr,t),t.td=null)}}else t.isRemoveHighlightedData?(t.style=this.parent.getCellStyleValue(["backgroundColor","color"],[t.rowIdx,t.colIdx]),this.parent.notify(Mr,t)):(t.style={backgroundColor:"#ffff00",color:"#ff0000"},t.cell&&t.cell.hyperlink&&t.cell.style&&t.cell.style.color==="#551a8b"&&(t.style.color=t.cell.style.color),this.parent.notify(Mr,t))},o.prototype.validationErrorHandler=function(t){var e=this,i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0],r=this.parent.serviceLocator.getService(ve),n=!1;if(!this.parent.element.querySelector(".e-validation-error-dlg")){var s=this.parent.serviceLocator.getService(jt),a=!1,l={width:400,height:200,isModal:!0,showCloseIcon:!0,cssClass:"e-validation-error-dlg",target:document.getElementById(this.parent.element.id)||this.parent.element,beforeOpen:function(h){var c={dialogName:"ValidationErrorDialog",element:h.element,target:h.target,cancel:h.cancel,content:t};e.parent.trigger("dialogBeforeOpen",c),c.cancel&&(h.cancel=!0,n=!0),i.focus(),s.dialogInstance.content=c.content,s.dialogInstance.dataBind()},buttons:[{buttonModel:{content:r.getConstant("Retry"),isPrimary:!0},click:function(){e.errorDlgHandler(s,"Retry")}},{buttonModel:{content:r.getConstant("Cancel")},click:function(){e.errorDlgHandler(s,"Cancel")}}]};s.show(l,a)}return n},o.prototype.errorDlgHandler=function(t,e){if(e==="Retry"){var i=this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0];t.hide(),i.innerText&&(window.getSelection().selectAllChildren(i),this.listObj&&!this.listObj.isDestroyed&&this.listObj.showPopup())}else{var r=xe(this.parent.getActiveSheet().activeCell),n=Q(r[0],r[1],this.parent.getActiveSheet()),s=n?this.parent.getDisplayText(n):"";this.parent.notify(ui,{action:"cancelEdit",value:s,refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!1,trigEvent:!0}),t.hide()}},o.prototype.getModuleName=function(){return"dataValidation"},o})(),Y9=(function(){function o(t){this.parent=t,this.init()}return o.prototype.init=function(){this.addEventListener()},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(sg,this.protect,this),this.parent.on(Hc,this.protectSheetHandler,this),this.parent.on(aa,this.protectSheetHandler,this),this.parent.on(Ra,this.editProtectedAlert,this),this.parent.on(k0,this.protectWorkbook,this),this.parent.on(Ds,this.KeyUpHandler,this),this.parent.on(F0,this.unProtectWorkbook,this),this.parent.on(zD,this.unProtectSheetPassword,this),this.parent.on(FD,this.importProtectWorkbook,this),this.parent.on(ND,this.protectWorkbookHandler,this),this.parent.on(kD,this.removeWorkbookProtection,this),this.parent.on(B0,this.toggleProtect,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(sg,this.protect),this.parent.off(Hc,this.protectSheetHandler),this.parent.off(aa,this.protectSheetHandler),this.parent.off(Ra,this.editProtectedAlert),this.parent.off(k0,this.protectWorkbook),this.parent.off(Ds,this.KeyUpHandler),this.parent.off(F0,this.unProtectWorkbook),this.parent.off(zD,this.unProtectSheetPassword),this.parent.off(FD,this.importProtectWorkbook),this.parent.off(ND,this.protectWorkbookHandler),this.parent.off(kD,this.removeWorkbookProtection),this.parent.off(B0,this.toggleProtect))},o.prototype.protect=function(t){if(t.isActive){var e=this.parent.getActiveSheet();e.isImportProtected&&(e.isImportProtected=!1)}this.parent.notify($d,null),t.isActive?(this.parent.setSheetPropertyOnMute(ke(this.parent,t.sheetIndex),"isProtected",!1),this.parent.notify(Bc,{props:"Protect"}),this.parent.notify(Hc,t),this.parent.notify(I0,null)):this.createDialogue()},o.prototype.createDialogue=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=[{text:e.getConstant("SelectCells"),id:"1"},{text:e.getConstant("SelectUnlockedCells"),id:"6"},{text:e.getConstant("FormatCells"),id:"2"},{text:e.getConstant("FormatRows"),id:"3"},{text:e.getConstant("FormatColumns"),id:"4"},{text:e.getConstant("InsertLinks"),id:"5"}];this.optionList=new hf({dataSource:i,showCheckBox:!0,enableRtl:this.parent.enableRtl,select:this.dialogOpen.bind(this)});var r=this.parent.createElement("div",{className:"e-sheet-password-dialog"}),n=this.parent.createElement("div",{className:"e-sheet-password-content"}),s=this.parent.createElement("div",{className:"e-header"});s.innerText=e.getConstant("SheetPassword");var a=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});a.setAttribute("placeholder",e.getConstant("EnterThePassword")),n.appendChild(a),n.insertBefore(s,a),r.appendChild(n);var l=this.parent.createElement("div",{className:"e-protect-content"});l.innerText=e.getConstant("ProtectAllowUser"),this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(),"isProtected",!1);var h=new ma({checked:!0,label:e.getConstant("ProtectContent"),cssClass:"e-protect-checkbox",enableRtl:this.parent.enableRtl}),c=this.parent.createElement("div",{className:"e-protect-option-list",id:this.parent.element.id+"_option_list"}),u=this.parent.createElement("div",{className:"e-header-content"});u.innerText=e.getConstant("ProtectSheet");var d=this.parent.createElement("input",{id:this.parent.element.id+"_protect_check",attrs:{type:"checkbox"}}),p=this.parent.serviceLocator.getService("dialog"),f=function(){var m=Cr(document.getElementById(t.parent.element.id+"_protect_check"),ma);p.dialogInstance.element.querySelector(".e-footer-content .e-btn.e-primary").disabled=!m.checked},v;p.show({header:u.outerHTML,content:r.outerHTML+d.outerHTML+l.outerHTML+c.outerHTML,showCloseIcon:!0,isModal:!0,cssClass:"e-protect-dlg",enableRtl:this.parent.enableRtl,beforeOpen:function(m){var y={dialogName:"ProtectSheetDialog",element:m.element,target:m.target,cancel:m.cancel};t.parent.trigger("dialogBeforeOpen",y),y.cancel?v=m.cancel=!0:Re(t.parent.element)},beforeClose:function(){v||T.remove(h.element,"click",f)},buttons:[{click:this.selectOption.bind(this,p),buttonModel:{content:e.getConstant("Ok"),isPrimary:!0}},{click:function(){return p.hide()},buttonModel:{content:e.getConstant("Cancel")}}]},!1),v||(h.appendTo("#"+this.parent.element.id+"_protect_check"),this.optionList.appendTo("#"+this.parent.element.id+"_option_list"),this.optionList.selectMultipleItems([{id:"1"},{id:"6"}]),T.add(h.element,"click",f,this))},o.prototype.dialogOpen=function(t){var e=this.parent.serviceLocator.getService(ve);t.text===e.getConstant("SelectCells")&&t.isChecked&&t.isInteracted&&this.optionList.checkItem({id:"6"}),t.text===e.getConstant("SelectUnlockedCells")&&!t.isChecked&&t.isInteracted&&this.optionList.uncheckItem({id:"1"})},o.prototype.selectOption=function(t){var e=t.dialogInstance.element.querySelector(".e-sheet-password-content .e-input"),i=e.value;if(i)this.reEnterSheetPassword(i);else{var r=this.parent.getActiveSheet();this.parent.setSheetPropertyOnMute(r,"isProtected",!0),this.parent.setSheetPropertyOnMute(r,"password",i),this.updateProtectSheet(i),t.hide(),!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells?this.parent.notify(zh,null):r.protectSettings.selectUnLockedCells&&Ko(this.parent,ie(r.selectedRange))&&this.parent.notify(zh,null)}},o.prototype.applySheetPwd=function(t){var e=this.parent.getActiveSheet();this.parent.setSheetPropertyOnMute(e,"isProtected",!0),this.parent.setSheetPropertyOnMute(e,"password",t),this.updateProtectSheet(t),!e.protectSettings.selectCells&&!e.protectSettings.selectUnLockedCells&&this.parent.notify(zh,null)},o.prototype.updateProtectSheet=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.optionList.getSelectedItems(),r={selectCells:i.text.indexOf(e.getConstant("SelectCells"))>-1,formatCells:i.text.indexOf(e.getConstant("FormatCells"))>-1,formatRows:i.text.indexOf(e.getConstant("FormatRows"))>-1,formatColumns:i.text.indexOf(e.getConstant("FormatColumns"))>-1,insertLink:i.text.indexOf(e.getConstant("InsertLinks"))>-1,selectUnLockedCells:i.text.indexOf(e.getConstant("SelectUnlockedCells"))>-1};this.parent.notify(Dd,{protectSettings:r,password:t,triggerEvent:!0}),this.parent.notify(I0,null),this.parent.notify(Vh,null)},o.prototype.protectSheetHandler=function(t){var e=g(t&&t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,i=ke(this.parent,e),r=this.parent.element.id,n=[r+"_undo",r+"_redo",r+"_cut",r+"_copy",r+"_paste",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_merge_cells",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],s=[r+"_cut",r+"_copy",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"];if(this.parent.allowMerge){var a=ie(i.selectedRange);(a[0]!==a[2]||a[1]!==a[3])&&s.push(r+"_merge_cells")}var l=[r+"_insert_function"],h=[r+"_hyperlink",r+"_",r+"_chart"],c=[r+"_image"],u=[r+"_find"],d=[r+"_datavalidation"],p=[r+"_chart"],f=document.getElementById(this.parent.element.id+"_sheet_panel");f&&(i.isProtected&&(i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!Ko(this.parent,ie(i.selectedRange)))?f.classList.remove("e-protected"):f.classList.add("e-protected"),i.isProtected||f.classList.remove("e-protected")),this.parent.dataBind(),this.parent.notify(vD,{disableHomeBtnId:n,enableHomeBtnId:s,enableFrmlaBtnId:l,enableInsertBtnId:h,findBtnId:u,dataValidationBtnId:d,imageBtnId:c,chartBtnId:p}),this.parent.notify(SD,null),i.isProtected&&this.parent.notify(Bc,{props:"Protect"}),t&&t.triggerEvent&&this.parent.notify(wt,{action:"protectSheet",eventArgs:{sheetIndex:e,isProtected:i.isProtected,password:i.password,protectSettings:i.protectSettings.properties||i.protectSettings}})},o.prototype.editProtectedAlert=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService("dialog");i.show({content:e.getConstant("EditAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-editAlert-dlg",enableRtl:this.parent.enableRtl,beforeOpen:function(r){var n={dialogName:"EditAlertDialog",content:e.getConstant("EditAlert"),element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=n.content,Re(t.parent.element))},close:function(){return Re(t.parent.element)}})},o.prototype.protectWorkbook=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService(jt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-protectworkbook-dlg",enableRtl:this.parent.enableRtl,header:e.getConstant("ProtectWorkbook"),beforeOpen:function(r){var n={dialogName:"ProtectWorkbook",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=t.passwordProtectContent(),i.dialogInstance.dataBind(),Re(t.parent.element))},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){t.alertMessage(),t.dlgClickHandler(i)}}]})},o.prototype.passwordProtectContent=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("div",{className:"e-password-dialog"}),i=this.parent.createElement("div",{className:"e-password-content"}),r=this.parent.createElement("div",{className:"e-password-content"}),n=this.parent.createElement("div",{className:"e-header"});n.innerText=t.getConstant("Password");var s=this.parent.createElement("div",{className:"e-header"});s.innerText=t.getConstant("ConfirmPassword");var a=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}}),l=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return a.setAttribute("placeholder",t.getConstant("EnterThePassword")),l.setAttribute("placeholder",t.getConstant("EnterTheConfirmPassword")),i.appendChild(a),i.insertBefore(n,a),r.appendChild(l),r.insertBefore(s,l),e.appendChild(r),e.insertBefore(i,r),e},o.prototype.KeyUpHandler=function(t){var e=t.target;if(e.classList.contains("e-text")&&H(e,".e-password-content")&&H(e,".e-password-dialog")&&H(e,".e-password-dialog").getElementsByClassName("e-password-content")[1]===e.parentElement){var i=H(e,".e-protectworkbook-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;e.value!==""?n.removeAttribute("disabled"):n.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&H(e,".e-unprotectpwd-content")&&H(e,".e-unprotectpwd-dialog")&&H(e,".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0]===e.parentElement){var s=H(e,".e-unprotectworkbook-dlg"),a=s.getElementsByClassName("e-footer-content")[0],l=a.firstChild;e.value!==""?l.removeAttribute("disabled"):l.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&H(e,".e-reenterpwd-content")&&H(e,".e-reenterpwd-dialog")&&H(e,".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0]===e.parentElement){var h=H(e,".e-reenterpwd-dlg"),c=h.getElementsByClassName("e-footer-content")[0],u=c.firstChild;e.value!==""?u.removeAttribute("disabled"):u.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&H(e,".e-unprotectsheetpwd-content")&&H(e,".e-unprotectsheetpwd-dialog")&&H(e,".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0]===e.parentElement){var d=H(e,".e-unprotectworksheet-dlg"),p=d.getElementsByClassName("e-footer-content")[0],f=p.firstChild;e.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&H(e,".e-importprotectpwd-content")&&H(e,".e-importprotectpwd-dialog")&&H(e,".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0]===e.parentElement){var v=H(e,".e-importprotectworkbook-dlg"),m=v.getElementsByClassName("e-footer-content")[0],f=m.firstChild;e.value!==""?f.removeAttribute("disabled"):f.setAttribute("disabled","true")}},o.prototype.alertMessage=function(){var t=this.parent.element.querySelector(".e-pwd-alert-span"),e=this.parent.element.querySelector(".e-unprotectpwd-alert-span"),i=this.parent.element.querySelector(".e-importprotectpwd-alert-span"),r=this.parent.element.querySelector(".e-reenterpwd-alert-span"),n=this.parent.element.querySelector(".e-unprotectsheetpwd-alert-span");t&&t.remove(),e&&e.remove(),i&&i.remove(),r&&r.remove(),n&&n.remove()},o.prototype.dlgClickHandler=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[1].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-pwd-alert-span"});i.value===r.value?(t.hide(),this.parent.notify(Bc,{props:"Protectworkbook"}),this.protectWorkbookHandler({password:i.value}),this.parent.notify(wt,{action:"protectWorkbook",eventArgs:{isProtected:!0,password:i.value}})):i.value===""?n.textContent=e.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=e.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=e.getConstant("PasswordAlert")),t.dialogInstance&&this.parent.element.querySelector(".e-protectworkbook-dlg").querySelector(".e-dlg-content").appendChild(n)},o.prototype.protectWorkbookHandler=function(t){this.parent.password=t.password,this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.notify(Bc,{props:"Protectworkbook"})},o.prototype.unProtectWorkbook=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService(jt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworkbook-dlg",enableRtl:this.parent.enableRtl,header:e.getConstant("UnprotectWorkbook"),beforeOpen:function(r){var n={dialogName:"UnprotectWorkbook",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:(i.dialogInstance.content=t.unProtectPasswordContent(),i.dialogInstance.dataBind(),Re(t.parent.element))},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage(),t.unprotectdlgOkClick(i)}}]})},o.prototype.unProtectsheet=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.serviceLocator.getService(jt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworksheet-dlg",enableRtl:this.parent.enableRtl,header:i.getConstant("UnprotectWorksheet"),beforeOpen:function(n){var s={dialogName:"UnProtectSheet",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(r.dialogInstance.content=e.unProtectSheetPasswordContent(),r.dialogInstance.dataBind(),Re(e.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!(this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1)},click:function(){e.alertMessage(),e.unprotectSheetdlgOkClick(r,t)}}]})},o.prototype.reEnterSheetPassword=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.serviceLocator.getService(jt),n=r.dialogInstance,s,a;r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-reenterpwd-dlg",enableRtl:this.parent.enableRtl,header:i.getConstant("ConfirmPassword"),beforeOpen:function(l){var h={dialogName:"Re-enterPassword",element:l.element,target:l.target,cancel:l.cancel};if(e.parent.trigger("dialogBeforeOpen",h),h.cancel)s=l.cancel=!0;else{var c=e.parent.serviceLocator.getService(ve),u=e.parent.createElement("div",{className:"e-reenterpwd-dialog"}),d=e.parent.createElement("div",{className:"e-reenterpwd-content"}),p=e.parent.createElement("div",{className:"e-header"});p.innerText=c.getConstant("ReEnterPassword");var f=e.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});d.appendChild(f),d.insertBefore(p,f),u.appendChild(d),r.dialogInstance.content=u,r.dialogInstance.dataBind(),Re(e.parent.element.querySelector(".e-protect-dlg.e-dialog .e-footer-content .e-btn"))}},close:function(){r.dialogInstance=n,s?(e.applySheetPwd(t),r.hide(!0)):a&&r.hide(!0)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage();var l=e.parent.serviceLocator.getService(ve),h=e.parent.element.querySelector(".e-reenterpwd-dialog .e-reenterpwd-content .e-input"),c=h.value;if(t===c)e.applySheetPwd(t),a=!0,r.hide();else{var u=e.parent.createElement("span",{className:"e-reenterpwd-alert-span"});c?u.textContent=l.getConstant("PasswordAlert"):u.textContent=l.getConstant("ConfirmPasswordAlertMsg"),e.parent.element.querySelector(".e-reenterpwd-dlg").querySelector(".e-reenterpwd-dialog").appendChild(u)}}}]})},o.prototype.unProtectPasswordContent=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("div",{className:"e-unprotectpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=t.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),e.appendChild(i),e},o.prototype.unProtectSheetPasswordContent=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("div",{className:"e-unprotectsheetpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectsheetpwd-content"}),r=this.parent.createElement("div",{className:"e-header"});r.innerText=t.getConstant("EnterThePassword");var n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),e.appendChild(i),e},o.prototype.unprotectdlgOkClick=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.element.querySelector(".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0].querySelector(".e-input");if(this.parent.password===i.value)t.hide(),this.removeWorkbookProtection(),this.parent.notify(wt,{action:"protectWorkbook",eventArgs:{isProtected:!1}});else{var r=this.parent.createElement("span",{className:"e-unprotectpwd-alert-span"});r.innerText=e.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(r)}},o.prototype.removeWorkbookProtection=function(){this.parent.password="",this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled"));var t=document.getElementById(this.parent.element.id+"_protectworkbook");t&&t.classList.remove("e-active"),this.parent.notify(Bc,{props:"Protectworkbook"})},o.prototype.unprotectSheetdlgOkClick=function(t,e){var i=this.parent.serviceLocator.getService(ve),r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0].querySelector(".e-input");if(e&&r.password.length===0){var s={sheetPassword:n.value,sheetIndex:this.parent.activeSheetIndex};this.parent.open(s)}else if(r.password===n.value)t.hide(),this.unProtectSheetPassword();else{var a=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});a.innerText=i.getConstant("UnprotectPasswordAlert"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(a)}},o.prototype.unProtectSheetPassword=function(){var t=this.parent.getActiveSheet(),e=this.parent.activeSheetIndex;this.parent.setSheetPropertyOnMute(t,"isProtected",!t.isProtected),this.parent.setSheetPropertyOnMute(t,"password","");var i=!t.isProtected;this.parent.notify(sg,{isActive:i,id:this.parent.element.id+"_protect",sheetIndex:e,triggerEvent:!0}),this.parent.allowOpen&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(e)===-1&&this.parent.openModule.unProtectSheetIdx.push(e)},o.prototype.importProtectWorkbook=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.serviceLocator.getService(jt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-importprotectworkbook-dlg",enableRtl:this.parent.enableRtl,header:i.getConstant("UnprotectWorkbook"),beforeOpen:function(n){var s={dialogName:"ImportProtectWorkbook",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(r.dialogInstance.content=e.importProtectPasswordContent(t),r.dialogInstance.dataBind(),Re(e.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage(),e.importOkClick(t)}}]})},o.prototype.importProtectPasswordContent=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.createElement("div",{className:"e-importprotectpwd-dialog"}),r=this.parent.createElement("div",{className:"e-importprotectpwd-content"}),n=this.parent.createElement("span",{className:"e-header"});n.innerText='"'+t.file.name+'" '+e.getConstant("IsProtected");var s=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return s.setAttribute("placeholder",e.getConstant("EnterThePassword")),r.appendChild(n),r.appendChild(s),i.appendChild(r),i},o.prototype.importOkClick=function(t){var e=this.parent.element.querySelector(".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0].querySelector(".e-input");this.parent.password=e.value;var i={file:t.file,password:e.value};this.parent.open(i)},o.prototype.toggleProtect=function(){var t,e=this.parent.element.id,i=this.parent.getActiveSheet();i.isProtected&&this.parent.allowOpen&&i.isImportProtected&&this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1?this.unProtectsheet(!0):i.password&&i.password.length>0?this.unProtectsheet():(this.parent.setSheetPropertyOnMute(i,"isProtected",!i.isProtected),t=!i.isProtected,this.parent.notify(sg,{isActive:t,id:e+"_protect",sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0}))},o.prototype.getModuleName=function(){return"protectSheet"},o})(),G9=(function(){function o(t){this.shortValue="",this.divElements=[],this.paraElements=[],this.inputElements=[],this.textBoxElements=[],this.dropDownListElements=[],this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(w0,this.renderFindDlg,this),this.parent.on(mD,this.renderGotoDlg,this),this.parent.on(Vc,this.gotoHandler,this),this.parent.on(tg,this.findHandler,this),this.parent.on(Hb,this.showFindAlert,this),this.parent.on(Ub,this.replaceAllDialog,this),this.parent.on(AM,this.findKeyUp,this),this.parent.on(Qc,this.findToolDlg,this),this.parent.on(su,this.refreshFindDlg,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(w0,this.renderFindDlg),this.parent.off(mD,this.renderGotoDlg),this.parent.off(Vc,this.gotoHandler),this.parent.off(tg,this.findHandler),this.parent.off(Hb,this.showFindAlert),this.parent.off(Ub,this.replaceAllDialog),this.parent.off(AM,this.findKeyUp),this.parent.off(Qc,this.findToolDlg),this.parent.off(su,this.refreshFindDlg))},o.prototype.findToolDlg=function(t){var e=this,i=function(x){var I=e.parent.showRibbon&&e.parent.element.querySelector(".e-ribbon");if(I){var D=t.event&&t.event.target?H(t.event.target,"#"+e.parent.element.id+"_findbtn"):J("#"+e.parent.element.id+"_findbtn",I);D&&(x?D.classList.add("e-disabled"):D.classList.remove("e-disabled"),D.disabled=x)}},r=t.dialogEle||this.parent.element.getElementsByClassName("e-findtool-dlg")[0];t.isPublic&&(this.findValue=t.findValue);var n=this.parent.getActiveSheet(),s,a,l,h=function(x){if(!(!a||n.isProtected&&!n.protectSettings.selectCells&&!n.protectSettings.selectUnLockedCells)){var I=a.value;if(x&&x.keyCode===13)a.value&&l.textContent!=="0 of 0"&&(e.parent.notify(tg,{findOption:x.shiftKey?"prev":"next"}),e.updateCount(l,x.shiftKey));else{var D=void 0;if(I==="")l.textContent="0 of 0",D=!1;else{var M={value:I,mode:"Sheet",isCSen:!1,sheetIndex:e.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};e.parent.notify(_b,M),l.textContent=M.findCount,D=M.findCount!=="0 of 0"}s.enableItems(1,D),s.enableItems(2,D)}}};if(r)if(t.isPublic||t.refreshPosition){if(t.isPublic&&(a=r.querySelector(".e-text-findNext-short"),a.value=this.findValue,l=r.querySelector(".e-input-group-icon"),s=ot(r.querySelector(".e-find-toolbar"),"toolbar"),h()),t.refreshPosition){var c=void 0;if(this.parent.getActiveSheet().showHeaders){var u=this.parent.getColumnHeaderContent().parentElement;c=(u&&u.offsetHeight||30)+1}else c=1;r.style.top=c+"px"}}else i(!0),this.findDialog.hide();else{var d=this.parent.createElement("div",{className:"e-input-group"});a=this.parent.createElement("input",{className:"e-input e-text-findNext-short",attrs:{type:"Text"}}),this.findValue&&(a.value=this.findValue);var p=this.parent.serviceLocator.getService(ve);a.setAttribute("placeholder",p.getConstant("FindValue")),l=this.parent.createElement("span",{className:"e-input-group-icon"});var f,v=n.usedRange.rowIndex*n.usedRange.colIndex>100;a.onkeyup=function(x){v?(f&&clearTimeout(f),f=setTimeout(h.bind(e,x),500)):h(x)},d.appendChild(a),d.appendChild(l);var m=[{type:"Input",template:d},{prefixIcon:"e-icons e-prev-icon",tooltipText:p.getConstant("FindPreviousBtn"),type:"Button",cssClass:"e-findRib-prev",disabled:!0},{prefixIcon:"e-icons e-next-icon",tooltipText:p.getConstant("FindNextBtn"),type:"Button",cssClass:"e-findRib-next",disabled:!0},{type:"Separator"},{prefixIcon:"e-icons e-option-icon",tooltipText:p.getConstant("MoreOptions"),type:"Button",cssClass:"e-findRib-more"},{prefixIcon:"e-icons e-close",tooltipText:p.getConstant("Close"),type:"Button",cssClass:"e-findRib-close"}];s=new yc({clicked:function(x){x.item.cssClass==="e-findRib-next"?(e.parent.notify(tg,{findOption:"next"}),e.updateCount(l)):x.item.cssClass==="e-findRib-prev"?(e.parent.notify(tg,{findOption:"prev"}),e.updateCount(l,!0)):x.item.cssClass==="e-findRib-more"&&(e.findDialog.animationSettings.effect="None",e.findDialog.setProperties({animationSettings:e.findDialog.animationSettings},!0),e.renderFindDlg(),e.findDialog.hide())},width:"auto",height:"auto",items:m,cssClass:"e-find-toolObj",enableRtl:this.parent.enableRtl,created:function(){var x=s.element.querySelectorAll(".e-toolbar-item .e-tbar-btn");x.forEach(function(I){return I.removeAttribute("tabindex")})}});var y=this.parent.createElement("div",{className:"e-find-toolbar",attrs:{tabindex:"-1"}});s.createElement=this.parent.createElement,s.appendTo(y),r=this.parent.createElement("div",{className:"e-dlg-div",attrs:{"aria-label":p.getConstant("FindValue")}});var b=this.parent.element.getElementsByClassName("e-sheet-panel")[0],S={cssClass:"e-findtool-dlg",visible:!1,enableRtl:this.parent.enableRtl,target:b,open:function(){if(T.add(document,"click",e.closeDialog,e),e.findValue&&(!n.isProtected||n.protectSettings.selectCells||n.protectSettings.selectUnLockedCells)){var x={value:e.findValue,mode:"Sheet",isCSen:!1,sheetIndex:e.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};e.parent.notify(_b,x),l.textContent=x.findCount;var I=x.findCount!=="0 of 0";s.enableItems(1,I),s.enableItems(2,I)}else l.textContent="0 of 0";i(!1);var D=s.element.querySelector(".e-input-group");D&&D.addEventListener("focus",function(){var M=s.element.querySelector(".e-text-findNext-short");Re(M),M.classList.add("e-input-focus"),M.setSelectionRange(0,M.value.length)}),C&&e.findDialog.setProperties({animationSettings:C},!0)},beforeOpen:function(){return Re(e.parent.element)},beforeClose:function(){e.findValue=a.value||null,s.destroy(),T.remove(document,"click",e.closeDialog)},close:function(){e.findDialog.destroy(),e.findDialog=null,se(r),b.style.position="",Re(e.parent.element),i(!1)},created:function(){b.style.position="relative",r.style.width=e.parent.getMainContent().offsetWidth+"px",r.style.visibility="hidden",r.style.display="block",e.findDialog.width=parseInt(getComputedStyle(r).borderLeftWidth,10)*2+r.querySelector(".e-toolbar-items").getBoundingClientRect().width+"px",r.style.display="",r.style.width="",r.style.visibility="",r.style.top=(t&&t.headerHgt||e.parent.getColumnHeaderContent().parentElement.offsetHeight+1)+"px",r.style.left="",r.style[e.parent.enableRtl?"left":"right"]=e.parent.sheetModule.getScrollSize()+"px",e.findDialog.show()}};j.isDevice?(S.header=y,S.allowDragging=!0):S.content=y,this.findDialog=new cc(S),this.findDialog.createElement=this.parent.createElement;var C;t&&t.isPublic&&(C={effect:this.findDialog.animationSettings.effect},this.findDialog.setProperties({animationSettings:{effect:"None"}},!0)),this.findDialog.appendTo(r)}},o.prototype.refreshFindDlg=function(){var t=this.findDialog&&this.parent.element.getElementsByClassName("e-findtool-dlg")[0];if(t){var e=t.querySelector(".e-text-findNext-short");this.findToolDlg({findValue:e.value,isPublic:!0,refreshPosition:!0,dialogEle:t})}},o.prototype.updateCount=function(t,e){var i=t.textContent.split(" "),r;e?(r=Number(i[0])-1,r<1&&(r=Number(i[2]))):(r=Number(i[0])+1,r>Number(i[2])&&(r=1)),i[0]=r.toString(),t.textContent=i.join(" ")},o.prototype.closeDialog=function(t){(H(t.target,".e-findRib-close")||!H(t.target,".e-spreadsheet"))&&this.findDialog&&this.findToolDlg({})},o.prototype.renderFindDlg=function(t){var e=this,i=this.parent.serviceLocator.getService(jt);if(this.parent.element.querySelector(".e-find-dlg"))i.hide();else{var r=this.parent.serviceLocator.getService(ve),n={isModal:!1,showCloseIcon:!0,cssClass:"e-find-dlg",enableRtl:this.parent.enableRtl,header:r.getConstant("FindAndReplace"),beforeOpen:function(s){var a={dialogName:"FindAndReplaceDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(i.dialogInstance.content=e.findandreplaceContent(),i.dialogInstance.dataBind(),Re(e.parent.element))},buttons:[{buttonModel:{content:r.getConstant("FindPreviousBtn"),isPrimary:!0,cssClass:"e-btn-findPrevious",disabled:!0},click:function(s){e.dialogMessage(),e.findHandler({findOption:s&&s.keyCode===13?"next":"prev"})}},{buttonModel:{content:r.getConstant("FindNextBtn"),isPrimary:!0,cssClass:"e-btn-findNext",disabled:!0},click:function(){e.dialogMessage(),e.findHandler({findOption:"next"})}},{buttonModel:{content:r.getConstant("ReplaceBtn"),isPrimary:!0,cssClass:"e-btn-replace",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(Cg)}},{buttonModel:{content:r.getConstant("ReplaceAllBtn"),isPrimary:!0,cssClass:"e-btn-replaceAll",disabled:!0},click:function(){e.dialogMessage(),e.replaceHandler(Bd)}}],open:function(){var s=e.parent.element.querySelector(".e-text-findNext");if(s.value){var a=e.parent.element.querySelector(".e-btn-findPrevious"),l=ot(a,"btn");l.disabled=!1,ot(e.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}if(er(function(){Re(s)}),t&&t.showDialog&&(t.value&&(s.value=t.value,ot(e.parent.element.querySelector(".e-btn-findPrevious"),"btn").disabled=!1,ot(e.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1),t.replaceValue)){var h=e.parent.element.querySelector(".e-text-replaceInp");h.value=t.replaceValue,ot(e.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!1,ot(e.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!1}},beforeClose:this.dialogBeforeClose.bind(this)};i.show(n)}},o.prototype.dialogBeforeClose=function(){var t=this.checkBoxElements;t&&t.element&&(t.destroy(),t.element.remove()),this.checkBoxElements=null,this.textBoxElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.textBoxElements=[],this.dropDownListElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.dropDownListElements=[],ws(this.paraElements),this.paraElements=[],ws(this.inputElements),this.inputElements=[],ws(this.divElements),this.divElements=[]},o.prototype.dialogMessage=function(){this.parent.element.querySelector(".e-replace-alert-span")?this.parent.element.querySelector(".e-replace-alert-span").remove():this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove()},o.prototype.renderGotoDlg=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.serviceLocator.getService(jt),r=!1;if(g(this.parent.element.querySelector(".e-goto-dlg"))){var n={width:300,isModal:!1,showCloseIcon:!0,cssClass:"e-goto-dlg",header:e.getConstant("GotoHeader"),enableRtl:this.parent.enableRtl,beforeOpen:function(s){var a={dialogName:"GoToDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(i.dialogInstance.content=t.GotoContent(),i.dialogInstance.dataBind(),Re(t.parent.element))},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){t.gotoHandler()&&i.hide()}}],open:function(){t.textFocus()}};i.show(n,r)}else i.hide()},o.prototype.textFocus=function(){var t=this,e=this.parent.element.querySelector(".e-text-goto");e.addEventListener("focus",function(){t.parent.element.querySelector(".e-goto-alert-span")&&t.parent.element.querySelector(".e-goto-alert-span").remove()})},o.prototype.findHandler=function(t){var e=this.parent.element.querySelector(".e-text-findNext");e||(e=this.parent.element.querySelector(".e-text-findNext-short"),e||this.gotoAlert());var i=e.value;if(e.value!==""){var r=this.parent.getActiveSheet();if(r.isProtected&&!r.protectSettings.selectCells&&!r.protectSettings.selectUnLockedCells)return;var n=this.parent.activeSheetIndex,s=this.parent.element.querySelector(".e-findnreplace-checkcase"),a=void 0;if(!s)a=!1;else{var l=ot(s,"checkbox");a=l.checked}var h=this.parent.element.querySelector(".e-findnreplace-checkmatch"),c=void 0;if(!h)c=!1;else{var u=ot(h,"checkbox");c=u.checked}var d=this.parent.element.querySelector(".e-findnreplace-searchby"),p=void 0;if(!d)p="By Row";else{var f=ot(d,"dropdownlist");p=f.value.toString()}var v=this.parent.element.querySelector(".e-findnreplace-searchwithin"),m=void 0;if(!v)m="Sheet";else{var y=ot(v,"dropdownlist");m=y.value.toString()}var b={value:i,sheetIndex:n,findOpt:t.findOption,mode:m,isCSen:a,isEMatch:c,searchBy:p,isAction:!0};this.parent.find(b)}},o.prototype.replaceHandler=function(t){var e=this.parent.element.querySelector(".e-find-dlg"),i=e.querySelector(".e-text-findNext").value,r=this.parent.element.querySelector(".e-text-replaceInp").value,n=this.parent.element.querySelector(".e-findnreplace-checkcase").checked,s=this.parent.element.querySelector(".e-findnreplace-checkmatch").checked,a=this.parent.element.querySelector(".e-search-within .e-ddl-hidden").value,l=this.parent.element.querySelector(".e-searchby .e-ddl-hidden").value;this.parent.notify(t,{value:i,mode:a,isCSen:n,isEMatch:s,searchBy:l,findOpt:"next",replaceValue:r,replaceBy:t,sheetIndex:this.parent.activeSheetIndex,isAction:!0})},o.prototype.gotoHandler=function(t){var e=!0;if(t)this.parent.goTo(t.address);else{for(var i=this.parent.element.querySelector(".e-text-goto").value,r=0;r<this.parent.definedNames.length;r++)if(this.parent.definedNames[r].name===i){i=this.parent.definedNames[r].refersTo.slice(1);break}var n=i;i.includes("!")&&(n=i.substring(i.lastIndexOf("!")+1)),n=n.split("$").join(""),n.includes(":")&&(n=n.split(":")[0]);var s=n.match(/\d+/),a=n.match(/[A-Z]+/i);if(!s||!a||a.index!==0)this.gotoAlert(),e=!1;else{var l=tt(ie(n)),h=this.parent.getActiveSheet();l[2]>=1048576||l[3]>=16384?(this.gotoAlert(),e=!1):this.parent.scrollSettings.isFinite&&(h.rowCount<l[2]+1||h.colCount<l[3]+1)?(this.parent.notify(x0,null),e=!1):this.parent.goTo(i)}}return e},o.prototype.gotoAlert=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("span",{className:"e-goto-alert-span"});e.innerText=t.getConstant("InsertingEmptyValue"),this.parent.element.querySelector(".e-goto-alert-span")&&this.parent.element.querySelector(".e-goto-alert-span").remove(),this.parent.element.querySelector(".e-goto-dlg").querySelector(".e-dlg-content").appendChild(e)},o.prototype.showFindAlert=function(){this.parent.element.querySelector(".e-replace-alert-span")&&this.parent.element.querySelector(".e-replace-alert-span").remove();var t=this.parent.element.querySelector(".e-find-dlg .e-dlg-content");if(t){var e=this.parent.createElement("span",{className:"e-find-alert-span"});e.innerText=this.parent.serviceLocator.getService(ve).getConstant("NoElements"),t.appendChild(e)}},o.prototype.replaceAllDialog=function(t){this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove();var e=this.parent.element.querySelector(".e-replace-alert-span");e&&e.remove();var i=this.parent.serviceLocator.getService(ve),r=this.parent.createElement("span",{className:"e-replace-alert-span"});r.innerText=t.count+i.getConstant("ReplaceAllEnd")+t.replaceValue,this.parent.element.querySelector(".e-find-dlg")&&this.parent.element.querySelector(".e-find-dlg").querySelector(".e-dlg-content").appendChild(r)},o.prototype.findKeyUp=function(t){if(t.target.classList.contains("e-text-findNext")){var e=this.parent.element.querySelector(".e-text-findNext").value;if(!g(e)&&e!==""){var i=this.parent.element.querySelector(".e-btn-findPrevious"),r=ot(i,"btn");r.disabled=!1,ot(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}else ot(this.parent.element.querySelector(".e-btn-findPrevious"),"btn").disabled=!0,ot(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!0,this.dialogMessage()}var n=this.parent.element.querySelector(".e-text-findNext");if(n){var e=this.parent.element.querySelector(".e-text-findNext").value,s=this.parent.element.querySelector(".e-text-replaceInp").value;!g(e)&&!g(s)&&e!==""&&s!==""?this.parent.getActiveSheet().isProtected||(ot(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!1,ot(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!1):(ot(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!0,ot(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!0)}},o.prototype.findandreplaceContent=function(){this.parent.element.querySelector(".e-text-findNext-short")&&(this.shortValue=this.parent.element.querySelector(".e-text-findNext-short").value);var t=this.parent.createElement("div",{className:"e-link-dialog"}),e=this.parent.createElement("div",{className:"e-find"}),i=this.parent.createElement("div",{className:"e-findCheck"});this.divElements.push(t),this.divElements.push(e),this.divElements.push(i);var r=this.parent.serviceLocator.getService(ve);t.appendChild(e);var n=this.parent.createElement("div",{className:"e-cont"}),s=this.parent.createElement("p",{className:"e-header"});s.innerText=r.getConstant("FindWhat");var a=this.parent.createElement("input",{className:"e-input e-text-findNext",attrs:{type:"Text",placeholder:r.getConstant("FindValue"),value:this.shortValue}});this.divElements.push(n),this.paraElements.push(s),this.inputElements.push(a),n.appendChild(a),n.insertBefore(s,a),e.appendChild(n);var l=new dc({width:"70%",enableRtl:this.parent.enableRtl});this.textBoxElements.push(l),l.createElement=this.parent.createElement,l.appendTo(a);var h=this.parent.createElement("div",{className:"e-cont"}),c=this.parent.createElement("p",{className:"e-header"});c.innerText=r.getConstant("ReplaceWith");var u=this.parent.createElement("input",{className:"e-input e-text-replaceInp",attrs:{type:"Text",placeholder:r.getConstant("ReplaceValue")}});this.divElements.push(h),this.paraElements.push(c),this.inputElements.push(u),h.appendChild(u),h.insertBefore(c,u),e.appendChild(h);var d=new dc({width:"70%",enableRtl:this.parent.enableRtl});this.textBoxElements.push(d),d.createElement=this.parent.createElement,d.appendTo(u);var p=[{Id:"Sheet",Within:r.getConstant("Sheet")},{Id:"Workbook",Within:r.getConstant("Workbook")}],f=new $s({dataSource:p,cssClass:"e-search-within",enableRtl:this.parent.enableRtl,fields:{value:"Id",text:"Within"},width:"50%",index:0});this.dropDownListElements.push(f);var v=r.getConstant("SearchWithin"),m=this.parent.createElement("input",{className:"e-findnreplace-searchwithin",attrs:{type:"select",label:v}}),y=this.parent.createElement("p",{className:"e-header"});y.innerText=v,this.inputElements.push(m),this.paraElements.push(y),e.appendChild(y),e.appendChild(m),f.createElement=this.parent.createElement,f.appendTo(m);var b=[{Id:"By Row",Search:r.getConstant("ByRow")},{Id:"By Column",Search:r.getConstant("ByColumn")}],S=new $s({dataSource:b,cssClass:"e-searchby",enableRtl:this.parent.enableRtl,fields:{value:"Id",text:"Search"},width:"50%",index:0});this.dropDownListElements.push(S),v=r.getConstant("SearchBy");var C=this.parent.createElement("input",{className:"e-findnreplace-searchby",attrs:{type:"select",label:v}}),x=this.parent.createElement("p",{className:"e-header"});x.innerText=v,this.inputElements.push(C),this.paraElements.push(x),e.appendChild(x),e.appendChild(C),S.createElement=this.parent.createElement,S.appendTo(C);var I=new ma({label:r.getConstant("MatchCase"),checked:!1,cssClass:"e-findnreplace-casecheckbox",enableRtl:this.parent.enableRtl}),D=this.parent.createElement("input",{className:"e-findnreplace-checkcase",attrs:{type:"checkbox"}});this.inputElements.push(D),i.appendChild(D),I.createElement=this.parent.createElement,I.appendTo(D);var M=new ma({label:r.getConstant("MatchExactCellElements"),checked:!1,cssClass:"e-findnreplace-exactmatchcheckbox",enableRtl:this.parent.enableRtl});this.checkBoxElements=M;var E=this.parent.createElement("input",{className:"e-findnreplace-checkmatch",attrs:{type:"checkbox"}});return this.inputElements.push(E),i.appendChild(E),M.createElement=this.parent.createElement,M.appendTo(E),e.appendChild(i),t},o.prototype.GotoContent=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.createElement("div",{className:"e-link-dialog"}),i=this.parent.createElement("div",{className:"e-goto"});e.appendChild(i);var r=this.parent.createElement("div",{className:"e-cont"}),n=this.parent.createElement("p",{className:"e-header"});n.innerText=t.getConstant("Reference");var s=new dc({placeholder:t.getConstant("EnterCellAddress"),enableRtl:this.parent.enableRtl}),a=this.parent.createElement("input",{className:"e-text-goto",attrs:{type:"Text"}});return r.appendChild(a),r.insertBefore(n,a),i.appendChild(r),s.createElement=this.parent.createElement,s.appendTo(a),e},o.prototype.destroy=function(){this.removeEventListener(),this.findDialog&&this.findDialog.hide(),this.parent=null},o.prototype.getModuleName=function(){return"findAndReplace"},o})(),Q9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.merge=function(t){this.parent.serviceLocator.getService("cell").refresh(t.rowIdx,t.colIdx,t.lastCell,t.element,!1,!1,xs(this.parent))},o.prototype.hideHandler=function(t){var e=this.parent.getActiveSheet(),i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};this.parent.notify(pr,i),i.range=i.range;var r=Q(i.range[0],i.range[1],e)||{},n=t.model==="row"?i.range[0]:i.range[1],s=n+((r[t.model+"Span"]||1)-1);if(!(!t.isEnd&&(t.start===n||Ft(e,n))||t.isEnd&&t.start>n&&!Ft(e,n))&&r[t.model+"Span"]>1&&s>=t.start)if(t.model==="row"?lt(e,n):Ft(e,n)){if(t.colIdx<=s){var a=ce(e,i.range[1],!0,"columns");if(a<=s){var l=i.range[0];r.rowSpan>1&&(l=ce(e,i.range[0],!0),l=l<=i.range[2]?l:i.range[0]);var h=this.parent.getCell(l,a);h&&(h.style.display="",this.parent.serviceLocator.getService("cell").refresh(i.range[0],i.range[1],!0,h,!0,!0))}}}else{var l=r.rowSpan>1?ce(e,i.range[0],!0):i.range[0];this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:this.parent.getCell(l,i.range[1])})}},o.prototype.checkPrevMerge=function(t){var e=this,i,r,n,s,a,l=this.parent.getActiveSheet(),h=function(){var d=e.parent.getContentTable(),p=d&&d.rows[0];if(p){var f=parseInt(p.getAttribute("aria-rowindex"),10)-1;if(r.range=r.range,f>e.parent.viewport.topIndex+e.parent.frozenRowCount(l)&&f>r.range[0]&&f<=r.range[2]){var v=void 0,m=e.parent.getRowHeaderTable(),y=m&&m.rows[0],b=e.parent.frozenColCount(l);if(b&&!y)return;for(var S=t.colIdx;S<=r.range[3];S++)v=e.parent.getCell(f,S,S<b?y:p),v&&(v.colSpan>1||v.rowSpan>1)&&(v.style.display="none",v.removeAttribute("colSpan"),v.removeAttribute("rowSpan"))}}},c=function(d){if(r.range=r.range,lt(l,r.range[0])&&t.rowIdx>=r.range[0]&&t.rowIdx<=r.range[2]){s=!1;for(var p=r.range[0];p<t.rowIdx;p++)if(!lt(l,p)){s=!0;break}if(i.rowSpan>1&&!s){var f=i.rowSpan-e.parent.hiddenCount(r.range[0],r.range[2]);f>0&&(h(),t.td.style.display="",t.colSpan=n,t.rowSpan=f,t.cell=i,t.isMerged=!1)}}else if(d){for(var p=r.range[0];a&&p<t.rowIdx;p++)if(!lt(l,p)){s=!0;break}s||(h(),t.td.style.display="",t.colSpan=n,t.cell=i,t.isMerged=!1)}};if(t.cell.colSpan<0){if(t.colIdx-1>-1&&Ft(l,t.colIdx-1)&&(i=Q(t.rowIdx,t.colIdx-1,l,!1,!0),a=t.rowIdx-1>-1&&lt(l,t.rowIdx-1),(i.colSpan!==void 0||i.rowSpan!==void 0)&&(i.rowSpan===void 0||i.rowSpan>1||a)&&(r={range:[t.rowIdx,t.colIdx-1,t.rowIdx,t.colIdx-1]},this.parent.notify(pr,r),r.range=r.range,i=Q(r.range[0],r.range[1],l,!1,!0),Ft(l,r.range[1])&&t.colIdx>=r.range[1]&&t.colIdx<=r.range[3]))){for(var u=r.range[1];u<t.colIdx;u++)if(!Ft(l,u)){s=!0;break}i.colSpan>1&&!s&&(n=i.colSpan-this.parent.hiddenCount(r.range[1],r.range[3],"columns"),n>0&&c(!0))}}else t.rowIdx-1>-1&&lt(l,t.rowIdx-1)&&(i=Q(t.rowIdx-1,t.colIdx,l,!1,!0),i.rowSpan!==void 0&&(r={range:[t.rowIdx-1,t.colIdx,t.rowIdx-1,t.colIdx]},this.parent.notify(pr,r),r.range=r.range,i=Q(r.range[0],r.range[1],l,!1,!0),c()))},o.prototype.checkMerge=function(t){var e=this.parent.getActiveSheet(),i,r=Q(t.rowIdx,t.colIdx,e)||{};if(t.isRow){if(r.colSpan===void 0||Ft(e,t.colIdx-1)){if(i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]},i.range=i.range,this.parent.notify(pr,i),Ft(e,t.colIdx-1)&&!Ft(e,i.range[1])||t.isFreezePane&&i.range[0]<this.parent.frozenRowCount(e)){t.insideFreezePane=i.range[0]<this.parent.frozenRowCount(e);return}if(t.colIdx!==this.parent.viewport.leftIndex+this.parent.frozenColCount(e)&&Ft(e,t.colIdx-1)){for(var n=i.range[1];r.colSpan!==void 0&&n<t.colIdx;n++)if(!Ft(e,n))return}r=Q(i.range[0],i.range[1],e);var s=i.range[2]-t.rowIdx+1-this.parent.hiddenCount(t.rowIdx,i.range[2]);s>=1&&(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:t.td}),s===1?t.td.removeAttribute("rowspan"):t.td.rowSpan=s,t.td.style.display="")}}else if(r.rowSpan===void 0||lt(e,t.rowIdx-1)){if(i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]},i.range=i.range,this.parent.notify(pr,i),lt(e,t.rowIdx-1)&&!lt(e,i.range[0])||t.isFreezePane&&i.range[1]<this.parent.frozenColCount(e)){t.insideFreezePane=i.range[1]<this.parent.frozenColCount(e);return}if(t.rowIdx!==this.parent.viewport.topIndex+this.parent.frozenRowCount(e)&&lt(e,t.rowIdx-1)){for(var a=i.range[0];r.rowSpan!==void 0&&a<t.rowIdx;a++)if(!lt(e,a))return}r=Q(i.range[0],i.range[1],e);var s=i.range[3]-t.colIdx+1-this.parent.hiddenCount(t.colIdx,i.range[3],"columns");s>=1&&(this.merge({rowIdx:i.range[0],colIdx:i.range[1],element:t.td}),s===1?t.td.removeAttribute("colspan"):t.td.colSpan=s,t.td.style.display="")}},o.prototype.addEventListener=function(){this.parent.on(LM,this.merge,this),this.parent.on(M0,this.hideHandler,this),this.parent.on(CD,this.checkPrevMerge,this),this.parent.on(D0,this.checkMerge,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(LM,this.merge),this.parent.off(M0,this.hideHandler),this.parent.off(CD,this.checkPrevMerge),this.parent.off(D0,this.checkMerge))},o.prototype.getModuleName=function(){return"merge"},o})(),X9=(function(){function o(t){this.divElements=[],this.spanElements=[],this.inputElements=[],this.dropDownListElements=[],this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.dupData&&(this.dupData=[]),this.colorData&&(this.colorData=[]),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Gi,this.applyCF,this),this.parent.on(ID,this.renderCFDlg,this),this.parent.on(NM,this.clearCF,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Gi,this.applyCF),this.parent.off(ID,this.renderCFDlg),this.parent.off(NM,this.clearCF))},o.prototype.clearCF=function(t){var e=this,i=this.parent.getActiveSheet(),r=function(n,s,a,l){Z([l],["e-redft","e-yellowft","e-greenft","e-redf","e-redt","e-iconset"]);var h,c;["backgroundColor","color"].forEach(function(p){l.style[""+p]&&(l.style[""+p]="",h=a&&a.style&&a.style[""+p]||e.parent.commonCellStyle[""+p],h&&(c={},c[""+p]=h,e.parent.notify(Mr,{style:c,rowIdx:n,colIdx:s,td:l})))});var u;if([".e-cf-databar",".e-iconsetspan"].forEach(function(p){u=l.querySelector(p),u&&(u.parentElement.removeChild(u),a&&a.format&&a.format.includes("*")?e.parent.notify(yr,{value:a.value,format:a.format,cell:a,formattedText:a.value,rowIndex:n,colIndex:s,td:l}):l.textContent=e.parent.getDisplayText(a),a&&a.hyperlink&&e.parent.notify(f0,{cell:a,style:a.style,td:l,rowIdx:n,colIdx:s}))}),a&&a.format&&a.format.includes("[")&&Ho(a.format)){var d={value:a.value,format:a.format,formattedText:a.value,cell:a,rowIndex:n,colIndex:s,refresh:!0,td:l};e.parent.notify(yr,d)}};this.updateRange(i,t.indexes,this.parent.frozenRowCount(i),this.parent.frozenColCount(i),xe(i.topLeftCell),r)},o.prototype.renderCFDlg=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r,n=this.parent.serviceLocator.getService(jt);n.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-conditionalformatting-dlg",header:t.action.replace("...",""),enableRtl:this.parent.enableRtl,beforeOpen:function(s){var a={dialogName:"ConditionalFormatDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(n.dialogInstance.content=e.cfDlgContent(t.action),n.dialogInstance.dataBind(),Re(e.parent.element))},beforeClose:this.dialogBeforeClose.bind(this),close:function(){r&&(e.parent.notify(fr,null),r=!1)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){var s=e.parent.getActiveSheet();Hi(e.parent,tt(ie(s.selectedRange)))?r=!0:e.dlgClickHandler(t.action),n.hide()}}]})},o.prototype.dialogBeforeClose=function(){var t=this.numericTBElements;t&&t.element&&(t.destroy(),t.element.remove()),this.numericTBElements=null,this.dropDownListElements.forEach(function(e){e&&e.element&&(e.destroy(),e.element.remove())}),this.dropDownListElements=[],this.value1Inp&&(this.value1Inp.removeEventListener("input",this.validateCFInput.bind(this)),this.value1Inp.parentNode&&this.value1Inp.parentNode.removeChild(this.value1Inp),this.value1Inp=null),this.value2Inp&&(this.value2Inp.removeEventListener("input",this.validateCFInput.bind(this)),this.value2Inp.parentNode&&this.value2Inp.parentNode.removeChild(this.value2Inp),this.value2Inp=null),ws(this.spanElements),this.spanElements=[],ws(this.inputElements),this.inputElements=[],ws(this.divElements),this.divElements=[]},o.prototype.dlgClickHandler=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.element.querySelector(".e-conditionalformatting-dlg .e-dlg-content .e-cf-dlg"),r={cFColor:this.getCFColor(i.querySelector(".e-cfsub .e-input").value),range:this.parent.getActiveSheet().selectedRange},n=i.querySelectorAll(".e-cfmain .e-input");if(t===e.getConstant("DuplicateValues")+"...")r.type=n[0].value===e.getConstant("Duplicate")?"Duplicate":"Unique";else{r.type=this.getType(t);var s=[];n[0]&&s.push(n[0].value),n[1]&&s.push(n[1].value),Td(s,this.parent),r.value=s.join(",")}this.parent.notify(jd,{cfModel:r,isAction:!0})},o.prototype.getType=function(t){var e=this.parent.serviceLocator.getService(ve),i;switch(t){case e.getConstant("GreaterThan")+"...":i="GreaterThan";break;case e.getConstant("LessThan")+"...":i="LessThan";break;case e.getConstant("Between")+"...":i="Between";break;case e.getConstant("CFEqualTo")+"...":i="EqualTo";break;case e.getConstant("TextThatContains")+"...":i="ContainsText";break;case e.getConstant("ADateOccuring")+"...":i="DateOccur";break;case e.getConstant("Top10Items")+"...":i="Top10Items";break;case e.getConstant("Bottom10Items")+"...":i="Bottom10Items";break;case e.getConstant("Top10")+" %...":i="Top10Percentage";break;case e.getConstant("Bottom10")+" %...":i="Bottom10Percentage";break;case e.getConstant("AboveAverage")+"...":i="AboveAverage";break;case e.getConstant("BelowAverage")+"...":i="BelowAverage";break}return i},o.prototype.getCFColor=function(t){var e=this.parent.serviceLocator.getService(ve),i="RedFT";switch(t){case e.getConstant("LightRedFillWithDarkRedText"):i="RedFT";break;case e.getConstant("YellowFillWithDarkYellowText"):i="YellowFT";break;case e.getConstant("GreenFillWithDarkGreenText"):i="GreenFT";break;case e.getConstant("RedFill"):i="RedF";break;case e.getConstant("RedText"):i="RedT";break}return i},o.prototype.cfDlgContent=function(t){var e=this.getDlgText(t),i=this.parent.serviceLocator.getService(ve),r=this.parent.createElement("div",{className:"e-cf-dlg"}),n=this.parent.createElement("div",{className:"e-cfmain"}),s=this.parent.createElement("div",{className:"e-cfsub"});this.divElements.push(r),this.divElements.push(n),this.divElements.push(s);var a=this.parent.createElement("span",{className:"e-header e-top-header"});a.innerText=e,this.value1Inp=this.parent.createElement("input",{className:"e-input",id:"valueInput",attrs:{type:"text","aria-label":e}});var l=this.parent.createElement("input",{className:"e-select"}),h=this.parent.createElement("span",{className:"e-header"});h.innerText=i.getConstant("With");var c=this.parent.createElement("input",{className:"e-select"});this.spanElements.push(a),this.inputElements.push(l),this.spanElements.push(h),this.inputElements.push(c),r.appendChild(n),r.appendChild(s),n.appendChild(a);var u;if(t!==i.getConstant("DuplicateValues")+"..."){if(t!==i.getConstant("AboveAverage")+"..."&&t!==i.getConstant("BelowAverage")+"..."){n.appendChild(this.value1Inp),u=!0;var d=t===i.getConstant("Top10")+" %..."||t===i.getConstant("Bottom10")+" %...";if(t===i.getConstant("Top10Items")+"..."||t===i.getConstant("Bottom10Items")+"..."||d){this.value1Inp.maxLength=d?3:4;var p=new ba({value:10,min:1,max:d?100:1e3,format:"###",enableRtl:this.parent.enableRtl});this.numericTBElements=p,p.appendTo(this.value1Inp)}}}else{n.appendChild(l),this.dupData=[{text:i.getConstant("Duplicate"),id:"duplicate"},{text:i.getConstant("Unique"),id:"unique"}];var f=new $s({dataSource:this.dupData,index:0,popupHeight:"200px",enableRtl:this.parent.enableRtl});this.dropDownListElements.push(f),f.appendTo(l)}if(t===i.getConstant("Between")+"..."){var v=this.parent.createElement("span",{className:"e-header e-header-2"});v.innerText=i.getConstant("And"),this.value2Inp=this.parent.createElement("input",{className:"e-input e-between"}),this.spanElements.push(v),n.appendChild(v),n.appendChild(this.value2Inp),this.value2Inp.addEventListener("input",this.validateCFInput.bind(this))}u&&(this.validateCFInput({target:this.value1Inp}),this.value1Inp.addEventListener("input",this.validateCFInput.bind(this))),s.appendChild(h),s.appendChild(c),this.colorData=[{text:i.getConstant("LightRedFillWithDarkRedText"),value:"redft",id:"redft"},{text:i.getConstant("YellowFillWithDarkYellowText"),id:"yellowft"},{text:i.getConstant("GreenFillWithDarkGreenText"),id:"greenft"},{text:i.getConstant("RedFill"),id:"redf"},{text:i.getConstant("RedText"),id:"redt"}];var m=new $s({dataSource:this.colorData,index:0,popupHeight:"200px",enableRtl:this.parent.enableRtl});return this.dropDownListElements.push(m),m.appendTo(c),r},o.prototype.validateCFInput=function(t){var e=this.parent.serviceLocator.getService(jt),i=t.target.value,r=e.dialogInstance.element.getElementsByClassName("e-primary")[0];i&&(t.target.classList.contains("e-between")||t.target.parentElement.querySelector(".e-between"))&&(i=t.target.parentElement.querySelector(t.target.classList.contains("e-between")?".e-input":".e-between").value),r.disabled=!i.trim()},o.prototype.checkCellHandler=function(t,e,i){var r=i.range.trim().split(",");return r.some(function(n){var s=ie(n.includes(":")?n:n+":"+n);return t>=s[0]&&t<=s[2]&&e>=s[1]&&e<=s[3]})},o.prototype.getDlgText=function(t){var e=this.parent.serviceLocator.getService(ve),i="";switch(t){case e.getConstant("GreaterThan")+"...":i=e.getConstant("FormatCellsGreaterThan");break;case e.getConstant("LessThan")+"...":i=e.getConstant("FormatCellsLessThan");break;case e.getConstant("Between")+"...":i=e.getConstant("FormatCellsBetween");break;case e.getConstant("CFEqualTo")+"...":i=e.getConstant("FormatCellsEqualTo");break;case e.getConstant("TextThatContains")+"...":i=e.getConstant("FormatCellsThatContainTheText");break;case e.getConstant("ADateOccuring")+"...":i=e.getConstant("FormatCellsThatContainADateOccurring");break;case e.getConstant("DuplicateValues")+"...":i=e.getConstant("FormatCellsDuplicate");break;case e.getConstant("Top10Items")+"...":i=e.getConstant("FormatCellsTop");break;case e.getConstant("Top10")+" %...":i=e.getConstant("FormatCellsTop");break;case e.getConstant("Bottom10Items")+"...":i=e.getConstant("FormatCellsBottom");break;case e.getConstant("Bottom10")+" %...":i=e.getConstant("FormatCellsBottom");break;case e.getConstant("AboveAverage")+"...":i=e.getConstant("FormatCellsAbove");break;case e.getConstant("BelowAverage")+"...":i=e.getConstant("FormatCellsBelow");break}return i},o.prototype.updateResult=function(t,e,i,r,n,s,a,l){var h={},c={},u=t.range.split(","),d=[],p,f,v,m,y;i?y=function(){if(De(f)&&m!=="Text"){var I=parseFloat(f);I>=0?(d[0]===void 0||I>d[0])&&(d[0]=I):(d[1]===void 0||I<d[1])&&(d[1]=I)}}:r?y=function(){if(De(f)&&m!=="Text"){var I=parseFloat(f);d.push(Number(I))}}:n?(d=[0,0],y=function(){De(f)&&m!=="Text"&&(d[0]+=parseFloat(f),d[1]++)}):s?y=function(){De(f)&&m!=="Text"&&d.push(parseFloat(f))}:a?y=function(){if(De(f)&&m!=="Text"){var I=parseFloat(f);(d[0]===void 0||I<d[0])&&(d[0]=I),(d[1]===void 0||I>d[1])&&(d[1]=I)}}:y=function(){h[""+f]?f!==""&&(c[""+f]||(c[""+f]=!0,d.push(f))):h[""+f]=!0};for(var b=0;b<u.length;b++){p=ie(u[b]);for(var S=p[0];S<=p[2];S++)for(var C=p[1];C<=p[3];C++)v=Q(S,C,e,!1,!0),m="",g(v.value)?v.formula&&(this.parent.notify(zl,{cell:v,rowIdx:S,colIdx:C,sheetIndex:this.parent.activeSheetIndex}),f=v.value.toString().toLowerCase(),m=en(v.format),y()):(f=v.value.toString().toLowerCase(),m=en(v.format),y())}if(r||s){if(d=d.sort(function(I,D){return I-D}),t.type.includes("Bottom")||(d=d.reverse()),s){var x=parseFloat(l);t.type.includes("Percentage")&&(x=x/(100/d.length),x=x<1?1:x),d=d.slice(0,x)}}else n&&(d=[d[0]/d[1]],d[0]||(d=[]));t.result=d},o.prototype.applyCF=function(t){var e=!t.cfModel,i=this.parent.getActiveSheet(),r=t.cfModel||i.conditionalFormats,n=[t.indexes];t.refreshAll&&(n=Az(this.parent,this.parent.viewport));for(var s={},a=r.length-1;a>=0;a--)e&&(n[0].length===2?!this.checkCellHandler(t.indexes[0],t.indexes[1],r[a]):!i0(n,r[a].range))||this.updateCF(t,i,r[a],s)},o.prototype.updateCF=function(t,e,i,r){var n=this,s,a="",l=!1;if(i.value){var h=[],c=[];if(i.type==="Between"?(h=i.value.split('"').filter(function(A){return A.trim()&&A.trim()!==","}),h.length>1?(c=h,l=!0):c=i.value.split(",").filter(function(A){return!!A.trim()})):c=[i.value],c.length>1)if(c[0].split("(").length>1){for(var u="",d=0;d<c.length;d++)u+=c[d]+",",u.split("(").length===u.split(")").length&&s===void 0&&(s=u.substring(0,u.length-1),u="");a=u.substring(0,u.length-1)}else{s=c[0];for(var d=1;d<c.length;d++)a+=d+1===c.length?c[d]:c[d]+","}else s=c[0]||i.value}i.type||(i.type="GreaterThan");var p,f;i.format&&i.format.style?(p=eE(i.format.style,!0),Object.keys(p).length||(f=i.cFColor,f||(f=i.cFColor="RedFT"))):(p={},f=i.cFColor,f||(f=i.cFColor="RedFT"));var v=i.type.includes("Average"),m=i.type.includes("10")&&De(s),y=i.type.includes("Three")||i.type.includes("Four")||i.type.includes("Five"),b=i.type.includes("DataBar"),S=i.type.includes("ColorScale");(!t.isRender||!i.result)&&(i.type==="Duplicate"||i.type==="Unique"||b||S||v||m||y)&&this.updateResult(i,e,b,S,v,m,y,s);var C=function(A,L,N,R,P,k,B){var F=N&&!g(N.value)?N.value.toString():"",O,z,Y=!0,K=N?en(N.format):"";switch(i.type){case"GreaterThan":case"LessThan":O=n.isGreaterThanLessThan(i,F,s,K);break;case"Between":O=De(F)&&K!=="Text"&&n.isBetWeen(i,F,s,a,k);break;case"EqualTo":O=n.isEqualTo(i,F,s);break;case"ContainsText":O=F&&s&&n.isContainsText(F,s);break;case"DateOccur":z={value:s,cell:{},updatedVal:s},De(s)||n.parent.notify(Jr,z),O=F===z.updatedVal;break;case"Unique":O=F!==""&&i.result.indexOf(F.toLowerCase())===-1;break;case"Duplicate":O=i.result.indexOf(F.toLowerCase())>-1;break;case"Top10Items":case"Bottom10Items":case"Top10Percentage":case"Bottom10Percentage":if(i.result){var U=parseFloat(F);_o(F)&&(U=ls(F)),O=i.result.indexOf(U)>-1}break;case"AboveAverage":O=i.result.length&&De(F)&&K!=="Text"&&parseFloat(F)>i.result[0];break;case"BelowAverage":O=i.result.length&&De(F)&&K!=="Text"&&parseFloat(F)<i.result[0];break;default:if(Y=!1,b)r[A+"_"+L+"_bars"]||(r[A+"_"+L+"_bars"]=!0,n.applyDataBars(F,i,R,A,K,P,N,B));else if(S){if(!r[A+"_"+L]){var U=De(F)?parseFloat(F):NaN;if(isNaN(U)){if(R.style.backgroundColor&&!R.classList.contains("e-yellowft")&&!R.classList.contains("e-greenft")&&!R.classList.value.includes("e-redf")){R.style.backgroundColor="";var q=pe({},n.parent.commonCellStyle,N&&N.style);q.backgroundColor&&n.parent.notify(Mr,{style:{backgroundColor:q.backgroundColor},td:R,rowIdx:A,colIdx:L}),n.isHighlight(A,L,e)}}else{var ae=i.result,te=ae.indexOf(U);if(te===-1){if(R.style.backgroundColor){R.style.backgroundColor="";var he=pe({},n.parent.commonCellStyle,N&&N.style);he.backgroundColor&&n.parent.notify(Mr,{style:{backgroundColor:he.backgroundColor},td:R,rowIdx:A,colIdx:L})}}else{var ue=n.getColor(i.type);R.style.backgroundColor=te===0?ue[0]:te===ae.length-1?ue[ue.length-1]:ae.length===3&&te===1?ue[1]:n.getGradient(te,ue[0],ue[1],ue[2],ae.length),r[A+"_"+L]=!0,n.isHighlight(A,L,e)}}}}else if(!r[A+"_"+L+"_icons"]){r[A+"_"+L+"_icons"]=!0;var ne=n.parent.createElement("span",{className:"e-icon e-iconsetspan"}),le=n.applyIconSet(F,i,R,ne,K);le&&N&&N.format&&N.format.includes("*")&&n.parent.notify(xg,{cell:N,cellEle:R,rowIdx:A,colIdx:L,updateFillSize:!0,iconSetSpan:ne})}break}if(t.isAction&&Y&&(n.parent.trigger("beforeConditionalFormat",{conditionalFormat:i,cell:N,element:R,apply:O,address:st(A,L)}),!O&&t.isEdit&&!r[A+"_"+L])){var $;f?R.className.includes("e-"+f.toLowerCase())&&(R.classList.remove("e-"+f.toLowerCase()),R.style.backgroundColor="",R.style.color="",$=pe({},n.parent.commonCellStyle,N&&N.style),($.backgroundColor||$.color)&&n.parent.notify(Mr,{rowIdx:A,colIdx:L,td:R,style:{backgroundColor:$.backgroundColor,color:$.color}})):(R.removeAttribute("style"),$=pe({},n.parent.commonCellStyle,N&&N.style),Object.keys($).length&&n.parent.notify(Mr,{style:$,rowIdx:A,colIdx:L,td:R}))}O&&!r[A+"_"+L]&&(r[A+"_"+L]=!0,Z([R],["e-redft","e-yellowft","e-greenft","e-redf","e-redt"]),f&&(R.classList.add("e-"+f.toLowerCase()),n.setCFStyle(p,i)),Object.assign(R.style,p),n.isHighlight(A,L,e))};if(t.ele)C(t.indexes[0],t.indexes[1],t.cell,t.ele,t.resizedRowHeight,l,t.mergeArgs);else for(var x=i.range.split(","),I=this.parent.frozenRowCount(e),D=this.parent.frozenColCount(e),M=xe(e.topLeftCell),E=0;E<x.length;E++)this.updateRange(e,ie(x[E]),I,D,M,C,l)},o.prototype.updateRange=function(t,e,i,r,n,s,a){e[0]=e[0]<i?e[0]<n[0]?n[0]:e[0]:e[0]<this.parent.viewport.topIndex+i?this.parent.viewport.topIndex+i:e[0],e[1]=e[1]<r?e[1]<n[1]?n[1]:e[1]:e[1]<this.parent.viewport.leftIndex+r?this.parent.viewport.leftIndex+r:e[1],e[2]=e[2]<i?e[2]<n[0]?n[0]-1:e[2]:e[2]>this.parent.viewport.bottomIndex?this.parent.viewport.bottomIndex:e[2],e[3]=e[3]<r?e[3]<n[1]?n[1]-1:e[3]:e[3]>this.parent.viewport.rightIndex?this.parent.viewport.rightIndex:e[3];for(var l,h=e[0];h<=e[2];h++)if(i&&h===i&&(h=this.parent.viewport.topIndex+i),!lt(t,h))for(var c=e[1];c<=e[3];c++)r&&c===r&&(c=this.parent.viewport.leftIndex+r),!Ft(t,c)&&(l=this.parent.getCell(h,c),l&&s(h,c,Q(h,c,t),l,void 0,a))},o.prototype.isHighlight=function(t,e,i){var r=Q(t,e,i,!1,!0),n=r.validation||hs(i.columns[e],t,e)&&i.columns[e].validation;(n||hs(i.columns[e],t,e))&&n.isHighlighted&&this.parent.notify(Rh,{rowIdx:t,colIdx:e,cell:r,validation:n,col:r.validation&&i.columns[e]})},o.prototype.applyIconSet=function(t,e,i,r,n){var s=i.classList.contains("e-iconset");if(s){i.classList.remove("e-iconset");var a=i.querySelector(".e-iconsetspan");a&&a.parentElement.removeChild(a)}var l=De(t)?parseFloat(t):NaN,h=e.result;if(isNaN(l)||h[0]===void 0&&h[1]===void 0||De(t)&&n==="Text")return s;var c=h[0],u=h[1],d=this.getIconList(e.type).split(","),p;if(d.length===3){var f=c+.67*(u-c),v=c+.33*(u-c);p="e-"+(l>=f?d[0].trim():l>=v?d[1].trim():d[2].trim())}else if(d.length===4){var m=c+.25*(u-c),y=c+.5*(u-c),b=c+.75*(u-c);p="e-"+(l>=b?d[0].trim():l>=y?d[1].trim():l>=m?d[2].trim():d[3].trim())}else if(d.length===5){var m=c+.2*(u-c),y=c+.4*(u-c),b=c+.6*(u-c),S=c+.8*(u-c);p="e-"+(l>=S?d[0].trim():l>=b?d[1].trim():l>=y?d[2].trim():l>=m?d[3].trim():d[4].trim())}r.classList.add(p);var C=i.querySelector(".e-cf-databar");C&&(r.style.height=C.style.height,r.classList.add(i.style.verticalAlign==="top"?"e-cf-icon-top":i.style.verticalAlign==="middle"?"e-cf-icon-middle":"e-cf-icon-end"));var x=i.querySelector(".e-wrap-content");return x?x.insertBefore(r,x.firstChild):i.insertBefore(r,i.childNodes[0]),i.classList.add("e-iconset"),!0},o.prototype.getIconList=function(t){var e="3arrows-1,3arrows-2,3arrows-3";switch(t){case"ThreeArrows":return"3arrows-1,3arrows-2,3arrows-3";case"ThreeArrowsGray":return"3arrowsgray-1,3arrowsgray-2,3arrowsgray-3";case"FourArrowsGray":return"4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4";case"FourArrows":return"4arrows-1,4arrows-2,4arrows-3,4arrows-4";case"FiveArrowsGray":return"5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5";case"FiveArrows":return"5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5";case"ThreeTrafficLights1":return"3trafficlights-1,3trafficlights-2,3trafficlights-3";case"ThreeTrafficLights2":return"3rafficlights2-1,3rafficlights2-2,3rafficlights2-3";case"ThreeSigns":return"3signs-1,3signs-2,3signs-3";case"FourTrafficLights":return"4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4";case"FourRedToBlack":return"4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4";case"ThreeSymbols":return"3symbols-1,3symbols-2,3symbols-3";case"ThreeSymbols2":return"3symbols2-1,3symbols2-2,3symbols2-3";case"ThreeFlags":return"3flags-1,3flags-2,3flags-3";case"FourRating":return"4rating-4,4rating-3,4rating-2,4rating-1";case"FiveQuarters":return"5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5";case"FiveRating":return"5rating-5,5rating-4,5rating-3,5rating-2,5rating-1";case"ThreeTriangles":return"3triangles-1,3triangles-2,3triangles-3";case"ThreeStars":return"3stars-1,3stars-2,3stars-3";case"FiveBoxes":return"5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5"}return e},o.prototype.applyDataBars=function(t,e,i,r,n,s,a,l){var h=this.parent.getActiveSheet(),c=e.result,u=0,d,p;if(De(t)&&(p=parseFloat(t)),c[0]===void 0&&c[1]===void 0||isNaN(p)||De(t)&&n==="Text"){var f=i.getElementsByClassName("e-cf-databar")[0];if(f){var v=f.getElementsByClassName("e-databar-value")[0].textContent,m=i.querySelector(".e-hyperlink"),y=i.querySelector(".e-addNoteIndicator"),b=i.querySelector(".e-wrap-content");b?(b.textContent="",m?b.appendChild(m):b.innerText=v):(i.removeChild(f),m?i.appendChild(m):i.innerText=v),y&&i.appendChild(y)}return}c[0]!==void 0&&c[1]!==void 0?(d=c[0]+Math.abs(c[1]),u=Math.abs(c[1]/d*100)):c[0]!==void 0?d=c[0]:d=c[1];var S=this.parent.createElement("div",{id:"spreadsheet-databar",className:"e-cf-databar"}),C=this.parent.createElement("span",{id:"spreadsheet-leftspan",className:"e-databar"}),x=this.parent.createElement("span",{id:"spreadsheet-rightspan",className:"e-databar"}),I=this.parent.createElement("span",{id:"spreadsheet-dataspan",className:"e-databar-value"}),D=i.querySelector(".e-iconsetspan"),M=i.querySelector(".e-addNoteIndicator"),E=i.querySelector(".e-wrap-content"),A=0;s?(l?(A+=xi(h,l.range[0],r-1,!0),r!==l.range[2]&&(A+=xi(h,r+1,l.range[0]+(a.rowSpan-1),!0))):a.rowSpan>1&&(A=xi(h,r+1,r+(a.rowSpan-1),!0)),A+=s):a.rowSpan!==void 0&&a.rowSpan>1?A=xi(h,r,r+(a.rowSpan-1),!0):A=ei(h,r,!0);var L=i.querySelector(".e-fill-before");S.style.height=A-1+"px",D&&(D.style.height=A-1+"px",D.classList.add(i.style.verticalAlign==="top"?"e-cf-icon-top":i.style.verticalAlign==="middle"?"e-cf-icon-middle":"e-cf-icon-end")),L&&(L.style.alignItems=i.style.verticalAlign==="top"?"start":i.style.verticalAlign==="middle"?"center":"end",L.classList.add("e-cf-currency"));var N=e.type[0];N==="L"&&(N+="B"),c[1]===void 0?(x.style.width=""+Math.ceil(Math.abs(p/d*100))+"%",x.style.height=A-3+"px",x.style.backgroundColor=this.getColor(N)[0],this.parent.enableRtl?x.style.right="0px":x.style.left="0px"):c[0]===void 0?(x.style.width=""+Math.ceil(Math.abs(p/d*100))+"%",x.style.height=A-3+"px",x.style.backgroundColor=this.getColor("R")[0],this.parent.enableRtl?x.style.right="0px":x.style.left="0px"):p>=0?(C.style.width=u+"%",C.style.height=A-3+"px",C.style.backgroundColor="transparent",this.parent.enableRtl?C.style.right="0px":C.style.left="0px",x.style.width=""+Math.ceil(Math.abs(p/d*100))+"%",x.style.height=A-3+"px",x.style.backgroundColor=this.getColor(N)[0],this.parent.enableRtl?x.style.right=u+"%":x.style.left=u+"%"):(C.style.width=""+Math.ceil(Math.abs(p/d*100))+"%",C.style.height=A-3+"px",C.style.backgroundColor=this.getColor("R")[0],this.parent.enableRtl?C.style.width===u+"%"?C.style.right="0px":C.style.left=100-u+"%":C.style.width===u+"%"?C.style.left="0px":C.style.right=100-u+"%"),I.style.fontSize=i.style.fontSize||"11pt",I.style.alignItems=i.style.verticalAlign==="top"?"start":i.style.verticalAlign==="middle"?"center":"end",I.style.textDecoration=i.style.textDecoration;var R=i.querySelector(".e-fill-before.e-cf-currency");R&&S.appendChild(R);var P=i.querySelector(".e-hyperlink");if(P)I.appendChild(P);else{var k=i.querySelector(".e-validation-list")?i.innerText:i.textContent;I.innerText=k,k===""&&I.appendChild(document.createTextNode(k))}S.appendChild(C),S.appendChild(x),S.appendChild(I),i.textContent="",E?(E.textContent="",D&&E.appendChild(D),E.appendChild(S),i.appendChild(E)):(D&&i.insertBefore(D,i.firstElementChild),i.appendChild(S)),M&&i.appendChild(M)},o.prototype.getColor=function(t){if(t==="LB")return["#008aef"];for(var e=t.split(""),i=[],r=0;r<e.length;r++)switch(e[r]){case"G":i.push("#63be7b");break;case"Y":i.push("#ffeb84");break;case"R":i.push("#f8696b");break;case"W":i.push("#ffffff");break;case"B":i.push("#5a8ac6");break;case"O":i.push("#ffb628");break;case"LB":i.push("#008aef");break;case"P":i.push("#d6007b");break}return i},o.prototype.getGradient=function(t,e,i,r,n){if(g(r))return this.getLinear(e,i,t/n);var s=n/2;return t>=s?this.getLinear(i,r,Math.abs((t-s)/s)):this.getLinear(e,i,t/s)},o.prototype.getLinear=function(t,e,i){var r=this.byteLinear(t[1]+t[2],e[1]+e[2],i),n=this.byteLinear(t[3]+t[4],e[3]+e[4],i),s=this.byteLinear(t[5]+t[6],e[5]+e[6],i);return"#"+r+n+s},o.prototype.byteLinear=function(t,e,i){var r=parseInt(t,16)*(1-i)+parseInt(e,16)*i|0;return Math.abs(r).toString(16)},o.prototype.isGreaterThanLessThan=function(t,e,i,r){if(De(e)&&r!=="Text")if(De(i)){var n=new RegExp(/[^.-a-zA-Z 0-9]+/g);return t.type==="GreaterThan"?parseFloat(e)>parseFloat(i.replace(n,"")):parseFloat(e)<parseFloat(i.replace(n,""))}else{var s={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};if(this.parent.notify(Jr,s),s.isDate||s.isTime)return t.value=s.updatedVal.toString(),t.type==="GreaterThan"?Number(e)>Number(s.updatedVal):Number(e)<Number(s.updatedVal);if(i)return t.type==="GreaterThan"?e.toLowerCase()>i.toLowerCase():De(i)?e.toLowerCase()<i.toLowerCase():ge.fnSort("ascending")(e,i.toLowerCase())<0}else if(t.type==="LessThan"){if(e===""&&(!De(i)||Number(i)>0))return!0;if(!De(i)){var s={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};if(this.parent.notify(Jr,s),s.isDate||s.isTime)t.value=s.updatedVal.toString();else if(ge.fnSort("ascending")(e.toLowerCase(),i.toLowerCase())<0)return!0}}return!1},o.prototype.isBetWeen=function(t,e,i,r,n){var s,a;if(!n){var l=new RegExp(/[^.-a-zA-Z 0-9]+/g);i=i.replace(l,""),r=r.replace(l,"")}if(De(i)){var h=parseFloat(i),c=parseFloat(r);return h>c&&(s=[c,h],h=s[0],c=s[1]),parseFloat(e)>=h&&parseFloat(e)<=c}else if(i&&r){var u={value:i,cell:{},updatedVal:""},d={value:r,cell:{},updatedVal:""};return this.parent.notify(Jr,u),this.parent.notify(Jr,d),(u.isDate||u.isTime)&&(d.isDate||d.isTime)?(t.value=u.updatedVal+","+d.updatedVal,u.updatedVal>d.updatedVal&&(a=[d.updatedVal,u.updatedVal],u.updatedVal=a[0],d.updatedVal=a[1]),e>=u.updatedVal&&e<=d.updatedVal):e.toLowerCase()>=i.toLowerCase()&&e.toLowerCase()<=r.toLowerCase()}return!1},o.prototype.isEqualTo=function(t,e,i){if(De(i)){if(e==="")return parseFloat(i)===0;var r=new RegExp(/[^.-a-zA-Z 0-9]+/g);return parseFloat(e)===parseFloat(i.replace(r,""))}else{if(!e||!i)return!1;var n={value:i,cell:{},updatedVal:""};return this.parent.notify(Jr,n),n.isTime||n.isDate?(t.value=n.updatedVal,e===n.updatedVal):e.toLowerCase()===i.toLowerCase()}},o.prototype.isContainsText=function(t,e){var i=new RegExp(/[^.-a-zA-Z 0-9]+/g);return De(e.replace(i,""))?(e=e.replace(i,""),_o(t)&&(t=ls(t).toString()),t.indexOf(e)>-1):_o(e)?(_o(t)&&(t=ls(t).toString()),t.indexOf(ls(e).toString())>-1):t.toLowerCase().indexOf(e.toLowerCase())>-1},o.prototype.setCFStyle=function(t,e){switch(e.cFColor){case"RedFT":t.backgroundColor="#ffc7ce",t.color="#9c0055";break;case"YellowFT":t.backgroundColor="#ffeb9c",t.color="#9c6500";break;case"GreenFT":t.backgroundColor="#c6efce",t.color="#006100";break;case"RedF":t.backgroundColor="#ffc7ce";break;case"RedT":t.color="#9c0055";break}return t},o.prototype.getModuleName=function(){return"conditionalFormatting"},o})(),K9=(function(){function o(t){this.fillOptionIndex=0,this.parent=t,this.addEventListener()}return o.prototype.getfillItems=function(){var t=this.parent.serviceLocator.getService(ve);return[{text:t.getConstant("CopyCells")},{text:t.getConstant("FillSeries")},{text:t.getConstant("FillFormattingOnly")},{text:t.getConstant("FillWithoutFormatting")}]},o.prototype.createAutoFillElement=function(){if(this.parent.allowAutoFill){var t=this.parent.getMainContent(),e=this.parent.createElement("div",{className:"e-autofill"});t.lastElementChild&&t.lastElementChild.classList.contains("e-ss-overlay")?t.insertBefore(e,t.getElementsByClassName("e-ss-overlay")[0]):t.appendChild(e),this.autoFillElement=e,this.autoFillDropDown&&(this.autoFillDropDown.destroy(),this.autoFillDropDown=null),this.getautofillDDB({id:this.parent.element.id+"_autofilloptionbtn",appendElem:t})}},o.prototype.getautofillDDB=function(t){var e=this;return this.splitBtnElem=this.parent.createElement("button",{id:t.id,className:"e-filloption",attrs:{type:"button"}}),this.splitBtnElem.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"})),this.autoFillDropDown=new Hr({cssClass:"e-dragfill-ddb",iconCss:"e-icons e-dragfill-icon",items:this.getfillItems(),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(i){e.autoFillOptionClick({type:e.getFillType(i.item.text)})},beforeOpen:function(){return e.autoFillClick()}}),this.autoFillDropDown.createElement=this.parent.createElement,this.autoFillDropDown.appendTo(this.splitBtnElem),t.appendElem.appendChild(this.splitBtnElem),this.autoFillDropDown},o.prototype.getFillType=function(t){var e=this.parent.serviceLocator.getService(ve),i;return t===e.getConstant("CopyCells")?i="CopyCells":t===e.getConstant("FillSeries")?i="FillSeries":t===e.getConstant("FillFormattingOnly")?i="FillFormattingOnly":i="FillWithoutFormatting",i},o.prototype.autoFillClick=function(){var t=this.parent.serviceLocator.getService(ve),e={fillType:"FillSeries",disableItems:[""]};this.parent.notify(FM,e),this.autoFillDropDown.setProperties({items:this.getfillItems()},!0),this.autoFillDropDown.removeItems(e.disableItems),this.refreshAutoFillOption(t.getConstant(e.fillType))},o.prototype.getFillRange=function(t,e,i,r){switch(r){case"Up":return[i.rowIndex,t.colIndex,t.rowIndex-1,e.colIndex];case"Right":return[t.rowIndex,e.colIndex+1,e.rowIndex,i.colIndex];case"Down":return[e.rowIndex+1,t.colIndex,i.rowIndex,e.colIndex];case"Left":return[t.rowIndex,i.colIndex,e.rowIndex,t.colIndex-1]}},o.prototype.autoFillOptionClick=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.getActiveSheet(),r=tt(ie(this.parent.selectionModule.dAutoFillCell)),n=ie(i.selectedRange),s=r[0],a=r[1],l=r[2],h=r[3],c=this.getDirection({rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]}),u=[s,a,l,h],d=this.getFillRange({rowIndex:s,colIndex:a},{rowIndex:l,colIndex:h},{rowIndex:n[2],colIndex:n[3]},c);this.refreshAutoFillOption(e.getConstant(t.type));var p={isUndo:!0,isPublic:!0,preventReSelect:!0,preventEvt:t.type==="FillWithoutFormatting",setCollection:t.type==="FillFormattingOnly"||t.type==="FillWithoutFormatting",isFromAutoFillOption:!0};this.parent.notify(yo,p);var f={dataRange:i.name+"!"+Ve(u),fillRange:i.name+"!"+Ve(d),direction:c,fillType:t.type,isFillOptClick:!0};this.isVerticalFill=f.direction==="Down"||f.direction==="Up",this.parent.notify(Vd,f),this.positionAutoFillElement({isautofill:!0});var v={dataRange:f.dataRange,fillRange:f.fillRange,fillType:f.fillType,direction:f.direction,selectedRange:i.name+"!"+Ve(n),undoArgs:p.undoArgs};this.parent.notify(wt,{eventArgs:v,action:"autofill"}),this.parent.showAggregate&&this.parent.notify(jl,{}),this.autoFillClick()},o.prototype.refreshAutoFillOption=function(t){for(var e=0;e<this.autoFillDropDown.items.length;e++)this.autoFillDropDown.items[e].iconCss="";for(var e=0;e<this.autoFillDropDown.items.length;e++)this.autoFillDropDown.items[e].text===t&&(this.autoFillDropDown.items[e].iconCss="e-icons e-selected-icon");["Copy Cells","Fill Series","Fill Formatting Only","Fill Without Formatting"].indexOf(t)<0&&(this.autoFillDropDown.items[this.fillOptionIndex].iconCss=""),this.autoFillDropDown.dataBind()},o.prototype.positionAutoFillElement=function(t){var e=this;if(t){if(t.onPropertyChange)this.createAutoFillElement();else if(t.isSelection){var i=this.parent.element.querySelector(".e-autofill");if(!i){delete t.isSelection,er(function(){return e.positionAutoFillElement(t)});return}}}var r=0,n=0,s=this.parent.getActiveSheet(),a=tt(ie(s.selectedRange)),l=-5,h=-5,c=6,u=6,d=a[1]===0&&a[3]===s.colCount-1,p=a[0]===0&&a[2]===s.rowCount-1,f=a[2],v=a[3],m,y,b,S=this.parent.enableRtl,C=this.parent.getCell(f,v);if(Ft(s,a[3])||lt(s,a[2])||C&&C.classList.contains("e-formularef-selection")||s.isProtected&&s.protectSettings.selectUnLockedCells&&Ko(this.parent,a)){this.hideAutoFillElement();return}if(s.isProtected&&(s.protectSettings.selectCells||s.protectSettings.selectUnLockedCells)||!s.isProtected){if(d?(l=-5,h=-1,c=6,u=2,f=a[2],v=a[1]):p&&(h=-5,l=0,c=1,u=6,f=a[0],v=a[3]),s.frozenColumns||s.frozenRows){if(p||d?(ra(this.parent,this.autoFillElement,a,"e-autofill",t&&t.preventAnimation),this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill&&ra(this.parent,this.autoFillDropDown.element,a,"e-filloption")):(ra(this.parent,this.autoFillElement,[f,v,f,v],"e-autofill",t&&t.preventAnimation),this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill&&ra(this.parent,this.autoFillDropDown.element,[f,v,f,v],"e-filloption")),this.autoFillElement){this.autoFillCell={rowIndex:f,colIndex:v};var x=this.parent.element.querySelectorAll(".e-autofill");if(x.length){var I=x[0].getBoundingClientRect();this.autoFillElementPosition={left:I.left,top:I.top},[].slice.call(x).forEach(function(R){Z([R],"e-hide")})}}}else if(b=Y0(s,[f,v,f,v],this.parent.frozenRowCount(s),this.parent.frozenColCount(s),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth),m=xi(s,f,f,!0),y=wi(s,v,v,!0),p||(r+=m),d||(n+=y),r+=Math.round(b.top)+l,n+=Math.round(b.left)+h,this.autoFillElement){Z([this.autoFillElement],"e-hide"),this.autoFillElement.style.top=r+"px",S?this.autoFillElement.style.right=n+"px":this.autoFillElement.style.left=n+"px",this.autoFillCell={rowIndex:f,colIndex:v};var I=this.autoFillElement.getBoundingClientRect();if(this.autoFillElementPosition={left:I.left,top:I.top},this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill){Z([this.autoFillDropDown.element],"e-hide");var D=this.parent.element.querySelector(".e-main-panel"),M=this.parent.element.querySelector(".e-main-panel .e-sheet-content .e-virtualable"),E=this.parent.element.querySelector(".e-sheet-panel .e-scrollbar .e-scroller"),A=M&&M.clientHeight<D.clientHeight?D.clientHeight-M.clientHeight:0,L=M&&M.clientWidth<D.clientWidth?D.clientWidth-M.clientWidth:0,N=this.autoFillDropDown.element.getBoundingClientRect();D.scrollTop+D.clientHeight-A<r+N.height&&(r-=N.height),E.scrollLeft+E.clientWidth-L<n+N.width&&(n-=N.width),this.autoFillDropDown.element.style.top=r+c+"px",this.autoFillDropDown.element.style.width=parseFloat(N.width.toFixed(2))+"px",S?this.autoFillDropDown.element.style.right=n+u+"px":this.autoFillDropDown.element.style.left=n+u+"px"}}}},o.prototype.hideAutoFillElement=function(){var t=this.parent.element;[].slice.call(t.querySelectorAll(".e-autofill")).forEach(function(e){t&&X([e],"e-hide")})},o.prototype.hideAutoFillOptions=function(){var t=this.parent.element;[].slice.call(t.querySelectorAll(".e-filloption")).forEach(function(e){t&&X([e],"e-hide")})},o.prototype.selectAutoFillRange=function(t){var e={clientY:Wo(t.e),target:t.e.target},i={clientX:Uo(t.e),target:t.e.target},r=this.parent.getActiveSheet();this.parent.notify(Is,e),this.parent.notify(Ms,i);var n,s=this.getAutoFillRange({rowIndex:e.clientY,colIndex:i.clientX});return s&&s.fillRange?n=[s.startCell.rowIndex,s.startCell.colIndex,s.endCell.rowIndex,s.endCell.colIndex]:n=ie(r.selectedRange),t.indexes=n,n},o.prototype.getAutoFillRange=function(t){var e=this.parent.getActiveSheet(),i=this.autoFillCell,r=tt(ie(e.selectedRange)),n=r[0],s=r[1],a=r[2],l=r[3],h=Dg(r,[t.rowIndex,t.colIndex,t.rowIndex,t.colIndex],!0),c={rowIndex:n,colIndex:s},u={rowIndex:r[0],colIndex:r[1]},d={rowIndex:r[2],colIndex:r[3]},p={rowIndex:a,colIndex:l},f=this.modifyRangeForMerge(t.rowIndex,t.colIndex,i.rowIndex,i.colIndex,r);return t.rowIndex<i.rowIndex?n-t.rowIndex>t.colIndex-l&&n-t.rowIndex>s-t.colIndex?h?{startCell:c,endCell:{rowIndex:t.rowIndex,colIndex:l}}:{startCell:p,endCell:{rowIndex:f.rowIndex,colIndex:s},fillRange:[f.rowIndex,s,n-1,l],direction:"Up"}:t.colIndex>i.colIndex?{startCell:c,endCell:{rowIndex:a,colIndex:t.colIndex},fillRange:[n,l+1,a,t.colIndex],direction:"Right"}:t.colIndex<i.colIndex?h?{startCell:c,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:t.colIndex},fillRange:[n,t.colIndex,a,s-1],direction:"Left"}:{startCell:u,endCell:d}:t.colIndex>i.colIndex?t.rowIndex-a>t.colIndex-l?{startCell:c,endCell:{rowIndex:t.rowIndex,colIndex:l},fillRange:[a+1,s,t.rowIndex,l],direction:"Down"}:{startCell:c,endCell:{rowIndex:a,colIndex:f.colIndex},fillRange:[n,l+1,a,f.colIndex],direction:"Right"}:t.colIndex<i.colIndex?t.rowIndex-a>l-t.colIndex||t.rowIndex-n>l-t.colIndex&&t.rowIndex!==a?{startCell:c,endCell:{rowIndex:t.rowIndex,colIndex:l},fillRange:[a+1,s,t.rowIndex,l],direction:"Down"}:h?{startCell:c,endCell:p}:{startCell:p,endCell:{rowIndex:n,colIndex:f.colIndex},fillRange:[n,f.colIndex,a,s-1],direction:"Left"}:t.rowIndex>i.rowIndex?{startCell:c,endCell:{rowIndex:f.rowIndex,colIndex:l},fillRange:[a+1,s,f.rowIndex,l],direction:"Down"}:t.rowIndex===i.rowIndex&&t.colIndex===i.colIndex?{startCell:u,endCell:d}:{startCell:u,endCell:d}},o.prototype.modifyRangeForMerge=function(t,e,i,r,n){var s={rowIndex:t,colIndex:e};if(this.isMergedRange(n)){var a=n[2]-n[0]+1,l=n[3]-n[1]+1,h=void 0;t<i?(h=(n[2]-t+1)%a,h&&t-(a-h)>=0&&(s.rowIndex=t-(a-h))):e>r?(h=(e-n[1]+1)%l,h&&(s.colIndex=e+(l-h))):e<r?(h=(n[3]-e+1)%l,h&&e-(l-h)>=0&&(s.colIndex=e-(l-h))):t>i&&(h=(t-n[0]+1)%a,h&&(s.rowIndex=t+(a-h)))}return s},o.prototype.performAutoFill=function(t){if(t.rangeInfo||!(t.event.clientX>this.autoFillElementPosition.left&&t.event.clientX<this.autoFillElementPosition.left+10)||!(t.event.clientY>this.autoFillElementPosition.top&&t.event.clientY<this.autoFillElementPosition.top+10)){var e=void 0;if(t.rangeInfo)e=t.rangeInfo;else{var i={clientY:Wo(t.event),target:t.event.target},r={clientX:Uo(t.event),target:t.event.target};this.parent.notify(Is,i),this.parent.notify(Ms,r),e=this.getAutoFillRange({rowIndex:i.clientY,colIndex:r.clientX})}var n=this.parent.getActiveSheet();if(e&&e.fillRange){var s={dataRange:n.name+"!"+t.dAutoFillCell,fillRange:n.name+"!"+Ve(e.fillRange),direction:e.direction,fillType:t.fillType||this.parent.autoFillSettings.fillType,cancel:!1},a=Hi(this.parent,ie(t.dAutoFillCell))||Hi(this.parent,e.fillRange);if(a){this.parent.notify(fr,null);return}if(this.parent.notify(hi,{eventArgs:s,action:"autofill"}),s.cancel)return;var l=Ko(this.parent,e.fillRange);if(n.isProtected&&l){this.parent.notify(Ra,null);return}t.rangeInfo?this.performAutoFillAction(s,null,l):(this.performAutoFillAction(s,e,l),this.positionAutoFillElement({isautofill:!0}))}}else this.positionAutoFillElement({isautofill:!1})},o.prototype.refreshCell=function(t){this.parent.serviceLocator.getService("cell").refreshRange([t.rowIndex,t.colIndex,t.rowIndex,t.colIndex])},o.prototype.getDirection=function(t,e,i){if(i=g(i)?this.isVerticalFill:i,i){if(e.rowIndex<t.rowIndex)return"Up";if(e.rowIndex>t.rowIndex)return"Down";if(e.colIndex>t.colIndex)return"Right";if(e.colIndex<t.colIndex)return"Left"}else{if(e.colIndex>t.colIndex)return"Right";if(e.colIndex<t.colIndex)return"Left";if(e.rowIndex<t.rowIndex)return"Up";if(e.rowIndex>t.rowIndex)return"Down"}return null},o.prototype.performAutoFillAction=function(t,e,i){var r=this,n=this.parent.getActiveSheet(),s=this.parent.serviceLocator.getService(ve);if(this.isMergedRange(ie(t.fillRange))){var a=this.parent.serviceLocator.getService(jt);a.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:s.getConstant("AutoFillMergeAlertMsg"),buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(ve).getConstant("Ok"),isPrimary:!0},click:function(){a.hide(),r.parent.selectRange(t.dataRange)}}],close:function(){a.hide(),r.parent.selectRange(t.dataRange)}},!1);return}this.isVerticalFill=t.direction==="Down"||t.direction==="Up",this.parent.notify(Vd,{dataRange:t.dataRange,fillRange:t.fillRange,direction:t.direction,fillType:t.fillType,isLockedCell:i});var l=e?Ve([e.startCell.rowIndex,e.startCell.colIndex,e.endCell.rowIndex,e.endCell.colIndex]):n.selectedRange;lg(this.parent,l,n);var h={dataRange:t.dataRange,fillRange:t.fillRange,fillType:t.fillType,direction:t.direction,selectedRange:l};this.parent.notify(wt,{eventArgs:h,action:n.conditionalFormats&&n.conditionalFormats.length>0&&n.conditionalFormats[n.conditionalFormats.length-1].action==="autofillWithCF"?"autofillWithCF":"autofill"}),this.parent.trigger("select",{range:this.parent.getActiveSheet().selectedRange}),this.parent.showAggregate&&this.parent.notify(jl,{}),this.parent.notify(Hs,null)},o.prototype.getRangeData=function(t){for(var e=[],i=this.parent.getActiveSheet(),r=t.range[0],n=t.range[1],s=t.range[2],a=t.range[3],l=n,h;r<=s;){if(lt(i,r)){r++;continue}for(n=l;n<=a;){if(Ft(i,n)){n++;continue}h=Q(r,n,i),e.push(h),n++}r++}return e},o.prototype.isMergedRange=function(t){var e=0,i=this.getRangeData({range:t,sheetIdx:this.parent.activeSheetIndex});for(e=0;e<i.length;e++)if(i[e]&&(i[e].rowSpan||i[e].colSpan))return!0;return!1},o.prototype.addEventListener=function(){this.parent.on(Ln,this.createAutoFillElement,this),this.parent.on(Oa,this.positionAutoFillElement,this),this.parent.on(O0,this.hideAutoFillOptions,this),this.parent.on(zh,this.hideAutoFillElement,this),this.parent.on(z0,this.performAutoFill,this),this.parent.on(OD,this.selectAutoFillRange,this),this.parent.on(az,this.refreshCell,this),this.parent.on($b,this.getautofillDDB,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ln,this.createAutoFillElement),this.parent.off(Oa,this.positionAutoFillElement),this.parent.off(O0,this.hideAutoFillOptions),this.parent.off(zh,this.hideAutoFillElement),this.parent.off(z0,this.performAutoFill),this.parent.off(OD,this.selectAutoFillRange),this.parent.off(az,this.refreshCell),this.parent.off($b,this.getautofillDDB))},o.prototype.destroy=function(){this.removeEventListener(),this.autoFillElement&&this.autoFillElement.remove(),this.autoFillElement=null,this.autoFillElementPosition=null,this.autoFillCell=null,this.autoFillDropDown&&this.autoFillDropDown.destroy(),this.autoFillDropDown=null,this.isVerticalFill=null,this.fillOptionIndex=null,this.splitBtnElem&&(lo(this.splitBtnElem),this.splitBtnElem.remove()),this.splitBtnElem=null,this.parent=null},o.prototype.getModuleName=function(){return"autofill"},o})(),$9=(function(){function o(t){this.isNoteVisible=!1,this.isNoteVisibleOnTouch=!1,this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){if(this.removeEventListener(),!this.parent.isDestroyed&&!this.parent.refreshing)for(var t=this.parent.element.getElementsByClassName("e-addNoteIndicator");t.length;){var e=H(t[0],".e-cell");e&&(T.remove(e,"mouseover",this.mouseOver),T.remove(e,"mouseout",this.mouseOut)),se(t[0])}this.parent=null,this.isNoteVisible=null},o.prototype.addEventListener=function(){this.parent.on(d0,this.addNote,this),this.parent.on(p0,this.editNote,this),this.parent.on(kg,this.deleteNote,this),this.parent.on(Zd,this.createNoteIndicator,this),this.parent.on(Ld,this.showNote,this),this.parent.on(jc,this.removeNoteContainer,this),this.parent.on(uD,this.updateNoteContainer,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(d0,this.addNote),this.parent.off(p0,this.editNote),this.parent.off(Ld,this.showNote),this.parent.off(kg,this.deleteNote),this.parent.off(Zd,this.createNoteIndicator),this.parent.off(jc,this.removeNoteContainer),this.parent.off(uD,this.updateNoteContainer))},o.prototype.getModuleName=function(){return"spreadsheetNote"},o.prototype.addNote=function(){var t=g(this.noteCellIndexes)?xe(this.parent.getActiveSheet().activeCell):this.noteCellIndexes,e=this.parent.getCell(t[0],t[1]);!g(e)&&(e.children.length===0||e.children.length>0&&e.children[e.childElementCount-1].className.indexOf("e-addNoteIndicator")===-1)&&(this.createNoteIndicator({targetElement:e,rowIndex:t[0],columnIndex:t[1]}),this.createNoteContainer(e,t[0],t[1],!1,!0))},o.prototype.deleteNote=function(t){var e=xe(this.parent.getActiveSheet().activeCell),i=!g(t)&&!g(t.rowIndex)?t.rowIndex:e[0],r=!g(t)&&!g(t.columnIndex)?t.columnIndex:e[1],n=this.parent.getCell(i,r);if(n.children.length>0&&n.children[n.children.length-1].className.indexOf("e-addNoteIndicator")>-1){n.removeChild(n.children[n.children.length-1]),T.remove(n,"mouseover",this.mouseOver),T.remove(n,"mouseout",this.mouseOut);var s=Gn(this.parent,this.parent.activeSheetIndex)+"!"+this.parent.getActiveSheet().activeCell,a=Q(i,r,this.parent.getActiveSheet());if(!g(t)&&t.isDeleteFromMenu&&this.parent.notify(Hh,{args:{action:"beforeCellSave",eventArgs:{address:s}}}),!g(a)&&a.notes&&delete a.notes,!g(t)&&t.isDeleteFromMenu){var l={notes:a.notes,address:s};this.parent.notify(wt,{eventArgs:l,action:"deleteNote"}),this.isShowNote=null}}},o.prototype.editNote=function(){var t=g(this.noteCellIndexes)?xe(this.parent.getActiveSheet().activeCell):this.noteCellIndexes;this.showNote({rowIndex:t[0],columnIndex:t[1],isNoteEditable:!0});var e=document.getElementsByClassName("e-addNoteContainer")[0];gr(this.parent,this.parent.getActiveSheet(),{rowIdx:t[0],colIdx:t[1],preventEvt:!0,cell:{isNoteEditable:!0}}),e&&this.getNoteFocus(e)},o.prototype.createNoteIndicator=function(t){var e=this.parent.enableRtl?"left: 0; border-right: 8px solid transparent;":"right: 0; border-left: 8px solid transparent;",i=this.parent.createElement("div",{className:"e-addNoteIndicator",styles:"position: absolute; top: 0; width: 0; height: 0; border-top: 8px solid red; cursor: pointer; "+e});if(t.targetElement.children.length>0)for(var r=ei(this.parent.getActiveSheet(),t.rowIndex),n=20,s=0;s<t.targetElement.childElementCount;s++)t.targetElement.children[s].className.indexOf("e-filter-btn")>-1&&(this.parent.enableRtl?i.style.left=(r<n+10?t.targetElement.children[s].getBoundingClientRect().width<=0?n:t.targetElement.children[s].getBoundingClientRect().width:2)+"px":i.style.right=(r<n+10?t.targetElement.children[s].getBoundingClientRect().width<=0?n:t.targetElement.children[s].getBoundingClientRect().width:2)+"px"),t.targetElement.children[s].className.indexOf("e-validation-list")>-1&&(this.parent.enableRtl?i.style.left=(t.targetElement.children[s].getBoundingClientRect().width||20)+2+"px":i.style.right=(t.targetElement.children[s].getBoundingClientRect().width||20)+2+"px");(!g(t.targetElement)&&t.targetElement.children.length===0||t.targetElement.children.length>0&&t.targetElement.children[t.targetElement.childElementCount-1].className.indexOf("e-addNoteIndicator")===-1)&&(t.skipEvent||(T.add(t.targetElement,"mouseover",this.mouseOver,[this,t.rowIndex,t.columnIndex]),T.add(t.targetElement,"mouseout",this.mouseOut,this)),t.targetElement.appendChild(i))},o.prototype.mouseOver=function(){var t=this,e=t[0];(e.isNoteVisibleOnTouch&&!g(document.getElementsByClassName("e-addNoteContainer")[0])||g(document.getElementsByClassName("e-addNoteContainer")[0]))&&(g(document.getElementsByClassName("e-addNoteContainer")[0])||e.removeNoteContainer(),e.showNote({rowIndex:t[1],columnIndex:t[2],isNoteEditable:!1}),e.isNoteVisible=!0)},o.prototype.mouseOut=function(t){this.isNoteVisible&&!this.isNoteVisibleOnTouch&&!g(document.getElementsByClassName("e-addNoteContainer")[0])&&document.activeElement.className.indexOf("e-addNoteContainer")===-1&&!g(t.relatedTarget)&&t.relatedTarget.className.indexOf("e-connectorLine")===-1&&t.relatedTarget.className.indexOf("e-addNoteContainer")===-1&&(this.removeNoteContainer(),this.isNoteVisible=!1)},o.prototype.createNoteContainer=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),a=Q(e,i,s),l=t.getBoundingClientRect(),h=this.parent.createElement("textarea",{className:"e-addNoteContainer"});this.createContainer(h,a,l,r),this.createConnectorLine(h,l),n&&this.getNoteFocus(h),T.add(h,"mouseout",this.mouseOut,this),T.add(document.getElementsByClassName("e-connectorLine")[0],"mouseout",this.mouseOut,this)},o.prototype.getNoteFocus=function(t){t.selectionStart=t.value.length,t.focus()},o.prototype.createContainer=function(t,e,i,r){var n=5,s=this.parent.element.getElementsByClassName("e-select-all-cell")[0],a=this.parent.element.getElementsByClassName("e-scroller")[0];if(!g(s)&&!g(a)&&i.top>=s.getBoundingClientRect().bottom&&i.bottom<=a.getBoundingClientRect().top){var l=this.parent.enableRtl?i.left<=s.getBoundingClientRect().left&&i.left>=a.getBoundingClientRect().left:i.right>=s.getBoundingClientRect().right&&i.right<=a.getBoundingClientRect().right;l?(t.style.display="block",n=i.top===s.getBoundingClientRect().bottom?0:n):t.style.display="none"}else t.style.display="none";var h=this.parent.element.getBoundingClientRect(),c=this.parent.element.style.getPropertyValue("position");t.style.position="absolute",t.style.top=i.top-(h.top-(c==="absolute"?0:this.parent.element.offsetTop))-n+"px";var u,d=120,p=c==="absolute"?0:this.parent.element.offsetLeft;this.parent.enableRtl?u=i.left-(h.left-p)-d-10:u=i.left+i.width-(h.left-p)+10,t.style.left=u+"px",t.style.width=d+"px",t.style.height="120px",t.style.zIndex="5",t.style.color="black",t.style.backgroundColor="lightyellow",r&&!g(e)&&!g(e.notes)?t.innerHTML=e.notes:t.innerHTML="",this.parent.element.appendChild(t)},o.prototype.createConnectorLine=function(t,e){var i=100,r=this.parent.createElement("canvas",{className:"e-connectorLine",styles:"width: "+i+"px; position: absolute;  z-index: 1;"}),n=r.getContext("2d"),s=this.parent.element.getBoundingClientRect(),a=this.parent.element.style.getPropertyValue("position"),l=a==="absolute"?0:this.parent.element.offsetLeft;this.parent.enableRtl?(r.style.left=e.left-(s.left-l)-i+"px",r.style.transform="scaleX(-1)"):r.style.left=e.left+e.width-(s.left-l)+"px",r.style.top=t.getBoundingClientRect().top-(s.top-(a==="absolute"?0:this.parent.element.offsetTop))-5+"px",n.clearRect(0,0,r.width,r.height),n.beginPath(),t.getBoundingClientRect().top===e.top?(n.moveTo(0,16),n.lineTo(30,15)):(n.moveTo(0,30),n.lineTo(30,15)),n.strokeStyle="black",n.lineWidth=5,n.stroke(),this.parent.element.appendChild(r),t.getBoundingClientRect().top>0?(r.style.display="block",r.style.zIndex="4"):r.style.display="none"},o.prototype.showNote=function(t){var e=g(this.parent.getCell(t.rowIndex,t.columnIndex))?t.cellElement:this.parent.getCell(t.rowIndex,t.columnIndex),i=document.getElementById(this.parent.element.id+"_contextmenu"),r=g(i)?"none":i.style.getPropertyValue("display"),n=t.isNoteEditable?!0:r!=="block";!g(e)&&g(document.getElementsByClassName("e-addNoteContainer")[0])&&n&&(t.isScrollWithNote||e.children!==null&&e.children.length>0&&e.children[e.children.length-1].classList.contains("e-addNoteIndicator"))&&(this.createNoteContainer(e,t.rowIndex,t.columnIndex,!0,t.isNoteEditable),this.noteCellIndexes=[t.rowIndex,t.columnIndex])},o.prototype.removeNoteContainer=function(){T.remove(document.getElementsByClassName("e-addNoteContainer")[0],"mouseout",this.mouseOut),T.remove(document.getElementsByClassName("e-connectorLine")[0],"mouseout",this.mouseOut),this.parent.element.removeChild(document.getElementsByClassName("e-addNoteContainer")[0]),this.parent.element.removeChild(document.getElementsByClassName("e-connectorLine")[0]),this.noteCellIndexes=null,this.isNoteVisible=!1,this.isNoteVisibleOnTouch=!1},o.prototype.updateNoteContainer=function(){this.parent.selectionModule.isNoteActiveElement=document.activeElement.className.indexOf("e-addNoteContainer")>-1?!0:this.parent.selectionModule.isNoteActiveElement;var t=g(this.noteCellIndexes)?xe(this.parent.getActiveSheet().activeCell):this.noteCellIndexes,e=Q(t[0],t[1],this.parent.getActiveSheet()),i=document.getElementsByClassName("e-addNoteContainer")[0];if((g(e)||g(e.notes)||e.notes!==i.value)&&this.parent.selectionModule.isNoteActiveElement){var r=Gn(this.parent,this.parent.activeSheetIndex)+"!"+Ve(t);this.parent.notify(Hh,{args:{action:"beforeCellSave",eventArgs:{address:r}}});var n=!g(e)&&e.notes?"editNote":"addNote";gr(this.parent,this.parent.getActiveSheet(),{rowIdx:t[0],colIdx:t[1],preventEvt:!0,cell:{notes:i.value,isNoteEditable:!0}});var s={notes:i.value,address:r};this.parent.notify(wt,{eventArgs:s,action:n}),this.isShowNote=null}if(this.isShowNote=g(this.isShowNote)?this.parent.selectionModule.isNoteActiveElement:this.isShowNote,this.isShowNote){var a=!g(e)&&!g(e.isNoteEditable)?e.isNoteEditable:!1;this.parent.notify(jc,""),this.parent.notify(Ld,{rowIndex:t[0],columnIndex:t[1],isNoteEditable:!0,isScrollWithNote:a})}else this.parent.notify(jc,""),this.isShowNote=null},o})(),Z9=(function(){function o(t){this.parent=t}return o.prototype.show=function(t,e){var i=this,r;e=!!g(e);var n=t.beforeOpen||null,s=t.close||null,a={header:"Spreadsheet",cssClass:this.parent.cssClass,target:this.parent.element,buttons:[],allowDragging:!0};t.beforeOpen=function(h){n&&(n(h),h.cancel&&(i.hide(!0),h.preventFocus||Re(i.parent.element)))},t.close=function(){i.destroyDialog(),s&&s()},pe(a,t),e&&(r=this.parent.serviceLocator.getService(ve).getConstant(a.buttons.length?"Cancel":"Ok"),a.buttons.push({buttonModel:{content:r,isPrimary:a.buttons.length===0},click:this.hide.bind(this)}));var l=this.parent.createElement("div");document.body.appendChild(l),this.dialogInstance=new cc(a),this.dialogInstance.createElement=this.parent.createElement,this.dialogInstance.appendTo(l),this.dialogInstance&&(this.parent.enableRtl&&this.dialogInstance.isModal&&(this.dialogInstance.element.style.position="relative"),this.dialogInstance.refreshPosition())},o.prototype.destroyDialog=function(){this.dialogInstance.destroy(),Qe(this.dialogInstance.element),this.dialogInstance=null},o.prototype.hide=function(t){this.dialogInstance&&(t&&(this.dialogInstance.animationSettings.effect="None",this.dialogInstance.dataBind()),this.dialogInstance.hide())},o.prototype.destroy=function(){this.parent=null},o})(),J9=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.initializeActionBegin=function(){var t=this,e=this.parent.beforeCellFormat;this.parent.beforeCellFormat=function(s){t.actionEventHandler({evtArgs:s,evtFunc:e,actionType:"begin",eventType:"format"})};var i=this.parent.beforeOpen;this.parent.beforeOpen=function(s){t.actionEventHandler({evtArgs:s,evtFunc:i,actionType:"begin",eventType:"beforeOpen"})};var r=this.parent.beforeSave;this.parent.beforeSave=function(s){t.actionEventHandler({evtArgs:s,evtFunc:r,actionType:"begin",eventType:"beforeSave"})};var n=this.parent.beforeSort;this.parent.beforeSort=function(s){t.actionEventHandler({evtArgs:s,evtFunc:n,actionType:"begin",eventType:"beforeSort"})}},o.prototype.initializeActionComplete=function(){var t=this,e=this.parent.sortComplete;this.parent.sortComplete=function(r){t.actionEventHandler({evtArgs:r,evtFunc:e,actionType:"complete",eventType:"sorting"})};var i=this.parent.cellSave;this.parent.cellSave=function(r){t.actionEventHandler({evtArgs:r,evtFunc:i,actionType:"complete",eventType:"cellSave"})}},o.prototype.actionEventHandler=function(t){t.evtFunc&&t.evtFunc.apply(this,[t]),t.actionType==="begin"?this.actionBeginHandler({eventArgs:t.evtArgs,action:t.eventType}):this.actionCompleteHandler({eventArgs:t.evtArgs,action:t.eventType})},o.prototype.actionBeginHandler=function(t){var e=t.preventAction;delete t.preventAction;var i={action:t.action};t.isUndo&&(i.isUndo=!0,delete t.isUndo),t.isRedo&&(i.isUndo=!1,delete t.isRedo),i.args=t,this.parent.trigger("actionBegin",i),!e&&!this.parent.isPrintingProcessing&&(t.action==="clipboard"||t.action==="format"||t.action==="cellSave"||t.action==="addNote"||t.action==="editNote"||t.action==="deleteNote"||t.action==="beforeWrap"||t.action==="beforeReplace"||t.action==="filter"||t.action==="beforeClear"||t.action==="beforeInsertImage"||t.action==="beforeInsertChart"||t.action==="chartDesign"||t.action==="cellDelete"||t.action==="autofill"||t.action==="validation"||t.action==="removeValidation"||t.action==="hyperlink"||t.action==="removeHyperlink"||t.action==="deleteImage")&&this.parent.notify(Hh,{args:t}),e&&(t.preventAction=!0),i.isUndo&&(t.isUndo=!0),i.isUndo===!1&&(t.isRedo=!0)},o.prototype.actionCompleteHandler=function(t){var e=t.preventAction;delete t.preventAction,this.parent.notify(dg,t),t.preventEventTrigger||this.parent.trigger("actionComplete",t),!e&&t.action!=="undoRedo"&&t.action!=="gotoSheet"&&this.parent.notify(m0,{args:t}),this.parent.notify(Oa,null)},o.prototype.addEventListener=function(){this.parent.on(wt,this.actionCompleteHandler,this),this.parent.on(hi,this.actionBeginHandler,this),this.parent.on(Xn,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(wt,this.actionCompleteHandler),this.parent.off(hi,this.actionBeginHandler),this.parent.off(Xn,this.removeEventListener)},o})(),eG=(function(){function o(t){this.minHeight="300px",this.minWidth="400px",this.isOverlayClicked=!1,this.isResizerClicked=!1,this.currentWidth=400,this.currenHeight=300,this.parent=t,this.parent.on(Bg,this.isOverlaySelected,this),this.parent.on(Nd,this.refreshOverlayElem,this),this.parent.on(Xn,this.destroy,this)}return o.prototype.insertOverlayElement=function(t,e,i){var r=this.parent.createElement("div",{id:t,attrs:{class:"e-ss-overlay"},styles:"width: "+this.minWidth+";  height: "+this.minHeight});if(this.parent.allowEditing){var n=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0];n&&(Z([n],"e-ss-overlay-active"),this.parent.notify(Go,{})),r.classList.add("e-ss-overlay-active")}var s=ie(e),a=this.parent.sheets[i],l=this.parent.frozenRowCount(a),h=this.parent.frozenColCount(a),c=Y0(a,s,l,h,this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth,!0);if(s[0]>=l&&s[1]<h){var u=this.parent.sheetModule.contentPanel;u.scrollTop&&(c.top-=u.scrollTop,c.top+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height)}if(s[1]>=h&&s[0]<l){var d=this.parent.getScrollElement();d.scrollLeft&&(c.left-=d.scrollLeft,c.left+=this.parent.sheetModule.getRowHeaderWidth(a))}var p;return s[0]<l||s[1]<h?(p=this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),l&&(s[0]>=l?c.top+=(a.showHeaders?31:0)+xi(a,xe(a.topLeftCell)[0],l-1):h||(c.left+=this.parent.sheetModule.getRowHeaderWidth(a,!0))),h&&(s[1]>=h?c.left+=this.parent.sheetModule.getRowHeaderWidth(a):l||(c.left+=a.showHeaders?31:0))):p=this.parent.getMainContent(),r.style.top=Number(os(c.top).toFixed(2))+"px",r.style.left=Number(os(c.left).toFixed(2))+"px",i===this.parent.activeSheetIndex?(p.appendChild(r),this.renderResizeHandler(r),this.addEventListener(r)):this.parent.isPrintingProcessing&&(r.style.visibility="hidden",document.body.append(r)),this.originalWidth=parseFloat(getComputedStyle(r,null).getPropertyValue("width").replace("px","")),this.originalHeight=parseFloat(getComputedStyle(r,null).getPropertyValue("height").replace("px","")),{element:r,top:c.top,left:c.left}},o.prototype.adjustFreezePaneSize=function(t,e,i){var r=ie(i),n=this.parent.getActiveSheet(),s=this.parent.frozenRowCount(n),a=this.parent.frozenColCount(n);if(r[0]<s||r[1]<a?(g(t.top)||(e.style.top=t.top+(n.showHeaders?31:0)-this.parent.viewport.beforeFreezeHeight+"px"),g(t.left)||(e.style.left=t.left+this.parent.sheetModule.getRowHeaderWidth(n,!0)-this.parent.viewport.beforeFreezeWidth+"px")):(g(t.top)||(e.style.top=t.top-this.parent.viewport.beforeFreezeHeight-(s?xi(n,xe(n.topLeftCell)[0],s-1):0)+"px"),g(t.left)||(e.style.left=t.left-this.parent.viewport.beforeFreezeWidth-(a?wi(n,xe(n.topLeftCell)[1],a-1):0)+"px")),g(t.top)){var l=xe(n.topLeftCell)[0];t.top=this.parent.viewport.beforeFreezeHeight+(s&&l===r[0]?0:xi(n,s?l:0,r[0]-1))}if(g(t.left)){var h=xe(n.topLeftCell)[1];t.left=this.parent.viewport.beforeFreezeWidth+(a&&h===r[1]?0:wi(n,a?h:0,r[1]-1))}},o.prototype.addEventListener=function(t){var e=t;T.add(e,tp(),this.overlayClickHandler,this),T.add(e,Fh(),this.overlayMouseMoveHandler,this),T.add(this.parent.element.querySelector("#"+this.parent.element.id+"_sheet"),Fh(),this.overlayMouseMoveHandler,this),this.mouseUpHandler||(this.mouseUpHandler=this.overlayMouseUpHandler,T.add(document,Md(),this.mouseUpHandler,this)),this.parent.on(RD,this.setOriginalSize,this)},o.prototype.setOriginalSize=function(t){this.originalHeight=t.height,this.originalWidth=t.width},o.prototype.overlayMouseMoveHandler=function(t){var e=t.target,i=document.getElementsByClassName("e-ss-overlay-active")[0],r=this.parent.getActiveSheet(),n=r.frozenRows||r.frozenColumns?[29,this.parent.sheetModule.getRowHeaderWidth(r,!0)]:[-1,-1],s,a,l,h,c,u;if(this.isOverlayClicked&&this.isResizerClicked)switch(V0(t)&&t.preventDefault(),this.resizer){case"e-ss-overlay-t":s=Math.max(this.originalMouseY-Wo(t)+this.originalHeight,20),a=Wo(t)-(this.originalMouseY-this.originalResizeTop),s>20&&a>n[0]&&(i.style.height=s+"px",i.style.top=a+"px",this.resizedReorderTop=a,this.currenHeight=s,this.parent.notify(kh,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-r":l=this.originalWidth+(w9(t)-this.originalMouseX),l>20&&(i.style.width=l+"px",this.currentWidth=l,this.parent.notify(kh,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-b":h=this.originalHeight+(x9(t)-this.originalMouseY),h>20&&(i.style.height=h+"px",this.currenHeight=h,this.parent.notify(kh,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-l":c=Math.max(this.originalMouseX-Uo(t)+this.originalWidth,20),u=Uo(t)-(this.originalMouseX-this.originalResizeLeft),c>20&&u>n[1]&&(i.style.width=c+"px",i.style.left=u+"px",this.resizedReorderLeft=u,this.currentWidth=c,this.parent.notify(kh,{height:i.style.height,width:i.style.width,overlayEle:i}));break}else if(this.isOverlayClicked)if(V0(t)&&t.preventDefault(),H(e,".e-sheet")&&!e.classList.contains("e-sheet-content")||e.classList.contains("e-cell")){if(!i)return;var d=Uo(t)-this.diffX,p=Wo(t)-this.diffY;d>n[1]&&(i.style.left=d+"px"),p>n[0]&&(i.style.top=p+"px"),this.resizedReorderLeft=d<0?0:d,this.resizedReorderTop=p<0?0:p}else this.overlayMouseUpHandler(t,!0)},o.prototype.overlayMouseUpHandler=function(t,e){if(!(!this.parent||this.parent.getActiveSheet().isProtected||!this.parent.allowEditing)){this.isResizerClicked=!1;var i=t.target,r=document.getElementsByClassName("e-datavisualization-chart e-ss-overlay-active");i.classList.contains("e-ss-overlay")||(i=H(t.target,".e-datavisualization-chart")?H(t.target,".e-datavisualization-chart"):i);var n=this.parent.getActiveSheet(),s={prevTop:n.frozenRows||n.frozenColumns?this.prevY:this.originalReorderTop,prevLeft:n.frozenRows||n.frozenColumns?this.prevX:this.originalReorderLeft,currentTop:this.resizedReorderTop>=0?parseInt(this.resizedReorderTop.toString(),10):this.originalReorderTop,currentLeft:this.resizedReorderLeft>=0?parseInt(this.resizedReorderLeft.toString(),10):this.originalReorderLeft,id:i.id,currentHeight:this.currenHeight,currentWidth:this.currentWidth,requestType:"imageRefresh",prevHeight:this.originalHeight,prevWidth:this.originalWidth};if(this.isOverlayClicked||e){var a=void 0,l=void 0,h={clientY:s.prevTop,isImage:!0},c={clientX:s.prevLeft,isImage:!0},u=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0],d=!!(n.frozenRows||n.frozenColumns);if(d){if(!u)return;h.isImage=!1,c.isImage=!1,h.target=u,c.target=u,s.prevTop<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(h.target=this.parent.getColumnHeaderContent(),h.isOverlay=!0),s.prevLeft<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(c.target=this.parent.getRowHeaderTable());var p=u.getBoundingClientRect();a={clientY:p.top},l={clientX:p.left},p.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(a.target=this.parent.getColumnHeaderContent(),a.isOverlay=!0),p.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else a={clientY:s.currentTop,isImage:!0},l={clientX:s.currentLeft,isImage:!0};if(this.parent.notify(Is,h),this.parent.notify(Is,a),this.parent.notify(Ms,c),this.parent.notify(Ms,l),a.size&&(s.currentTop=a.size),l.size&&(s.currentLeft=l.size),d){var f=u.id.split("_overlay")[0],v=this.parent.chartColl.find(function(D){return D.id===f});v&&v.address?(s.prevRowIdx=v.address[0],s.prevColIdx=v.address[1],s.prevTop=v.top,s.prevLeft=v.left):(s.prevRowIdx=h.clientY,s.prevColIdx=c.clientX)}else s.prevRowIdx=h.clientY,s.prevColIdx=c.clientX;if(s.currentRowIdx=a.clientY,s.currentColIdx=l.clientX,(n.frozenColumns||n.frozenRows)&&!H(u,".e-sheet-content")){var m=this.parent.frozenColCount(n),y=this.parent.frozenRowCount(n);if(s.currentRowIdx>=y&&s.currentColIdx>=m){var b=parseFloat(u.style.top),S=parseFloat(u.style.left),C=this.parent.sheetModule.contentPanel;b+=C.scrollTop,b-=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var x=this.parent.getScrollElement();if(S+=x.scrollLeft,S-=this.parent.sheetModule.getRowHeaderWidth(n),u.style.top=b+"px",u.style.left=S+"px",this.parent.getMainContent().appendChild(u),u.classList.contains("e-datavisualization-chart")){var I=u.querySelector(".e-chart");I&&Re(I)}}}r&&r[0]&&r[0].querySelector(".e-control")&&(s.id=r[0].id),this.originalReorderTop!==this.resizedReorderTop||this.originalReorderLeft!==this.resizedReorderLeft?(s.id=u.id,r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(Uc,s)):this.parent.notify(Jd,s),this.resizedReorderTop=this.originalReorderTop,this.resizedReorderLeft=this.originalReorderLeft):(this.currenHeight!==this.originalHeight||this.originalWidth!==this.currentWidth)&&(s.id=i.id.indexOf("overlay")>0?i.id:i.parentElement&&i.parentElement.classList.contains("e-ss-overlay")?i.parentElement.id:u.id,r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(Uc,s)):this.parent.notify(Jd,s),this.originalHeight=this.currenHeight,this.originalWidth=this.currentWidth)}this.isOverlayClicked=!1}},o.prototype.isOverlaySelected=function(t){t.isOverlayClicked=this.isOverlayClicked},o.prototype.refreshOverlayElem=function(t){if(t){var e=".e-ss-overlay-active"+(t&&t.selector||""),i=this.parent.element.querySelector(e);i&&(Z([i],"e-ss-overlay-active"),this.parent.notify(Go,{}))}else for(var e="e-ss-overlay-active",r=Array.from(this.parent.element.getElementsByClassName(e)),n=0;n<r.length;n++){var s=r[n];s&&(Z([s],"e-ss-overlay-active"),this.parent.notify(Go,{}))}this.parent.notify(N0,null)},o.prototype.overlayClickHandler=function(t){if(!(this.parent.getActiveSheet().isProtected||!this.parent.allowEditing)){this.isOverlayClicked=!0;var e=t.target,i=t.target;e.classList.contains("e-ss-overlay")||(i=e.parentElement,H(t.target,".e-datavisualization-chart")&&(i=H(t.target,".e-datavisualization-chart")));var r=this.parent.getActiveSheet();if((r.frozenColumns||r.frozenRows)&&H(i,".e-sheet-content")){var n=parseInt(i.style.top,10),s=parseInt(i.style.left,10),a=this.parent.sheetModule.contentPanel;n-=a.scrollTop,n+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var l=this.parent.getScrollElement();s-=l.scrollLeft,s+=this.parent.sheetModule.getRowHeaderWidth(r),i.style.top=n+"px",i.style.left=s+"px",this.parent.element.querySelector("#"+this.parent.element.id+"_sheet").appendChild(i)}this.originalWidth=this.currentWidth=parseFloat(i.style.width),this.originalHeight=this.currenHeight=parseFloat(i.style.height),this.originalReorderLeft=parseFloat(i.style.left),this.originalReorderTop=parseFloat(i.style.top),this.resizedReorderLeft=parseFloat(i.style.left),this.resizedReorderTop=parseFloat(i.style.top),this.originalResizeTop=this.originalReorderTop,this.originalResizeLeft=this.originalReorderLeft,this.originalMouseX=Uo(t),this.originalMouseY=Wo(t),this.diffX=this.originalMouseX-this.originalReorderLeft,this.diffY=this.originalMouseY-this.originalReorderTop;var h=document.getElementsByClassName("e-ss-overlay-active")[0];h&&Z([h],"e-ss-overlay-active"),this.parent.element.querySelector("#"+i.id).classList.add("e-ss-overlay-active"),e.classList.contains("e-ss-resizer")&&(this.resizer=e.classList[0],this.isResizerClicked=!0),i.classList.contains("e-datavisualization-chart")&&(this.parent.notify(Xb,{id:i.id}),h?h.id!==i.id&&this.parent.notify(ep,{refreshChartTheme:!0}):this.parent.notify(ep,{id:i.id}));var c=i.getBoundingClientRect();this.prevX=c.left,this.prevY=c.top}},o.prototype.renderResizeHandler=function(t){for(var e=["e-ss-overlay-t","e-ss-overlay-r","e-ss-overlay-b","e-ss-overlay-l"],i=0,r;i<e.length;)r=this.parent.createElement("div",{className:e[i]+" e-ss-resizer"+(j.isDevice?" e-ss-resizer-touch":""),styles:"width: 8px; height: 8px; border-radius: 4px;"}),t.appendChild(r),i++},o.prototype.removeEventListener=function(){var t=this.parent.element.querySelectorAll(".e-ss-overlay");if(t.length)for(var e=0;e<t.length;e++)T.remove(t[e],tp(),this.overlayClickHandler),T.remove(t[e],Fh(),this.overlayMouseMoveHandler);var i=this.parent.element.querySelector("#"+this.parent.element.id+"_sheet");i&&T.remove(i,Fh(),this.overlayMouseMoveHandler),document&&this.mouseUpHandler&&(T.remove(document,Md(),this.mouseUpHandler),this.mouseUpHandler=null),this.parent.isDestroyed||(this.parent.off(RD,this.setOriginalSize),this.parent.off(Bg,this.isOverlaySelected),this.parent.off(Nd,this.refreshOverlayElem),this.parent.off(Xn,this.destroy))},o.prototype.destroy=function(){this.removeEventListener(),this.currentWidth&&(this.currentWidth=null),this.currenHeight&&(this.currenHeight=null),this.minHeight&&(this.minHeight=null),this.minWidth&&(this.minWidth=null),this.isOverlayClicked&&(this.isOverlayClicked=null),this.isResizerClicked&&(this.isResizerClicked=null),this.parent=null},o})(),lE=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),XD=function(){return XD=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},XD.apply(this,arguments)},Wr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},tG=(function(o){lE(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Wr([w("")],t.prototype,"text",void 0),Wr([w("")],t.prototype,"iconCss",void 0),Wr([w("left")],t.prototype,"iconPosition",void 0),t})(Oe),Cz=(function(o){lE(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Wr([Ce({},tG)],t.prototype,"header",void 0),Wr([Gt([],Sy)],t.prototype,"content",void 0),Wr([w("")],t.prototype,"cssClass",void 0),Wr([w(!1)],t.prototype,"disabled",void 0),t})(Oe),iG=(function(o){lE(t,o);function t(e,i){return o.call(this,e)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.element.id||(this.element.id=Lt("ribbon")),this.renderRibbon()},t.prototype.destroy=function(){var e=this.element.querySelector(".e-drop-icon");if(e&&e.removeEventListener("click",this.ribbonExpandCollapse.bind(this)),this.menuItems.length){var i=document.getElementById(this.element.id+"_menu");if(i){var r=ot(i,"menu");r.setProperties({animationSettings:{effect:"None"}},!0),r.destroy()}}this.toolbarObj&&this.toolbarObj.destroy(),this.tabObj&&this.tabObj.destroy(),this.element.innerHTML="",this.toolbarObj=null,this.tabObj=null,o.prototype.destroy.call(this)},t.prototype.getTabItems=function(){var e=this,i=[];return this.menuItems.length&&i.push({header:{text:this.initMenu(this.menuItems)},content:this.toolbarObj.element,cssClass:"e-menu-tab"}),this.items.forEach(function(r){i.push({header:r.header,content:e.toolbarObj.element})}),i},t.prototype.initMenu=function(e){var i=this,r=this.createElement("ul",{id:this.element.id+"_menu"});this.element.appendChild(r);var n=new bc({cssClass:"e-file-menu",items:e,showItemOnClick:!0,enableRtl:this.enableRtl,beforeOpen:function(s){s.parentItem.text===e[0].text&&(n.showItemOnClick=!1),i.trigger("beforeOpen",s)},select:function(s){i.trigger("fileMenuItemSelect",s)},beforeClose:function(s){if(s.event&&s.event.type==="mouseover"&&!H(s.event.target,".e-menu-popup")){s.cancel=!0;return}i.trigger("beforeClose",s),(!s.parentItem||s.parentItem.text===e[0].text)&&n.setProperties({showItemOnClick:!0},!0)},beforeItemRender:function(s){i.trigger("beforeFileMenuItemRender",s)},created:function(){n.element.removeAttribute("tabindex");var s=n.element.querySelector(".e-menu-item");s&&s.removeAttribute("tabindex")}});return n.createElement=this.createElement,n.appendTo(r),r.parentElement},t.prototype.renderRibbon=function(){var e=this,i=this.createElement("div"),r=this.createElement("div"),n;this.toolbarObj=new yc({items:this.items[this.selectedTab].content,enableRtl:this.enableRtl,clicked:function(a){return e.trigger("clicked",a)}}),this.toolbarObj.createElement=this.createElement,this.toolbarObj.appendTo(r),this.tabObj=new wy({selectedItem:this.getIndex(this.selectedTab),animation:{next:{duration:0},previous:{duration:0}},items:this.getTabItems(),enableRtl:this.enableRtl,selecting:function(a){if(a.isSwiped){a.cancel=!0;return}if(n=a.event&&a.event.isShortcut,e.menuItems.length&&a.selectingIndex===0){if(a.cancel=!0,(!a.event||n||a.event.type==="keydown")&&a.selectingItem){var l=a.selectingItem.querySelector(".e-file-menu .e-menu-item");l&&l.click()}}else{if(a.selectingIndex===e.getIndex(e.selectedTab))return;e.updateToolbar(e.getIndex(a.selectingIndex,!0)),e.toolbarObj.dataBind(),e.refreshTemplateItems(e.toolbarObj),e.element.classList.contains("e-collapsed")&&T.remove(a.selectedItem,"click",e.ribbonExpandCollapse);var h=void 0;e.menuItems.length?(h=XD({},a),h.selectingIndex-=1,h.selectedIndex-=1):h=a,e.trigger("selecting",h)}},selected:function(a){!a.isInteracted&&!n&&(a.preventFocus=!0),a.selectedIndex!==e.getIndex(e.selectedTab)&&(e.setProperties({selectedTab:e.getIndex(a.selectedIndex,!0)},!0),e.element.classList.contains("e-collapsed")&&(e.element.classList.remove("e-collapsed"),e.trigger("expandCollapse",{element:e.toolbarObj.element,expanded:!0})))},created:function(){e.toolbarObj.refreshOverflow()}}),this.element.appendChild(i),this.tabObj.createElement=this.createElement,this.tabObj.appendTo(i);var s=this.createElement("span",{className:"e-drop-icon e-icons"});s.addEventListener("click",this.ribbonExpandCollapse.bind(this)),this.element.appendChild(s)},t.prototype.ribbonExpandCollapse=function(e){var i={element:this.toolbarObj.element,expanded:!0},r;this.element.classList.contains("e-collapsed")?(r=this.tabObj.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[this.tabObj.selectedItem],this.element.classList.remove("e-collapsed"),r.classList.add("e-active"),T.remove(r,"click",this.ribbonExpandCollapse),this.trigger("expandCollapse",i)):(r=this.tabObj.element.querySelector(".e-tab-header .e-toolbar-item.e-active"),this.element.classList.add("e-collapsed"),i.expanded=!1,r.classList.remove("e-active"),T.add(r,"click",this.ribbonExpandCollapse,this),this.trigger("expandCollapse",i))},t.prototype.getIndex=function(e,i){return this.menuItems.length?i?e-1:e+1:e},t.prototype.updateToolbar=function(e){this.toolbarObj.items=this.items[e].content,this.toolbarObj.dataBind()},t.prototype.refreshTemplateItems=function(e){this.spreadInstance&&this.spreadInstance.isReact&&this.spreadInstance.portals&&e&&e.portals&&(this.spreadInstance.portals=this.spreadInstance.portals.concat(e.portals),this.spreadInstance.renderReactTemplates())},t.prototype.enableMenuItems=function(e,i,r){i===void 0&&(i=!0),this.menuItems.length&&ot(document.getElementById(this.element.id+"_menu"),"menu").enableItems(e,i,r)},t.prototype.hideMenuItems=function(e,i,r){if(i===void 0&&(i=!0),!!this.menuItems.length){var n=ot(document.getElementById(this.element.id+"_menu"),"menu");i?n.hideItems(e,r):n.showItems(e,r)}},t.prototype.addMenuItems=function(e,i,r,n){if(r===void 0&&(r=!0),!!this.menuItems.length){var s=ot(document.getElementById(this.element.id+"_menu"),"menu");r?s.insertAfter(e.reverse(),i,n):s.insertBefore(e,i,n)}},t.prototype.hideTabs=function(e,i){var r=this;i===void 0&&(i=!0);var n,s,a,l;if(i||(l=this.isAllHidden()),e.forEach(function(c){n=r.getTabIndex(c,-1),n>-1&&(i?r.items[n].cssClass.includes(" e-hide")||(r.items[n].cssClass=r.items[n].cssClass+" e-hide",r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),a=!0):r.items[n].cssClass.includes(" e-hide")&&(r.items[n].cssClass=r.items[n].cssClass.replace(" e-hide",""),r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),a=!0))}),this.setProperties({items:this.items},!0),this.tabObj.items=this.tabObj.items,this.tabObj.dataBind(),i&&(l=this.isAllHidden(),l&&(s=!1)),!i&&l&&(s=!s),a&&l&&(this.element.classList.contains("e-collapsed")?(this.element.classList.remove("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.remove("e-hide")):(this.element.classList.add("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.add("e-hide"))),s){for(var h=0;h<this.items.length;h++)if(!this.items[h].cssClass.includes(" e-hide")){this.tabObj.selectedItem=this.getIndex(h),this.tabObj.dataBind();break}}},t.prototype.isAllHidden=function(){for(var e=!0,i=0;i<this.items.length;i++)if(!this.items[i].cssClass.includes(" e-hide")){e=!1;break}return e},t.prototype.enableTabs=function(e,i){var r=this;i===void 0&&(i=!0),e.forEach(function(n){var s=r.getTabIndex(n,-1);s>-1&&(r.items[s].disabled=!i,s=r.getIndex(s),r.tabObj.enableTab(s,i))}),this.setProperties({items:this.items},!0)},t.prototype.addTabs=function(e,i){var r=this,n=this.getTabIndex(i),s;e.forEach(function(a){a=new Cz(r.items[0],"items",a,!0),r.items.splice(n,0,a),s={header:a.header,content:r.toolbarObj.element},a.cssClass&&(s.cssClass=a.cssClass),a.disabled&&(s.disabled=a.disabled),r.tabObj.addTab([s],r.getIndex(n)),n++}),this.setProperties({items:this.items},!0),this.setProperties({selectedTab:this.getIndex(this.tabObj.selectedItem,!0)},!0)},t.prototype.getTabIndex=function(e,i){if(i===void 0&&(i=this.items.length),e){for(var r=0;r<this.items.length;r++)if(this.items[r].header.text===e){i=r;break}}return i},t.prototype.addToolbarItems=function(e,i,r){var n=this,s=this.getTabIndex(e);g(r)&&(r=this.items[s].content.length),i.forEach(function(a){a=new Sy(n.items[s].content[0],"content",a,!0),n.items[s].content.splice(r,0,a),r++}),this.setProperties({items:this.items},!0),s===this.selectedTab&&i.length&&this.updateToolbar(s)},t.prototype.enableItems=function(e,i,r,n){if(r===void 0&&(r=!0),i){var s=this.getTabIndex(e,-1);if(s<0)return;for(var a=void 0,l=0;l<i.length;l++){if(typeof i[l]=="string"){for(var h=0;h<this.items[s].content.length;h++)if(this.items[s].content[h].id===i[l]){i[l]=h;break}}if(typeof i[l]=="string"){if(i.length-1>l)continue;return}var c=this.items[s].content[i[l]];a=r,n?c.isManuallyEnabled=r:r&&c.isManuallyEnabled!==void 0&&(a=c.isManuallyEnabled),c.disabled=!a,this.setProperties({items:this.items},!0),s===this.selectedTab&&this.toolbarObj.enableItems(i[l],a)}}else this.toolbarObj.disable(!r)},t.prototype.hideToolbarItems=function(e,i,r){var n=this;r===void 0&&(r=!0);for(var s,a,l=0;l<this.items.length;l++)if(this.items[l].header.text===e){s=l,i.forEach(function(h){a=n.items[s].content[h],a&&(r?a.cssClass.includes(" e-hide")||(a.cssClass=a.cssClass+" e-hide"):a.cssClass.includes(" e-hide")&&(a.cssClass=a.cssClass.replace(" e-hide","")))});break}this.setProperties({items:this.items},!0),s!==void 0&&s===this.selectedTab&&this.updateToolbar(s)},t.prototype.getModuleName=function(){return"ribbon"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"selectedTab":this.tabObj.selectedItem=this.getIndex(e.selectedTab),this.tabObj.dataBind();break}}},Wr([w("")],t.prototype,"cssClass",void 0),Wr([w(!0)],t.prototype,"menuType",void 0),Wr([Gt([],td)],t.prototype,"menuItems",void 0),Wr([w(0)],t.prototype,"selectedTab",void 0),Wr([Gt([],Cz)],t.prototype,"items",void 0),Wr([w(null)],t.prototype,"spreadInstance",void 0),Wr([G()],t.prototype,"selecting",void 0),Wr([G()],t.prototype,"fileMenuItemSelect",void 0),Wr([G()],t.prototype,"beforeFileMenuItemRender",void 0),Wr([G()],t.prototype,"beforeOpen",void 0),Wr([G()],t.prototype,"beforeClose",void 0),Wr([G()],t.prototype,"selectFormat",void 0),Wr([G()],t.prototype,"clicked",void 0),Wr([G()],t.prototype,"created",void 0),Wr([G()],t.prototype,"expandCollapse",void 0),t=Wr([It],t),t})(ti),rG=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.render=function(){var t=this,e=this.parent.element.id,i=this.parent.createElement("input",{attrs:{type:"color"}}),r=function(n){n.element.tabIndex=-1};this.fontColorPicker=new Wm({value:"#000000ff",mode:"Palette",showButtons:!1,presetColors:d9,enableOpacity:!1,enableRtl:this.parent.enableRtl,cssClass:"e-spreadsheet-color-popup",beforeTileRender:r,beforeClose:function(){return t.beforeCloseHandler(t.fontColorPicker)},open:this.openHandler.bind(this),beforeModeSwitch:function(n){return t.beforeModeSwitch(t.fontColorPicker,n)},change:function(n){var s=t.fontColorPicker.getValue(n.currentValue.rgba),a={style:{color:s},onActionUpdate:!0};t.parent.notify(ur,a),a.cancel?t.fontColorPicker.setProperties({value:t.fontColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):t.updateSelectedColor(a.style.color,t.fontColorPicker.element,"TextColor")},created:function(){return t.updateSelectedColor("#000000",t.fontColorPicker.element,"TextColor",!0)}}),this.fontColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.fontColorPicker.appendTo(i),i.parentElement.id=e+"_font_color_picker",X([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-font-color"]),i=this.parent.createElement("input",{attrs:{type:"color"}}),this.filColorPicker=new Wm({value:"#ffff00ff",mode:"Palette",presetColors:p9,showButtons:!1,enableOpacity:!1,enableRtl:this.parent.enableRtl,cssClass:"e-spreadsheet-color-popup",open:this.openHandler.bind(this),beforeTileRender:r,beforeClose:function(){return t.beforeCloseHandler(t.filColorPicker)},beforeModeSwitch:function(n){return t.beforeModeSwitch(t.filColorPicker,n)},change:function(n){var s=t.filColorPicker.getValue(n.currentValue.rgba),a={style:{backgroundColor:s},onActionUpdate:!0};t.parent.notify(ur,a),a.cancel?t.filColorPicker.setProperties({value:t.filColorPicker.getValue(n.previousValue.rgba,"HEXA")},!0):t.updateSelectedColor(a.style.backgroundColor,t.filColorPicker.element,"FillColor")},created:function(){return t.updateSelectedColor("#ffff00",t.filColorPicker.element,"FillColor",!0)}}),this.filColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.filColorPicker.appendTo(i),i.parentElement.id=e+"_fill_color_picker",X([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-fill-color"])},o.prototype.updateSelectedColor=function(t,e,i,r){var n=this.parent.serviceLocator.getService(ve).getConstant(i);r&&e.parentElement.querySelector(".e-dropdown-btn").setAttribute("aria-label",n);var s=e.parentElement.querySelector(".e-split-colorpicker");s.setAttribute("aria-label",n+" "+t),s.firstElementChild.style.borderBottomColor=t},o.prototype.openHandler=function(t){t.element.querySelector(".e-mode-switch-btn").title=this.parent.serviceLocator.getService(ve).getConstant("MoreColors")},o.prototype.beforeCloseHandler=function(t){t.modeSwitcher||t.setProperties({modeSwitcher:!0},!0),t.showButtons&&t.setProperties({showButtons:!1},!0),Re(t.element.parentElement.querySelector(".e-split-colorpicker"))},o.prototype.beforeModeSwitch=function(t,e){var i=this.parent.serviceLocator.getService(ve);e.mode==="Picker"?(t.showButtons=!0,t.dataBind(),e.element.querySelector(".e-apply").title=i.getConstant("Apply"),e.element.querySelector(".e-cancel").title=i.getConstant("Cancel"),e.element.querySelector(".e-mode-switch-btn").title=i.getConstant("StandardColors")):(t.showButtons=!1,t.dataBind(),e.element.querySelector(".e-mode-switch-btn").title=i.getConstant("MoreColors"))},o.prototype.destroy=function(){this.parent&&(this.removeEventListener(),this.fontColorPicker&&this.fontColorPicker.destroy(),this.fontColorPicker=null,this.filColorPicker&&this.filColorPicker.destroy(),this.filColorPicker=null,this.parent=null)},o.prototype.addEventListener=function(){this.parent.on(oD,this.render,this),this.parent.on("destroyRibbonComponents",this.destroy,this),this.parent.on(Xn,this.destroy,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(oD,this.render),this.parent.off("destroyRibbonComponents",this.destroy),this.parent.off(Xn,this.destroy))},o})(),hE=(function(){function o(t){this.border="1px solid #000000",this.fontNameIndex=5,this.numPopupWidth=0,this.preTabIdx=1,this.spanElements=[],this.iconSetGroupElement=[],this.iconSetElements=[],this.iconWrapElements=[],this.parent=t,this.addEventListener(),new rG(t)}return o.prototype.getModuleName=function(){return"ribbon"},o.prototype.ribbonOperation=function(t){t&&t.onPropertyChange?this.onPropertyChanged(t.prop):this.initialize()},o.prototype.initialize=function(t){if(this.parent.notify(oD,{}),this.parent.isMobileView())this.createMobileView();else{var e=t&&(this.parent.element.querySelector(".e-formula-bar-panel")||document.getElementById(this.parent.element.id+"_sheet_panel"));this.createRibbon(e)}},o.prototype.getRibbonMenuItems=function(){var t=this.parent.serviceLocator.getService(ve),e=this.parent.element.id,i=[{text:this.parent.isMobileView()?"":t.getConstant("File"),iconCss:this.parent.isMobileView()?"e-icons e-file-menu-icon":null,id:e+"_File",items:[{text:t.getConstant("New"),id:e+"_New",iconCss:"e-new e-icons"},{text:t.getConstant("Open"),id:e+"_Open",iconCss:"e-open e-icons"},{text:t.getConstant("SaveAs"),iconCss:"e-save e-icons",id:e+"_Save_As",items:[{text:t.getConstant("ExcelXlsx"),id:e+"_Xlsx",iconCss:"e-xlsx e-icons"},{text:t.getConstant("ExcelXls"),id:e+"_Xls",iconCss:"e-xls e-icons"},{text:t.getConstant("CSV"),id:e+"_Csv",iconCss:"e-csv e-icons"},{text:t.getConstant("PDF"),id:e+"_Pdf",iconCss:"e-pdf e-icons"}]},{text:t.getConstant("Print"),id:e+"_Print",iconCss:"e-print e-icons"}]}];return i},o.prototype.getRibbonItems=function(){var t=this,e=this.parent.element.id,i=this.parent.serviceLocator.getService(ve),r=[{header:{text:i.getConstant("Home")},content:[{prefixIcon:"e-undo-icon",tooltipText:i.getConstant("Undo")+" (Ctrl+Z)",htmlAttributes:{"aria-label":i.getConstant("Undo")},id:e+"_undo",disabled:!0},{prefixIcon:"e-redo-icon",tooltipText:i.getConstant("Redo")+" (Ctrl+Y)",htmlAttributes:{"aria-label":i.getConstant("Redo")},id:e+"_redo",disabled:!0},{type:"Separator",id:e+"_separator_1"},{prefixIcon:"e-cut-icon",tooltipText:i.getConstant("Cut")+" (Ctrl+X)",htmlAttributes:{"aria-label":i.getConstant("Cut")},id:e+"_cut"},{prefixIcon:"e-copy-icon",tooltipText:i.getConstant("Copy")+" (Ctrl+C)",htmlAttributes:{"aria-label":i.getConstant("Copy")},id:e+"_copy"},{tooltipText:i.getConstant("Paste")+" (Ctrl+V)",template:this.getPasteBtn(e,i),id:e+"_paste",disabled:!0},{type:"Separator",id:e+"_separator_2"},{template:this.getNumFormatDDB(e,i),tooltipText:i.getConstant("NumberFormat"),id:e+"_number_format"},{type:"Separator",id:e+"_separator_3"},{template:this.getFontNameDDB(e),tooltipText:i.getConstant("Font"),id:e+"_font_name"},{type:"Separator",id:e+"_separator_4"},{template:this.getFontSizeDDB(e),tooltipText:i.getConstant("FontSize"),id:e+"_font_size"},{type:"Separator",id:e+"_separator_5"},{template:this.getBtn(e,"bold",i.getConstant("Bold")),tooltipText:i.getConstant("Bold")+" (Ctrl+B)",id:e+"_bold"},{template:this.getBtn(e,"italic",i.getConstant("Italic")),tooltipText:i.getConstant("Italic")+" (Ctrl+I)",id:e+"_italic"},{template:this.getBtn(e,"line-through",i.getConstant("Strikethrough")),tooltipText:i.getConstant("Strikethrough")+" (Ctrl+5)",id:e+"_line-through"},{template:this.getBtn(e,"underline",i.getConstant("Underline")),tooltipText:i.getConstant("Underline")+" (Ctrl+U)",id:e+"_underline"},{template:document.getElementById(e+"_font_color_picker"),tooltipText:i.getConstant("TextColor"),id:e+"_font_color_picker"},{type:"Separator",id:e+"_separator_6"},{template:document.getElementById(e+"_fill_color_picker"),tooltipText:i.getConstant("FillColor"),id:e+"_fill_color_picker"},{template:this.getBordersDBB(e),tooltipText:i.getConstant("Borders"),id:e+"_borders"},{template:this.getMergeSplitBtn(e),tooltipText:i.getConstant("MergeCells"),id:e+"_merge_cells",disabled:!0},{type:"Separator",id:e+"_separator_7"},{template:this.getTextAlignDDB(e),tooltipText:i.getConstant("HorizontalAlignment"),id:e+"_text_align"},{template:this.getVerticalAlignDDB(e),tooltipText:i.getConstant("VerticalAlignment"),id:e+"_vertical_align"},{template:this.getBtn(e,"wrap",i.getConstant("WrapText"),!1),tooltipText:""+i.getConstant("WrapText"),id:e+"_wrap"}]},{header:{text:i.getConstant("Insert")},content:[{prefixIcon:"e-hyperlink-icon",text:i.getConstant("Link"),id:e+"_hyperlink",tooltipText:i.getConstant("Link"),click:function(){t.getHyperlinkDlg()}},{prefixIcon:"e-image-icon",text:i.getConstant("Image"),id:e+"_image",tooltipText:i.getConstant("Image"),click:function(){J("#"+e+"_imageUpload",t.parent.element).click()}}]},{header:{text:i.getConstant("Formulas")},content:[{prefixIcon:"e-insert-function",tooltipText:i.getConstant("InsertFunction"),text:i.getConstant("InsertFunction"),id:e+"_insert_function"},{type:"Separator",id:e+"_separator_14"},{template:this.createCalcOptions(e,i),tooltipText:i.getConstant("CalcOptionsTip"),id:e+"_calc_types"},{type:"Separator",id:e+"_separator_15"},{prefixIcon:"e-calculate-sheet",tooltipText:i.getConstant("CalcSheetTip"),text:i.getConstant("CalcActiveSheet"),id:e+"_calc_current_sheet",click:function(){t.parent.notify(At,{action:"ClearDependentCellCollection"}),t.parent.calculateNow("Sheet")},disabled:this.parent.calculationMode==="Automatic"},{prefixIcon:"e-calculation",tooltipText:i.getConstant("CalcWorkbookTip"),text:i.getConstant("CalcWorkbook"),id:e+"_calc_entire_sheets",click:function(){t.parent.notify(At,{action:"ClearDependentCellCollection"}),t.parent.calculateNow("Workbook")},disabled:this.parent.calculationMode==="Automatic"}]},{header:{text:i.getConstant("Data")},content:[{prefixIcon:"e-protect-icon",text:i.getConstant("ProtectSheet"),id:e+"_protect",tooltipText:i.getConstant("ProtectSheet")},{prefixIcon:"e-password-protect-icon",text:i.getConstant("ProtectWorkbook"),id:e+"_protectworkbook",tooltipText:i.getConstant("ProtectWorkbook")},{type:"Separator",id:e+"_separator_8"},{template:this.datavalidationDDB(e),tooltipText:i.getConstant("DataValidation"),id:e+"_datavalidation"}]},{header:{text:i.getConstant("View")},content:[{prefixIcon:"e-hide-headers",text:this.getLocaleText("Headers"),id:e+"_headers",tooltipText:this.getLocaleText("Headers")},{type:"Separator",id:e+"_separator_9"},{prefixIcon:"e-hide-gridlines",text:this.getLocaleText("GridLines"),id:e+"_gridlines",tooltipText:this.getLocaleText("GridLines")},{type:"Separator",id:e+"_separator_13"},{prefixIcon:"e-freeze-pane",text:i.getConstant("FreezePanes"),id:e+"_freezepanes",tooltipText:i.getConstant("FreezePanes"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-row",text:i.getConstant("FreezeRows"),id:e+"_freezerows",tooltipText:i.getConstant("FreezeRows"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-column",text:i.getConstant("FreezeColumns"),id:e+"_freezecolumns",tooltipText:i.getConstant("FreezeColumns"),disabled:!this.parent.allowFreezePane}]}];return this.parent.allowConditionalFormat&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:e+"_separator_10"},{template:this.getCFDBB(e),tooltipText:i.getConstant("ConditionalFormatting"),id:e+"_conditionalformatting"}),this.parent.allowChart&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Insert")}).content.push({type:"Separator",id:e+"_separator_11"},{template:this.getChartDDB(e,!0),text:i.getConstant("Chart"),tooltipText:i.getConstant("Chart"),id:e+"_chart"}),this.parent.allowCellFormatting&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:e+"_separator_12"},{template:this.getClearDDB(e),tooltipText:i.getConstant("Clear"),id:e+"_clear"}),(this.parent.allowSorting||this.parent.allowFiltering)&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getSortFilterDDB(e),tooltipText:i.getConstant("SortAndFilter"),id:e+"_sorting"}),this.parent.allowFindAndReplace&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getFindBtn(e),prefixIcon:"e-tbar-search-icon tb-icons",tooltipText:i.getConstant("FindReplaceTooltip"),id:e+"_find"}),r},o.prototype.createCalcOptions=function(t,e){var i=et("button",{id:t+"_calc_types",attrs:{type:"button"},className:"e-calc-types"}),r=et("span",{className:"e-calc-types-text"});return r.innerText=e.getConstant("CalcOptions"),i.appendChild(r),this.calcTypeOptions=new Hr({items:[{id:t+"_Automatic",text:e.getConstant("Automatic"),iconCss:this.parent.calculationMode==="Automatic"?"e-icons e-selected-icon":""},{id:t+"_Manual",text:e.getConstant("Manual"),iconCss:this.parent.calculationMode==="Manual"?"e-icons e-selected-icon":""}],createPopupOnClick:!0,enableRtl:this.parent.enableRtl,iconCss:"e-calculation e-icons",cssClass:"e-flat e-calc-types"}),this.calcTypeOptions.select=this.selectCalcOptions.bind(this),this.calcTypeOptions.appendTo(i),i},o.prototype.selectCalcOptions=function(t){t.item.id===this.parent.element.id+"_Automatic"?(this.calcTypeOptions.items[0].iconCss="e-icons e-selected-icon",this.calcTypeOptions.items[1].iconCss="",this.parent.calculationMode==="Manual"&&this.parent.notify(At,{action:"ClearDependentCellCollection"}),this.parent.setProperties({calculationMode:"Automatic"},!0),this.updateFormulaButtons(),this.parent.calculateNow("Workbook")):(this.calcTypeOptions.items[0].iconCss="",this.calcTypeOptions.items[1].iconCss="e-icons e-selected-icon",this.parent.setProperties({calculationMode:"Manual"},!0),this.updateFormulaButtons())},o.prototype.updateFormulaButtons=function(){var t=this.parent.serviceLocator.getService(ve);this.parent.notify(Ea,[{tab:t.getConstant("Formulas"),items:[this.parent.element.id+"_calc_current_sheet"],enable:this.parent.calculationMode==="Manual"}]),this.parent.notify(Ea,[{tab:t.getConstant("Formulas"),items:[this.parent.element.id+"_calc_entire_sheets"],enable:this.parent.calculationMode==="Manual"}])},o.prototype.getPasteBtn=function(t,e){var i=this,r=this.parent.element.appendChild(this.parent.createElement("button",{id:t+"_paste",attrs:{type:"button"}}));return this.pasteSplitBtn=new uf({iconCss:"e-icons e-paste-icon",items:[{text:e.getConstant("All"),id:"All"},{text:e.getConstant("Values"),id:"Values"},{text:e.getConstant("Formats"),id:"Formats"}],createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(n){i.pasteSplitBtn.element.setAttribute("aria-label",e.getConstant("Paste")+" "+n.item.text),i.parent.notify(fo,{type:n.item.id,isAction:!0,isInternal:!0})},click:function(){r.setAttribute("aria-label",e.getConstant("Paste")),i.parent.notify(fo,{isAction:!0,isInternal:!0})},beforeOpen:function(n){n.element.setAttribute("aria-label",e.getConstant("Paste"))}}),this.pasteSplitBtn.createElement=this.parent.createElement,this.pasteSplitBtn.appendTo(r),r.parentElement},o.prototype.getHyperlinkDlg=function(){var t=this.parent.getActiveSheet(),e=ie(t.activeCell),i=Q(e[0],e[1],t);i&&i.hyperlink?this.parent.notify(Ng,null):this.parent.notify(Lg,null)},o.prototype.passwordProtectDlg=function(){this.parent.password.length>0?this.parent.notify(F0,null):document.getElementById(this.parent.element.id+"_protectworkbook").classList.contains("e-active")?(document.getElementById(this.parent.element.id+"_protectworkbook").classList.remove("e-active"),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled")):this.parent.notify(k0,null)},o.prototype.getLocaleText=function(t){var e,i=this.parent.serviceLocator.getService(ve),r=this.parent.getActiveSheet();return r["show"+t]?e=i.getConstant("Hide"+t):e=i.getConstant("Show"+t),e},o.prototype.getLocaleProtectText=function(t,e){var i,r=this.parent.serviceLocator.getService(ve),n=this.parent.getActiveSheet();return n.isProtected?(e&&this.parent.getMainContent().classList.remove("e-hide-"+t.toLowerCase()),i=r.getConstant("Unprotect"+t)):(e&&this.parent.getMainContent().classList.add("e-hide-"+t.toLowerCase()),i=r.getConstant("Protect"+t)),i},o.prototype.getLocaleProtectWorkbook=function(t,e){var i,r=this.parent.serviceLocator.getService(ve);return this.parent.isProtected?(e&&this.parent.getMainContent().classList.remove("e-hide-"+t.toLowerCase()),i=r.getConstant(t)):(e&&this.parent.getMainContent().classList.add("e-hide-"+t.toLowerCase()),i=r.getConstant(t)),i},o.prototype.insertDesignChart=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.ribbon.items.length-1,n=i.getConstant("ChartDesign");if(this.parent.allowChart&&this.ribbon.items[r]&&this.ribbon.items[r].header.text!==n){this.preTabIdx=this.ribbon.selectedTab;var s=this.parent.element.id,a=[{header:{text:n},content:[{template:this.getAddChartEleDBB(s),tooltipText:i.getConstant("AddChartElement"),id:s+"add_chart_ element_chart"},{type:"Separator"},{prefixIcon:"e-switch-row-column-icon",text:i.getConstant("SwitchRowColumn"),tooltipText:i.getConstant("SwitchRowColumn"),id:s+"switch_row_column_chart",click:function(){e.parent.notify(Wc,{switchRowColumn:!0,triggerEvent:!0})}},{type:"Separator"},{template:this.getChartThemeDDB(s),tooltipText:i.getConstant("ChartTheme"),id:s+"_chart_theme"},{type:"Separator"},{template:this.getChartDDB(s,!1),tooltipText:i.getConstant("ChartType"),id:s+"_chart_type"}]}];this.addRibbonTabs({items:a}),this.ribbon.tabObj.select(this.ribbon.items.length)}else if(t.refreshChartTheme){var l=void 0,h=this.parent.element.querySelector(".e-ss-overlay-active");if(h){var c=h.querySelector(".e-chart");c?l=ot(c,"chart").theme:(c=h.querySelector(".e-accumulationchart"),c&&(l=ot(c,"accumulationchart").theme))}var u=document.getElementById(this.parent.element.id+"_chart_theme");if(l&&u){var d=ot(u,Hr);if(d){l=i.getConstant(l);for(var p=0;p<d.items.length;p++)d.items[p].iconCss!==""&&(d.items[p].iconCss=""),d.items[p].text===l&&(d.items[p].iconCss="e-icons e-selected-icon");d.element.firstChild.textContent=l,d.setProperties({items:d.items},!0),d.element.setAttribute("aria-label",l)}}}},o.prototype.removeDesignChart=function(){var t=this.parent.serviceLocator.getService(ve),e=this.ribbon.items.length-1;this.ribbon.items[e]&&this.ribbon.items[e].header.text===t.getConstant("ChartDesign")&&(this.ribbon.tabObj.select(this.preTabIdx+1),this.parent.hideRibbonTabs([t.getConstant("ChartDesign")],!0),document.getElementsByClassName("e-addchart-ddb").length>0&&document.getElementsByClassName("e-addchart-ddb")[0].remove(),document.getElementsByClassName("e-chart-type-ddb").length>0&&document.getElementsByClassName("e-chart-type-ddb")[0].remove(),document.getElementsByClassName("e-charttheme-ddb").length>0&&document.getElementsByClassName("e-charttheme-ddb")[0].remove(),delete this.ribbon.items[e].content[0],this.ribbon.items.length=this.ribbon.items.length-1)},o.prototype.createRibbon=function(t){var e=this.parent.createElement("div",{id:this.parent.element.id+"_ribbon",className:this.parent.enableRtl?"e-rtl":""});this.ribbon=new iG({selectedTab:0,enableRtl:this.parent.enableRtl,menuItems:this.getRibbonMenuItems(),items:this.getRibbonItems(),fileMenuItemSelect:this.fileMenuItemSelect.bind(this),beforeOpen:this.fileMenuBeforeOpen.bind(this),beforeClose:this.fileMenuBeforeClose.bind(this),clicked:this.toolbarClicked.bind(this),created:this.ribbonCreated.bind(this),selecting:this.tabSelecting.bind(this),expandCollapse:this.expandCollapseHandler.bind(this),beforeFileMenuItemRender:this.beforeRenderHandler.bind(this),spreadInstance:this.parent&&this.parent.isReact?this.parent:null}),this.ribbon.createElement=this.parent.createElement,t?this.parent.element.insertBefore(e,t):this.parent.element.appendChild(e),this.ribbon.appendTo(e)},o.prototype.tabSelecting=function(t){if(t.selectingIndex!==this.ribbon.selectedTab){var e=this.parent.serviceLocator.getService(ve);if(this.ribbon.items[t.selectingIndex]&&this.ribbon.items[t.selectingIndex].header.text===e.getConstant("Insert")){for(var i=this.ribbon.items[t.selectingIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&!n.classList.contains("e-dropdown-btn")&&this.createChartDdb(document.getElementById(this.parent.element.id+"_chart-btn"),!0);break}}if(this.ribbon.items[t.selectedIndex]&&this.ribbon.items[t.selectedIndex].header.text===e.getConstant("Insert")){for(var i=this.ribbon.items[t.selectedIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&n.classList.contains("e-dropdown-btn")&&this.destroyComponent(n,"dropdown-btn");break}}this.refreshRibbonContent(t.selectingIndex),this.parent.notify(QM,{activeTab:t.selectingIndex})}},o.prototype.beforeRenderHandler=function(t){var e=this.parent.serviceLocator.getService(ve);t.item.text===e.getConstant("Open")&&(!this.parent.openUrl||!this.parent.allowOpen)&&t.element.classList.add("e-disabled"),t.item.text===e.getConstant("SaveAs")&&(!this.parent.saveUrl||!this.parent.allowSave)&&t.element.classList.add("e-disabled"),t.item.text===e.getConstant("Print")&&!this.parent.allowPrint&&t.element.classList.add("e-disabled")},o.prototype.getChartThemeDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.createElement("button",{id:t+"_chart_theme",attrs:{type:"button"},className:"e-ss-ddb"});r.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"}));var n="Material",s=this.parent.element.querySelector(".e-ss-overlay-active");if(s){var a=s.querySelector(".e-chart");a?n=ot(a,"chart").theme:(a=s.querySelector(".e-accumulationchart"),a&&(n=ot(a,"accumulationchart").theme))}var l=new Hr({items:this.getChartThemeDdbItems(n),content:i.getConstant(n),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(h){e.parent.notify(Ta,{type:"mousedown"}),(!h.element||!h.element.querySelector(".e-selected-icon"))&&(l.content=h.item.text,l.refresh(),e.parent.notify(Wc,{chartTheme:h.item.id,triggerEvent:!0}),l.setProperties({items:e.getChartThemeDdbItems(h.item.id)},!0))},cssClass:"e-flat e-charttheme-ddb",beforeOpen:function(h){e.tBarDdbBeforeOpen(h.element,h.items,e.parent.serviceLocator.getService(ve).getConstant("Chart"))}});return l.createElement=this.parent.createElement,l.appendTo(r),r},o.prototype.getNumFormatDDB=function(t,e){var i=this,r=this.parent.createElement("button",{id:t+"_number_format",attrs:{type:"button"},className:"e-ss-ddb"}),n=this.parent.createElement("span",{className:"e-tbar-btn-text"});n.innerText=e.getConstant("General"),r.appendChild(n);var s={action:"getLocalizedFormats"};this.parent.notify(qd,s);var a=s.defaultFormats,l=s.localizedFormats;return this.numFormatDDB=new Hr({items:this.getNumFormatDdbItems(t),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(h){var c=i.parent.serviceLocator.getService(ve);if(h.item.text===c.getConstant("Custom"))i.renderCustomFormatDialog(a,l);else{var u=h.item.id.split(i.parent.element.id+"_")[1],d=cr(u);i.applyNumFormat(d);var p=i.parent.getActiveSheet();i.refreshNumFormatSelection(en(d,!0),p,c,d);var f=xe(p.activeCell);i.refreshTextAlign(p,Q(f[0],f[1],p,!1,!0),u,f),i.numFormatDDB.element.setAttribute("aria-label",u),i.parent.showAggregate&&i.parent.notify(jl,{})}},open:function(h){return i.numDDBOpen(h)},beforeItemRender:function(h){return i.previewNumFormat(h)},cssClass:"e-flat e-numformat-ddb",beforeOpen:function(h){i.tBarDdbBeforeOpen(h.element,h.items,i.parent.serviceLocator.getService(ve).getConstant("NumberFormat"))}}),this.numFormatDDB.createElement=this.parent.createElement,this.numFormatDDB.appendTo(r),r},o.prototype.getFontSizeDDB=function(t){var e=this;return this.fontSizeDdb=new Hr({cssClass:"e-font-size-ddb",content:"11",createPopupOnClick:!0,enableRtl:this.parent.enableRtl,items:[{text:"8"},{text:"9"},{text:"10"},{text:"11"},{text:"12"},{text:"14"},{text:"16"},{text:"18"},{text:"20"},{text:"22"},{text:"24"},{text:"26"},{text:"28"},{text:"36"},{text:"48"},{text:"72"}],beforeOpen:function(i){e.tBarDdbBeforeOpen(i.element,i.items,e.parent.serviceLocator.getService(ve).getConstant("FontSize")),e.refreshSelected(e.fontSizeDdb,i.element,"content","text")},select:function(i){var r={style:{fontSize:i.item.text+"pt"},onActionUpdate:!0};e.parent.notify(ur,r),r.cancel||(e.fontSizeDdb.content=r.style.fontSize.split("pt")[0],e.fontSizeDdb.dataBind()),e.fontSizeDdb.element.setAttribute("aria-label",i.item.text)}}),this.fontSizeDdb.createElement=this.parent.createElement,this.fontSizeDdb.appendTo(this.parent.createElement("button",{id:t+"_font_size",attrs:{type:"button"},className:"e-ss-ddb"})),this.fontSizeDdb.element},o.prototype.getChartDDB=function(t,e){var i=this.parent.serviceLocator.getService(ve),r;if(e){r=this.parent.createElement("button",{id:t+"_chart-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:t+"_chart"});n.innerText=i.getConstant("Chart"),r.appendChild(n)}else{r=this.parent.createElement("button",{id:t+"_chart-type-btn",attrs:{type:"button"}});var n=this.parent.createElement("span",{id:t+"_chart_type"});n.innerText=i.getConstant("ChartType"),r.appendChild(n),this.createChartDdb(r,!1)}return r},o.prototype.closeDropdownPopup=function(t){if(t.altKey&&t.keyCode===38||t.keyCode===27){var e=this[1];e&&(e.toggle(),Re(e.element))}},o.prototype.createChartDdb=function(t,e){var i=this,r=this.parent.serviceLocator.getService(ve),n=e?"e-chart-menu":"e-chart-type-menu",s=this.parent.createElement("ul",{id:""+this.parent.element.id+(e?"_chart_menu":"_chart_type_menu")}),a,l=new Hr({iconCss:"e-icons "+(e?"e-chart-icon":"e-chart-type-icon"),cssClass:e?"e-chart-ddb":"e-chart-type-ddb",target:s,createPopupOnClick:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(h){a=i.createChartMenu(s,n,r,l),i.tBarDdbBeforeOpen(h.element,a.items,i.parent.serviceLocator.getService(ve).getConstant("Chart")),T.add(s,"keydown",i.closeDropdownPopup,[i,l])},open:function(h){i.openHandler(h.element,s)},beforeClose:function(h){h.event&&H(h.event.target,"."+n)?h.cancel=!0:(T.remove(s,"keydown",i.closeDropdownPopup),a.destroy())}});l.createElement=this.parent.createElement,l.appendTo(t)},o.prototype.createChartMenu=function(t,e,i,r){var n=this,s=new bc({cssClass:e,enableRtl:this.parent.enableRtl,items:[{iconCss:"e-icons e-column",text:i.getConstant("Column"),items:[{id:"column_chart"}]},{iconCss:"e-icons e-bar",text:i.getConstant("Bar"),items:[{id:"bar_chart"}]},{iconCss:"e-icons e-area",text:i.getConstant("Area"),items:[{id:"area_chart"}]},{iconCss:"e-icons e-pie-doughnut",text:i.getConstant("PieAndDoughnut"),items:[{id:"pie_doughnut_chart"}]},{iconCss:"e-icons e-line",text:i.getConstant("Line"),items:[{id:"line_chart"}]},{iconCss:"e-icons e-scatter",text:i.getConstant("Scatter"),items:[{id:"scatter_chart"}]}],orientation:"Vertical",beforeOpen:function(vt){var bi;vt.parentItem.text===i.getConstant("Column")?(vt.element.firstChild.appendChild(a),bi="e-column-chart"):vt.parentItem.text===i.getConstant("Bar")?(vt.element.firstChild.appendChild(b),bi="e-bar-chart"):vt.parentItem.text===i.getConstant("Area")?(vt.element.firstChild.appendChild(N),bi="e-area-chart"):vt.parentItem.text===i.getConstant("Line")?(vt.element.firstChild.appendChild(O),bi="e-line-chart"):vt.parentItem.text===i.getConstant("PieAndDoughnut")?(vt.element.firstChild.appendChild(ne),bi="e-pie-doughnut-chart"):vt.parentItem.text===i.getConstant("Radar")?(vt.element.firstChild.appendChild(qe),bi="e-radar-chart"):vt.parentItem.text===i.getConstant("Scatter")&&(vt.element.firstChild.appendChild(dt),bi="e-scatter-chart"),bi&&(vt.element.parentElement.classList.add(bi),T.add(vt.element,"keydown",n.menuIconKeyDown.bind(n,bi+" .e-menu-icon",0)))},select:function(vt){return n.chartSelected(vt,r)},beforeItemRender:function(vt){vt.item.text||vt.element.removeAttribute("tabindex")},beforeClose:function(vt){vt.event&&vt.event.keyCode===37?vt.cancel=!0:T.remove(vt.element,"keydown",n.menuIconKeyDown)}}),a=this.parent.createElement("div",{id:"column_main",className:"e-column-main"}),l=this.parent.createElement("div",{id:"column1_text",className:"e-column1-text"});l.innerText=i.getConstant("Column");var h=this.parent.createElement("div",{id:"column1_cont",className:"e-column1-cont"}),c=this.parent.createElement("div",{id:"column2_cont",className:"e-column2-cont"});a.appendChild(l),a.appendChild(h);var u=i.getConstant("ClusteredColumn"),d=this.parent.createElement("span",{id:"clusteredColumn",className:"e-clusteredcolumn e-column-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedColumn");var p=this.parent.createElement("span",{id:"stackedColumn",className:"e-stackedcolumn e-column-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedColumn100");var f=this.parent.createElement("span",{id:"stackedColumn100",className:"e-stackedcolumn100 e-column-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}}),v=this.parent.createElement("span",{id:"clusteredColumn3D",className:"e-clusteredColumn3D e-column-icon"}),m=this.parent.createElement("span",{id:"stackedColumn3D",className:"e-stackedColumn3D e-column-icon"}),y=this.parent.createElement("span",{id:"stackedColumn1003D",className:"e-stackedColumn1003D e-column-icon"});h.appendChild(d),h.appendChild(p),h.appendChild(f),c.appendChild(v),c.appendChild(m),c.appendChild(y);var b=this.parent.createElement("div",{id:"bar_main",className:"e-bar-main"}),S=this.parent.createElement("div",{id:"bar1_text",className:"e-bar1-text"});S.innerText=i.getConstant("Bar");var C=this.parent.createElement("div",{id:"bar1_cont",className:"e-bar1-cont"}),x=this.parent.createElement("div",{id:"bar2_cont",className:"e-bar2-cont"});b.appendChild(S),b.appendChild(C),u=i.getConstant("ClusteredBar");var I=this.parent.createElement("span",{id:"clusteredBar",className:"e-clusteredbar e-bar-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedBar");var D=this.parent.createElement("span",{id:"stackedBar",className:"e-stackedbar e-bar-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedBar100");var M=this.parent.createElement("span",{id:"stackedBar100",className:"e-stackedbar100 e-bar-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}}),E=this.parent.createElement("span",{id:"clusteredBar3D",className:"e-clusteredBar3D e-bar-icon"}),A=this.parent.createElement("span",{id:"stackedBar3D",className:"e-stackedBar3D e-bar-icon"}),L=this.parent.createElement("span",{id:"stackedBar1003D",className:"e-stackedBar1003D e-bar-icon"});C.appendChild(I),C.appendChild(D),C.appendChild(M),x.appendChild(E),x.appendChild(A),x.appendChild(L);var N=this.parent.createElement("div",{id:"area_main",className:"e-area-main"}),R=this.parent.createElement("div",{id:"area_text",className:"e-area-text"});R.innerText=i.getConstant("Area");var P=this.parent.createElement("div",{id:"area_cont",className:"e-area-cont"});N.appendChild(R),N.appendChild(P),u=i.getConstant("Area");var k=this.parent.createElement("span",{id:"area",className:"e-area e-area-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedArea");var B=this.parent.createElement("span",{id:"stackedArea",className:"e-stackedarea e-area-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedArea100");var F=this.parent.createElement("span",{id:"stackedArea100",className:"e-stackedarea100 e-area-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});P.appendChild(k),P.appendChild(B),P.appendChild(F);var O=this.parent.createElement("div",{id:"line_main",className:"e-line-main"}),z=this.parent.createElement("div",{id:"line_text",className:"e-line-text"});z.innerText=i.getConstant("Line");var Y=this.parent.createElement("div",{id:"line_cont",className:"e-line-cont"}),K=this.parent.createElement("div",{id:"line_cont_marker",className:"e-line-cont"});O.appendChild(z),O.appendChild(Y),O.appendChild(K),u=i.getConstant("Line");var U=this.parent.createElement("span",{id:"line",className:"e-line e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedLine");var q=this.parent.createElement("span",{id:"stackedLine",className:"e-stackedline e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedLine100");var ae=this.parent.createElement("span",{id:"stackedLine100",className:"e-stackedline100 e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("LineMarker");var te=this.parent.createElement("span",{id:"lineMarker",className:"e-line-marker e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedLineMarker");var he=this.parent.createElement("span",{id:"stackedLineMarker",className:"e-stackedline-marker e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("StackedLine100Marker");var ue=this.parent.createElement("span",{id:"stackedLine100Marker",className:"e-stackedline100-marker e-line-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});Y.appendChild(U),Y.appendChild(q),Y.appendChild(ae),K.appendChild(te),K.appendChild(he),K.appendChild(ue);var ne=this.parent.createElement("div",{id:"pie_main",className:"e-pie-main"}),le=this.parent.createElement("div",{id:"pie_text",className:"e-pie-text"});le.innerText=i.getConstant("Pie");var $=this.parent.createElement("div",{id:"pie_cont",className:"e-pie-cont"});ne.appendChild(le),ne.appendChild($),u=i.getConstant("Pie");var ee=this.parent.createElement("span",{id:"pie",className:"e-pie e-pie-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});u=i.getConstant("Doughnut");var He=this.parent.createElement("span",{id:"doughnut",className:"e-doughnut e-pie-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});$.appendChild(ee),$.appendChild(He);var qe=this.parent.createElement("div",{id:"radar_main",className:"e-radar-main"}),we=this.parent.createElement("div",{id:"radar_text",className:"e-radar-text"});we.innerText=i.getConstant("Radar");var je=this.parent.createElement("div",{id:"radar_cont",className:"e-radar-cont"});qe.appendChild(we),qe.appendChild(je);var Ne=this.parent.createElement("span",{id:"radar",className:"e-radar e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}}),Ye=this.parent.createElement("span",{id:"radar_markers",className:"e-radar-markers e-radar-icon e-menu-icon e-icons",attrs:{tabindex:"-1"}});Ne.title=i.getConstant("BlueDataBar"),Ye.title=i.getConstant("GreenDataBar"),je.appendChild(Ne),je.appendChild(Ye);var dt=this.parent.createElement("div",{id:"scatter_main",className:"e-scatter-main"}),Ke=this.parent.createElement("div",{id:"scatter_text",className:"e-scatter-text"});u=i.getConstant("Scatter"),Ke.innerText=u;var ci=this.parent.createElement("div",{id:"scatter_cont",className:"e-scatter-cont"});dt.appendChild(Ke),dt.appendChild(ci);var Jt=this.parent.createElement("span",{id:"scatter",className:"e-scatter e-scatter-icon e-menu-icon e-icons",attrs:{title:u,"aria-label":u,tabindex:"-1"}});return ci.appendChild(Jt),s.createElement=this.parent.createElement,s.appendTo(t),t.classList.add("e-ul"),s},o.prototype.getAddChartEleDBB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.createElement("ul",{id:t+"_add_chart_menu"}),n;this.addChartDdb=new Hr({iconCss:"e-icons e-addchart-icon",cssClass:"e-addchart-ddb",target:r,createPopupOnClick:!0,enableRtl:this.parent.enableRtl,close:function(){return Re(e.parent.element)},beforeOpen:function(l){n=e.createAddChartMenu(r,i),e.tBarDdbBeforeOpen(l.element,n.items),T.add(r,"keydown",e.closeDropdownPopup,[e,e.addChartDdb])},open:function(l){e.openHandler(l.element,r)},beforeClose:function(l){l.event&&H(l.event.target,".e-addchart-menu")?l.cancel=!0:(T.remove(r,"keydown",e.closeDropdownPopup),n.destroy())}}),this.addChartDdb.createElement=this.parent.createElement;var s=this.parent.createElement("button",{id:t+"_addchart",attrs:{type:"button"}}),a=this.parent.createElement("span",{id:t+"_chart"});return a.innerText=i.getConstant("AddChartElement"),s.appendChild(a),this.addChartDdb.appendTo(s),this.addChartDdb.element},o.prototype.createAddChartMenu=function(t,e){var i=this,r=[],n=this.parent.element.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(n){var s=n.querySelector(".e-chart");s?r=[{iconCss:"e-icons e-axes",text:e.getConstant("Axes"),items:[{iconCss:"e-icons e-ph-axes",id:"PHAxes",text:e.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axes",id:"PVAxes",text:e.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-axis-title",text:e.getConstant("AxisTitle"),items:[{iconCss:"e-icons e-ph-axistitle",id:"PHAxisTitle",text:e.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axistitle",id:"PVAxisTitle",text:e.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-chart-title",text:e.getConstant("ChartTitle"),items:[{iconCss:"e-icons e-ct-none",id:"ChartTitleNone",text:e.getConstant("None")},{iconCss:"e-icons e-ct-abovechart",id:"ChartTitleAbove",text:e.getConstant("AboveChart")}]},{iconCss:"e-icons e-data-labels",id:this.parent.element.id+"data-labels",text:e.getConstant("DataLabels"),items:[{iconCss:"e-icons e-dl-none",id:"DLNone",text:e.getConstant("None")},{iconCss:"e-icons e-dl-center",id:"DLCenter",text:e.getConstant("Center")},{iconCss:"e-icons e-dl-insideend",id:"DLInsideend",text:e.getConstant("InsideEnd")},{iconCss:"e-icons e-dl-insidebase",id:"DLInsidebase",text:e.getConstant("InsideBase")},{iconCss:"e-icons e-dl-outsideend",id:"DLOutsideend",text:e.getConstant("OutsideEnd")}]},{iconCss:"e-icons e-gridlines",text:e.getConstant("Gridlines"),items:[{iconCss:"e-icons e-gl-major-horizontal",id:"GLMajorHorizontal",text:e.getConstant("PrimaryMajorHorizontal")},{iconCss:"e-icons e-gl-major-vertical",id:"GLMajorVertical",text:e.getConstant("PrimaryMajorVertical")},{iconCss:"e-icons e-gl-minor-horizontal",id:"GLMinorHorizontal",text:e.getConstant("PrimaryMinorHorizontal")},{iconCss:"e-icons e-gl-minor-vertical",id:"GLMinorVertical",text:e.getConstant("PrimaryMinorVertical")}]},{iconCss:"e-icons e-legends",text:e.getConstant("Legends"),items:[{iconCss:"e-icons e-legends-none",id:"LegendNone",text:e.getConstant("None")},{iconCss:"e-icons e-legends-right",id:"LegendsRight",text:e.getConstant("Right")},{iconCss:"e-icons e-legends-left",id:"LegendsLeft",text:e.getConstant("Left")},{iconCss:"e-icons e-legends-bottom",id:"LegendsBottom",text:e.getConstant("Bottom")},{iconCss:"e-icons e-legends-top",id:"LegendsTop",text:e.getConstant("Top")}]}]:r=[{iconCss:"e-icons e-chart-title",text:e.getConstant("ChartTitle"),items:[{iconCss:"e-icons e-ct-none",id:"ChartTitleNone",text:e.getConstant("None")},{iconCss:"e-icons e-ct-abovechart",id:"ChartTitleAbove",text:e.getConstant("AboveChart")}]},{iconCss:"e-icons e-data-labels",id:this.parent.element.id+"data-labels",text:e.getConstant("DataLabels"),items:[{iconCss:"e-icons e-dl-none",id:"DLNone",text:e.getConstant("None")},{iconCss:"e-icons e-dl-center",id:"DLCenter",text:e.getConstant("Center")},{iconCss:"e-icons e-dl-insideend",id:"DLInsideend",text:e.getConstant("InsideEnd")},{iconCss:"e-icons e-dl-insidebase",id:"DLInsidebase",text:e.getConstant("InsideBase")},{iconCss:"e-icons e-dl-outsideend",id:"DLOutsideend",text:e.getConstant("OutsideEnd")}]},{iconCss:"e-icons e-legends",text:e.getConstant("Legends"),items:[{iconCss:"e-icons e-legends-none",id:"LegendNone",text:e.getConstant("None")},{iconCss:"e-icons e-legends-right",id:"LegendsRight",text:e.getConstant("Right")},{iconCss:"e-icons e-legends-left",id:"LegendsLeft",text:e.getConstant("Left")},{iconCss:"e-icons e-legends-bottom",id:"LegendsBottom",text:e.getConstant("Bottom")},{iconCss:"e-icons e-legends-top",id:"LegendsTop",text:e.getConstant("Top")}]}]}var a=new bc({cssClass:"e-addchart-menu",title:e.getConstant("AddChartElement"),orientation:"Vertical",enableRtl:this.parent.enableRtl,select:this.addChartEleSelected.bind(this),items:r,beforeOpen:function(l){if(l.parentItem.id===i.parent.element.id+"data-labels"){var h=i.parent.element.querySelector(".e-ss-overlay-active");if(h){var c=h.querySelector(".e-chart");if(c){var u=ot(c,"chart");if(u.series[0]&&u.series[0].type.includes("Line")){var d=function(f,v){if(f){var m=f.parentElement;m.innerHTML="",m.appendChild(f),m.appendChild(document.createTextNode(e.getConstant(v)))}};d(l.element.querySelector(".e-dl-insideend"),"Above"),d(l.element.querySelector(".e-dl-insidebase"),"Below");var p=l.element.querySelector(".e-dl-outsideend");p&&(p.parentElement.style.display="none")}}}}}});return a.createElement=this.parent.createElement,a.appendTo(t),t.classList.add("e-ul"),a},o.prototype.getCFDBB=function(t){var e=this,i=this.parent.createElement("ul",{id:t+"_cf_menu"}),r;return this.cfDdb=new Hr({iconCss:"e-icons e-conditionalformatting-icon",cssClass:"e-cf-ddb",target:i,createPopupOnClick:!0,enableRtl:this.parent.enableRtl,close:function(){return Re(e.parent.element)},beforeOpen:function(n){r=e.createCFMenu(i),e.tBarDdbBeforeOpen(n.element,r.items,e.parent.serviceLocator.getService(ve).getConstant("ConditionalFormatting")),T.add(i,"keydown",e.closeDropdownPopup,[e,e.cfDdb])},open:function(n){e.openHandler(n.element,i)},beforeClose:function(n){n.event&&H(n.event.target,".e-cf-menu")?n.cancel=!0:(T.remove(i,"keydown",e.closeDropdownPopup),r&&r.element&&(ws(e.spanElements),e.spanElements=[],ws(e.iconWrapElements),e.iconWrapElements=[],ws(e.iconSetElements),e.iconSetElements=[],ws(e.iconSetGroupElement),e.iconSetGroupElement=[],r.destroy(),r.element.remove()))}}),this.cfDdb.createElement=this.parent.createElement,this.cfDdb.appendTo(this.parent.createElement("button",{id:t+"_conditionalformatting",attrs:{type:"button"}})),this.cfDdb.element},o.prototype.createCFMenu=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.enableRtl,n=function(a,l,h){var c;a.forEach(function(u){c=i.getConstant(u+l);var d=e.parent.createElement("span",{id:u+l,className:"e-"+u.toLowerCase()+" e-cf-icon",attrs:{title:c,"aria-label":c,tabindex:"-1"}});e.spanElements.push(d),h.appendChild(d)})},s=new bc({cssClass:"e-cf-menu",enableRtl:r,items:[{iconCss:"e-icons e-hlcellrules",text:i.getConstant("HighlightCellsRules"),items:[{iconCss:"e-icons e-greaterthan",id:"cf_greaterthan_dlg",text:i.getConstant("GreaterThan")+"..."},{iconCss:"e-icons e-lessthan",id:"cf_lessthan_dlg",text:i.getConstant("LessThan")+"..."},{iconCss:"e-icons e-between",id:"cf_between_dlg",text:i.getConstant("Between")+"..."},{iconCss:"e-icons e-equalto",id:"cf_eqaulto_dlg",text:i.getConstant("CFEqualTo")+"..."},{iconCss:"e-icons e-textcontains",id:"cf_textcontains_dlg",text:i.getConstant("TextThatContains")+"..."},{iconCss:"e-icons e-adateoccuring",id:"cf_adateoccuring_dlg",text:i.getConstant("ADateOccuring")+"..."},{iconCss:"e-icons e-duplicate",id:"cf_duplicatevalues_dlg",text:i.getConstant("DuplicateValues")+"..."}]},{iconCss:"e-icons e-topbottomrules",text:i.getConstant("TopBottomRules"),items:[{iconCss:"e-icons e-top10items",id:"cf_top10items_dlg",text:i.getConstant("Top10Items")+"..."},{iconCss:"e-icons e-top10",id:"cf_top10_dlg",text:i.getConstant("Top10")+" %..."},{iconCss:"e-icons e-bottom10items",id:"cf_bottom10items_dlg",text:i.getConstant("Bottom10Items")+"..."},{iconCss:"e-icons e-bottom10",id:"cf_bottom10_dlg",text:i.getConstant("Bottom10")+" %..."},{iconCss:"e-icons e-aboveaverage",id:"cf_aboveaverage_dlg",text:i.getConstant("AboveAverage")+"..."},{iconCss:"e-icons e-belowaverage",id:"cf_belowaverage_dlg",text:i.getConstant("BelowAverage")+"..."}]},{iconCss:"e-icons e-databars",text:i.getConstant("DataBars"),items:[{id:"db_icons1"},{id:"db_icons2"}]},{iconCss:"e-icons e-colorscales",text:i.getConstant("ColorScales"),items:[{id:"cs_icons1"},{id:"cs_icons2"},{id:"cs_icons3"}]},{iconCss:"e-icons e-iconsets",text:i.getConstant("IconSets"),items:[{id:"is_icons"}]},{iconCss:"e-icons e-clearrules",text:i.getConstant("ClearRules"),items:[{id:"cf_cr_cells",text:i.getConstant("SelectedCells")},{id:"cf_cr_sheet",text:i.getConstant("EntireSheet")}]}],orientation:"Vertical",beforeOpen:function(a){if(a.parentItem.iconCss==="e-icons e-databars")a.element.parentElement.classList.add("e-databars"),n(["Blue","Green","Red"],"DataBar",a.element.firstChild),n(["Orange","LightBlue","Purple"],"DataBar",a.element.lastChild),T.add(a.element,"keydown",e.menuIconKeyDown.bind(e,"e-cf-icon",3));else if(a.parentItem.iconCss==="e-icons e-colorscales")a.element.parentElement.classList.add("e-colorscales"),n(["GYR","RYG","GWR","RWG"],"ColorScale",a.element.firstChild),n(["BWR","RWB","WR","RW"],"ColorScale",a.element.querySelector("#cs_icons2")),n(["GW","WG","GY","YG"],"ColorScale",a.element.lastChild),T.add(a.element,"keydown",e.menuIconKeyDown.bind(e,"e-cf-icon",4));else if(a.parentItem.iconCss==="e-icons e-iconsets"){a.element.parentElement.classList.add("e-iconsets");var l=e.parent.createElement("div",{id:"is",className:"e-is"});e.iconSetGroupElement.push(l);var h=[{hdr:"Directional"},{cont:[{cls:"3arrows",key:"ThreeArrowsColor",id:"ThreeArrows",count:3},{cls:"3arrowsgray",key:"ThreeArrowsGray",count:3},{cls:"3triangles",key:"ThreeTriangles",count:3},{cls:"4arrowsgray",key:"FourArrowsGray",count:4},{cls:"4arrows",key:"FourArrowsColor",id:"FourArrows",count:4},{cls:"5arrowsgray",key:"FiveArrowsGray",count:5},{cls:"5arrows",key:"FiveArrowsColor",id:"FiveArrows",count:5}]},{hdr:"Shapes"},{cont:[{cls:"3trafficlights",key:"ThreeTrafficLights1",count:3},{cls:"3rafficlights2",key:"ThreeTrafficLights2",count:3},{cls:"3signs",key:"ThreeSigns",count:3},{cls:"4trafficlights",key:"FourTrafficLights",count:4},{cls:"4redtoblack",key:"RedToBlack",id:"FourRedToBlack",count:4}]},{hdr:"Indicators"},{cont:[{cls:"3symbols",key:"ThreeSymbols1",id:"ThreeSymbols",count:3},{cls:"3symbols2",key:"ThreeSymbols2",count:3},{cls:"3flags",key:"ThreeFlags",count:3}]},{hdr:"Ratings"},{cont:[{cls:"3stars",key:"ThreeStars",count:3},{cls:"4rating",key:"FourRatings",id:"FourRating",count:4},{cls:"5quarters",key:"FiveQuarters",count:5},{cls:"5rating",key:"FiveRatings",id:"FiveRating",count:5},{cls:"5boxes",key:"FiveBoxes",count:5}]}],c,u,d,p;h.forEach(function(f,v){c=e.parent.createElement("div",{id:"is"+(v+1),className:"e-is"+(v+1)}),e.iconSetElements.push(c),f.hdr?c.innerText=i.getConstant(f.hdr):f.cont.forEach(function(m){for(d=i.getConstant(m.key),u=e.parent.createElement("div",{id:m.id||m.key,className:"e-"+m.cls+" e-is-wrapper",attrs:{title:d,"aria-label":d,tabindex:"-1"}}),e.iconWrapElements.push(u),p=0;p<m.count;p++){var y=e.createElement("span","e-"+m.cls+"-"+(p+1)+" e-iconsetspan");e.spanElements.push(y),u.appendChild(y)}c.appendChild(u)}),l.appendChild(c)}),a.element.firstChild.appendChild(l),T.add(a.element,"keydown",e.menuIconKeyDown.bind(e,"e-is-wrapper",0))}},select:this.cfSelected.bind(this),beforeItemRender:function(a){(a.item.id.includes("db_icons")||a.item.id.includes("cs_icons")||a.item.id==="is_icons")&&a.element.removeAttribute("tabindex")},beforeClose:function(a){var l=["e-icons e-databars","e-icons e-colorscales","e-icons e-iconsets"].indexOf(a.parentItem.iconCss)>-1;a.cancel=a.event&&a.event.keyCode===37&&l,l&&!a.cancel&&T.remove(a.element,"keydown",e.menuIconKeyDown)}});return s.createElement=this.parent.createElement,s.appendTo(t),t.classList.add("e-ul"),s},o.prototype.menuIconKeyDown=function(t,e,i){var r,n=[];if(!i)r=0,n=[].slice.call(document.querySelectorAll("."+t));else if(i.keyCode===40||i.keyCode===39||i.keyCode===38||i.keyCode===37){if(i.preventDefault(),n=[].slice.call(document.querySelectorAll("."+t)),r=n.indexOf(i.target),r===-1)r=0;else if(i.keyCode===39)r++,r===n.length&&(r=0);else if(i.keyCode===37)r--,r===-1&&(r=n.length-1);else if(!t.includes("e-menu-icon")){var s=n.length,a=void 0,l=void 0;e||(e=2,i.keyCode===40?(a=[6,11,14,19],l=[5,10,13]):(a=[7,12,15],l=[8,13,16]),s--),i.keyCode===40?r===s-1?r=0:(r+=a&&a.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:e,a&&s++,r>=s&&(r=r-s+1)):r===0?r=s-1:(r-=a&&a.indexOf(r)>-1?1:l&&l.indexOf(r)>-1?3:e,r<0&&(r=a?s:s+r-1))}}n[r]&&Re(n[r])},o.prototype.createElement=function(t,e){return this.parent.createElement(t,{className:e})},o.prototype.getBordersDBB=function(t){var e=this,i=this.parent.createElement("ul",{id:t+"_borders_menu"});this.cPickerEle=this.parent.createElement("input",{id:t+"_cell_border_color",attrs:{type:"color"}}),this.parent.element.appendChild(this.cPickerEle),this.colorPicker=new Wm({cssClass:"e-border-colorpicker",mode:"Palette",inline:!0,enableRtl:this.parent.enableRtl,beforeTileRender:function(n){n.element.tabIndex=-1},change:function(n){var s=e.border.split(" ");s[2]=n.currentValue.hex,e.border=s.join(" ")}}),this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(this.cPickerEle);var r;return this.bordersDdb=new Hr({iconCss:"e-icons e-bottom-borders",cssClass:"e-borders-ddb",target:i,createPopupOnClick:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(n){r=e.createBorderMenu(i),e.tBarDdbBeforeOpen(n.element,r.items,e.parent.serviceLocator.getService(ve).getConstant("Borders"),1),T.add(i,"keydown",e.closeDropdownPopup,[e,e.bordersDdb])},open:function(){return Re(i)},beforeClose:function(n){n.event&&H(n.event.target,".e-borders-menu")?n.cancel=!0:(T.remove(i,"keydown",e.closeDropdownPopup),r.destroy())},close:function(){return Re(e.bordersDdb.element)}}),this.bordersDdb.createElement=this.parent.createElement,this.bordersDdb.appendTo(this.parent.createElement("button",{id:t+"_borders",attrs:{type:"button"}})),this.bordersDdb.element},o.prototype.createBorderMenu=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.element.id,n=function(a){var l=a.target;if(a.keyCode===27||a.keyCode===13&&(l.classList.contains("e-apply")||l.classList.contains("e-cancel"))){var h=document.getElementById(r+"_border_bordercolor");if(h&&(h.classList.remove("e-selected"),a.keyCode===27)){var c=document.querySelector(".e-border-color.e-popup-open .e-cancel");c&&c.click()}}},s=new bc({cssClass:"e-borders-menu",enableRtl:this.parent.enableRtl,items:[{iconCss:"e-icons e-top-borders",text:i.getConstant("TopBorders"),id:r+"_border_topborders"},{iconCss:"e-icons e-left-borders",text:i.getConstant("LeftBorders"),id:r+"_border_leftborders"},{iconCss:"e-icons e-right-borders",text:i.getConstant("RightBorders"),id:r+"_border_rightborders"},{iconCss:"e-icons e-bottom-borders",text:i.getConstant("BottomBorders"),id:r+"_border_bottomborders"},{iconCss:"e-icons e-all-borders",text:i.getConstant("AllBorders"),id:r+"_border_allborders"},{iconCss:"e-icons e-horizontal-borders",text:i.getConstant("HorizontalBorders"),id:r+"_border_horizontalborders"},{iconCss:"e-icons e-vertical-borders",text:i.getConstant("VerticalBorders"),id:r+"_border_verticalborders"},{iconCss:"e-icons e-outside-borders",text:i.getConstant("OutsideBorders"),id:r+"_border_outsideborders"},{iconCss:"e-icons e-inside-borders",text:i.getConstant("InsideBorders"),id:r+"_border_insideborders"},{iconCss:"e-icons e-no-borders",text:i.getConstant("NoBorders"),id:r+"_border_noborders"},{separator:!0},{text:i.getConstant("BorderColor"),items:[{id:r+"_border_colors"}],id:r+"_border_bordercolor"},{text:i.getConstant("BorderStyle"),items:[{iconCss:"e-icons e-selected-icon",id:r+"_1px"},{id:r+"_2px"},{id:r+"_3px"},{id:r+"_dashed"},{id:r+"_dotted"},{id:r+"_double"}]}],orientation:"Vertical",beforeOpen:function(a){if(a.parentItem.id===r+"_border_bordercolor"){e.colorPicker.refresh();var l=e.colorPicker.element.parentElement;a.element.firstElementChild.appendChild(l),l.style.display="inline-block",a.element.parentElement.classList.add("e-border-color"),a.element.firstElementChild.removeAttribute("tabindex"),T.add(l,"keydown",n,e)}else a.element.classList.add("e-border-style")},beforeClose:function(a){if(a.event&&a.parentItem.id===r+"_border_bordercolor")if(!H(a.event.target,".e-border-colorpicker")||H(a.event.target,".e-apply")||H(a.event.target,".e-cancel")){e.colorPicker=ot(e.cPickerEle,"colorpicker"),e.colorPicker.mode==="Picker"&&(e.colorPicker.mode="Palette",e.colorPicker.dataBind());var l=e.colorPicker.element.parentElement;l.style.display="",e.parent.element.appendChild(l),T.remove(l,"keydown",n)}else a.cancel=!0},onOpen:function(a){if(a.parentItem.id===r+"_border_bordercolor"){a.element.parentElement.style.overflow="visible";var l=a.element.querySelector(".e-color-palette .e-palette");l&&Re(l)}},onClose:function(){return Re(s.element)},select:function(a){e.borderSelected(a,s)}});return s.createElement=this.parent.createElement,s.appendTo(t),t.classList.add("e-ul"),s},o.prototype.chartSelected=function(t,e){var i=!g(H(t.element,".e-chart-menu")),r=t.element.id;if("column_chartbar_chartarea_chartpie_doughnut_chartline_chartradar_chartscatter_chart".includes(r)){t.item&&(!t.item.items||!t.item.items.length)&&e.toggle();var n=t.event.target.id;this.parent.notify(AD,{action:r,id:n,isChart:i})}},o.prototype.addChartEleSelected=function(t){var e=t.element.id;this.parent.notify(Wc,{addChartEle:e,triggerEvent:!0}),t.item&&(!t.item.items||!t.item.items.length)&&this.addChartDdb.toggle()},o.prototype.cfSelected=function(t){var e=this.parent.getActiveSheet();if(t.item.id.includes("_dlg"))this.parent.notify(ID,{action:t.item.text});else{var i=t.item.id.includes("icons");if(i||t.item.id==="cf_cr_cells"||t.item.id==="cf_cr_sheet")if(Hi(this.parent,tt(ie(e.selectedRange))))this.parent.notify(fr,null);else if(i){var r=t.event.target;this.parent.notify(jd,{cfModel:{type:r.id||r.parentElement.id,range:e.selectedRange},isAction:!0})}else t.item.id==="cf_cr_cells"?this.parent.notify(po,{range:e.selectedRange,isAction:!0}):t.item.id==="cf_cr_sheet"&&(this.parent.conditionalFormat=null,this.parent.notify(po,{isAction:!0}))}t.item&&(!t.item.items||!t.item.items.length)&&this.cfDdb.toggle()},o.prototype.borderSelected=function(t,e){this.bordersDdb.element.setAttribute("aria-label",t.item.text);var i=this.parent.element.id;if(!(t.item.items.length||t.item.id===i+"_border_colors")){if(!t.item.text){var r=this.border.split(" "),n=r[1]==="solid"?i+"_"+r[0]:i+"_"+r[1];if(n===t.item.id)return;t.item.id===i+"_1px"||t.item.id===i+"_2px"||t.item.id===i+"_3px"?(r[0]=t.item.id.split(i+"_")[1],r[1]="solid"):(r[1]=t.item.id.split(i+"_")[1],r[0]=r[1]==="double"?"3px":"1px"),this.border=r.join(" "),e.items[12].items.forEach(function(s){s.id===n&&(s.iconCss=null),s.id===t.item.id&&(s.iconCss="e-icons e-selected-icon")}),e.setProperties({items:e.items},!0);return}switch(this.bordersDdb.toggle(),this.parent.showSpinner(),t.item.id){case i+"_border_topborders":this.parent.notify(ur,{style:{borderTop:this.border},onActionUpdate:!0});break;case i+"_border_leftborders":this.parent.notify(ur,{style:{borderLeft:this.border},onActionUpdate:!0});break;case i+"_border_rightborders":this.parent.notify(ur,{style:{borderRight:this.border},onActionUpdate:!0});break;case i+"_border_bottomborders":this.parent.notify(ur,{style:{borderBottom:this.border},onActionUpdate:!0});break;case i+"_border_allborders":this.parent.notify(ur,{style:{border:this.border},onActionUpdate:!0});break;case i+"_border_horizontalborders":this.parent.notify(ur,{style:{border:this.border},onActionUpdate:!0,borderType:"Horizontal"});break;case i+"_border_verticalborders":this.parent.notify(ur,{style:{border:this.border},onActionUpdate:!0,borderType:"Vertical"});break;case i+"_border_outsideborders":this.parent.notify(ur,{style:{border:this.border},onActionUpdate:!0,borderType:"Outer"});break;case i+"_border_insideborders":this.parent.notify(ur,{style:{border:this.border},onActionUpdate:!0,borderType:"Inner"});break;case i+"_border_noborders":this.parent.notify(ur,{style:{border:""},onActionUpdate:!0});break}this.parent.hideSpinner()}},o.prototype.getFontNameDDB=function(t){var e=this,i=this.parent.createElement("button",{id:t+"_font_name",attrs:{type:"button"},className:"e-ss-ddb"}),r=this.parent.createElement("span",{className:"e-tbar-btn-text"});return r.innerText="Calibri",i.appendChild(r),this.fontNameDdb=new Hr({cssClass:"e-font-family",items:this.getFontFamilyItems(),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(n){var s={style:{fontFamily:n.item.text},onActionUpdate:!0};e.parent.notify(ur,s),i.setAttribute("aria-label",n.item.text),s.cancel||e.refreshFontNameSelection(s.style.fontFamily)},beforeOpen:function(n){e.tBarDdbBeforeOpen(n.element,n.items,e.parent.serviceLocator.getService(ve).getConstant("Font"))}}),this.fontNameDdb.createElement=this.parent.createElement,this.fontNameDdb.appendTo(i),i},o.prototype.getBtn=function(t,e,i,r){r===void 0&&(r=!0);var n=new Jn({iconCss:"e-icons e-"+e+"-icon",cssClass:"e-flat",isToggle:!0,enableRtl:this.parent.enableRtl});return n.createElement=this.parent.createElement,n.appendTo(this.parent.createElement("button",{id:t+"_"+e,attrs:{"aria-label":i,type:"button"}})),r&&n.element.addEventListener("click",this.toggleBtnClicked.bind(this)),n.element},o.prototype.datavalidationDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r;return this.datavalidationDdb=new Hr({cssClass:"e-datavalidation-ddb",iconCss:"e-datavalidation-icon e-icons",content:i.getConstant("DataValidation"),enableRtl:this.parent.enableRtl,items:[{text:i.getConstant("DataValidation")},{text:i.getConstant("HighlightInvalidData")},{text:i.getConstant("ClearHighlight")},{text:i.getConstant("ClearValidation")}],createPopupOnClick:!0,beforeOpen:function(n){e.refreshSelected(e.datavalidationDdb,n.element,"iconCss"),n.element.setAttribute("aria-label",i.getConstant("DataValidation"))},select:function(n){switch(n.item.text){case i.getConstant("DataValidation"):e.parent.notify(gD,null);break;case i.getConstant("HighlightInvalidData"):e.parent.notify(Og,{});break;case i.getConstant("ClearHighlight"):e.parent.notify(Og,{isRemoveHighlight:!0});break;case i.getConstant("ClearValidation"):e.parent.notify(zg,{isAction:!0});break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",e.parent.notify(au,{sortOptions:{sortDescriptors:{order:r}}});break}e.datavalidationDdb.element.setAttribute("aria-label",n.item.text)}}),this.datavalidationDdb.createElement=this.parent.createElement,this.datavalidationDdb.appendTo(this.parent.createElement("button",{id:t+"_datavalidation",attrs:{type:"button"},className:"e-ss-ddb"})),this.datavalidationDdb.element},o.prototype.getTextAlignDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve);return this.textAlignDdb=new Hr({cssClass:"e-align-ddb",iconCss:"e-icons e-left-icon",items:[{iconCss:"e-icons e-left-icon"},{iconCss:"e-icons e-center-icon"},{iconCss:"e-icons e-right-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(r){e.refreshSelected(e.textAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment"))},select:function(r){var n={style:{textAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};e.parent.notify(ur,n),n.cancel||(e.textAlignDdb.iconCss="e-icons e-"+n.style.textAlign+"-icon",e.textAlignDdb.dataBind()),e.textAlignDdb.element.setAttribute("aria-label",i.getConstant("HorizontalAlignment")+" "+i.getConstant("Align"+e.getAlignText(r)))}}),this.textAlignDdb.createElement=this.parent.createElement,this.textAlignDdb.appendTo(this.parent.createElement("button",{id:t+"_text_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.textAlignDdb.element},o.prototype.getVerticalAlignDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve);return this.verticalAlignDdb=new Hr({cssClass:"e-align-ddb",iconCss:"e-icons e-bottom-icon",items:[{iconCss:"e-icons e-top-icon"},{iconCss:"e-icons e-middle-icon"},{iconCss:"e-icons e-bottom-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(r){e.refreshSelected(e.verticalAlignDdb,r.element,"iconCss"),r.element.setAttribute("aria-label",i.getConstant("VerticalAlignment"))},select:function(r){var n={style:{verticalAlign:r.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};e.parent.notify(ur,n),n.cancel||(e.verticalAlignDdb.iconCss="e-icons e-"+n.style.verticalAlign+"-icon",e.verticalAlignDdb.dataBind()),e.verticalAlignDdb.element.setAttribute("aria-label",i.getConstant("VerticalAlignment")+" "+i.getConstant("Align"+e.getAlignText(r)))}}),this.verticalAlignDdb.createElement=this.parent.createElement,this.verticalAlignDdb.appendTo(this.parent.createElement("button",{id:t+"_vertical_align",attrs:{type:"button"},className:"e-ss-ddb"})),this.verticalAlignDdb.element},o.prototype.getMergeSplitBtn=function(t){var e=this;this.parent.element.appendChild(this.parent.createElement("button",{id:t+"_merge",attrs:{type:"button"}}));var i=this.parent.serviceLocator.getService(ve);return this.mergeSplitBtn=new uf({cssClass:"e-merge-ddb",iconCss:"e-icons e-merge-icon",createPopupOnClick:!0,enableRtl:this.parent.enableRtl,items:[{text:i.getConstant("MergeAll"),id:t+"_merge_all"},{text:i.getConstant("MergeHorizontally"),id:t+"_merge_horizontally"},{text:i.getConstant("MergeVertically"),id:t+"_merge_vertically"},{separator:!0,id:t+"_merge_separator"},{text:i.getConstant("Unmerge"),id:t+"_unmerge"}],select:this.mergeSelectHandler.bind(this),click:function(r){r.element.setAttribute("aria-label",i.getConstant("MergeCells")),r.element.classList.contains("e-active")?e.unMerge():e.merge(e.parent.element.id+"_merge_all")},created:function(){var r=i.getConstant("MergeCells");e.mergeSplitBtn.element.title=r,e.mergeSplitBtn.element.setAttribute("aria-label",r),e.mergeSplitBtn.element.nextElementSibling.title=i.getConstant("SelectMergeType")},beforeOpen:function(r){return r.element.setAttribute("aria-label",i.getConstant("MergeCells"))}}),this.mergeSplitBtn.createElement=this.parent.createElement,this.mergeSplitBtn.appendTo("#"+t+"_merge"),this.mergeSplitBtn.element.parentElement},o.prototype.mergeSelectHandler=function(t){t.item.id===this.parent.element.id+"_unmerge"?this.unMerge():this.merge(t.item.id),this.mergeSplitBtn.element.setAttribute("aria-label",t.item.text)},o.prototype.unMerge=function(t){var e=this.parent.getActiveSheet(),i=tt(ie(e.selectedRange));if(Hi(this.parent,i)){this.parent.notify(fr,null);return}this.parent.showSpinner();for(var r=e.selectedRange,n=[],s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++){var l=Q(s,a,e);if(l&&(l.rowSpan>1||l.colSpan>1)){var h={range:[s,a,s,a]};this.parent.notify(uo,h),n.push(h.range)}}var c={merge:!1,range:t&&t.range||r,isAction:!0,refreshRibbon:!0,type:"All"};n.length>0&&(c.mergeCollection=n),this.parent.notify(Nn,c),this.toggleActiveState(!1),this.parent.hideSpinner()},o.prototype.merge=function(t){var e=this,i=this.parent.getActiveSheet(),r=tt(ie(i.selectedRange)),n;if(Hi(this.parent,tt(r))){this.parent.notify(fr,null);return}for(var s,a=t.includes("merge_all"),l=r[0];l<=r[2];l++)for(var h=r[1];h<=r[3];h++)l===r[0]&&h===r[1]&&a||l===r[0]&&t.includes("merge_vertically")||h===r[1]&&t.includes("_merge_horizontally")||(n=Q(l,h,i)||{},(n.value||n.formula)&&(s=!0));if(!s){this.performMerge(t),a&&this.toggleActiveState(!0);return}var c=this.parent.serviceLocator.getService(jt);c.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-merge-alert-dlg",enableRtl:this.parent.enableRtl,content:this.parent.serviceLocator.getService(ve).getConstant("MergeCellsAlert"),beforeOpen:function(u){var d={dialogName:"MergeAlertDialog",element:u.element,target:u.target,cancel:u.cancel};e.parent.trigger("dialogBeforeOpen",d),d.cancel?u.cancel=!0:Re(e.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(ve).getConstant("Ok"),isPrimary:!0},click:function(){c.hide(),e.performMerge(t),a&&e.toggleActiveState(!0)}}]})},o.prototype.performMerge=function(t){var e=this.parent.element.id;switch(this.parent.showSpinner(),t){case e+"_merge_all":this.parent.notify(Nn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"All",isAction:!0,refreshRibbon:!0});break;case e+"_merge_horizontally":this.parent.notify(Nn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Horizontally",isAction:!0});break;case e+"_merge_vertically":this.parent.notify(Nn,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Vertically",isAction:!0});break}this.parent.hideSpinner()},o.prototype.getSortFilterDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.enableRtl,n;return this.sortingDdb=new Hr({cssClass:"e-sort-filter-ddb",iconCss:"e-icons e-sort-filter-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom"},{separator:!0},{text:i.getConstant("Filter"),iconCss:"e-icons e-filter-apply",id:t+"_applyfilter"},{text:i.getConstant("ClearAllFilter"),iconCss:"e-icons e-filter-clear",id:t+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:t+"_reapplyfilter"}],createPopupOnClick:!0,enableRtl:r,beforeItemRender:function(s){var a={isFiltered:!1,isClearAll:!0};e.parent.notify(S0,a),!e.parent.allowSorting&&(s.item.text===i.getConstant("SortAscending")||s.item.text===i.getConstant("SortDescending")||s.item.text===i.getConstant("CustomSort")+"...")&&s.element.classList.add("e-disabled"),!e.parent.allowFiltering&&s.item.text===i.getConstant("Filter")&&s.element.classList.add("e-disabled"),(s.item.id===t+"_clearfilter"||s.item.id===t+"_reapplyfilter")&&(a.isFiltered?s.element.classList.remove("e-disabled"):s.element.classList.add("e-disabled"))},beforeOpen:function(s){e.refreshSelected(e.sortingDdb,s.element,"iconCss"),s.element.setAttribute("aria-label",e.parent.serviceLocator.getService(ve).getConstant("SortAndFilter"))},select:function(s){var a=[];if(s.item.text===i.getConstant("SortAscending")||s.item.text===i.getConstant("SortDescending")||s.item.text===i.getConstant("CustomSort")+"..."){var l=ie(e.parent.getActiveSheet().selectedRange),h=U0(l[0],l[1],e.parent.getActiveSheet());if(Hi(e.parent,h)){e.parent.notify(fr,null);return}}switch(s.item.text){case i.getConstant("Filter"):e.parent.notify(Yo,{});break;case i.getConstant("ClearAllFilter"):e.parent.notify(Rg,{isAction:!0});break;case i.getConstant("ReapplyFilter"):e.parent.notify(b0,null);break;case i.getConstant("CustomSort")+"...":e.parent.notify(c0,null);break;default:if(n=s.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",e.parent.sortCollection)for(var c=e.parent.sortCollection.length-1;c>=0;c--)e.parent.sortCollection[c]&&e.parent.sortCollection[c].sheetIndex===e.parent.activeSheetIndex&&(a.push(e.parent.sortCollection[c]),e.parent.sortCollection.splice(c,1));e.parent.notify(Zc,{sortOptions:{sortDescriptors:{order:n}}}),e.parent.notify(au,{sortOptions:{sortDescriptors:{order:n}},previousSort:a});break}e.sortingDdb.element.setAttribute("aria-label",s.item.text)}}),this.sortingDdb.createElement=this.parent.createElement,this.sortingDdb.appendTo(this.parent.createElement("button",{id:t+"_sorting",attrs:{type:"button"},className:"e-ss-ddb"})),this.sortingDdb.element},o.prototype.getFindBtn=function(t){var e=this,i=this.parent.createElement("button",{id:t+"_findbtn",attrs:{type:"button","aria-label":this.parent.serviceLocator.getService(ve).getConstant("FindReplaceTooltip")}});return this.findDdb=new Jn({cssClass:"e-spreadsheet-find-ddb e-flat",iconCss:"e-icons e-search-icon",enableRtl:this.parent.enableRtl}),this.findDdb.createElement=this.parent.createElement,this.findDdb.appendTo(i),i.onclick=function(r){e.parent.notify(Qc,{event:r})},this.findDdb.element},o.prototype.getClearDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(ve);return this.clearDdb=new Hr({cssClass:"e-clear-ddb",iconCss:"e-icons e-clear-icon",items:[{text:i.getConstant("ClearAll"),id:t+"_Clear All"},{text:i.getConstant("ClearFormats"),id:t+"_Clear Formats"},{text:i.getConstant("ClearContents"),id:t+"_Clear Contents"},{text:i.getConstant("ClearHyperlinks"),id:t+"_Clear Hyperlinks"}],createPopupOnClick:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(r){r.element.setAttribute("aria-label",e.parent.serviceLocator.getService(ve).getConstant("Clear"))},beforeItemRender:function(r){var n=e.parent.getActiveSheet(),s=tt(ie(n.selectedRange));n.isProtected&&n.protectSettings.formatCells&&r.item.id!==t+"_Clear Formats"&&(r.item.id===t+"_Clear Hyperlinks"||Ko(e.parent,s))&&(r.element.classList.add("e-disabled"),r.element.setAttribute("aria-disabled","true"))},select:function(r){e.parent.notify(Pg,{options:{type:r.item.id.replace(t+"_","")},isAction:!0}),e.clearDdb.element.setAttribute("aria-label",r.item.text)}}),this.clearDdb.createElement=this.parent.createElement,this.clearDdb.appendTo(this.parent.createElement("button",{id:t+"_clear",attrs:{type:"button"},className:"e-ss-ddb"})),this.clearDdb.element},o.prototype.ribbonCreated=function(){var t=this.parent.serviceLocator.getService(ve).getConstant("CollapseToolbar");Ee(this.ribbon.element.querySelector(".e-drop-icon"),{role:"button",tabindex:"-1",title:t,"aria-label":t}),this.ribbon.toolbarObj&&(this.ribbon.toolbarObj.allowKeyboard=this.parent.enableKeyboardNavigation,this.ribbon.toolbarObj.dataBind())},o.prototype.alignItemRender=function(t){t.element.title=this.parent.serviceLocator.getService(ve).getConstant("Align"+this.getAlignText(t))},o.prototype.getAlignText=function(t){var e=t.item.iconCss.split(" e-")[1].split("-icon")[0];return e[0].toUpperCase()+e.slice(1,e.length)},o.prototype.toggleBtnClicked=function(t){var e=H(t.target,".e-btn"),i=this.parent.element.id,r=e.id,n=ur,s,a,l,h,c;switch(r){case i+"_bold":a={fontWeight:"normal"},l={fontWeight:"bold"},c="fontWeight";break;case i+"_italic":a={fontStyle:"normal"},l={fontStyle:"italic"},c="fontStyle";break;case i+"_line-through":n=Rd,a={textDecoration:"line-through"},l=a,c="textDecoration";break;case i+"_underline":n=Rd,a={textDecoration:"underline"},l=a,c="textDecoration";break}e.classList.contains("e-active")?(s=l[""+c],h={style:l,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&e.classList.remove("e-active")):(s=a[""+c],h={style:a,onActionUpdate:!0},this.parent.notify(n,h),h.cancel&&e.classList.add("e-active")),!h.cancel&&s!==h.style[""+c]&&this.refreshToggleBtn(xe(this.parent.getActiveSheet().activeCell))},o.prototype.getCellStyleValue=function(t,e){var i=Q(e[0],e[1],this.parent.getActiveSheet()),r=this.parent.cellStyle[""+t];return i&&i.style&&i.style[""+t]&&(r=i.style[""+t]),r},o.prototype.refreshSelected=function(t,e,i,r){r===void 0&&(r=i);for(var n=0;n<t.items.length;n++)if(t.items[n][""+r]===t[""+i]){e.children[n].classList.add("e-selected");break}},o.prototype.expandCollapseHandler=function(t){var e=this.ribbon.element.querySelector(".e-drop-icon"),i=this.parent.serviceLocator.getService(ve);t.expanded?(e.title=i.getConstant("CollapseToolbar"),e.setAttribute("aria-label",i.getConstant("ExpandToolbar"))):(e.title=i.getConstant("ExpandToolbar"),e.setAttribute("aria-label",i.getConstant("CollapseToolbar"))),this.parent.setPanelSize()},o.prototype.getChartThemeDdbItems=function(t){var e=this.parent.serviceLocator.getService(ve),i=[],r=["Material","Fabric","Bootstrap","HighContrastLight","MaterialDark","FabricDark","HighContrast","BootstrapDark","Bootstrap4","Bootstrap5Dark","Bootstrap5","TailwindDark","Tailwind","Tailwind3","Tailwind3Dark","FluentDark","Fluent","Fluent2","Fluent2Dark","Material3","Material3Dark"];return r.forEach(function(n){i.push({id:n,text:e.getConstant(n),iconCss:n===t?"e-icons e-selected-icon":""})}),i},o.prototype.getNumFormatDdbItems=function(t){var e=this.parent.serviceLocator.getService(ve);return[{id:t+"_General",text:e.getConstant("General")},{id:t+"_Number",text:e.getConstant("Number")},{id:t+"_Currency",text:e.getConstant("Currency")},{id:t+"_Accounting",text:e.getConstant("Accounting")},{id:t+"_ShortDate",text:e.getConstant("ShortDate")},{id:t+"_LongDate",text:e.getConstant("LongDate")},{id:t+"_Time",text:e.getConstant("Time")},{id:t+"_Percentage",text:e.getConstant("Percentage")},{id:t+"_Fraction",text:e.getConstant("Fraction")},{id:t+"_Scientific",text:e.getConstant("Scientific")},{id:t+"_Text",text:e.getConstant("Text")},{id:t+"_Custom",text:e.getConstant("Custom")}]},o.prototype.getFontFamilyItems=function(){return[{text:"Arial"},{text:"Arial Black"},{text:"Axettac Demo"},{text:"Batang"},{text:"Book Antiqua"},{text:"Calibri",iconCss:"e-icons e-selected-icon"},{text:"Comic Sans MS"},{text:"Courier"},{text:"Courier New"},{text:"Din Condensed"},{text:"Georgia"},{text:"Helvetica"},{text:"Helvetica New"},{text:"Roboto"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Verdana"}]},o.prototype.applyNumFormat=function(t){var e=this.parent.getActiveSheet(),i={format:t,range:e.selectedRange,cancel:!1,requestType:"NumberFormat"},r={range:e.name+"!"+i.range,format:i.format,requestType:"NumberFormat"},n=Hi(this.parent,tt(ie(i.range)));return!n&&(this.parent.trigger("beforeCellFormat",i),this.parent.notify(hi,{eventArgs:i,action:"format"}),i.cancel)||(this.parent.notify(vg,i),this.parent.notify(Ta,{type:"mousedown"}),n||this.parent.notify(wt,{eventArgs:r,action:"format"})),i.format},o.prototype.renderCustomFormatDialog=function(t,e){var i=this,r=this.parent.serviceLocator.getService(ve),n=this.parent.createElement("div"),s=this.parent.createElement("div",{className:"e-custom-dialog"}),a=this.parent.createElement("button",{className:"e-btn",attrs:{type:"button"}});a.innerText=r.getConstant("Apply");var l=this.parent.createElement("div",{className:"e-custom-sample"});l.innerText=r.getConstant("CustomFormatTypeList")+":";var h=this.parent.createElement("div",{className:"e-input-button"}),c=this.parent.createElement("input",{className:"e-input e-dialog-input",attrs:{type:"text",name:"input",spellcheck:"false",placeholder:r.getConstant("CustomFormatPlaceholder")}}),u=this.parent.createElement("div",{className:"e-custom-listview"}),d=this.parent.serviceLocator.getService(jt),p=new hf({dataSource:e,enableRtl:this.parent.enableRtl,select:function(S){c.value=S.item.textContent,S.event&&S.event.type==="keydown"&&S.item&&S.item.focus()}});if(h.appendChild(c),h.appendChild(a),s.appendChild(h),s.appendChild(l),s.appendChild(u),p.appendTo(u),e[4]!==t[4])for(var f=p.element.getElementsByClassName("e-list-text"),v=0,m=f.length;v<m;v++)f[v].textContent!==e[v]&&(f[v].textContent=e[v]);var y=function(){var S=c.value,C=e.indexOf(S),x;C>-1?x=t[C]:x=g9(i.parent,S),x=i.applyNumFormat(x),x&&(i.refreshNumFormatSelection(en(x,!0),i.parent.getActiveSheet(),r,x),i.parent.notify(qd,{action:"addToCustomFormats",format:S,defaultFormat:x})),d.hide(),i.parent.showAggregate&&i.parent.notify(jl,{})};a.addEventListener("click",y);var b=function(){var S=p.getSelectedItems();S&&p.unselectItem()};c.addEventListener("input",b),d.show({header:r.getConstant("CustomFormat"),cssClass:"e-custom-format-dlg",height:this.parent.cssClass.indexOf("e-bigger")>-1?502:480,width:440,isModal:!0,showCloseIcon:!0,content:s,footerTemplate:n,enableRtl:this.parent.enableRtl,beforeOpen:function(S){var C={dialogName:"CustomNumberFormatDlg",element:S.element,target:S.target,cancel:S.cancel};if(i.parent.trigger("dialogBeforeOpen",C),C.cancel)S.cancel=!0;else{var x=i.parent.getActiveSheet(),I=xe(x.activeCell),D=Q(I[0],I[1],x);if(D&&D.format){var M=t.indexOf(D.format);p.selectItem(p.element.getElementsByClassName("e-list-item")[M])}Re(i.parent.element)}}})},o.prototype.tBarDdbBeforeOpen=function(t,e,i,r){r===void 0&&(r=0);var n=this.parent.viewport.height,s=parseInt(getComputedStyle(t.firstElementChild).height,10)*(e.length-r)+parseInt(getComputedStyle(t).paddingTop,10)*2;if(r){var a=getComputedStyle(t.querySelector(".e-separator"));s+=r*(parseInt(a.borderBottomWidth,10)+parseInt(a.marginTop,10)*2)}s>n?(t.style.height=n+"px",t.style.overflowY="auto"):t.style.height&&(t.style.height="",t.style.overflowY=""),t.setAttribute("aria-label",i)},o.prototype.numDDBOpen=function(t){this.numPopupWidth=0;for(var e=t.element.querySelectorAll("span.e-numformat-preview-text"),i=0,r=e.length;i<r;i++){var n=e[i].textContent;n.endsWith(" ")&&(e[i].textContent=n.trim()),this.numPopupWidth<e[i].offsetWidth&&(this.numPopupWidth=e[i].offsetWidth)}var s=this.numPopupWidth+160;document.querySelector(".e-numformat-ddb.e-dropdown-popup").style.width=s+"px"},o.prototype.previewNumFormat=function(t){if(!t.item.id.includes("_Custom")){var e=this.parent.createElement("div",{className:"e-numformat-text",styles:"width:100%",innerHTML:t.element.innerHTML});t.element.innerHTML="";var i=this.parent.getActiveSheet(),r=xe(i.activeCell),n=Q(r[0],r[1],i,!1,!0);if(!g(n.value)||n.value!==""){var s=cr(t.item.id.split(this.parent.element.id+"_")[1]),a={type:t.item.text,formattedText:"",value:n.value,format:s,cell:{value:n.value,format:s},skipFormatCheck:xs(this.parent)};this.parent.notify(yr,a);var l=this.parent.createElement("span",{className:"e-numformat-preview-text",styles:"float:"+(this.parent.enableRtl?"left":"right")+";"});l.innerText=a.formattedText,e.appendChild(l)}t.element.appendChild(e)}},o.prototype.refreshRibbonContent=function(t){if(this.ribbon){g(t)&&(t=this.ribbon.selectedTab);var e=this.parent.serviceLocator.getService(ve),i=this.parent.getActiveSheet(),r=xe(i.activeCell);switch(this.ribbon.items[t].header.text){case e.getConstant("Home"):this.refreshHomeTabContent(r);break;case e.getConstant("Insert"):{i.isProtected&&(i.protectSettings.insertLink&&!mn(Q(r[0],r[1],i),Ht(i,r[1]))?this.enableToolbarItems([{tab:e.getConstant("Insert"),items:[this.parent.element.id+"_hyperlink"],enable:!0}]):this.enableToolbarItems([{tab:e.getConstant("Insert"),items:[this.parent.element.id+"_hyperlink"],enable:!1}]));break}case e.getConstant("Formulas"):i.isProtected&&(mn(Q(r[0],r[1],i),Ht(i,r[1]))?this.enableToolbarItems([{tab:e.getConstant("Formulas"),items:[this.parent.element.id+"_insert_function"],enable:!1}]):this.enableToolbarItems([{tab:e.getConstant("Formulas"),items:[this.parent.element.id+"_insert_function"],enable:!0}]));break;case e.getConstant("Data"):this.refreshDataTabContent(t);break;case e.getConstant("View"):this.refreshViewTabContent(t);break}}},o.prototype.refreshHomeTabContent=function(t){g(document.getElementById(this.parent.element.id+"_number_format"))||(this.numFormatDDB=ot(document.getElementById(this.parent.element.id+"_number_format"),Hr));var e=this.parent.getActiveSheet(),i=xe(e.activeCell),r=this.parent.serviceLocator.getService(ve),n=Q(i[0],i[1],e,!1,!0),s=en(n.format||"General",!0);if(this.refreshNumFormatSelection(s,e,r,n.format),e.isProtected&&this.parent.enableClipboard&&this.parent.clipboardModule.copiedInfo&&this.parent.notify(Ea,[{items:[this.parent.element.id+"_paste"],enable:!mn(n,Ht(e,i[1]))}]),this.fontNameDdb&&(e.isProtected&&!e.protectSettings.formatCells?this.refreshFontNameSelection("Calibri"):this.refreshFontNameSelection(this.getCellStyleValue("fontFamily",t))),this.fontSizeDdb){var a=this.getCellStyleValue("fontSize",t);e.isProtected&&!e.protectSettings.formatCells?this.fontSizeDdb.content="11":(a=a.includes("pt")?a.split("pt")[0]:"11",a!==this.fontSizeDdb.content&&(this.fontSizeDdb.content=a,this.fontSizeDdb.dataBind()))}if(this.refreshTextAlign(e,n,s,t),this.verticalAlignDdb){var a="e-icons e-"+this.getCellStyleValue("verticalAlign",t).toLowerCase()+"-icon";e.isProtected&&!e.protectSettings.formatCells?this.verticalAlignDdb.iconCss="e-icons e-bottom-icon":a!==this.verticalAlignDdb.iconCss&&(this.verticalAlignDdb.iconCss=a,this.verticalAlignDdb.dataBind())}this.refreshToggleBtn(t),this.parent.allowMerge&&this.updateMergeBtnState(e,r,n)},o.prototype.updateMergeBtnState=function(t,e,i){if(i.rowSpan>1||i.colSpan>1)this.enableToolbarItems([{tab:e.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!t.isProtected}]),this.toggleActiveState(!0);else{var r=ie(t.selectedRange);this.enableToolbarItems([{tab:e.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:(r[0]!==r[2]||r[1]!==r[3])&&!t.isProtected}]),this.toggleActiveState(!1)}},o.prototype.refreshTextAlign=function(t,e,i,r){if(this.textAlignDdb){var n=this.getCellStyleValue("textAlign",r);if(t.isProtected&&!t.protectSettings.formatCells)this.textAlignDdb.iconCss="e-icons e-left-icon";else{e.value!==void 0&&n==="left"&&(i==="Accounting"||De(e.value)&&i!=="Text")&&(n="right");var s="e-icons e-"+n.toLowerCase()+"-icon";s!==this.textAlignDdb.iconCss&&(this.textAlignDdb.iconCss=s,this.textAlignDdb.dataBind())}}},o.prototype.toggleActiveState=function(t){var e=this.parent.serviceLocator.getService(ve);t?this.mergeSplitBtn.element.classList.contains("e-active")||(this.mergeSplitBtn.element.classList.add("e-active"),this.mergeSplitBtn.element.title=e.getConstant("UnmergeCells")):this.mergeSplitBtn.element.classList.contains("e-active")&&(this.mergeSplitBtn.element.classList.remove("e-active"),this.mergeSplitBtn.element.title=e.getConstant("MergeCells"))},o.prototype.refreshToggleBtn=function(t){var e=this,i=this.parent.getActiveSheet(),r,n=this.parent.element.id,s,a,l=Q(t[0],t[1],i),h=["fontWeight","fontStyle","textDecoration","textDecoration"];["bold","italic","line-through","underline","wrap"].forEach(function(c,u){r=document.getElementById(n+"_"+c),r&&(a=!1,(!i.isProtected||i.protectSettings.formatCells)&&(c==="wrap"?a=e.parent.allowWrap&&l&&l.wrap:e.parent.allowCellFormatting&&(s=e.getCellStyleValue(h[u],t).toLowerCase(),a=s.indexOf(c)>-1)),a?r.classList.add("e-active"):r.classList.contains("e-active")&&r.classList.remove("e-active"))})},o.prototype.refreshFontNameSelection=function(t){t=t.split('"').join(""),this.fontNameDdb.element.firstElementChild.textContent=t;for(var e=0;e<this.fontNameDdb.items.length;e++)if(this.fontNameDdb.items[e].text===t){this.fontNameDdb.items[e].iconCss="e-icons e-selected-icon",e!==this.fontNameIndex&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.setProperties({items:this.fontNameDdb.items},!0),this.fontNameIndex=e;break}["Arial","Arial Black","Axettac Demo","Batang","Book Antiqua","Calibri","Comic Sans MS","Courier","Courier New","Din Condensed","Georgia","Helvetica","Helvetica New","Roboto","Tahoma","Times New Roman","Verdana"].indexOf(t)<0&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.element.setAttribute("aria-label",t)},o.prototype.refreshNumFormatSelection=function(t,e,i,r){if(this.numFormatDDB){e.isProtected&&!e.protectSettings.formatCells?t="General":(r&&t==="General"&&r!=="General"&&(t="Custom"),t=i.getConstant(t));for(var n=0;n<this.numFormatDDB.items.length;n++)this.numFormatDDB.items[n].iconCss!==""&&(this.numFormatDDB.items[n].iconCss=""),this.numFormatDDB.items[n].text===t&&(this.numFormatDDB.items[n].iconCss="e-icons e-selected-icon");this.numFormatDDB.element.firstElementChild.textContent=t,this.numFormatDDB.setProperties({items:this.numFormatDDB.items},!0),this.numFormatDDB.element.setAttribute("aria-label",t)}},o.prototype.fileMenuItemSelect=function(t){var e=this,i=pe({cancel:!1},t);this.parent.trigger("fileMenuItemSelect",i);var r=this.parent.element.id,n;if(!i.cancel)switch(t.item.id){case r+"_Print":this.parent.print();break;case r+"_Open":J("#"+r+"_fileUpload",this.parent.element).click(),Re(this.parent.element);break;case r+"_Xlsx":case r+"_Xls":case r+"_Csv":case r+"_Pdf":this.parent.notify(fg,t);break;case r+"_New":n=this.parent.serviceLocator.getService(jt),n.show({height:200,width:400,isModal:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,content:this.parent.serviceLocator.getService(ve).getConstant("DestroyAlert"),beforeOpen:function(s){var a={dialogName:"DestroySheetDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:Re(e.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(ve).getConstant("Ok"),isPrimary:!0},click:function(){n.hide(),e.parent.refresh(!0)}}]});break}},o.prototype.toolbarClicked=function(t){if(t.item&&t.item.id!=="spreadsheet_find"){var e=this.parent.element.id,i=this.parent.getActiveSheet(),r=void 0,n=void 0,s=void 0,a=void 0;switch(t.item.id){case e+"_headers":if(r={isShow:!i.showHeaders,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(wt,{eventArgs:r,action:"headers"}),r.cancel)return;this.parent.setSheetPropertyOnMute(i,"showHeaders",!i.showHeaders),this.parent.serviceLocator.getService("sheet").showHideHeaders(),this.toggleRibbonItems({props:"Headers",activeTab:this.ribbon.selectedTab});break;case e+"_gridlines":if(n={isShow:!i.showGridLines,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(wt,{eventArgs:n,action:"gridLines"}),n.cancel)return;this.parent.setSheetPropertyOnMute(i,"showGridLines",!i.showGridLines),this.toggleRibbonItems({props:"GridLines",activeTab:this.ribbon.selectedTab});break;case e+"_protect":this.parent.notify(B0,{});break;case e+"_undo":this.parent.notify(yo,{isUndo:!0});break;case e+"_redo":this.parent.notify(yo,{isUndo:!1});break;case e+"_freezepanes":s=xe(i.topLeftCell),a=i.frozenRows||i.frozenColumns?s:xe(i.activeCell),this.parent.notify(hg,{row:a[0]-s[0],column:a[1]-s[1],triggerEvent:!0});break;case e+"_freezerows":this.parent.notify(hg,{row:i.frozenRows?0:xe(i.activeCell)[0]-xe(i.topLeftCell)[0],column:i.frozenColumns,triggerEvent:!0});break;case e+"_freezecolumns":this.parent.notify(hg,{row:i.frozenRows,column:i.frozenColumns?0:xe(i.activeCell)[1]-xe(i.topLeftCell)[1],triggerEvent:!0});break;case e+"_protectworkbook":this.parent.password.length>0?this.parent.notify(F0,null):this.parent.isProtected?(this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}),this.parent.notify(wt,{action:"protectWorkbook",eventArgs:{isProtected:!1}})):this.parent.element.querySelector(".e-add-sheet-tab").classList.contains("e-disabled")?this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}):this.parent.notify(k0,null);break}this.parent.notify(Ag,t)}},o.prototype.toggleRibbonItems=function(t){var e="",i=this.parent.serviceLocator.getService(ve).getConstant("View"),r=this.parent.serviceLocator.getService(ve).getConstant("Data");if(this.ribbon.items[this.ribbon.selectedTab].header.text===i){if(g(t.activeTab)){for(var n=0,s=this.ribbon.items.length;n<s;n++)if(this.ribbon.items[n].header.text===i){t.activeTab=n;break}}var a=this.getLocaleText(t.props);t.props==="GridLines"&&this.parent.serviceLocator.getService("sheet").toggleGridlines();for(var l=this.parent.element.id+"_"+t.props.toLowerCase(),h=this.ribbon.items[t.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[t.activeTab].content[n].type!=="Separator"&&this.ribbon.items[t.activeTab].content[n].id===l&&(this.ribbon.items[t.activeTab].content[n].text=a,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===i&&t.props!=="Protect"&&this.updateToggleText(t.props.toLowerCase(),a)}if(this.ribbon.items[this.ribbon.selectedTab].header.text===r){if(g(t.activeTab)){for(var n=0,c=this.ribbon.items.length;n<c;n++)if(this.ribbon.items[n].header.text===r){t.activeTab=n;break}}var l=this.parent.element.id+"_"+t.props.toLowerCase();if(l===this.parent.element.id+"_protect"){var u=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<u&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protect";d++);e=this.getLocaleProtectText("Sheet",!0)}else if(l===this.parent.element.id+"_protectworkbook"){var p=this.ribbon.items[this.ribbon.selectedTab].content.length,d=void 0;for(d=0;d<p&&this.ribbon.items[this.ribbon.selectedTab].content[d].id!==this.parent.element.id+"_protectworkbook";d++);this.parent.isProtected||this.parent.password.length>0?e=this.getLocaleProtectWorkbook("UnprotectWorkbook"):this.parent.isProtected||(e=this.getLocaleProtectWorkbook("ProtectWorkbook"))}for(var h=this.ribbon.items[t.activeTab].content.length,n=void 0;n<h;n++)this.ribbon.items[t.activeTab].content[n].type!=="Separator"&&this.ribbon.items[t.activeTab].content[n].id===l&&(this.ribbon.items[t.activeTab].content[n].text=e,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===r&&this.updateToggleText(t.props.toLowerCase(),e)}},o.prototype.enableFileMenuItems=function(t){this.ribbon.enableMenuItems(t.items,t.enable,t.isUniqueId)},o.prototype.hideRibbonTabs=function(t){this.ribbon.hideTabs(t.tabs,t.hide)},o.prototype.addRibbonTabs=function(t){this.ribbon.addTabs(t.items,t.insertBefore);var e=J(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide",this.parent.element);e&&this.parent.updateActiveBorder(ze(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)",this.parent.element)[this.ribbon.selectedTab])},o.prototype.updateToggleText=function(t,e){var i=J("#"+this.parent.element.id+"_"+t+" .e-tbar-btn-text",this.ribbon.element);if(t==="protect"||t==="protectworkbook"?i.parentElement.setAttribute("aria-label",e):i.parentElement.setAttribute("aria-label",i.textContent),er(function(){i&&(i.textContent=e)}),t==="headers"){var r=this.parent.element.getElementsByClassName("e-findtool-dlg")[0];r&&r.classList.contains("e-popup-open")&&this.parent.notify(Qc,{refreshPosition:!0,dialogEle:r})}},o.prototype.refreshViewTabContent=function(t){for(var e=this.parent.element.id,i=this.parent.getActiveSheet(),r=this.parent.serviceLocator.getService(ve),n,s=0;s<this.ribbon.items[t].content.length;s++)n=this.ribbon.items[t].content[s],n.type!=="Separator"&&(n.id===e+"_headers"&&this.updateViewTabContent(t,"Headers",s),n.id===e+"_gridlines"&&this.updateViewTabContent(t,"GridLines",s),n.id===e+"_freezepanes"&&(i.frozenRows||i.frozenColumns?n.text===r.getConstant("FreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Unfreeze","Panes",s,t)):n.text===r.getConstant("UnfreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Freeze","Panes",s,t))),n.id===e+"_freezerows"&&(i.frozenRows?n.text===r.getConstant("FreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Unfreeze","Rows",s,t)):n.text===r.getConstant("UnfreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Freeze","Rows",s,t))),n.id===e+"_freezecolumns"&&(i.frozenColumns?n.text===r.getConstant("FreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Unfreeze","Columns",s,t)):n.text===r.getConstant("UnfreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Freeze","Columns",s,t))))},o.prototype.updateViewTabContent=function(t,e,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(ve);r["show"+e]?this.ribbon.items[t].content[i].text===n.getConstant("Show"+e)&&this.updateToggleText(e.toLowerCase(),this.updateRibbonItemText("Hide",e,i,t)):this.ribbon.items[t].content[i].text===n.getConstant("Hide"+e)&&this.updateToggleText(e.toLowerCase(),this.updateRibbonItemText("Show",e,i,t))},o.prototype.updateRibbonItemText=function(t,e,i,r){var n=this.parent.serviceLocator.getService(ve),s=n.getConstant(t+e);return this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),s},o.prototype.refreshDataTabContent=function(t){for(var e=this.parent.element.id,i,r=0;r<this.ribbon.items[t].content.length;r++)if(this.ribbon.items[t].content[r].type!=="Separator"){if(this.ribbon.items[t].content[r].id===e+"_protect"){if(this.updateDataTabContent(t,"Sheet",r),i)break;i=!0}this.ribbon.items[t].content[r].id===e+"_protectworkbook"&&this.updateDataTabContent(t,"Workbook",r)}},o.prototype.updateDataTabContent=function(t,e,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(ve);if(e==="Sheet")r.isProtected?this.ribbon.items[t].content[i].text===n.getConstant("Protect"+e)&&(this.ribbon.items[t].content[i].cssClass="e-active",this.updateProtectBtn("Unprotect",e,i,t)):this.updateProtectBtn("Protect",e,i,t);else if(e==="Workbook"){var s=this.parent.serviceLocator.getService(ve);this.parent.isProtected?this.ribbon.items[t].content[i].text===s.getConstant("Protect"+e)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Unprotect",e,i,t)):this.ribbon.items[t].content[i].text===s.getConstant("Unprotect"+e)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Protect",e,i,t))}},o.prototype.updateProtectBtn=function(t,e,i,r){var n=this.parent.serviceLocator.getService(ve),s=n.getConstant(t+e);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protect",s)},o.prototype.updateProtectWorkbookBtn=function(t,e,i,r){var n=this.parent.serviceLocator.getService(ve),s=n.getConstant(t);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protectworkbook",s)},o.prototype.addToolbarItems=function(t){var e=this.parent.serviceLocator.getService(ve);this.ribbon.addToolbarItems(e.getConstant(t.tab),t.items,t.index),this.parent&&this.parent.isReact&&this.parent.portals&&this.ribbon.toolbarObj&&this.ribbon.toolbarObj.portals&&(this.parent.portals=this.parent.portals.concat(this.ribbon.toolbarObj.portals),this.parent.renderReactTemplates())},o.prototype.enableToolbarItems=function(t){var e=this;t.forEach(function(i){e.ribbon.enableItems(i.tab||e.ribbon.items[e.ribbon.selectedTab].header.text,i.items,i.enable,i.isPublic)})},o.prototype.createMobileView=function(){var t=this,e=this.parent.element.id,i=this.parent.createElement("div",{className:"e-header-toolbar"}),r=this.parent.createElement("ul");i.appendChild(r);var n=new yc({items:[{prefixIcon:"e-tick-icon",align:"Left",id:e+"focused_tick",cssClass:"e-focused-tick"},{template:r,align:"Right",id:e+"file_menu"}],enableRtl:this.parent.enableRtl,clicked:function(s){switch(s.item.id){case e+"focused_tick":t.parent.element.classList.remove("e-mobile-focused"),t.parent.renderModule.setSheetPanelSize();break}},created:function(){var s=new bc({cssClass:"e-mobile e-file-menu",enableRtl:t.parent.enableRtl,showItemOnClick:!0,items:t.getRibbonMenuItems(),select:t.fileMenuItemSelect.bind(t),beforeOpen:function(a){a.element.parentElement.classList.remove("e-rtl"),t.fileMenuBeforeOpen(a)},beforeClose:t.fileMenuBeforeClose.bind(t)});s.createElement=t.parent.createElement,s.appendTo(r)}});n.createElement=this.parent.createElement,n.appendTo(i),this.parent.element.insertBefore(i,this.parent.element.firstElementChild),this.renderMobileToolbar()},o.prototype.renderMobileToolbar=function(){var t=this,e=this.parent.createElement("div",{className:"e-toolbar-panel e-ribbon"}),i=this.parent.createElement("div"),r=this.parent.createElement("button",{attrs:{type:"button"}});e.appendChild(i),e.appendChild(r),e.style.display="block",this.parent.element.appendChild(e);var n=new Hr({cssClass:"e-caret-hide",content:this.ribbon.items[0].header.text,items:[{text:this.ribbon.items[0].header.text},{text:this.ribbon.items[1].header.text},{text:this.ribbon.items[2].header.text},{text:this.ribbon.items[3].header.text}],createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(a){a.item.text!==n.content&&(s.element.style.display="none",n.content=a.item.text,n.dataBind(),s.items=t.ribbon.items[n.items.indexOf(a.item)+1].content,s.width="calc(100% - "+r.getBoundingClientRect().width+"px)",s.element.style.display="",s.dataBind(),s.items[0].text=a.item.text,s.dataBind())},open:function(a){var l=a.element.parentElement,h=l.getBoundingClientRect(),c=Ar(n.element,"right","bottom");l.style.left=c.left-h.width+"px",l.style.top=c.top-h.height+"px";for(var u=0;u<n.items.length;u++)if(n.content===n.items[u].text){a.element.children[u].classList.add("e-selected");break}},close:function(){return Re(t.parent.element)}});n.createElement=this.parent.createElement,n.appendTo(r);var s=new yc({width:"calc(100% - "+r.getBoundingClientRect().width+"px)",items:this.ribbon.items[0].content,clicked:this.toolbarClicked.bind(this)});s.createElement=this.parent.createElement,s.appendTo(i),e.style.display=""},o.prototype.fileMenuBeforeOpen=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r,n=[".xlsx",".xls",".csv",".pdf"];t.parentItem.text===i.getConstant("SaveAs")&&[].slice.call(t.element.children).forEach(function(s,a){r=e.parent.createElement("div",{innerHTML:s.innerHTML}),s.innerHTML="";var l=e.parent.createElement("span",{className:"e-extension"});l.innerText=n[a],r.appendChild(l),s.appendChild(r)}),this.parent.trigger("fileMenuBeforeOpen",t),t.element.setAttribute("aria-label",i.getConstant("File"))},o.prototype.enableRibbonTabs=function(t){this.ribbon.enableTabs(t.tabs,t.enable)},o.prototype.fileMenuBeforeClose=function(t){var e=this;this.parent.trigger("fileMenuBeforeClose",t),t.parentItem&&t.event&&t.event.keyCode===37&&t.parentItem.id===this.parent.element.id+"_File"&&er(function(){var i=e.ribbon.element.querySelector(".e-tab-header .e-toolbar-item .e-tab-wrap");if(i){Re(i);var r=i.querySelector(".e-menu-item.e-focused");r&&r.classList.remove("e-focused")}})},o.prototype.hideFileMenuItems=function(t){this.ribbon.hideMenuItems(t.items,t.hide,t.isUniqueId)},o.prototype.addFileMenuItems=function(t){this.ribbon.addMenuItems(t.items,t.text,t.insertAfter,t.isUniqueId)},o.prototype.hideToolbarItems=function(t){this.ribbon.hideToolbarItems(t.tab,t.indexes,t.hide)},o.prototype.protectSheetHandler=function(t){var e=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(ve);e.isProtected&&e.protectSettings.formatCells||!e.isProtected?(this.parent.allowCellFormatting?(this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId,enable:!0}]),e.isProtected&&e.protectSettings.formatCells&&(this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(15,16),enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!1}]))):this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(3,14),enable:!1}]),this.parent.allowWrap||this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(14,15),enable:!1}]),this.parent.allowNumberFormatting||this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(2,3),enable:!1}]),this.parent.notify(bD,null)):this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.disableHomeBtnId,enable:!1}]),e.isProtected&&e.protectSettings.insertLink||!e.isProtected?!this.parent.allowHyperlink||e.isProtected&&e.protectSettings.insertLink?this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId.slice(0,1),enable:!1}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.findBtnId,enable:!e.isProtected||e.protectSettings.selectCells||e.protectSettings.selectUnLockedCells}]);var r=this.ribbon.items[this.ribbon.selectedTab].content.length,n;for(n=0;n<r&&this.ribbon.items[this.ribbon.selectedTab].content[n].id!==this.parent.element.id+"_protectworkbook";n++);e.isProtected?(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.imageBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:t.dataValidationBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:t.enableFrmlaBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.chartBtnId,enable:!1}])):(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnprotectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnprotectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.imageBtnId,enable:this.parent.allowImage}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:t.dataValidationBtnId,enable:this.parent.allowDataValidation}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:t.enableFrmlaBtnId,enable:!0}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.chartBtnId,enable:this.parent.allowChart}]))},o.prototype.updateMergeItem=function(t){if(this.parent.allowMerge&&(yd(t)||t.type==="touchmove"||t.shiftKey&&(t.type==="mousedown"||t.type==="touchend"))){var e=this.parent.getActiveSheet();if(!e.isProtected){var i=ie(e.selectedRange);if(i[1]===i[3]&&i[0]===i[2])this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(ve).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!1}]),this.toggleActiveState(!1);else{this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(ve).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:this.parent.allowMerge}]),i=tt(i);var r=Q(i[0],i[1],e,!1,!0);r.rowSpan>1||r.colSpan>1?this.toggleActiveState((!(r.rowSpan>1)||i[0]+r.rowSpan-1===i[2])&&(!(r.colSpan>1)||i[1]+r.colSpan-1===i[3])):this.toggleActiveState(!1)}}}},o.prototype.onPropertyChanged=function(t){var e=this.parent.serviceLocator.getService(ve),i=this.parent.element.id,r=this.parent.getActiveSheet();switch(t){case"allowFreezePane":this.ribbon.enableItems(e.getConstant("View"),[i+"_freezepanes",i+"_freezerows",i+"_freezecolumns"],this.parent.allowFreezePane);break;case"showRibbon":this.parent.showRibbon?this.initialize(!0):this.ribbon&&this.destroy();break;case"allowImage":this.ribbon.enableItems(e.getConstant("Insert"),[i+"_image"],this.parent.allowImage);break;case"allowChart":this.ribbon.enableItems(e.getConstant("Insert"),[i+"_chart"],this.parent.allowChart),this.parent.allowChart||this.removeDesignChart();break;case"allowWrap":case"allowCellFormatting":case"allowMerge":if(this.refreshToggleBtn(xe(r.activeCell)),!r.isProtected||r.protectSettings.formatCells)if(t==="allowWrap")this.ribbon.enableItems(e.getConstant("Home"),[i+"_wrap"],this.parent.allowWrap);else if(t==="allowCellFormatting"){var n=[i+"_font_name",i+"_font_size",i+"_bold",i+"_italic",i+"_line-through",i+"_underline",i+"_font_color_picker",i+"_fill_color_picker",i+"_borders",i+"_text_align",i+"_vertical_align"];this.enableToolbarItems([{tab:e.getConstant("Home"),items:n,enable:this.parent.allowCellFormatting}])}else if(this.parent.allowMerge){var s=xe(r.activeCell),a=Q(s[0],s[1],r,!1,!0);this.updateMergeBtnState(r,e,a)}else this.enableToolbarItems([{tab:e.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!1}]);break;case"allowNumberFormatting":(!r.isProtected||r.protectSettings.formatCells)&&this.ribbon.enableItems(e.getConstant("Home"),[i+"_number_format"],this.parent.allowNumberFormatting);break;case"calculationMode":this.parent.notify(Ea,[{tab:e.getConstant("Formulas"),items:[this.parent.element.id+"_calc_current_sheet",this.parent.element.id+"_calc_entire_sheets"],enable:this.parent.calculationMode==="Manual"}]),this.calcTypeOptions&&(this.calcTypeOptions.items[0].iconCss=this.parent.calculationMode==="Automatic"?"e-icons e-selected-icon":"",this.calcTypeOptions.items[1].iconCss=this.parent.calculationMode==="Manual"?"e-icons e-selected-icon":""),this.parent.calculationMode==="Automatic"&&this.parent.calculateNow("Workbook");break}},o.prototype.openHandler=function(t,e){if(j.isDevice&&e){var i=t.parentElement,r=i.getBoundingClientRect(),n=r.bottom,s=window.innerHeight;if(n>s){var a=r.height-(n-s);a>70&&(e.style.height=a+"px",e.style.overflowY="auto")}}Re(e)},o.prototype.addEventListener=function(){this.parent.on(Fl,this.ribbonOperation,this),this.parent.on(Ea,this.enableToolbarItems,this),this.parent.on(vo,this.refreshRibbonContent,this),this.parent.on(Bc,this.toggleRibbonItems,this),this.parent.on(JM,this.enableFileMenuItems,this),this.parent.on(iD,this.hideRibbonTabs,this),this.parent.on(nD,this.addRibbonTabs,this),this.parent.on(sD,this.addToolbarItems,this),this.parent.on(eD,this.hideFileMenuItems,this),this.parent.on(tD,this.addFileMenuItems,this),this.parent.on(aD,this.hideToolbarItems,this),this.parent.on(rD,this.enableRibbonTabs,this),this.parent.on(vD,this.protectSheetHandler,this),this.parent.on(Ta,this.updateMergeItem,this),this.parent.on(Hs,this.refreshRibbonContent,this),this.parent.on(ep,this.insertDesignChart,this),this.parent.on(Go,this.removeDesignChart,this),this.parent.on(oz,this.unMerge,this)},o.prototype.destroy=function(){var t=this.parent.element,e=this.ribbon?this.ribbon.element:null,i=this.cPickerEle,r=t.id,n=this.parent.serviceLocator.getService(ve),s=ot(t.querySelector(".e-tab"),"tab"),a;s&&(a=s.selectedItem),this.switchRibbonTab(n.getConstant("Home")),["bold","italic","line-through","underline","cut","copy","undo","redo","wrap"].forEach(function(h){M9(J("#"+(r+"_"+h),t),Jn)}),this.pasteSplitBtn&&this.pasteSplitBtn.destroy(),this.pasteSplitBtn=null,this.mergeSplitBtn&&this.mergeSplitBtn.destroy(),this.mergeSplitBtn=null,this.numFormatDDB&&this.numFormatDDB.destroy(),this.numFormatDDB=null,this.fontSizeDdb&&this.fontSizeDdb.destroy(),this.fontSizeDdb=null,this.fontNameDdb&&this.fontNameDdb.destroy(),this.fontNameDdb=null,this.textAlignDdb&&this.textAlignDdb.destroy(),this.textAlignDdb=null,this.verticalAlignDdb&&this.verticalAlignDdb.destroy(),this.verticalAlignDdb=null,this.sortingDdb&&this.sortingDdb.destroy(),this.sortingDdb=null,this.clearDdb&&this.clearDdb.destroy(),this.clearDdb=null,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=null,this.destroyComponent(r+"_borders_menu","menu"),this.bordersDdb&&this.bordersDdb.destroy(),this.bordersDdb=null,this.findDdb&&this.findDdb.destroy(),this.findDdb=null,this.destroyComponent(r+"_chart_menu","menu"),this.destroyComponent(r+"_chart_type_menu","menu"),this.destroyComponent(r+"_chart-btn","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.destroyComponent(r+"_cf_menu","menu"),this.cfDdb&&(this.cfDdb.destroy(),this.cfDdb.element&&this.cfDdb.element.remove()),this.cfDdb=null,this.detachPopupElement(r),this.parent.notify("destroyRibbonComponents",null),a&&(s.selectedItem=a,s.dataBind()),this.addChartDdb&&(this.addChartDdb.destroy(),this.addChartDdb=null),this.destroyComponent(r+"_chart_theme","menu"),this.destroyComponent(r+"_chart_theme","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","menu"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.datavalidationDdb&&this.datavalidationDdb.destroy(),this.datavalidationDdb=null,i&&se(i);var l=this.parent.serviceLocator.getService(jt);l.dialogInstance&&l.dialogInstance.element.classList.contains("e-custom-format-dlg")&&l.hide(!0),this.cPickerEle=null,this.border&&(this.border=""),this.fontNameIndex&&(this.fontNameIndex=null),this.preTabIdx&&(this.preTabIdx=null),this.numPopupWidth&&(this.numPopupWidth=null),this.ribbon&&this.ribbon.destroy(),e&&se(e),this.ribbon=null,this.removeEventListener(),this.parent=null},o.prototype.destroyComponent=function(t,e){var i=typeof t=="string"?document.getElementById(t):t;if(i){if(e!=="menu"||i.childElementCount){var r=ot(i,e);if(r&&(r.destroy(),e==="dropdown-btn")){var n=document.getElementById(i.id+"-popup");n&&se(n)}}e==="menu"&&se(i)}},o.prototype.detachPopupElement=function(t){["_conditionalformatting","_chart-type-btn","_chart-btn","_borders"].forEach(function(e){var i=document.getElementById(""+t+e+"-popup");i&&se(i)})},o.prototype.switchRibbonTab=function(t){for(var e,i=this.parent.element.querySelectorAll(".e-tab-text"),r=0;r<i.length;r++){var n=i[r];if(n.textContent.toLowerCase()===t.toLowerCase()){var s=n.closest(".e-toolbar-item");if(s){e=s.getAttribute("data-id");break}}}var a=ot(this.parent.element.querySelector(".e-tab"),"tab");a&&!g(e)&&(a.selectedItem=a.getItemIndex(e),a.dataBind())},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Fl,this.ribbonOperation),this.parent.off(Ea,this.enableToolbarItems),this.parent.off(vo,this.refreshRibbonContent),this.parent.off(Bc,this.toggleRibbonItems),this.parent.off(JM,this.enableFileMenuItems),this.parent.off(iD,this.hideRibbonTabs),this.parent.off(nD,this.addRibbonTabs),this.parent.off(sD,this.addToolbarItems),this.parent.off(eD,this.hideFileMenuItems),this.parent.off(tD,this.addFileMenuItems),this.parent.off(aD,this.hideToolbarItems),this.parent.off(rD,this.enableRibbonTabs),this.parent.off(vD,this.protectSheetHandler),this.parent.off(Ta,this.updateMergeItem),this.parent.off(Hs,this.refreshRibbonContent),this.parent.off(ep,this.insertDesignChart),this.parent.off(Go,this.removeDesignChart),this.parent.off(oz,this.unMerge))},o})(),cE=(function(){function o(t){this.categoryCollection=[],this.formulaCollection=[],this.isGoto=!1,this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"formulaBar"},o.prototype.createFormulaBar=function(t){var e=this;if(!this.parent.showFormulaBar&&this.insertFnRipple){this.destroy();return}var i=this.parent.serviceLocator.getService(ve),r=this.parent.element.id,n=this.parent.enableRtl,s=this.parent.createElement("div",{className:"e-formula-bar-panel"});if(!this.parent.isMobileView()){var a=this.parent.createElement("input",{id:r+"_name_box",attrs:{type:"text"}});s.appendChild(a),this.comboBoxInstance=new Fy({value:"A1",cssClass:"e-name-box",enableRtl:n,width:"",noRecordsTemplate:fa(function(){return""}),fields:{text:"name",value:"refersTo"},beforeOpen:this.nameBoxBeforeOpen.bind(this),blur:this.nameBoxBlur.bind(this),select:this.nameBoxSelect.bind(this),open:function(){e.isDevice&&(window.browserDetails.isDevice=!0)},change:function(){}}),this.comboBoxInstance.createElement=this.parent.createElement,this.comboBoxInstance.appendTo(a),this.comboBoxInstance.element.parentElement.title=i.getConstant("NameBox")}var l=s.appendChild(this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-insert-function",attrs:{title:i.getConstant("InsertFunction"),type:"button"}}));l.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons"})),this.insertFnRipple=Wi(s,{selector:".e-insert-function"}),s.appendChild(this.parent.createElement("div",{className:"e-separator"}));var h=i.getConstant("FormulaBar"),c=s.appendChild(this.parent.createElement("textarea",{className:"e-formula-bar e-css",id:r+"_formula_input",attrs:{title:h,"aria-label":h,spellcheck:"false"}}));if(c.rows=1,this.parent.isMobileView())c.placeholder=i.getConstant("MobileFormulaBarPlaceHolder"),T.add(c,"focus",this.textAreaFocusIn,this),T.add(c,"blur",this.textAreaFocusOut,this);else{var u=i.getConstant("ExpandFormulaBar");s.appendChild(this.parent.createElement("span",{className:"e-drop-icon e-icons",attrs:{title:u,role:"button",tabindex:"-1","aria-label":u}}))}t&&t.uiUpdate?this.parent.element.insertBefore(s,document.getElementById(r+"_sheet_panel")):this.parent.element.appendChild(s)},o.prototype.textAreaFocusIn=function(){var t=this.parent.element.querySelector(".e-formula-bar-panel"),e=this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-formula-submit",attrs:{type:"button"}});e.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-tick-icon"})),t.classList.add("e-focused"),t.appendChild(e)},o.prototype.textAreaFocusOut=function(){var t=this.parent.element.querySelector(".e-formula-bar-panel");t.classList.remove("e-focused"),se(t.querySelector(".e-formula-submit"))},o.prototype.keyDownHandler=function(t){var e=t.target;if(this.parent.isEdit&&(!this.parent.getActiveSheet().isProtected||e.classList.contains("e-formula-bar")&&!e.disabled)){if((pt(e.value)||e.validity&&e.value.toString().indexOf("=")===0)&&(t.keyCode===16||t.keyCode===17))return;e.classList.contains("e-formula-bar")&&(!t.shiftKey||t.shiftKey&&!Yc(t.keyCode))&&this.parent.notify(ui,{action:"refreshEditor",value:e.value,refreshEditorElem:!0})}},o.prototype.keyUpHandler=function(t){if(this.parent.isEdit){var e=t.target;if(e.classList.contains("e-formula-bar")){if(t.altKey&&t.keyCode===13){var i=e.value,r=e.selectionStart,n=i.slice(0,r),s=i.slice(e.selectionEnd);e.value=n+`
`;var a=Math.max(0,e.scrollHeight-e.clientHeight);e.value+=s;var l=n.length+1;e.setSelectionRange(l,l),er(function(){var c=document.activeElement;c.classList.contains("e-formula-bar")&&(c.scrollTop=a)})}var h={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,h),h.editedValue!==e.value&&t.keyCode!==16&&t.keyCode!==17&&(!t.shiftKey||t.shiftKey&&!Yc(t.keyCode))&&this.parent.notify(ui,{action:"refreshEditor",value:e.value,refreshEditorElem:!0})}}},o.prototype.nameBoxBeforeOpen=function(t){this.comboBoxInstance.element.classList.contains("e-name-editing")?t.cancel=!0:(this.comboBoxInstance.element.select(),this.isDevice=window.browserDetails.isDevice,this.isDevice&&(window.browserDetails.isDevice=!1))},o.prototype.nameBoxBlur=function(){this.comboBoxInstance.element.classList.contains("e-name-editing")&&(this.comboBoxInstance.element.classList.remove("e-name-editing"),this.updateValueAfterMouseUp())},o.prototype.nameBoxSelect=function(t){if(t.isInteracted&&(!t.e||t.e.type!=="keydown"||t.e.keyCode!==40&&t.e.keyCode!==38)){var e=t.itemData.refersTo.substr(1),i=Ct(this.parent,na(e));if(i===void 0)return;var r=Gc(e),n=ke(this.parent,i),s=void 0,a=void 0;if(r.indexOf(":")===-1)s=a=r.replace("$","");else{var l=r.indexOf(":");s=r.substr(0,l).replace("$",""),a=r.substr(l+1,r.length).replace("$","")}a.match(/\D/g)&&!a.match(/[0-9]/g)&&s.match(/\D/g)&&!s.match(/[0-9]/g)?(s=s+"1",a=a+n.rowCount,r=s+":"+a):!a.match(/\D/g)&&a.match(/[0-9]/g)&&!s.match(/\D/g)&&s.match(/[0-9]/g)&&(s=st(parseInt(s,10)-1,0),a=st(parseInt(a,10)-1,n.colCount-1),r=s+":"+a),i===this.parent.activeSheetIndex?(this.parent.isEdit||this.parent.selectRange(r),this.parent.notify(Rl,{range:r,isSelect:!1,isMouseDown:!1,isNameBoxSelect:!0}),Re(this.parent.element)):(lg(this.parent,r,n),this.parent.activeSheetIndex=i,this.parent.notify(Rl,{range:r,isSelect:!1,isMouseDown:!1,isNameBoxSelect:!0}),Re(this.parent.element))}},o.prototype.formulaBarUpdateHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r=i.selectedRange.split(":"),n,s={action:"getElement",element:null};this.parent.notify(ui,s);var a=this.parent.element.querySelector(".e-formula-bar");if(t.type==="mousemove"||t.type==="pointermove"){var l=ie(r[0]),h=ie(r[1]);n=Math.abs(l[0]-h[0])+1+"R x "+(Math.abs(l[1]-h[1])+1)+"C",this.parent.isEdit&&(t.target&&!t.target.classList.contains("e-spreadsheet-edit")?this.parent.notify(T0,{}):s.element&&(a.value=s.element.textContent))}else{n=r[0];var c=Gn(this.parent)+"!"+n;Aa(this.parent,c,!1,!0).then(function(u){e.parent&&u.forEach(function(d){var p=e.getFormulaBarValue(d),f={action:"getCurrentEditValue",editedValue:""};e.parent.notify(ui,f);var v=document.getElementById(e.parent.element.id+"_formula_input"),m=v.value;v.value=p,(!f.editedValue||!pt(f.editedValue.toString(),!0))&&e.parent.notify(ui,{action:"refreshEditor",value:p,refreshEditorElem:!0}),e.parent.isEdit&&(t.target&&!t.target.classList.contains("e-spreadsheet-edit")?e.parent.notify(T0,{isMouseDown:Eb(t),formulaBarVal:m}):s.element&&(a.value=s.element.textContent))})})}this.updateComboBoxValue(n)},o.prototype.getFormulaBarValue=function(t){var e="";if(t)if(t.formula)e=t.formula;else if(!g(t.value)&&t.value!==""){var i={},r=t.format&&Bs(t.format,!0,i,!0)&&i.type;if(r==="date"||r==="time"||r==="datetime"){var n=Yn(Number(t.value));if(n&&n.toString()!=="Invalid Date"&&n.getFullYear()>=1900){var s=new Nt,a=cr("Time");a==="h:mm:ss AM/PM"&&(a="h:mm:ss a");var l=t.format.toLowerCase();r==="time"&&l.includes("m")&&!l.includes(":m")&&!l.includes("m:")&&!l.includes("[m")&&!l.includes("am")&&(r="date");var h=t.value.toString().split("."),c=h.length===2,u=c?Yn(parseFloat(h[0]+1+"."+h[1])||Number(t.value)):n;if(r==="date"){var d={type:"date"};d.skeleton="yMd",e=s.formatDate(n,d),c&&(e+=" "+s.formatDate(u,{type:"time",skeleton:"medium",format:a}))}else(Number(t.value)>=1||r==="datetime")&&(e=s.formatDate(n,{type:"date",skeleton:"yMd"})+" "),e+=s.formatDate(u,{type:"time",skeleton:"medium",format:a})}}else t.format&&t.format.includes("%")&&De(t.value)&&(e=this.parent.getDisplayText(t),e.includes("%")||(e=""));if(!e){if(e=t.value.toString(),e.toLowerCase()==="true"||e.toLowerCase()==="false")e=e.toUpperCase();else if(this.parent.locale!=="en-US"){var p=Ki(this.parent.locale).decimal;p!=="."&&De(e)&&e.includes(".")&&(e=e.replace(".",p))}}}else t.hyperlink&&(e=typeof t.hyperlink=="string"?t.hyperlink:t.hyperlink.address||"");return e},o.prototype.updateValueAfterMouseUp=function(){this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(":")[0])},o.prototype.updateComboBoxValue=function(t){var e=this.parent.getActiveSheet(),i=Gn(this.parent)+"!"+e.selectedRange,r={action:"getNameFromRange",range:i,definedName:null};if(this.parent.notify(Ol,r),r.definedName&&(t=r.definedName.name),!this.parent.isMobileView()){if(this.comboBoxInstance.text===t)return;this.comboBoxInstance.text=t,this.comboBoxInstance.dataBind()}},o.prototype.disabletextarea=function(){var t=this.getFormulaBar();this.parent.getActiveSheet().isProtected&&!this.parent.isEdit?t.disabled=!0:t.disabled=!1},o.prototype.updateNameBoxValue=function(t,e){var i=this.parent.element.id,r=ot(this.parent.element.querySelector("#"+i+"_name_box"),"combobox"),n=this.parent.getActiveSheet();if(e)r.text===t.name&&(r.value=n.activeCell,r.dataBind());else{var s=t.refersTo.split("!");if(s.length===2&&t.refersTo.startsWith("=")){var a=s[0].split("=")[1].replace(/'/g,""),l=t.refersTo.split("!")[1];a===n.name&&l===n.selectedRange&&(r.value=t.name,r.dataBind())}}},o.prototype.formulaBarScrollEdit=function(){var t=ie(this.parent.getActiveSheet().selectedRange),e=xe(this.parent.getActiveSheet().topLeftCell);t[0]<e[0]&&(this.parent.goTo(this.parent.getActiveSheet().selectedRange),this.isGoto=!0),this.parent.notify(ui,{action:"startEdit",refreshCurPos:!1})},o.prototype.formulaBarClickHandler=function(t){var e=t.target,i=this.parent.getActiveSheet(),r=i.isProtected,n=xe(i.activeCell),s=Q(n[0],n[1],i),a=mn(s,Ht(i,n[1]));if(e.classList.contains("e-drop-icon")&&e.parentElement.classList.contains("e-formula-bar-panel"))this.toggleFormulaBar(e);else if(e.classList.contains("e-formula-bar")||document.activeElement.classList.contains("e-formula-bar")){if(Pl(s,Ht(i,n[1]),Yr(i,n[0]))){this.parent.notify(fr,null);return}!this.parent.isEdit&&(!r||r&&!a)||this.parent.isEdit&&r&&!e.disabled?this.formulaBarScrollEdit():r&&a&&this.parent.notify(Ra,null)}else if(e.parentElement&&e.parentElement.classList.contains("e-name-box"))if(e.classList.contains("e-ddl-icon")){var l={action:"getNames",names:[]};if(this.parent.notify(Ol,l),this.comboBoxInstance.dataSource.length!==l.names.length||this.comboBoxInstance.value===this.comboBoxInstance.text){var h=this.comboBoxInstance.text;this.comboBoxInstance.dataSource=l.names;var c=l.names.find(function(u){return u.name===h});this.comboBoxInstance.value=c?c.refersTo:this.comboBoxInstance.value,this.comboBoxInstance.dataBind()}}else this.comboBoxInstance.element.classList.add("e-name-editing"),this.comboBoxInstance.element.select();!g(e.offsetParent)&&(e.offsetParent.classList.contains("e-insert-function")||e.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===e.offsetParent.id||this.parent.element.id+"_insert_function"===e.id||e.parentElement.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===e.parentElement.id)&&this.renderInsertDlg()},o.prototype.renderInsertDlg=function(){var t=this,e=this.parent.getActiveSheet(),i=xe(e.activeCell);if(e.isProtected&&mn(Q(i[0],i[1],e),Ht(e,i[1]))&&!this.parent.isEdit){this.parent.notify(Ra,null);return}var r=Q(i[0],i[1],e);if(Pl(r,Ht(e,i[1]),Yr(e,i[0]))){this.parent.notify(fr,null);return}var n=this.parent.serviceLocator.getService(ve),s=!this.parent.isEdit,a={action:"getCurrentEditValue",editedValue:""};if(!s){var l={action:"isFormulaEditing",isFormulaEdit:!1};this.parent.notify(Ol,l),s=l.isFormulaEdit,this.parent.notify(ui,a)}if(a.editedValue===""&&!this.parent.element.querySelector(".e-spreadsheet-function-dlg")){a.editedValue===""&&this.parent.notify(ui,{action:"refreshEditor",value:"="});var h=this.parent.createElement("div",{className:"e-formula-description",id:this.parent.element.id+"_description_content"}),c=this.parent.createElement("div",{className:"e-category-content",id:this.parent.element.id+"_category_content"});c.innerText=n.getConstant("PickACategory");var u=this.parent.createElement("input",{className:"e-formula-category",id:this.parent.element.id+"_formula_category"}),d=this.parent.createElement("div",{className:"e-formula-list",id:this.parent.element.id+"_formula_list"}),p=this.parent.createElement("div",{className:"e-description-content"});p.innerText=n.getConstant("Description");var f=this.parent.createElement("div",{className:"e-header-content"});f.innerText=n.getConstant("InsertFunction");var v={action:"getFormulaCategory",categoryCollection:[]};this.parent.notify(At,v),this.categoryCollection=v.categoryCollection.map(function(S){return g(S)?S:n.getConstant(S.split(" ").join("").replace("&",""))});var m;this.categoryList=new $s({dataSource:this.categoryCollection,cssClass:"e-ss-formula-category",index:0,width:"285px",popupHeight:"210px",enableRtl:this.parent.enableRtl,select:this.dropDownSelect.bind(this),open:function(){return m=!0},close:function(){return m=!1}});var y={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(At,y),this.formulaCollection=y.formulaCollection,this.formulaList=new hf({dataSource:this.formulaCollection.sort(),enableRtl:this.parent.enableRtl,actionComplete:this.updateFormulaList.bind(this),select:this.listSelected.bind(this),width:"285px",height:"200px"});var b;this.dialog=this.parent.serviceLocator.getService(jt),this.dialog.show({header:f.outerHTML,content:c.outerHTML+u.outerHTML+d.outerHTML+p.outerHTML+h.outerHTML,width:"320px",height:"485px",cssClass:"e-spreadsheet-function-dlg",showCloseIcon:!0,isModal:!0,enableRtl:this.parent.enableRtl,beforeOpen:function(S){var C={dialogName:"InsertFunctionDialog",element:S.element,target:S.target,cancel:S.cancel};t.parent.trigger("dialogBeforeOpen",C),C.cancel?(t.dialog.dialogInstance.setProperties({beforeClose:void 0},!0),b=S.cancel=!0):Re(t.parent.element)},open:this.dialogOpen.bind(this),beforeClose:this.dialogBeforeClose.bind(this),close:this.dialogClose.bind(this),buttons:[{click:function(S){S&&S.keyCode===13&&!m||t.selectFormula()},buttonModel:{content:n.getConstant("Ok"),isPrimary:!0}}]}),b?this.categoryList=this.formulaList=null:(this.categoryList.appendTo("#"+this.parent.element.id+"_formula_category"),this.formulaList.appendTo("#"+this.parent.element.id+"_formula_list"),T.add(this.formulaList.element,"dblclick",this.formulaClickHandler,this))}},o.prototype.toggleFormulaBar=function(t){var e=t.parentElement,i=this.parent.serviceLocator.getService(ve);e.classList.contains("e-expanded")?(e.classList.remove("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=1,t.title=i.getConstant("ExpandFormulaBar"),t.setAttribute("aria-label",i.getConstant("CollapseFormulaBar"))):(e.classList.add("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=3,t.title=i.getConstant("CollapseFormulaBar"),t.setAttribute("aria-label",i.getConstant("ExpandFormulaBar"))),this.parent.setPanelSize()},o.prototype.dialogOpen=function(){var t=this;er(function(){var e=t.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary"),i=t.parent.serviceLocator.getService(ve);e.setAttribute("aria-label",i.getConstant("InsertFunction")+" "+i.getConstant("Ok")),t.categoryList&&Re(t.categoryList.element)})},o.prototype.dialogClose=function(){var t={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,t),t.editedValue.toString().trim()==="="&&this.parent.notify(ui,{action:"refreshEditor",value:""})},o.prototype.dialogBeforeClose=function(){T.remove(this.formulaList.element,"dblclick",this.formulaClickHandler);var t=document.getElementsByClassName("e-spreadsheet-function-dlg")[0].querySelector(".e-dlg-content");t.parentNode.removeChild(t),this.categoryList.destroy(),this.categoryList=null,this.formulaList.destroy(),this.formulaList=null},o.prototype.selectFormula=function(){var t=this.formulaList.getSelectedItems().text,e=ke(this.parent,this.parent.activeSheetIndex);this.parent.isEdit?this.parent.notify(ui,{action:"refreshEditor",value:t+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(ui,{action:"startEdit",value:"="+t+"(",address:e.activeCell}),this.parent.notify(ho,{action:"refreshFormulabar",value:"="+t+"("})),this.dialog.dialogInstance.storeActiveElement=document.getElementById(this.parent.element.id+"_edit"),this.dialog.hide()},o.prototype.listSelected=function(t){this.updateFormulaDescription(),t.isInteracted&&t.item&&t.item.focus()},o.prototype.updateFormulaList=function(){this.activeListFormula(),this.updateFormulaDescription()},o.prototype.dropDownSelect=function(t){this.formulaCollection=[];var e=this.parent.serviceLocator.getService(ve),i={action:"getLibraryFormulas",formulaCollection:[]};if(t.item.textContent===e.getConstant("All"))this.parent.notify(At,i),this.formulaCollection=i.formulaCollection;else{var r=t.item.textContent,n={action:"dropDownSelectFormulas",formulaCollection:[],selectCategory:r};this.parent.notify(At,n),this.formulaCollection=n.formulaCollection}this.formulaList.dataSource=this.formulaCollection.sort()},o.prototype.activeListFormula=function(){var t=document.getElementById(this.parent.element.id+"_formula_list"),e=t.children[0].children[0].firstElementChild;this.formulaList.selectItem(e)},o.prototype.updateFormulaDescription=function(){var t=this.formulaList.getSelectedItems().text,e={action:"getFormulaDescription",description:"",selectedList:t,isCustom:!1};this.parent.notify(At,e);var i=this.dialog.dialogInstance.element.querySelector(".e-footer-content .e-primary");i.hasAttribute("aria-label")&&i.removeAttribute("aria-label");var r=document.getElementById(this.parent.element.id+"_description_content");t=t==="AND"?"CalculateAND":t==="OR"?"CalculateOR":t,r.textContent=e.isCustom?e.description:this.parent.serviceLocator.getService(ve).getConstant(t)},o.prototype.formulaClickHandler=function(t){var e=t.target,i=ke(this.parent,this.parent.activeSheetIndex);(e.offsetParent.classList.contains("e-text-content")||e.classList.contains("e-list-item"))&&(this.parent.isEdit?this.parent.notify(ui,{action:"refreshEditor",value:e.innerText+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(ui,{action:"startEdit",value:"="+e.innerText+"(",address:i.activeCell}),this.parent.notify(ho,{action:"refreshFormulabar",value:"="+e.innerText+"("})),this.dialog.hide())},o.prototype.addEventListener=function(){this.parent.on(Tg,this.createFormulaBar,this),this.parent.on(Jc,this.formulaBarClickHandler,this),this.parent.on(mo,this.keyDownHandler,this),this.parent.on(BD,this.renderInsertDlg,this),this.parent.on(Ds,this.keyUpHandler,this),this.parent.on(Ta,this.formulaBarUpdateHandler,this),this.parent.on(qM,this.updateValueAfterMouseUp,this),this.parent.on(ho,this.editOperationHandler,this),this.parent.on(SD,this.disabletextarea,this),this.parent.on(Kd,this.isFormulaBarEdit,this)},o.prototype.destroy=function(){this.removeEventListener(),this.comboBoxInstance&&this.comboBoxInstance.destroy(),this.comboBoxInstance=null,this.categoryCollection=null,this.formulaCollection=null,this.dialog=null,this.isGoto=null,this.insertFnRipple&&this.insertFnRipple(),this.insertFnRipple=null;var t=this.parent.element.querySelector(".e-formula-bar-panel");t&&(lo(t),se(t)),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Tg,this.createFormulaBar),this.parent.off(Jc,this.formulaBarClickHandler),this.parent.off(BD,this.renderInsertDlg),this.parent.off(mo,this.keyDownHandler),this.parent.off(Ds,this.keyUpHandler),this.parent.off(Ta,this.formulaBarUpdateHandler),this.parent.off(qM,this.updateValueAfterMouseUp),this.parent.off(ho,this.editOperationHandler),this.parent.off(SD,this.disabletextarea),this.parent.off(Kd,this.isFormulaBarEdit))},o.prototype.editOperationHandler=function(t){switch(t.action){case"refreshFormulabar":t.cell?this.getFormulaBar().value=this.getFormulaBarValue(t.cell):this.getFormulaBar().value=Te(t.value)?"":t.value;break;case"setNameBoxValue":this.updateNameBoxValue(t.definedName,t.isRemove);break;case"getElement":t.element=this.getFormulaBar();break}},o.prototype.isFormulaBarEdit=function(t){var e=this.parent.isEdit;e&&this.isGoto?t.isEdit=!0:t.isEdit=!1},o.prototype.getFormulaBar=function(){return J("#"+this.parent.element.id+"_formula_input",this.parent.element)},o})(),uE=(function(){function o(t){this.isFormulaBar=!1,this.isFormula=!1,this.isPopupOpened=!1,this.isPreventClose=!1,this.isSubFormula=!1,this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"formula"},o.prototype.destroy=function(){this.removeEventListener(),this.autocompleteInstance&&(this.autocompleteInstance.destroy(),this.autocompleteInstance.element&&(this.autocompleteInstance.element.remove(),this.autocompleteInstance.element=null)),this.autocompleteInstance=null,this.acInputElement&&(this.acInputElement.remove(),this.acInputElement=null),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(Ol,this.performFormulaOperation,this),this.parent.on(Ds,this.keyUpHandler,this),this.parent.on(mo,this.keyDownHandler,this),this.parent.on(Jc,this.formulaClick,this),this.parent.on(fD,this.refreshFormulaDatasource,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ol,this.performFormulaOperation),this.parent.off(Ds,this.keyUpHandler),this.parent.off(mo,this.keyDownHandler),this.parent.off(Jc,this.formulaClick),this.parent.off(fD,this.refreshFormulaDatasource))},o.prototype.performFormulaOperation=function(t){var e=this,i=t.action,r=this.parent.serviceLocator.getService(ve);switch(i){case"renderAutoComplete":this.renderAutoComplete();break;case"endEdit":this.endEdit();break;case"addDefinedName":t.isAdded=this.addDefinedName(t.definedName);break;case"getNames":t.sheetName||(t.sheetName=Gn(this.parent)),t.names=this.getNames(t.sheetName);break;case"getNameFromRange":t.definedName=this.getNameFromRange(t.range);break;case"isFormulaEditing":t.isFormulaEdit=this.isFormula;break;case"isCircularReference":{var n=this.parent.serviceLocator.getService(jt),s=r.getConstant("CircularReference"),a=function(c){e.parent.trigger("dialogBeforeOpen",c),c.content!==s&&(n.dialogInstance.content=c.content,n.dialogInstance.dataBind())},l=n.dialogInstance;if(l&&l.visible&&l.element.classList.contains("e-circularref-dlg"))a({dialogName:"CircularReferenceDialog",element:l.element,target:this.parent.element,cancel:!1,cellAddress:t.address,content:s});else{var h=t.address;n.show({height:180,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-circularref-dlg",content:s,beforeOpen:function(c){var u={dialogName:"CircularReferenceDialog",element:c.element,target:c.target,cancel:c.cancel,cellAddress:h,content:s};a(u),c.cancel=u.cancel}})}t.argValue="0";break}}},o.prototype.renderAutoComplete=function(){if(!J("#"+this.parent.element.id+"_ac",this.parent.element)){var t=this.parent.createElement("input",{id:this.parent.element.id+"_ac",className:"e-ss-ac"});this.parent.element.appendChild(t);var e={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(At,e);var i={dataSource:e.formulaCollection,cssClass:"e-ss-atc",popupWidth:"130px",allowFiltering:!0,debounceDelay:0,filterType:"StartsWith",sortOrder:"Ascending",open:this.onSuggestionOpen.bind(this),close:this.onSuggestionClose.bind(this),select:this.onSelect.bind(this),actionComplete:this.onSuggestionComplete.bind(this)};this.autocompleteInstance=new Ry(i,t),this.autocompleteInstance.createElement=this.parent.createElement,this.acInputElement=t}},o.prototype.onSuggestionOpen=function(t){var e=this;this.isPopupOpened=!0,t.popup.relateTo=this.getRelateToElem(),t.popup.element.firstChild.style.maxHeight="180px",new Promise(function(i){setTimeout(function(){i()},100)}).then(function(){e.triggerKeyDownEvent(ia.DOWN)})},o.prototype.onSuggestionClose=function(t){this.isPreventClose?t.cancel=!0:this.isPopupOpened=!1},o.prototype.onSelect=function(t){var e="="+t.itemData.value+"(";if(this.isSubFormula){var i=this.getEditingValue(),r=i.lastIndexOf(this.parent.listSeparator);r>-1?e=i.slice(0,r+1):(r=i.lastIndexOf("("),r>-1&&(e=i.slice(0,r+1))),e+=t.itemData.value+"("}if(this.parent.notify(ui,{action:"refreshEditor",value:e,refreshFormulaBar:!0,refreshEditorElem:!0,refreshCurPos:!this.isFormulaBar}),this.isPopupOpened){this.hidePopUp();var n=J("#"+this.parent.element.id+"_ac_popup");n&&se(n),this.isPopupOpened=!1}},o.prototype.onSuggestionComplete=function(t){this.isPreventClose=t.result.length>0,this.isPreventClose||(t.cancel=!0,this.hidePopUp())},o.prototype.refreshFormulaDatasource=function(){var t={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(At,t),this.autocompleteInstance&&(this.autocompleteInstance.dataSource=t.formulaCollection)},o.prototype.keyUpHandler=function(t){if(this.parent.isEdit){var e=this.getEditingValue();this.isFormula=pt(e),(this.isFormula||this.isPopupOpened)&&(t.keyCode!==ia.TAB&&this.isFormula&&(e=this.getSuggestionKeyFromFormula(e)),this.refreshFormulaSuggestion(t,e))}else this.isPopupOpened&&this.hidePopUp()},o.prototype.keyDownHandler=function(t){var e=t.keyCode;if(this.isFormula){if(this.isPopupOpened)switch(e){case ia.UP:case ia.DOWN:t.preventDefault(),this.triggerKeyDownEvent(e);break;case ia.TAB:t.preventDefault(),this.triggerKeyDownEvent(ia.ENTER);break}}else{var i=t.target;if(i.id===this.parent.element.id+"_name_box")switch(e){case ia.ENTER:document.querySelector(".e-name-box.e-popup-open")||(this.addDefinedName({name:i.value}),Re(this.parent.element));break;case ia.ESC:Re(this.parent.element);break}}},o.prototype.formulaClick=function(t){if(this.parent.isEdit){var e=t.target;this.isFormulaBar=e.classList.contains("e-formula-bar")}},o.prototype.refreshFormulaSuggestion=function(t,e){if(e.length>0){var i=this.autocompleteInstance.element,r=t.keyCode,n=this.isPopupOpened;Yc(r)||(i.value=e,i.dispatchEvent(new Event("input")),i.dispatchEvent(new Event("keyup")),n&&this.triggerKeyDownEvent(ia.DOWN))}else this.isPopupOpened&&(this.isPreventClose=!1,this.hidePopUp())},o.prototype.endEdit=function(){if(this.isSubFormula=!1,this.isPreventClose=!1,this.isFormula=!1,this.isFormulaBar=!1,this.isPopupOpened){this.hidePopUp();var t=J("#"+this.parent.element.id+"_ac_popup");t&&se(t),this.isPopupOpened=!1}},o.prototype.hidePopUp=function(){this.autocompleteInstance.hidePopup()},o.prototype.getSuggestionKeyFromFormula=function(t){var e="";if(t=t.substr(1),t){var i=t.lastIndexOf("(");t=t.substr(i+1);var r=t.split(this.parent.listSeparator);r.length===1?(e=r[0],this.isSubFormula=i>-1):(e=r[r.length-1],this.isSubFormula=!0);var n=e.match(/\w/);(!n||n&&n.index!==0)&&(e="")}return e},o.prototype.getRelateToElem=function(){var t={action:"getElement"};return this.isFormulaBar?this.parent.notify(ho,t):this.parent.notify(ui,t),t.element},o.prototype.getEditingValue=function(){var t={action:"getCurrentEditValue",editedValue:""};return this.parent.notify(ui,t),t.editedValue},o.prototype.triggerKeyDownEvent=function(t){var e=this.autocompleteInstance.element;e.dispatchEvent(new Event("input"));var i=new Event("keydown");i.keyCode=t,i.which=t,i.altKey=!1,i.shiftKey=!1,i.ctrlKey=!1,e.dispatchEvent(i)},o.prototype.getNames=function(t){var e=this.parent.definedNames.filter(function(i){return i.scope==="Workbook"||i.scope===""||i.scope===t});return e},o.prototype.getNameFromRange=function(t){var e=t.slice(0,t.indexOf(":")),i=t.substring(t.lastIndexOf("!")+1).split(":"),r=i.length>1&&i[0]===i[1],n,s,a=this.parent.definedNames.filter(function(l){n=l.refersTo.substring(0,l.refersTo.lastIndexOf("!")),s=l.refersTo.substring(l.refersTo.lastIndexOf("!")+1),n.includes("'")&&n.match(/^='.*'$/)&&(n="="+n.slice(2,-1));var h=n+"!"+s.split("$").join("");return r&&h==="="+e?!0:h==="="+t});return a&&a[0]},o.prototype.addDefinedName=function(t){var e=this,i=t.name,r=!1;if(i&&Or(i.toUpperCase()))return this.parent.goTo(i),r;if(!t.refersTo){var n=ke(this.parent,this.parent.activeSheetIndex),s=Gn(this.parent);s=s.indexOf(" ")!==-1?"'"+s+"'":s;var a=n.selectedRange;if(!g(a)){var l=a.indexOf(":"),h=a.substr(0,l),c=a.substr(l+1,a.length);parseInt(c.replace(/\D/g,""),10)===n.rowCount&&parseInt(h.replace(/\D/g,""),10)===1?(c=c.replace(/[0-9]/g,""),h=h.replace(/[0-9]/g,""),a="$"+h+":$"+c):xe(c)[1]===n.colCount-1&&xe(h)[1]===0?(c=c.replace(/\D/g,""),h=h.replace(/\D/g,""),a="$"+h+":$"+c):a=h===c?h:a}t.refersTo=s+"!"+a,t.scope="Workbook"}if(i.length>0&&/^([a-zA-Z_0-9.]){0,255}$/.test(i)){var u={action:"addDefinedName",definedName:t,isAdded:!1};this.parent.notify(At,u),r=u.isAdded,u.isAdded||this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService(ve).getConstant("DefineNameExists"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameExistsDialog",element:d.element,target:d.target,cancel:d.cancel};e.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}})}else this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService(ve).getConstant("DefineNameInValid"),width:"300",beforeOpen:function(d){var p={dialogName:"DefineNameInValidDialog",element:d.element,target:d.target,cancel:d.cancel};e.parent.trigger("dialogBeforeOpen",p),p.cancel&&(d.cancel=!0)}});return r},o})(),dE=(function(){function o(t){this.aggregateContent="",this.selaggregateCnt="Sum",this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"sheetTabs"},o.prototype.createSheetTabs=function(){var t=this;if(!this.parent.showSheetTabs&&this.tabInstance){this.destroy();return}var e=this.parent.serviceLocator.getService(ve),i=this.parent.enableRtl,r=this.parent.createElement("div",{className:"e-sheet-tab-panel",id:this.parent.element.id+"_sheet_tab_panel"}),n=this.parent.createElement("button",{className:"e-add-sheet-tab e-btn e-css e-flat e-icon-btn"+(this.parent.allowInsert?"":" e-disabled"),attrs:{title:e.getConstant("AddSheet"),type:"button"}});n.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-add-icon"})),n.addEventListener("click",this.addSheetTab.bind(this)),n.disabled=!this.parent.allowInsert,r.appendChild(n),this.addBtnRipple=Wi(r,{selector:".e-add-sheet-tab"});var s=this.parent.createElement("button",{attrs:{title:e.getConstant("ListAllSheets"),type:"button"}});r.appendChild(s),this.parent.element.appendChild(r);var a=this.getSheetTabItems();this.dropDownInstance=new Hr({iconCss:"e-icons",items:a.ddbItems,createPopupOnClick:!0,enableRtl:i,beforeItemRender:function(f){var v=t.parent.sheets[t.dropDownInstance.items.indexOf(f.item)];v.state==="Hidden"?f.element.classList.add("e-hide"):v.state==="VeryHidden"&&(f.element.style.display="none")},select:function(f){return t.updateSheetTab({idx:t.dropDownInstance.items.indexOf(f.item)})},beforeOpen:function(f){return t.beforeOpenHandler(t.dropDownInstance,f.element,e.getConstant("ListAllSheets"))},open:function(f){return t.openHandler(t.dropDownInstance,f.element,t.parent.enableRtl?"right":"left",j.isDevice)},cssClass:"e-sheets-list e-flat e-caret-hide",close:function(){return t.focusTab(t.tabInstance.element)}}),this.dropDownInstance.createElement=this.parent.createElement,this.dropDownInstance.appendTo(s);var l=this.parent.createElement("div",{className:"e-sheet-tab"}),h;this.tabInstance=new wy({selectedItem:this.parent.activeSheetIndex,overflowMode:"Scrollable",items:a.tabItems,scrollStep:250,enableRtl:i,selecting:function(f){if(f.selectingIndex!==f.selectedIndex)if(h)h=!1;else{var v={currentSheetIndex:f.selectingIndex,previousSheetIndex:f.selectedIndex,cancel:!1};t.parent.notify(hi,{eventArgs:v,action:"gotoSheet"}),h=v.cancel}},selected:function(f){f.isInteracted||(f.preventFocus=!0),t.goToSheet(f,h,!0)},created:function(){var f=t.tabInstance.element.querySelector(".e-toolbar-items");f.classList.add("e-sheet-tabs-items"),T.add(f,"dblclick",t.renameSheetTab,t)}}),r.appendChild(l),this.tabInstance.createElement=this.parent.createElement,this.tabInstance.appendTo(l),T.remove(this.tabInstance.element,"keydown",this.tabInstance.spaceKeyDown);for(var c=a.tabItems.length,u,d=0;d<c;d++){u=ke(this.parent,d);var p={action:"addSheet",sheetName:"Sheet"+u.id,sheetId:u.id,visibleName:u.name};this.parent.notify(At,p)}this.parent.notify(At,{action:"initiateDefinedNames"}),this.parent.notify(Hc,null)},o.prototype.goToSheet=function(t,e,i){var r=this;if(t.selectedIndex!==t.previousIndex){if(e){this.tabInstance.selectedItem=t.previousIndex,this.tabInstance.dataBind(),Re(this.parent.element);return}if(this.parent.notify(Go,{}),this.parent.isEdit){var n=window.getSelection(),s={action:"getCurrentEditValue",editedValue:""};this.parent.notify(ui,s);var a=s.editedValue?pt(s.editedValue,!0):!1;!a&&n&&n.focusNode&&n.focusNode.classList&&n.focusNode.classList.contains("e-formula-bar-panel")&&(a=pt(this.parent.element.querySelector(".e-formula-bar").value,!0)),a||this.parent.endEdit()}this.parent.activeSheetIndex=t.selectedIndex,this.parent.dataBind(),this.updateDropDownItems(t.selectedIndex,t.previousIndex);var l={action:"registerGridInCalc",sheetID:(t.selectedIndex+1).toString()};this.parent.notify(At,l),i&&(this.parent.notify(wt,{eventArgs:{previousSheetIndex:t.previousIndex,currentSheetIndex:t.selectedIndex},action:"gotoSheet"}),er(function(){return Re(r.parent.element)}))}},o.prototype.updateDropDownItems=function(t,e){e>-1&&(this.dropDownInstance.items[e].iconCss=""),this.dropDownInstance.items[t].iconCss="e-selected-icon e-icons",this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0)},o.prototype.beforeOpenHandler=function(t,e,i){var r=this.parent.viewport.height,n=parseInt(getComputedStyle(e.firstElementChild).height,10)*t.items.length+parseInt(getComputedStyle(e).paddingTop,10)*2;n>r&&(e.style.height=r+"px",e.style.overflowY="auto"),e.parentElement.style.visibility="hidden",i&&e.setAttribute("aria-label",i)},o.prototype.openHandler=function(t,e,i,r){var n=e.parentElement,s,a=gs(n);if(a.indexOf("bottom")===-1||r){s=e.style.overflowY==="auto"?this.parent.viewport.height:n.getBoundingClientRect().height;var l=Ar(t.element,i,"top");i==="right"&&(l.left-=n.getBoundingClientRect().width),n.style.left=l.left+"px",n.style.top=l.top-s+"px"}n.style.visibility="",Re(e)},o.prototype.getSheetTabItems=function(){var t=this,e=[],i=[],r;return this.parent.sheets.forEach(function(n,s){r=Gn(t.parent,s).replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.push({header:{text:r},visible:n.state==="Visible"}),i.push({text:r,iconCss:s===t.parent.activeSheetIndex?"e-selected-icon e-icons":""})}),{tabItems:e,ddbItems:i}},o.prototype.refreshSheetTab=function(){var t=this.getSheetTabItems();this.dropDownInstance.items=t.ddbItems,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.items=t.tabItems,this.tabInstance.selectedItem=this.parent.activeSheetIndex,this.tabInstance.dataBind()},o.prototype.addSheetTab=function(){this.parent.notify(Fa,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1})},o.prototype.insertSheetTab=function(t){this.parent.notify(Go,{}),(!t.preventUpdate||t.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss="");for(var e=t.startIdx;e<=t.endIdx;e++){var i=this.parent.sheets[e].name.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.dropDownInstance.items.splice(e,0,{text:i}),this.tabInstance.addTab([{header:{text:i},content:""}],e)}(!t.preventUpdate||t.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[t.startIdx].iconCss="e-selected-icon e-icons"),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),t.preventUpdate?t.startIdx!==this.tabInstance.selectedItem?this.refreshSheetTab():this.parent.notify(Hc,null):this.updateSheetTab({idx:t.startIdx,preventDataBind:!0})},o.prototype.updateSheetTab=function(t){if(t.name==="activeSheetChanged")t.idx=this.parent.skipHiddenSheets(t.idx);else if(this.parent.sheets[t.idx].state==="Hidden"){if(this.parent.isProtected)return;this.showSheet({sheetIndex:t.idx,triggerEvent:!0})}this.tabInstance.selectedItem=t.idx,t.preventDataBind||this.tabInstance.dataBind(),this.parent.notify(Hc,null)},o.prototype.showSheet=function(t){this.parent.setSheetPropertyOnMute(this.parent.sheets[t.sheetIndex],"state","Visible"),this.tabInstance.hideTab(t.sheetIndex,!1),t.triggerEvent&&this.parent.notify(wt,{action:"showSheet",eventArgs:{sheetIndex:t.sheetIndex}})},o.prototype.switchSheetTab=function(t){var e=H(t.event.target,".e-toolbar-item");if(e){for(var i=e.querySelector(".e-tab-text").textContent,r=[],n=this.parent.element.id+"_cmenu",s=0,a=this.parent.sheets.length;s<a;s++)if(this.parent.sheets[s].name===i){this.parent.activeSheetIndex!==s&&this.updateSheetTab({idx:s});break}t.element.classList.contains("e-contextmenu")&&t.items[0]&&t.items[0].id===this.parent.element.id+"_cmenu_insert_sheet"&&(this.skipHiddenSheets()===1&&r.push(n+"_hide_sheet",n+"_delete_sheet"),(!this.parent.allowInsert||this.parent.isProtected)&&r.push(n+"_insert_sheet"),!this.parent.allowDelete&&r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet")),(this.parent.password.length>0||this.parent.isProtected)&&(r.indexOf(n+"_insert_sheet")>-1&&r.push(n+"_insert_sheet"),r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet"),r.push(n+"_duplicate",n+"_rename",n+"_hide_sheet",n+"_delete_sheet",n+"_insert_sheet",n+"_move_left",n+"_move_right")),this.parent.enableContextMenuItems(r,!1,!0)}},o.prototype.skipHiddenSheets=function(){var t=this.parent.sheets.length;return this.parent.sheets.forEach(function(e){e.state!=="Visible"&&--t}),t},o.prototype.renameSheetTab=function(){var t=this.tabInstance.element.querySelector(".e-toolbar-item.e-active");if(t){t=t.querySelector(".e-text-wrap");var e=t.querySelector(".e-tab-text").textContent,i={eventArgs:{name:e,index:this.parent.getActiveSheet().id},action:"renameSheet",cancel:!1};if(this.parent.trigger("actionBegin",i),i.cancel||this.parent.isProtected)return;var r=this.parent.createElement("input",{id:this.parent.element.id+"_rename_input",className:"e-input e-sheet-rename",styles:"width: "+t.getBoundingClientRect().width+"px",attrs:{type:"text",name:"Rename",required:"",value:e,spellcheck:"false",maxlength:"31"}});t.firstElementChild.style.display="none",t.appendChild(r),T.add(document,"mousedown touchstart",this.renameInputFocusOut,this),T.add(r,"keydown",this.renameKeyDown,this),T.add(r,"input",this.updateWidth,this),r.focus(),r.setSelectionRange(0,e.length),T.remove(H(t,".e-toolbar-items"),"dblclick",this.renameSheetTab)}},o.prototype.updateWidth=function(t){var e=t.target,i=e.value.length,r=e.value.split(" ");if(r.length){var n=r.length-1;i-=n,i+=n*.5}e.style.width=i+"ch"},o.prototype.renameKeyDown=function(t){t.keyCode===32?t.stopPropagation():t.keyCode===27?(this.removeRenameInput(t.target),this.focusTab(this.tabInstance.element)):t.keyCode===13&&this.renameInputFocusOut(t)},o.prototype.renameInputFocusOut=function(t){var e=t.target;if(!((t.type==="mousedown"||t.type==="touchstart")&&(e.classList.contains("e-sheet-rename")||H(e,".e-dlg-container")))){e=document.getElementById(this.parent.element.id+"_rename_input");var i=e.value,r=this.parent.serviceLocator.getService(ve);if(i){var n=this.tabInstance.selectedItem;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*")))this.showRenameDialog(e,r.getConstant("SheetRenameInvalidAlert"));else{if(this.parent.sheets[n].name!==i){for(var s=0,a=this.parent.sheets.length;s<a;s++)if(s!==this.parent.activeSheetIndex&&this.parent.sheets[s].name.toLowerCase()===i.toLowerCase()){this.showRenameDialog(e,r.getConstant("SheetRenameAlreadyExistsAlert"));return}}var l=this.removeRenameInput(e);this.parent.sheets[n].name!==i&&(this.parent.setSheetPropertyOnMute(this.parent.sheets[n],"name",i),this.updateSheetName({value:i,idx:n,items:l})),t.type==="keydown"?this.focusTab(l):H(t.target,".e-spreadsheet")&&Re(this.parent.element)}}else this.showRenameDialog(e,r.getConstant("SheetRenameEmptyAlert"));this.parent.notify(wt,{eventArgs:{index:this.parent.getActiveSheet().id,value:i},action:"renameSheet"})}},o.prototype.focusTab=function(t){Re(J(".e-toolbar-item.e-active .e-tab-wrap",t))},o.prototype.updateSheetName=function(t){var e=this.tabInstance.items[t.idx].header.text.replace(/&lt;/g,"<").replace(/&gt;/g,">"),i=t.value.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.tabInstance.items[t.idx].header.text=i,this.dropDownInstance.items[t.idx].text=i,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0);var r=t.items.querySelectorAll(".e-toolbar-item")[t.idx].querySelector(".e-tab-text");if(r.textContent="",r.appendChild(document.createTextNode(t.value)),t.value.indexOf("  ")>-1?this.tabInstance.setProperties({items:this.tabInstance.items},!0):this.tabInstance.dataBind(),this.parent.notify(Mg,{value:t.value,pName:e}),this.parent.allowChart){var n=[],s;this.parent.chartColl.forEach(function(a){a.range.includes("!")&&(s=a.range.lastIndexOf("!"),n[0]=a.range.substring(0,s),n[0].startsWith("'")&&n[0].endsWith("'")&&(n[0]=n[0].slice(1,-1)),n[1]=a.range.substring(s+1),n[0].toLowerCase()===e.toLowerCase()&&(n[0]=t.value,a.range=n.join("!")))})}},o.prototype.hideSheet=function(t){var e={action:"hideSheet",eventArgs:{sheetIndex:t.sheetIndex,cancel:!1}};t.triggerEvent&&(this.parent.notify(hi,e),e.eventArgs.cancel)||(this.parent.setSheetPropertyOnMute(ke(this.parent,t.sheetIndex),"state","Hidden"),this.tabInstance.hideTab(t.sheetIndex),t.triggerEvent&&(delete e.eventArgs.cancel,this.parent.notify(wt,e)))},o.prototype.removeRenameInput=function(t){var e=t.parentElement.querySelector(".e-tab-text"),i=H(t,".e-toolbar-items");return T.add(i,"dblclick",this.renameSheetTab,this),T.remove(document,"mousedown touchstart",this.renameInputFocusOut),T.remove(t,"keydown",this.renameKeyDown),T.remove(t,"input",this.updateWidth),Qe(t),e.style.display="",i},o.prototype.showRenameDialog=function(t,e){var i=this,r=this.parent.serviceLocator.getService(jt),n;r.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:e,enableRtl:this.parent.enableRtl,beforeOpen:function(s){var a={dialogName:"SheetRenameDialog",element:s.element,target:s.target,cancel:s.cancel};i.parent.trigger("dialogBeforeOpen",a),a.cancel?n=s.preventFocus=s.cancel=!0:(s.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",e+" "+i.parent.serviceLocator.getService(ve).getConstant("Ok")),Re(t))},close:function(){n?er(function(){var s=[t.selectionStart,t.selectionEnd];Re(t),t.setSelectionRange(s[0],s[1])}):t.setSelectionRange(0,t.value.length)}})},o.prototype.focusRenameInput=function(){var t=document.getElementById(this.parent.element.id+"_rename_input");t&&t.focus()},o.prototype.removeSheetTab=function(t){var e=this;if(!(t.count&&t.count===this.parent.sheets.length)){var i=this.parent.serviceLocator.getService(ve);if(this.skipHiddenSheets()>1){var r=t.sheetName?ke(this.parent,Ct(this.parent,t.sheetName)):this.parent.getActiveSheet(),n=g(t.index)?Ct(this.parent,r.name):t.index,s={index:n,sheetCount:this.parent.sheets.length,sheetName:r.name},a=r.rows&&r.rows.length?r.rows.length===1?!!(r.rows[0].cells&&r.rows[0].cells.length):!0:!1;if(a){var l=this.parent.serviceLocator.getService(jt);t.clicked?this.forceDelete(n):l.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-delete-sheet-dlg",enableRtl:this.parent.enableRtl,content:i.getConstant("DeleteSheetAlert"),beforeOpen:function(h){var c={dialogName:"DeleteSheetDialog",element:h.element,target:h.target,cancel:h.cancel};e.parent.trigger("dialogBeforeOpen",c),c.cancel?h.cancel=!0:(h.element.querySelector(".e-footer-content .e-primary").setAttribute("aria-label",i.getConstant("DeleteSheetAlert")+" "+i.getConstant("Ok")),Re(e.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){l.hide(),e.forceDelete(n),e.parent.notify(Vh,null),t&&!t.isAction&&(s.sheetCount=e.parent.sheets.length,e.parent.notify(wt,{eventArgs:s,action:"removeSheet"}))}}]})}else this.parent.notify(Ss,{startIndex:n,endIndex:n,modelType:"Sheet",isDelete:!0}),this.parent.notify(At,{action:"deleteSheetTab",sheetId:ke(this.parent,n).id}),this.destroySheet(n),this.parent.notify(Vh,null),t&&!t.isAction&&(s.sheetCount=this.parent.sheets.length,this.parent.notify(wt,{eventArgs:s,action:"removeSheet"}))}else this.parent.serviceLocator.getService(jt).show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:i.getConstant("DeleteSingleLastSheetAlert"),beforeOpen:function(h){var c={dialogName:"DeleteSingleSheetDialog",element:h.element,target:h.target,cancel:h.cancel};e.parent.trigger("dialogBeforeOpen",c),c.cancel&&(h.cancel=!0)}})}},o.prototype.forceDelete=function(t){this.parent.notify(Go,{}),this.parent.notify(Ss,{startIndex:t,endIndex:t,modelType:"Sheet",isDelete:!0}),this.parent.notify(At,{action:"deleteSheetTab",sheetId:ke(this.parent,t).id}),this.destroySheet(t)},o.prototype.destroySheet=function(t){var e=g(t)?this.parent.activeSheetIndex:t;this.parent.removeSheet(e),this.parent.notify(ka,{sheetIndex:e}),this.dropDownInstance.items.splice(e,1),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.removeTab(e);var i=this.parent.skipHiddenSheets(this.tabInstance.selectedItem);this.parent.activeSheetIndex=i,this.parent.setProperties({activeSheetIndex:i},!0),this.parent.renderModule.refreshSheet(),this.tabInstance.selectedItem=i,this.tabInstance.dataBind(),this.updateDropDownItems(i),this.parent.notify(Hc,null)},o.prototype.showAggregate=function(t){var e=this,i=this.parent.getActiveSheet();if(!i.selectedRange.includes(" ")&&ug(ie(i.selectedRange))||t&&t.remove){this.removeAggregate();return}var r={Count:0,Sum:"0",Avg:"0",Min:"0",Max:"0",countOnly:!0};if(this.parent.notify(ag,r),r.Count>1){this.aggregateContent=r.countOnly?"Count":this.selaggregateCnt,r.countOnly&&(this.aggregateContent="Count",delete r.Sum,delete r.Avg,delete r.Min,delete r.Max);var n=r.countOnly?"e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide":"e-aggregate-list e-flat";delete r.countOnly;var s=this.aggregateContent,a=s+": "+r[s.toString()];if(this.aggregateDropDown)this.updateAggregateContent(a,r);else{var l=this.parent.createElement("button",{id:this.parent.element.id+"_aggregate",attrs:{type:"button"}});document.getElementById(this.parent.element.id+"_sheet_tab_panel").appendChild(l),this.aggregateDropDown=new Hr({content:a,items:this.getAggregateItems(r),createPopupOnClick:!0,enableRtl:this.parent.enableRtl,select:function(h){e.parent.notify(ag,r),e.updateAggregateContent(h.item.text,{Count:r.Count,Sum:r.Sum,Avg:r.Avg,Min:r.Min,Max:r.Max},!0)},beforeOpen:function(h){return e.beforeOpenHandler(e.aggregateDropDown,h.element)},open:function(h){return e.openHandler(e.aggregateDropDown,h.element,e.parent.enableRtl?"left":"right")},close:function(){return Re(e.parent.element)},cssClass:n}),this.aggregateDropDown.createElement=this.parent.createElement,this.aggregateDropDown.appendTo(l)}}else this.removeAggregate()},o.prototype.getAggregateItems=function(t){var e=this,i=[],r,n,s;return Object.keys(t).forEach(function(a){s=t[""+a],s!==ag&&(r=a+": "+s,n=a===e.aggregateContent?"e-selected-icon e-icons":"",i.push({text:r,iconCss:n}))}),i},o.prototype.updateAggregateContent=function(t,e,i){this.aggregateContent=t.split(": ")[0],i&&(this.selaggregateCnt=t.split(": ")[0]),this.aggregateDropDown.content=t,this.aggregateDropDown.dataBind(),this.aggregateDropDown.setProperties({items:this.getAggregateItems(e)},!0)},o.prototype.removeAggregate=function(){g(this.aggregateDropDown)||(this.aggregateDropDown.destroy(),Qe(this.aggregateDropDown.element),this.aggregateDropDown=null)},o.prototype.addEventListener=function(){this.parent.on(o0,this.createSheetTabs,this),this.parent.on(Oh,this.refreshSheetTab,this),this.parent.on(YM,this.insertSheetTab,this),this.parent.on(h0,this.removeSheetTab,this),this.parent.on(GM,this.renameSheetTab,this),this.parent.on(eu,this.switchSheetTab,this),this.parent.on(su,this.updateSheetTab,this),this.parent.on(vo,this.removeAggregate,this),this.parent.on(l0,this.focusRenameInput,this),this.parent.on(g0,this.updateSheetName,this),this.parent.on(v0,this.hideSheet,this),this.parent.on(jl,this.showAggregate,this),this.parent.on(wD,this.goToSheet,this),this.parent.on(xD,this.showSheet,this)},o.prototype.destroy=function(){this.removeEventListener(),this.dropDownInstance&&this.dropDownInstance.destroy(),this.dropDownInstance=null,this.tabInstance&&this.tabInstance.destroy(),this.tabInstance=null,this.removeAggregate(),this.aggregateContent=null,this.addBtnRipple&&this.addBtnRipple(),this.addBtnRipple=null,T.remove(document,"mousedown touchstart",this.renameInputFocusOut);var t=document.getElementById(this.parent.element.id+"_sheet_tab_panel");t&&Qe(t),this.selaggregateCnt&&(this.selaggregateCnt=null),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(o0,this.createSheetTabs),this.parent.off(Oh,this.refreshSheetTab),this.parent.off(YM,this.insertSheetTab),this.parent.off(h0,this.removeSheetTab),this.parent.off(GM,this.renameSheetTab),this.parent.off(eu,this.switchSheetTab),this.parent.off(su,this.updateSheetTab),this.parent.off(vo,this.removeAggregate),this.parent.off(l0,this.focusRenameInput),this.parent.off(g0,this.updateSheetName),this.parent.off(v0,this.hideSheet),this.parent.off(jl,this.showAggregate),this.parent.off(wD,this.goToSheet),this.parent.off(xD,this.showSheet))},o})(),pE=(function(){function o(t){this.isImportedFile=!1,this.unProtectSheetIdx=[],this.parent=t,this.addEventListener(),this.renderFileUpload()}return o.prototype.addEventListener=function(){this.parent.on(Rb,this.openSuccess,this),this.parent.on(wM,this.openFailed,this),this.parent.on(ka,this.sheetsDestroyHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Rb,this.openSuccess),this.parent.off(wM,this.openFailed),this.parent.off(ka,this.sheetsDestroyHandler))},o.prototype.renderFileUpload=function(){var t=this.parent.element.appendChild(this.parent.createElement("input",{id:this.parent.element.id+"_fileUpload",attrs:{type:"file",accept:".xls, .xlsx, .csv, .xlsm, .xlsb",name:"fileUpload"}}));t.onchange=this.fileSelect.bind(this),t.onerror=this.openFailed.bind(this),t.style.display="none"},o.prototype.fileSelect=function(t){var e=t.target.files[0];if(!(e&&e.length<1)){var i={file:e};this.parent.open(i),J("#"+this.parent.element.id+"_fileUpload",this.parent.element).value=""}},o.prototype.openSuccess=function(t){var e=this,i=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword","DataLimitExceeded","FileSizeLimitExceeded","ExternalWorkbook"],r=function(c){e.parent.serviceLocator.getService(jt).hide(!0);var u=new File([],t.guid,{type:c.toLowerCase()});e.parent.open({file:u,guid:t.guid,password:t.eventArgs.password,orginalFile:t.eventArgs.file})};if(i.indexOf(t.data)>-1){var n=this.parent.serviceLocator.getService(ve);if(i[2]===t.data)this.parent.element.querySelector(".e-importprotectworkbook-dlg")||this.parent.notify(FD,t.eventArgs);else if(i[3]===t.data){var s=this.parent.createElement("span",{className:"e-importprotectpwd-alert-span"});s.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-importprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(s)}else if(i[4]===t.data){var s=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span"});s.innerText=n.getConstant("IncorrectPassword"),this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(s)}else if(i[5]===t.data){this.parent.isOpen=!1,this.parent.notify(zD,null);var a=this.parent.serviceLocator.getService(jt);a.hide(),this.parent.hideSpinner()}else if(i[8]===t.data){var a=this.parent.serviceLocator.getService(jt);a.hide(!0);var l=t.data.includes("ExternalWorkbook");this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("ExternalWorkbook"),width:"350",buttons:l?[{click:r.bind(this,t.data+"Yes"),buttonModel:{content:n.getConstant("Yes"),isPrimary:!0}},{click:r.bind(this,t.data+"No"),buttonModel:{content:n.getConstant("No")}}]:[],beforeOpen:function(u){var d={dialogName:"OpenDialog",element:u.element,target:u.target,cancel:u.cancel};e.parent.trigger("dialogBeforeOpen",d),d.cancel&&(u.cancel=!0)}},l?!0:null),this.parent.hideSpinner();return}else{var a=this.parent.serviceLocator.getService(jt);a.hide(!0);var h=t.data.includes("LimitExceeded");this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant(t.data),width:"300",buttons:h?[{click:r.bind(this,t.data+"Open"),buttonModel:{content:n.getConstant("Ok"),isPrimary:!0}},{click:r.bind(this,t.data+"Cancel"),buttonModel:{content:n.getConstant("Cancel")}}]:[],beforeOpen:function(u){var d={dialogName:"OpenDialog",element:u.element,target:u.target,cancel:u.cancel};e.parent.trigger("dialogBeforeOpen",d),d.cancel&&(u.cancel=!0)}},h?!0:null),this.parent.hideSpinner();return}}else{var a=this.parent.serviceLocator.getService(jt);a.hide(),this.parent.showSpinner()}this.parent.element&&i[5]!==t.data&&(this.parent.notify($c,{cellRef:null,isOpen:!0}),t.isOpenFromJson||(this.parent.trigger("openComplete",{response:t}),this.parent.notify(wt,{response:t,action:"import"})),this.parent.isProtected&&this.parent.showSheetTabs&&t.isOpenFromJson&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.renderModule.refreshSheet(t.isOpenFromJson,!1,!1,!1,t),this.parent.notify(Oh,null),this.isImportedFile=!0,t.context.preventFormatCheck=t.eventArgs&&t.eventArgs.file&&t.eventArgs.file.name&&!t.eventArgs.file.name.includes(".csv"),this.unProtectSheetIdx=[],this.parent.hideSpinner())},o.prototype.openFailed=function(t){this.parent.trigger("openFailure",t),this.parent.hideSpinner()},o.prototype.sheetsDestroyHandler=function(t){g(t.sheetIndex)&&(this.isImportedFile=!1,this.unProtectSheetIdx=[])},o.prototype.destroy=function(){this.removeEventListener();var t=J("#"+this.parent.element.id+"_fileUpload",this.parent.element);t&&se(t),this.isImportedFile=null,this.unProtectSheetIdx=null,this.parent=null},o.prototype.getModuleName=function(){return"open"},o})(),fE=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(pg,this.initiateSave,this),this.parent.on(gg,this.saveCompleted,this),this.parent.on(kM,this.showErrorDialog,this),this.parent.on(fg,this.exportDialog,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pg,this.initiateSave),this.parent.off(gg,this.saveCompleted),this.parent.off(kM,this.showErrorDialog),this.parent.off(fg,this.exportDialog))},o.prototype.getModuleName=function(){return"save"},o.prototype.initiateSave=function(){this.parent.showSpinner()},o.prototype.saveCompleted=function(){this.parent.hideSpinner()},o.prototype.showErrorDialog=function(t){var e=this,i=this.parent.serviceLocator.getService(jt);i.show({isModal:!0,showCloseIcon:!0,height:180,width:400,content:t.content,beforeOpen:function(){return Re(e.parent.element)}})},o.prototype.exportDialog=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.serviceLocator.getService(jt),n=t?t.item.id.split(this.parent.element.id+"_")[1]:"xlsx";if(g(this.parent.element.querySelector(".e-open-dlg"))){var s={isModal:!0,showCloseIcon:!0,cssClass:"e-open-dlg",header:i.getConstant("SaveAs"),enableRtl:this.parent.enableRtl,beforeOpen:function(a){var l={dialogName:i.getConstant("SaveAs"),element:a.element,target:a.target,cancel:a.cancel};e.parent.trigger("dialogBeforeOpen",l),l.cancel?a.cancel=!0:(r.dialogInstance.content=e.OpenContent(n),r.dialogInstance.dataBind(),e.parent.element.querySelector(".e-text-open").setSelectionRange(0,e.parent.element.querySelector(".e-text-open").value.length),Re(e.parent.element))},buttons:[{buttonModel:{content:i.getConstant("Save"),isPrimary:!0,cssClass:"e-btn-open-ok"},click:function(){var a=e.parent.element.querySelector(".e-text-open").value;if(e.checkValidName(a)){r.hide();var l=t?t.item.id.split(e.parent.element.id+"_")[1]:"Xlsx";e.parent.save({saveType:l,fileName:a})}else{var h=e.parent.element.querySelector(".e-btn-open-ok"),c=ot(h,"btn");c.disabled=!0;var u=e.parent.serviceLocator.getService(ve),d=a.length===0?u.getConstant("EmptyFileName"):a.length>218?u.getConstant("LargeName"):u.getConstant("FileNameError"),p=e.parent.createElement("span",{className:"e-file-alert-span"});p.innerText=d,e.parent.element.querySelector(".e-file-alert-span")&&e.parent.element.querySelector(".e-file-alert-span").remove(),e.parent.element.querySelector(".e-open-dlg").querySelector(".e-dlg-content").appendChild(p)}}}]};r.show(s)}else r.hide()},o.prototype.checkValidName=function(t){var e=!0;return(t.match(new RegExp('.*[\\[\\]\\*\\\\/\\?\\:\\<\\>\\|\\"].*'))||t.length<1||t.length>218)&&(e=!1),e},o.prototype.OpenContent=function(t){var e=this,i=this.parent.serviceLocator.getService(ve),r=this.parent.createElement("div",{className:"e-open-dialog"}),n=this.parent.createElement("div",{className:"e-open-head"}),s=this.parent.createElement("div",{className:"e-input-group"});r.appendChild(n),r.appendChild(s);var a=i.getConstant("FileName"),l=this.parent.element.id+"_filename",h=this.parent.createElement("p",{className:"e-header",id:l,attrs:{"aria-label":i.getConstant("SaveAs")+" "+a}});h.innerText=a;var c=this.parent.createElement("input",{className:"e-input e-text-open",attrs:{type:"Text","aria-labelledby":l}}),u=this.parent.createElement("span",{className:"e-input-group-icon"});return c.onkeyup=function(d){if(e.parent.element.querySelector(".e-file-alert-span")&&d.keyCode!==13){var p=e.parent.element.querySelector(".e-btn-open-ok"),f=ot(p,"btn");f.disabled=!1,e.parent.element.querySelector(".e-file-alert-span").remove()}},n.appendChild(h),u.textContent="."+t.toLowerCase(),s.appendChild(c),c.setAttribute("value","Sample"),s.appendChild(u),r},o})(),gE=(function(){function o(t){this.parent=t,this.init()}return o.prototype.init=function(){this.initContextMenu(),this.addEventListener()},o.prototype.initContextMenu=function(){var t=this,e=document.createElement("ul");e.id=this.parent.element.id+"_contextmenu",this.parent.element.appendChild(e),this.contextMenuInstance=new Cy({cssClass:"e-spreadsheet-contextmenu",target:"#"+this.parent.element.id,select:this.selectHandler.bind(this),beforeOpen:this.beforeOpenHandler.bind(this),beforeClose:this.beforeCloseHandler.bind(this),beforeItemRender:function(i){i.element.setAttribute("aria-label",i.item.text)},created:function(){T.add(e,"keyup",t.preventKeyNavigation,t)}},e),e.setAttribute("role","menu")},o.prototype.beforeCloseHandler=function(t){var e=this;this.parent.trigger("contextMenuBeforeClose",t),this.parent.enableKeyboardShortcut&&t.event&&t.event.keyCode===27&&er(function(){return Re(e.parent.element)})},o.prototype.preventKeyNavigation=function(t){!this.parent.enableKeyboardNavigation&&[37,38,39,40].indexOf(t.keyCode)>-1&&(t.preventDefault(),t.stopPropagation())},o.prototype.selectHandler=function(t){var e=pe({cancel:!1},t);this.parent.trigger("contextMenuItemSelect",e);var i=this.parent.element.id+"_cmenu",r=ie(this.parent.getActiveSheet().selectedRange),n=[];if((t.item.id===i+"_ascending"||t.item.id===i+"_descending")&&this.parent.sortCollection)for(var s=this.parent.sortCollection.length-1;s>=0;s--)this.parent.sortCollection[s]&&this.parent.sortCollection[s].sheetIndex===this.parent.activeSheetIndex&&(n.push(this.parent.sortCollection[s]),this.parent.sortCollection.splice(s,1));if(t.item.id===i+"_delete_row"||t.item.id===i+"_delete_column"||t.item.id===i+"_insert_column_before"||t.item.id===i+"_insert_column_after"||t.item.id===i+"_insert_row_above"||t.item.id===i+"_insert_row_below"){var a=Yr(this.parent.getActiveSheet(),r[0]),l=Ht(this.parent.getActiveSheet(),r[1]);if(a&&!a.isReadOnly&&l&&!l.isReadOnly&&Hi(this.parent,r)){this.parent.notify(fr,null);return}}if(t.item.id===i+"_ascending"||t.item.id===i+"_descending"||t.item.id===i+"_customsort"){var h=U0(r[0],r[1],this.parent.getActiveSheet());if(Hi(this.parent,h)){this.parent.notify(fr,null);return}}var c;if(!e.cancel){var u=void 0;switch(t.item.id){case i+"_cut":this.parent.notify(iu,{invokeCopy:!0,promise:Promise});break;case i+"_copy":this.parent.notify(ru,{invokeCopy:!0,promise:Promise});break;case i+"_paste":this.parent.notify(fo,{isAction:!0,isInternal:!0,focus:!0});break;case i+"_pastevalues":this.parent.notify(fo,{type:"Values",isAction:!0,isInternal:!0,focus:!0});break;case i+"_pasteformats":this.parent.notify(fo,{type:"Formats",isAction:!0,isInternal:!0,focus:!0});break;case i+"_rename":this.parent.notify(GM,{});break;case i+"_delete_sheet":this.parent.notify(h0,{}),Re(this.parent.element);break;case i+"_insert_sheet":this.parent.notify(Fa,{model:this.parent,start:this.parent.activeSheetIndex,end:this.parent.activeSheetIndex,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex});break;case i+"_hide_sheet":this.parent.notify(v0,{sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0});break;case i+"_duplicate":JD(this.parent,void 0,!0),Re(this.parent.element);break;case i+"_move_right":a0(this.parent,this.parent.activeSheetIndex+1,null,!0),Re(this.parent.element);break;case i+"_move_left":a0(this.parent,this.parent.activeSheetIndex-1,null,!0),Re(this.parent.element);break;case i+"_ascending":this.parent.notify(Zc,{sortOptions:{sortDescriptors:{order:"Ascending"}}}),this.parent.notify(au,{sortOptions:{sortDescriptors:{order:"Ascending"}},previousSort:n});break;case i+"_descending":this.parent.notify(Zc,{sortOptions:{sortDescriptors:{order:"Descending"}}}),this.parent.notify(au,{sortOptions:{sortDescriptors:{order:"Descending"}},previousSort:n});break;case i+"_customsort":this.parent.notify(c0,null);break;case i+"_filtercellvalue":this.parent.notify(dD,null);break;case i+"_clearfilter":c=ji(xe(this.parent.getActiveSheet().activeCell)[1]+1),this.parent.notify(Rg,{field:c});break;case i+"_reapplyfilter":this.parent.notify(b0,null);break;case i+"_hide_row":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(kn,{startIndex:u[0],endIndex:u[2],hide:!0,isCol:!1,actionUpdate:!0});break;case i+"_unhide_row":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(kn,{startIndex:u[0],endIndex:u[2],hide:!1,isCol:!1,actionUpdate:!0});break;case i+"_hide_column":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(kn,{startIndex:u[1],endIndex:u[3],hide:!0,isCol:!0,actionUpdate:!0});break;case i+"_unhide_column":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(kn,{startIndex:u[1],endIndex:u[3],hide:!1,isCol:!0,actionUpdate:!0});break;case i+"_insert_row_above":case i+"_delete_row":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(t.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:u[0],end:u[2],modelType:"Row",isAction:!0,insertType:"above"});break;case i+"_insert_row_below":u=tt(ie(this.parent.getActiveSheet().selectedRange)),this.parent.notify(Fa,{model:this.parent.getActiveSheet(),start:u[2]+1,end:u[2]+1+(u[2]-u[0]),modelType:"Row",isAction:!0,insertType:"below"});break;case i+"_insert_column_before":case i+"_delete_column":u=ie(this.parent.getActiveSheet().selectedRange),this.parent.notify(t.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:u[1],end:u[3],modelType:"Column",isAction:!0,insertType:"before"});break;case i+"_insert_column_after":u=tt(ie(this.parent.getActiveSheet().selectedRange)),this.parent.notify(Fa,{model:this.parent.getActiveSheet(),start:u[3]+1,end:u[3]+1+(u[3]-u[1]),modelType:"Column",isAction:!0,insertType:"after"});break;case i+"_addNote":this.parent.notify(d0,null);break;case i+"_editNote":this.parent.notify(p0,null);break;case i+"_deleteNote":this.parent.notify(kg,{rowIndex:null,columnIndex:null,isDeleteFromMenu:!0});break;case i+"_hyperlink":this.parent.notify(Lg,null);break;case i+"_editHyperlink":this.parent.notify(Ng,null);break;case i+"_openHyperlink":this.parent.notify(cD,null);break;case i+"_removeHyperlink":this.parent.notify(Fg,{range:this.parent.getActiveSheet().selectedRange});break;case i+"_protect":this.parent.notify(B0,{});break}}},o.prototype.getInsertModel=function(t,e){for(var i=[],r=t;r<=e;r++)r===t?i.push({index:r}):i.push({});return i},o.prototype.beforeOpenHandler=function(t){for(var e=t.event.target,i,r=["e-numericcontainer","e-active-cell","e-selection","e-row","e-header-row","e-select-all-cell","e-sheet-tabs-items","e-spreadsheet-contextmenu"],n,s,a=0,l=r.length;a<l;a++)if(H(e,"."+r[a])){i=!0;break}if(i)n=this.getTarget(e);else{var h=["e-header-cell","e-rowhdr-table","e-selectall-table","e-main-panel"];if(i=h.some(function(C){return e.classList.contains(C)}),i&&(parseInt(e.parentElement.style.zIndex,10)>1||parseInt(e.parentElement.parentElement.style.zIndex,10)>1)){var c=t.event,u={clientY:c.clientY,isImage:!1,target:e},d={clientX:c.clientX,isImage:!1,target:e};this.parent.notify(Is,u),this.parent.notify(Ms,d),n=u.size<=0?"ColumnHeader":d.size<=0?"RowHeader":"Content"}else i=!1}if(!i){t.cancel=!0;return}if(t.element.classList.contains("e-contextmenu")){var p=this.parent.getActiveSheet();if(t.event.target&&(e.classList.contains("e-rowresize")||e.classList.contains("e-colresize"))){var f=ie(p.selectedRange);if(!(e.classList.contains("e-rowresize")?f[1]===0&&f[3]===p.colCount-1:f[0]===0&&f[2]===p.rowCount-1)){t.cancel=!0;return}(e.classList.contains("e-rowresize")?this.parent.hiddenCount(f[0],f[2])!==Math.abs(f[2]-f[0])+1:this.parent.hiddenCount(f[1],f[3],"columns")!==Math.abs(f[3]-f[1])+1)?s=this.getDataSource(n):s=this.getDataSource(n,e)}else{if(n==="Content"){var f=ie(p.selectedRange),v=f[1]===0&&f[3]===p.colCount-1,m=f[0]===0&&f[2]===p.rowCount-1;n=v&&m?"SelectAll":v?"RowHeader":m?"ColumnHeader":"Content"}s=this.getDataSource(n,n==="Footer"?e:void 0)}this.contextMenuInstance.items=s,this.contextMenuInstance.dataBind()}else s=t.items;if(this.parent.selectionSettings.mode==="None"&&n==="Content"&&this.parent.enableContextMenuItems(["Filter"],!1,!1),n==="ColumnHeader"||n==="RowHeader"){if(t.element&&t.element.childElementCount>0){var y=n==="ColumnHeader"?t.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_column"):t.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_row"),b=n==="ColumnHeader"?t.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_column"):t.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_row");this.parent.allowInsert&&y.classList.contains("e-disabled")?y.classList.remove("e-disabled"):(!this.parent.allowInsert||this.parent.element.querySelector(".e-selectall.e-highlight"))&&!y.classList.contains("e-disabled")&&y.classList.add("e-disabled"),this.parent.allowDelete&&b.classList.contains("e-disabled")?b.classList.remove("e-disabled"):!this.parent.allowDelete&&!b.classList.contains("e-disabled")&&b.classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&(n==="ColumnHeader"&&this.parent.enableContextMenuItems(["Insert Column","Delete Column","Hide Column"],!1,!1),n==="RowHeader"&&this.parent.enableContextMenuItems(["Insert Row","Delete Row","Hide Row"],!1,!1))}}else if(n==="Footer"){var S=Ct(this.parent,e.textContent);S===0&&t.element.querySelector("#"+this.parent.element.id+"_cmenu_move_left").classList.add("e-disabled"),S===this.parent.sheets.length-1&&t.element.querySelector("#"+this.parent.element.id+"_cmenu_move_right").classList.add("e-disabled"),this.parent.selectionSettings.mode==="None"&&this.parent.enableContextMenuItems(["Insert"],!1,!1),this.parent.allowDelete||this.parent.enableContextMenuItems(["Delete"],!1,!1)}this.parent.notify(eu,pe(t,{target:n,items:s})),this.parent.trigger("contextMenuBeforeOpen",t)},o.prototype.getTarget=function(t){return H(t,".e-sheet-content")?"Content":H(t,".e-column-header")?t.classList.contains("e-header-cell")?"ColumnHeader":"Content":H(t,".e-row-header")?t.classList.contains("e-header-cell")?"RowHeader":"Content":H(t,".e-sheet-tabs-items")?"Footer":H(t,".e-selectall-container")?t.classList.contains("e-header-cell")?H(t,".e-header-row")?"ColumnHeader":"RowHeader":H(t,".e-select-all-cell")?"SelectAll":"Content":""},o.prototype.getDataSource=function(t,e){var i=this.parent.serviceLocator.getService(ve),r=[],n=this.parent.element.id+"_cmenu";if(t==="Content")this.setClipboardData(r,i,n),r.push({separator:!0}),this.setFilterItems(r,n),this.setSortItems(r,n),r.push({separator:!0}),this.parent.enableNotes&&(this.setNotesMenu(r,n),r.push({separator:!0})),this.setHyperLink(r,n);else if(t==="RowHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),a=ie(s.selectedRange);this.setInsertDeleteItems(r,i,"Row",n,[a[0],a[2]],["Above","Below"]),(!e||e.classList.contains("e-rowresize")||!e.parentElement||!e.parentElement.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Row",n,[a[0],a[2]])}else if(t==="ColumnHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),a=ie(s.selectedRange);this.setInsertDeleteItems(r,i,"Column",n,[a[1],a[3]],["Before","After"]),(!e||!e.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Column",n,[a[1],a[3]])}else t==="SelectAll"?(this.setClipboardData(r,i,n),this.setFilterItems(r,n),this.setSortItems(r,n)):t==="Footer"&&(r.push({text:i.getConstant("Insert"),id:n+"_insert_sheet"}),r.push({text:i.getConstant("Delete"),iconCss:"e-icons e-delete",id:n+"_delete_sheet"}),r.push({text:i.getConstant("DuplicateSheet"),id:n+"_duplicate"}),r.push({text:i.getConstant("Rename"),id:n+"_rename"}),r.push({text:i.getConstant("Hide"),id:n+"_hide_sheet"}),this.setProtectSheetItems(r,n,e),r.push({text:i.getConstant("MoveRight"),id:n+"_move_right"}),r.push({text:i.getConstant("MoveLeft"),id:n+"_move_left"}));return r},o.prototype.setProtectSheetItems=function(t,e,i){var r=this.parent.serviceLocator.getService(ve);ke(this.parent,Ct(this.parent,i.textContent)).isProtected?t.push({text:r.getConstant("UnprotectSheet"),id:e+"_protect",iconCss:"e-icons e-protect-icon"}):t.push({text:r.getConstant("ProtectSheet"),id:e+"_protect",iconCss:"e-icons e-protect-icon"})},o.prototype.setFilterItems=function(t,e){if(this.parent.allowFiltering){var i=this.parent.serviceLocator.getService(ve),r={clearFilterText:null,isFiltered:!1};this.parent.notify(S0,r),t.push({text:i.getConstant("Filter"),id:e+"_filter",iconCss:"",items:[{text:r.clearFilterText,iconCss:"e-icons e-filter-clear",id:e+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:e+"_reapplyfilter"},{separator:!0},{text:i.getConstant("FilterCellValue"),iconCss:"",id:e+"_filtercellvalue"}]})}},o.prototype.setSortItems=function(t,e){var i=this.parent.serviceLocator.getService(ve);this.parent.allowSorting&&t.push({text:i.getConstant("Sort"),id:e+"_sort",iconCss:"e-icons e-sort-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc",id:e+"_ascending"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc",id:e+"_descending"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom",id:e+"_customsort"}]})},o.prototype.setHyperLink=function(t,e){if(this.parent.allowHyperlink){var i=this.parent.serviceLocator.getService(ve),r=this.parent.getActiveSheet(),n=xe(r.activeCell),s=this.parent.getCell(n[0],n[1]);g(s)?t.push({text:i.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:e+"_hyperlink"}):!s.getElementsByClassName("e-hyperlink")[0]&&!s.classList.contains("e-hyperlink")?t.push({text:i.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:e+"_hyperlink"}):t.push({text:i.getConstant("EditHyperlink"),iconCss:"e-icons e-edithyperlink-icon",id:e+"_editHyperlink"},{text:i.getConstant("OpenHyperlink"),iconCss:"e-icons e-openhyperlink-icon",id:e+"_openHyperlink"},{text:i.getConstant("RemoveHyperlink"),iconCss:"e-icons e-removehyperlink-icon",id:e+"_removeHyperlink"})}},o.prototype.setNotesMenu=function(t,e){if(this.parent.enableNotes){var i=this.parent.serviceLocator.getService(ve),r=xe(this.parent.getActiveSheet().activeCell),n=this.parent.getCell(r[0],r[1]);!g(n)&&n.children.length>0&&n.children[n.children.length-1].className.indexOf("addNoteIndicator")>-1?t.push({text:i.getConstant("EditNote"),iconCss:"e-icons e-edit-notes",id:e+"_editNote"},{text:i.getConstant("DeleteNote"),iconCss:"e-icons e-delete-notes",id:e+"_deleteNote"}):t.push({text:i.getConstant("AddNote"),iconCss:"e-icons e-add-notes",id:e+"_addNote"})}},o.prototype.setClipboardData=function(t,e,i){this.parent.enableClipboard&&(t.push({text:e.getConstant("Cut"),iconCss:"e-icons e-cut-icon",id:i+"_cut"}),t.push({text:e.getConstant("Copy"),iconCss:"e-icons e-copy-icon",id:i+"_copy"}),t.push({text:e.getConstant("Paste"),iconCss:"e-icons e-paste-icon",id:i+"_paste"}),t.push({text:e.getConstant("PasteSpecial"),id:i+"_pastespecial",items:[{text:e.getConstant("Values"),id:i+"_pastevalues"},{text:e.getConstant("Formats"),id:i+"_pasteformats"}]}))},o.prototype.setInsertDeleteItems=function(t,e,i,r,n,s){t.push({separator:!0}),["Insert","Delete"].forEach(function(a){n[0]===n[1]?t.push({text:e.getConstant(""+a+i),id:r+("_"+a.toLowerCase()+"_"+i.toLowerCase())}):t.push({text:e.getConstant(""+a+i+"s"),id:r+("_"+a.toLowerCase()+"_"+i.toLowerCase())}),a==="Insert"&&(t[t.length-1].items=[],s.forEach(function(l){t[t.length-1].items.push({text:e.getConstant(l),id:t[t.length-1].id+"_"+l.toLowerCase()})}))})},o.prototype.setHideShowItems=function(t,e,i,r,n){if(n[0]===n[1])t.push({text:e.getConstant("Hide"+i),id:r+("_hide_"+i.toLowerCase())});else{var s=n[0];n[0]=n[0]>n[1]?n[1]:n[0],n[1]=n[1]>s?n[1]:s,t.push({text:e.getConstant("Hide"+i+"s"),id:r+("_hide_"+i.toLowerCase())})}this.parent.hiddenCount(n[0],n[1],i.toLowerCase()+"s")&&t.push({text:e.getConstant("Unhide"+i+"s"),id:r+("_unhide_"+i.toLowerCase())})},o.prototype.addEventListener=function(){this.parent.on(KM,this.addItemsHandler,this),this.parent.on($M,this.removeItemsHandler,this),this.parent.on(ZM,this.enableItemsHandler,this)},o.prototype.addItemsHandler=function(t){t.insertAfter?this.contextMenuInstance.insertAfter(t.items,t.text,t.isUniqueId):this.contextMenuInstance.insertBefore(t.items,t.text,t.isUniqueId)},o.prototype.removeItemsHandler=function(t){this.contextMenuInstance.removeItems(t.items,t.isUniqueId)},o.prototype.enableItemsHandler=function(t){this.contextMenuInstance.enableItems(t.items,t.enable,t.isUniqueId)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(KM,this.addItemsHandler),this.parent.off($M,this.removeItemsHandler),this.parent.off(ZM,this.enableItemsHandler))},o.prototype.getModuleName=function(){return"contextMenu"},o.prototype.destroy=function(){this.removeEventListener(),this.contextMenuInstance.destroy();var t=document.getElementById(this.parent.element.id+"_contextmenu");t&&(T.remove(t,"keyup",this.preventKeyNavigation),se(t)),this.contextMenuInstance=null,this.parent=null},o})(),vE=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.refreshCellElement=function(t){this.parent.refreshNode(t.td,t)},o.prototype.getTextSpace=function(t){t.width=dr(t.char,t.cell.style,this.parent.cellStyle)},o.prototype.rowFillHandler=function(t){var e=t.cellEle;if(e){var i=void 0,r=t.colIdx;if(t.cell.colSpan>1){var n={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};this.parent.notify(pr,n),r=n.range[3]}var s=ip(this.parent.getActiveSheet(),t.rowIdx,t.colIdx,r),a=t.iconSetSpan||e.querySelector(".e-iconsetspan");a&&(s-=a.getBoundingClientRect().width);var l=e.querySelector(".e-filter-btn");if(l&&(s-=l.getBoundingClientRect().width),t.updateFillSize){if(i=e.querySelector(".e-fill"),!i||!i.textContent)return;t.repeatChar=i.textContent[0];var h=e.querySelector(".e-fill-before");h&&(s-=dr(h.textContent,t.cell.style,this.parent.cellStyle));var c=e.querySelector(".e-fill-sec");c&&(s-=dr(c.textContent,t.cell.style,this.parent.cellStyle))}else{var u=e.querySelector(".e-addNoteIndicator"),d=e.querySelector(".e-hyperlink"),p=void 0,f=void 0,v=void 0;if(d||(d=e.querySelector(".e-databar-value"),d&&(v=!0)),d?f=e.querySelector(".e-cf-currency"):(d=e.querySelector(".e-wrap-content"),d||(d=e,p=!!l)),d.innerText="",t.beforeFillText){if(f)f.innerText=t.beforeFillText;else{var h=this.parent.createElement("span",{className:"e-fill-before",styles:"float: "+(this.parent.enableRtl?"right":"left")});h.innerText=t.beforeFillText,d.appendChild(h)}s-=dr(t.beforeFillText,t.cell.style,this.parent.cellStyle)}if(i=this.parent.createElement("span",{className:"e-fill"}),v){var m=e.querySelector(".e-cf-databar"),y=m.querySelector(".e-fill");y&&y.remove(),m.insertBefore(i,d)}else d.appendChild(i);if(t.afterFillText){var c=this.parent.createElement("span",{className:"e-fill-sec"});c.innerText=t.afterFillText,d.appendChild(c),s-=dr(t.afterFillText,t.cell.style,this.parent.cellStyle)}if(a){var b=e.querySelector(".e-wrap-content");b?b.insertBefore(a,b.childNodes[0]):e.insertBefore(a,e.childNodes[0])}p&&e.insertBefore(l,e.firstChild),u&&d.appendChild(u)}var S=dr(t.repeatChar,t.cell.style,this.parent.cellStyle),C=parseInt((s/S).toString(),10);if(C>0){if(t.formattedText=t.repeatChar.repeat(C),C>1&&!t.formattedText.startsWith("#")){var x=dr(t.formattedText,t.cell.style,this.parent.cellStyle),I=s-x,D=I/(C-1);i.style.letterSpacing=D+"px"}}else t.formattedText="";i.textContent=t.formattedText}},o.prototype.addEventListener=function(){this.parent.on(bM,this.refreshCellElement,this),this.parent.on(xg,this.rowFillHandler,this),this.parent.on(Zb,this.getTextSpace,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(bM,this.refreshCellElement),this.parent.off(xg,this.rowFillHandler),this.parent.off(Zb,this.getTextSpace))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"numberFormat"},o})(),nG=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(au,this.applySortHandler,this),this.parent.on(og,this.sortCompleteHandler,this),this.parent.on(c0,this.initiateCustomSortHandler,this),this.parent.on(Nb,this.sortImport,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(au,this.applySortHandler),this.parent.off(og,this.sortCompleteHandler),this.parent.off(c0,this.initiateCustomSortHandler),this.parent.off(Nb,this.sortImport))},o.prototype.getModuleName=function(){return"sort"},o.prototype.isValidSortRange=function(){var t=this.parent.getActiveSheet(),e=tt(Ji(t.selectedRange));return!(e[0]>t.usedRange.rowIndex||e[1]>t.usedRange.colIndex)},o.prototype.sortImport=function(t){for(var e=this.parent.sortCollection,i,r=this.parent.getActiveSheet().usedRange.rowIndex-1,n=t?t.sheetIdx:this.parent.activeSheetIndex,s=0;s<e.length;s++)if(e[s].sheetIndex===n){for(var a=0;a<r;a++)if(i=this.parent.getCell(a,e[s].columnIndex),i&&i.querySelector(".e-filter-icon")){e[s].order==="Ascending"||e[s].order==="OnTop"?i.querySelector(".e-filter-icon").classList.contains("e-sortasc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"):i.querySelector(".e-filter-icon").classList.contains("e-sortdesc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter");return}}},o.prototype.sortRangeAlertHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(jt),r=this.parent.serviceLocator.getService(ve);i.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:t.error,enableRtl:this.parent.enableRtl,beforeOpen:function(n){var s={dialogName:t.error===r.getConstant("MultiRangeSortError")?"MultiRangeSortDialog":"SortRangeDialog",content:t.error,element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel?n.cancel=!0:(i.dialogInstance.content=s.content,Re(e.parent.element))}}),this.parent.hideSpinner()},o.prototype.initiateCustomSortHandler=function(){var t=this,e=this.parent.serviceLocator.getService(ve),i=this.parent.getActiveSheet();if(!this.isValidSortRange()||i.rows.length===0){this.sortRangeAlertHandler({error:e.getConstant("SortOutOfRangeError")});return}if(YD(i.selectedRange)){this.sortRangeAlertHandler({error:e.getConstant("MultiRangeSortError")});return}var r=this.parent.serviceLocator.getService(jt),n;r.show({height:400,width:560,isModal:!0,showCloseIcon:!0,cssClass:"e-customsort-dlg",header:e.getConstant("CustomSort"),enableRtl:this.parent.enableRtl,beforeOpen:function(s){var a={dialogName:"CustomSortDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",a),a.cancel?s.cancel=!0:(r.dialogInstance.content=t.customSortContent(),r.dialogInstance.dataBind(),Re(t.parent.element))},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){var s=r.dialogInstance.content,a=ot(s.getElementsByClassName("e-list-sort e-listview e-lib")[0],"listview"),l=a.dataSource;t.clearError();var h=s.getElementsByClassName("e-sort-error")[0];h.style.display="block",t.validateError(l,s,h)||(n={sortDescriptors:l,containsHeader:s.getElementsByClassName("e-sort-checkheader")[0].checked,caseSensitive:s.getElementsByClassName("e-sort-checkcase")[0].checked},r.hide())}}],close:function(){n&&er(function(){return t.applySortHandler({sortOptions:n})})}})},o.prototype.validateError=function(t,e,i){var r=this.parent.serviceLocator.getService(ve),n=t.some(function(d){return d.field.toString()===""});if(n)return Array.prototype.some.call(e.getElementsByClassName("e-sort-field"),function(d){var p=!ot(d,"dropdownlist").value;return p&&d.parentElement.classList.add("e-error"),p}),i.innerText=r.getConstant("SortEmptyFieldError"),!0;var s=new Set,a="",l=t.some(function(d){return a=d.field.toString(),s.size===s.add(d.field).size}),h="";if(l){var c=0;Array.prototype.some.call(e.getElementsByClassName("e-sort-field"),function(d){var p=ot(d,"dropdownlist");return p.value===a&&(d.parentElement.classList.add("e-error"),h=p.text,c++),c===2}),i.innerText="";var u=this.parent.createElement("strong");return u.innerText=h,i.appendChild(u),i.appendChild(document.createTextNode(r.getConstant("SortDuplicateFieldError"))),!0}return!1},o.prototype.customSortContent=function(){var t=this.parent.createElement("div",{className:"e-sort-dialog"}),e=this.getFields(),i=Lt("customSort"),r=this.getCustomListview(i);this.setHeaderTab(t,r,e);var n=this.parent.createElement("div",{className:"e-sort-listsection",styles:""});t.appendChild(n);var s=this.parent.createElement("div",{className:"e-list-sort",styles:""});n.appendChild(s),r.createElement=this.parent.createElement,r.appendTo(s),s.removeAttribute("tabindex"),this.renderListItem(i,r,!0,e);var a=this.parent.createElement("div",{className:"e-sort-error"});return t.appendChild(a),t},o.prototype.getFields=function(){var t=this.parent.getActiveSheet(),e=tt(Ji(t.selectedRange));if(e[0]===e[2]&&e[2]-e[0]===0){e[0]=0,e[1]=0,e[3]=t.usedRange.colIndex;var i={filterRange:[],hasFilter:!1};this.parent.notify(ou,i),i.hasFilter&&i.filterRange&&(e[0]=i.filterRange[0])}var r=[],n,s;for(e[1];e[1]<=e[3];e[1]++){var a=Q(e[0],e[1],t);if(s="Column "+ji(e[1]+1),a&&a.value){if(n=a.value,a.format){var l={formattedText:n,value:n,format:a.format,rowIndex:e[0],colIndex:e[1]};this.parent.notify(yr,l),n=l.formattedText}}else n=s;r.push({text:n,value:s})}return r},o.prototype.setHeaderTab=function(t,e,i){var r=this,n=this.parent.serviceLocator.getService(ve),s=this.parent.createElement("div",{className:"e-sort-header"});t.appendChild(s);var a=this.parent.createElement("button",{className:"e-btn e-sort-addbtn e-flat",attrs:{type:"button"}});a.innerText=n.getConstant("AddColumn");var l=this.parent.element.querySelector(".e-customsort-dlg .e-footer-content");l.insertBefore(a,l.firstElementChild),a.addEventListener("click",function(){if(e){var p=Lt("customSort");e.addItem([{id:p,text:n.getConstant("ThenBy"),field:"",order:"ascending"}]),r.renderListItem(p,e,h.checked,i,!0)}});var h=new ma({label:n.getConstant("ContainsHeader"),checked:!0,enableRtl:this.parent.enableRtl,change:function(p){var f=p.checked?{text:"text",value:"value"}:{text:"value"};Array.prototype.forEach.call(t.getElementsByClassName("e-sort-field e-dropdownlist e-lib"),function(v){var m=ot(v,"dropdownlist");m.dataSource=null,m.dataSource=i,m.fields=f,m.dataBind()})},cssClass:"e-sort-headercheckbox"}),c=this.parent.createElement("input",{className:"e-sort-checkheader",attrs:{type:"checkbox"}});s.appendChild(c),h.createElement=this.parent.createElement,h.appendTo(c);var u=new ma({label:n.getConstant("CaseSensitive"),checked:!1,cssClass:"e-sort-casecheckbox",enableRtl:this.parent.enableRtl}),d=this.parent.createElement("input",{className:"e-sort-checkcase",attrs:{type:"checkbox"}});s.appendChild(d),u.createElement=this.parent.createElement,u.appendTo(d)},o.prototype.getCustomListview=function(t){var e=this.parent.serviceLocator.getService(ve),i=[{id:t,text:e.getConstant("SortBy"),field:"",order:"ascending"}];PL(!1);var r=new hf({dataSource:i,fields:{id:"id"},height:"100%",enableRtl:this.parent.enableRtl,template:fa(function(n){return'<div class="e-sort-listwrapper">'+('<span class="text">'+n.text+"</span>")+'<div class="e-sort-row"><div class="e-sort-field"></div><div class="e-sort-order">'+('<span class="e-sort-ordertxt" style="display:none;">'+n.order+"</span></div>")+'<span class="e-icons e-sort-delete" tabindex="0"></span></div>'}),cssClass:"e-sort-template"});return r},o.prototype.deleteHandler=function(t,e){var i=t.getElementsByClassName("e-sort-delete")[0];i.addEventListener("click",function(){t&&e.removeItem(t)})},o.prototype.renderListItem=function(t,e,i,r,n){var s=this,a=this.parent.serviceLocator.getService(ve),l=e.element.querySelector("li[data-uid="+t+"]"),h=i?{text:"text",value:"value"}:{text:"value"},c=l.getElementsByClassName("e-sort-field")[0],u=new $s({dataSource:r,enableRtl:this.parent.enableRtl,width:"auto",cssClass:"e-sort-field-ddl",fields:h,placeholder:a.getConstant("SelectAColumn"),change:function(S){S.value&&(Array.prototype.some.call(e.dataSource,function(C){return C.id===t&&(C.field=S.value.toString().replace("Column ","")),C.id===t}),s.clearError())}});u.createElement=this.parent.createElement,u.appendTo(c),n||(u.index=0);var d=l.getElementsByClassName("e-sort-order")[0],p=d.getElementsByClassName("e-sort-ordertxt")[0],f=p.innerText.toLocaleLowerCase()==="ascending",v=new Ou({label:a.getConstant("SortAscending"),enableRtl:this.parent.enableRtl,name:"sortAZ_"+t,value:"ascending",checked:f,cssClass:"e-sort-radiobutton",change:function(S){s.setRadioBtnValue(e,t,S.value)}}),m=this.parent.createElement("input",{id:"orderAsc_"+t,className:"e-sort-radioasc",styles:"",attrs:{type:"radio"}});d.appendChild(m),v.createElement=this.parent.createElement,v.appendTo(m);var y=new Ou({label:a.getConstant("SortDescending"),enableRtl:this.parent.enableRtl,name:"sortAZ_"+t,value:"descending",checked:!f,cssClass:"e-sort-radiobutton",change:function(S){s.setRadioBtnValue(e,t,S.value)}}),b=this.parent.createElement("input",{id:"orderDesc_"+t,className:"e-sort-radiodesc",styles:"",attrs:{type:"radio"}});d.appendChild(b),y.createElement=this.parent.createElement,y.appendTo(b),this.deleteHandler(l,e)},o.prototype.setRadioBtnValue=function(t,e,i){i&&Array.prototype.some.call(t.dataSource,function(r){return r.id===e&&(r.order=i),r.id===e})},o.prototype.clearError=function(){var t=document.getElementsByClassName("e-sort-dialog")[0],e=t.getElementsByClassName("e-sort-error")[0];e.style.display!=="none"&&e.innerHTML!==""&&(e.style.display="none",Array.prototype.forEach.call(t.getElementsByClassName("e-error"),function(i){i.classList.remove("e-error")}))},o.prototype.applySortHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r=t&&t.range||i.selectedRange,n=tt(Ji(r)),s=t&&t.sortOptions||{sortDescriptors:{}},a=n[0]===n[2],l={filterRange:[],hasFilter:!1,sheetIdx:this.parent.activeSheetIndex};this.parent.notify(ou,l),l.hasFilter&&(a?Vo(l.filterRange,n[0],n[1]):l.filterRange[0]===n[0]&&(this.parent.element.querySelector(".e-selectall.e-highlight")||n[1]>=l.filterRange[1]&&n[1]<=l.filterRange[3]||n[3]>=l.filterRange[1]&&n[3]<=l.filterRange[3]))&&(n[0]=l.filterRange[0],n[1]=l.filterRange[1],n[2]=i.usedRange.rowIndex,n[3]=i.usedRange.colIndex,s.containsHeader=!l.allowHeaderFilter,a=!1),r=Ve(n);var h={range:r,sortOptions:s,cancel:!1};if(this.parent.trigger(NY,h),!h.cancel){this.parent.notify(hi,{eventArgs:h,action:"beforeSort"}),this.parent.showSpinner();var c=new Promise(function(d){d((function(){})())}),u={args:{range:h.range,sortOptions:h.sortOptions,checkForHeader:a&&r!==h.range},promise:c,previousSort:t&&t.previousSort};this.parent.notify(bg,u),u.promise.then(function(d){return e.sortCompleteHandler(d),e.parent.trigger(og,d),e.parent.notify(wt,{eventArgs:d,action:"sorting"}),document.activeElement.tagName==="BODY"&&Re(e.parent.element),Promise.resolve(d)}).catch(function(d){return e.sortRangeAlertHandler({error:d}),Promise.reject(d)})}},o.prototype.sortCompleteHandler=function(t){var e,i,r=this.parent.activeSheetIndex;if(t.range.includes("!")){var n=t.range.lastIndexOf("!");r=Ct(this.parent,t.range.substring(0,n)),e=ke(this.parent,r),i=ie(t.range.substring(n+1))}else e=this.parent.getActiveSheet(),i=ie(t.range);for(var s=i[0];s<=i[2];s++)for(var a=i[1];a<=i[3];a++)this.parent.notify(At,{action:"refreshCalculate",rowIndex:s,colIndex:a});this.parent.serviceLocator.getService("cell").refreshRange(i,!0,!0,!1,!1,xs(this.parent),void 0,void 0,void 0,!0),r===this.parent.activeSheetIndex&&e.conditionalFormats&&e.conditionalFormats.length&&this.parent.notify(Gi,{indexes:i}),this.parent.hideSpinner(),this.parent.notify(y0,null)},o})(),sG=(function(){function o(t){this.parent=t,this.filterCollection=new Map,this.filterRange=new Map,this.filterBtn=t.createElement("div",{className:"e-filter-btn e-control e-btn e-lib e-filter-iconbtn e-icon-btn"+(this.parent.enableRtl?" e-rtl":"")}),this.filterBtn.appendChild(t.createElement("span",{className:"e-btn-icon e-icons e-filter-icon"})),this.addEventListener()}return o.prototype.destroy=function(){var t=this;this.removeEventListener(),this.parent.refreshing&&this.filterRange.size&&(this.parent.filterCollection=[],this.filterRange.forEach(function(i,r){t.setFilteredCollection({sheetIdx:r,saveJson:{filterCollection:t.parent.filterCollection}})})),this.filterRange=null,this.filterCollection=null,this.filterBtn&&this.filterBtn.remove(),this.filterBtn=null,this.treeViewObj&&this.treeViewObj.destroy(),this.treeViewObj=null,this.treeViewEle&&this.treeViewEle.remove(),this.treeViewEle=null,this.cBox&&(this.cBox.remove(),this.cBox=null);var e=document.querySelectorAll(".e-filter-popup");e&&e.forEach(function(i){i.remove()}),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(rz,this.filterRangeAlertHandler,this),this.parent.on(Yo,this.initiateFilterUIHandler,this),this.parent.on(Bl,this.filterMouseDownHandler,this),this.parent.on(Cd,this.renderFilterCellHandler,this),this.parent.on(y0,this.refreshFilterRange,this),this.parent.on(Zc,this.updateSortCollectionHandler,this),this.parent.on(Xy,this.beforeFilterMenuOpenHandler,this),this.parent.on($y,this.closeDialog,this),this.parent.on(b0,this.reapplyFilterHandler,this),this.parent.on(dD,this.filterByCellValueHandler,this),this.parent.on(Rg,this.clearFilterHandler,this),this.parent.on(S0,this.getFilteredColumnHandler,this),this.parent.on(eu,this.cMenuBeforeOpenHandler,this),this.parent.on(Ky,this.filterCboxValueHandler,this),this.parent.on(ou,this.getFilterRangeHandler,this),this.parent.on(C0,this.filterCellKeyDownHandler,this),this.parent.on(kb,this.setFilteredCollection,this),this.parent.on(Ln,this.updateFilter,this),this.parent.on(Ed,this.beforeInsertHandler,this),this.parent.on(wg,this.beforeDeleteHandler,this),this.parent.on(ka,this.deleteSheetHandler,this),this.parent.on(Hd,this.clearHandler,this),this.parent.on(Gf,this.filterDialogCreatedHandler,this),this.parent.on(xh,this.removeFilterClass,this),this.parent.on(RM,this.duplicateSheetFilterHandler,this),this.parent.on(Dc,this.beforeFilteringHandler,this),this.parent.on(Qy,this.customFilterOpen,this),this.parent.on(PM,this.moveSheetHandler,this),this.parent.on(u0,this.refreshFilterCellsOnResize,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(rz,this.filterRangeAlertHandler),this.parent.off(Yo,this.initiateFilterUIHandler),this.parent.off(Bl,this.filterMouseDownHandler),this.parent.off(Cd,this.renderFilterCellHandler),this.parent.off(y0,this.refreshFilterRange),this.parent.off(Zc,this.updateSortCollectionHandler),this.parent.off(Xy,this.beforeFilterMenuOpenHandler),this.parent.off($y,this.closeDialog),this.parent.off(b0,this.reapplyFilterHandler),this.parent.off(dD,this.filterByCellValueHandler),this.parent.off(Rg,this.clearFilterHandler),this.parent.off(S0,this.getFilteredColumnHandler),this.parent.off(eu,this.cMenuBeforeOpenHandler),this.parent.off(Ky,this.filterCboxValueHandler),this.parent.off(ou,this.getFilterRangeHandler),this.parent.off(C0,this.filterCellKeyDownHandler),this.parent.off(kb,this.setFilteredCollection),this.parent.off(Ln,this.updateFilter),this.parent.off(Ed,this.beforeInsertHandler),this.parent.off(wg,this.beforeDeleteHandler),this.parent.off(ka,this.deleteSheetHandler),this.parent.off(Hd,this.clearHandler),this.parent.off(Gf,this.filterDialogCreatedHandler),this.parent.off(xh,this.removeFilterClass),this.parent.off(RM,this.duplicateSheetFilterHandler),this.parent.off(Dc,this.beforeFilteringHandler),this.parent.off(Qy,this.customFilterOpen),this.parent.off(PM,this.moveSheetHandler),this.parent.off(u0,this.refreshFilterCellsOnResize))},o.prototype.getModuleName=function(){return"filter"},o.prototype.isInValidFilterRange=function(t,e){var i=tt(Ji(e||t.selectedRange)),r=!1;return t.usedRange.colIndex===0&&t.usedRange.rowIndex===0&&g(t.rows[t.usedRange.rowIndex])&&(r=!0),i[0]>t.usedRange.rowIndex||i[1]>t.usedRange.colIndex||r},o.prototype.filterRangeAlertHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(jt);i.show({content:t.error,isModal:!0,height:180,width:400,showCloseIcon:!0,beforeOpen:function(r){var n={dialogName:"FilterRangeDialog",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel?r.cancel=!0:Re(e.parent.element)}}),this.parent.hideSpinner()},o.prototype.beforeFilterMenuOpenHandler=function(t){var e=this.parent.serviceLocator.getService(ve);t.element.classList.add("e-spreadsheet-contextmenu");var i=t.element.querySelector("ul");this.addMenuItem(i,e.getConstant("SortDescending"),"e-filter-sortdesc","e-sort-desc"),this.addMenuItem(i,e.getConstant("SortAscending"),"e-filter-sortasc","e-sort-asc"),t.element.appendChild(i)},o.prototype.addMenuItem=function(t,e,i,r){var n=this.parent.createElement("li",{className:i+" e-menu-item"});this.parent.allowSorting||n.classList.add("e-disabled"),n.innerText=e,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r}),n.firstChild),t.insertBefore(n,t.firstChild)},o.prototype.initiateFilterUIHandler=function(t){var e=this,i=t?t.predicates:null,r=t.sIdx;!r&&r!==0&&(r=t.isOpen?0:this.parent.activeSheetIndex);var n;t.promise&&(n=new zn,t.promise=n.promise);var s=function(){n&&n.resolve()},a=t.isInternal||t.isCut;if(this.filterRange.size>0&&this.filterRange.has(r)&&!this.parent.isOpen&&!i){this.removeFilter(r,a,!1),s();return}var l=ke(this.parent,r);if(this.isInValidFilterRange(l,t.range)){var h=this.parent.serviceLocator.getService(ve);this.filterRangeAlertHandler({error:h.getConstant("FilterOutOfRangeError")}),s();return}var c=t.range||l.selectedRange,u,d;if(!a){if(u={range:c,sheetIndex:r,cancel:!1,allowHeaderFilter:!1},t.predicates?(u.predicates=t.predicates,u.previousPredicates=this.filterCollection.get(r)&&[].slice.call(this.filterCollection.get(r))):u.filterOptions={predicates:t.predicates},u.useFilterRange=!1,d={action:"filter",eventArgs:u},this.parent.notify(hi,d),u.cancel){s();return}delete u.cancel,t.useFilterRange=u.useFilterRange,t.allowHeaderFilter=u.allowHeaderFilter}if(!t.range&&(a||c===u.range)){var p=ie(c);p[0]===p[2]&&p[1]===p[3]&&(p=U0(p[0],p[1],l),c=Ve(p),a||(u.range=c))}else a||(c=u.range);if(i)if(i.length){var f=this.filterRange.get(r);f&&(t.useFilterRange=f.useFilterRange,t.allowHeaderFilter=f.allowHeaderFilter),this.processRange(l,r,c,!0,t.useFilterRange,t.allowHeaderFilter);var v=this.filterRange.get(r).range.slice();t.allowHeaderFilter||(v[0]=v[0]+1),t.useFilterRange||(v[2]=l.usedRange.rowIndex),v[1]=v[3]=Sn(i[0].field);var m=l.name+"!"+this.getPredicateRange(v,i.slice(1,i.length)),y=Ve(v);Aa(this.parent,m,!0,!0,null,!0,null,null,!1,y).then(function(b){e.filterSuccessHandler(new oe(b),{action:"filtering",filterCollection:i,field:i[0].field,sIdx:t.sIdx,isInternal:a,isOpen:t.isOpen,prevPredicates:u&&u.previousPredicates}),s()});return}else this.clearFilterHandler({sheetIndex:r}),s();else this.processRange(l,r,c,!1,t.useFilterRange,t.allowHeaderFilter),s();a||(this.parent.notify(wt,d),Re(this.parent.element))},o.prototype.processRange=function(t,e,i,r,n,s){var a=tt(Ji(i||t.selectedRange));a[0]===a[2]&&a[1]===a[3]?(a[0]=0,a[1]=0,a[2]=t.usedRange.rowIndex,a[3]=t.usedRange.colIndex):a[3]>t.usedRange.colIndex&&(a[3]=t.usedRange.colIndex);var l={useFilterRange:n,range:a};s&&(l.allowHeaderFilter=s),this.filterRange.set(e,l),this.filterCollection.set(e,[]),r||this.refreshFilterRange(a,!1,e)},o.prototype.removeFilter=function(t,e,i,r){var n=this.filterRange.get(t),s=n.range.slice(),a=n.allowHeaderFilter,l=Ve(s),h;if(!e){if(h={action:"filter",eventArgs:{range:l,sheetIndex:t,cancel:!1},isClearAction:r},this.parent.notify(hi,h),h.eventArgs.cancel)return;delete h.eventArgs.cancel}if(this.filterCollection.get(t).length||i){if(this.filterCollection.get(t).length&&r&&!e){var c={action:"filter",eventArgs:{range:l,sheetIndex:t,predicates:[],previousPredicates:this.filterCollection.get(t)},isClearAction:r};this.parent.notify(wt,c)}this.clearFilterHandler({preventRefresh:i,sheetIndex:t})}this.filterRange.delete(t),this.filterCollection.delete(t),this.refreshFilterRange(s,!0,t,a),e||this.parent.notify(wt,h)},o.prototype.filterByCellValueHandler=function(){var t=this,e=this.parent.activeSheetIndex,i=this.parent.getActiveSheet();if(this.isInValidFilterRange(i)){var r=this.parent.serviceLocator.getService(ve);this.filterRangeAlertHandler({error:r.getConstant("FilterOutOfRangeError")});return}var n=ie(i.activeCell),s;this.isFilterRange(e,n[0],n[1])||(s=!0,this.processRange(i,e));var a=this.filterRange.get(e),l=a.range.slice(),h=Ve(l);l[0]=l[0]+1,l[2]=i.usedRange.rowIndex,l[1]=l[3]=n[1];var c=ji(n[1]+1),u=Q(n[0],n[1],i),d=n0(this.parent,u,n[0],n[1],e),p=[{field:c,operator:"equal",type:this.getColumnType(i,n[1],n).type,matchCase:!1,value:d}],f=[].slice.call(this.filterCollection.get(e));f.length||(f=void 0);var v={range:h,predicates:p,previousPredicates:f,sheetIndex:e,cancel:!1,allowHeaderFilter:!1};if(this.parent.notify(hi,{action:"filter",eventArgs:v}),v.cancel){s&&this.removeFilter(e,!0);return}v.allowHeaderFilter&&(a.allowHeaderFilter=v.allowHeaderFilter,l[0]--);var m=i.name+"!"+this.getPredicateRange(l,this.filterCollection.get(e)),y=Ve(l);Aa(this.parent,m,!0,!0,null,!0,null,null,!1,y).then(function(b){t.filterSuccessHandler(new oe(b),{action:"filtering",filterCollection:p,field:c,isFilterByValue:!0})})},o.prototype.renderFilterCellHandler=function(t){var e=g(t.sIdx)?this.parent.activeSheetIndex:t.sIdx;if(e===this.parent.activeSheetIndex){var i=this.filterRange.get(e)&&this.filterRange.get(e),r=i&&i.range;if(r&&(r[0]===t.rowIndex||i.allowHeaderFilter)&&r[1]<=t.colIndex&&r[3]>=t.colIndex){if(!t.td||t.td.classList.contains(i.allowHeaderFilter?"e-cell":"e-header-cell"))return;for(var n=t.td.querySelector(".e-filter-icon"),s="",a=this.parent.sortCollection,l=ji(t.colIndex+1),h=this.filterCollection.get(e),c=0;c<h.length;c++)if(h[c].field===l){s=" e-filtered";break}if(a){for(var c=0;c<a.length;c++)if(a[c].sheetIndex===e&&a[c].columnIndex===t.colIndex){s+=a[c].order==="Ascending"?" e-sortasc-filter":" e-sortdesc-filter";break}}if(n)n.className="e-btn-icon e-icons e-filter-icon"+s;else{var u=!1;if(n=this.filterBtn.cloneNode(!0),t.td.children.length>0&&t.td.children[t.td.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&(t.td.removeChild(t.td.children[t.td.childElementCount-1]),u=!0),n.firstElementChild.className="e-btn-icon e-icons e-filter-icon"+s,t.td.insertBefore(n,t.td.firstChild),t.isAction){var d=ke(this.parent,e);Q(t.rowIndex,t.colIndex,d,!1,!0).wrap&&this.parent.notify(HD,{rowIdx:t.rowIndex,colIdx:t.colIndex,sheet:d,ele:t.td})}u&&this.parent.notify(Zd,{targetElement:t.td,rowIndex:t.rowIndex,columnIndex:t.colIndex})}}}},o.prototype.refreshFilterRange=function(t,e,i,r){var n=i;!n&&n!==0&&(n=this.parent.activeSheetIndex);var s=this.filterRange&&this.filterRange.get(n);s?(t=t||s.range.slice(),r=s.allowHeaderFilter):t||(t=[0,0,0,0]);for(var a=t,l,h=ke(this.parent,n),c=this.parent.frozenColCount(h),u=a[1];u<=a[3];u++){if(r){var d=u<c?this.parent.sheetModule.getSelectAllTable():this.parent.getColHeaderTable(),p=d&&this.parent.getRow(0,d);l=p&&this.parent.getCell(0,u,p)}else lt(h,a[0])?l=null:l=this.parent.getCell(a[0],u);if(e){if(l){var f=l.querySelector(".e-filter-btn");if(f){var v=!1;l.children.length>0&&l.children[l.childElementCount-1].className.indexOf("e-addNoteIndicator")>-1&&(l.removeChild(l.children[l.childElementCount-1]),v=!0),f.parentElement.removeChild(f),v&&this.parent.notify(Zd,{targetElement:l,rowIndex:a[0],columnIndex:u})}}}else this.renderFilterCellHandler({td:l,rowIndex:a[0],colIndex:u,sIdx:n,isAction:!0})}this.parent.sortCollection&&this.parent.notify(Nb,null)},o.prototype.isFilterCell=function(t,e,i){var r=this.filterRange.has(t)&&this.filterRange.get(t).range;return r&&r[0]===e&&r[1]<=i&&r[3]>=i},o.prototype.isFilterRange=function(t,e,i){var r=this.filterRange.get(t)&&this.filterRange.get(t).range;return r&&r[0]<=e&&r[2]>=e&&r[1]<=i&&r[3]>=i},o.prototype.getFilteredColumnHandler=function(t){var e=Te(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,i=this.parent.serviceLocator.getService(ve);if(t.clearFilterText=i.getConstant("ClearFilter"),this.filterRange.has(e)){var r=this.filterCollection.get(e);if(t.isClearAll){t.isFiltered=r&&r.length>0;return}var n=this.filterRange.get(e).range.slice(),s=ke(this.parent,e),a=xe(s.activeCell);if(this.isFilterRange(e,a[0],a[1])){t.field=ji(a[1]+1);var l=Q(n[0],a[1],s),h=this.parent.getDisplayText(l);t.clearFilterText=i.getConstant("ClearFilterFrom")+'"'+(h?h.toString():"Column "+t.field)+'"',r.some(function(c){return t.isFiltered=c.field===t.field,t.isFiltered})}}},o.prototype.cMenuBeforeOpenHandler=function(t){var e=this.parent.element.id+"_cmenu";if(t.parentItem&&t.parentItem.id===e+"_filter"&&t.target===""){var i={isFiltered:!1};this.getFilteredColumnHandler(i),this.parent.enableContextMenuItems([e+"_clearfilter",e+"_reapplyfilter"],!!i.isFiltered,!0)}},o.prototype.closeDialog=function(){var t=document.querySelector(".e-filter-popup");if(t&&t.id.includes(this.parent.element.id)){var e=ot(t,"dialog");T.remove(t,tp(),this.filterMouseDownHandler),e&&e.hide(),this.parent.notify(xh,null)}},o.prototype.removeFilterClass=function(){this.parent.element.style.position==="relative"&&(this.parent.element.style.position=""),this.parent.element.classList.contains("e-filter-open")&&this.parent.element.classList.remove("e-filter-open")},o.prototype.isPopupOpened=function(){var t=document.getElementsByClassName("e-filter-popup")[0];return t&&t.id.includes(this.parent.element.id)&&t.style.display!=="none"},o.prototype.filterCellKeyDownHandler=function(t){var e=this.parent.getActiveSheet(),i=xe(e.activeCell);if(this.isFilterCell(this.parent.activeSheetIndex,i[0],i[1])){if(t.closePopup)this.closeDialog();else if(t.isFilterCell=!0,!this.isPopupOpened()){var r=this.parent.getCell(i[0],i[1]);r&&this.openDialog(r)}}},o.prototype.filterMouseDownHandler=function(t){if(!(j.isDevice&&t.type==="mousedown"||this.parent.getActiveSheet().isProtected)){var e=t.target;if(e.classList.contains("e-filter-icon")||e.classList.contains("e-filter-btn"))j.isDevice&&Oc(t)&&t.preventDefault(),this.isPopupOpened()&&this.closeDialog(),this.openDialog(Fr(e,"e-cell")||Fr(e,"e-header-cell"));else if(this.isPopupOpened()){var i=e.offsetParent;!e.classList.contains("e-searchinput")&&!e.classList.contains("e-searchclear")&&i&&!i.classList.contains("e-filter-popup")&&!i.classList.contains("e-text-content")&&!i.classList.contains("e-checkboxtree")&&!i.classList.contains("e-checkbox-wrapper")?this.closeDialog():this.selectSortItemHandler(e)}}},o.prototype.cboxListSelected=function(t,e,i,r,n){var s=Fr(r.target,"e-ftrchk");if(s){var a=n&&s.querySelector(".e-add-current");if(a)return a.classList.contains("e-check")?(Ai(a,["e-uncheck"],["e-check"]),e.length||(t.btnObj.element.disabled=!0),!1):(Ai(a,["e-check"],["e-uncheck"]),t.btnObj.element.disabled=!1,!0);var l=s.querySelector(".e-selectall");if(l){s.querySelector(".e-chk-hidden").indeterminate=!1;for(var h=s.querySelector(".e-frame").classList.contains("e-check"),c=void 0,u=void 0,d=n?2:1,p=t.element.childElementCount;d<p;d++)c=t.element.children[d].querySelector(".e-frame"),Z([c],["e-check","e-stop","e-uncheck"]),h?(t.element.children[d].querySelector(".e-chk-hidden").checked=!1,c.classList.add("e-uncheck"),e.splice(0,1)):(t.element.children[d].querySelector(".e-chk-hidden").checked=!0,c.classList.add("e-check"),u=t.element.children[d].querySelector(".e-checkboxfiltertext").textContent,e.indexOf(u)===-1&&e.push(u))}else{var u=s.querySelector(".e-checkboxfiltertext").textContent;s.querySelector(".e-frame").classList.contains("e-check")?e.splice(e.indexOf(u),1):e.push(u),Mc(s),l=t.element.querySelector(".e-selectall")}this.updateState(t,l,l.parentElement.querySelector(".e-chk-hidden"),e.length!==i,e.length)}return null},o.prototype.initCboxList=function(t,e,i){var r=this,n=t.column.field,s=new oe(t.dataSource).executeLocal(new Pe().sortBy(n+"_value","ascending")),a=[],l=this.parent.getActiveSheet(),h=this.parent.serviceLocator.getService(ve),c=document.createDocumentFragment(),u=this.createSelectAll(t,e);c.appendChild(u);var d={},p,f=[],v=[],m;s.forEach(function(k){if(k[n]===""){if(!d.isBlank){d.isBlank=!0;var B={};B[n]=h.getConstant("Blanks"),p=as(l,Number(k.__rowIndex)-1);var F=Ml(Ro("cbox"),e.createCheckbox(B[n],!p,B),"e-ftrchk");c.childElementCount===1?c.appendChild(F):c.insertBefore(F,c.children[1]),a.splice(0,0,B[n]),p||(f.push(B[n]),v.push(B[n]))}}else d[k[n]]||(d[k[n]]=!0,p=as(l,Number(k.__rowIndex)-1),m=k[n],c.appendChild(Ml(Ro("cbox"),e.createCheckbox(m,!p,k),"e-ftrchk")),a.push(m),p||(f.push(m),v.push(m)))}),t.element.appendChild(c);var y=u.querySelector(".e-frame");y.classList.add("e-selectall");var b=u.querySelector(".e-chk-hidden");this.updateState(t,y,b,v.length!==a.length,v.length);var S=[].slice.call(t.element.childNodes),C,x,I;t.element.addEventListener("click",function(k){if(C){var B=r.cboxListSelected(t,C,t.element.childElementCount-2,k,!0);B!==null&&(I=B)}else r.cboxListSelected(t,v,a.length,k)});var D,M,E=function(k){if(k.toLowerCase().includes(M)){var B={};B[t.column.field]=k,c.appendChild(Ml(Ro("cbox"),e.createCheckbox(k,!0,B),"e-ftrchk")),x.push(k),C.push(k)}},A,L=t.dataSource.length>1e3?t.dataSource.length:1e3,N=a;i.length<=L?A=function(){a.forEach(function(k){E(k)})}:A=function(){D||(N=[],f=[],v=[],D=new oe(i).executeLocal(new Pe().sortBy(n+"_value","ascending")),d={},D.forEach(function(F){F[n]===""?d.isBlank||(d.isBlank=!0,m=h.getConstant("Blanks"),N.splice(0,0,m),as(l,Number(F.__rowIndex)-1)||(f.push(m),v.push(m))):d[F[n]]||(m=F[n],d[m]=!0,N.push(F[n]),as(l,Number(F.__rowIndex)-1)||(v.push(m),f.push(m)))}));for(var k=0,B=N.length;k<B&&x.length<L;k++)E(N[k])};var R=function(k){if(k.event.type==="keyup")M=k.event.target.value.toLowerCase();else if(k.event.target.classList.contains("e-search-icon"))return;if(c=document.createDocumentFragment(),c.appendChild(u),M)if(x=[],C=[],A(),C.length){r.updateState(t,y,b,!1,0),u.classList.remove("e-hide");var B={};B[n]=h.getConstant("AddCurrentSelection");var F=Ml(Ro("cbox"),e.createCheckbox(B[n],!1,B),"e-ftrchk");c.insertBefore(F,c.children[1]),F.querySelector(".e-frame").classList.add("e-add-current")}else{u.classList.add("e-hide");var O=r.parent.createElement("div",{className:"e-checkfltrnmdiv"}),z=r.parent.createElement("span");z.innerText=h.getConstant("NoResult"),O.appendChild(z),c.appendChild(O),t.btnObj.element.disabled=!0}else S&&(C=null,x=null,r.updateState(t,y,b,v.length!==a.length,v.length),u.classList.remove("e-hide"),S.forEach(function(Y){c.appendChild(Y)}));t.element.innerHTML="",t.element.appendChild(c)},P=function(){if(x)if(I){var k=void 0,B=void 0;v=f;for(var F=0,O=x.length;F<O;F++)k=x[F],x.length===C.length||C.indexOf(k)>-1?v.indexOf(k)===-1&&v.push(k):(B=v.indexOf(k),B>-1&&v.splice(B,1))}else v=C;var z=v.length;if(z===a.length&&(!C||i.length<=L))r.filterSuccessHandler(new oe(t.dataSource),{action:"clear-filter",field:t.column.field});else{var Y=[],K={field:n,ignoreAccent:!1,matchCase:!1,isFilterByMenu:!0},U=Ki(r.parent.locale),q=function(ae){var te=t.type;te==="number"&&(ae===h.getConstant("Blanks")?(ae="",te="string"):De(Td([ae],r.parent,U)[0])||(te="string")),Y.push(Object.assign({value:ae,type:te},K))};if(z>N.length/2){K.operator="notequal",K.predicate="and";for(var F=0,O=N.length;F<O;F++)v.indexOf(N[F])===-1&&q(N[F])}else{K.operator="equal",K.predicate="or";for(var F=0,O=z;F<O;F++)q(v[F])}e.initiateFilter(Y)}};this.wireFilterEvents(t,P,R.bind(this))},o.prototype.createSelectAll=function(t,e){var i={};i[t.column.field]=this.parent.serviceLocator.getService(ve).getConstant("SelectAll");var r=Ml(Ro("cbox"),e.createCheckbox(i[t.column.field],!1,i),"e-ftrchk");return r},o.prototype.updateState=function(t,e,i,r,n){if(Z([e],["e-check","e-stop","e-uncheck"]),t.btnObj.element.disabled&&(t.btnObj.element.disabled=!1),r)if(n)e.classList.add("e-stop");else{e.classList.add("e-uncheck");var s=t.element.querySelector(".e-add-current");t.btnObj.element.disabled=!s||!s.classList.contains("e-check")}else e.classList.add("e-check");i.indeterminate=r,i.checked=!r},o.prototype.beforeFilteringHandler=function(t){var e=this;if(t.instance&&t.instance.options){if(t.isOpen&&t.instance.options.type==="string"){var i=Ki(this.parent.locale);if(i.decimal!=="."){var r=t.arg3.toString().split(".");if(r.length===2){var n=r.join(i.decimal);De(new Nt(this.parent.locale).parseNumber(n,{format:"n"}))&&(t.arg3=n)}}}var s=function(h,c){if(c&&(c==="notequal"||e.isCustomNumFilter(c)))if(h){if(De(h))h=parseFloat(h.toString());else if(typeof h=="string"){var u=function(C){if(!C.includes("/"))return!0;var x=C.trim().split(" ");if(x.length!==2||!De(x[0]))return!0;var I=x[1].split("/");return I.length===2&&De(I[0])&&De(I[1])&&parseFloat(I[1])!==0?(h=parseFloat(x[0])+parseFloat(I[0])/parseFloat(I[1]),!1):!0};if(u(h)){var d=Ki(e.parent.locale),p=new Nt(e.parent.locale),f={};if(h.includes(d.percentSign)){var v=h.trim().split("%");v[0]!==""&&!v[1]&&(f=Da({value:v[0]},e.parent.locale,d.group,d.decimal))}if(f.isNumber)h=Number(f.value)/100;else{var m=h.trim(),y={args:{updateValue:!0,cell:{value:m},value:m,curSymbol:nh(e.parent.locale,Ws),isEdit:!0},intl:p,fResult:m};e.parent.notify(mg,y);var b=y.args.cell.value;if(d.decimal!=="."&&!De(b)&&b.includes(d.decimal)&&(b=b.replace(d.decimal,".")),De(b))h=Number(b);else{var S={value:m,cell:{value:m}};e.parent.notify(Jr,S),(S.isTime||S.isDate)&&(h=parseFloat(S.updatedVal))}}}}}else c==="notequal"&&h===null&&(h="");else c==="equal"&&(De(h)?h=h.toString():typeof h=="string"&&De(s(h,"notequal"))?h=h.trim():h===null&&(h=""));return h};if(t.instance.options.type!=="date")t.arg3=s(t.arg3,t.arg2),t.arg8=s(t.arg8,t.arg7);else if(t.instance.options.format==="yMd"){var a=function(h,c){if(h)if(typeof h=="string"){var u=h.trim(),d={value:u,cell:{value:u}};if(e.parent.notify(Jr,d),d.isDate)h=c==="equal"?d.dateObj:parseFloat(d.updatedVal);else if(c==="equal"||c==="notequal"){var p=s(h,"notequal");De(p)?(t.instance.options.type="number",c==="notequal"&&(h=p)):t.instance.options.type="string"}}else _o(h)&&c!=="equal"&&(h=ls(h,!0));return h},l=document.querySelectorAll(".e-xlfl-valuediv input.e-datepicker");l.length===2?(t.arg3=a(t.arg3||l[0].value,t.arg2),t.arg8=a(t.arg8||l[1].value,t.arg7)):t.arg3&&(t.arg3=a(t.arg3,t.arg2))}}},o.prototype.customFilterOpen=function(t){for(var e=document.querySelectorAll(".e-xlfl-optrdiv input.e-dropdownlist"),i=[],r=0;r<e.length;r++){var n=ot(e[r],"dropdownlist");n&&i.push(n.value)}var s=[];if(i.length===2)for(var a=this.filterCollection.get(this.parent.activeSheetIndex),l=void 0,r=0;r<a.length;r++)a[r].field===t.column&&a[r].value!==null&&(l=i.indexOf(a[r].operator),l>-1&&(a[r].operator==="equal"&&_o(a[r].value)?s[l]=ls(a[r].value,!0).toString():s[l]=a[r].value.toString(),i[l]=""));var h=Ki(this.parent.locale),c=function(m){if(h.decimal!=="."&&De(m)){var y=m.toString();if(y.includes("."))return y.replace(".",h.decimal)}return m},u=document.querySelectorAll(".e-xlfl-valuediv input.e-ss-filter-input");if(u.length)for(var r=0;r<u.length;r++){var d=new dc({placeholder:this.parent.serviceLocator.getService(ve).getConstant("CustomFilterPlaceHolder")});s[r]&&(d.value=c(s[r])),d.appendTo(u[r])}else for(var p=document.querySelectorAll(".e-xlfl-valuediv input.e-datepicker"),f=void 0,v=void 0,r=0;r<p.length;r++)De(s[r])?v=this.parent.getDisplayText({value:s[r],format:cr("ShortDate")+(s[r].includes(".")?" "+cr("Time"):"")}):v=c(s[r]),f=ot(p[r],"datepicker"),f&&(f.value=v,p[r].value=v)},o.prototype.wireFilterEvents=function(t,e,i){var r=this;t.btnObj.element.addEventListener("click",e.bind(this)),t.searchBox.addEventListener("keydown",function(s){s.keyCode===13&&e()});var n=function(){r.parent.off(pz,i),r.parent.off(xh,n),Re(r.parent.element)};this.parent.on(xh,n,this),this.parent.on(pz,i,this)},o.prototype.initTreeView=function(t,e){var i=this,r=[],n=[],s={},a=[],l=[],h=[],c=[],u,d,p,f,v,m,y,b=["January","February","March","April","May","June","July","August","September","October","November","December"];if(this.parent.locale!=="en-US"){var S=ut.getDependables(Br,this.parent.locale,null).dateObject,C=S.months["stand-alone"]?S.months["stand-alone"].wide:{};Object.keys(C).length===12&&(b=Object.keys(C).map(Number).map(function(F){return C[F]}))}var x,I=!1,D=this.parent.getActiveSheet(),M=function(F){s[""+m]=!0,as(D,Number(F.__rowIndex)-1)?I=!0:r.push(m),n.push(m)};t.dataSource.forEach(function(F){f=F[t.column.field],typeof f=="object"&&Date.parse(f.toString())?(u=f.getFullYear().toString(),s[""+u]||(x={__rowIndex:u,hasChild:!0},x[t.column.field]=u,a.push(x),s[""+u]=!0),y=f.getMonth(),d=b[y],v=u+" "+d,s[""+v]||(x={__rowIndex:v,pId:u,hasChild:!0,month:y},x[t.column.field]=d,l.push(x),s[""+v]=!0),p=f.getDate(),m=v+" "+p.toString(),s[""+m]||(x={__rowIndex:m,pId:v},x[t.column.field]=p,h.push(x),M(F))):(!F[t.column.field]&&F[t.column.field]!==0?(m="blanks",u=i.parent.serviceLocator.getService(ve).getConstant("Blanks")):(m="text "+F[t.column.field].toString().toLowerCase(),u=F[t.column.field]),s[""+m]||(x={__rowIndex:m},x[t.column.field]=u,c.push(x),M(F)))}),a=new oe(a).executeLocal(new Pe().sortBy(t.column.field,"decending")),l=new oe(l).executeLocal(new Pe().sortBy("month","ascending")),h=new oe(h).executeLocal(new Pe().sortBy(t.column.field,"ascending")),h=a.concat(l.concat(h)),c.length&&(c=new oe(c).executeLocal(new Pe().sortBy(t.column.field,"ascending")),h=h.concat(c));var E=function(F){var O=[F.node];if(F.event.target.classList.contains("e-fullrow")||F.event.key==="Enter"){var z=k.getNode(F.node);z.isChecked==="true"?k.uncheckAll(O):k.checkAll(O)}},A=function(){R.indeterminate=!1,N.classList.contains("e-check")?(k.uncheckAll(),N.classList.add("e-uncheck"),R.checked=!1):(k.checkAll(),N.classList.add("e-check"),R.checked=!0)},L=this.createSelectAll(t,e);L.addEventListener("click",A.bind(this)),L.classList.add("e-spreadsheet-ftrchk");var N=L.querySelector(".e-frame");N.classList.add("e-selectall"),t.element.appendChild(L);var R=L.querySelector(".e-chk-hidden"),P=this.parent.createElement("div"),k=new CI({fields:{dataSource:h,id:"__rowIndex",parentID:"pId",text:t.column.field,hasChildren:"hasChild"},enableRtl:this.parent.enableRtl,showCheckBox:!0,cssClass:"e-checkboxtree",checkedNodes:r,nodeClicked:E.bind(this),keyPress:E.bind(this),nodeChecked:function(F){F.action!=="indeterminate"&&(I=k.checkedNodes.length!==k.fields.dataSource.length,i.updateState(t,N,R,I,k.checkedNodes.length))}});k.createElement=this.parent.createElement,k.appendTo(P),t.element.appendChild(P),r=k.checkedNodes,this.updateState(t,N,R,I,k.checkedNodes.length);var B=function(){k.checkedNodes.length===h.length?i.filterSuccessHandler(new oe(t.dataSource),{action:"clear-filter",field:t.column.field}):i.generatePredicate(k.checkedNodes,c.length?"string":t.type,t.column.field,e,n,k.checkedNodes.length>h.length/2)};this.treeViewObj=k,this.treeViewEle=P,this.cBox=R,this.wireFilterEvents(t,B,this.refreshCheckbox.bind(this,h,k,r))},o.prototype.generatePredicate=function(t,e,i,r,n,s){var a=this,l=[],h,c={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},u,d,p,f,v=function(){u[0]==="blanks"?l.push(Object.assign({value:"",type:e},h)):u[0]==="text"&&(u.splice(0,1),p=u.join(" "),isNaN(Number(p))?f="string":(p=Number(p),f="number"),l.push(Object.assign({value:p,type:f},h)))},m=function(){if(a.parent.locale!=="en-US"){var S=ut.getDependables(Br,a.parent.locale,null).dateObject;if(S.months&&S.months["stand-alone"]&&S.months["stand-alone"].wide){for(var C=Object.keys(S.months["stand-alone"].wide),x=0;x<C.length;x++)if(S.months["stand-alone"].wide[C[x]]===u[1]){c[u[1]]=Number(C[x])-1;break}}}d=new Date(Number(u[0]),c[u[1]],Number(u[2])),d.getDate()?l.push(Object.assign({value:d,type:e},h)):v()};if(s){h={field:i,ignoreAccent:!1,matchCase:!1,predicate:"and",operator:"notequal",isFilterByMenu:!0};for(var y=0,b=n.length;y<b;y++)t.indexOf(n[y])===-1&&(u=n[y].split(" "),m())}else{h={field:i,ignoreAccent:!1,matchCase:!1,predicate:"or",operator:"equal",isFilterByMenu:!0};for(var y=0,b=t.length;y<b;y++)u=t[y].split(" "),u.length===3?m():v()}r.initiateFilter(l)},o.prototype.refreshCheckbox=function(t,e,i,r){var n;if(r.event.type==="keyup")n=r.event.target.value;else if(r.event.target.classList.contains("e-search-icon"))return;var s,a=function(){if(s.length&&!e.fields.dataSource.length){var I=e.element.parentElement;I.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.remove("e-hide"),se(I.getElementsByClassName("e-checkfltrnmdiv")[0])}e.fields.dataSource=s,e.dataBind()};if(n){s=new oe(t).executeLocal(new Pe().where(new xt(e.fields.text,"contains",n,!0)));var l={},h=[],c=void 0,u=void 0,d=isNaN(Number(n)),p=void 0,f=void 0;if(d){for(var v=0;v<s.length;v++)s[v].hasChild&&(h.push(new xt("pId","equal",s[v].__rowIndex,!1)),c=s[v].pId,l[""+c]||(h.push(new xt("__rowIndex","equal",c,!1)),l[""+c]=!0));u=s,f=1}else{var m=void 0,y={};p=[];for(var v=0;v<s.length;v++)c=s[v].pId,c?(m=c.split(" ")[0],l[""+c]||(h.push(new xt("__rowIndex","equal",c,!1)),l[""+c]=!0,p.push(m),p.push(c)),y[""+m]||(l[""+m]||(h.push(new xt("__rowIndex","equal",m,!1)),l[""+m]=!0),h.push(new xt("__rowIndex","equal",s[v].__rowIndex,!1)))):(c=s[v].__rowIndex,y[""+c]||(h.push(new xt("__rowIndex","contains",c,!1)),y[""+c]=!0));u=[]}if(s.length){h.length&&(s=u.concat(new oe(t).executeLocal(new Pe().where(xt.or(h))))),a(),e.checkAll();var b=e.animation.expand.duration;e.animation.expand.duration=0,e.expandAll(p,f),e.animation.expand.duration=b}else if(e.fields.dataSource.length){a();var S=e.element.parentElement;S.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.add("e-hide");var C=this.parent.createElement("div",{className:"e-checkfltrnmdiv"}),x=this.parent.createElement("span");x.innerText=this.parent.serviceLocator.getService(ve).getConstant("NoResult"),C.appendChild(x),S.appendChild(C)}}else s=t,a(),e.checkedNodes=i,e.refresh()},o.prototype.openDialog=function(t){var e=this,i=parseInt(t.getAttribute("aria-colindex"),10),r=ji(i);this.parent.showSpinner();var n=this.parent.activeSheetIndex,s=this.filterRange.get(n),a=s.range.slice(),l=this.parent.getActiveSheet(),h=Q(a[0],i-1,l),c=this.parent.getDisplayText(h);s.allowHeaderFilter||(a[0]=a[0]+1),s.useFilterRange||(a[2]=l.usedRange.rowIndex);var u=[a[0],i-1,a[2],i-1],d=this.getPredicateRange(u,this.filterCollection.get(n),i-1),p=d.otherColPredicate,f,v=d.curPredicate;v.length&&(f={},f[r]=v);var m=l.name+"!"+d.address,y=Ve(u),b=this.getColumnType(l,i-1,a,!0),S=b.type,C,x=S==="date"||b.isDateAvail,I=S==="number",D=x||I,M=b.isMultiFormattedCol;D&&!d.filteredCol&&(C=[]),Aa(this.parent,m,!0,!0,null,!0,null,null,!0,y,null,C).then(function(E){var A;e.parent.element.style.position="relative",e.parent.element.classList.add("e-filter-open");var L;if(D){if(C||!p.length)A=new oe(C||E);else{var N=e.getPredicates(p),R=BM(new oe(E),N.predicates,N.equalOrPredicates);A=new oe(R)}var P=function(le){e.parent.off(dz,P),le.isCheckboxFilterTemplate=!0,x?e.initTreeView(le,K):e.initCboxList(le,K,E)};e.parent.on(dz,P,e),L=[]}else{if(p.length){var k=e.getPredicates(p),R=BM(new oe(E),k.predicates,k.equalOrPredicates);A=new oe(R)}else A=new oe(E);L=e.getClonedPredicates(v)}var B=t.querySelector(".e-filter-btn"),F={field:r,filter:{}};if(I){var O=e.parent;F.filterTemplate=function(le){if(O.isReact&&le)le.appendChild(O.createElement("input",{className:"e-ss-filter-input"}));else return[O.createElement("input",{className:"e-ss-filter-input"})]};var z=function(le){return function($,ee,He,qe,we,je,Ne){return le(Ne)}};F.getFilterTemplate=function(){return z(F.filterTemplate)},O.isReact&&!O.renderTemplates&&(O.renderTemplates=function(le){return le()})}var Y={type:S,field:r,format:S==="date"?"yMd":null,displayName:c||"Column "+r,dataSource:A||[],height:e.parent.element.classList.contains("e-bigger")?800:500,columns:[],hideSearchbox:!1,filteredColumns:L,column:F,handler:e.filterSuccessHandler.bind(e,new oe(E)),target:B,position:{X:0,Y:0},localeObj:e.parent.serviceLocator.getService(ve),actualPredicate:f,isFormatted:D&&!x,isMultiFormattedCol:M},K=new IR(e.parent,e.getLocalizedCustomOperators());K.openDialog(Y);var U=document.querySelector(".e-filter-popup");if(U&&U.id.includes(e.parent.element.id)){T.add(U,tp(),e.filterMouseDownHandler,e);var q=e.parent.element.getBoundingClientRect(),ae=B.getBoundingClientRect(),te=U.getBoundingClientRect(),he=ae.right-q.left-te.width;if(he<0&&(he=ae.left-q.left),j.isDevice){var ue=he+te.width-q.width;ue>0&&(he-=ue)}U.style.left=he*e.parent.viewport.scaleX+"px",U.style.top="0px",U.style.visibility="hidden",U.classList.contains("e-hide")&&U.classList.remove("e-hide");var ne=ae.bottom-q.top;te.height-(q.bottom-ae.bottom)>0&&(ne-=te.height-(q.bottom-ae.bottom),ne<0&&(ne=0)),U.style.top=ne*e.parent.viewport.scaleY+"px",U.style.visibility=""}e.parent.hideSpinner()})},o.prototype.getPredicateRange=function(t,e,i){var r=Ve(t),n,s=[],a=[];if(e&&e.length){var l,h;e.forEach(function(c){c.field&&(l=""+c.field+(t[0]+1)+":"+c.field+(t[2]+1),h=Sn(c.field),r.includes(l)||(r+=","+l,h<t[1]&&(t[1]=h),h>t[3]&&(t[3]=h)),i!==void 0&&(h===i?(n=!0,a.push(c)):s.push(c)))})}else n=!0;return i===void 0?r:{address:r,filteredCol:n,otherColPredicate:s,curPredicate:a}},o.prototype.filterDialogCreatedHandler=function(){var t=document.querySelector(".e-filter-popup");t&&t.id.includes(this.parent.element.id)&&t.classList.contains("e-popup-close")&&t.classList.add("e-hide")},o.prototype.filterCboxValueHandler=function(t){if(t.column&&t.data){var e=t.column.field;if(t.value){var i=xe(e+t.data.dataObj.__rowIndex),r=Q(i[0],i[1],this.parent.getActiveSheet());r&&r.format&&(t.value=this.parent.getDisplayText(r))}}},o.prototype.selectSortItemHandler=function(t){var e=this.parent.serviceLocator.getService(ve),i=t.classList.contains("e-filter-sortasc")?"Ascending":t.classList.contains("e-filter-sortdesc")?"Descending":null;if(i==="Ascending"?t.setAttribute("aria-label",e.getConstant("SortAscending")):t.setAttribute("aria-label",e.getConstant("SortDescending")),!!i){var r=this.parent.getActiveSheet(),n=this.parent.activeSheetIndex,s=this.filterRange.get(n),a=s.range.slice();if(s.allowHeaderFilter||(a[0]=a[0]+1),s.useFilterRange||(a[2]=r.usedRange.rowIndex),Hi(this.parent,a)){this.closeDialog(),this.parent.notify(fr,null);return}this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[];for(var l=[],h=this.parent.sortCollection.length-1;h>=0;h--)this.parent.sortCollection[h]&&this.parent.sortCollection[h].sheetIndex===n&&(l.push(this.parent.sortCollection[h]),this.parent.sortCollection.splice(h,1));this.parent.sortCollection.push({sortRange:Ve(a),columnIndex:Ji(r.activeCell)[1],order:i,sheetIndex:n}),this.parent.notify(au,{sortOptions:{sortDescriptors:{order:i},containsHeader:!1},previousSort:l,range:Ve(a)}),this.refreshFilterRange(),this.closeDialog()}},o.prototype.filterSuccessHandler=function(t,e){var i=e.sIdx;!i&&i!==0&&(i=e.isOpen?0:this.parent.activeSheetIndex);var r=e.prevPredicates||[].slice.call(this.filterCollection.get(i));e.isFilterByValue&&!r.length&&(r=void 0);var n=this.filterCollection.get(i);if(this.updatePredicate(n,e.field),!(e.action==="clear-filter"&&n.length===r.length)){if(e.action==="filtering"){var s=function(c){return c.map(function(u){return u&&typeof u.value=="string"&&u.value.includes("*")&&(u.value.startsWith("*")&&u.value.endsWith("*")?(u.value=u.value.split("*").join(""),u.operator="contains"):u.value.endsWith("*")?(u.value=u.value.split("*").join(""),u.operator="startswith"):u.value.startsWith("*")&&(u.value=u.value.split("*").join(""),u.operator="endswith")),u})};n=n.concat(s(e.filterCollection))}this.filterCollection.set(i,n);var a=this.getPredicates(n),l={datasource:t,predicates:a.predicates,equalOrPredicates:a.equalOrPredicates},h=this.filterRange.get(i);h.useFilterRange||(h.range[2]=ke(this.parent,i).usedRange.rowIndex),this.applyFilter(l,Ve(h.range),i,r,!1,e.isInternal,e.isFilterByValue)}},o.prototype.isCustomNumFilter=function(t){return t.includes("greaterthan")||t.includes("lessthan")||t==="between"},o.prototype.getClonedPredicates=function(t,e){e===void 0&&(e=[]);for(var i=[],r,n,s=0;s<t.length;s++)r=t[s],(this.isCustomNumFilter(r.operator)||!r.isFilterByMenu&&r.operator==="notequal")&&De(r.value)?(i.push(Object.assign({},r,{field:r.field+"_value",type:"number"})),n=!0):(!r.isFilterByMenu&&r.operator==="equal"&&r.predicate==="or"&&e.push(r.field),i.push(r));return!n&&e.length&&e.splice(0),i},o.prototype.updatePredicate=function(t,e){for(var i=new oe(t),r=new Pe,n=i.executeLocal(r.where("field","equal",e)),s=0;s<n.length;s++){for(var a=-1,l=0;l<t.length;l++)if(t[l].field===n[s].field){a=l;break}a!==-1&&t.splice(a,1)}},o.prototype.applyFilter=function(t,e,i,r,n,s,a){var l=this,h={range:e,predicates:[].slice.call(this.filterCollection.get(i)),previousPredicates:r,sheetIndex:i,cancel:!1};if(!(!s&&!a&&(this.parent.notify(hi,{action:"filter",eventArgs:h}),h.cancel))){e.indexOf("!")<0&&(e=this.parent.sheets[i].name+"!"+e),this.parent.showSpinner();var c=new Promise(function(f){f((function(){})())}),u={args:{range:e,filterOptions:t},promise:c,refresh:n},d=Nh(this.parent);this.parent.notify(Pb,u);var p=Nh(this.parent);this.parent.notify(A0,{prevChartIndexes:d,currentChartIndexes:p}),u.promise.then(function(f){return l.refreshFilterRange(),l.parent.hideSpinner(),s||(delete h.cancel,l.parent.notify(wt,{action:"filter",eventArgs:h}),document.activeElement.id!==l.parent.element.id+"_SearchBox"&&Re(l.parent.element)),Promise.resolve(f)}).catch(function(f){return l.filterRangeAlertHandler({error:f}),Promise.reject(f)})}},o.prototype.getPredicates=function(t){var e,i=[],r=this.getClonedPredicates(t,i);if(i.length){for(var n=void 0,s=void 0,a=new Map,l=0;l<r.length;l++)n=r[l].field.replace("_value",""),i.indexOf(n)>-1&&(s=r.splice(l,1)[0],l--,a.has(n)?a.get(n).push(s):a.set(n,[s]));e=[];var h;a.forEach(function(v){h=[];for(var m=Zy.getPredicate(v),y=0,b=Object.keys(m);y<b.length;y++){var S=b[y];h.push(m[""+S])}e.push(h)})}for(var c=[],u=Zy.getPredicate(r),d=0,p=Object.keys(u);d<p.length;d++){var f=p[d];c.push(u[""+f])}return{predicates:c,equalOrPredicates:e}},o.prototype.getColumnType=function(t,e,i,r){for(var n=0,s=0,a=0,l=0,h,c,u,d,p=i[0];p<=i[2];p++)if(h=Q(p,e,t),h&&!(r&&!(h.value||Number(h.value)===0))){if(h.format&&h.format!=="General"){var f=en(h.format).toLowerCase();switch(f){case"number":case"currency":case"accounting":case"percentage":n++;break;case"shortdate":case"longdate":a++;break;case"time":n++;break;case"text":s++;break;default:c={},Bs(h.format,!0,c)?c.type==="date"?a++:n++:De(h.value)?n++:h.value&&s++;break}u||(u=h.format)}else De(h.value)?n++:h.value&&s++;u&&u!==h.format&&(d=!0)}return{type:n>s&&n>a&&n>l?"number":s>=n&&s>=a&&s>=l?"string":a>n&&a>s&&a>l?"date":"datetime",isDateAvail:!!a,isMultiFormattedCol:d}},o.prototype.clearFilterHandler=function(t){var e=t&&!g(t.sheetIndex)?t.sheetIndex:this.parent.activeSheetIndex;if(t&&t.field){var i=[].slice.call(this.filterCollection.get(e));i&&i.length&&(this.updatePredicate(i,t.field),this.initiateFilterUIHandler({predicates:i,range:Ve(this.filterRange.get(e).range),sIdx:e}))}else{var r=t&&t.isAction,n={isFiltered:!1,isClearAll:!0,sheetIndex:e};if(this.getFilteredColumnHandler(n),n.isFiltered||t&&t.preventRefresh){var s=void 0,a=ke(this.parent,e),l=this.filterRange.get(e),h=l.range;if(r&&(s={range:Ve(h),predicates:[],previousPredicates:this.filterCollection.get(e),sheetIndex:e,cancel:!1},this.parent.notify(hi,{action:"filter",eventArgs:s}),s.cancel))return;this.filterCollection.set(e,[]);var c=l.useFilterRange?h[2]:a.usedRange.rowIndex;if(this.parent.scrollSettings.enableVirtualization&&c-h[0]+1>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2){for(var u=0;u<=c;u++)Cs(a,u,{hidden:!1,isFiltered:!1});(!t||!t.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else{this.refreshFilterRange(null,null,e);var d={startIndex:h[0],hide:!1,isFiltering:!0,refreshUI:!1,endIndex:l.useFilterRange?h[2]:a.usedRange.rowIndex,sheetIndex:e};this.parent.notify(kn,d),d.refreshUI&&(!t||!t.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}r&&(delete s.cancel,this.parent.notify(wt,{action:"filter",eventArgs:s}),Re(this.parent.element))}}},o.prototype.reapplyFilterHandler=function(t,e){var i=this,r=this.parent.activeSheetIndex;if(this.filterRange.has(r)){var n=this.filterCollection.get(r);if(n&&n.length){var s=ke(this.parent,r),a=this.filterRange.get(r),l=a.range.slice();a.allowHeaderFilter||(l[0]=l[0]+1),a.useFilterRange||(l[2]=s.usedRange.rowIndex),l[1]=l[3]=Sn(n[0].field);var h=s.name+"!"+this.getPredicateRange(l,n.slice(1,n.length));Aa(this.parent,h,!0,!0,null,!0,null,null,!1,Ve(l)).then(function(c){var u=i.getPredicates(i.filterCollection.get(r));i.applyFilter({predicates:u.predicates,datasource:new oe(c),equalOrPredicates:u.equalOrPredicates},Ve(a.range),r,[].slice.call(n),e,t)})}}},o.prototype.getFilterRangeHandler=function(t){var e=g(t.sheetIdx)?this.parent.activeSheetIndex:t.sheetIdx,i=this.filterRange&&this.filterRange.get(e);i?(t.hasFilter=!0,t.filterRange=i.range,t.allowHeaderFilter=i.allowHeaderFilter,t.isFiltered=this.filterCollection&&this.filterCollection.get(e)&&this.filterCollection.get(e).length>0):(t.hasFilter=!1,t.filterRange=null)},o.prototype.getLocalizedCustomOperators=function(){var t=this.parent.serviceLocator.getService(ve),e=[{value:"equal",text:t.getConstant("Equal")},{value:"greaterthan",text:t.getConstant("GreaterThan")},{value:"greaterthanorequal",text:t.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:t.getConstant("LessThan")},{value:"lessthanorequal",text:t.getConstant("LessThanOrEqual")},{value:"notequal",text:t.getConstant("NotEqual")}],i={stringOperator:[{value:"startswith",text:t.getConstant("StartsWith")},{value:"endswith",text:t.getConstant("EndsWith")},{value:"contains",text:t.getConstant("Contains")},{value:"equal",text:t.getConstant("Equal")},{value:"isempty",text:t.getConstant("IsEmpty")},{value:"doesnotstartwith",text:t.getConstant("NotStartsWith")},{value:"doesnotendwith",text:t.getConstant("NotEndsWith")},{value:"doesnotcontain",text:t.getConstant("NotContains")},{value:"notequal",text:t.getConstant("NotEqual")},{value:"isnotempty",text:t.getConstant("IsNotEmpty")}],numberOperator:e,dateOperator:e,datetimeOperator:e,booleanOperator:[{value:"equal",text:t.getConstant("Equal")},{value:"notequal",text:t.getConstant("NotEqual")}]};return i},o.prototype.setFilteredCollection=function(t){var e=this,i={sheetIdx:t.sheetIdx};if(this.getFilterRangeHandler(i),i.hasFilter){var r={sheetIndex:t.sheetIdx,filterRange:Ve(i.filterRange),hasFilter:!0,column:[],criteria:[],value:[],dataType:[],predicates:[]};t.saveJson.filterCollection.push(r);for(var n=this.filterCollection.get(t.sheetIdx),s=new Map,a=void 0,l,h=function(p){if(g(p))return"";if(t.isSaveAction&&l==="date"){var f=p;p=f.getMonth()+1+"/"+f.getDate()+"/"+f.getFullYear()+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()}return p},c=0;c<n.length;c++)a=n[c],t.isSaveAction&&a.operator==="notequal"&&a.isFilterByMenu?s.has(a.field)?s.get(a.field).push(a):s.set(a.field,[a]):(r.column.push(Sn(a.field)),r.criteria.push(a.operator),t.isSaveAction?a.operator==="equal"?(l=_o(a.value)?"date":"string",r.value.push(h(a.value)),r.dataType.push(l)):(r.value.push(a.value),r.dataType.push("custom")):(r.value.push(a.value),r.dataType.push(a.type)),r.predicates.push(a.predicate));var u=new Map,d;s.forEach(function(p,f){d=Sn(f),u.has(f)||u.set(f,e.getColData(d,f,t.sheetIdx));for(var v=u.get(f),m=e.getPredicates(p).predicates,y=new oe(v).executeLocal(new Pe().where(xt.and(m))),b=0;b<y.length;b++)r.column.push(d),r.criteria.push("equal"),l=_o(y[b][f])?"date":"string",r.value.push(h(y[b][f])),r.dataType.push(l),r.predicates.push("or")})}},o.prototype.updateFilter=function(t){if(this.parent.filterCollection&&(t.initLoad||t.isOpen)){for(var e=void 0,i=void 0,r=void 0,n={},s=void 0,a=void 0,l=void 0,h=0;h<this.parent.filterCollection.length;h++){r=this.parent.filterCollection[h];var c=r.sheetIndex;if(h===0&&!this.parent.isOpen&&!t.isOpen&&(c=0),i=[],r.column)for(var u=0;u<r.column.length;u++)if(a={field:ji(r.column[u]+1),operator:this.getFilterOperator(r.criteria[u]),value:typeof r.value[u]=="string"?r.value[u].split("*").join(""):r.value[u],predicate:r.predicates&&r.predicates[u],type:r.dataType&&r.dataType[u]},["year","month","day"].indexOf(a.type)>-1){var d={value:a.value,cell:{value:a.value}};if(this.parent.notify(Jr,d),d.isDate){var p=d.dateObj;if(a.value=p,a.type==="day")a.type="date",a.predicate="or",i.push(a);else{a.operator="greaterthanorequal",a.predicate="and";var f=a.type;a.type="date",e=this.getPredicates([a,{field:a.field,operator:"lessthanorequal",predicate:"and",type:"date",value:new Date(p.getFullYear(),f==="year"?12:p.getMonth()+1,0,0,0,0)}]).predicates,n[a.field]||(n[a.field]=this.getColData(r.column[u],a.field,h)),s=new oe(n[a.field]).executeLocal(new Pe().where(xt.and(e)));for(var v=0;v<s.length;v++)i.push({field:a.field,operator:"equal",predicate:"or",type:"date",value:s[v][a.field]})}}}else{if(l={isOpen:!0,instance:{options:{type:a.type}},arg3:a.value,arg2:a.operator},this.beforeFilteringHandler(l),a.value=l.arg3,a.type==="string"||a.type==="custom")this.isCustomNumFilter(a.operator)&&De(a.value)&&(a.type="number");else if(a.type==="date"&&a.operator==="equal"&&typeof a.value=="string"&&a.value.includes("/")&&a.value.includes(":")){var m=a.value.split(" ");if(m.length===2){var y=m[0].split("/"),b=m[1].split(":");y.length===3&&b.length===3&&(a.value=new Date(Number(y[2]),Number(y[0])-1,Number(y[1]),Number(b[0]),Number(b[1]),Number(b[2])))}}i.push(a)}if(!t.isOpen)for(var S=0;S<i.length-1;S++)i[S].field===i[S+1].field&&(i[S].predicate||(i[S].predicate="or"),i[S+1].predicate||(i[S+1].predicate="or"));this.parent.notify(Yo,{predicates:i.length?i:void 0,range:r.filterRange,sIdx:c,isInternal:!0,isOpen:t.isOpen})}this.parent.sortCollection&&this.parent.notify(Nb,null),this.parent.setProperties({filterCollection:null},!0)}},o.prototype.getColData=function(t,e,i){var r=ke(this.parent,i);if(!r.rows||!r.rows.length)return[];for(var n=[],s,a,l=1,h=r.rows.length;l<h;l++)r.rows[l]&&(a=Q(l,t,r,!1,!0),a&&a.value&&(s={},s[e]=n0(this.parent,a,l,t,i),n.push(s)));return n},o.prototype.getFilterOperator=function(t){switch(t){case"BeginsWith":t="startswith";break;case"Less":t="lessthan";break;case"EndsWith":t="endswith";break;case"Equal":t="equal";break;case"Notequal":t="notEqual";break;case"Greater":t="greaterthan";break;case"Contains":t="contains";break;case"LessOrEqual":t="lessthanorequal";break;case"GreaterOrEqual":t="greaterthanorequal";break;case"NotContains":t="doesnotcontain";break;case"NotBeginsWith":t="doesnotstartwith";break;case"NotEndsWith":t="doesnotendwith";break;case"Empty":t="isempty";break;case"NotEmpty":t="isnotempty";break}return t},o.prototype.beforeInsertHandler=function(t){if(t.modelType==="Column"){var e=Te(t.activeSheetIndex)?this.parent.activeSheetIndex:t.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(e)){var i=this.filterRange.get(e).range;(this.isFilterCell(e,i[0],t.index)||t.index<i[1])&&(i[3]+=t.model.length,t.index<=i[1]&&(i[1]+=t.model.length),this.filterCollection.get(e).forEach(function(a){var l=Sn(a.field);t.index<=l&&(a.field=ji(l+t.model.length+1))}),this.parent.sortCollection&&this.parent.sortCollection.forEach(function(a){a.sheetIndex===e&&t.index<=a.columnIndex&&(a.columnIndex+=t.model.length)}))}}else if(t.modelType==="Sheet"){for(var r=0,n=Array.from(this.filterRange.keys()).sort().reverse();r<n.length;r++){var s=n[r];t.index<=s&&(this.filterRange.set(s+t.model.length,this.filterRange.get(s)),this.filterRange.delete(s),this.filterCollection.set(s+t.model.length,this.filterCollection.get(s)),this.filterCollection.delete(s))}this.parent.sortCollection&&this.parent.sortCollection.forEach(function(a){t.index<=a.sheetIndex&&(a.sheetIndex+=t.model.length)})}},o.prototype.beforeDeleteHandler=function(t){if(t.modelType==="Column"){var e=this.parent.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(e)){var i=!0,r=this.filterRange.get(e).range;if(t.start>=r[1]&&t.end<=r[3]?r[3]-=t.end-t.start+1:t.start<r[1]&&t.end<r[1]?(r[1]-=t.end-t.start+1,r[3]-=t.end-t.start+1):t.start<r[1]&&t.end>r[1]&&t.end<r[3]?(r[1]=t.start,r[3]-=t.end-t.start+1):i=!1,i){for(var n=this.filterCollection.get(e),s=void 0,a=n.length-1;a>=0;a--){var l=Sn(n[a].field);t.end<l?n[a].field=ji(l-(t.end-t.start+1)+1):t.start<=l&&t.end>=l&&(s=!0,n.splice(a,1))}var h=this.parent.sortCollection;if(h){for(var a=0;a<h.length;a++)if(h[a].sheetIndex===e){if(t.end<h[a].columnIndex){h[a].columnIndex=h[a].columnIndex-(t.end-t.start+1);break}else if(t.start<=h[a].columnIndex&&t.end>=h[a].columnIndex){h.splice(a,1);break}}}r.some(function(c){return c<0})?(this.removeFilter(e,!0,!0),t.refreshSheet=!0):s&&(n&&n.length?(this.reapplyFilterHandler(!0,!0),t.refreshSheet=!1):(this.clearFilterHandler({preventRefresh:!0}),t.refreshSheet=!0))}}}},o.prototype.deleteSheetHandler=function(t){if(Te(t.sheetIndex))this.filterRange.get(this.parent.activeSheetIndex)&&(this.filterRange.delete(this.parent.activeSheetIndex),this.filterCollection.delete(this.parent.activeSheetIndex));else{for(var e=0,i=Array.from(this.filterRange.keys()).sort().reverse();e<i.length;e++){var r=i[e];t.sheetIndex===r?(this.filterRange.delete(r),this.filterCollection.delete(r)):t.sheetIndex<r&&(this.filterRange.set(r-1,this.filterRange.get(r)),this.filterRange.delete(r),this.filterCollection.set(r-1,this.filterCollection.get(r)),this.filterCollection.delete(r))}var n=this.parent.sortCollection;if(n)for(var s=n.length-1;s>=0;s--)t.sheetIndex===n[s].sheetIndex?n.splice(s,1):t.sheetIndex<n[s].sheetIndex&&(n[s].sheetIndex-=1)}},o.prototype.clearHandler=function(t){var e=this.parent.getAddressInfo(t.range);if(this.filterRange.has(e.sheetIndex)){var i=this.filterRange.get(e.sheetIndex).range.slice();Vo(e.indices,i[0],i[1])&&Vo(e.indices,i[0],i[3])&&this.removeFilter(e.sheetIndex,!t.isAction,null,!0)}},o.prototype.duplicateSheetFilterHandler=function(t){for(var e=0,i=Array.from(this.filterRange.keys()).sort().reverse();e<i.length;e++){var r=i[e];if(t.newSheetIndex<=r)this.filterRange.set(r+1,this.filterRange.get(r)),this.filterRange.delete(r),this.filterCollection.set(r+1,this.filterCollection.get(r)),this.filterCollection.delete(r);else break}if(this.filterCollection.has(t.sheetIndex)&&this.filterCollection.set(t.newSheetIndex,this.filterCollection.get(t.sheetIndex).slice()),this.filterRange.has(t.sheetIndex)){var n=this.filterRange.get(t.sheetIndex);this.filterRange.set(t.newSheetIndex,{useFilterRange:n.useFilterRange,range:n.range.slice(),allowHeaderFilter:n.allowHeaderFilter})}},o.prototype.updateSortCollectionHandler=function(t){var e;if(t.isDuplicate){if(this.parent.sortCollection&&this.parent.sortCollection.length>0){for(var i=[],r=0;r<this.parent.sortCollection.length;r++){var n=this.parent.sortCollection[r];if(n.sheetIndex===t.curSheetIndex){var s=Object.assign({},n);s.sheetIndex=t.newSheetIndex,i.push(s)}}(e=this.parent.sortCollection).push.apply(e,i)}return}var a=this.parent.getActiveSheet(),l=this.parent.activeSheetIndex,h=this.filterRange.get(l);if(h){var c=h.range.slice();h.allowHeaderFilter||(c[0]=c[0]+1),h.useFilterRange||(c[2]=a.usedRange.rowIndex);var u=t.sortOptions.sortDescriptors;if(this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[],Array.isArray(u))for(var d=0;d<u.length;d++)this.parent.sortCollection.push({sortRange:Ve(c),columnIndex:Sn(u[d].field),order:u[d].order,sheetIndex:l});else this.parent.sortCollection.push({sortRange:Ve(c),columnIndex:Ji(a.activeCell)[1],order:u.order,sheetIndex:l})}},o.prototype.moveSheetHandler=function(t){var e,i,r,n;this.filterRange.has(t.prevIndex)&&(e=this.filterRange.get(t.prevIndex),r=this.filterCollection.get(t.prevIndex)),this.filterRange.has(t.currentIndex)&&(i=this.filterRange.get(t.currentIndex),n=this.filterCollection.get(t.currentIndex)),e&&i?(this.filterRange.set(t.currentIndex,e),this.filterRange.set(t.prevIndex,i),this.filterCollection.set(t.currentIndex,r),this.filterCollection.set(t.prevIndex,n)):e?(this.filterRange.set(t.currentIndex,e),this.filterRange.delete(t.prevIndex),this.filterCollection.set(t.currentIndex,r),this.filterCollection.delete(t.prevIndex)):i&&(this.filterRange.set(t.prevIndex,i),this.filterRange.delete(t.currentIndex),this.filterCollection.set(t.prevIndex,n),this.filterCollection.delete(t.currentIndex))},o.prototype.refreshFilterCellsOnResize=function(t){var e=this.filterRange.has(this.parent.activeSheetIndex)&&this.filterRange.get(this.parent.activeSheetIndex).range;if(e&&e[0]===t.rowIndex){for(var i=this.parent.getActiveSheet(),r=e[1];r<=e[3];r++)if(Q(t.rowIndex,r,i,!1,!0).notes){var n=this.parent.getCell(t.rowIndex,r);n&&this.parent.serviceLocator.getService("cell").refresh(t.rowIndex,r,!1,n,!1,!1,!0)}}},o})(),aG=(function(){function o(t){this.parent=t,this.addEventListener(),this.renderImageUpload()}return o.prototype.addEventListener=function(){this.parent.on(ED,this.insertImage,this),this.parent.on(Jd,this.refreshImgCellObj,this),this.parent.on(go,this.createImageElement,this),this.parent.on(La,this.deleteImage,this),this.parent.on(L0,this.refreshInsDelImagePosition,this)},o.prototype.renderImageUpload=function(){var t=this.parent.createElement("input",{id:this.parent.element.id+"_imageUpload",attrs:{type:"file",accept:".image, .jpg, .png, .gif ,jpeg",name:"fileUpload"}});t.style.display="none",this.parent.element.appendChild(t),t.onchange=this.imageSelect.bind(this)},o.prototype.imageSelect=function(t){var e=t.target.files[0];e&&(e.type.includes("image")?this.insertImage({file:e,isAction:!0}):this.parent.serviceLocator.getService(jt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("UnsupportedFile"),width:"300"}),t.target.value="")},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ED,this.insertImage),this.parent.off(Jd,this.refreshImgCellObj),this.parent.off(go,this.createImageElement),this.parent.off(La,this.deleteImage),this.parent.off(L0,this.refreshInsDelImagePosition))},o.prototype.insertImage=function(t,e){var i=this;this.binaryStringVal(t).then(function(r){var n=typeof r=="string"||r instanceof ArrayBuffer?{dataUrl:r}:r;i.createImageElement({options:{src:n.dataUrl,height:n.height,width:n.width},range:e,isPublic:!0,isAction:t.isAction})})},o.prototype.binaryStringVal=function(t){return new Promise(function(e,i){var r=new FileReader;r.readAsDataURL(t.file),r.onload=function(){var n=new Image;n.onload=function(){return e({dataUrl:r.result,width:n.width,height:n.height})},n.onerror=i,n.src=r.result},r.onerror=function(n){return i(n)}})},o.prototype.createImageElement=function(t){var e=t.range?t.range.lastIndexOf("!"):0,i=t.range?e>0?t.range.substring(e+1):t.range:this.parent.getActiveSheet().selectedRange,r=t.range&&e>0?Ct(this.parent,t.range.substring(0,e)):this.parent.activeSheetIndex,n=this.parent.serviceLocator.getService(j0),s=t.options.id?t.options.id:Lt(this.parent.element.id+"_overlay_picture_"),a=ie(i),l=Te(r)&&!t.isUndoRedo?this.parent.getActiveSheet():this.parent.sheets[r];if(!(!l||this.parent.element.querySelector("#"+s))){if(t.isPublic&&Hi(this.parent,a)){t.isAction&&this.parent.notify(fr,null);return}var h={requestType:"beforeInsertImage",range:l.name+"!"+i,imageData:t.options.src,sheetIndex:r};if(t.isPublic&&this.parent.notify("actionBegin",{eventArgs:h,action:"beforeInsertImage"}),!h.cancel){var c=n.insertOverlayElement(s,i,r);c.element.style.backgroundImage="url('"+t.options.src+"')";var u=l.frozenRows||l.frozenColumns;if((t.options.height||t.options.left)&&(c.element.style.height=t.options.height+"px",c.element.style.width=t.options.width+"px",g(t.options.top)||(c.element.style.top=Number(os(!u&&t.options.preservePos&&c.top>t.options.top?c.top:t.options.top).toFixed(2))+"px"),g(t.options.left)||(c.element.style.left=Number(os(!u&&t.options.preservePos&&c.left>t.options.left?c.left:t.options.left).toFixed(2))+"px"),!t.options.preservePos&&!g(t.options.top)&&!g(t.options.left))){var d={clientY:t.options.top,isImage:!0},p={clientX:t.options.left,isImage:!0};this.parent.notify(Is,d),this.parent.notify(Ms,p);var f=d.clientY,v=p.clientX;if(a[0]!==f||a[1]!==v){var m={prevTop:t.options.top,prevLeft:t.options.left,prevRowIdx:a[0],prevColIdx:a[1],prevHeight:t.options.height,prevWidth:t.options.width,currentTop:t.options.top,currentLeft:t.options.left,currentRowIdx:f,currentColIdx:v,currentHeight:t.options.height,currentWidth:t.options.width,id:t.options.id,requestType:"imagePositionRefresh"};this.refreshImgCellObj(m),a[0]=f,a[1]=v,i=Ve([f,v])}}u&&n.adjustFreezePaneSize(t.options,c.element,i);var y={src:t.options.src,id:s,height:parseFloat(c.element.style.height.replace("px","")),width:parseFloat(c.element.style.width.replace("px","")),top:u?a[0]?xi(l,0,a[0]-1):0:g(t.options.top)||t.options.preservePos&&c.top>t.options.top?c.top:t.options.top,left:u?a[1]?wi(l,0,a[1]-1):0:g(t.options.left)||t.options.preservePos&&c.left>t.options.left?c.left:t.options.left};this.parent.setUsedRange(a[0],a[1]);var b=!1,S=!1;!t.isPublic&&!t.isUndoRedo&&(y.top!==t.options.top||y.left!==t.options.left)&&(t.options.top=y.top,t.options.left=y.left,b=!0);var C={options:[y],range:l.name+"!"+i,isPositionChanged:b,isElementRemoved:S};(t.isPublic||t.isUndoRedo||b)&&this.parent.notify(Yb,C),b&&C.isElementRemoved&&(c=n.insertOverlayElement(s,i,r),c.element.style.backgroundImage="url('"+t.options.src+"')",t.options.height&&t.options.width&&(c.element.style.height=t.options.height+"px",c.element.style.width=t.options.width+"px"));for(var x=Q(a[0],a[1],l),I=0;I<x.image.length;I++){var D=x.image[I];if(!D.id){D.id=y.id;break}}!t.isUndoRedo&&t.isPublic&&(h={requestType:"insertImage",range:l.name+"!"+i,imageHeight:t.options.height?t.options.height:300,imageWidth:t.options.width?t.options.width:400,imageData:t.options.src,id:s,sheetIndex:r},this.parent.notify("actionComplete",{eventArgs:h,action:"insertImage"}))}}},o.prototype.refreshInsDelImagePosition=function(t){for(var e=t.count,i=t.sheetIdx,r=this.parent.sheets[i],n,s=Q(t.rowIdx,t.colIdx,r),a=s.image.length,l,h,c=0;c<a;c++)n=document.getElementById(s.image[c].id),l=t.type==="Row"?t.status==="insert"?s.image[c].top+e*20:s.image[c].top-e*20:s.image[c].top,h=t.type==="Column"?t.status==="insert"?s.image[c].left+e*64:s.image[c].left-e*64:s.image[c].left,s.image[c].top=l,s.image[c].left=h,n&&(n.style.top=l+"px",n.style.left=h+"px")},o.prototype.refreshImgCellObj=function(t){var e=Te(t.sheetIdx)?this.parent.activeSheetIndex:t.sheetIdx,i=ke(this.parent,e),r=Q(t.prevRowIdx,t.prevColIdx,i),n=Q(t.currentRowIdx,t.currentColIdx,i),s=r?r.image:[],a,l,h=s&&s.length?s.length:0;if(r&&r.image&&s.length>0){for(var c=0;c<h;c++)s[c]&&s[c].id===t.id&&(a=s[c],a.height=t.currentHeight,a.width=t.currentWidth,a.top=t.currentTop,a.left=t.currentLeft,s.splice(c,1));if(n&&n.image&&(l=n.image,a&&l.push(a)),l?Zt(t.currentRowIdx,t.currentColIdx,i,{image:l},!0):Zt(t.currentRowIdx,t.currentColIdx,i,{image:[a]},!0),t.requestType==="imageRefresh"&&!t.isUndoRedo){var u={requestType:"imageRefresh",currentRowIdx:t.currentRowIdx,currentColIdx:t.currentColIdx,prevRowIdx:t.prevRowIdx,prevColIdx:t.prevColIdx,prevTop:t.prevTop,prevLeft:t.prevLeft,currentTop:t.currentTop,currentLeft:t.currentLeft,currentHeight:t.currentHeight,currentWidth:t.currentWidth,prevHeight:t.prevHeight,prevWidth:t.prevWidth,id:t.id,sheetIdx:this.parent.activeSheetIndex};this.parent.notify("actionComplete",{eventArgs:u,action:"imageRefresh"})}}},o.prototype.deleteImage=function(t){var e=t.sheet||this.parent.getActiveSheet(),i=document.getElementById(t.id),r=t.rowIdx,n=t.colIdx,s;if(i){if(t.rowIdx===void 0&&t.colIdx===void 0){var a=void 0,l=void 0;if(e.frozenRows||e.frozenColumns){var h=i.getBoundingClientRect();a={clientY:h.top},l={clientX:h.left},h.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(a.target=this.parent.getColumnHeaderContent()),h.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(l.target=this.parent.getRowHeaderTable())}else a={clientY:parseFloat(i.style.top),isImage:!0},l={clientX:parseFloat(i.style.left),isImage:!0};this.parent.notify(Is,a),this.parent.notify(Ms,l),r=a.clientY,n=l.clientX}if(s=e.name+"!"+st(r,n),!t.preventEventTrigger){var c={address:s,cancel:!1};if(this.parent.notify(hi,{action:"deleteImage",eventArgs:c}),c.cancel)return}document.getElementById(t.id).remove()}else if(!t.sheet){var u=t.range?t.range.lastIndexOf("!")>0?t.range.substring(t.range.lastIndexOf("!")+1):t.range:this.parent.getActiveSheet().selectedRange,d=t.range&&t.range.lastIndexOf("!")>0?Ct(this.parent,t.range.substring(0,t.range.lastIndexOf("!"))):this.parent.activeSheetIndex,p=ie(u);r=p[0],n=p[1],e=this.parent.sheets[d]}var f={};if(e){for(var v=Q(r,n,e),m=v&&v.image?v.image:[],y=m.length,b=y-1;b>=0;b--)m[b].id===t.id&&(f=m.splice(b,1)[0]);Zt(r,n,e,{image:m},!0)}t.preventEventTrigger||this.parent.notify(wt,{action:"deleteImage",eventArgs:{address:s,id:f.id,imageData:f.src,imageWidth:f.width,imageHeight:f.height,cancel:!1},preventAction:t.isUndoRedo,isClearAction:t.clearAction})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"spreadsheetImage"},o})();yb.Inject(zO,OO,BO,PO,HO,_O,jO,UO);yb.Inject(VO,RO,QO,YO,GO,FO);oM.Inject(ub,ZO,$O,KO);var oG=(function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Gb,this.initiateChartHandler,this),this.parent.on(Uc,this.refreshChartCellObj,this),this.parent.on(A0,this.refreshChartCellModel,this),this.parent.on(Ig,this.refreshChartCellObj,this),this.parent.on(lu,this.deleteChart,this),this.parent.on(N0,this.clearBorder,this),this.parent.on(AD,this.insertChartHandler,this),this.parent.on(Id,this.chartRangeHandler,this),this.parent.on(Wc,this.chartDesignTabHandler,this),this.parent.on(LD,this.undoRedoForChartDesign,this),this.parent.on(Xo,this.refreshChartData,this)},o.prototype.insertChartHandler=function(t){var e=this,i="Column",r=!1;switch(t.id){case"clusteredColumn":i="Column";break;case"stackedColumn":i="StackingColumn";break;case"stackedColumn100":i="StackingColumn100";break;case"clusteredBar":i="Bar";break;case"stackedBar":i="StackingBar";break;case"stackedBar100":i="StackingBar100";break;case"area":i="Area";break;case"stackedArea":i="StackingArea";break;case"stackedArea100":i="StackingArea100";break;case"line":i="Line";break;case"lineMarker":i="Line",r=!0;break;case"stackedLine":i="StackingLine";break;case"stackedLineMarker":i="StackingLine",r=!0;break;case"stackedLine100":i="StackingLine100";break;case"stackedLine100Marker":i="StackingLine100",r=!0;break;case"pie":i="Pie";break;case"doughnut":i="Doughnut";break;case"scatter":i="Scatter";break}var n=[{type:i,markerSettings:{visible:r,isFilled:!0}}];t.isChart?(this.parent.notify(jh,{chart:n}),er(function(){return Re(e.parent.element)})):this.parent.notify(Wc,{chartType:i,triggerEvent:!0,markerVisible:r})},o.prototype.chartRangeHandler=function(){var t=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(t)for(var e=t.getElementsByClassName("e-control")[0].id,i=this.parent.chartColl,r=i.length,n=0;n<r;n++){var s=document.getElementById(i[n].id);t&&s&&i[n].id===e&&this.initiateChartHandler({option:i[n],isRefresh:!0})}},o.prototype.refreshChartData=function(t){if(!(!this.parent.chartColl||!this.parent.chartColl.length)){for(var e,i,r,n,s,a,l=0,h=this.parent.chartColl.length;l<h;l++)if(e=this.parent.chartColl[l],!!e.range){if(e.range.includes("!")){if(i=e.range.substring(0,e.range.lastIndexOf("!")),this.parent.activeSheetIndex!==Ct(this.parent,i))continue;r=e.range.substring(e.range.lastIndexOf("!")+1)}else r=e.range;if(t.viewportIndexes){for(var c=0;c<t.viewportIndexes.length;c++)if(i0([t.viewportIndexes[c]],r)){n=!0;break}}else n=t.range?i0([t.range],r):t.showHide?this.inRowColumnRange(ie(r),t.rIdx,t.showHide):Vo(ie(r),t.rIdx,t.cIdx);(n||t.isSelectAll&&!t.isRefreshChart)&&(s=this.parent.element.querySelector("."+e.id),s&&(a=ot(s,"chart")||ot(s,"accumulationchart"),a&&(a.series=this.initiateChartHandler({option:e,isRefresh:!0}),a.refresh())))}}},o.prototype.inRowColumnRange=function(t,e,i){return i==="rows"?e>=t[0]&&e<=t[2]:e>=t[1]&&e<=t[3]},o.prototype.refreshChartCellModel=function(t){for(var e=0,i=t.prevChartIndexes.length;e<i;e++){var r=t.prevChartIndexes[e].chart,n=t.prevChartIndexes[e].chartRowIdx,s=t.prevChartIndexes[e].chartColIdx,a=t.currentChartIndexes[e].chartRowIdx,l=t.currentChartIndexes[e].chartColIdx,h={prevTop:r.top,prevLeft:r.left,prevRowIdx:n,prevColIdx:s,prevHeight:r.height,prevWidth:r.width,currentTop:r.top,currentLeft:r.left,currentRowIdx:a,currentColIdx:l,currentHeight:r.height,currentWidth:r.width,id:r.id,requestType:"chartRefreshOnFilter"};this.parent.notify(Uc,h)}},o.prototype.refreshChartCellObj=function(t){var e=Te(t.sheetIdx)?this.parent.activeSheetIndex:t.sheetIdx,i=ke(this.parent,e),r=Q(t.prevRowIdx,t.prevColIdx,i),n=Q(t.currentRowIdx,t.currentColIdx,i),s=r?r.chart:[],a,l,h=s&&s.length?s.length:0;if(h){for(var c=0;c<h;c++)if(s[c].id===t.id.split("_overlay")[0]){a=s[c],a.height=t.currentHeight,a.width=t.currentWidth,a.top=t.currentTop,a.left=t.currentLeft,a.address=[t.currentRowIdx,t.currentColIdx],s.splice(c,1),c--,h--;for(var u=0,d=this.parent.chartColl.length;u<d;u++)a.id===this.parent.chartColl[u].id&&(a.height=t.currentHeight,this.parent.chartColl[u].width=t.currentWidth,this.parent.chartColl[u].height=t.currentHeight,this.parent.chartColl[u].top=t.currentTop,this.parent.chartColl[u].left=t.currentLeft,this.parent.chartColl[u].address=a.address)}if(n&&n.chart&&(l=n.chart,a&&l.push(a)),l?Zt(t.currentRowIdx,t.currentColIdx,i,{chart:l},!0):Zt(t.currentRowIdx,t.currentColIdx,i,{chart:[a]},!0),t.requestType==="chartRefresh"&&!t.isUndoRedo){var p={requestType:"chartRefresh",currentRowIdx:t.currentRowIdx,currentColIdx:t.currentColIdx,currentWidth:t.currentWidth,prevHeight:t.prevHeight,prevWidth:t.prevWidth,prevRowIdx:t.prevRowIdx,prevColIdx:t.prevColIdx,prevTop:t.prevTop,prevLeft:t.prevLeft,currentTop:t.currentTop,currentLeft:t.currentLeft,currentHeight:t.currentHeight,id:t.id,sheetIdx:e};this.parent.notify("actionComplete",{eventArgs:p,action:"chartRefresh"})}}if(t.isUndoRedo&&e===this.parent.activeSheetIndex){var f=document.getElementById(t.id);if(f){f.style.height=t.currentHeight+"px",f.style.width=t.currentWidth+"px";var v=this.parent.frozenRowCount(i),m=this.parent.frozenColCount(i);if(v||m){t.currentRowIdx<v||t.currentColIdx<m?this.parent.element.querySelector("#"+this.parent.element.id+"_sheet").appendChild(f):this.parent.getMainContent().appendChild(f),this.parent.serviceLocator.getService(j0).adjustFreezePaneSize({top:t.currentTop,left:t.currentLeft},f,st(t.currentRowIdx,t.currentColIdx));var y=f.querySelector(".e-chart");y&&Re(y)}else f.style.top=t.currentTop+"px",f.style.left=t.currentLeft+"px"}}},o.prototype.processChartRange=function(t,e,i){var r=this,n,s,a,l,h,c=t[0],u=t[1],d=t[2],p=t[3],f=c===d,v=u===p,m=ke(this.parent,e),y=Xd(this.parent),b=function(E,A,L,N){var R=Q(E,A,m);if(R){R.formula&&g(R.value)&&r.parent.notify(zl,{cell:R,rowIdx:E,colIdx:A,sheetIndex:e});var P=void 0;if(R.format){var k={value:R.value,format:R.format,formattedText:R.value,cell:R,rowIndex:E,colIndex:A};r.parent.notify(yr,k);var B=De(R.value);B&&!Bs(R.format,!0,null,!0)?P=Number(R.value):(N&&B?l=!0:L&&B&&(h=!0),P=k.formattedText&&k.formattedText.toString())}else y(R),P=R.value;return g(P)?"":P}else return""},S=m?b(c,p,!1,!0):"",C=m?b(d,u,!0):"",x=m?b(c,u,!0):"",I=!1;if((!De(C)||!x)&&(I=!0),(g(x)||i.type==="Scatter"&&!i.isSeriesInRows)&&!f&&!v){var D=ce(m,c+1,!0),M=ce(m,u+1,!0,"columns");n=[D,u,d,u],s=[D,M,d,p],a=[c,M,c,p]}else if(!g(C)&&I&&!f&&!v&&!l){var M=ce(m,u+1,!0,"columns");if(!g(S)&&(!De(S)||!x)){var D=ce(m,c+1,!0);n=[D,u,d,u],s=[D,M,d,p],a=[c,M,c,p]}else n=[c,u,d,u],s=[c,M,d,p]}else s=[c,u,d,p],!g(S)&&!De(S)&&!l?(a=[c,u,c,p],f||(s[0]=ce(m,s[0]+1,!0))):(f||v)&&g(x)&&(a=[c,u,c,p],f?(s[1]=ce(m,s[1]+1,!0,"columns"),a[3]=a[1]):s[0]=ce(m,s[0]+1,!0));return{xRange:n,yRange:s,lRange:a,isStringSeries:I,isDateTime:h}},o.prototype.getRangeData=function(t){var e=t.sheet;t.range?typeof t.range=="string"&&(t.range=ie(t.range)):t.range=ie(e.selectedRange);for(var i=[],r,n,s=t.range[0],a=t.isYvalue&&Xd(this.parent);s<=t.range[2];){if(lt(e,s)){s++;continue}for(r=t.range[1];r<=t.range[3];){if(Ft(e,r)){r++;continue}var l=Q(s,r,e,!1,!0);l.formula&&g(l.value)&&this.parent.notify(zl,{cell:l,rowIdx:s,colIdx:r,sheetIndex:t.sheetIdx}),t.isYvalue&&a(l);var h={value:l.value||(l.value===0?0:null)};l.format?(n={formattedText:l.value,value:l.value,format:l.format,cell:l,skipFormatCheck:!0,checkDate:!0},this.parent.notify(yr,n),t.isYvalue?De(l.value)?(h.value=Number(l.value),h.displayText=n.formattedText?n.formattedText.toString():""):(h.displayText=h.value===null?"":this.parent.getDisplayText({format:l.format,value:"0"}),h.value=0):t.isScatter&&!t.isDateTime&&De(l.value)?h.value=Number(l.value):t.isDateFormat&&De(l.value)?h.value=n.dateObj?n.dateObj:null:h.value=n.formattedText?n.formattedText.toString():null):t.isYvalue&&(De(h.value)?(h.displayText=h.value.toString(),h.value=Number(h.value)):(h.displayText=h.value===null?"":"0",h.value=0)),i.push(h),r++}s++}return i},o.prototype.toArrayData=function(t){for(var e="value",i,r=0,n=[];r<t.length;)i=t[r],Object.keys(i).length?e in i&&n.push(i[""+e]):n.push(""),r++;return n},o.prototype.getVirtualXValues=function(t){for(var e=1,i=[];e<t;)i.push(e.toString()),e++;return i},o.prototype.isDateFormattedRange=function(t,e){for(var i=t[1];i<=t[3];i++)if(!Ft(e,i)){for(var r=t[0];r<=t[2];r++)if(!lt(e,r)){var n=Q(r,i,e);if(!n||!n.format||n.value&&!De(n.value)||!Bs(n.format,!1))return!1}}return!0},o.prototype.processChartSeries=function(t,e,i,r,n,s,a){t=t||{};var l,h,c,u,d,p={},f,v=0,m=0,y=[],b,S,C;e=g(e)?this.parent.activeSheetIndex:e;var x=ke(this.parent,e),I=t&&t.type==="Scatter",D=t&&(t.type==="Pie"||t.type==="Doughnut"),M={name:"displayText"},E=this.parent.isPrintingProcessing,A=r[2]-r[0]+1-this.parent.hiddenCount(r[0],r[2],"rows",x),L=r[3]-r[1]+1-this.parent.hiddenCount(r[1],r[3],"columns",x),N=this.getRangeData({range:r,sheet:x,isYvalue:!0,sheetIdx:e});t.isSeriesInRows?(h=n?this.toArrayData(this.getRangeData({range:n,sheet:x,isScatter:I,isDateTime:s})):this.getVirtualXValues(L+1),i&&(c=this.toArrayData(this.getRangeData({range:i,sheet:x}))),u=A):(i?(b=!t.skipDateInterpolation&&!a&&!D&&this.isDateFormattedRange(i,x),h=this.toArrayData(this.getRangeData({range:i,sheet:x,isScatter:I,isDateTime:s,isDateFormat:b})),b&&(S=new Date(864e13),C=new Date(-864e13))):h=this.getVirtualXValues(A+1),n&&(c=this.toArrayData(this.getRangeData({range:n,sheet:x}))),u=L);var R=h.length,P=t.isSeriesInRows?1:u;for(g(t.dataLabelSettings)||(M.visible=t.dataLabelSettings.visible,M.position=t.dataLabelSettings.position);v<u;){for(f=0,d=[],m=t.isSeriesInRows?m:v;f<R;){if(b)if(g(h[f])){m+=P,f++;continue}else{var k=h[f];k<S&&(S=k),k>C&&(C=k)}g(h[f])&&(h[f]=Lt("spread-chart-empty-label-")),d.push({x:h[f],y:N[m].value,displayText:N[m].displayText}),m+=P,f++}if(c&&c.length>0?l=c[v]:l=t.type==="Scatter"?"series"+(v+1):"series"+v,l=g(l)?"":l.toString(),t.type){var B=t.type;B==="Line"||B==="StackingLine"||B==="StackingLine100"?p={dataSource:d,type:t.type,xName:"x",yName:"y",name:l,animation:{enable:!E},tooltipMappingName:"displayText",marker:t.markerSettings?{visible:t.markerSettings.visible,width:t.markerSettings.size,height:t.markerSettings.size,shape:t.markerSettings.shape,dataLabel:M,isFilled:t.markerSettings.isFilled,border:t.markerSettings.border,fill:t.markerSettings.isFilled?t.markerSettings.fill:null}:{dataLabel:M}}:B==="Scatter"?p={dataSource:d,type:t.type,xName:"x",yName:"y",name:l,tooltipMappingName:"displayText",animation:{enable:!E},marker:{visible:!1,width:12,height:12,shape:"Circle",dataLabel:M}}:B==="Pie"||B==="Doughnut"?p={dataSource:d,radius:"100%",xName:"x",yName:"y",innerRadius:t.type==="Pie"?"0%":"40%",dataLabel:{visible:!!M.visible,position:M.position==="Outer"?"Outside":"Inside",name:"displayText",font:{fontWeight:"600"}},animation:{enable:!E},tooltipMappingName:"displayText"}:p={dataSource:d,type:t.type,xName:"x",yName:"y",animation:{enable:!E},name:l,marker:{dataLabel:M},tooltipMappingName:"displayText"}}y.push(p),v++}if(S&&C&&S===C)return this.processChartSeries(t,e,i,r,n,s,!0);var F;return t.type&&(F={series:y,xRange:t.isSeriesInRows?n:i,yRange:r,lRange:t.isSeriesInRows?i:n,isDateFormat:b,minDate:S,maxDate:C}),F},o.prototype.getAxisFormat=function(t,e){var i="";if(!g(t)){var r=Q(t[0],t[1],e);r&&r.format&&(i=r.format)}return i},o.prototype.focusChartRange=function(t,e,i){var r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"];this.clearBorder();var n,s=this.parent.getActiveSheet(),a=!!(s.frozenRows||s.frozenColumns);i&&(a?n=i:this.parent.notify(xd,{startcell:{rowIndex:i[0],colIndex:i[1]},endcell:{rowIndex:i[2],colIndex:i[3]},classes:[r[0],r[1]]})),t&&(a?n?(n[0]=Math.min(i[0],t[0]),n[1]=Math.min(i[1],t[1]),n[2]=Math.max(i[2],t[2]),n[3]=Math.max(i[3],t[3])):n=t:this.parent.notify(xd,{startcell:{rowIndex:t[0],colIndex:t[1]},endcell:{rowIndex:t[2],colIndex:t[3]},classes:[r[2],r[3]]})),a&&n?this.parent.notify(xd,{startcell:{rowIndex:Math.min(n[0],e[0]),colIndex:Math.min(n[1],e[1])},endcell:{rowIndex:Math.max(n[2],e[2]),colIndex:Math.max(n[3],e[3])},classes:[r[4],r[5]]}):this.parent.notify(xd,{startcell:{rowIndex:e[0],colIndex:e[1]},endcell:{rowIndex:e[2],colIndex:e[3]},classes:[r[4],r[5]]})},o.prototype.clearBorder=function(){var t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var e=[].slice.call(this.parent.element.getElementsByClassName("e-chart-range"));e.forEach(function(u){se(u)});return}for(var i=this.parent.getMainContent(),r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"],n=0,s=r.length;n<s;n++)for(var a=i.querySelectorAll("."+r[n]),l=0,h=a.length;l<h;l++){var c=a[l];c.classList.remove(r[n])}},o.prototype.initiateChartHandler=function(t){var e=this,i=g(t.isInitCell)?!0:!t.isInitCell;t.triggerEvent=g(t.triggerEvent)?!0:t.triggerEvent,t.isRefresh=g(t.isRefresh)?!1:t.isRefresh;var r=this.parent.activeSheetIndex,n=t.option,s=n.range&&n.range.lastIndexOf("!")>0?Ct(this.parent,n.range.substring(0,n.range.lastIndexOf("!"))):r,a=ke(this.parent,s),l=n.range?n.range:this.parent.getActiveSheet().selectedRange,h=ie(l),c={},u,d,p,f=!g(t.isInitCell)&&t.isInitCell?t.range:l,v=t.isChangeChartType||!f?r:js(this.parent,f),m=this.parent.isPrintingProcessing;if(!this.parent.allowChart&&a.isProtected||v!==r&&!m)return d;var y={sheetIndex:s,reqType:"shape",type:"actionBegin",shapeType:"chart",action:"create",options:n,range:l,operation:"create"};if(c=y.options,l=y.range,c=c||{},h.length>0&&!t.isRefresh&&i){var b=h[2]-h[0],S=h[3]-h[1];b<S&&(u=!0)}c.isSeriesInRows=u?!0:c.isSeriesInRows?c.isSeriesInRows:!1,t.dataSheetIdx=g(t.dataSheetIdx)?s:t.dataSheetIdx;var C=this.processChartRange(h,t.dataSheetIdx,c),x=C.xRange,I=C.yRange,D=C.lRange;if(s===r&&i&&this.focusChartRange(x,I,D),t.triggerEvent&&!t.isRefresh){if(p={type:n.type,theme:n.theme,isSeriesInRows:n.isSeriesInRows,range:n.range,markerSettings:c.markerSettings,dataLabelSettings:c.dataLabelSettings,title:c.title,legendSettings:c.legendSettings,primaryXAxis:c.primaryXAxis,primaryYAxis:c.primaryYAxis,id:n.id,height:n.height,width:n.width,posRange:t.range,isInitCell:t.isInitCell,cancel:!1,top:n.top,left:n.left,enableCanvas:n.enableCanvas,skipDateInterpolation:n.skipDateInterpolation},this.parent.notify(hi,{eventArgs:p,action:"beforeInsertChart"}),p.cancel)return[];n.type=p.type,n.theme=p.theme,n.isSeriesInRows=p.isSeriesInRows,n.markerSettings=p.markerSettings,n.range=p.range,n.id=p.id,n.height=p.height,n.width=p.width,p.enableCanvas&&(n.enableCanvas=p.enableCanvas),p.skipDateInterpolation&&(n.skipDateInterpolation=p.skipDateInterpolation)}var M=this.processChartSeries(c,t.dataSheetIdx,x,I,D,C.isDateTime);this.isDateFormatRange=M.isDateFormat;var E={majorGridLines:n.primaryXAxis&&n.primaryXAxis.majorGridLines&&!g(n.primaryXAxis.majorGridLines.width)?{width:n.primaryXAxis.majorGridLines.width}:{width:0},minorGridLines:n.primaryXAxis&&n.primaryXAxis.minorGridLines&&!g(n.primaryXAxis.minorGridLines.width)?{width:n.primaryXAxis.minorGridLines.width}:{width:0},majorTickLines:n.primaryXAxis&&n.primaryXAxis.majorTickLines&&!g(n.primaryXAxis.majorTickLines.width)?{width:n.primaryXAxis.majorTickLines.width}:{width:1},minorTicksPerInterval:n.primaryXAxis&&n.primaryXAxis.minorGridLines&&n.primaryXAxis.minorGridLines.width>0?5:0,labelStyle:n.primaryXAxis&&n.primaryXAxis.labelStyle&&!g(n.primaryXAxis.labelStyle.size)?{size:n.primaryXAxis.labelStyle.size}:{},edgeLabelPlacement:"Shift",lineStyle:{width:0},crossesAt:0,rangePadding:n.type==="Scatter"&&!C.isStringSeries&&!n.isSeriesInRows?"Round":"Auto",title:n.primaryXAxis?n.primaryXAxis.title:""};this.isDateFormatRange?(this.minDate=M.minDate,this.maxDate=M.maxDate,E.valueType="DateTime",E.minimum=this.minDate,E.maximum=this.maxDate):E.valueType=n.type==="Scatter"&&!C.isStringSeries&&!n.isSeriesInRows?"Double":"Category",n.primaryXAxis&&n.primaryXAxis.visible===!1&&(delete n.primaryXAxis.visible,n.primaryXAxis.majorTickLines={width:0},E.majorTickLines={width:0},n.primaryXAxis.labelStyle={size:"0px"},E.labelStyle={size:"0px"});var A={majorGridLines:n.primaryYAxis&&n.primaryYAxis.majorGridLines&&!g(n.primaryYAxis.majorGridLines.width)?{width:n.primaryYAxis.majorGridLines.width}:{width:1},minorGridLines:n.primaryYAxis&&n.primaryYAxis.minorGridLines&&!g(n.primaryYAxis.minorGridLines.width)?{width:n.primaryYAxis.minorGridLines.width}:{width:0},majorTickLines:n.primaryYAxis&&n.primaryYAxis.majorTickLines&&!g(n.primaryYAxis.majorTickLines.width)?{width:n.primaryYAxis.majorTickLines.width}:{width:1},minorTicksPerInterval:n.primaryYAxis&&n.primaryYAxis.minorGridLines&&n.primaryYAxis.minorGridLines.width>0?5:0,labelStyle:n.primaryYAxis&&n.primaryYAxis.labelStyle&&!g(n.primaryYAxis.labelStyle.size)?{size:n.primaryYAxis.labelStyle.size}:{},edgeLabelPlacement:"Shift",lineStyle:{width:0},crossesAt:this.isDateFormatRange?null:0,title:n.primaryYAxis?n.primaryYAxis.title:""};if(n.primaryYAxis&&n.primaryYAxis.visible===!1&&(delete n.primaryYAxis.visible,n.primaryYAxis.majorTickLines={width:0},A.majorTickLines={width:0},n.primaryYAxis.labelStyle={size:"0px"},A.labelStyle={size:"0px"}),this.primaryYAxisFormat=this.getAxisFormat(I,a),this.primaryXAxisFormat=this.getAxisFormat(x,a),t.isRefresh){var L=this.parent.element.querySelector("."+n.id),N=void 0;if(L){N=ot(L,"chart");var R=t.isSwitchRowColumn&&n.type==="Scatter",P=n.type!=="Pie"&&n.type!=="Doughnut";(R||P)&&(this.isDateFormatRange?(N.primaryXAxis.valueType="DateTime",N.primaryXAxis.minimum=this.minDate,N.primaryXAxis.maximum=this.maxDate):(N.primaryXAxis.valueType=R&&!C.isStringSeries&&!n.isSeriesInRows?"Double":"Category",N.primaryXAxis.minimum&&(N.primaryXAxis.minimum=null),N.primaryXAxis.maximum&&(N.primaryXAxis.maximum=null)))}return M.series}var k=n.id+"_overlay",B=this.parent.serviceLocator.getService(j0),F=B.insertOverlayElement(k,f,v);F.element.classList.add("e-datavisualization-chart"),F.element.style.width=n.width+"px",F.element.style.height=n.height+"px",a&&(a.frozenRows||a.frozenColumns)?B.adjustFreezePaneSize(n,F.element,f):(g(n.top)?n.top=F.top:F.element.style.top=Number(os(n.top).toFixed(2))+"px",g(n.left)?n.left=F.left:F.element.style.left=Number(os(n.left).toFixed(2))+"px"),this.parent.notify(RD,{height:n.height,width:n.width});var O=n.type==="Pie"||n.type==="Doughnut"?{position:"Bottom",visible:!0}:{};g(n.legendSettings)||(O.visible=n.legendSettings.visible,O.position=n.legendSettings.position);var z=n.theme||"Material",Y=Math.round(parseFloat(getComputedStyle(F.element).borderWidth))*2,K=parseFloat(F.element.style.height)-(isNaN(Y)?0:Y)+"px",U=this.parent.createElement("div",{id:n.id,className:n.id});return n.type!=="Pie"&&n.type!=="Doughnut"?(this.chart=new yb({primaryXAxis:E,primaryYAxis:A,background:this.getThemeBgColor(z),chartArea:{border:{width:0}},title:n.title,legendSettings:O,theme:z,series:M.series,tooltip:{enable:!0,format:"${point.x} : <b>${point.tooltip}</b>"},width:F.element.style.width,height:K,enableRtl:this.parent.enableRtl,enableCanvas:!!n.enableCanvas,load:function(q){q.chart.theme=n.theme||"Material"},beforeResize:function(q){q.cancelResizedEvent=!0},tooltipRender:function(q){if(e.isDateFormatRange){if(e.primaryXAxisFormat){var ae=q.point,te=ls(new Date(ae.xValue)),he=e.parent.getDisplayText({format:e.primaryXAxisFormat,value:te.toString()});q.text=he+" : <b>"+ae.yValue+"</b>"}}else if(C.isDateTime){var ue=q.point.x&&e.isDateTimeNegativeValue(q.point.x.toString()),ne=q.point.tooltip&&e.isDateTimeNegativeValue(q.point.tooltip.toString());if(ue||ne){var ae=q.point,he=ue?ae.xValue:q.point.x,le=ne?ae.yValue:q.point.tooltip;q.text=he+" : <b>"+le+"</b>"}}},axisLabelRender:function(q){if(q.axis.name==="primaryYAxis"&&e.primaryYAxisFormat&&!n.type.includes("100")&&!g(q.value)&&e.parent?q.text=e.parent.getDisplayText({format:e.primaryYAxisFormat,value:q.value.toString()}):q.axis.name==="primaryXAxis"&&q.text.startsWith("spread-chart-empty-label-")&&(q.text=""),q.axis.name==="primaryXAxis"){if(n.type==="Scatter"&&!C.isDateTime)q.axis.labels.length>0&&!De(q.text)?q.text=(q.axis.labels.indexOf(q.text)+1).toString():e.primaryXAxisFormat&&!g(q.value)&&(q.text=e.parent.getDisplayText({format:e.primaryXAxisFormat,value:q.value.toString()}));else if(e.isDateFormatRange&&e.primaryXAxisFormat){var ae=ls(new Date(q.value));q.text=e.parent.getDisplayText({format:e.primaryXAxisFormat,value:ae.toString()})}}C.isDateTime&&q.text&&e.isDateTimeNegativeValue(q.text)&&(q.cancel=!0)},seriesRender:function(q){e.isDateFormatRange&&(n.type.includes("Area")||n.type.includes("Line"))&&q.data.sort(function(ae,te){return ae.x.getTime()-te.x.getTime()})}}),this.chart.appendTo(U)):(this.chart=new oM({title:n.title,legendSettings:O,theme:z,background:this.getThemeBgColor(z),series:M.series,width:F.element.style.width,height:K,center:{x:"50%",y:"50%"},tooltip:{enable:!0,format:"${point.x} : <b>${point.tooltip}</b>"},enableSmartLabels:!0,enableAnimation:!0,enableRtl:this.parent.enableRtl,load:function(q){q.chart.theme=n.theme||"Material"},beforeResize:function(q){q.cancelResizedEvent=!0}}),this.chart.appendTo(U)),F.element.appendChild(U),F.element.classList.contains("e-ss-overlay-active")&&!m&&this.parent.notify(ep,{id:F.element.id}),t.triggerEvent&&this.parent.notify(wt,{eventArgs:p,action:"insertChart"}),d},o.prototype.isDateTimeNegativeValue=function(t){return t.startsWith("###")&&!t.split("#").join("")},o.prototype.deleteChart=function(t){this.clearBorder();var e=null,i=this.parent.getActiveSheet();if(g(t.id)?(e=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active"),t.id=e?e.getElementsByClassName("e-control")[0].id:null):(t.id=t.id.includes("overlay")?t.id:t.id+"_overlay",e=document.getElementById(t.id)),!g(t.id)){t.id=t.id.includes("overlay")?t.id:t.id+"_overlay";for(var r,n,s,a=!1,l,h=0,c=this.parent.chartColl.length;h<c;h++)if(this.parent.chartColl[h].id===t.id.split("_overlay")[0]){l=this.parent.chartColl[h];break}var u={id:l.id,range:l.range,type:l.type,markerSettings:l.markerSettings,dataLabelSettings:l.dataLabelSettings,title:l.title,legendSettings:l.legendSettings,primaryXAxis:l.primaryXAxis,primaryYAxis:l.primaryYAxis,theme:l.theme,height:l.height,width:l.width,isSeriesInRows:l.isSeriesInRows,isInitCell:!0,posRange:null,top:l.top,left:l.left,cancel:!1,enableCanvas:l.enableCanvas,skipDateInterpolation:l.skipDateInterpolation};if(e){var d=void 0,p=void 0;if(i.frozenRows||i.frozenColumns)if(l.address)r=l.address[0],n=l.address[1];else{var f=e.getBoundingClientRect();d={clientY:f.top},p={clientX:f.left},f.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(d.target=this.parent.getColumnHeaderContent()),f.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(p.target=this.parent.getRowHeaderTable()),this.parent.notify(Is,d),this.parent.notify(Ms,p),r=d.clientY,n=p.clientX}else d={clientY:parseFloat(e.style.top),isImage:!0},p={clientX:parseFloat(e.style.left),isImage:!0},this.parent.notify(Is,d),this.parent.notify(Ms,p),r=d.clientY,n=p.clientX;this.parent.notify(Qb,{id:t.id}),a=!0,i=this.parent.sheets[this.parent.activeSheetIndex]}else{this.parent.notify(Qb,{id:t.id});var v=t.range?t.range.lastIndexOf("!"):0,m=t.range&&v>0?Ct(this.parent,t.range.substring(0,v)):this.parent.activeSheetIndex,y=t.range?v>0?t.range.substring(v+1):t.range:this.parent.getActiveSheet().selectedRange,b=ie(y);r=b[0],n=b[1],i=this.parent.sheets[m]}var S=Q(r,n,i);S&&(s=S.chart);for(var C=s?s.length:null,h=0;h<C;h++)t.id===s[h].id+"_overlay"&&(s.splice(h,1),C=s.length);a&&(document.getElementById(t.id).remove(),Re(this.parent.element),this.parent.notify(Go,{})),Zt(r,n,i,{chart:s},!0),u.posRange=i.name+"!"+st(r,n),t.isUndoRedo||this.parent.notify(wt,{eventArgs:u,action:"deleteChart",isClearAction:t.clearAction})}},o.prototype.updateChartModel=function(t,e,i,r,n){var s=e;e=e;var a=this.parent.chartColl[r].id;if(!(n&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(t)>-1)&&!(!i||g(i.chart))){for(var l=0,h=i.chart.length;l<h;l++)if(i.chart[l].id===a)switch(t){case"PHAxes":case"PHAxisTitle":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),t==="PHAxes"?(g(i.chart[l].primaryXAxis.majorTickLines)&&(i.chart[l].primaryXAxis.majorTickLines={},this.parent.chartColl[r].primaryXAxis.majorTickLines={}),i.chart[l].primaryXAxis.majorTickLines.width=e.primaryXAxis.majorTickLines.width,this.parent.chartColl[r].primaryXAxis.majorTickLines.width=e.primaryXAxis.majorTickLines.width,g(i.chart[l].primaryXAxis.labelStyle)&&(i.chart[l].primaryXAxis.labelStyle={},this.parent.chartColl[r].primaryXAxis.labelStyle={}),i.chart[l].primaryXAxis.labelStyle.size=e.primaryXAxis.labelStyle.size,this.parent.chartColl[r].primaryXAxis.labelStyle.size=e.primaryXAxis.labelStyle.size):t==="PHAxisTitle"&&(i.chart[l].primaryXAxis.title=e.primaryXAxis.title,this.parent.chartColl[r].primaryXAxis.title=e.primaryXAxis.title);break;case"PVAxes":case"PVAxisTitle":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),t==="PVAxes"?(g(i.chart[l].primaryYAxis.majorTickLines)&&(i.chart[l].primaryYAxis.majorTickLines={},this.parent.chartColl[r].primaryYAxis.majorTickLines={}),i.chart[l].primaryYAxis.majorTickLines.width=e.primaryYAxis.majorTickLines.width,this.parent.chartColl[r].primaryYAxis.majorTickLines.width=e.primaryYAxis.majorTickLines.width,g(i.chart[l].primaryYAxis.labelStyle)&&(i.chart[l].primaryYAxis.labelStyle={},this.parent.chartColl[r].primaryYAxis.labelStyle={}),i.chart[l].primaryYAxis.labelStyle.size=e.primaryYAxis.labelStyle.size,this.parent.chartColl[r].primaryYAxis.labelStyle.size=e.primaryYAxis.labelStyle.size):t==="PVAxisTitle"&&(i.chart[l].primaryYAxis.title=e.primaryYAxis.title,this.parent.chartColl[r].primaryYAxis.title=e.primaryYAxis.title);break;case"ChartTitleNone":case"ChartTitleAbove":i.chart[l].title=e.title,this.parent.chartColl[r].title=e.title;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(g(i.chart[l].dataLabelSettings)&&(i.chart[l].dataLabelSettings={},this.parent.chartColl[r].dataLabelSettings={}),t==="DLNone")i.chart[l].dataLabelSettings.visible=!1,this.parent.chartColl[r].dataLabelSettings.visible=!1;else{i.chart[l].dataLabelSettings.visible=!0,this.parent.chartColl[r].dataLabelSettings.visible=!0;var c=void 0;n?c=s.series[0].dataLabel.position==="Outside"?"Outer":"Middle":c=e.series[0].marker.dataLabel.position,i.chart[l].dataLabelSettings.position=c,this.parent.chartColl[r].dataLabelSettings.position=c}break;case"GLMajorHorizontal":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),g(i.chart[l].primaryYAxis.majorGridLines)&&(i.chart[l].primaryYAxis.majorGridLines={},this.parent.chartColl[r].primaryYAxis.majorGridLines={}),i.chart[l].primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width,this.parent.chartColl[r].primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width;break;case"GLMajorVertical":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),g(i.chart[l].primaryXAxis.majorGridLines)&&(i.chart[l].primaryXAxis.majorGridLines={},this.parent.chartColl[r].primaryXAxis.majorGridLines={}),i.chart[l].primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width,this.parent.chartColl[r].primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width;break;case"GLMinorHorizontal":g(i.chart[l].primaryYAxis)&&(i.chart[l].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),g(i.chart[l].primaryYAxis.minorGridLines)&&(i.chart[l].primaryYAxis.minorGridLines={},this.parent.chartColl[r].primaryYAxis.minorGridLines={}),i.chart[l].primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width,this.parent.chartColl[r].primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width;break;case"GLMinorVertical":g(i.chart[l].primaryXAxis)&&(i.chart[l].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),g(i.chart[l].primaryXAxis.minorGridLines)&&(i.chart[l].primaryXAxis.minorGridLines={},this.parent.chartColl[r].primaryXAxis.minorGridLines={}),i.chart[l].primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width,this.parent.chartColl[r].primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width;break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":if(g(i.chart[l].legendSettings)&&(i.chart[l].legendSettings={},this.parent.chartColl[r].legendSettings={}),i.chart[l].legendSettings.visible=e.legendSettings.visible,this.parent.chartColl[r].legendSettings.visible=e.legendSettings.visible,t!=="LegendNone"){i.chart[l].legendSettings.position=e.legendSettings.position,this.parent.chartColl[r].legendSettings.position=e.legendSettings.position;break}}}},o.prototype.updateChartElement=function(t,e,i,r,n,s,a,l,h,c,u){var d;if(h){var p=new Map([["PHAxes","PVAxes"],["PVAxes","PHAxes"],["PHAxisTitle","PVAxisTitle"],["PVAxisTitle","PHAxisTitle"],["GLMajorHorizontal","GLMajorVertical"],["GLMajorVertical","GLMajorHorizontal"],["GLMinorHorizontal","GLMinorVertical"],["GLMinorVertical","GLMinorHorizontal"]]),f=p.get(t);f&&(t=f)}switch(t){case"PHAxes":e=e,e.primaryXAxis.labelStyle.size==="0px"?(e.primaryXAxis.labelStyle.size=s,e.primaryXAxis.majorTickLines.width=1):(e.primaryXAxis.labelStyle.size="0px",e.primaryXAxis.majorTickLines.width=0);break;case"PVAxes":e=e,e.primaryYAxis.labelStyle.size==="0px"?(e.primaryYAxis.labelStyle.size=a,e.primaryYAxis.majorTickLines.width=1):(e.primaryYAxis.labelStyle.size="0px",e.primaryYAxis.majorTickLines.width=0);break;case"PHAxisTitle":e=e,e.primaryXAxis.title=n;break;case"PVAxisTitle":e=e,e.primaryYAxis.title=n;break;case"ChartTitleNone":e.title="";break;case"ChartTitleAbove":e.title=n;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(e=e,d=e.series,t==="DLNone")for(var v=0,m=d.length;v<m;v++)l?d[v].dataLabel.visible=!1:d[v].marker.dataLabel.visible=!1;else for(var v=0,m=d.length;v<m;v++)if(l){var y=t==="DLOutsideend"?"Outside":"Inside";d[v].dataLabel.visible=!0,d[v].dataLabel.position=y}else{var y=t==="DLCenter"?"Middle":t==="DLInsideend"?"Top":t==="DLInsidebase"?"Bottom":t==="DLOutsideend"?"Outer":d[0].marker.dataLabel.position;d[v].marker.dataLabel.visible=!0,d[v].marker.dataLabel.position=y}e.series=d,l&&e.refresh();break;case"GLMajorHorizontal":e=e,e.primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width===0?1:0;break;case"GLMajorVertical":e=e,e.primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width===0?1:0;break;case"GLMinorHorizontal":e=e,e.primaryYAxis.minorTicksPerInterval=e.primaryYAxis.minorGridLines.width===0?5:0,e.primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width===0?1:0;break;case"GLMinorVertical":e=e,e.primaryXAxis.minorTicksPerInterval=e.primaryXAxis.minorGridLines.width===0?5:0,e.primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width===0?1:0;break;case"LegendNone":e.legendSettings.visible=!1;break;case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":e.legendSettings.visible=!0,e.legendSettings.position=t==="LegendsRight"?"Right":t==="LegendsLeft"?"Left":t==="LegendsBottom"?"Bottom":t==="LegendsTop"?"Top":e.legendSettings.position;break}if(this.updateChartModel(t,e,i,r,l),u){var b={addChartEle:t,id:e.element.id+"_overlay",title:n,address:c};this.parent.notify(wt,{action:"chartDesign",eventArgs:b})}},o.prototype.undoRedoForChartDesign=function(t){var e=document.getElementById(t.id);if(e){var i=!1,r=this.getChartElement(e),n=ot(r,"chart");g(n)&&(n=ot(r,"accumulationchart"),i=!0);var s=this.parent.getAddressInfo(t.address),a=Q(s.indices[0],s.indices[1],ke(this.parent,s.sheetIndex));if(!(!a||g(a.chart))){for(var l=this.getChartCollectionId(r.id),h,c=t.addChartEle,u=t.title,d=0;d<t.beforeActionData.cellDetails[0].chart.length;d++)if(r.id===t.beforeActionData.cellDetails[0].chart[d].id){h=t.beforeActionData.cellDetails[0].chart[d];break}var p=g(h.markerSettings)?!1:h.markerSettings.visible;if(t.switchRowColumn)this.switchRowColumn(l,r.id,n,a);else if(t.chartTheme)this.switchChartTheme(l,r.id,t.isUndo?h.theme:t.chartTheme,n,a);else if(t.chartType)this.switchChartType(l,r.id,t.isUndo?h.type:t.chartType,n,a,!1,t.isUndo?p:t.chartMarker,"undoRedo");else if(t.addChartEle){if(t.isUndo){var f=void 0;switch(c){case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":f=h.dataLabelSettings&&h.dataLabelSettings.position,c=f==="Middle"?"DLCenter":f==="Top"?"DLInsideend":f==="Bottom"?"DLInsidebase":f==="Outer"?"DLOutsideend":"DLNone";break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":h.legendSettings&&!h.legendSettings.visible?f="LegendNone":(f=h.legendSettings&&h.legendSettings.position,c=f==="Right"?"LegendsRight":f==="Left"?"LegendsLeft":f==="Bottom"?"LegendsBottom":f==="Top"?"LegendsTop":"LegendsBottom");break;case"PVAxisTitle":u=h.primaryYAxis&&h.primaryYAxis.title;break;case"PHAxisTitle":u=h.primaryXAxis&&h.primaryXAxis.title;break;case"ChartTitleNone":case"ChartTitleAbove":u=h.title;break}}var v=h.type.includes("Bar")&&c!=="PHAxisTitle"&&c!=="PVAxisTitle";this.updateChartElement(c,n,a,l,u,t.pXAxisLSize,t.pYAxisLSize,i,v,t.address)}}}},o.prototype.chartDesignTabHandler=function(t){var e=!1,i,r,n=this.parent.sheets[this.parent.activeSheetIndex],s=t.switchRowColumn,a=t.chartType,l=t.chartTheme,h=t.addChartEle,c=null,u=t.id?document.getElementById(t.id):document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(u){var d=h==="ChartTitleAbove"||h==="PHAxisTitle"||h==="PVAxisTitle",p,f;if(n.frozenRows||n.frozenColumns){var v=u.getBoundingClientRect();p={clientY:v.top},f={clientX:v.left},v.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(p.target=this.parent.getColumnHeaderContent()),v.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(f.target=this.parent.getRowHeaderTable())}else p={clientY:u.offsetTop,isImage:!0},f={clientX:u.offsetLeft,isImage:!0};this.parent.notify(Is,p),this.parent.notify(Ms,f);var m=Q(p.clientY,f.clientX,n);if(!(!m||g(m.chart))){var y=n.name+"!"+st(p.clientY,f.clientX);if(t.triggerEvent){var b={switchRowColumn:t.switchRowColumn,chartType:t.chartType,chartTheme:t.chartTheme,addChartEle:t.addChartEle,id:u.id,address:y,cancel:!1};if(this.parent.notify(hi,{action:"chartDesign",eventArgs:b}),b.cancel)return}var S=this.getChartElement(u),C=S.getAttribute("id"),x=this.getChartCollectionId(C);if(S&&(c=ot(S,"chart"),g(c)&&(c=ot(S,"accumulationchart"),e=!0)),!e&&(h==="PVAxes"||h==="PHAxes")&&(c=c,c.primaryXAxis.labelStyle.size!=="0px"&&(i=c.primaryXAxis.labelStyle.size),c.primaryYAxis.labelStyle.size!=="0px"&&(r=c.primaryYAxis.labelStyle.size)),s&&this.switchRowColumn(x,C,c,m),a&&this.switchChartType(x,C,a,c,m,t.markerVisible),l&&this.switchChartTheme(x,C,l,c,m),h){var I=m.chart[x],D=I&&I.type.includes("Bar");if(d&&!t.title){if(this.parent.element.getElementsByClassName("e-title-dlg").length>0)return;this.titleDlgHandler(h,c,m,x,e,y,t.triggerEvent,D)}else this.updateChartElement(h,c,m,x,t.title,i,r,e,D)}if(t.triggerEvent&&!d){var b={switchRowColumn:t.switchRowColumn,chartType:t.chartType,chartMarker:t.markerVisible,chartTheme:t.chartTheme,addChartEle:t.addChartEle,id:u.id,address:y,pXAxisLSize:i,pYAxisLSize:r};this.parent.notify(wt,{action:"chartDesign",eventArgs:b})}}}},o.prototype.switchRowColumn=function(t,e,i,r){var n=this.parent.chartColl[t];n.isSeriesInRows=g(n.isSeriesInRows)?!0:!n.isSeriesInRows;for(var s=0,a=r.chart.length;s<a;s++)r.chart[s].id===e&&(r.chart[s].isSeriesInRows=n.isSeriesInRows);var l=this.initiateChartHandler({option:n,isRefresh:!0,isSwitchRowColumn:!0});i.series=l,i.refresh()},o.prototype.switchChartTheme=function(t,e,i,r,n){this.parent.chartColl[t].theme=i;for(var s=0,a=n.chart.length;s<a;s++)n.chart[s].id===e&&(n.chart[s].theme=i);r.setProperties({theme:i,background:this.getThemeBgColor(i)},!0),r.refresh()},o.prototype.getThemeBgColor=function(t){var e;if(t.includes("Dark"))switch(t){case"MaterialDark":e="#383838";break;case"FabricDark":e="#242424";break;case"BootstrapDark":e="#1b1b1b";break;case"Bootstrap5Dark":e="#212529";break;case"TailwindDark":e="#1f2937";break;case"Tailwind3Dark":e="#111827";break;case"FluentDark":e="#1b1a19";break;case"Fluent2Dark":e="#292929";break;case"Material3Dark":e="#1C1B1F";break}else t.includes("HighContrast")?e="#000000":e="#FFFFFF";return e},o.prototype.switchChartType=function(t,e,i,r,n,s,a,l){var h=this.parent.chartColl[t].type;this.parent.chartColl[t].type=i;for(var c=0,u=n.chart.length;c<u;c++)n.chart[c].id===e&&(n.chart[c].type=i,g(n.chart[c].markerSettings)||(n.chart[c].markerSettings.visible=s));if(i!=="Pie"&&i!=="Doughnut")if(h==="Pie"||h==="Doughnut")g(this.parent.chartColl[t].markerSettings)?s&&(i==="Line"||i==="StackingLine"||i==="StackingLine100")&&(this.parent.chartColl[t].markerSettings={shape:"Circle",visible:!0,isFilled:!1}):s?this.parent.chartColl[t].markerSettings.visible=s:l==="undoRedo"?this.parent.chartColl[t].markerSettings.visible=a:this.parent.chartColl[t].markerSettings.visible=!1,this.changeCharType(t);else{if(h!==i)if(i==="Scatter"){var d=r.primaryXAxis.labels;d&&d.length>0&&De(d[d.length-1])&&(r.primaryXAxis.valueType="Double")}else r.primaryXAxis.valueType==="Double"&&(r.primaryXAxis.valueType="Category");for(var p=r.series,f=i==="Line"||i==="StackingLine"||i==="StackingLine100",c=0,v=p.length;c<v;c++)p[c].type=i,f?(p[c].marker.visible=s,p[c].marker.shape=g(p[c].marker.shape)?"Circle":p[c].marker.shape,l==="undoRedo"&&(p[c].marker.visible=a)):p[c].marker.visible=!1;r.series=p,r.refresh()}else if(h==="Pie"||h==="Doughnut"){for(var p=r.series,c=0,v=p.length;c<v;c++)p[c].innerRadius=i==="Pie"?"0%":"40%";r.series=p,r.refresh()}else this.changeCharType(t)},o.prototype.getChartElement=function(t){var e=t.querySelector(".e-chart");return g(e)&&(e=t.querySelector(".e-accumulationchart")),e},o.prototype.getChartCollectionId=function(t){for(var e,i=0,r=this.parent.chartColl.length;i<r;i++)t===this.parent.chartColl[i].id&&(e=i);return e},o.prototype.changeCharType=function(t){var e=document.getElementById(this.parent.chartColl[t].id),i=H(e,".e-datavisualization-chart");i.remove(),this.initiateChartHandler({option:this.parent.chartColl[t],isInitCell:!1,triggerEvent:!1,isPaste:!1,isChangeChartType:!0}),e=document.getElementById(this.parent.chartColl[t].id),i=H(e,".e-datavisualization-chart"),i.classList.contains("e-ss-overlay-active")||i.classList.add("e-ss-overlay-active")},o.prototype.titleDlgHandler=function(t,e,i,r,n,s,a,l){var h=this,c="";if(!(n&&(t==="PHAxisTitle"||t==="PVAxisTitle"))){var u=this.parent.serviceLocator.getService(ve),d=this.parent.serviceLocator.getService(jt);d.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-title-dlg",header:t==="chart_abovechart"?u.getConstant("ChartTitle"):t==="PHAxisTitle"?u.getConstant("HorizontalAxisTitle"):u.getConstant("VerticalAxisTitle"),beforeOpen:function(){d.dialogInstance.content=h.titleDlgContent(t,e,l),d.dialogInstance.dataBind(),h.parent.element.focus()},buttons:[{buttonModel:{content:u.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn e-clearall-btn e-flat"},click:function(){var p=h.parent.element.querySelector(".e-title-dlg").getElementsByClassName("e-title-dlg-content")[0];c=p.getElementsByTagName("input")[0].value,d.hide(),h.updateChartElement(t,e,i,r,c,null,null,null,l,s,a)}}]}),d.dialogInstance.refresh()}},o.prototype.titleDlgContent=function(t,e,i){var r=this.parent.serviceLocator.getService(ve),n=this.parent.createElement("div",{className:"e-title-dlg-content"}),s=this.parent.createElement("span",{className:"e-header e-top-header"});s.innerText=r.getConstant("EnterTitle");var a=this.parent.createElement("input",{className:"e-input",id:"titleInput",attrs:{type:"text"}});return n.appendChild(s),n.appendChild(a),e&&(t==="PHAxisTitle"?i?a.value=e.primaryYAxis.title?e.primaryYAxis.title:a.value:a.value=e.primaryXAxis.title?e.primaryXAxis.title:a.value:t==="PVAxisTitle"?i?a.value=e.primaryXAxis.title?e.primaryXAxis.title:a.value:a.value=e.primaryYAxis.title?e.primaryYAxis.title:a.value:a.value=e.title?e.title:a.value),n},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Gb,this.initiateChartHandler),this.parent.off(Uc,this.refreshChartCellObj),this.parent.off(Ig,this.refreshChartCellObj),this.parent.off(A0,this.refreshChartCellModel),this.parent.off(lu,this.deleteChart),this.parent.off(N0,this.clearBorder),this.parent.off(AD,this.insertChartHandler),this.parent.off(Id,this.chartRangeHandler),this.parent.off(Wc,this.chartDesignTabHandler),this.parent.off(LD,this.undoRedoForChartDesign),this.parent.off(Xo,this.refreshChartData))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.isDateFormatRange=null,this.minDate=null,this.maxDate=null,this.primaryYAxisFormat=null,this.primaryXAxisFormat=null;var t=null;this.chart&&(t=this.chart.element,this.chart.destroy()),t&&se(t),this.chart=null},o.prototype.getModuleName=function(){return"spreadsheetChart"},o})(),lG=(function(){function o(t){this.totalSheetCount=[],this.workbookActiveSheetCount=0,this.defaultCellWidth=64,this.defaultCellHeight=19,this.pageCounts=[],this.initialRowCount=0,this.chartHeight=0,this.columnIndex=0,this.rowIndex=0,this.multipleCanvasDataURL=[],this.chartElements=[],this.totalCharts=0,this.isChartLoaded=!1,this.chartLoadedCount=0,this.isImageLoaded=!1,this.totalImages=0,this.imageLoadedCount=0,this.endRow=0,this.isColumn=!0,this.startNewPageCount=0,this.allowTimer=!1,this.parent=t}return o.prototype.print=function(t,e){var i=this;if(t.isPrintingProcessing=!0,this.multipleCanvasDataURL=[],this.chartElements=[],e.type==="ActiveSheet"){var r=t.sheets[t.activeSheetIndex];this.activeSheetPrint(t,r,e,t.activeSheetIndex)}else{this.totalSheetCount=[],this.workbookActiveSheetCount=1;for(var n=0;n<t.sheets.length;n++)if(t.sheets[n].state==="Visible"&&(this.totalSheetCount.push(n),this.totalSheetCount.length>1&&this.parent.sheets[n].ranges.length>0)){var s=this.parent.sheets[n].ranges.some(function(h){return!g(h.dataSource)});if(s){this.allowTimer=!0;var r=t.sheets[n],a=st(0,0)+":"+st(r.rowCount-1,r.colCount-1),l=Ji(a);this.parent.notify(Bh,{sheet:r,indexes:l})}}this.allowTimer?(this.allowTimer=!1,setTimeout(function(){i.activeSheetPrint(t,t.sheets[i.totalSheetCount[0]],e,i.totalSheetCount[0])},2e3)):this.activeSheetPrint(t,t.sheets[this.totalSheetCount[0]],e,this.totalSheetCount[0])}},o.prototype.updateChartRowAndColumnIndices=function(t,e){var i=t.sheets[e];if(this.rowIndex=i.usedRange.rowIndex,this.columnIndex=i.usedRange.colIndex,t.chartColl.length>0)for(var r=0;r<t.chartColl.length;r++){var n=t.chartColl[r],s=Ct(t,n.range.substring(0,n.range.lastIndexOf("!")));if(e===s){var a={clientX:n.left,isImage:!0},l={clientY:n.top,isImage:!0};t.notify(Is,l),t.notify(Ms,a),l.clientY>i.usedRange.rowIndex&&(this.rowIndex=Math.max(this.rowIndex,l.clientY)),a.clientX>i.usedRange.colIndex&&(this.columnIndex=Math.max(this.columnIndex,a.clientX))}}},o.prototype.activeSheetPrint=function(t,e,i,r){this.updateChartRowAndColumnIndices(t,r),this.pageCounts=this.calculatePageCount(e,1e3,i.allowRowColumnHeader);var n,s;this.initialRowCount=0,this.parent.currentPrintSheetIndex=r,this.endRow=this.rowIndex+1,this.processCell(0,0,this.endRow,2,[],s,n,e,this,0,0,!0,r,i)},o.prototype.processCell=function(t,e,i,r,n,s,a,l,h,c,u,d,p,f){var v=this;c===void 0&&(c=0),u===void 0&&(u=0),d===void 0&&(d=!0);var m=0,y=f.allowRowColumnHeader,b=37,S=0;this.chartHeight=0;for(var C=!1,x=t;x<this.pageCounts.length;x++){this.chartLoadedCount=0,this.totalCharts=0,this.imageLoadedCount=0,this.totalImages=0,c+=x===0?0:1100,a=document.createElement("canvas"),s=a.getContext("2d"),a.width=1e3,a.height=1100,s.font="11pt Calibri",s.textBaseline="bottom",s.index=x,s.width=1e3,(d||!this.isImageLoaded&&!this.isChartLoaded)&&(n=[],r=0,u=0);for(var I=e;I<this.endRow;I++){d=!0;var D=!1;this.isColumn=this.isColumn?this.isColumn:I===0;var M={borderBottom:"1px solid black"},E=l.rows[I]&&l.rows[I].height||this.defaultCellHeight;this.initialRowCount=I,r=m;var A=x===0?0:this.pageCounts[x-1]+1,L=this.pageCounts[x];u+=g(l.rows[I])?this.defaultCellHeight:E+(I===0&&y?this.defaultCellHeight:0);var N=g(l.rows[I])?this.defaultCellHeight:l.rows[I]&&l.rows[I].height||this.defaultCellHeight;if(u>1080){if(this.startNewPageCount=I,S=y?E+(I===0&&y?this.defaultCellHeight:0):0,D=!1,this.isColumn=!0,this.isImageLoaded||this.isChartLoaded)break;c+=1100,d&&this.multipleCanvasDataURL.push(a.toDataURL()),d=!0,a=document.createElement("canvas"),s=a.getContext("2d"),a.width=1e3,a.height=1100,s.font="11pt Calibri",s.textBaseline="bottom",s.index=x,s.width=1e3;for(var R=0;R<n.length;R++)n[R]!==void 0&&(n[R]-=u-N);u=y||f.allowGridLines?E+(y?this.defaultCellHeight:0):E}var P={borderBottom:"1px solid black",borderTop:"1px solid black",borderLeft:"1px solid black",borderRight:"1px solid black"},k={borderRight:"1px solid black"};if(y&&this.isColumn)for(var B=A;B<=L;B++){var F=ji(B+1),O=B===A?2:1;s.font="11pt Calibri";for(var R=0;R<O;R++){var z=R===0&&O===2?b:l.columns[B]&&l.columns[B].hidden?0:l.columns[B]&&l.columns[B].width||this.defaultCellWidth;if(z=r+z>1e3?z-1-(r+z-1e3):z,z!==0){var Y=s.measureText(F),K=Y.width,U=h.calculateTextPosition(K,z,r,"Center"),q=this.defaultCellHeight;s.fillText(B===A&&R===0?"":F,U,q),h.drawBorder(s,P,r,0,z,this.defaultCellHeight),r+=z,n[B]=this.defaultCellHeight,B===L&&(O===2?R===1:R===0)&&(this.isColumn=B!==L,r=0)}else B===L&&(this.isColumn=!1,r=0)}}if(!g(l.rows[I])&&(g(l.rows[I].hidden)||!l.rows[I].hidden)){D=this.endRow===l.rows.length?u+(l.rows[I+1]?l.rows[I+1].height||this.defaultCellHeight:this.defaultCellHeight)+(I===0&&y?this.defaultCellHeight:0)>1080||I===l.rows.length-1:!1;for(var ae=function($){var ee=l.rows[I]&&!g(l.rows[I].cells)&&l.rows[I].cells[$];if(!g(ee)&&!g(ee.style)&&(P=te.setBorderStyle(ee,P)),g(l.columns[$])||g(l.columns[$].hidden)||!l.columns[$].hidden){var He=!g(l.rows[I].cells)&&!g(l.rows[I].cells[$])&&!isNaN(l.rows[I].cells[$].colSpan)&&A>$+l.rows[I].cells[$].colSpan,qe=!g(l.rows[I].cells)&&!g(l.rows[I].cells[$])&&!isNaN(l.rows[I].cells[$].rowSpan)&&!(I+l.rows[I].cells[$].rowSpan>te.startNewPageCount)&&te.startNewPageCount!==0,we="",je,Ne,Ye=g(ee)||isNaN(ee.rowSpan)||He||qe?1:Math.max(ee.rowSpan,0);if(n[$]=isNaN(n[$])?m:n[$],y&&$===A){s.font="11pt Calibri";var dt=n[$];if(Ye>0)for(var Ke=0;Ke<(Ye===0?1:Ye);Ke++)r=0,dt+=Ke===0?0:l.rows[I+Ke]&&l.rows[I+Ke-1].height||te.defaultCellHeight,h.rowHeaderText((I+1+Ke).toString(),s,h,b,r,P,dt,l.rows[I+Ke].height||te.defaultCellHeight),r+=b;else r=0,r+=b}if(!g(ee)&&ee){var ci=ee.style&&ee.style.fontSize||"11pt",Jt=ee.style&&ee.style.color||"#000000";if(!isNaN(l.rows[I].cells[$].rowSpan)&&l.rows[I].cells[$].rowSpan>1&&isNaN(l.rows[I+1].cells[$].rowSpan)&&te.parent.merge(""+ji($+1)+(I+1)+":"+ji($+1)+(I+l.rows[I].cells[$].rowSpan-1)),!isNaN(l.rows[I].cells[$].colSpan)&&l.rows[I].cells[$].colSpan>1){if(!g(l.rows[I+1])&&!g(l.rows[I+1].cells)&&l.rows[I+1].cells.length>0&&!g(l.rows[I+1].cells[$])&&isNaN(l.rows[I+1].cells[$].colSpan))te.parent.merge(""+ji($+1)+(I+1)+":"+ji($+1+l.rows[I].cells[$].colSpan-1)+(I+1));else if(g(l.rows[I].cells[$+1].colSpan))for(var vt=1;vt<l.rows[I].cells[$].colSpan;vt++)l.rows[I].cells[$+vt].colSpan=-vt}if(je=isNaN(l.rows[I].cells[$].colSpan)||He?1:Math.max(l.rows[I].cells[$].colSpan,0),l.rows[I].cells[$].rowSpan&&!He&&l.rows[I].cells[$].rowSpan<0){var bi=l.rows[I+l.rows[I].cells[$].rowSpan].cells[$].colSpan;je=bi||je}($===A||$>0&&l.columns&&l.columns[$-1]&&l.columns[$-1].hidden&&l.rows[I].cells[$-1]&&l.rows[I].cells[$-1].colSpan>1)&&je<=0&&(je=1);var Bi=ee.style&&ee.style.backgroundColor||"#ffffff",Dr=ee.style?ee.style.textAlign:"";s.font=ci,s.fillStyle=Jt;var vr=[];if(je>1){for(var Fi=l.columns.slice($,$+je),Ke=0;Ke<Fi.length;Ke++)vr.push(Fi.hidden?0:Fi[Ke]&&Fi[Ke].width||te.defaultCellWidth);vr.length===0?vr.push(te.defaultCellWidth*je):vr.length!==je&&(vr=vr.map(function(Es){return Es+v.defaultCellWidth*(je-1-vr.length)}))}Ne=je>1?vr.reduce(function(Es,ap){return Es+ap},0):je===1?l.columns[$]&&l.columns[$].width||te.defaultCellWidth:0,Ne=r+Ne>1e3?Ne-1-(r+Ne-1e3):Ne,N=Ye>1?l.rows.slice(I,I+Ye).map(function(Es){return Es.height||v.defaultCellHeight}).reduce(function(Es,ap){return Es+(ap||v.defaultCellHeight)},0):Ye===1?E:0;var tr=(ee.style&&ee.style.verticalAlign||"Bottom").toLowerCase();if(!g(ee.image)&&ee.image.length>0&&te.processImages(x,I,ee,a,s,u,te.endRow,E,S,y,f,l,h,r,n,c,p),!g(ee.chart)&&ee.chart.length>0&&te.handleCharts(x,I,ee,s,a,u,te.endRow,te.initialRowCount,S,E,y,f,l,h,te.multipleCanvasDataURL,r,n,c,p),!g(ee.value)||!g(ee.formula)||!g(ee.hyperlink)){var _;if(ee.formula&&ee.format){te.parent.calculationMode==="Automatic"&&te.parent.notify(At,{action:"refreshCalculate",rowIndex:I,colIndex:$,value:ee.formula,isFormula:pt(ee.formula),sheetIndex:p});var re={value:ee.value,format:ee.format,rowIndex:I,colIndex:$,sheetIndex:te.parent.activeSheetIndex,cell:ee,refresh:!0};we=te.parent.workbookNumberFormatModule.getFormattedCell(re),_=""+(Dr||(re.isRightAlign?"Right":"Left")),re.color&&(Jt=re.color)}else if(ee.format){var re={value:ee.value,format:ee.format,rowIndex:I,colIndex:$,sheetIndex:te.parent.activeSheetIndex,cell:ee,refresh:!0};we=te.parent.workbookNumberFormatModule.getFormattedCell(re),_=""+(Dr||(re.isRightAlign?"Right":"Left")),re.color&&(Jt=re.color)}else if(ee.formula)te.parent.calculationMode==="Automatic"&&te.parent.notify(At,{action:"refreshCalculate",rowIndex:I,colIndex:$,value:ee.formula,isFormula:pt(ee.formula),sheetIndex:p}),we=ee.value,_=""+(Dr||"Left");else{g(ee.hyperlink)||(g(ee.value)?ee.value=!g(ee.hyperlink)&&typeof ee.hyperlink=="object"?ee.hyperlink.address:ee.hyperlink||ee.hyperlink.address:(g(ee.value)||ee.value==="")&&(ee.value=typeof ee.hyperlink=="object"?ee.hyperlink.address:ee.hyperlink),Jt=ee.style&&ee.style.color||"#00e"),we=ee.value;var Se=!g(ee.value)&&ee.value!==""?new RegExp("^[^\\p{L}]*$","u").test(ee.value):!1;_=""+(Dr||(Se?"Right":"Left"))}var Be=ee.style&&ee.style.fontSize||"11pt",_e=ee.style&&ee.style.fontFamily||"Calibri",We=ee.style&&ee.style.fontStyle||"",Dt=ee.style&&ee.style.fontWeight||"normal";s.font=We+" "+Dt+" "+Be+" "+_e;var _i=s.measureText(we),qt=_i.width,Kn=_i.actualBoundingBoxAscent+_i.actualBoundingBoxDescent;if(ee.wrap){var br=te.defaultCellHeight<N?parseInt(Be.replace("pt",""),10)/72*96:N,ql=ee.colSpan>1?$+ee.colSpan-1:$,Zo=zr(wi(l,$,ql)-(4+(eP(I,$,l)||1)),!0),Ba=te.wrapText(we,Zo,ee.style,te.parent.cellStyle),ja=Ba.length===1?N:Ba.length*br===N?br:Ba.length*br<N?N-(Ba.length-1)*br:br,sp=n[$]+(tr==="top"?br:tr==="middle"&&ja>br+ja/4?br+ja/4:ja);s.save(),s.beginPath(),s.rect(r,n[$],Ne,N),s.clip(),s.fillStyle=Bi,s.fillRect(r,n[$],Ne,N+(tr==="top"?br:0)),Ba.forEach(function(Es,ap){s.fillStyle=Jt,_i=s.measureText(Es),qt=_i.width;var Z0=h.calculateTextPosition(qt,Ne,r,_,!0),J0=sp+ap*br;_.toLowerCase()==="right"?(s.textAlign="right",s.fillText(Es.trim(),Z0,J0)):s.fillText(Es,Z0,J0),h.textDecoration(ee,s,Z0,J0,Jt,_i,we,Ne)}),s.restore()}else{s.save(),s.beginPath(),s.rect(r,n[$],Ne,N),s.clip(),s.fillStyle=Bi,s.fillRect(r,n[$],Ne,N),s.fillStyle=Jt;var Ha=h.calculateTextPosition(qt,Ne,r,_),Jo=n[$],Gr=N/2+Kn/2;tr==="top"?s.textBaseline="top":tr==="middle"&&N>Gr?Jo+=Gr:Jo+=N,g(ee.style)||(Jo=!g(ee.style.borderBottom)&&ee.style.borderBottom.indexOf("double")>-1||!g(ee.style.borderTop)&&ee.style.borderTop.indexOf("double")>-1?Jo-2:Jo,Ha=!g(ee.style.borderLeft)&&ee.style.borderLeft.indexOf("double")>-1||!g(ee.style.borderRight)&&ee.style.borderRight.indexOf("double")>-1?Ha+(_==="Left"?2:-3):Ha),s.fillText(we,Ha,Jo),s.restore(),h.textDecoration(ee,s,Ha,Jo,Jt,_i,we,Ne)}}else h.rowHeaderRect(s,r,n[$],Ne,N,Bi)}var hn=je<=0?Ne:Ne||l.columns[$]&&l.columns[$].width||te.defaultCellWidth;f.allowGridLines&&(P.borderRight=$===L&&y?void 0:"1px solid black",P.borderBottom="1px solid black",P.borderTop="1px solid black",P.borderLeft="1px solid black",h.drawBorder(s,P,r,n[$],hn,N)),ee&&ee.style&&(Ne>0||N>0)&&(ee.style.borderBottom||ee.style.borderTop||ee.style.borderLeft||ee.style.borderRight&&(g(ee.rowSpan)&&g(ee.colSpan)||!g(ee.rowSpan)&&ee.rowSpan>0||!g(ee.colSpan)&&ee.colSpan>0))&&h.drawBorder(s,ee.style,r,n[$]<=0?2:n[$],Ne,N),r+=hn;var $n=0;if(Ye>1){$n=n[$];for(var vt=$;vt<$+je;vt++){var Qr=l.rows[I]&&!g(l.rows[I].cells)&&l.rows[I].cells[vt];Qr&&!g(Qr.image)?te.processImages(x,I,Qr,a,s,u,te.endRow,E,S,y,f,l,h,r,n,c,p):Qr&&!g(Qr.chart)&&te.handleCharts(x,I,Qr,s,a,u,te.endRow,te.initialRowCount,S,E,y,f,l,h,te.multipleCanvasDataURL,r,n,c,p),Qr.style&&vt===$&&N>0&&(Qr.style.borderBottom||Qr.style.borderTop||Qr.style.borderLeft||Qr.style.borderRight)&&h.drawBorder(s,Qr.style,r,n[$],2,N),n[vt]=(isNaN(n[vt])?m:n[vt])+N}$+=je-1}$===L&&y&&h.drawBorder(s,k,r-2,n[$]-$n,2,N),$===L&&y&&D&&!C&&(h.drawBorder(s,M,0,n[$]-$n,r,N),D=!1),Ye<=1&&(n[$]+=N)}else if(y&&$===A){var Ye=g(ee)||isNaN(l.rows[I].cells[$].rowSpan)?1:Math.max(l.rows[I].cells[$].rowSpan,0);n[$]=isNaN(n[$])?m:n[$];var dt=n[$];s.font="11pt Calibri";for(var Ke=0;Ke<Ye;Ke++)r=0,dt+=Ke===0?0:l.rows[I+Ke]&&l.rows[I+Ke-1].height||te.defaultCellHeight,h.rowHeaderText((I+1+Ke).toString(),s,h,b,r,P,dt,l.rows[I+Ke].height||te.defaultCellHeight),r+=b;n[$]+=N}he=$},te=this,he,B=A;B<=L;B++)ae(B),B=he}else if(g(l.rows[I])){var ue={borderBottom:"1px solid black",borderTop:"1px solid black",borderLeft:"1px solid black",borderRight:"1px solid black"};D=u+N+(I===0&&y?this.defaultCellHeight:0)>1080||I===l.rows.length-1||I===this.endRow-1;for(var B=A;B<=L;B++){var ne=l.rows[I]&&!g(l.rows[I].cells)&&l.rows[I].cells[B];!g(ne)&&!g(ne.style)&&(ue=this.setBorderStyle(ne,ue)),y&&B===A&&(h.rowHeaderText((I+1).toString(),s,h,b,r,ue,n[B],this.defaultCellHeight),r+=b);var le=l.columns[B]&&l.columns[B].width||this.defaultCellWidth;le=r+le>1e3?le-1-(r+le-1e3):le,n[B]=isNaN(n[B])?m:n[B],f.allowGridLines?h.drawBorder(s,ue,r,n[B],le,N):y&&!f.allowGridLines&&B===L&&h.drawBorder(s,{borderRight:"1px solid black"},r,n[B],le,N),r+=le,B===L&&y&&D&&(h.drawBorder(s,M,0,n[B],r,N),D=!1),n[B]+=N}}}if(!this.isImageLoaded&&!this.isChartLoaded)d&&this.endRow>0&&this.multipleCanvasDataURL.push(a.toDataURL()),e=0,this.pageCounts.length-1===x&&h.canvasPrint(this.parent,p,f);else if(this.isImageLoaded||this.isChartLoaded)break}},o.prototype.setBorderStyle=function(t,e){return e.borderBottom=g(t.style.borderBottom)?e.borderBottom:t.style.borderBottom,e.borderTop=g(t.style.borderTop)?e.borderTop:t.style.borderTop,e.borderRight=g(t.style.borderRight)?e.borderRight:t.style.borderRight,e.borderLeft=g(t.style.borderLeft)?e.borderLeft:t.style.borderLeft,e},o.prototype.setToDefault=function(){this.parent.currentPrintSheetIndex=0,this.initialRowCount=0,this.chartHeight=0,this.totalCharts=0,this.totalImages=0,this.chartLoadedCount=0,this.imageLoadedCount=0,this.endRow=0,this.pageCounts=[],this.multipleCanvasDataURL=[],this.chartElements=[],this.isChartLoaded=!1,this.isImageLoaded=!1,this.startNewPageCount=0},o.prototype.handleCharts=function(t,e,i,r,n,s,a,l,h,c,u,d,p,f,v,m,y,b,S){var C=this;if(!g(i.chart))for(var x=function(A){I.totalCharts+=1;var L=new Image;A.left=g(A.left)?0:A.left,A.top=g(A.top)?0:A.top;var N=document.getElementById(A.id);if(g(N)&&(I.parent.insertChart([A]),N=document.getElementById(A.id),I.chartElements.push(A.id+"_overlay")),!g(N)){I.chartHeight=A.height;var R=I.initialRowCount+Math.ceil(A.height/19)>I.endRow&&(d.allowRowColumnHeader||d.allowGridLines);if(R&&p.rows.length-1===e){var P=c+(u?I.defaultCellHeight:0);n.height>s+(I.chartHeight-P)?I.endRow+=Math.ceil((I.chartHeight-P)/19):I.endRow+=Math.ceil((n.height-(s+P))/19)}var k=N.cloneNode(!0),B=window.URL.createObjectURL(new Blob([new XMLSerializer().serializeToString(k.childNodes[1])],{type:"image/svg+xml"}));L.onload=function(){var F=Math.ceil(A.left/1e3)-1,O=Math.ceil(A.top/1080)-1,z=A.left+(u?37:0),Y=A.top+(u?19:0)+(O>0?h:0);if(r.drawImage(L,F<=0?z:z-F*1e3,O<=0?Y:Y-O*1160,A.width,A.height),C.chartLoadedCount++,C.chartLoadedCount===C.totalCharts&&(m+=A.width,C.isChartLoaded=!1,!C.isImageLoaded)){v.push(n.toDataURL());var K=C.initialRowCount===p.rows.length-1&&s<1080?p.rows.length:C.initialRowCount,U=C.endRow;C.processCell(t,K+1===U?U:K,U,m,y,r,n,p,f,b,s,!1,S,d)}},L.src=B,I.isChartLoaded=!0}},I=this,D=0,M=i.chart;D<M.length;D++){var E=M[D];x(E)}},o.prototype.processImages=function(t,e,i,r,n,s,a,l,h,c,u,d,p,f,v,m,y){var b=this;if(!g(i.image)){for(var S=function(M){C.totalImages+=1;var E=new Image;E.src=M.src,M.left=g(M.left)?0:M.left,M.top=g(M.top)?0:M.top,C.chartHeight=M.height;var A=C.initialRowCount+Math.ceil(M.height/19)>C.endRow&&(u.allowRowColumnHeader||u.allowGridLines);if(A&&e===d.rows.length-1){var L=l+(c?C.defaultCellHeight:0);r.height>s+(C.chartHeight-L)?C.endRow+=Math.ceil((C.chartHeight-L)/19):C.endRow+=Math.ceil((r.height-(s+L))/19)}E.onload=function(){var N=Math.ceil(M.left/1e3)-1,R=Math.ceil(M.top/1080)-1,P=M.left+(c?37:0),k=M.top+(c?19:0)+(R>0?h:0);if(n.drawImage(E,N<=0?P:P-N*1e3,R<=0?k:k-R*1160,M.width,M.height),b.imageLoadedCount++,b.imageLoadedCount===b.totalImages&&(b.isImageLoaded=!1,f+=M.width,!b.isChartLoaded)){b.multipleCanvasDataURL.push(r.toDataURL());var B=b.initialRowCount===d.rows.length-1&&s<1080?d.rows.length:b.initialRowCount,F=b.endRow;b.processCell(t,B+1===F?F:B,F,f,v,n,r,d,p,m,s,!1,y,u)}},E.onerror=function(){if(b.imageLoadedCount++,b.imageLoadedCount===b.totalImages&&(b.isImageLoaded=!1,!b.isChartLoaded)){b.multipleCanvasDataURL.push(r.toDataURL());var N=b.initialRowCount===d.rows.length-1&&s<1080?d.rows.length:b.initialRowCount,R=b.endRow;b.processCell(t,N+1===R?R:N,R,f,v,n,r,d,p,m,s,!1,y,u)}}},C=this,x=0,I=i.image;x<I.length;x++){var D=I[x];S(D)}this.isImageLoaded=!0}},o.prototype.textDecoration=function(t,e,i,r,n,s,a,l){a!==""&&(!g(t.style)&&!g(t.style.textDecoration)&&t.style.textDecoration.toLowerCase().indexOf("underline")>-1||!g(t.hyperlink))&&(e.beginPath(),e.moveTo(i,r-3),e.lineTo(i+(s.width>l?l:s.width),r-3),e.strokeStyle=n,e.lineWidth=1,e.stroke())},o.prototype.rowHeaderRect=function(t,e,i,r,n,s){s===void 0&&(s="#ffffff"),t.save(),t.beginPath(),t.rect(e,i,r,n),t.clip(),t.fillStyle=s,t.fillRect(e,i,r,n),t.restore()},o.prototype.rowHeaderText=function(t,e,i,r,n,s,a,l){var h=e.measureText(t),c=h.width,u=i.calculateTextPosition(c,r,n,"Center"),d=a;e.save(),e.beginPath(),e.rect(n,a,r,l),e.clip(),e.fillStyle="#000000",e.fillText(t,u,d+l),i.drawBorder(e,s,n,a||0,r,l),e.restore()},o.prototype.canvasPrint=function(t,e,i){var r=this;if(i.type==="Workbook"&&this.totalSheetCount.length-1>=this.workbookActiveSheetCount){var n=this.totalSheetCount[this.workbookActiveSheetCount],s=t.sheets[n];this.workbookActiveSheetCount++,this.activeSheetPrint(t,s,i,n)}else{for(var a=0;a<this.chartElements.length;a++){var l=document.getElementById(this.chartElements[a]);g(l)||l.remove()}if(this.multipleCanvasDataURL.length>0){var h=navigator.userAgent,c=window.open(" ","_blank","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");if(c){c.document.write("<html><head><title></title></head><body>");var u=1e3,d=1400;h.indexOf("Chrome")!==-1||h.indexOf("Safari")!==-1||h.indexOf("Firefox")!==-1?(c.document.write("<!DOCTYPE html>"),c.document.write("<html><head><style>html, body {  } img { height: 100%; width: 100%; display: block; }@media print { body {  } img { width:100%; width:100%; box-sizing: border-box; }br, button { display: none; } div{ page-break-inside: avoid; }} @page{ size:"+u.toString()+"px "+d.toString()+"px; }</style></head><body>")):(c.document.write("<!DOCTYPE html>"),c.document.write("<html><head><style>html, body {  } img { height: 100%; width: 100%; }@media print { body {  }img { width:100%; width:100%; box-sizing: border-box; }br, button { display: none; } div{ page-break-inside: avoid; }} @page{ size:"+u.toString()+"px "+d.toString()+"px; }</style></head><body>")),this.multipleCanvasDataURL.forEach(function(p,f){var v=c.document.createElement("canvas");v.width=u,v.height=d;var m=v.getContext("2d"),y=new Image;y.onload=function(){m.drawImage(y,0,0,u,d),f===r.multipleCanvasDataURL.length-1&&(t.isPrintingProcessing=!1,c.print(),c.document.close(),c.close(),t.printModule.setToDefault())},y.src=p,c.document.body.appendChild(v)})}}}},o.prototype.drawBorder=function(t,e,i,r,n,s){var a=e.borderBottom,l=e.borderLeft,h=e.borderRight,c=e.borderTop,u=e.borderColor;t.strokeStyle=u||"black",!g(a)&&a.indexOf("#FFFFFF")===-1&&(t.strokeStyle=a.split(" ")[2],this.drawPath(i,(r===2?-2:r)+s,i+n,(r===2?-2:r)+s,t,a,!1,e,"bottom")),!g(l)&&l.indexOf("#FFFFFF")===-1&&(t.strokeStyle=l.split(" ")[2],this.drawPath(i,r,i,(r===2?-2:r)+s,t,l,!0,e,"left")),!g(h)&&h.indexOf("#FFFFFF")===-1&&(t.strokeStyle=h.split(" ")[2],this.drawPath(i+n,r,i+n,(r===2?-2:r)+s,t,h,!1,e,"right")),!g(c)&&c.indexOf("#FFFFFF")===-1&&(t.strokeStyle=c.split(" ")[2],this.drawPath(i,r,i+n,r,t,c,!0,e,"top"))},o.prototype.drawPath=function(t,e,i,r,n,s,a,l,h){if(n.beginPath(),s.indexOf("dashed")>-1)n.setLineDash([3,2]),n.lineWidth=s.split(" ")[0].split("")[0];else if(s.indexOf("dotted")>-1)n.setLineDash([1,1]),n.lineWidth=s.split(" ")[0].split("")[0];else if(s.indexOf("double")>-1){n.setLineDash([]);var c=!g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),u=!g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&g(l.borderTop),d=g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&!g(l.borderTop),p=!g(l.borderBottom)&&!g(l.borderLeft)&&g(l.borderRight)&&!g(l.borderTop),f=!g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&g(l.borderTop),v=g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),m=!g(l.borderBottom)&&g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),y=g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&!g(l.borderTop),b=!g(l.borderBottom)&&!g(l.borderLeft)&&!g(l.borderRight)&&g(l.borderTop);n.lineWidth=1;var S=3;c?t===i?a?this.drawDoubleBorder(n,t,e,i,r,t+S,e+S,i+S,r-(S-1)):this.drawDoubleBorder(n,t,e,i,r,t-S,e+S,i-S,r-(S-1)):e===r&&(a?this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e+S,i-(S-1),r+S):this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e-S,i-(S-1),r-S)):u?h==="left"?this.drawDoubleBorder(n,t,e,i,r,t+S,e,i+S,r-(S-1)):this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e-S,i,r-S):d?h==="left"?this.drawDoubleBorder(n,t,e,i,r,t+S,e+(S-1),i+S,r):this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e+S,i,r+S):p?h==="left"?this.drawDoubleBorder(n,t,e,i,r,t+S,e+S,i+S,r-(S-1)):h==="top"?this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e+S,i,r+S):this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e-S,i,r-S):f?h==="right"?this.drawDoubleBorder(n,t,e,i,r,t-S,e,i-S,r-(S-1)):this.drawDoubleBorder(n,t,e,i,r,t,e-S,i-(S-1),r-S):v?h==="right"?this.drawDoubleBorder(n,t,e,i,r,t-S,e+S,i-S,r):this.drawDoubleBorder(n,t,e,i,r,t,e+S,i-(S-1),r+S):m?h==="right"?this.drawDoubleBorder(n,t,e,i,r,t-S,e+S,i-S,r-(S-1)):h==="top"?this.drawDoubleBorder(n,t,e,i,r,t,e+S,i-(S-1),r+S):this.drawDoubleBorder(n,t,e,i,r,t,e-S,i-(S-1),r-S):y?h==="right"?this.drawDoubleBorder(n,t,e,i,r,t-S,e+S,i-S,r):h==="top"?this.drawDoubleBorder(n,t,e,i,r,t+S,e+S,i-(S-1),r+S):this.drawDoubleBorder(n,t,e,i,r,t+S,e+S,i+S,r):b?h==="right"?this.drawDoubleBorder(n,t,e,i,r,t-S,e,i-S,r-(S-1)):h==="bottom"?this.drawDoubleBorder(n,t,e,i,r,t+(S-1),e-S,i-(S-1),r-S):this.drawDoubleBorder(n,t,e,i,r,t+S,e,i+S,r-(S-1)):t===i?this.drawDoubleBorder(n,t,e,i,r,t+(h==="left"?S:-S),e,i+(h==="left"?S:-S),r):e===r&&this.drawDoubleBorder(n,t,e,i,r,t,e+(h==="top"?S:-S),i,r+(h==="top"?S:-S)),n.stroke();return}else n.setLineDash([]),n.lineWidth=s.split(" ")[0].split("")[0];n.moveTo(t,e),n.lineTo(i,r),n.stroke()},o.prototype.drawDoubleBorder=function(t,e,i,r,n,s,a,l,h){t.moveTo(e,i),t.lineTo(r,n),t.moveTo(s,a),t.lineTo(l,h)},o.prototype.calculateTextPosition=function(t,e,i,r,n){var s,a=3,l=e;if(l>=t)switch(r.toLowerCase()){case"left":s=i+a;break;case"center":s=i+(l-t)/2;break;case"right":n?s=i+(l-a):s=i+(l-a)-t;break}else t<e?s=r.toLowerCase()==="left"?i+a:r.toLowerCase()==="center"?i+(e-t)/2:i+e-t:s=i+a;return s},o.prototype.calculatePageCount=function(t,e,i){var r=i,n=this.columnIndex;if(t.columns.length===0){var s=Math.floor(e/this.defaultCellWidth)-(r?1:0);return Array(Math.max(1,Math.ceil(n/s))).fill(s)}for(var a=0,l=[],h=0;h<=n;h++){var c=t.columns&&t.columns[h],u=(r?27:0)+(c&&c.hidden?0:c&&!g(c.width)?c.width:this.defaultCellWidth);a+=u,r=!1,a>e&&(l.push(h-1),r=!0,a=u)}return(l.length===0||n>l[l.length-1])&&l.push(n),l},o.prototype.wrapText=function(t,e,i,r){if(g(t))return[""];var n=[],s,a,l,h,c,u=0,d=[];if(t=t.toString(),t.includes(`
`)){var p=t.split(`
`);p.forEach(function(x){d.push.apply(d,x.split(" ").filter(function(I){return I!==""}).concat([`
`]))}),d.pop()}else d=t.split(" ");var f=dr(" ",i,r,!0),v,m,y="",b=function(x){u&&n.push(y),zr(s/e,!0)>1&&(x.split("").forEach(function(I){h=dr(I,i,r,!0),l+=h,c+=I,zr(l,!0)>e&&(n.push(c),l=h,c=I)}),s=l,x=c),y=x,u=s},S=d.length-1,C=function(x,I){zr(x+f,!0)/e>=1?s+=0:(s+=f,I!==S&&(y+=" "))};return d.forEach(function(x,I){if(l=0,h=0,c="",x===`
`){n.push(y),y="",u=0;return}if(s=dr(x,i,r,!0),m=zr(u+s,!0)/e,m>1)if(a=x.split("-"),a.length>1){var D=a.length-1;a.forEach(function(M,E){l=0,h=0,c="",v||(v=dr("-",i,r,!0)),s=dr(M,i,r,!0),E<D&&(s+=v,M+="-"),m=zr(u+s,!0)/e,m>1?(b(M),E===D&&C(s,I)):(y+=M,E===D&&d[d.length-1]!==x&&C(u+s,I),u+=s)})}else b(x),C(s,I);else y+=x,C(u+s,I),u+=s}),u&&n.push(y),n},o.prototype.getModuleName=function(){return"print"},o.prototype.destroy=function(){this.setToDefault(),this.totalSheetCount=[],this.parent=null},o})(),hG=(function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}})(),Kt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},sP=(function(o){hG(t,o);function t(i,r){var n=o.call(this,i)||this;return n.rafIds=[],n.viewport={rowCount:0,colCount:0,height:0,topIndex:0,leftIndex:0,width:0,bottomIndex:0,rightIndex:0,beforeFreezeHeight:0,beforeFreezeWidth:0,scaleX:1,scaleY:1},n.needsID=!0,e.Inject(hE,cE,dE,nE,rE,sE,aE,iE,q0,pE,gE,fE,vE,oE,uE,_9,Vz,Nz,kz,Hz,Oz,Rz,nG,zz,B9,V9,Pz,sG,H9,_z,U9,W9,Uz,v9,q9,Wz,lG,Y9,Yz,G9,qz,Q9,Gz,aG,X9,Bz,Qz,oG,jz,K9,Xz,$9),r&&n.appendTo(r),n}e=t,t.prototype.getCell=function(i,r,n){var s;return this.insideViewport(i,r)&&(n||(n=this.getRow(i,null,r)),r=this.getViewportIndex(r,!0),s=n&&n.cells[r]),s},t.prototype.getRow=function(i,r,n){if(!r){var s=this.getActiveSheet(),a=this.frozenRowCount(s),l=this.frozenColCount(s);g(n)||i>a-1&&n>l-1?r=this.getContentTable():r=i<a&&n<l?this.sheetModule.getSelectAllTable():i<a?this.getColHeaderTable():this.getRowHeaderTable()}return i=this.getViewportIndex(i),r?r.rows[i]:null},t.prototype.hiddenCount=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.getActiveSheet());for(var a=0,l,h=i;h<=r;h++)l=s[""+n][h],l&&l.hidden&&a++;return a},t.prototype.getViewportIndex=function(i,r){var n=this.getActiveSheet(),s=this.frozenColCount(n),a=this.frozenRowCount(n);if(r)if(s){var l=xe(n.topLeftCell)[1];return i<s?(i-=this.hiddenCount(l,i,"columns"),i-=l,i+1):(i-=this.hiddenCount(this.viewport.leftIndex+s,i,"columns"),i-=this.viewport.leftIndex+s,i)}else i-=this.hiddenCount(this.viewport.leftIndex,i,"columns"),i-=this.viewport.leftIndex;else if(a){var h=xe(n.topLeftCell)[0];return i<a?(i-=this.hiddenCount(h,i),i-=h,i+1):(i-=this.hiddenCount(this.viewport.topIndex+a,i),i-=this.viewport.topIndex+a,i)}else i-=this.hiddenCount(this.viewport.topIndex,i),i-=this.viewport.topIndex;return i},t.prototype.preRender=function(){o.prototype.preRender.call(this),this.serviceLocator=new Kz,this.initServices()},t.prototype.initServices=function(){this.serviceLocator.register(ve,new Ri(this.getModuleName(),f9,this.locale)),this.serviceLocator.register(jt,new Z9(this)),this.serviceLocator.register(u9,new J9(this)),this.serviceLocator.register(j0,new eG(this))},t.prototype.render=function(){if(o.prototype.render.call(this),this.element.setAttribute("tabindex","0"),this.renderModule=new F9(this),this.renderSpreadsheet(),this.wireEvents(),this.created&&!this.refreshing)if(this.created.observers){if(this.created.observers.length>0){var i={observers:this.created.observers};this.isAngular&&(i={observers:this.created.observers,currentObservers:this.created.observers},this.created.currentObservers=[]),this.createdHandler=i,this.created.observers=[]}}else this.createdHandler=this.created,this.setProperties({created:void 0},!0)},t.prototype.renderSpreadsheet=function(){this.cssClass&&X([this.element],this.cssClass.split(" ")),this.enableRtl&&this.element.classList.add("e-rtl"),this.setHeight(),this.setWidth(),Qs({target:this.element},this.createElement),this.cssClass&&this.cssClass.indexOf("e-mobile-view")===-1&&this.isMobileView()&&this.element.classList.add("e-mobile-view"),j.isDevice&&this.element.classList.add("e-device"),this.sheetModule=this.serviceLocator.getService("sheet"),this.allowScrolling&&(this.scrollModule=new z9(this)),this.scrollSettings.enableVirtualization&&new P9(this),this.renderModule.render(),new j9(this)},t.prototype.showSpinner=function(){vs(this.element)},t.prototype.hideSpinner=function(){Xs(this.element)},t.prototype.protectSheet=function(i,r,n){o.prototype.protectSheet.call(this,i,r,n)},t.prototype.unprotectSheet=function(i){o.prototype.unprotectSheet.call(this,i)},t.prototype.find=function(i){var r=this.getActiveSheet().activeCell;if(o.prototype.findHandler.call(this,i),!i.isAction)return r!==this.getActiveSheet().activeCell?this.getActiveSheet().name+"!"+this.getActiveSheet().activeCell:null},t.prototype.replace=function(i){i.showDialog?this.notify(w0,i):(i={value:i.value,mode:i.mode?i.mode:"Sheet",isCSen:i.isCSen?i.isCSen:!1,isEMatch:i.isEMatch?i.isEMatch:!1,searchBy:i.searchBy?i.searchBy:"By Row",replaceValue:i.replaceValue,replaceBy:i.replaceBy,sheetIndex:Te(i.sheetIndex)?this.activeSheetIndex:i.sheetIndex,findOpt:i.findOpt?i.findOpt:""},o.prototype.replaceHandler.call(this,i))},t.prototype.findAll=function(i,r,n,s,a){r=r||"Sheet",a=a<this.sheets.length?a:this.activeSheetIndex,n=n||!1,s=s||!1;var l=[],h={value:i,mode:r,sheetIndex:a,isCSen:n,isEMatch:s,findCollection:l};return this.notify(SM,h),l},t.prototype.goTo=function(i){if(!this.allowScrolling){this.selectRange(i);return}if(i.includes("!")){var r=Ct(this,na(i));if(r===void 0)return;if(r!==this.activeSheetIndex){var n=i.substring(i.lastIndexOf("!")+1),s=n.split(":")[0],a=this.sheets[r];this.setSheetPropertyOnMute(a,"activeCell",s),this.setSheetPropertyOnMute(a,"selectedRange",n);var l=xe(s);if(a.frozenColumns||a.frozenRows){var h=xe(a.topLeftCell);if(!(a.frozenRows&&l[0]<h[0]||a.frozenColumns&&l[1]<h[1])){var c=this.frozenRowCount(a),u=this.frozenColCount(a),d=[],p=[],f=xe(a.paneTopLeftCell);c?(d.push(h[0]),l[0]>=c?p.push(l[0]):p.push(f[0])):(d.push(l[0]),p.push(l[0])),u?(d.push(h[1]),l[1]>=u?p.push(l[1]):p.push(f[1])):(d.push(l[1]),p.push(l[1])),this.setSheetPropertyOnMute(a,"topLeftCell",st(d[0],d[1])),this.setSheetPropertyOnMute(a,"paneTopLeftCell",st(p[0],p[1]))}}else l[0]<this.viewport.rowCount&&(l[0]=0),l[1]<this.viewport.colCount&&(l[1]=0),this.updateTopLeftCell(l[0],l[1],null,a);this.activeSheetIndex=r,this.dataBind();return}}var v=ie(i),m=this.getActiveSheet(),y=this.frozenRowCount(m),b=this.frozenColCount(m),S=this.insideViewport(v[0],v[1]);if(S){this.selectRange(i);var C=xe(m.paneTopLeftCell),x=this.viewport.height;this.allowScrolling&&(x-=this.getScrollElement().parentElement.getBoundingClientRect().height);var I=0,D=0;if(y){for(var M=xe(m.topLeftCell),E=M[0];E<y;E++)if(I+=ei(m,E),I>x){D=E;break}}if(D===0)for(var E=C[0];E<=this.viewport.bottomIndex;E++)if(I+=ei(m,E),I>x){D=E;break}else E===this.viewport.bottomIndex&&(D=this.viewport.bottomIndex);C[2]=D;var A=0;if(I=0,x=this.viewport.width-this.sheetModule.getScrollSize(),b){for(var M=xe(m.topLeftCell),E=M[1];E<b;E++)if(I+=qr(m,E),I>x){A=E;break}}if(A===0)for(var E=C[1];E<=this.viewport.rightIndex;E++)if(I+=qr(m,E),I>x){A=E;break}else E===this.viewport.rightIndex&&(A=this.viewport.rightIndex);if(C[3]=A,v[0]>=C[0]&&v[0]<C[2]&&v[1]>=C[1]&&v[1]<C[3]||(y||b)&&(C=[].concat(xe(m.topLeftCell),[y,C[3]]),v[0]>=C[0]&&v[0]<C[2]&&v[1]>=C[1]&&v[1]<C[3]||(C[2]=D,C[3]=b,v[0]>=C[0]&&v[0]<C[2]&&v[1]>=C[1]&&v[1]<C[3])))return}var L=this.getMainContent().parentElement,N,R,P,k,B,F;v[0]===y?P=0:(P=xi(m,y,v[0]-1,!0),this.scrollSettings.enableVirtualization&&(F=P+this.getContentTable().getBoundingClientRect().height,B=parseFloat(L.querySelector(".e-virtualtrack").style.height),F>B&&(F+=10,N=L.querySelector(".e-virtualtrack"),N.style.height=F+"px",er(function(){N.style.height=B+"px"})))),L.scrollTop=P,L=this.element.getElementsByClassName("e-scroller")[0],v[1]===b?P=0:(P=wi(m,b,v[1]-1,!0),this.scrollSettings.enableVirtualization&&(F=P+this.getContentTable().getBoundingClientRect().width,k=parseFloat(L.querySelector(".e-virtualtrack").style.width),F>k&&(F+=10,N=L.querySelector(".e-virtualtrack"),N.style.width=F+"px",R=this.getColumnHeaderContent().querySelector(".e-virtualtrack"),R.style.width=F+"px",N=this.getMainContent().querySelector(".e-virtualtrack"),N.style.width=F+"px",er(function(){N.style.width=k+"px",R.style.width=k+"px"})))),L.scrollLeft=P,S||this.selectRange(i)},t.prototype.insideViewport=function(i,r){var n=this.getActiveSheet();if(n.frozenRows||n.frozenColumns){var s=this.frozenRowCount(n),a=this.frozenColCount(n),l=xe(n.topLeftCell);return(i>=l[0]&&i<s||i>=this.viewport.topIndex+s&&i<=this.viewport.bottomIndex)&&(r>=l[1]&&r<a||r>=this.viewport.leftIndex+a&&r<=this.viewport.rightIndex)}else return i>=this.viewport.topIndex&&i<=this.viewport.bottomIndex&&r>=this.viewport.leftIndex&&r<=this.viewport.rightIndex},t.prototype.resize=function(){this.renderModule.setSheetPanelSize(),this.scrollSettings.enableVirtualization&&this.renderModule.refreshSheet(!1,!0)},t.prototype.cut=function(i){var r=new Promise(function(n){n((function(){})())});return this.notify(iu,i?{range:Ji(i),sId:this.sheets[Ct(this,na(i))]?this.sheets[Ct(this,na(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},t.prototype.copy=function(i){var r=new Promise(function(n){n((function(){})())});return this.notify(ru,i?{range:Ji(i),sId:this.sheets[Ct(this,na(i))]?this.sheets[Ct(this,na(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},t.prototype.paste=function(i,r){this.notify(fo,{range:i&&Ji(i),sIdx:i&&Ct(this,na(i)),type:r,isAction:!0,isInternal:!0})},t.prototype.updateAction=function(i){on(i,this)},t.prototype.setHeight=function(){this.height&&(this.height.toString().indexOf("%")>-1&&(this.element.style.minHeight="400px"),this.element.style.height=Ae(this.height))},t.prototype.setWidth=function(){this.width&&((this.width.toString().indexOf("%")>-1||this.width==="auto")&&(this.element.style.minWidth="300px"),this.element.style.width=Ae(this.width))},t.prototype.setColWidth=function(i,r,n){i===void 0&&(i=64),r===void 0&&(r=0);var s=g(n)?this.getActiveSheet():this.sheets[n];if(s&&(!s.isProtected||s.protectSettings.formatColumns)){var a=r,l=typeof i=="number"?i+"px":i;r=g(r)?xe(s.activeCell)[1]:r;var h=function(){Ht(s,a).width=parseInt(l,10)>0?parseInt(l,10):0,s.columns[a].customWidth=!0},c=this.frozenColCount(s);if(s.id===this.getActiveSheet().id){if(r>=this.viewport.leftIndex+c&&r<=this.viewport.rightIndex||c&&r<c){r=this.getViewportIndex(r,!0);var u=qr(s,a,null,!0),d=zr(parseInt(l,10))-u;d<0&&u<-d&&(d=-u),h(),this.notify(Qn,{threshold:d,colIdx:a,checkWrapCell:!0}),qD(a,r,l,!0,this)}else{var p=qr(s,r),d=void 0;parseInt(l,10)>0?d=-(p-parseInt(l,10)):d=-p,h(),this.notify(Qn,{threshold:d,colIdx:r})}this.notify(Oa,null)}else h()}},t.prototype.setRowHeight=function(i,r,n,s,a){i===void 0&&(i=20),r===void 0&&(r=0);var l=g(n)?this.getActiveSheet():this.sheets[n];if(l){var h=r;if(r=g(r)?xe(l.activeCell)[0]:r,a&&l.rows[r]&&l.rows[r].customHeight)return;var c=typeof i=="number"?i+"px":i,u=function(){H0(l,h,parseInt(c,10)>0?parseInt(c,10):0),l.rows[h].customHeight=!0};if(l.id===this.getActiveSheet().id){var d=this.frozenRowCount(l);if(r>=this.viewport.topIndex+d&&r<=this.viewport.bottomIndex||d&&r<d){r=this.getViewportIndex(h);var p=ei(l,h,!0),f=zr(parseInt(c,10))-p;f<0&&p<-f&&(f=-p),u(),this.notify(Fn,{threshold:f,rowIdx:h,isCustomHgt:!0}),g(s)&&(s=!1),s||(qD(h,r,c,!1,this),s=!1)}else{var v=ei(l,r),f=void 0;parseInt(c,10)>0?f=-(v-parseInt(c,10)):f=-v,u(),this.notify(Fn,{threshold:f,rowIdx:h})}this.notify(Oa,null)}else u()}},t.prototype.setRowsHeight=function(i,r,n){i===void 0&&(i=20),r||(r=["1:"+(this.getActiveSheet().usedRange.rowIndex+1)]),this.setSize(i,r,function(s){return Number(s)-1},this.setRowHeight.bind(this),n)},t.prototype.setColumnsWidth=function(i,r){i===void 0&&(i=64),r||(r=["A:"+ji(this.getActiveSheet().usedRange.colIndex+1)]),this.setSize(i,r,function(n){return Sn(n)},this.setColWidth.bind(this))},t.prototype.setSize=function(i,r,n,s,a){var l=this,h,c,u,d,p;r.forEach(function(f){f.includes("!")?(u=f.substring(0,f.lastIndexOf("!")),h=Ct(l,u),f=f.substring(f.lastIndexOf("!")+1)):h=l.activeSheetIndex,f.includes(":")?(c=f.split(":"),d=n(c[0]),p=n(c[1])):d=p=n(f);for(var v=d;v<=p;v++)s(i,v,h,!1,a)})},t.prototype.autoFit=function(i){var r;i.indexOf("!")!==-1&&(r=Ct(this,i.substring(0,i.lastIndexOf("!"))),i=i.substring(i.lastIndexOf("!")+1));var n=this.getIndexes(i),s=n.startIdx,a=n.endIdx,l=n.isCol,h=l?Sn("XFD"):1048576;if(s<=h)a>h&&(a=h);else return;for(s;s<=a;s++)this.notify(pD,{idx:s,isCol:l,sheetIdx:r})},t.prototype.getIndexes=function(i){var r,n,s,a;if(i.indexOf(":")!==-1){var l=i.split(":");s=l[0],a=l[1]}else s=i,a=i;if(!g(s)){var h=this.getAddress(s);s=h.address,r=h.isCol}if(!g(a)){var c=this.getAddress(a);a=c.address,n=c.isCol}var u=r===!0&&n===!0,d=u?Sn(s.toUpperCase()):parseInt(s,10),p=u?Sn(a.toUpperCase()):parseInt(a,10);return{startIdx:d,endIdx:p,isCol:u}},t.prototype.getAddress=function(i){var r;return i.substring(0,1).match(/\D/g)?(r=!0,i=i.replace(/[0-9]/g,""),{address:i,isCol:r}):i.substring(0,1).match(/[0-9]/g)&&i.match(/\D/g)?{address:"",isCol:!1}:(i=(parseInt(i,10)-1).toString(),{address:i,isCol:r})},t.prototype.addHyperlink=function(i,r,n){this.insertHyperlink(i,r,n,!0)},t.prototype.removeHyperlink=function(i){this.notify(Fg,{range:i,preventEventTrigger:!0})},t.prototype.insertHyperlink=function(i,r,n,s){if(this.allowHyperlink){var a=void 0,l=void 0,h=void 0,c=this.getActiveSheet();if(r=r||c.name+"!"+c.activeCell,h=ie(r),Hi(this,h)){this.notify(fr,null);return}for(var u=this.getCell(h[0],h[1]),d=[],p=0;u&&p<u.classList.length;p++)d.push(u.classList[p]);var f={hyperlink:i,address:r,displayText:n,cancel:!1},v={hyperlink:i,address:r,displayText:n};if(s||(this.trigger(kY,f),this.notify(hi,{action:"hyperlink",eventArgs:f})),!f.cancel){i=f.hyperlink,r=f.address;var m={hyperlink:i,cell:r,displayText:n,triggerEvt:!s};if(this.notify(Pd,m),r&&r.lastIndexOf("!")!==-1){var y=r.lastIndexOf("!");a=r.substring(0,y);for(var b=this.sheets,S=0;S<b.length;S++)b[S].name===a&&(l=S);c=this.sheets[l],r=r.substring(y+1)}if(!c)return;if(r=r||this.getActiveSheet().activeCell,h=ie(r),s||(this.trigger(FY,v),this.notify(wt,{action:"hyperlink",eventArgs:f})),c===this.getActiveSheet()){this.serviceLocator.getService("cell").refreshRange(h,!1,!1,!1,!0,xs(this));for(var p=0;p<d.length;p++)this.getCell(h[0],h[1]).classList.contains(d[p])||this.getCell(h[0],h[1]).classList.add(d[p]);this.notify(Hs,null)}}}},t.prototype.addDataValidation=function(i,r){o.prototype.addDataValidation.call(this,i,r)},t.prototype.removeDataValidation=function(i){o.prototype.removeDataValidation.call(this,i)},t.prototype.addInvalidHighlight=function(i){o.prototype.addInvalidHighlight.call(this,i)},t.prototype.removeInvalidHighlight=function(i){o.prototype.removeInvalidHighlight.call(this,i)},t.prototype.conditionalFormat=function(i){o.prototype.conditionalFormat.call(this,i)},t.prototype.clearConditionalFormat=function(i){i=i||this.getActiveSheet().selectedRange,o.prototype.clearConditionalFormat.call(this,i)},t.prototype.setPanelSize=function(){if(this.height!=="auto"){var i=document.getElementById(this.element.id+"_sheet_panel");i.style.height=this.element.getBoundingClientRect().height*this.viewport.scaleY-Zz(i,null,this.viewport.scaleY)+"px"}},t.prototype.open=function(i){this.isOpen=!0,o.prototype.open.call(this,i),this.isOpen&&this.showSpinner()},t.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(kn,{startIndex:i,endIndex:r,hide:n,actionUpdate:!1}):o.prototype.hideRow.call(this,i,r,n)},t.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(kn,{startIndex:i,endIndex:r,hide:n,isCol:!0,actionUpdate:!1}):o.prototype.hideColumn.call(this,i,r,n)},t.prototype.clear=function(i){this.notify(Pg,{options:i})},t.prototype.refresh=function(i){var r=this;if(this.isReact&&this.clearTemplate(),i)this.notify($d,null),this.notify(At,{action:"unRegisterSheet",isNewWorkBook:!0}),this.sheets.length=0,this.sheetNameCount=1,this.notify(ka,{}),this.notify(Vh,null),this.createSheet(),this.activeSheetIndex=this.sheets.length-1,this.notify(Oh,null),this.notify(At,{action:"initSheetInfo"}),this.renderModule.refreshSheet();else if(this.createdHandler){var n=function(){r.off(yD,n),r.refresh()};this.on(yD,n,this)}else this.notify(nu,{}),o.prototype.refresh.call(this)},t.prototype.insertImage=function(i,r){var n;for(n=0;n<i.length;n++)this.notify(go,{options:i[n],range:r||this.getActiveSheet().selectedRange,isPublic:!0})},t.prototype.deleteImage=function(i,r){this.notify(La,{id:i,range:r||this.getActiveSheet().selectedRange})},t.prototype.getRowHeaderContent=function(){return this.sheetModule.getRowHeaderPanel()},t.prototype.getColumnHeaderContent=function(){return this.sheetModule.getColHeaderPanel()},t.prototype.getMainContent=function(){return this.sheetModule.getContentPanel()},t.prototype.getSelectAllContent=function(){return this.sheetModule.getSelectAllContent()},t.prototype.getScrollElement=function(){return this.sheetModule.getScrollElement()},t.prototype.getContentTable=function(){return this.sheetModule.getContentTable()},t.prototype.getRowHeaderTable=function(){return this.sheetModule.getRowHeaderTable()},t.prototype.getColHeaderTable=function(){return this.sheetModule.getColHeaderTable()},t.prototype.getThreshold=function(i){var r=Math.round((this.viewport[i+"Count"]+1)/2);return r<15?15:r},t.prototype.isMobileView=function(){return!g(this.cssClass)&&(this.cssClass.indexOf("e-mobile-view")>-1||j.isDevice)&&this.cssClass.indexOf("e-desktop-view")===-1&&!1},t.prototype.getValueRowCol=function(i,r,n,s,a,l,h){return o.prototype.getValueRowCol.call(this,i,r,n,s,a,l,h)},t.prototype.updateCell=function(i,r,n){g(n)&&(n=!0),this.updateCellInfo(i,r,n,void 0,void 0,!0)},t.prototype.updateCellInfo=function(i,r,n,s,a,l){if(r=r||this.getActiveSheet().activeCell,!Hi(this,ie(r))){var h=this.scrollSettings.isFinite;o.prototype.updateCellDetails.call(this,i,r,s,a,n,h,l)}},t.prototype.getRowData=function(i,r){return o.prototype.getRowData.call(this,i,r)},t.prototype.sort=function(i,r){var n=this;if(!this.allowSorting)return Promise.reject();var s,a;if(r?(s=js(this,r),a=ke(this,s)):(a=this.getActiveSheet(),r=a.selectedRange,s=this.activeSheetIndex),a.isProtected)return Promise.reject(new Error("The cell you're trying to change is protected. To make change, unprotect the sheet."));var l=[];if(this.sortCollection)for(var h=this.sortCollection.length-1;h>=0;h--)this.sortCollection[h]&&this.sortCollection[h].sheetIndex===s&&(l.push(this.sortCollection[h]),this.sortCollection.splice(h,1));return this.notify(Zc,{sortOptions:i}),o.prototype.sort.call(this,i,r,l).then(function(c){return n.notify(og,c),Promise.resolve(c)})},t.prototype.setValueRowCol=function(i,r,n,s,a,l){if(!this.isEdit&&r==="#CIRCULARREF!"){var h=ke(this,Cn(this,i)),c={action:"isCircularReference",argValue:r,address:h.name+"!"+ji(s)+n};this.notify(Ol,c),r=c.argValue}o.prototype.setValueRowCol.call(this,i,r,n,s,a,l);var u=Cn(this,i);if(this.activeSheetIndex===u)if(this.allowEditing)this.notify(ui,{action:"refreshDependentCellValue",rowIdx:n,colIdx:s});else{n--,s--;var h=ke(this,u),d=void 0;if(!lt(h,n)&&!Ft(h,s)&&(d=this.getCell(n,s)),d){if(d.parentElement){var p=d.parentElement.getAttribute("aria-rowindex");if(p&&Number(p)-1!==n)return;var f=d.getAttribute("aria-colindex");if(f&&Number(f)-1!==s)return}var v=Q(n,s,h),m={value:v.value,format:v.format,onLoad:!0,formattedText:v.value,isRightAlign:!1,type:"General",cell:v,rowIndex:n,colIndex:s,isRowFill:!1};this.notify(yr,m),this.refreshNode(d,m)}}},t.prototype.getModuleName=function(){return"spreadsheet"},t.prototype.calculateNow=function(i,r){return o.prototype.calculateNow.call(this,i,r)},t.prototype.refreshNode=function(i,r){var n;if(i){if(r){if(r.result=g(r.formattedText)?g(r.result)?"":r.result:r.formattedText.toString(),!r.isRowFill){var s=i.querySelector(".e-fill-before");s&&se(s);var a=J(".e-fill",i);a&&(se(a),i.style.display="table-cell");var l=J(".e-fill-sec",i);l&&se(l)}var h=void 0;r.result&&(r.result.toLowerCase()==="true"||r.result.toLowerCase()==="false")?(r.result=r.result.toUpperCase(),h="e-center-align",r.isRightAlign=!0):h="e-right-align",n=r.result,this.allowWrap||n.toString().includes(`
`)&&(n=n.replace(/\n/g,"")),r.isRightAlign?i.classList.add(h):i.classList.remove(h)}n=g(n)?"":n,!g(r.rowIndex)&&!g(r.colIndex)&&Ee(i,{"aria-label":(n?n+" ":"")+st(r.rowIndex,r.colIndex)});var c=i.lastChild;c&&c.nodeName==="SPAN"&&c.classList.contains("e-iconsetspan")&&(c=null);var u=i.querySelector(".e-addNoteIndicator");u&&(c=u.previousSibling),i.querySelector(".e-databar-value")&&(c=i.querySelector(".e-databar-value").lastChild),i.querySelector(".e-hyperlink")&&(r.cell&&r.cell.wrap&&n&&n.toString().indexOf(`
`)&&(i.querySelector(".e-hyperlink").textContent=n),c=i.querySelector(".e-hyperlink").lastChild);var d=i.querySelector(".e-wrap-content");if(d&&!(i.querySelector(".e-hyperlink")||i.querySelector(".e-databar-value"))&&(d.lastChild||d.appendChild(document.createTextNode("")),c=d.lastChild),(this.isAngular||this.isVue)&&i.classList.contains("e-cell-template")&&c&&(c.nodeType===8||c.nodeType===3)){if(c.nodeType===3||n!==""){var p=function(){i.childElementCount||(c.nodeType===3?r.isRowFill||(c.nodeValue=n):i.appendChild(document.createTextNode(n)))};this.isAngular?er(p):p()}}else c&&(c.nodeType===3||c.nodeType===1)?r.isRowFill||(!g(c.className)&&c.className.indexOf("e-addNoteIndicator")>-1&&(c=i.lastChild),c.nodeValue=n):i.appendChild(document.createTextNode(n))}},t.prototype.calculateHeight=function(i,r,n){r===void 0&&(r=1),n===void 0&&(n=1);var s=i&&i.fontSize||this.cellStyle.fontSize,a=i.fontFamily==="Arial Black"?1.44:1.24;return(s.indexOf("pt")>-1?parseInt(s,10)*1.33:parseInt(s,10))*a*r+n*a},t.prototype.skipHidden=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.scrollSettings.isFinite);var a=this.getActiveSheet(),l;this.scrollSettings.isFinite&&(l=(n==="rows"?a.rowCount:a.colCount)-1);for(var h=i;h<=r;h++)if(a[""+n][h]&&a[""+n][h].hidden){if(i===h&&i++,r++,s&&r>l){r=l;break}}else if(!s&&this.scrollSettings.isFinite&&r>l&&a[""+n][h-1]&&a[""+n][h-1].hidden){r--;break}return[i,r]},t.prototype.updateActiveBorder=function(i,r){r===void 0&&(r=".e-ribbon");var n=J(r+" .e-tab-header .e-indicator",this.element);n.style.display="none",Ze(n,{left:"",right:""}),Ze(n,{left:i.offsetLeft+"px",right:i.parentElement.offsetWidth-(i.offsetLeft+i.offsetWidth)+"px"}),n.style.display=""},t.prototype.undo=function(){this.notify(yo,{isUndo:!0,isPublic:!0})},t.prototype.redo=function(){this.notify(yo,{isUndo:!1,isPublic:!0})},t.prototype.updateUndoRedoCollection=function(i){this.notify(m0,{args:i,isPublic:!0})},t.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(Ol,r),r.isAdded},t.prototype.removeDefinedName=function(i,r){return o.prototype.removeDefinedName.call(this,i,r)},t.prototype.mouseClickHandler=function(i){this.notify(Jc,i)},t.prototype.mouseDownHandler=function(i){this.notify(Bl,i)},t.prototype.keyUpHandler=function(i){H(i.target,".e-find-dlg")?this.notify(AM,i):this.notify(Ds,i)},t.prototype.keyDownHandler=function(i){var r=H(i.target,".e-findtool-dlg");if(r){if(i.keyCode===9){var n=i.target;if(i.shiftKey){if(n.classList.contains("e-text-findNext-short")){var s=r.querySelector(".e-findRib-close .e-tbar-btn");s&&(i.preventDefault(),s.focus())}}else n.classList.contains("e-tbar-btn")&&n.parentElement.classList.contains("e-findRib-close")&&Re(r)}}else{this.notify(mo,i);var a=H(i.target,".e-dialog");!this.enableKeyboardNavigation&&(document.activeElement.classList.contains("e-cell")||a)&&[38,40,33,34,35,36,9].indexOf(i.keyCode)>-1&&i.preventDefault()}},t.prototype.freeze=function(i){if(!(!this.allowFreezePane||i.row<0||i.column<0)){if(i.triggerEvent){var r={row:i.row,column:i.column,cancel:!1,sheetIndex:this.activeSheetIndex};if(this.notify(hi,{eventArgs:r,action:"freezePanes"}),r.cancel)return}this.on(Ln,this.freezePaneUpdated,this),this.freezePanes(i.row,i.column),this.notify(Hs,null)}},t.prototype.freezePaneUpdated=function(){this.off(Ln,this.freezePaneUpdated);var i=this.getActiveSheet();Re(this.element),this.notify(wt,{eventArgs:{row:i.frozenRows,column:i.frozenColumns,sheetIndex:this.activeSheetIndex},action:"freezePanes"})},t.prototype.wireEvents=function(){T.add(this.element,"click",this.mouseClickHandler,this),T.add(this.element,tp(),this.mouseDownHandler,this),T.add(this.element,"keyup",this.keyUpHandler,this),T.add(this.element,"keydown",this.keyDownHandler,this),this.on(hg,this.freeze,this),this.on(Ss,this.refreshInsertDelete,this)},t.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unwireEvents(),this.notify(Xn,null),o.prototype.destroy.call(this),this.element.innerHTML="",this.element.removeAttribute("tabindex"),this.element.removeAttribute("role"),this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("min-height"),this.element.style.removeProperty("min-width"),this.enableRtl&&this.element.classList.remove("e-rtl"),this.sheetModule&&this.sheetModule.destroy()},t.prototype.unwireEvents=function(){T.remove(this.element,"click",this.mouseClickHandler),T.remove(this.element,tp(),this.mouseDownHandler),T.remove(this.element,"keyup",this.keyUpHandler),T.remove(this.element,"keydown",this.keyDownHandler),this.off(hg,this.freeze),this.off(Ss,this.refreshInsertDelete)},t.prototype.refreshInsertDelete=function(i){var r=this;if(i.modelType!=="Sheet"){var n,s;i.sheet.ranges.forEach(function(a){a.template&&a.address&&(s=ie(a.address),n=r.updateRangeOnInsertDelete(i,s),n&&(a.address=Ve(s)))}),this.setSheetPropertyOnMute(i.sheet,"ranges",i.sheet.ranges)}},t.prototype.addContextMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(KM,{items:i,text:r,insertAfter:n,isUniqueId:s})},t.prototype.removeContextMenuItems=function(i,r){this.notify($M,{items:i,isUniqueId:r})},t.prototype.enableContextMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(ZM,{items:i,enable:r,isUniqueId:n})},t.prototype.enableFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(JM,{items:i,enable:r,isUniqueId:n})},t.prototype.hideFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(eD,{items:i,hide:r,isUniqueId:n})},t.prototype.addFileMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(tD,{items:i,text:r,insertAfter:n,isUniqueId:s})},t.prototype.hideRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(iD,{tabs:i,hide:r})},t.prototype.enableRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(rD,{tabs:i,enable:r})},t.prototype.addRibbonTabs=function(i,r){this.notify(nD,{items:i,insertBefore:r})},t.prototype.enableToolbarItems=function(i,r,n){this.notify(Ea,[{tab:i,items:r,enable:n===void 0?!0:n,isPublic:!0}])},t.prototype.hideToolbarItems=function(i,r,n){n===void 0&&(n=!0),this.notify(aD,{tab:i,indexes:r,hide:n})},t.prototype.addToolbarItems=function(i,r,n){this.notify(sD,{tab:i,items:r,index:n})},t.prototype.selectRange=function(i){this.isEdit&&this.notify(ui,{action:"endEdit"}),this.notify(tu,{address:i})},t.prototype.selectChart=function(i){this.selectOverlay(i,!0)},t.prototype.selectImage=function(i){this.selectOverlay(i)},t.prototype.selectOverlay=function(i,r){var n=this.getActiveSheet();if(!(n.isProtected||!this.allowEditing)){if(!i){var s=xe(n.activeCell),a=Q(s[0],s[1],n,!1,!0);r?a.chart&&a.chart.length&&(i=a.chart[a.chart.length-1].id):a.image&&a.image.length&&(i=a.image[a.image.length-1].id)}var l;if(i?(l=this.element.querySelector("#"+i),l.classList.contains("e-ss-overlay")||(l=l.parentElement)):l=this.element.querySelector(".e-ss-overlay"+(r?".e-datavisualization-chart":":not(.e-datavisualization-chart)")),l){var h=void 0,c=this.element.getElementsByClassName("e-ss-overlay-active")[0];c&&(c.classList.remove("e-ss-overlay-active"),h=c.classList.contains("e-datavisualization-chart"),h&&this.notify(N0,null)),l.classList.add("e-ss-overlay-active"),l.classList.contains("e-datavisualization-chart")?(this.notify(Xb,{id:l.id}),h||this.notify(ep,{id:l.id})):h&&this.notify(Go,null)}}},t.prototype.deselectChart=function(){this.notify(Nd,{selector:".e-datavisualization-chart"})},t.prototype.deselectImage=function(){this.notify(Nd,{selector:":not(.e-datavisualization-chart)"})},t.prototype.startEdit=function(){this.notify(ui,{action:"startEdit",isNewValueEdit:!1})},t.prototype.closeEdit=function(){this.notify(ui,{action:"cancelEdit"})},t.prototype.endEdit=function(){this.notify(ui,{action:"endEdit",isPublic:!0})},t.prototype.print=function(i){i===void 0&&(i={type:"ActiveSheet",allowRowColumnHeader:!1,allowGridLines:!1}),this.allowPrint&&!g(this.printModule)&&this.printModule.print(this,i)},t.prototype.onPropertyChanged=function(i,r){var n=this;o.prototype.onPropertyChanged.call(this,i,r);for(var s,a=0,l=Object.keys(i);a<l.length;a++){var h=l[a],c=void 0;switch(h){case"enableRtl":i.enableRtl||this.element.classList.remove("e-rtl"),i.locale||i.currencyCode||this.refresh();break;case"cssClass":r.cssClass&&Z([this.element],r.cssClass.split(" ")),i.cssClass&&X([this.element],i.cssClass.split(" "));break;case"activeSheetIndex":this.renderModule.refreshSheet(),this.notify(su,{idx:i.activeSheetIndex});break;case"width":this.setWidth(),this.resize();break;case"height":this.setHeight(),this.resize();break;case"showRibbon":this.notify(Fl,{prop:"showRibbon",onPropertyChange:!0});break;case"showFormulaBar":this.notify(Tg,{uiUpdate:!0});break;case"showSheetTabs":this.notify(o0,null);break;case"cellStyle":this.renderModule.refreshSheet();break;case"allowEditing":if(this.allowEditing){if(this.notify(ui,{action:"renderEditor"}),this.enableKeyboardNavigation){this.enableKeyboardNavigation=!1,this.dataBind(),this.enableKeyboardNavigation=!0,this.dataBind();var u=this.selectionSettings.mode;u!=="None"&&(this.selectionSettings.mode="None",this.dataBind(),this.selectionSettings.mode=u,this.dataBind())}}else this.notify(Nd,null);break;case"allowInsert":c=this.element.getElementsByClassName("e-add-sheet-tab")[0],c&&(c.disabled=!this.allowInsert,this.allowInsert?c.classList.contains("e-disabled")&&c.classList.remove("e-disabled"):c.classList.contains("e-disabled")||c.classList.add("e-disabled"));break;case"sheets":if(i.sheets===this.sheets){this.renderModule.refreshSheet(),this.notify(Oh,null),this.notify(At,{action:"initSheetInfo"});break}Object.keys(i.sheets).forEach(function(p,f){var v=Number(p),m=i.sheets[v],y=ke(n,v);if(m.ranges&&Object.keys(m.ranges).length){var b=Object.keys(m.ranges),S;b.forEach(function(B,F){m.ranges[Number(B)].info||(S=F)});var C,x,I,D;b.forEach(function(B,F){(Te(S)||S===F)&&(C=Number(B),x=m.ranges[C],I=y.ranges[C],D=x.dataSource,x.fieldsOrder&&I.info&&!D&&I.dataSource&&(D=I.dataSource),D&&n.notify(Ab,{sheetIdx:v,rangeIdx:C,changedData:D}))})}else if(m.paneTopLeftCell&&r.sheets&&r.sheets[""+v]&&r.sheets[""+v].paneTopLeftCell){if(n.activeSheetIndex!==Number(v))return;var M=xe(m.paneTopLeftCell),E=xe(r.sheets[""+v].paneTopLeftCell);if(M[0]!==E[0]){var A=n.frozenRowCount(n.getActiveSheet()),L=M[0]>A?xi(n.getActiveSheet(),A,M[0]-1):0;n.notify(R0,{top:L})}if(M[1]!==E[1]){var N=n.frozenColCount(n.getActiveSheet()),R=M[1]>N?wi(n.getActiveSheet(),N,M[1]-1):0;n.notify(R0,{left:R})}}else if(f===0&&n.renderModule.refreshSheet(),n.showSheetTabs&&m.name&&!s){var P=J(".e-sheet-tabs-items",n.element),k=Number(v);P.children[k+1]?n.notify(g0,{items:P,value:m.name,idx:k}):(n.notify(Oh,null),s=!0)}});break;case"locale":this.refresh();break;case"currencyCode":!i.locale&&(!r||i.currencyCode!==r.currencyCode)&&this.refresh();break;case"password":this.password.length>0&&this.showSheetTabs&&(this.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"));break;case"isProtected":if(this.isProtected){var d=this.element.getElementsByClassName("e-add-sheet-tab")[0];d&&(d.disabled=this.isProtected,this.isProtected?d.classList.contains("e-disabled")&&d.classList.add("e-disabled"):d.classList.contains("e-disabled")||d.classList.remove("e-disabled"))}break;case"allowFreezePane":this.notify(Fl,{prop:"allowFreezePane",onPropertyChange:!0});break;case"allowImage":case"allowChart":this.renderModule.refreshSheet(),this.notify(Fl,{prop:h,onPropertyChange:!0});break;case"calculationMode":r.calculationMode==="Manual"&&this.notify(At,{action:"ClearDependentCellCollection"}),this.notify(Fl,{prop:h,onPropertyChange:!0});break;case"allowResizing":i.allowResizing&&this.notify(jD,{propertyName:h});break;case"enableNotes":i.enableNotes&&this.notify(_d,{});break;case"allowNumberFormatting":case"allowWrap":case"allowCellFormatting":case"allowMerge":this.notify(Fl,{prop:h,onPropertyChange:!0}),this.notify(_d,{});break;case"showAggregate":this.notify(jl,{remove:!this.showAggregate});break;case"allowAutoFill":i.allowAutoFill&&this.notify(Oa,{onPropertyChange:!0});break}}},t.prototype.requiredModules=function(){return b9(this)},t.prototype.appendTo=function(i){o.prototype.appendTo.call(this,i)},t.prototype.filter=function(i,r){return this.allowFiltering?(r=r||this.getActiveSheet().selectedRange,o.prototype.filter.call(this,i,r)):Promise.reject()},t.prototype.clearFilter=function(i,r){this.notify(Rg,{field:i,sheetIndex:r})},t.prototype.applyFilter=function(i,r){var n=this;if(!this.allowFiltering)return Promise.reject();var s=new Promise(function(c){c((function(){})())});if(i&&i.length){var a;i.forEach(function(c){a={instance:{options:{type:c.type,format:c.type==="date"&&"yMd"}},arg3:c.value,arg2:c.operator},n.notify(Dc,a),c.value=a.arg3})}var l=r?js(this,r):this.activeSheetIndex,h={predicates:i,range:r,isInternal:!0,promise:s,sIdx:l};return this.notify(Yo,h),h.promise},t.prototype.addCustomFunction=function(i,r,n){o.prototype.addCustomFunction.call(this,i,r,n),this.notify(fD,null)},t.prototype.setRangeReadOnly=function(i,r,n){r=r||this.getActiveSheet().selectedRange;var s=n||this.activeSheetIndex,a=tt(ie(r)),l=ke(this,s);if(!g(l)){if(this.notify("actionBegin",{action:"readonly",eventArgs:{readOnly:i,range:r,sheetIdx:s}}),iP(r)||a[0]===0&&a[2]===l.rowCount-1)for(var h=a[1];h<=a[3];h++)if(i)Hl(l,h,{isReadOnly:i});else{var c=Ht(l,h);c&&c.isReadOnly&&delete c.isReadOnly}else if(E9(r)||a[1]===0&&a[3]===l.colCount-1)for(var u=a[0];u<=a[2];u++)if(i)Cs(l,u,{isReadOnly:i});else{var d=Yr(l,u);d&&d.isReadOnly&&delete d.isReadOnly}else for(var p=a[1];p<=a[3];p++)for(var f=a[0];f<=a[2];f++)if(i)Zt(f,p,l,{isReadOnly:i},!0);else{var v=Q(f,p,l);v&&v.isReadOnly&&delete v.isReadOnly}for(var m=a[1];m<=a[3];m++)for(var y=a[0];y<=a[2];y++){var v=this.getCell(y,m);!i&&v&&v.classList.contains("e-readonly")?v.classList.remove("e-readonly"):v&&!v.classList.contains("e-readonly")&&(v.className+=" e-readonly")}this.notify("actionComplete",{action:"readonly",eventArgs:{readOnly:i,range:r,sheetIdx:s}})}};var e;return Kt([w("")],t.prototype,"cssClass",void 0),Kt([w(!0)],t.prototype,"allowScrolling",void 0),Kt([w(!0)],t.prototype,"allowResizing",void 0),Kt([w(!0)],t.prototype,"showAggregate",void 0),Kt([w(!0)],t.prototype,"enableClipboard",void 0),Kt([w(!0)],t.prototype,"enableContextMenu",void 0),Kt([w(!0)],t.prototype,"enableKeyboardNavigation",void 0),Kt([w(!0)],t.prototype,"enableKeyboardShortcut",void 0),Kt([w(!0)],t.prototype,"allowUndoRedo",void 0),Kt([w(!0)],t.prototype,"allowWrap",void 0),Kt([Ce({},A9)],t.prototype,"selectionSettings",void 0),Kt([Ce({},T9)],t.prototype,"scrollSettings",void 0),Kt([G()],t.prototype,"beforeCellRender",void 0),Kt([G()],t.prototype,"beforeSelect",void 0),Kt([G()],t.prototype,"select",void 0),Kt([G()],t.prototype,"contextMenuBeforeOpen",void 0),Kt([G()],t.prototype,"fileMenuBeforeOpen",void 0),Kt([G()],t.prototype,"contextMenuBeforeClose",void 0),Kt([G()],t.prototype,"dialogBeforeOpen",void 0),Kt([G()],t.prototype,"fileMenuBeforeClose",void 0),Kt([G()],t.prototype,"contextMenuItemSelect",void 0),Kt([G()],t.prototype,"fileMenuItemSelect",void 0),Kt([G()],t.prototype,"beforeDataBound",void 0),Kt([G()],t.prototype,"dataBound",void 0),Kt([G()],t.prototype,"dataSourceChanged",void 0),Kt([G()],t.prototype,"cellEdit",void 0),Kt([G()],t.prototype,"cellEditing",void 0),Kt([G()],t.prototype,"cellEdited",void 0),Kt([G()],t.prototype,"cellSave",void 0),Kt([G()],t.prototype,"beforeCellSave",void 0),Kt([G()],t.prototype,"created",void 0),Kt([G()],t.prototype,"beforeSort",void 0),Kt([G()],t.prototype,"beforeHyperlinkCreate",void 0),Kt([G()],t.prototype,"afterHyperlinkCreate",void 0),Kt([G()],t.prototype,"beforeHyperlinkClick",void 0),Kt([G()],t.prototype,"afterHyperlinkClick",void 0),Kt([G()],t.prototype,"beforeConditionalFormat",void 0),Kt([G()],t.prototype,"actionBegin",void 0),Kt([G()],t.prototype,"actionComplete",void 0),Kt([G()],t.prototype,"openComplete",void 0),Kt([G()],t.prototype,"sortComplete",void 0),Kt([w("USD")],t.prototype,"currencyCode",void 0),t=e=Kt([It],t),t})(y9);var oP=["template"],cG=["height","id","left","src","top","width"],uG=[],dG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(uG),this.directivePropList=cG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-image"]],inputs:{height:"height",id:"id",left:"left",src:"src",top:"top",width:"width"},standalone:!1,features:[Xr]}),o})(),pG=(()=>{class o extends To{constructor(){super("image")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-images"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,dG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),fG=["dataLabelSettings","height","id","isSeriesInRows","legendSettings","markerSettings","primaryXAxis","primaryYAxis","range","theme","title","type","width"],gG=[],vG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(gG),this.directivePropList=fG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-chart"]],inputs:{dataLabelSettings:"dataLabelSettings",height:"height",id:"id",isSeriesInRows:"isSeriesInRows",legendSettings:"legendSettings",markerSettings:"markerSettings",primaryXAxis:"primaryXAxis",primaryYAxis:"primaryYAxis",range:"range",theme:"theme",title:"title",type:"type",width:"width"},standalone:!1,features:[Xr]}),o})(),mG=(()=>{class o extends To{constructor(){super("chart")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-charts"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,vG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),yG=["chart","colSpan","format","formula","hyperlink","image","index","isLocked","isReadOnly","notes","rowSpan","style","validation","value","wrap"],bG=[],SG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,this.tags=["image","chart"],Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(bG),this.directivePropList=yG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-cell"]],contentQueries:function(e,i,r){if(e&1&&(Kr(r,pG,5),Kr(r,mG,5)),e&2){let n;Er(n=Tr())&&(i.childImage=n.first),Er(n=Tr())&&(i.childChart=n.first)}},inputs:{chart:"chart",colSpan:"colSpan",format:"format",formula:"formula",hyperlink:"hyperlink",image:"image",index:"index",isLocked:"isLocked",isReadOnly:"isReadOnly",notes:"notes",rowSpan:"rowSpan",style:"style",validation:"validation",value:"value",wrap:"wrap"},standalone:!1,features:[Xr]}),o})(),CG=(()=>{class o extends To{constructor(){super("cells")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-cells"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,SG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),wG=["cells","customHeight","format","height","hidden","index","isReadOnly"],xG=[],IG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,this.tags=["cells"],Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(xG),this.directivePropList=wG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-row"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,CG,5),e&2){let n;Er(n=Tr())&&(i.childCells=n.first)}},inputs:{cells:"cells",customHeight:"customHeight",format:"format",height:"height",hidden:"hidden",index:"index",isReadOnly:"isReadOnly"},standalone:!1,features:[Xr]}),o})(),MG=(()=>{class o extends To{constructor(){super("rows")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-rows"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,IG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),DG=["customWidth","format","hidden","index","isLocked","isReadOnly","validation","width"],EG=[],mE=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(EG),this.directivePropList=DG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-column"]],inputs:{customWidth:"customWidth",format:"format",hidden:"hidden",index:"index",isLocked:"isLocked",isReadOnly:"isReadOnly",validation:"validation",width:"width"},standalone:!1,features:[Xr]}),o})(),yE=(()=>{class o extends To{constructor(){super("columns")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-columns"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,mE,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),TG=["address","dataSource","fieldsOrder","query","showFieldAsHeader","startCell","template"],AG=[],LG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(AG),this.directivePropList=TG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-range"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,oP,5),e&2){let n;Er(n=Tr())&&(i.template=n.first)}},inputs:{address:"address",dataSource:"dataSource",fieldsOrder:"fieldsOrder",query:"query",showFieldAsHeader:"showFieldAsHeader",startCell:"startCell",template:"template"},standalone:!1,features:[Xr]}),$g([Pw()],o.prototype,"template",void 0),o})(),NG=(()=>{class o extends To{constructor(){super("ranges")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-ranges"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,LG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),kG=["cFColor","format","range","type","value"],FG=[],RG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(FG),this.directivePropList=kG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-conditionalformat"]],inputs:{cFColor:"cFColor",format:"format",range:"range",type:"type",value:"value"},standalone:!1,features:[Xr]}),o})(),OG=(()=>{class o extends To{constructor(){super("conditionalformats")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-conditionalformats"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,RG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),zG=["activeCell","colCount","columns","conditionalFormats","frozenColumns","frozenRows","index","isProtected","name","paneTopLeftCell","password","protectSettings","ranges","rowCount","rows","selectedRange","showGridLines","showHeaders","standardHeight","state","topLeftCell","usedRange"],PG=[],bE=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,this.tags=["rows","columns","ranges","conditionalFormats"],Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(PG),this.directivePropList=zG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-sheet"]],contentQueries:function(e,i,r){if(e&1&&(Kr(r,MG,5),Kr(r,yE,5),Kr(r,NG,5),Kr(r,OG,5)),e&2){let n;Er(n=Tr())&&(i.childRows=n.first),Er(n=Tr())&&(i.childColumns=n.first),Er(n=Tr())&&(i.childRanges=n.first),Er(n=Tr())&&(i.childConditionalFormats=n.first)}},inputs:{activeCell:"activeCell",colCount:"colCount",columns:"columns",conditionalFormats:"conditionalFormats",frozenColumns:"frozenColumns",frozenRows:"frozenRows",index:"index",isProtected:"isProtected",name:"name",paneTopLeftCell:"paneTopLeftCell",password:"password",protectSettings:"protectSettings",ranges:"ranges",rowCount:"rowCount",rows:"rows",selectedRange:"selectedRange",showGridLines:"showGridLines",showHeaders:"showHeaders",standardHeight:"standardHeight",state:"state",topLeftCell:"topLeftCell",usedRange:"usedRange"},standalone:!1,features:[Xr]}),o})(),SE=(()=>{class o extends To{constructor(){super("sheets")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-sheets"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,bE,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})(),BG=["comment","name","refersTo","scope"],jG=[],HG=(()=>{class o extends Eo{constructor(e){super(),this.viewContainerRef=e,Ka("currentInstance",this,this.viewContainerRef),this.registerEvents(jG),this.directivePropList=BG}}return o.\u0275fac=function(e){return new(e||o)(On(Zn))},o.\u0275dir=tn({type:o,selectors:[["e-definedname"]],inputs:{comment:"comment",name:"name",refersTo:"refersTo",scope:"scope"},standalone:!1,features:[Xr]}),o})(),VG=(()=>{class o extends To{constructor(){super("definednames")}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=tn({type:o,selectors:[["e-definednames"]],contentQueries:function(e,i,r){if(e&1&&Kr(r,HG,4),e&2){let n;Er(n=Tr())&&(i.children=n)}},standalone:!1,features:[Xr]}),o})();var _G=["actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeCellFormat","beforeCellRender","beforeCellSave","beforeCellUpdate","beforeConditionalFormat","beforeDataBound","beforeHyperlinkClick","beforeHyperlinkCreate","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEdited","cellEditing","cellSave","contextMenuBeforeClose","contextMenuBeforeOpen","contextMenuItemSelect","created","dataBound","dataSourceChanged","dialogBeforeOpen","fileMenuBeforeClose","fileMenuBeforeOpen","fileMenuItemSelect","openComplete","openFailure","queryCellInfo","saveComplete","select","sortComplete"],UG=[""],lP=(()=>{let o=class extends sP{constructor(e,i,r,n){super(),this.ngEle=e,this.srenderer=i,this.viewContainerRef=r,this.injector=n,this.tags=["sheets","definedNames"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let s=this.injector.get("SpreadsheetClipboard");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetEdit");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetKeyboardNavigation");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetKeyboardShortcut");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetSelection");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetContextMenu");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetFormulaBar");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetRibbon");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetSave");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetOpen");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetSheetTabs");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetDataBind");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetCellFormat");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetNumberFormat");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}try{let s=this.injector.get("SpreadsheetFormula");this.injectedModules.indexOf(s)===-1&&this.injectedModules.push(s)}catch{}this.registerEvents(_G),this.addTwoWay.call(this,UG),Ka("currentInstance",this,this.viewContainerRef),this.context=new zw}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.tagObjects[0].instance=this.childSheets,this.childDefinedNames&&(this.tagObjects[1].instance=this.childDefinedNames),this.context.ngAfterContentChecked(this)}};return o.\u0275fac=function(e){return new(e||o)(On(ih),On(Qv),On(Zn),On(tl))},o.\u0275cmp=Np({type:o,selectors:[["ejs-spreadsheet"]],contentQueries:function(e,i,r){if(e&1&&(Kr(r,oP,5),Kr(r,SE,5),Kr(r,VG,5)),e&2){let n;Er(n=Tr())&&(i.template=n.first),Er(n=Tr())&&(i.childSheets=n.first),Er(n=Tr())&&(i.childDefinedNames=n.first)}},inputs:{activeSheetIndex:"activeSheetIndex",allowAutoFill:"allowAutoFill",allowCellFormatting:"allowCellFormatting",allowChart:"allowChart",allowConditionalFormat:"allowConditionalFormat",allowDataValidation:"allowDataValidation",allowDelete:"allowDelete",allowEditing:"allowEditing",allowFiltering:"allowFiltering",allowFindAndReplace:"allowFindAndReplace",allowFreezePane:"allowFreezePane",allowHyperlink:"allowHyperlink",allowImage:"allowImage",allowInsert:"allowInsert",allowMerge:"allowMerge",allowNumberFormatting:"allowNumberFormatting",allowOpen:"allowOpen",allowPrint:"allowPrint",allowResizing:"allowResizing",allowSave:"allowSave",allowScrolling:"allowScrolling",allowSorting:"allowSorting",allowUndoRedo:"allowUndoRedo",allowWrap:"allowWrap",autoFillSettings:"autoFillSettings",calculationMode:"calculationMode",cellStyle:"cellStyle",cssClass:"cssClass",currencyCode:"currencyCode",definedNames:"definedNames",enableClipboard:"enableClipboard",enableContextMenu:"enableContextMenu",enableKeyboardNavigation:"enableKeyboardNavigation",enableKeyboardShortcut:"enableKeyboardShortcut",enableNotes:"enableNotes",enablePersistence:"enablePersistence",enableRtl:"enableRtl",height:"height",isProtected:"isProtected",listSeparator:"listSeparator",locale:"locale",openSettings:"openSettings",openUrl:"openUrl",password:"password",saveUrl:"saveUrl",scrollSettings:"scrollSettings",selectionSettings:"selectionSettings",sheets:"sheets",showAggregate:"showAggregate",showFormulaBar:"showFormulaBar",showRibbon:"showRibbon",showSheetTabs:"showSheetTabs",width:"width"},outputs:{actionBegin:"actionBegin",actionComplete:"actionComplete",afterHyperlinkClick:"afterHyperlinkClick",afterHyperlinkCreate:"afterHyperlinkCreate",beforeCellFormat:"beforeCellFormat",beforeCellRender:"beforeCellRender",beforeCellSave:"beforeCellSave",beforeCellUpdate:"beforeCellUpdate",beforeConditionalFormat:"beforeConditionalFormat",beforeDataBound:"beforeDataBound",beforeHyperlinkClick:"beforeHyperlinkClick",beforeHyperlinkCreate:"beforeHyperlinkCreate",beforeOpen:"beforeOpen",beforeSave:"beforeSave",beforeSelect:"beforeSelect",beforeSort:"beforeSort",cellEdit:"cellEdit",cellEdited:"cellEdited",cellEditing:"cellEditing",cellSave:"cellSave",contextMenuBeforeClose:"contextMenuBeforeClose",contextMenuBeforeOpen:"contextMenuBeforeOpen",contextMenuItemSelect:"contextMenuItemSelect",created:"created",dataBound:"dataBound",dataSourceChanged:"dataSourceChanged",dialogBeforeOpen:"dialogBeforeOpen",fileMenuBeforeClose:"fileMenuBeforeClose",fileMenuBeforeOpen:"fileMenuBeforeOpen",fileMenuItemSelect:"fileMenuItemSelect",openComplete:"openComplete",openFailure:"openFailure",queryCellInfo:"queryCellInfo",saveComplete:"saveComplete",select:"select",sortComplete:"sortComplete"},standalone:!1,features:[Xr],decls:0,vars:0,template:function(e,i){},encapsulation:2,changeDetection:0}),$g([Pw()],o.prototype,"template",void 0),o=$g([QL([zw])],o),o})(),aP=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=ac({type:o}),o.\u0275inj=Ql({imports:[[jp]]}),o})(),WG={provide:"SpreadsheetClipboard",useValue:iE},qG={provide:"SpreadsheetEdit",useValue:rE},YG={provide:"SpreadsheetKeyboardNavigation",useValue:sE},GG={provide:"SpreadsheetKeyboardShortcut",useValue:aE},QG={provide:"SpreadsheetSelection",useValue:nE},XG={provide:"SpreadsheetContextMenu",useValue:gE},KG={provide:"SpreadsheetFormulaBar",useValue:cE},$G={provide:"SpreadsheetRibbon",useValue:hE},ZG={provide:"SpreadsheetSave",useValue:fE},JG={provide:"SpreadsheetOpen",useValue:pE},e7={provide:"SpreadsheetSheetTabs",useValue:dE},t7={provide:"SpreadsheetDataBind",useValue:q0},i7={provide:"SpreadsheetCellFormat",useValue:oE},r7={provide:"SpreadsheetNumberFormat",useValue:vE},n7={provide:"SpreadsheetFormula",useValue:uE},hP=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=ac({type:o}),o.\u0275inj=Ql({providers:[WG,qG,YG,GG,QG,XG,KG,$G,ZG,JG,e7,t7,i7,r7,n7],imports:[[jp,aP],aP]}),o})();var cP={Workbook:{definedNames:[],sheets:[{columns:[{width:100},{width:158},{width:72},{width:113},{width:113},{width:77},{width:97},{width:73}],conditionalFormats:[{type:"GYRColorScale",range:"C3:C10"},{type:"LessThan",cFColor:"RedF",range:"G3:G10",value:"43707,"},{type:"BlueDataBar",range:"D3:D10"},{type:"GreenDataBar",range:"E3:E10"},{type:"Top10Items",format:{style:{backgroundColor:"#009999",fontWeight:"Bold"}},range:"F3:F10",value:"1,"},{type:"Bottom10Items",format:{style:{backgroundColor:"#C68D53",fontWeight:"Bold"}},range:"F3:F10",value:"1,"},{type:"ThreeStars",range:"H3:H10"}],name:"Inventory List",rows:[{cells:[{colSpan:8,style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"},value:"Inventory List"},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}},{style:{fontSize:"13pt",fontWeight:"Bold",textAlign:"Center",verticalAlign:"Middle"}}],height:30},{cells:[{style:{fontWeight:"Bold",textAlign:"Center"},value:"Item Code"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Item Name"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Quantity"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Purchase Price"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Selling Price"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Profit"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Last Updated"},{style:{fontWeight:"Bold",textAlign:"Center"},value:"Rating"}]},{cells:[{value:"AG940Z"},{value:"Laser Printer"},{value:"144"},{format:"$#,##0.00",value:"169.5"},{format:"$#,##0.00",value:"172"},{format:"$#,##0.00",formula:"=E3-D3"},{format:"mm-dd-yyyy",value:"43610"},{value:"4.5"}]},{cells:[{value:"BJ120K"},{value:"Scientific Calculator"},{value:"116"},{format:"$#,##0.00",value:"21.8"},{format:"$#,##0.00",value:"23"},{format:"$#,##0.00",formula:"=E4-D4"},{format:"mm-dd-yyyy",value:"43674"},{value:"4"}]},{cells:[{value:"BC120M"},{value:"Wired Keyboard"},{value:"438"},{format:"$#,##0.00",value:"26.8"},{format:"$#,##0.00",value:"29"},{format:"$#,##0.00",formula:"=E5-D5"},{format:"mm-dd-yyyy",value:"43920"},{value:"4.25"}]},{cells:[{value:"BS121L"},{value:"Memory Card"},{value:"486"},{format:"$#,##0.00",value:"23.5"},{format:"$#,##0.00",value:"25"},{format:"$#,##0.00",formula:"=E6-D6"},{format:"mm-dd-yyyy",value:"43697"},{value:"3.5"}]},{cells:[{value:"BU121K"},{value:"Coffee Maker"},{value:"176"},{format:"$#,##0.00",value:"56.5"},{format:"$#,##0.00",value:"59"},{format:"$#,##0.00",formula:"=E7-D7"},{format:"mm-dd-yyyy",value:"43863"},{value:"4.5"}]},{cells:[{value:"BD121M"},{value:"Table Lamp"},{value:"0"},{format:"$#,##0.00",value:"22.5"},{format:"$#,##0.00",value:"25"},{format:"$#,##0.00",formula:"=E8-D8"},{format:"mm-dd-yyyy",value:"43780"},{value:"5"}]},{cells:[{value:"AT992X"},{value:"Document Scanner"},{value:"116"},{format:"$#,##0.00",value:"175"},{format:"$#,##0.00",value:"177"},{format:"$#,##0.00",formula:"=E9-D9"},{format:"mm-dd-yyyy",value:"43568"},{value:"4.75"}]},{cells:[{value:"AP992Z"},{value:"Gaming Headset"},{value:"58"},{format:"$#,##0.00",value:"32"},{format:"$#,##0.00",value:"35"},{format:"$#,##0.00",formula:"=E10-D10"},{format:"mm-dd-yyyy",value:"43875"},{value:"4.4"}]}],selectedRange:"A1:H1"}]}};var a7=["spreadsheet"],G0=class o{data;spreadsheetObj;created(){this.spreadsheetObj.openFromJson({file:cP})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=Np({type:o,selectors:[["app-container"]],viewQuery:function(e,i){if(e&1&&iw(a7,5),e&2){let r;Er(r=Tr())&&(i.spreadsheetObj=r.first)}},decls:11,vars:6,consts:[["spreadsheet",""],[3,"created"],[3,"width"]],template:function(e,i){if(e&1){let r=tw();Du(0,"ejs-spreadsheet",1,0),Kv("created",function(){return fv(r),gv(i.created())}),Du(2,"e-sheets")(3,"e-sheet")(4,"e-columns"),Xv(5,"e-column",2)(6,"e-column",2)(7,"e-column",2)(8,"e-column",2)(9,"e-column",2)(10,"e-column",2),Fp()()()()}e&2&&(rh(5),sl("width",90),rh(),sl("width",100),rh(),sl("width",96),rh(),sl("width",120),rh(),sl("width",130),rh(),sl("width",120))},dependencies:[hP,lP,mE,yE,bE,SE],encapsulation:2})};var $o=globalThis;function za(o){return($o.__Zone_symbol_prefix||"__zone_symbol__")+o}function o7(){let o=$o.performance;function t(B){o&&o.mark&&o.mark(B)}function e(B,F){o&&o.measure&&o.measure(B,F)}t("Zone");let i=(()=>{class B{static __symbol__=za;static assertZonePatched(){if($o.Promise!==A.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let O=B.current;for(;O.parent;)O=O.parent;return O}static get current(){return N.zone}static get currentTask(){return R}static __load_patch(O,z,Y=!1){if(A.hasOwnProperty(O)){let K=$o[za("forceDuplicateZoneCheck")]===!0;if(!Y&&K)throw Error("Already loaded patch: "+O)}else if(!$o["__Zone_disable_"+O]){let K="Zone:"+O;t(K),A[O]=z($o,B,L),e(K,K)}}get parent(){return this._parent}get name(){return this._name}_parent;_name;_properties;_zoneDelegate;constructor(O,z){this._parent=O,this._name=z?z.name||"unnamed":"<root>",this._properties=z&&z.properties||{},this._zoneDelegate=new n(this,this._parent&&this._parent._zoneDelegate,z)}get(O){let z=this.getZoneWith(O);if(z)return z._properties[O]}getZoneWith(O){let z=this;for(;z;){if(z._properties.hasOwnProperty(O))return z;z=z._parent}return null}fork(O){if(!O)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,O)}wrap(O,z){if(typeof O!="function")throw new Error("Expecting function got: "+O);let Y=this._zoneDelegate.intercept(this,O,z),K=this;return function(){return K.runGuarded(Y,this,arguments,z)}}run(O,z,Y,K){N={parent:N,zone:this};try{return this._zoneDelegate.invoke(this,O,z,Y,K)}finally{N=N.parent}}runGuarded(O,z=null,Y,K){N={parent:N,zone:this};try{try{return this._zoneDelegate.invoke(this,O,z,Y,K)}catch(U){if(this._zoneDelegate.handleError(this,U))throw U}}finally{N=N.parent}}runTask(O,z,Y){if(O.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(O.zone||m).name+"; Execution: "+this.name+")");let K=O,{type:U,data:{isPeriodic:q=!1,isRefreshable:ae=!1}={}}=O;if(O.state===y&&(U===E||U===M))return;let te=O.state!=C;te&&K._transitionTo(C,S);let he=R;R=K,N={parent:N,zone:this};try{U==M&&O.data&&!q&&!ae&&(O.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,K,z,Y)}catch(ue){if(this._zoneDelegate.handleError(this,ue))throw ue}}finally{let ue=O.state;if(ue!==y&&ue!==I)if(U==E||q||ae&&ue===b)te&&K._transitionTo(S,C,b);else{let ne=K._zoneDelegates;this._updateTaskCount(K,-1),te&&K._transitionTo(y,C,y),ae&&(K._zoneDelegates=ne)}N=N.parent,R=he}}scheduleTask(O){if(O.zone&&O.zone!==this){let Y=this;for(;Y;){if(Y===O.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${O.zone.name}`);Y=Y.parent}}O._transitionTo(b,y);let z=[];O._zoneDelegates=z,O._zone=this;try{O=this._zoneDelegate.scheduleTask(this,O)}catch(Y){throw O._transitionTo(I,b,y),this._zoneDelegate.handleError(this,Y),Y}return O._zoneDelegates===z&&this._updateTaskCount(O,1),O.state==b&&O._transitionTo(S,b),O}scheduleMicroTask(O,z,Y,K){return this.scheduleTask(new s(D,O,z,Y,K,void 0))}scheduleMacroTask(O,z,Y,K,U){return this.scheduleTask(new s(M,O,z,Y,K,U))}scheduleEventTask(O,z,Y,K,U){return this.scheduleTask(new s(E,O,z,Y,K,U))}cancelTask(O){if(O.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(O.zone||m).name+"; Execution: "+this.name+")");if(!(O.state!==S&&O.state!==C)){O._transitionTo(x,S,C);try{this._zoneDelegate.cancelTask(this,O)}catch(z){throw O._transitionTo(I,x),this._zoneDelegate.handleError(this,z),z}return this._updateTaskCount(O,-1),O._transitionTo(y,x),O.runCount=-1,O}}_updateTaskCount(O,z){let Y=O._zoneDelegates;z==-1&&(O._zoneDelegates=null);for(let K=0;K<Y.length;K++)Y[K]._updateTaskCount(O.type,z)}}return B})(),r={name:"",onHasTask:(B,F,O,z)=>B.hasTask(O,z),onScheduleTask:(B,F,O,z)=>B.scheduleTask(O,z),onInvokeTask:(B,F,O,z,Y,K)=>B.invokeTask(O,z,Y,K),onCancelTask:(B,F,O,z)=>B.cancelTask(O,z)};class n{get zone(){return this._zone}_zone;_taskCounts={microTask:0,macroTask:0,eventTask:0};_parentDelegate;_forkDlgt;_forkZS;_forkCurrZone;_interceptDlgt;_interceptZS;_interceptCurrZone;_invokeDlgt;_invokeZS;_invokeCurrZone;_handleErrorDlgt;_handleErrorZS;_handleErrorCurrZone;_scheduleTaskDlgt;_scheduleTaskZS;_scheduleTaskCurrZone;_invokeTaskDlgt;_invokeTaskZS;_invokeTaskCurrZone;_cancelTaskDlgt;_cancelTaskZS;_cancelTaskCurrZone;_hasTaskDlgt;_hasTaskDlgtOwner;_hasTaskZS;_hasTaskCurrZone;constructor(F,O,z){this._zone=F,this._parentDelegate=O,this._forkZS=z&&(z&&z.onFork?z:O._forkZS),this._forkDlgt=z&&(z.onFork?O:O._forkDlgt),this._forkCurrZone=z&&(z.onFork?this._zone:O._forkCurrZone),this._interceptZS=z&&(z.onIntercept?z:O._interceptZS),this._interceptDlgt=z&&(z.onIntercept?O:O._interceptDlgt),this._interceptCurrZone=z&&(z.onIntercept?this._zone:O._interceptCurrZone),this._invokeZS=z&&(z.onInvoke?z:O._invokeZS),this._invokeDlgt=z&&(z.onInvoke?O:O._invokeDlgt),this._invokeCurrZone=z&&(z.onInvoke?this._zone:O._invokeCurrZone),this._handleErrorZS=z&&(z.onHandleError?z:O._handleErrorZS),this._handleErrorDlgt=z&&(z.onHandleError?O:O._handleErrorDlgt),this._handleErrorCurrZone=z&&(z.onHandleError?this._zone:O._handleErrorCurrZone),this._scheduleTaskZS=z&&(z.onScheduleTask?z:O._scheduleTaskZS),this._scheduleTaskDlgt=z&&(z.onScheduleTask?O:O._scheduleTaskDlgt),this._scheduleTaskCurrZone=z&&(z.onScheduleTask?this._zone:O._scheduleTaskCurrZone),this._invokeTaskZS=z&&(z.onInvokeTask?z:O._invokeTaskZS),this._invokeTaskDlgt=z&&(z.onInvokeTask?O:O._invokeTaskDlgt),this._invokeTaskCurrZone=z&&(z.onInvokeTask?this._zone:O._invokeTaskCurrZone),this._cancelTaskZS=z&&(z.onCancelTask?z:O._cancelTaskZS),this._cancelTaskDlgt=z&&(z.onCancelTask?O:O._cancelTaskDlgt),this._cancelTaskCurrZone=z&&(z.onCancelTask?this._zone:O._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;let Y=z&&z.onHasTask,K=O&&O._hasTaskZS;(Y||K)&&(this._hasTaskZS=Y?z:r,this._hasTaskDlgt=O,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=this._zone,z.onScheduleTask||(this._scheduleTaskZS=r,this._scheduleTaskDlgt=O,this._scheduleTaskCurrZone=this._zone),z.onInvokeTask||(this._invokeTaskZS=r,this._invokeTaskDlgt=O,this._invokeTaskCurrZone=this._zone),z.onCancelTask||(this._cancelTaskZS=r,this._cancelTaskDlgt=O,this._cancelTaskCurrZone=this._zone))}fork(F,O){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,F,O):new i(F,O)}intercept(F,O,z){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,F,O,z):O}invoke(F,O,z,Y,K){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,F,O,z,Y,K):O.apply(z,Y)}handleError(F,O){return this._handleErrorZS?this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,F,O):!0}scheduleTask(F,O){let z=O;if(this._scheduleTaskZS)this._hasTaskZS&&z._zoneDelegates.push(this._hasTaskDlgtOwner),z=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,F,O),z||(z=O);else if(O.scheduleFn)O.scheduleFn(O);else if(O.type==D)f(O);else throw new Error("Task is missing scheduleFn.");return z}invokeTask(F,O,z,Y){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,F,O,z,Y):O.callback.apply(z,Y)}cancelTask(F,O){let z;if(this._cancelTaskZS)z=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,F,O);else{if(!O.cancelFn)throw Error("Task is not cancelable");z=O.cancelFn(O)}return z}hasTask(F,O){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,F,O)}catch(z){this.handleError(F,z)}}_updateTaskCount(F,O){let z=this._taskCounts,Y=z[F],K=z[F]=Y+O;if(K<0)throw new Error("More tasks executed then were scheduled.");if(Y==0||K==0){let U={microTask:z.microTask>0,macroTask:z.macroTask>0,eventTask:z.eventTask>0,change:F};this.hasTask(this._zone,U)}}}class s{type;source;invoke;callback;data;scheduleFn;cancelFn;_zone=null;runCount=0;_zoneDelegates=null;_state="notScheduled";constructor(F,O,z,Y,K,U){if(this.type=F,this.source=O,this.data=Y,this.scheduleFn=K,this.cancelFn=U,!z)throw new Error("callback is not defined");this.callback=z;let q=this;F===E&&Y&&Y.useG?this.invoke=s.invokeTask:this.invoke=function(){return s.invokeTask.call($o,q,this,arguments)}}static invokeTask(F,O,z){F||(F=this),P++;try{return F.runCount++,F.zone.runTask(F,O,z)}finally{P==1&&v(),P--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(y,b)}_transitionTo(F,O,z){if(this._state===O||this._state===z)this._state=F,F==y&&(this._zoneDelegates=null);else throw new Error(`${this.type} '${this.source}': can not transition to '${F}', expecting state '${O}'${z?" or '"+z+"'":""}, was '${this._state}'.`)}toString(){return this.data&&typeof this.data.handleId<"u"?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}let a=za("setTimeout"),l=za("Promise"),h=za("then"),c=[],u=!1,d;function p(B){if(d||$o[l]&&(d=$o[l].resolve(0)),d){let F=d[h];F||(F=d.then),F.call(d,B)}else $o[a](B,0)}function f(B){P===0&&c.length===0&&p(v),B&&c.push(B)}function v(){if(!u){for(u=!0;c.length;){let B=c;c=[];for(let F=0;F<B.length;F++){let O=B[F];try{O.zone.runTask(O,null,null)}catch(z){L.onUnhandledError(z)}}}L.microtaskDrainDone(),u=!1}}let m={name:"NO ZONE"},y="notScheduled",b="scheduling",S="scheduled",C="running",x="canceling",I="unknown",D="microTask",M="macroTask",E="eventTask",A={},L={symbol:za,currentZoneFrame:()=>N,onUnhandledError:k,microtaskDrainDone:k,scheduleMicroTask:f,showUncaughtError:()=>!i[za("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:k,patchMethod:()=>k,bindArguments:()=>[],patchThen:()=>k,patchMacroTask:()=>k,patchEventPrototype:()=>k,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>k,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>k,wrapWithCurrentZone:()=>k,filterProperties:()=>[],attachOriginToPatched:()=>k,_redefineProperty:()=>k,patchCallbacks:()=>k,nativeScheduleMicroTask:p},N={parent:null,zone:new i(null,null)},R=null,P=0;function k(){}return e("Zone","Zone"),i}function l7(){let o=globalThis,t=o[za("forceDuplicateZoneCheck")]===!0;if(o.Zone&&(t||typeof o.Zone.__symbol__!="function"))throw new Error("Zone already loaded.");return o.Zone??=o7(),o.Zone}var Vg=Object.getOwnPropertyDescriptor,ME=Object.defineProperty,DE=Object.getPrototypeOf,h7=Object.create,c7=Array.prototype.slice,EE="addEventListener",TE="removeEventListener",CE=za(EE),wE=za(TE),Vl="true",_l="false",_g=za("");function AE(o,t){return Zone.current.wrap(o,t)}function LE(o,t,e,i,r){return Zone.current.scheduleMacroTask(o,t,e,i,r)}var Vi=za,K0=typeof window<"u",Ug=K0?window:void 0,wn=K0&&Ug||globalThis,u7="removeAttribute";function NE(o,t){for(let e=o.length-1;e>=0;e--)typeof o[e]=="function"&&(o[e]=AE(o[e],t+"_"+e));return o}function d7(o,t){let e=o.constructor.name;for(let i=0;i<t.length;i++){let r=t[i],n=o[r];if(n){let s=Vg(o,r);if(!mP(s))continue;o[r]=(a=>{let l=function(){return a.apply(this,NE(arguments,e+"."+r))};return Wl(l,a),l})(n)}}}function mP(o){return o?o.writable===!1?!1:!(typeof o.get=="function"&&typeof o.set>"u"):!0}var yP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,$0=!("nw"in wn)&&typeof wn.process<"u"&&wn.process.toString()==="[object process]",kE=!$0&&!yP&&!!(K0&&Ug.HTMLElement),bP=typeof wn.process<"u"&&wn.process.toString()==="[object process]"&&!yP&&!!(K0&&Ug.HTMLElement),X0={},p7=Vi("enable_beforeunload"),uP=function(o){if(o=o||wn.event,!o)return;let t=X0[o.type];t||(t=X0[o.type]=Vi("ON_PROPERTY"+o.type));let e=this||o.target||wn,i=e[t],r;if(kE&&e===Ug&&o.type==="error"){let n=o;r=i&&i.call(this,n.message,n.filename,n.lineno,n.colno,n.error),r===!0&&o.preventDefault()}else r=i&&i.apply(this,arguments),o.type==="beforeunload"&&wn[p7]&&typeof r=="string"?o.returnValue=r:r!=null&&!r&&o.preventDefault();return r};function dP(o,t,e){let i=Vg(o,t);if(!i&&e&&Vg(e,t)&&(i={enumerable:!0,configurable:!0}),!i||!i.configurable)return;let r=Vi("on"+t+"patched");if(o.hasOwnProperty(r)&&o[r])return;delete i.writable,delete i.value;let n=i.get,s=i.set,a=t.slice(2),l=X0[a];l||(l=X0[a]=Vi("ON_PROPERTY"+a)),i.set=function(h){let c=this;if(!c&&o===wn&&(c=wn),!c)return;typeof c[l]=="function"&&c.removeEventListener(a,uP),s?.call(c,null),c[l]=h,typeof h=="function"&&c.addEventListener(a,uP,!1)},i.get=function(){let h=this;if(!h&&o===wn&&(h=wn),!h)return null;let c=h[l];if(c)return c;if(n){let u=n.call(this);if(u)return i.set.call(this,u),typeof h[u7]=="function"&&h.removeAttribute(t),u}return null},ME(o,t,i),o[r]=!0}function SP(o,t,e){if(t)for(let i=0;i<t.length;i++)dP(o,"on"+t[i],e);else{let i=[];for(let r in o)r.slice(0,2)=="on"&&i.push(r);for(let r=0;r<i.length;r++)dP(o,i[r],e)}}var bo=Vi("originalInstance");function Hg(o){let t=wn[o];if(!t)return;wn[Vi(o)]=t,wn[o]=function(){let r=NE(arguments,o);switch(r.length){case 0:this[bo]=new t;break;case 1:this[bo]=new t(r[0]);break;case 2:this[bo]=new t(r[0],r[1]);break;case 3:this[bo]=new t(r[0],r[1],r[2]);break;case 4:this[bo]=new t(r[0],r[1],r[2],r[3]);break;default:throw new Error("Arg list too long.")}},Wl(wn[o],t);let e=new t(function(){}),i;for(i in e)o==="XMLHttpRequest"&&i==="responseBlob"||(function(r){typeof e[r]=="function"?wn[o].prototype[r]=function(){return this[bo][r].apply(this[bo],arguments)}:ME(wn[o].prototype,r,{set:function(n){typeof n=="function"?(this[bo][r]=AE(n,o+"."+r),Wl(this[bo][r],n)):this[bo][r]=n},get:function(){return this[bo][r]}})})(i);for(i in t)i!=="prototype"&&t.hasOwnProperty(i)&&(wn[o][i]=t[i])}function Ul(o,t,e){let i=o;for(;i&&!i.hasOwnProperty(t);)i=DE(i);!i&&o[t]&&(i=o);let r=Vi(t),n=null;if(i&&(!(n=i[r])||!i.hasOwnProperty(r))){n=i[r]=i[t];let s=i&&Vg(i,t);if(mP(s)){let a=e(n,r,t);i[t]=function(){return a(this,arguments)},Wl(i[t],n)}}return n}function f7(o,t,e){let i=null;function r(n){let s=n.data;return s.args[s.cbIdx]=function(){n.invoke.apply(this,arguments)},i.apply(s.target,s.args),n}i=Ul(o,t,n=>function(s,a){let l=e(s,a);return l.cbIdx>=0&&typeof a[l.cbIdx]=="function"?LE(l.name,a[l.cbIdx],l,r):n.apply(s,a)})}function Wl(o,t){o[Vi("OriginalDelegate")]=t}var pP=!1,xE=!1;function g7(){if(pP)return xE;pP=!0;try{let o=Ug.navigator.userAgent;(o.indexOf("MSIE ")!==-1||o.indexOf("Trident/")!==-1||o.indexOf("Edge/")!==-1)&&(xE=!0)}catch{}return xE}function fP(o){return typeof o=="function"}function gP(o){return typeof o=="number"}var v7={useG:!0},Pa={},CP={},wP=new RegExp("^"+_g+"(\\w+)(true|false)$"),xP=Vi("propagationStopped");function IP(o,t){let e=(t?t(o):o)+_l,i=(t?t(o):o)+Vl,r=_g+e,n=_g+i;Pa[o]={},Pa[o][_l]=r,Pa[o][Vl]=n}function m7(o,t,e,i){let r=i&&i.add||EE,n=i&&i.rm||TE,s=i&&i.listeners||"eventListeners",a=i&&i.rmAll||"removeAllListeners",l=Vi(r),h="."+r+":",c="prependListener",u="."+c+":",d=function(b,S,C){if(b.isRemoved)return;let x=b.callback;typeof x=="object"&&x.handleEvent&&(b.callback=M=>x.handleEvent(M),b.originalDelegate=x);let I;try{b.invoke(b,S,[C])}catch(M){I=M}let D=b.options;if(D&&typeof D=="object"&&D.once){let M=b.originalDelegate?b.originalDelegate:b.callback;S[n].call(S,C.type,M,D)}return I};function p(b,S,C){if(S=S||o.event,!S)return;let x=b||S.target||o,I=x[Pa[S.type][C?Vl:_l]];if(I){let D=[];if(I.length===1){let M=d(I[0],x,S);M&&D.push(M)}else{let M=I.slice();for(let E=0;E<M.length&&!(S&&S[xP]===!0);E++){let A=d(M[E],x,S);A&&D.push(A)}}if(D.length===1)throw D[0];for(let M=0;M<D.length;M++){let E=D[M];t.nativeScheduleMicroTask(()=>{throw E})}}}let f=function(b){return p(this,b,!1)},v=function(b){return p(this,b,!0)};function m(b,S){if(!b)return!1;let C=!0;S&&S.useG!==void 0&&(C=S.useG);let x=S&&S.vh,I=!0;S&&S.chkDup!==void 0&&(I=S.chkDup);let D=!1;S&&S.rt!==void 0&&(D=S.rt);let M=b;for(;M&&!M.hasOwnProperty(r);)M=DE(M);if(!M&&b[r]&&(M=b),!M||M[l])return!1;let E=S&&S.eventNameToString,A={},L=M[l]=M[r],N=M[Vi(n)]=M[n],R=M[Vi(s)]=M[s],P=M[Vi(a)]=M[a],k;S&&S.prepend&&(k=M[Vi(S.prepend)]=M[S.prepend]);function B($,ee){return ee?typeof $=="boolean"?{capture:$,passive:!0}:$?typeof $=="object"&&$.passive!==!1?oa(cs({},$),{passive:!0}):$:{passive:!0}:$}let F=function($){if(!A.isExisting)return L.call(A.target,A.eventName,A.capture?v:f,A.options)},O=function($){if(!$.isRemoved){let ee=Pa[$.eventName],He;ee&&(He=ee[$.capture?Vl:_l]);let qe=He&&$.target[He];if(qe){for(let we=0;we<qe.length;we++)if(qe[we]===$){qe.splice(we,1),$.isRemoved=!0,$.removeAbortListener&&($.removeAbortListener(),$.removeAbortListener=null),qe.length===0&&($.allRemoved=!0,$.target[He]=null);break}}}if($.allRemoved)return N.call($.target,$.eventName,$.capture?v:f,$.options)},z=function($){return L.call(A.target,A.eventName,$.invoke,A.options)},Y=function($){return k.call(A.target,A.eventName,$.invoke,A.options)},K=function($){return N.call($.target,$.eventName,$.invoke,$.options)},U=C?F:z,q=C?O:K,ae=function($,ee){let He=typeof ee;return He==="function"&&$.callback===ee||He==="object"&&$.originalDelegate===ee},te=S?.diff||ae,he=Zone[Vi("UNPATCHED_EVENTS")],ue=o[Vi("PASSIVE_EVENTS")];function ne($){if(typeof $=="object"&&$!==null){let ee=cs({},$);return $.signal&&(ee.signal=$.signal),ee}return $}let le=function($,ee,He,qe,we=!1,je=!1){return function(){let Ne=this||o,Ye=arguments[0];S&&S.transferEventName&&(Ye=S.transferEventName(Ye));let dt=arguments[1];if(!dt)return $.apply(this,arguments);if($0&&Ye==="uncaughtException")return $.apply(this,arguments);let Ke=!1;if(typeof dt!="function"){if(!dt.handleEvent)return $.apply(this,arguments);Ke=!0}if(x&&!x($,dt,Ne,arguments))return;let ci=!!ue&&ue.indexOf(Ye)!==-1,Jt=ne(B(arguments[2],ci)),vt=Jt?.signal;if(vt?.aborted)return;if(he){for(let Dt=0;Dt<he.length;Dt++)if(Ye===he[Dt])return ci?$.call(Ne,Ye,dt,Jt):$.apply(this,arguments)}let bi=Jt?typeof Jt=="boolean"?!0:Jt.capture:!1,Bi=Jt&&typeof Jt=="object"?Jt.once:!1,Dr=Zone.current,vr=Pa[Ye];vr||(IP(Ye,E),vr=Pa[Ye]);let Fi=vr[bi?Vl:_l],tr=Ne[Fi],_=!1;if(tr){if(_=!0,I){for(let Dt=0;Dt<tr.length;Dt++)if(te(tr[Dt],dt))return}}else tr=Ne[Fi]=[];let re,Se=Ne.constructor.name,Be=CP[Se];Be&&(re=Be[Ye]),re||(re=Se+ee+(E?E(Ye):Ye)),A.options=Jt,Bi&&(A.options.once=!1),A.target=Ne,A.capture=bi,A.eventName=Ye,A.isExisting=_;let _e=C?v7:void 0;_e&&(_e.taskData=A),vt&&(A.options.signal=void 0);let We=Dr.scheduleEventTask(re,dt,_e,He,qe);if(vt){A.options.signal=vt;let Dt=()=>We.zone.cancelTask(We);$.call(vt,"abort",Dt,{once:!0}),We.removeAbortListener=()=>vt.removeEventListener("abort",Dt)}if(A.target=null,_e&&(_e.taskData=null),Bi&&(A.options.once=!0),typeof We.options!="boolean"&&(We.options=Jt),We.target=Ne,We.capture=bi,We.eventName=Ye,Ke&&(We.originalDelegate=dt),je?tr.unshift(We):tr.push(We),we)return Ne}};return M[r]=le(L,h,U,q,D),k&&(M[c]=le(k,u,Y,q,D,!0)),M[n]=function(){let $=this||o,ee=arguments[0];S&&S.transferEventName&&(ee=S.transferEventName(ee));let He=arguments[2],qe=He?typeof He=="boolean"?!0:He.capture:!1,we=arguments[1];if(!we)return N.apply(this,arguments);if(x&&!x(N,we,$,arguments))return;let je=Pa[ee],Ne;je&&(Ne=je[qe?Vl:_l]);let Ye=Ne&&$[Ne];if(Ye)for(let dt=0;dt<Ye.length;dt++){let Ke=Ye[dt];if(te(Ke,we)){if(Ye.splice(dt,1),Ke.isRemoved=!0,Ye.length===0&&(Ke.allRemoved=!0,$[Ne]=null,!qe&&typeof ee=="string")){let ci=_g+"ON_PROPERTY"+ee;$[ci]=null}return Ke.zone.cancelTask(Ke),D?$:void 0}}return N.apply(this,arguments)},M[s]=function(){let $=this||o,ee=arguments[0];S&&S.transferEventName&&(ee=S.transferEventName(ee));let He=[],qe=MP($,E?E(ee):ee);for(let we=0;we<qe.length;we++){let je=qe[we],Ne=je.originalDelegate?je.originalDelegate:je.callback;He.push(Ne)}return He},M[a]=function(){let $=this||o,ee=arguments[0];if(ee){S&&S.transferEventName&&(ee=S.transferEventName(ee));let He=Pa[ee];if(He){let qe=He[_l],we=He[Vl],je=$[qe],Ne=$[we];if(je){let Ye=je.slice();for(let dt=0;dt<Ye.length;dt++){let Ke=Ye[dt],ci=Ke.originalDelegate?Ke.originalDelegate:Ke.callback;this[n].call(this,ee,ci,Ke.options)}}if(Ne){let Ye=Ne.slice();for(let dt=0;dt<Ye.length;dt++){let Ke=Ye[dt],ci=Ke.originalDelegate?Ke.originalDelegate:Ke.callback;this[n].call(this,ee,ci,Ke.options)}}}}else{let He=Object.keys($);for(let qe=0;qe<He.length;qe++){let we=He[qe],je=wP.exec(we),Ne=je&&je[1];Ne&&Ne!=="removeListener"&&this[a].call(this,Ne)}this[a].call(this,"removeListener")}if(D)return this},Wl(M[r],L),Wl(M[n],N),P&&Wl(M[a],P),R&&Wl(M[s],R),!0}let y=[];for(let b=0;b<e.length;b++)y[b]=m(e[b],i);return y}function MP(o,t){if(!t){let n=[];for(let s in o){let a=wP.exec(s),l=a&&a[1];if(l&&(!t||l===t)){let h=o[s];if(h)for(let c=0;c<h.length;c++)n.push(h[c])}}return n}let e=Pa[t];e||(IP(t),e=Pa[t]);let i=o[e[_l]],r=o[e[Vl]];return i?r?i.concat(r):i.slice():r?r.slice():[]}function y7(o,t){let e=o.Event;e&&e.prototype&&t.patchMethod(e.prototype,"stopImmediatePropagation",i=>function(r,n){r[xP]=!0,i&&i.apply(r,n)})}function b7(o,t){t.patchMethod(o,"queueMicrotask",e=>function(i,r){Zone.current.scheduleMicroTask("queueMicrotask",r[0])})}var Q0=Vi("zoneTask");function np(o,t,e,i){let r=null,n=null;t+=i,e+=i;let s={};function a(h){let c=h.data;c.args[0]=function(){return h.invoke.apply(this,arguments)};let u=r.apply(o,c.args);return gP(u)?c.handleId=u:(c.handle=u,c.isRefreshable=fP(u.refresh)),h}function l(h){let{handle:c,handleId:u}=h.data;return n.call(o,c??u)}r=Ul(o,t,h=>function(c,u){if(fP(u[0])){let d={isRefreshable:!1,isPeriodic:i==="Interval",delay:i==="Timeout"||i==="Interval"?u[1]||0:void 0,args:u},p=u[0];u[0]=function(){try{return p.apply(this,arguments)}finally{let{handle:C,handleId:x,isPeriodic:I,isRefreshable:D}=d;!I&&!D&&(x?delete s[x]:C&&(C[Q0]=null))}};let f=LE(t,u[0],d,a,l);if(!f)return f;let{handleId:v,handle:m,isRefreshable:y,isPeriodic:b}=f.data;if(v)s[v]=f;else if(m&&(m[Q0]=f,y&&!b)){let S=m.refresh;m.refresh=function(){let{zone:C,state:x}=f;return x==="notScheduled"?(f._state="scheduled",C._updateTaskCount(f,1)):x==="running"&&(f._state="scheduling"),S.call(this)}}return m??v??f}else return h.apply(o,u)}),n=Ul(o,e,h=>function(c,u){let d=u[0],p;gP(d)?(p=s[d],delete s[d]):(p=d?.[Q0],p?d[Q0]=null:p=d),p?.type?p.cancelFn&&p.zone.cancelTask(p):h.apply(o,u)})}function S7(o,t){let{isBrowser:e,isMix:i}=t.getGlobalObjects();if(!e&&!i||!o.customElements||!("customElements"in o))return;let r=["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","formAssociatedCallback","formDisabledCallback","formResetCallback","formStateRestoreCallback"];t.patchCallbacks(t,o.customElements,"customElements","define",r)}function C7(o,t){if(Zone[t.symbol("patchEventTarget")])return;let{eventNames:e,zoneSymbolEventNames:i,TRUE_STR:r,FALSE_STR:n,ZONE_SYMBOL_PREFIX:s}=t.getGlobalObjects();for(let l=0;l<e.length;l++){let h=e[l],c=h+n,u=h+r,d=s+c,p=s+u;i[h]={},i[h][n]=d,i[h][r]=p}let a=o.EventTarget;if(!(!a||!a.prototype))return t.patchEventTarget(o,t,[a&&a.prototype]),!0}function w7(o,t){t.patchEventPrototype(o,t)}function DP(o,t,e){if(!e||e.length===0)return t;let i=e.filter(n=>n.target===o);if(i.length===0)return t;let r=i[0].ignoreProperties;return t.filter(n=>r.indexOf(n)===-1)}function vP(o,t,e,i){if(!o)return;let r=DP(o,t,e);SP(o,r,i)}function IE(o){return Object.getOwnPropertyNames(o).filter(t=>t.startsWith("on")&&t.length>2).map(t=>t.substring(2))}function x7(o,t){if($0&&!bP||Zone[o.symbol("patchEvents")])return;let e=t.__Zone_ignore_on_properties,i=[];if(kE){let r=window;i=i.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);let n=[];vP(r,IE(r),e&&e.concat(n),DE(r))}i=i.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(let r=0;r<i.length;r++){let n=t[i[r]];n?.prototype&&vP(n.prototype,IE(n.prototype),e)}}function I7(o){o.__load_patch("legacy",t=>{let e=t[o.__symbol__("legacyPatch")];e&&e()}),o.__load_patch("timers",t=>{let i="clear";np(t,"set",i,"Timeout"),np(t,"set",i,"Interval"),np(t,"set",i,"Immediate")}),o.__load_patch("requestAnimationFrame",t=>{np(t,"request","cancel","AnimationFrame"),np(t,"mozRequest","mozCancel","AnimationFrame"),np(t,"webkitRequest","webkitCancel","AnimationFrame")}),o.__load_patch("blocking",(t,e)=>{let i=["alert","prompt","confirm"];for(let r=0;r<i.length;r++){let n=i[r];Ul(t,n,(s,a,l)=>function(h,c){return e.current.run(s,t,c,l)})}}),o.__load_patch("EventTarget",(t,e,i)=>{w7(t,i),C7(t,i);let r=t.XMLHttpRequestEventTarget;r&&r.prototype&&i.patchEventTarget(t,i,[r.prototype])}),o.__load_patch("MutationObserver",(t,e,i)=>{Hg("MutationObserver"),Hg("WebKitMutationObserver")}),o.__load_patch("IntersectionObserver",(t,e,i)=>{Hg("IntersectionObserver")}),o.__load_patch("FileReader",(t,e,i)=>{Hg("FileReader")}),o.__load_patch("on_property",(t,e,i)=>{x7(i,t)}),o.__load_patch("customElements",(t,e,i)=>{S7(t,i)}),o.__load_patch("XHR",(t,e)=>{h(t);let i=Vi("xhrTask"),r=Vi("xhrSync"),n=Vi("xhrListener"),s=Vi("xhrScheduled"),a=Vi("xhrURL"),l=Vi("xhrErrorBeforeScheduled");function h(c){let u=c.XMLHttpRequest;if(!u)return;let d=u.prototype;function p(L){return L[i]}let f=d[CE],v=d[wE];if(!f){let L=c.XMLHttpRequestEventTarget;if(L){let N=L.prototype;f=N[CE],v=N[wE]}}let m="readystatechange",y="scheduled";function b(L){let N=L.data,R=N.target;R[s]=!1,R[l]=!1;let P=R[n];f||(f=R[CE],v=R[wE]),P&&v.call(R,m,P);let k=R[n]=()=>{if(R.readyState===R.DONE)if(!N.aborted&&R[s]&&L.state===y){let F=R[e.__symbol__("loadfalse")];if(R.status!==0&&F&&F.length>0){let O=L.invoke;L.invoke=function(){let z=R[e.__symbol__("loadfalse")];for(let Y=0;Y<z.length;Y++)z[Y]===L&&z.splice(Y,1);!N.aborted&&L.state===y&&O.call(L)},F.push(L)}else L.invoke()}else!N.aborted&&R[s]===!1&&(R[l]=!0)};return f.call(R,m,k),R[i]||(R[i]=L),E.apply(R,N.args),R[s]=!0,L}function S(){}function C(L){let N=L.data;return N.aborted=!0,A.apply(N.target,N.args)}let x=Ul(d,"open",()=>function(L,N){return L[r]=N[2]==!1,L[a]=N[1],x.apply(L,N)}),I="XMLHttpRequest.send",D=Vi("fetchTaskAborting"),M=Vi("fetchTaskScheduling"),E=Ul(d,"send",()=>function(L,N){if(e.current[M]===!0||L[r])return E.apply(L,N);{let R={target:L,url:L[a],isPeriodic:!1,args:N,aborted:!1},P=LE(I,S,R,b,C);L&&L[l]===!0&&!R.aborted&&P.state===y&&P.invoke()}}),A=Ul(d,"abort",()=>function(L,N){let R=p(L);if(R&&typeof R.type=="string"){if(R.cancelFn==null||R.data&&R.data.aborted)return;R.zone.cancelTask(R)}else if(e.current[D]===!0)return A.apply(L,N)})}}),o.__load_patch("geolocation",t=>{t.navigator&&t.navigator.geolocation&&d7(t.navigator.geolocation,["getCurrentPosition","watchPosition"])}),o.__load_patch("PromiseRejectionEvent",(t,e)=>{function i(r){return function(n){MP(t,r).forEach(a=>{let l=t.PromiseRejectionEvent;if(l){let h=new l(r,{promise:n.promise,reason:n.rejection});a.invoke(h)}})}}t.PromiseRejectionEvent&&(e[Vi("unhandledPromiseRejectionHandler")]=i("unhandledrejection"),e[Vi("rejectionHandledHandler")]=i("rejectionhandled"))}),o.__load_patch("queueMicrotask",(t,e,i)=>{b7(t,i)})}function M7(o){o.__load_patch("ZoneAwarePromise",(t,e,i)=>{let r=Object.getOwnPropertyDescriptor,n=Object.defineProperty;function s(ne){if(ne&&ne.toString===Object.prototype.toString){let le=ne.constructor&&ne.constructor.name;return(le||"")+": "+JSON.stringify(ne)}return ne?ne.toString():Object.prototype.toString.call(ne)}let a=i.symbol,l=[],h=t[a("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")]!==!1,c=a("Promise"),u=a("then"),d="__creationTrace__";i.onUnhandledError=ne=>{if(i.showUncaughtError()){let le=ne&&ne.rejection;le?console.error("Unhandled Promise rejection:",le instanceof Error?le.message:le,"; Zone:",ne.zone.name,"; Task:",ne.task&&ne.task.source,"; Value:",le,le instanceof Error?le.stack:void 0):console.error(ne)}},i.microtaskDrainDone=()=>{for(;l.length;){let ne=l.shift();try{ne.zone.runGuarded(()=>{throw ne.throwOriginal?ne.rejection:ne})}catch(le){f(le)}}};let p=a("unhandledPromiseRejectionHandler");function f(ne){i.onUnhandledError(ne);try{let le=e[p];typeof le=="function"&&le.call(this,ne)}catch{}}function v(ne){return ne&&typeof ne.then=="function"}function m(ne){return ne}function y(ne){return q.reject(ne)}let b=a("state"),S=a("value"),C=a("finally"),x=a("parentPromiseValue"),I=a("parentPromiseState"),D="Promise.then",M=null,E=!0,A=!1,L=0;function N(ne,le){return $=>{try{B(ne,le,$)}catch(ee){B(ne,!1,ee)}}}let R=function(){let ne=!1;return function($){return function(){ne||(ne=!0,$.apply(null,arguments))}}},P="Promise resolved with itself",k=a("currentTaskTrace");function B(ne,le,$){let ee=R();if(ne===$)throw new TypeError(P);if(ne[b]===M){let He=null;try{(typeof $=="object"||typeof $=="function")&&(He=$&&$.then)}catch(qe){return ee(()=>{B(ne,!1,qe)})(),ne}if(le!==A&&$ instanceof q&&$.hasOwnProperty(b)&&$.hasOwnProperty(S)&&$[b]!==M)O($),B(ne,$[b],$[S]);else if(le!==A&&typeof He=="function")try{He.call($,ee(N(ne,le)),ee(N(ne,!1)))}catch(qe){ee(()=>{B(ne,!1,qe)})()}else{ne[b]=le;let qe=ne[S];if(ne[S]=$,ne[C]===C&&le===E&&(ne[b]=ne[I],ne[S]=ne[x]),le===A&&$ instanceof Error){let we=e.currentTask&&e.currentTask.data&&e.currentTask.data[d];we&&n($,k,{configurable:!0,enumerable:!1,writable:!0,value:we})}for(let we=0;we<qe.length;)z(ne,qe[we++],qe[we++],qe[we++],qe[we++]);if(qe.length==0&&le==A){ne[b]=L;let we=$;try{throw new Error("Uncaught (in promise): "+s($)+($&&$.stack?`
`+$.stack:""))}catch(je){we=je}h&&(we.throwOriginal=!0),we.rejection=$,we.promise=ne,we.zone=e.current,we.task=e.currentTask,l.push(we),i.scheduleMicroTask()}}}return ne}let F=a("rejectionHandledHandler");function O(ne){if(ne[b]===L){try{let le=e[F];le&&typeof le=="function"&&le.call(this,{rejection:ne[S],promise:ne})}catch{}ne[b]=A;for(let le=0;le<l.length;le++)ne===l[le].promise&&l.splice(le,1)}}function z(ne,le,$,ee,He){O(ne);let qe=ne[b],we=qe?typeof ee=="function"?ee:m:typeof He=="function"?He:y;le.scheduleMicroTask(D,()=>{try{let je=ne[S],Ne=!!$&&C===$[C];Ne&&($[x]=je,$[I]=qe);let Ye=le.run(we,void 0,Ne&&we!==y&&we!==m?[]:[je]);B($,!0,Ye)}catch(je){B($,!1,je)}},$)}let Y="function ZoneAwarePromise() { [native code] }",K=function(){},U=t.AggregateError;class q{static toString(){return Y}static resolve(le){return le instanceof q?le:B(new this(null),E,le)}static reject(le){return B(new this(null),A,le)}static withResolvers(){let le={};return le.promise=new q(($,ee)=>{le.resolve=$,le.reject=ee}),le}static any(le){if(!le||typeof le[Symbol.iterator]!="function")return Promise.reject(new U([],"All promises were rejected"));let $=[],ee=0;try{for(let we of le)ee++,$.push(q.resolve(we))}catch{return Promise.reject(new U([],"All promises were rejected"))}if(ee===0)return Promise.reject(new U([],"All promises were rejected"));let He=!1,qe=[];return new q((we,je)=>{for(let Ne=0;Ne<$.length;Ne++)$[Ne].then(Ye=>{He||(He=!0,we(Ye))},Ye=>{qe.push(Ye),ee--,ee===0&&(He=!0,je(new U(qe,"All promises were rejected")))})})}static race(le){let $,ee,He=new this((je,Ne)=>{$=je,ee=Ne});function qe(je){$(je)}function we(je){ee(je)}for(let je of le)v(je)||(je=this.resolve(je)),je.then(qe,we);return He}static all(le){return q.allWithCallback(le)}static allSettled(le){return(this&&this.prototype instanceof q?this:q).allWithCallback(le,{thenCallback:ee=>({status:"fulfilled",value:ee}),errorCallback:ee=>({status:"rejected",reason:ee})})}static allWithCallback(le,$){let ee,He,qe=new this((Ye,dt)=>{ee=Ye,He=dt}),we=2,je=0,Ne=[];for(let Ye of le){v(Ye)||(Ye=this.resolve(Ye));let dt=je;try{Ye.then(Ke=>{Ne[dt]=$?$.thenCallback(Ke):Ke,we--,we===0&&ee(Ne)},Ke=>{$?(Ne[dt]=$.errorCallback(Ke),we--,we===0&&ee(Ne)):He(Ke)})}catch(Ke){He(Ke)}we++,je++}return we-=2,we===0&&ee(Ne),qe}constructor(le){let $=this;if(!($ instanceof q))throw new Error("Must be an instanceof Promise.");$[b]=M,$[S]=[];try{let ee=R();le&&le(ee(N($,E)),ee(N($,A)))}catch(ee){B($,!1,ee)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return q}then(le,$){let ee=this.constructor?.[Symbol.species];(!ee||typeof ee!="function")&&(ee=this.constructor||q);let He=new ee(K),qe=e.current;return this[b]==M?this[S].push(qe,He,le,$):z(this,qe,He,le,$),He}catch(le){return this.then(null,le)}finally(le){let $=this.constructor?.[Symbol.species];(!$||typeof $!="function")&&($=q);let ee=new $(K);ee[C]=C;let He=e.current;return this[b]==M?this[S].push(He,ee,le,le):z(this,He,ee,le,le),ee}}q.resolve=q.resolve,q.reject=q.reject,q.race=q.race,q.all=q.all;let ae=t[c]=t.Promise;t.Promise=q;let te=a("thenPatched");function he(ne){let le=ne.prototype,$=r(le,"then");if($&&($.writable===!1||!$.configurable))return;let ee=le.then;le[u]=ee,ne.prototype.then=function(He,qe){return new q((je,Ne)=>{ee.call(this,je,Ne)}).then(He,qe)},ne[te]=!0}i.patchThen=he;function ue(ne){return function(le,$){let ee=ne.apply(le,$);if(ee instanceof q)return ee;let He=ee.constructor;return He[te]||he(He),ee}}return ae&&(he(ae),Ul(t,"fetch",ne=>ue(ne))),Promise[e.__symbol__("uncaughtPromiseErrors")]=l,q})}function D7(o){o.__load_patch("toString",t=>{let e=Function.prototype.toString,i=Vi("OriginalDelegate"),r=Vi("Promise"),n=Vi("Error"),s=function(){if(typeof this=="function"){let c=this[i];if(c)return typeof c=="function"?e.call(c):Object.prototype.toString.call(c);if(this===Promise){let u=t[r];if(u)return e.call(u)}if(this===Error){let u=t[n];if(u)return e.call(u)}}return e.call(this)};s[i]=e,Function.prototype.toString=s;let a=Object.prototype.toString,l="[object Promise]";Object.prototype.toString=function(){return typeof Promise=="function"&&this instanceof Promise?l:a.call(this)}})}function E7(o,t,e,i,r){let n=Zone.__symbol__(i);if(t[n])return;let s=t[n]=t[i];t[i]=function(a,l,h){return l&&l.prototype&&r.forEach(function(c){let u=`${e}.${i}::`+c,d=l.prototype;try{if(d.hasOwnProperty(c)){let p=o.ObjectGetOwnPropertyDescriptor(d,c);p&&p.value?(p.value=o.wrapWithCurrentZone(p.value,u),o._redefineProperty(l.prototype,c,p)):d[c]&&(d[c]=o.wrapWithCurrentZone(d[c],u))}else d[c]&&(d[c]=o.wrapWithCurrentZone(d[c],u))}catch{}}),s.call(t,a,l,h)},o.attachOriginToPatched(t[i],s)}function T7(o){o.__load_patch("util",(t,e,i)=>{let r=IE(t);i.patchOnProperties=SP,i.patchMethod=Ul,i.bindArguments=NE,i.patchMacroTask=f7;let n=e.__symbol__("BLACK_LISTED_EVENTS"),s=e.__symbol__("UNPATCHED_EVENTS");t[s]&&(t[n]=t[s]),t[n]&&(e[n]=e[s]=t[n]),i.patchEventPrototype=y7,i.patchEventTarget=m7,i.isIEOrEdge=g7,i.ObjectDefineProperty=ME,i.ObjectGetOwnPropertyDescriptor=Vg,i.ObjectCreate=h7,i.ArraySlice=c7,i.patchClass=Hg,i.wrapWithCurrentZone=AE,i.filterProperties=DP,i.attachOriginToPatched=Wl,i._redefineProperty=Object.defineProperty,i.patchCallbacks=E7,i.getGlobalObjects=()=>({globalSources:CP,zoneSymbolEventNames:Pa,eventNames:r,isBrowser:kE,isMix:bP,isNode:$0,TRUE_STR:Vl,FALSE_STR:_l,ZONE_SYMBOL_PREFIX:_g,ADD_EVENT_LISTENER_STR:EE,REMOVE_EVENT_LISTENER_STR:TE})})}function A7(o){M7(o),D7(o),T7(o)}var EP=l7();A7(EP);I7(EP);gw(G0).catch(o=>console.error(o));
